Rank =    0  Free Memory = 81720 MB
Rank =    1  Free Memory = 81720 MB
Rank =    2  Free Memory = 81720 MB
Rank =    3  Free Memory = 81719 MB
Rank =    4  Free Memory = 81719 MB
Rank =    5  Free Memory = 81719 MB
Rank =    6  Free Memory = 81719 MB
Rank =    7  Free Memory = 81719 MB
Rank =    8  Free Memory = 81719 MB
Rank =    9  Free Memory = 81719 MB
Rank =   10  Free Memory = 81718 MB
Rank =   11  Free Memory = 81718 MB
Rank =   12  Free Memory = 81718 MB
Rank =   13  Free Memory = 81718 MB
Rank =   14  Free Memory = 81717 MB
Rank =   15  Free Memory = 81703 MB
Rank =   16  Free Memory = 81703 MB
Rank =   17  Free Memory = 81703 MB
Rank =   18  Free Memory = 81703 MB
Rank =   19  Free Memory = 81703 MB
Rank =   20  Free Memory = 81703 MB
Rank =   21  Free Memory = 81703 MB
Rank =   22  Free Memory = 81703 MB
Rank =   23  Free Memory = 81703 MB
Rank =   24  Free Memory = 81703 MB
Rank =   25  Free Memory = 81703 MB
Rank =   26  Free Memory = 81703 MB
Rank =   27  Free Memory = 81703 MB
Rank =   28  Free Memory = 81703 MB
Rank =   29  Free Memory = 81703 MB
Rank =   30  Free Memory = 81703 MB
Rank =   31  Free Memory = 81703 MB
Rank =   32  Free Memory = 82763 MB
Rank =   33  Free Memory = 82763 MB
Rank =   34  Free Memory = 82762 MB
Rank =   35  Free Memory = 82762 MB
Rank =   36  Free Memory = 82762 MB
Rank =   37  Free Memory = 82762 MB
Rank =   38  Free Memory = 82762 MB
Rank =   39  Free Memory = 82762 MB
Rank =   40  Free Memory = 82762 MB
Rank =   41  Free Memory = 82762 MB
Rank =   42  Free Memory = 82762 MB
Rank =   43  Free Memory = 82762 MB
Rank =   44  Free Memory = 82762 MB
Rank =   45  Free Memory = 82762 MB
Rank =   46  Free Memory = 82762 MB
Rank =   47  Free Memory = 82762 MB
Rank =   48  Free Memory = 82762 MB
Rank =   49  Free Memory = 82762 MB
Rank =   50  Free Memory = 82762 MB
Rank =   51  Free Memory = 82762 MB
Rank =   52  Free Memory = 82762 MB
Rank =   53  Free Memory = 82762 MB
Rank =   54  Free Memory = 82762 MB
Rank =   55  Free Memory = 82762 MB
Rank =   56  Free Memory = 82761 MB
Rank =   57  Free Memory = 82761 MB
Rank =   58  Free Memory = 82761 MB
Rank =   59  Free Memory = 82761 MB
Rank =   60  Free Memory = 82761 MB
Rank =   61  Free Memory = 82761 MB
Rank =   62  Free Memory = 82761 MB
Rank =   63  Free Memory = 82761 MB
Rank =   64  Free Memory = 82178 MB
Rank =   65  Free Memory = 82178 MB
Rank =   66  Free Memory = 82178 MB
Rank =   67  Free Memory = 82178 MB
Rank =   68  Free Memory = 82178 MB
Rank =   69  Free Memory = 82178 MB
Rank =   70  Free Memory = 82178 MB
Rank =   71  Free Memory = 82178 MB
Rank =   72  Free Memory = 82178 MB
Rank =   73  Free Memory = 82178 MB
Rank =   74  Free Memory = 82178 MB
Rank =   75  Free Memory = 82178 MB
Rank =   76  Free Memory = 82178 MB
Rank =   77  Free Memory = 82178 MB
Rank =   78  Free Memory = 82178 MB
Rank =   79  Free Memory = 82178 MB
Rank =   80  Free Memory = 82178 MB
Rank =   81  Free Memory = 82178 MB
Rank =   82  Free Memory = 82178 MB
Rank =   83  Free Memory = 82178 MB
Rank =   84  Free Memory = 82178 MB
Rank =   85  Free Memory = 82178 MB
Rank =   86  Free Memory = 82178 MB
Rank =   87  Free Memory = 82178 MB
Rank =   88  Free Memory = 82178 MB
Rank =   89  Free Memory = 82178 MB
Rank =   90  Free Memory = 82178 MB
Rank =   91  Free Memory = 82178 MB
Rank =   92  Free Memory = 82178 MB
Rank =   93  Free Memory = 82178 MB
Rank =   94  Free Memory = 82178 MB
Rank =   95  Free Memory = 82178 MB
Rank =   96  Free Memory = 84192 MB
Rank =   97  Free Memory = 84192 MB
Rank =   98  Free Memory = 84192 MB
Rank =   99  Free Memory = 84192 MB
Rank =  100  Free Memory = 84192 MB
Rank =  101  Free Memory = 84192 MB
Rank =  102  Free Memory = 84192 MB
Rank =  103  Free Memory = 84192 MB
Rank =  104  Free Memory = 84192 MB
Rank =  105  Free Memory = 84192 MB
Rank =  106  Free Memory = 84192 MB
Rank =  107  Free Memory = 84192 MB
Rank =  108  Free Memory = 84192 MB
Rank =  109  Free Memory = 84192 MB
Rank =  110  Free Memory = 84192 MB
Rank =  111  Free Memory = 84192 MB
Rank =  112  Free Memory = 84192 MB
Rank =  113  Free Memory = 84192 MB
Rank =  114  Free Memory = 84192 MB
Rank =  115  Free Memory = 84192 MB
Rank =  116  Free Memory = 84192 MB
Rank =  117  Free Memory = 84192 MB
Rank =  118  Free Memory = 84192 MB
Rank =  119  Free Memory = 84192 MB
Rank =  120  Free Memory = 84192 MB
Rank =  121  Free Memory = 84192 MB
Rank =  122  Free Memory = 84192 MB
Rank =  123  Free Memory = 84192 MB
Rank =  124  Free Memory = 84192 MB
Rank =  125  Free Memory = 84192 MB
Rank =  126  Free Memory = 84192 MB
Rank =  127  Free Memory = 84192 MB
  Input file(s): opt_h2o_gs_gvptt_run003h.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvptt_run003h.xml

  Project = H2O
  date    = 2023-04-10 11:10:14 PDT
  host    = n0029.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 262

  Range of prime numbers to use as seeds over processors and threads = 1693-2693


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.156920e-01    1         1  ON     0
     uu_1                 5.261309e-02    1         1  ON     1
     uu_2                -4.277930e-02    1         1  ON     2
     uu_3                -9.884128e-02    1         1  ON     3
     uu_4                -1.337053e-01    1         1  ON     4
     uu_5                -1.423960e-01    1         1  ON     5
     uu_6                -1.201254e-01    1         1  ON     6
     uu_7                -5.137389e-02    1         1  ON     7
     uu_8                 9.089303e-02    1         1  ON     8
     uu_9                 1.284456e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.554769e-01    1         1  ON     0
     ud_1                 9.680473e-02    1         1  ON     1
     ud_2                -1.285764e-02    1         1  ON     2
     ud_3                -7.434211e-02    1         1  ON     3
     ud_4                -1.230076e-01    1         1  ON     4
     ud_5                -1.556260e-01    1         1  ON     5
     ud_6                -1.582973e-01    1         1  ON     6
     ud_7                -1.120621e-01    1         1  ON     7
     ud_8                -8.225009e-03    1         1  ON     8
     ud_9                 9.246287e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.892148e-01    1         1  ON     0
     eO_1                -4.676579e-01    1         1  ON     1
     eO_2                -5.566716e-02    1         1  ON     2
     eO_3                 2.073232e-01    1         1  ON     3
     eO_4                 3.123468e-01    1         1  ON     4
     eO_5                 3.338822e-01    1         1  ON     5
     eO_6                 2.676182e-01    1         1  ON     6
     eO_7                 1.297939e-01    1         1  ON     7
     eO_8                 3.111679e-02    1         1  ON     8
     eO_9                 1.924238e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.844724e-01    1         1  ON     0
     eH1_1                -1.056881e-01    1         1  ON     1
     eH1_2                -6.401847e-02    1         1  ON     2
     eH1_3                -2.669413e-02    1         1  ON     3
     eH1_4                 1.878994e-02    1         1  ON     4
     eH1_5                 3.146862e-02    1         1  ON     5
     eH1_6                 7.771215e-02    1         1  ON     6
     eH1_7                 1.090692e-01    1         1  ON     7
     eH1_8                 1.002774e-01    1         1  ON     8
     eH1_9                 2.728702e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.851321e-01    1         1  ON     0
     eH2_1                -1.062684e-01    1         1  ON     1
     eH2_2                -6.452492e-02    1         1  ON     2
     eH2_3                -2.737952e-02    1         1  ON     3
     eH2_4                 1.762293e-02    1         1  ON     4
     eH2_5                 3.022024e-02    1         1  ON     5
     eH2_6                 7.594683e-02    1         1  ON     6
     eH2_7                 1.132115e-01    1         1  ON     7
     eH2_8                 1.041072e-01    1         1  ON     8
     eH2_9                 2.922227e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.697451e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 5.0407e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1492
    reference variance = 0.397542
====================================================
  Execution time = 2.0382e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1334e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4469e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313382250695
                                         uncertainty =       0.003107944433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313382250695
                                         uncertainty =       0.003107944433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395813345
  error estimate for blocks of size 2^( 2) =       0.000405825220
  error estimate for blocks of size 2^( 3) =       0.000414144780
  error estimate for blocks of size 2^( 4) =       0.000420362474
  error estimate for blocks of size 2^( 5) =       0.000425690165
  error estimate for blocks of size 2^( 6) =       0.000427974854
  error estimate for blocks of size 2^( 7) =       0.000427950073

      target function =                  N/A
              le_mean =     -17.215716651965
             les_mean =     296.694236091587
             stat err =       0.000425494391
             autocorr =       1.155598089851
              std dev =       0.559764600090
             le_variance =       0.313336407514


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721571665196e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215716651965       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215715762268       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215715261422       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215717890692       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215719146558       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215718587929       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215718068424       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215718313720       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215718457835       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215718520360       residual = 9.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.722971e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215716651965       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215716268381       residual = 9.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215716009267       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215716935903       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215717540040       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215717394612       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215717279568       residual = 6.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215717312666       residual = 9.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 5.114987e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215716651965       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215716534856       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215716449329       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215716703573       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215716879294       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215716866423       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215716829591       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215716851736       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.353856e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.345956 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6183e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  2.157873e-01                 1 1 ON  0
uu_1  5.274029e-02                 1 1 ON  1
uu_2  -4.284174e-02                1 1 ON  2
uu_3  -9.889787e-02                1 1 ON  3
uu_4  -1.337700e-01                1 1 ON  4
uu_5  -1.424571e-01                1 1 ON  5
uu_6  -1.202295e-01                1 1 ON  6
uu_7  -5.141736e-02                1 1 ON  7
uu_8  9.086791e-02                 1 1 ON  8
uu_9  1.285206e-01                 1 1 ON  9
ud_0  3.557775e-01                 1 1 ON  10
ud_1  9.689660e-02                 1 1 ON  11
ud_2  -1.307865e-02                1 1 ON  12
ud_3  -7.455618e-02                1 1 ON  13
ud_4  -1.230162e-01                1 1 ON  14
ud_5  -1.556282e-01                1 1 ON  15
ud_6  -1.582625e-01                1 1 ON  16
ud_7  -1.121331e-01                1 1 ON  17
ud_8  -8.299410e-03                1 1 ON  18
ud_9  9.249435e-02                 1 1 ON  19
eO_0  -7.897263e-01                1 1 ON  20
eO_1  -4.679417e-01                1 1 ON  21
eO_2  -5.544735e-02                1 1 ON  22
eO_3  2.074862e-01                 1 1 ON  23
eO_4  3.123782e-01                 1 1 ON  24
eO_5  3.339407e-01                 1 1 ON  25
eO_6  2.677424e-01                 1 1 ON  26
eO_7  1.299235e-01                 1 1 ON  27
eO_8  3.114405e-02                 1 1 ON  28
eO_9  1.925834e-02                 1 1 ON  29
eH1_0 -1.844902e-01                1 1 ON  30
eH1_1 -1.056802e-01                1 1 ON  31
eH1_2 -6.397120e-02                1 1 ON  32
eH1_3 -2.669034e-02                1 1 ON  33
eH1_4 1.867425e-02                 1 1 ON  34
eH1_5 3.140971e-02                 1 1 ON  35
eH1_6 7.771491e-02                 1 1 ON  36
eH1_7 1.090788e-01                 1 1 ON  37
eH1_8 1.003460e-01                 1 1 ON  38
eH1_9 2.731878e-02                 1 1 ON  39
eH2_0 -1.851139e-01                1 1 ON  40
eH2_1 -1.062598e-01                1 1 ON  41
eH2_2 -6.460156e-02                1 1 ON  42
eH2_3 -2.736085e-02                1 1 ON  43
eH2_4 1.764523e-02                 1 1 ON  44
eH2_5 3.021075e-02                 1 1 ON  45
eH2_6 7.587236e-02                 1 1 ON  46
eH2_7 1.131833e-01                 1 1 ON  47
eH2_8 1.041879e-01                 1 1 ON  48
eH2_9 2.924364e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2656
    reference variance = 0.449242
====================================================
  Execution time = 2.1169e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1631e-01
  Total weights = 2.0000e+06
  Execution time = 1.8994e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315910686174
                                         uncertainty =       0.003337406444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315910686174
                                         uncertainty =       0.003337406444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397431664
  error estimate for blocks of size 2^( 2) =       0.000407061441
  error estimate for blocks of size 2^( 3) =       0.000415484640
  error estimate for blocks of size 2^( 4) =       0.000422003211
  error estimate for blocks of size 2^( 5) =       0.000426429396
  error estimate for blocks of size 2^( 6) =       0.000428164178
  error estimate for blocks of size 2^( 7) =       0.000429909081

      target function =                  N/A
              le_mean =     -17.216575574640
             les_mean =     296.726378214830
             stat err =       0.000426626467
             autocorr =       1.152313520853
              std dev =       0.562053249702
             le_variance =       0.315903855500

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316942180475
                                         uncertainty =       0.003346041230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316942180475
                                         uncertainty =       0.003346041230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398080100
  error estimate for blocks of size 2^( 2) =       0.000407677560
  error estimate for blocks of size 2^( 3) =       0.000416061470
  error estimate for blocks of size 2^( 4) =       0.000422555782
  error estimate for blocks of size 2^( 5) =       0.000426975285
  error estimate for blocks of size 2^( 6) =       0.000428694669
  error estimate for blocks of size 2^( 7) =       0.000430460594

      target function =                  N/A
              le_mean =     -17.216573806968
             les_mean =     296.727349024606
             stat err =       0.000427171583
             autocorr =       1.151499547709
              std dev =       0.562970276558
             le_variance =       0.316935532288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316738779586
                                         uncertainty =       0.003343728737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316738779586
                                         uncertainty =       0.003343728737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397952299
  error estimate for blocks of size 2^( 2) =       0.000407554733
  error estimate for blocks of size 2^( 3) =       0.000415945474
  error estimate for blocks of size 2^( 4) =       0.000422445572
  error estimate for blocks of size 2^( 5) =       0.000426866616
  error estimate for blocks of size 2^( 6) =       0.000428588798
  error estimate for blocks of size 2^( 7) =       0.000430351139

      target function =                  N/A
              le_mean =     -17.216573694540
             les_mean =     296.727141686129
             stat err =       0.000427063031
             autocorr =       1.151653733533
              std dev =       0.562789538792
             le_variance =       0.316732064974

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316033126426
                                         uncertainty =       0.003338276936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316033126426
                                         uncertainty =       0.003338276936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397508686
  error estimate for blocks of size 2^( 2) =       0.000407134205
  error estimate for blocks of size 2^( 3) =       0.000415552376
  error estimate for blocks of size 2^( 4) =       0.000422068220
  error estimate for blocks of size 2^( 5) =       0.000426493646
  error estimate for blocks of size 2^( 6) =       0.000428226416
  error estimate for blocks of size 2^( 7) =       0.000429973899

      target function =                  N/A
              le_mean =     -17.216575031779
             les_mean =     296.726481978430
             stat err =       0.000426690545
             autocorr =       1.152213057549
              std dev =       0.562162175493
             le_variance =       0.316026311555


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216575574640        initial  <--
     2.5000e-01     2.5000e+00             1.7230e-03       -17.216573806968
     1.0000e+00     1.0000e+01             5.1150e-04       -17.216573694540
     4.0000e+00     4.0000e+01             1.3539e-04       -17.216575031779

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7639
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261309e-02 1 1  ON 1
 uu_2                -4.277930e-02 1 1  ON 2
 uu_3                -9.884128e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201254e-01 1 1  ON 6
 uu_7                -5.137389e-02 1 1  ON 7
 uu_8                 9.089303e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285764e-02 1 1  ON 12
 ud_3                -7.434211e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.225009e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892148e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566716e-02 1 1  ON 22
 eO_3                 2.073232e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676182e-01 1 1  ON 26
 eO_7                 1.297939e-01 1 1  ON 27
 eO_8                 3.111679e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844724e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401847e-02 1 1  ON 32
eH1_3                -2.669413e-02 1 1  ON 33
eH1_4                 1.878994e-02 1 1  ON 34
eH1_5                 3.146862e-02 1 1  ON 35
eH1_6                 7.771215e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728702e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452492e-02 1 1  ON 42
eH2_3                -2.737952e-02 1 1  ON 43
eH2_4                 1.762293e-02 1 1  ON 44
eH2_5                 3.022024e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922227e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7209e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.274
    reference variance = 0.536962
====================================================
  Execution time = 2.2672e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2384e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6481e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323890223612
                                         uncertainty =       0.005360366040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323890223612
                                         uncertainty =       0.005360366040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402395776
  error estimate for blocks of size 2^( 2) =       0.000412005277
  error estimate for blocks of size 2^( 3) =       0.000420598719
  error estimate for blocks of size 2^( 4) =       0.000427499957
  error estimate for blocks of size 2^( 5) =       0.000432669999
  error estimate for blocks of size 2^( 6) =       0.000434668615
  error estimate for blocks of size 2^( 7) =       0.000434882838

      target function =                  N/A
              le_mean =     -17.216856792280
             les_mean =     296.744002364891
             stat err =       0.000432430352
             autocorr =       1.154849824582
              std dev =       0.569073563715
             le_variance =       0.323844720919


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721685679228e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216856792280       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216856881252       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216856818076       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216856834356       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216856963344       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216856839319       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216857014745       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216856996444       residual = 5.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.931312e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216856792280       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216856816150       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216856799272       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216856802577       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216856836207       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216856806932       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216856847666       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216856843341       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 5.014108e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216856792280       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216856798359       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216856794067       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216856794842       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216856803331       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216856796141       residual = 7.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216856806068       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216856805038       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 1.266418e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.348695 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8330e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.156945e-01 1 1  ON 0
 uu_1                 5.262026e-02 1 1  ON 1
 uu_2                -4.278735e-02 1 1  ON 2
 uu_3                -9.884026e-02 1 1  ON 3
 uu_4                -1.337005e-01 1 1  ON 4
 uu_5                -1.423984e-01 1 1  ON 5
 uu_6                -1.201296e-01 1 1  ON 6
 uu_7                -5.137324e-02 1 1  ON 7
 uu_8                 9.088432e-02 1 1  ON 8
 uu_9                 1.284488e-01 1 1  ON 9
 ud_0                 3.555082e-01 1 1  ON 10
 ud_1                 9.683175e-02 1 1  ON 11
 ud_2                -1.287814e-02 1 1  ON 12
 ud_3                -7.435197e-02 1 1  ON 13
 ud_4                -1.230220e-01 1 1  ON 14
 ud_5                -1.556345e-01 1 1  ON 15
 ud_6                -1.582936e-01 1 1  ON 16
 ud_7                -1.120652e-01 1 1  ON 17
 ud_8                -8.233384e-03 1 1  ON 18
 ud_9                 9.246149e-02 1 1  ON 19
 eO_0                -7.892649e-01 1 1  ON 20
 eO_1                -4.676815e-01 1 1  ON 21
 eO_2                -5.564528e-02 1 1  ON 22
 eO_3                 2.073384e-01 1 1  ON 23
 eO_4                 3.123448e-01 1 1  ON 24
 eO_5                 3.338915e-01 1 1  ON 25
 eO_6                 2.676321e-01 1 1  ON 26
 eO_7                 1.298081e-01 1 1  ON 27
 eO_8                 3.111776e-02 1 1  ON 28
 eO_9                 1.924252e-02 1 1  ON 29
eH1_0                -1.844807e-01 1 1  ON 30
eH1_1                -1.056829e-01 1 1  ON 31
eH1_2                -6.401796e-02 1 1  ON 32
eH1_3                -2.668702e-02 1 1  ON 33
eH1_4                 1.878719e-02 1 1  ON 34
eH1_5                 3.146710e-02 1 1  ON 35
eH1_6                 7.770652e-02 1 1  ON 36
eH1_7                 1.090669e-01 1 1  ON 37
eH1_8                 1.002831e-01 1 1  ON 38
eH1_9                 2.728873e-02 1 1  ON 39
eH2_0                -1.851333e-01 1 1  ON 40
eH2_1                -1.062628e-01 1 1  ON 41
eH2_2                -6.454348e-02 1 1  ON 42
eH2_3                -2.738177e-02 1 1  ON 43
eH2_4                 1.762713e-02 1 1  ON 44
eH2_5                 3.022535e-02 1 1  ON 45
eH2_6                 7.594672e-02 1 1  ON 46
eH2_7                 1.132118e-01 1 1  ON 47
eH2_8                 1.041132e-01 1 1  ON 48
eH2_9                 2.922322e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2227
    reference variance = 0.239737
====================================================
  Execution time = 2.0175e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1418e-01
  Total weights = 2.0000e+06
  Execution time = 1.9036e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314191052489
                                         uncertainty =       0.002309418502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314191052489
                                         uncertainty =       0.002309418502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396326582
  error estimate for blocks of size 2^( 2) =       0.000406390987
  error estimate for blocks of size 2^( 3) =       0.000415176878
  error estimate for blocks of size 2^( 4) =       0.000421762469
  error estimate for blocks of size 2^( 5) =       0.000426490559
  error estimate for blocks of size 2^( 6) =       0.000428204513
  error estimate for blocks of size 2^( 7) =       0.000430481809

      target function =                  N/A
              le_mean =     -17.215953815647
             les_mean =     296.703215144735
             stat err =       0.000426734838
             autocorr =       1.159337260642
              std dev =       0.560490427506
             le_variance =       0.314149519325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314324327470
                                         uncertainty =       0.002310614432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314324327470
                                         uncertainty =       0.002310614432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396410652
  error estimate for blocks of size 2^( 2) =       0.000406469704
  error estimate for blocks of size 2^( 3) =       0.000415251098
  error estimate for blocks of size 2^( 4) =       0.000421833125
  error estimate for blocks of size 2^( 5) =       0.000426558894
  error estimate for blocks of size 2^( 6) =       0.000428269775
  error estimate for blocks of size 2^( 7) =       0.000430547494

      target function =                  N/A
              le_mean =     -17.215953399692
             les_mean =     296.703334113467
             stat err =       0.000426802322
             autocorr =       1.159212124045
              std dev =       0.560609320497
             le_variance =       0.314282810228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314261565505
                                         uncertainty =       0.002310063475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314261565505
                                         uncertainty =       0.002310063475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396371065
  error estimate for blocks of size 2^( 2) =       0.000406432552
  error estimate for blocks of size 2^( 3) =       0.000415216036
  error estimate for blocks of size 2^( 4) =       0.000421799761
  error estimate for blocks of size 2^( 5) =       0.000426526560
  error estimate for blocks of size 2^( 6) =       0.000428238766
  error estimate for blocks of size 2^( 7) =       0.000430516288

      target function =                  N/A
              le_mean =     -17.215953589234
             les_mean =     296.703277872283
             stat err =       0.000426770344
             autocorr =       1.159269948825
              std dev =       0.560553336194
             le_variance =       0.314220042718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314199976818
                                         uncertainty =       0.002309500747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314199976818
                                         uncertainty =       0.002309500747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396332212
  error estimate for blocks of size 2^( 2) =       0.000406396244
  error estimate for blocks of size 2^( 3) =       0.000415181827
  error estimate for blocks of size 2^( 4) =       0.000421767182
  error estimate for blocks of size 2^( 5) =       0.000426495106
  error estimate for blocks of size 2^( 6) =       0.000428208834
  error estimate for blocks of size 2^( 7) =       0.000430486159

      target function =                  N/A
              le_mean =     -17.215953784828
             les_mean =     296.703223009323
             stat err =       0.000426739320
             autocorr =       1.159328677717
              std dev =       0.560498389878
             le_variance =       0.314158445056


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215953815647        initial  <--
     2.5000e+00     2.5000e+01             1.9313e-04       -17.215953399692
     1.0000e+01     1.0000e+02             5.0141e-05       -17.215953589234
     4.0000e+01     4.0000e+02             1.2664e-05       -17.215953784828

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7665
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261309e-02 1 1  ON 1
 uu_2                -4.277930e-02 1 1  ON 2
 uu_3                -9.884128e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201254e-01 1 1  ON 6
 uu_7                -5.137389e-02 1 1  ON 7
 uu_8                 9.089303e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285764e-02 1 1  ON 12
 ud_3                -7.434211e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.225009e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892148e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566716e-02 1 1  ON 22
 eO_3                 2.073232e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676182e-01 1 1  ON 26
 eO_7                 1.297939e-01 1 1  ON 27
 eO_8                 3.111679e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844724e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401847e-02 1 1  ON 32
eH1_3                -2.669413e-02 1 1  ON 33
eH1_4                 1.878994e-02 1 1  ON 34
eH1_5                 3.146862e-02 1 1  ON 35
eH1_6                 7.771215e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728702e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452492e-02 1 1  ON 42
eH2_3                -2.737952e-02 1 1  ON 43
eH2_4                 1.762293e-02 1 1  ON 44
eH2_5                 3.022024e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922227e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8456e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7228e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.0639
    reference variance = 1.83281
====================================================
  Execution time = 2.1520e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1711e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5479e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316881652995
                                         uncertainty =       0.003296010799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316881652995
                                         uncertainty =       0.003296010799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398191416
  error estimate for blocks of size 2^( 2) =       0.000407940106
  error estimate for blocks of size 2^( 3) =       0.000416937754
  error estimate for blocks of size 2^( 4) =       0.000423612267
  error estimate for blocks of size 2^( 5) =       0.000427536911
  error estimate for blocks of size 2^( 6) =       0.000429514896
  error estimate for blocks of size 2^( 7) =       0.000432012818

      target function =                  N/A
              le_mean =     -17.217001787269
             les_mean =     296.742263192111
             stat err =       0.000428169223
             autocorr =       1.156237648255
              std dev =       0.563127701178
             le_variance =       0.317112807834


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721700178727e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217001787269       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217001791888       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217001766416       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217001777634       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217001807351       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217001801011       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217001801074       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217001803439       residual = 2.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 2.225095e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217001787269       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217001788433       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217001782004       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217001784795       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217001792298       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217001790751       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217001790757       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217001791358       residual = 2.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 5.585921e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217001787269       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217001787561       residual = 8.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217001785950       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217001786647       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217001788527       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217001788143       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217001788144       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217001788294       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+02 is 1.397947e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.351428 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7080e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.156922e-01 1 1  ON 0
 uu_1                 5.261488e-02 1 1  ON 1
 uu_2                -4.277991e-02 1 1  ON 2
 uu_3                -9.884168e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423955e-01 1 1  ON 5
 uu_6                -1.201267e-01 1 1  ON 6
 uu_7                -5.137454e-02 1 1  ON 7
 uu_8                 9.089255e-02 1 1  ON 8
 uu_9                 1.284460e-01 1 1  ON 9
 ud_0                 3.554799e-01 1 1  ON 10
 ud_1                 9.680661e-02 1 1  ON 11
 ud_2                -1.285972e-02 1 1  ON 12
 ud_3                -7.434328e-02 1 1  ON 13
 ud_4                -1.230080e-01 1 1  ON 14
 ud_5                -1.556259e-01 1 1  ON 15
 ud_6                -1.582982e-01 1 1  ON 16
 ud_7                -1.120625e-01 1 1  ON 17
 ud_8                -8.225513e-03 1 1  ON 18
 ud_9                 9.246282e-02 1 1  ON 19
 eO_0                -7.892204e-01 1 1  ON 20
 eO_1                -4.676599e-01 1 1  ON 21
 eO_2                -5.566413e-02 1 1  ON 22
 eO_3                 2.073235e-01 1 1  ON 23
 eO_4                 3.123474e-01 1 1  ON 24
 eO_5                 3.338830e-01 1 1  ON 25
 eO_6                 2.676194e-01 1 1  ON 26
 eO_7                 1.297952e-01 1 1  ON 27
 eO_8                 3.111701e-02 1 1  ON 28
 eO_9                 1.924241e-02 1 1  ON 29
eH1_0                -1.844728e-01 1 1  ON 30
eH1_1                -1.056878e-01 1 1  ON 31
eH1_2                -6.401891e-02 1 1  ON 32
eH1_3                -2.669412e-02 1 1  ON 33
eH1_4                 1.879011e-02 1 1  ON 34
eH1_5                 3.146865e-02 1 1  ON 35
eH1_6                 7.771195e-02 1 1  ON 36
eH1_7                 1.090690e-01 1 1  ON 37
eH1_8                 1.002780e-01 1 1  ON 38
eH1_9                 2.728724e-02 1 1  ON 39
eH2_0                -1.851328e-01 1 1  ON 40
eH2_1                -1.062679e-01 1 1  ON 41
eH2_2                -6.452544e-02 1 1  ON 42
eH2_3                -2.738017e-02 1 1  ON 43
eH2_4                 1.762377e-02 1 1  ON 44
eH2_5                 3.022009e-02 1 1  ON 45
eH2_6                 7.594660e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041079e-01 1 1  ON 48
eH2_9                 2.922249e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.3136
    reference variance = 0.425281
====================================================
  Execution time = 2.0462e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3817e-01
  Total weights = 2.0000e+06
  Execution time = 1.8995e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338199469143
                                         uncertainty =       0.024646758931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338199469143
                                         uncertainty =       0.024646758931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411195077
  error estimate for blocks of size 2^( 2) =       0.000420585064
  error estimate for blocks of size 2^( 3) =       0.000428918239
  error estimate for blocks of size 2^( 4) =       0.000435128047
  error estimate for blocks of size 2^( 5) =       0.000439638217
  error estimate for blocks of size 2^( 6) =       0.000442515155
  error estimate for blocks of size 2^( 7) =       0.000440637850

      target function =                  N/A
              le_mean =     -17.216000495757
             les_mean =     296.728835683143
             stat err =       0.000439479817
             autocorr =       1.142304949100
              std dev =       0.581517654353
             le_variance =       0.338162782324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338215602354
                                         uncertainty =       0.024648108157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338215602354
                                         uncertainty =       0.024648108157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411204881
  error estimate for blocks of size 2^( 2) =       0.000420594333
  error estimate for blocks of size 2^( 3) =       0.000428926978
  error estimate for blocks of size 2^( 4) =       0.000435136457
  error estimate for blocks of size 2^( 5) =       0.000439646348
  error estimate for blocks of size 2^( 6) =       0.000442522937
  error estimate for blocks of size 2^( 7) =       0.000440645755

      target function =                  N/A
              le_mean =     -17.216000517494
             les_mean =     296.728852557068
             stat err =       0.000439487874
             autocorr =       1.142292361709
              std dev =       0.581531519183
             le_variance =       0.338178907803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338207589213
                                         uncertainty =       0.024647434943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338207589213
                                         uncertainty =       0.024647434943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411200011
  error estimate for blocks of size 2^( 2) =       0.000420589729
  error estimate for blocks of size 2^( 3) =       0.000428922636
  error estimate for blocks of size 2^( 4) =       0.000435132279
  error estimate for blocks of size 2^( 5) =       0.000439642308
  error estimate for blocks of size 2^( 6) =       0.000442519069
  error estimate for blocks of size 2^( 7) =       0.000440641827

      target function =                  N/A
              le_mean =     -17.216000506405
             les_mean =     296.728844165973
             stat err =       0.000439483871
             autocorr =       1.142298603986
              std dev =       0.581524632759
             le_variance =       0.338170898505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338200485701
                                         uncertainty =       0.024646843472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338200485701
                                         uncertainty =       0.024646843472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411195695
  error estimate for blocks of size 2^( 2) =       0.000420585648
  error estimate for blocks of size 2^( 3) =       0.000428918790
  error estimate for blocks of size 2^( 4) =       0.000435128577
  error estimate for blocks of size 2^( 5) =       0.000439638729
  error estimate for blocks of size 2^( 6) =       0.000442515645
  error estimate for blocks of size 2^( 7) =       0.000440638348

      target function =                  N/A
              le_mean =     -17.216000497065
             les_mean =     296.728836744260
             stat err =       0.000439480325
             autocorr =       1.142304154301
              std dev =       0.581518527990
             le_variance =       0.338163798395


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216000495757        initial
     2.5000e+01     2.5000e+02             2.2251e-05       -17.216000517494  <--
     1.0000e+02     1.0000e+03             5.5859e-06       -17.216000506405
     4.0000e+02     4.0000e+03             1.3979e-06       -17.216000497065

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 3.0058e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278171e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227021e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565519e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7167e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1816
    reference variance = 0.38318
====================================================
  Execution time = 2.0392e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2573e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5915e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325870333223
                                         uncertainty =       0.005490084240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325870333223
                                         uncertainty =       0.005490084240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403567365
  error estimate for blocks of size 2^( 2) =       0.000412949539
  error estimate for blocks of size 2^( 3) =       0.000421579128
  error estimate for blocks of size 2^( 4) =       0.000428161451
  error estimate for blocks of size 2^( 5) =       0.000432449700
  error estimate for blocks of size 2^( 6) =       0.000435036469
  error estimate for blocks of size 2^( 7) =       0.000436867331

      target function =                  N/A
              le_mean =     -17.217356603388
             les_mean =     296.763101481304
             stat err =       0.000433128738
             autocorr =       1.151865899504
              std dev =       0.570730440715
             le_variance =       0.325733235958


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721735660339e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217356603388       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217356375677       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217356477865       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217356595329       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217356747017       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217356756297       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217356778311       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217356785273       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 9.999904e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217356603388       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217356544389       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217356569921       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217356599070       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217356635455       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217356638967       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217356644452       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217356646288       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 2.551444e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217356603388       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217356588503       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217356594883       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217356602152       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217356611133       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217356612086       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217356613456       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217356613922       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 6.412270e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.354073 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5994e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.156878e-01 1 1  ON 0
 uu_1                 5.262768e-02 1 1  ON 1
 uu_2                -4.278638e-02 1 1  ON 2
 uu_3                -9.884150e-02 1 1  ON 3
 uu_4                -1.337027e-01 1 1  ON 4
 uu_5                -1.423944e-01 1 1  ON 5
 uu_6                -1.201337e-01 1 1  ON 6
 uu_7                -5.137834e-02 1 1  ON 7
 uu_8                 9.088935e-02 1 1  ON 8
 uu_9                 1.284495e-01 1 1  ON 9
 ud_0                 3.555005e-01 1 1  ON 10
 ud_1                 9.682328e-02 1 1  ON 11
 ud_2                -1.287479e-02 1 1  ON 12
 ud_3                -7.435412e-02 1 1  ON 13
 ud_4                -1.230108e-01 1 1  ON 14
 ud_5                -1.556261e-01 1 1  ON 15
 ud_6                -1.583022e-01 1 1  ON 16
 ud_7                -1.120659e-01 1 1  ON 17
 ud_8                -8.229569e-03 1 1  ON 18
 ud_9                 9.246291e-02 1 1  ON 19
 eO_0                -7.892625e-01 1 1  ON 20
 eO_1                -4.676727e-01 1 1  ON 21
 eO_2                -5.564223e-02 1 1  ON 22
 eO_3                 2.073306e-01 1 1  ON 23
 eO_4                 3.123489e-01 1 1  ON 24
 eO_5                 3.338879e-01 1 1  ON 25
 eO_6                 2.676274e-01 1 1  ON 26
 eO_7                 1.298043e-01 1 1  ON 27
 eO_8                 3.111883e-02 1 1  ON 28
 eO_9                 1.924288e-02 1 1  ON 29
eH1_0                -1.844779e-01 1 1  ON 30
eH1_1                -1.056864e-01 1 1  ON 31
eH1_2                -6.401952e-02 1 1  ON 32
eH1_3                -2.669514e-02 1 1  ON 33
eH1_4                 1.879166e-02 1 1  ON 34
eH1_5                 3.146824e-02 1 1  ON 35
eH1_6                 7.770974e-02 1 1  ON 36
eH1_7                 1.090691e-01 1 1  ON 37
eH1_8                 1.002824e-01 1 1  ON 38
eH1_9                 2.728881e-02 1 1  ON 39
eH2_0                -1.851370e-01 1 1  ON 40
eH2_1                -1.062685e-01 1 1  ON 41
eH2_2                -6.452737e-02 1 1  ON 42
eH2_3                -2.738050e-02 1 1  ON 43
eH2_4                 1.762961e-02 1 1  ON 44
eH2_5                 3.022028e-02 1 1  ON 45
eH2_6                 7.594285e-02 1 1  ON 46
eH2_7                 1.132104e-01 1 1  ON 47
eH2_8                 1.041120e-01 1 1  ON 48
eH2_9                 2.922392e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1696
    reference variance = 0.201726
====================================================
  Execution time = 2.0290e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2247e-01
  Total weights = 2.0000e+06
  Execution time = 1.8984e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322526278866
                                         uncertainty =       0.005049528005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322526278866
                                         uncertainty =       0.005049528005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401533012
  error estimate for blocks of size 2^( 2) =       0.000411014270
  error estimate for blocks of size 2^( 3) =       0.000419946339
  error estimate for blocks of size 2^( 4) =       0.000426350347
  error estimate for blocks of size 2^( 5) =       0.000430879017
  error estimate for blocks of size 2^( 6) =       0.000430834268
  error estimate for blocks of size 2^( 7) =       0.000430346636

      target function =                  N/A
              le_mean =     -17.217159418484
             les_mean =     296.753035800350
             stat err =       0.000429602567
             autocorr =       1.144698784119
              std dev =       0.567853431873
             le_variance =       0.322457520090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322576681471
                                         uncertainty =       0.005049676726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322576681471
                                         uncertainty =       0.005049676726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401564384
  error estimate for blocks of size 2^( 2) =       0.000411043349
  error estimate for blocks of size 2^( 3) =       0.000419973694
  error estimate for blocks of size 2^( 4) =       0.000426376601
  error estimate for blocks of size 2^( 5) =       0.000430904617
  error estimate for blocks of size 2^( 6) =       0.000430859448
  error estimate for blocks of size 2^( 7) =       0.000430371891

      target function =                  N/A
              le_mean =     -17.217159415248
             les_mean =     296.753086078189
             stat err =       0.000429628139
             autocorr =       1.144656193626
              std dev =       0.567897798361
             le_variance =       0.322507909384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322551925591
                                         uncertainty =       0.005049590386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322551925591
                                         uncertainty =       0.005049590386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401548976
  error estimate for blocks of size 2^( 2) =       0.000411029048
  error estimate for blocks of size 2^( 3) =       0.000419960229
  error estimate for blocks of size 2^( 4) =       0.000426363677
  error estimate for blocks of size 2^( 5) =       0.000430892011
  error estimate for blocks of size 2^( 6) =       0.000430847023
  error estimate for blocks of size 2^( 7) =       0.000430359431

      target function =                  N/A
              le_mean =     -17.217159417259
             les_mean =     296.753061398145
             stat err =       0.000429615535
             autocorr =       1.144676876462
              std dev =       0.567876007662
             le_variance =       0.322483160078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322529494988
                                         uncertainty =       0.005049535362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322529494988
                                         uncertainty =       0.005049535362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401535014
  error estimate for blocks of size 2^( 2) =       0.000411016122
  error estimate for blocks of size 2^( 3) =       0.000419948080
  error estimate for blocks of size 2^( 4) =       0.000426352017
  error estimate for blocks of size 2^( 5) =       0.000430880645
  error estimate for blocks of size 2^( 6) =       0.000430835865
  error estimate for blocks of size 2^( 7) =       0.000430348238

      target function =                  N/A
              le_mean =     -17.217159417992
             les_mean =     296.753038998692
             stat err =       0.000429604191
             autocorr =       1.144696025142
              std dev =       0.567856262946
             le_variance =       0.322460735367


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217159418484        initial  <--
     6.2500e+00     6.2500e+01             9.9999e-05       -17.217159415248
     2.5000e+01     2.5000e+02             2.5514e-05       -17.217159417259
     1.0000e+02     1.0000e+03             6.4123e-06       -17.217159417992

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8635
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278171e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227021e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565519e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6108e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2906
    reference variance = 0.282169
====================================================
  Execution time = 2.0473e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2231e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5536e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322431756023
                                         uncertainty =       0.004586668567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322431756023
                                         uncertainty =       0.004586668567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401442086
  error estimate for blocks of size 2^( 2) =       0.000410914262
  error estimate for blocks of size 2^( 3) =       0.000419496443
  error estimate for blocks of size 2^( 4) =       0.000426092629
  error estimate for blocks of size 2^( 5) =       0.000430310036
  error estimate for blocks of size 2^( 6) =       0.000432194402
  error estimate for blocks of size 2^( 7) =       0.000432629737

      target function =                  N/A
              le_mean =     -17.215896679638
             les_mean =     296.709409819656
             stat err =       0.000430306701
             autocorr =       1.148974570075
              std dev =       0.567724842535
             le_variance =       0.322311496831


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721589667964e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215896679638       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215896698192       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215896714604       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215896718445       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215896722438       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215896716891       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215896718707       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215896721493       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 8.447525e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215896679638       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215896684289       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215896688419       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215896689383       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215896690387       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215896688991       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215896689448       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215896690135       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 2.114241e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215896679638       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215896680802       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215896681836       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215896682077       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215896682329       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215896681979       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215896682094       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215896682264       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 5.287087e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.356716 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6036e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.156929e-01 1 1  ON 0
 uu_1                 5.262075e-02 1 1  ON 1
 uu_2                -4.278192e-02 1 1  ON 2
 uu_3                -9.884289e-02 1 1  ON 3
 uu_4                -1.337054e-01 1 1  ON 4
 uu_5                -1.423942e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137646e-02 1 1  ON 7
 uu_8                 9.089091e-02 1 1  ON 8
 uu_9                 1.284474e-01 1 1  ON 9
 ud_0                 3.554905e-01 1 1  ON 10
 ud_1                 9.681299e-02 1 1  ON 11
 ud_2                -1.286693e-02 1 1  ON 12
 ud_3                -7.434740e-02 1 1  ON 13
 ud_4                -1.230098e-01 1 1  ON 14
 ud_5                -1.556257e-01 1 1  ON 15
 ud_6                -1.583005e-01 1 1  ON 16
 ud_7                -1.120635e-01 1 1  ON 17
 ud_8                -8.227370e-03 1 1  ON 18
 ud_9                 9.246260e-02 1 1  ON 19
 eO_0                -7.892391e-01 1 1  ON 20
 eO_1                -4.676671e-01 1 1  ON 21
 eO_2                -5.565375e-02 1 1  ON 22
 eO_3                 2.073250e-01 1 1  ON 23
 eO_4                 3.123491e-01 1 1  ON 24
 eO_5                 3.338856e-01 1 1  ON 25
 eO_6                 2.676237e-01 1 1  ON 26
 eO_7                 1.297997e-01 1 1  ON 27
 eO_8                 3.111776e-02 1 1  ON 28
 eO_9                 1.924252e-02 1 1  ON 29
eH1_0                -1.844739e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402045e-02 1 1  ON 32
eH1_3                -2.669389e-02 1 1  ON 33
eH1_4                 1.879037e-02 1 1  ON 34
eH1_5                 3.146880e-02 1 1  ON 35
eH1_6                 7.771117e-02 1 1  ON 36
eH1_7                 1.090683e-01 1 1  ON 37
eH1_8                 1.002800e-01 1 1  ON 38
eH1_9                 2.728799e-02 1 1  ON 39
eH2_0                -1.851350e-01 1 1  ON 40
eH2_1                -1.062663e-01 1 1  ON 41
eH2_2                -6.452720e-02 1 1  ON 42
eH2_3                -2.738212e-02 1 1  ON 43
eH2_4                 1.762663e-02 1 1  ON 44
eH2_5                 3.021965e-02 1 1  ON 45
eH2_6                 7.594554e-02 1 1  ON 46
eH2_7                 1.132112e-01 1 1  ON 47
eH2_8                 1.041103e-01 1 1  ON 48
eH2_9                 2.922325e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2104
    reference variance = 0.222556
====================================================
  Execution time = 2.0377e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0914e-01
  Total weights = 2.0000e+06
  Execution time = 1.9014e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309088708683
                                         uncertainty =       0.002244397494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309088708683
                                         uncertainty =       0.002244397494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393153273
  error estimate for blocks of size 2^( 2) =       0.000403260355
  error estimate for blocks of size 2^( 3) =       0.000411850512
  error estimate for blocks of size 2^( 4) =       0.000418589635
  error estimate for blocks of size 2^( 5) =       0.000422087807
  error estimate for blocks of size 2^( 6) =       0.000425120330
  error estimate for blocks of size 2^( 7) =       0.000427359779

      target function =                  N/A
              le_mean =     -17.217071018131
             les_mean =     296.736673281502
             stat err =       0.000423289388
             autocorr =       1.159180238817
              std dev =       0.556002691261
             le_variance =       0.309138992690

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309096570107
                                         uncertainty =       0.002244452671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309096570107
                                         uncertainty =       0.002244452671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393158275
  error estimate for blocks of size 2^( 2) =       0.000403265094
  error estimate for blocks of size 2^( 3) =       0.000411854924
  error estimate for blocks of size 2^( 4) =       0.000418593815
  error estimate for blocks of size 2^( 5) =       0.000422091717
  error estimate for blocks of size 2^( 6) =       0.000425124233
  error estimate for blocks of size 2^( 7) =       0.000427363738

      target function =                  N/A
              le_mean =     -17.217071004331
             les_mean =     296.736680672228
             stat err =       0.000423293376
             autocorr =       1.159172588538
              std dev =       0.556009764862
             le_variance =       0.309146858622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309092653030
                                         uncertainty =       0.002244425173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309092653030
                                         uncertainty =       0.002244425173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393155783
  error estimate for blocks of size 2^( 2) =       0.000403262733
  error estimate for blocks of size 2^( 3) =       0.000411852725
  error estimate for blocks of size 2^( 4) =       0.000418591732
  error estimate for blocks of size 2^( 5) =       0.000422089768
  error estimate for blocks of size 2^( 6) =       0.000425122288
  error estimate for blocks of size 2^( 7) =       0.000427361765

      target function =                  N/A
              le_mean =     -17.217071011154
             les_mean =     296.736676987862
             stat err =       0.000423291388
             autocorr =       1.159176398560
              std dev =       0.556006240343
             le_variance =       0.309142939300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309089202125
                                         uncertainty =       0.002244400957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309089202125
                                         uncertainty =       0.002244400957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393153587
  error estimate for blocks of size 2^( 2) =       0.000403260652
  error estimate for blocks of size 2^( 3) =       0.000411850789
  error estimate for blocks of size 2^( 4) =       0.000418589898
  error estimate for blocks of size 2^( 5) =       0.000422088052
  error estimate for blocks of size 2^( 6) =       0.000425120575
  error estimate for blocks of size 2^( 7) =       0.000427360027

      target function =                  N/A
              le_mean =     -17.217071017253
             les_mean =     296.736673744982
             stat err =       0.000423289638
             autocorr =       1.159179758297
              std dev =       0.556003135256
             le_variance =       0.309139486414


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217071018131        initial  <--
     6.2500e+01     6.2500e+02             8.4475e-06       -17.217071004331
     2.5000e+02     2.5000e+03             2.1142e-06       -17.217071011154
     1.0000e+03     1.0000e+04             5.2871e-07       -17.217071017253

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9670
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278171e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227021e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565519e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6114e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1225
    reference variance = 0.328636
====================================================
  Execution time = 2.0649e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2836e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5553e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328301906381
                                         uncertainty =       0.007813034567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328301906381
                                         uncertainty =       0.007813034567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405191921
  error estimate for blocks of size 2^( 2) =       0.000415202615
  error estimate for blocks of size 2^( 3) =       0.000424217589
  error estimate for blocks of size 2^( 4) =       0.000431441031
  error estimate for blocks of size 2^( 5) =       0.000435288093
  error estimate for blocks of size 2^( 6) =       0.000437773086
  error estimate for blocks of size 2^( 7) =       0.000439768414

      target function =                  N/A
              le_mean =     -17.216728145862
             les_mean =     296.744088870381
             stat err =       0.000436067656
             autocorr =       1.158207026345
              std dev =       0.573027910340
             le_variance =       0.328360986029


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721672814586e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216728145862       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216728147718       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216728147441       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216728147952       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216728148701       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216728148722       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216728148591       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216728148421       residual = 1.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 8.624258e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216728145862       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216728146327       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216728146257       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216728146385       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216728146572       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216728146577       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216728146543       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216728146501       residual = 1.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 2.156491e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216728145862       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216728145978       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216728145961       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216728145993       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216728146040       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216728146040       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216728146040       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216728146024       residual = 1.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+04 is 5.391496e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.359353 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6215e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262024e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884288e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137653e-02 1 1  ON 7
 uu_8                 9.089110e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554888e-01 1 1  ON 10
 ud_1                 9.681223e-02 1 1  ON 11
 ud_2                -1.286586e-02 1 1  ON 12
 ud_3                -7.434685e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227059e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892372e-01 1 1  ON 20
 eO_1                -4.676658e-01 1 1  ON 21
 eO_2                -5.565510e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123493e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676232e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111770e-02 1 1  ON 28
 eO_9                 1.924251e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056871e-01 1 1  ON 31
eH1_2                -6.402027e-02 1 1  ON 32
eH1_3                -2.669407e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146871e-02 1 1  ON 35
eH1_6                 7.771131e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002797e-01 1 1  ON 38
eH1_9                 2.728792e-02 1 1  ON 39
eH2_0                -1.851348e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452699e-02 1 1  ON 42
eH2_3                -2.738207e-02 1 1  ON 43
eH2_4                 1.762631e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594589e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922317e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1718
    reference variance = 0.145073
====================================================
  Execution time = 2.2430e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4499e-01
  Total weights = 2.0000e+06
  Execution time = 1.8731e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345048212002
                                         uncertainty =       0.028028581812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345048212002
                                         uncertainty =       0.028028581812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415324484
  error estimate for blocks of size 2^( 2) =       0.000424639866
  error estimate for blocks of size 2^( 3) =       0.000433341689
  error estimate for blocks of size 2^( 4) =       0.000440116439
  error estimate for blocks of size 2^( 5) =       0.000443572203
  error estimate for blocks of size 2^( 6) =       0.000445999150
  error estimate for blocks of size 2^( 7) =       0.000447081178

      target function =                  N/A
              le_mean =     -17.216948021102
             les_mean =     296.768287842320
             stat err =       0.000444192243
             autocorr =       1.143844192837
              std dev =       0.587357517595
             le_variance =       0.344988853475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345048607616
                                         uncertainty =       0.028028651116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345048607616
                                         uncertainty =       0.028028651116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415324722
  error estimate for blocks of size 2^( 2) =       0.000424640088
  error estimate for blocks of size 2^( 3) =       0.000433341898
  error estimate for blocks of size 2^( 4) =       0.000440116639
  error estimate for blocks of size 2^( 5) =       0.000443572397
  error estimate for blocks of size 2^( 6) =       0.000445999334
  error estimate for blocks of size 2^( 7) =       0.000447081356

      target function =                  N/A
              le_mean =     -17.216948020239
             les_mean =     296.768288208204
             stat err =       0.000444192431
             autocorr =       1.143843854411
              std dev =       0.587357854355
             le_variance =       0.344989249072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345048409808
                                         uncertainty =       0.028028616468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345048409808
                                         uncertainty =       0.028028616468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415324603
  error estimate for blocks of size 2^( 2) =       0.000424639977
  error estimate for blocks of size 2^( 3) =       0.000433341793
  error estimate for blocks of size 2^( 4) =       0.000440116539
  error estimate for blocks of size 2^( 5) =       0.000443572300
  error estimate for blocks of size 2^( 6) =       0.000445999242
  error estimate for blocks of size 2^( 7) =       0.000447081267

      target function =                  N/A
              le_mean =     -17.216948020670
             les_mean =     296.768288025246
             stat err =       0.000444192337
             autocorr =       1.143844023598
              std dev =       0.587357685974
             le_variance =       0.344989051273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345048236728
                                         uncertainty =       0.028028586144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345048236728
                                         uncertainty =       0.028028586144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415324499
  error estimate for blocks of size 2^( 2) =       0.000424639880
  error estimate for blocks of size 2^( 3) =       0.000433341702
  error estimate for blocks of size 2^( 4) =       0.000440116452
  error estimate for blocks of size 2^( 5) =       0.000443572215
  error estimate for blocks of size 2^( 6) =       0.000445999161
  error estimate for blocks of size 2^( 7) =       0.000447081189

      target function =                  N/A
              le_mean =     -17.216948021048
             les_mean =     296.768287865184
             stat err =       0.000444192254
             autocorr =       1.143844171674
              std dev =       0.587357538642
             le_variance =       0.344988878200


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216948021102        initial  <--
     6.2500e+02     6.2500e+03             8.6243e-07       -17.216948020239
     2.5000e+03     2.5000e+04             2.1565e-07       -17.216948020670
     1.0000e+04     1.0000e+05             5.3915e-08       -17.216948021048

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.8679
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278171e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227021e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565519e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9036e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2023
    reference variance = 0.172493
====================================================
  Execution time = 6.5595e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1403e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5638e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314032026917
                                         uncertainty =       0.003182917021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314032026917
                                         uncertainty =       0.003182917021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396254248
  error estimate for blocks of size 2^( 2) =       0.000406057773
  error estimate for blocks of size 2^( 3) =       0.000415335495
  error estimate for blocks of size 2^( 4) =       0.000421824250
  error estimate for blocks of size 2^( 5) =       0.000425776908
  error estimate for blocks of size 2^( 6) =       0.000428241494
  error estimate for blocks of size 2^( 7) =       0.000429962444

      target function =                  N/A
              le_mean =     -17.216838055752
             les_mean =     296.733547338559
             stat err =       0.000426451274
             autocorr =       1.158219762236
              std dev =       0.560388131203
             le_variance =       0.314034857593


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721683805575e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216838055752       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216838055848       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216838056038       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216838056377       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216838056437       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216838056435       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216838056447       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216838056445       residual = 2.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 8.600916e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216838055752       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216838055776       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216838055823       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216838055908       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216838055929       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216838055919       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216838055933       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216838055933       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+04 is 2.150269e-08

solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216838055752       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216838055758       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216838055770       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216838055791       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216838055801       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216838055780       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216838055783       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216838055764       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+05 is 5.375697e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.362031 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 7.1170e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262019e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554888e-01 1 1  ON 10
 ud_1                 9.681214e-02 1 1  ON 11
 ud_2                -1.286581e-02 1 1  ON 12
 ud_3                -7.434679e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227025e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892371e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565517e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111770e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146873e-02 1 1  ON 35
eH1_6                 7.771134e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2416
    reference variance = 0.185749
====================================================
  Execution time = 2.1367e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1991e-01
  Total weights = 2.0000e+06
  Execution time = 1.8629e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319956782821
                                         uncertainty =       0.004449285201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319956782821
                                         uncertainty =       0.004449285201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399946643
  error estimate for blocks of size 2^( 2) =       0.000409508967
  error estimate for blocks of size 2^( 3) =       0.000418361661
  error estimate for blocks of size 2^( 4) =       0.000424885484
  error estimate for blocks of size 2^( 5) =       0.000428535989
  error estimate for blocks of size 2^( 6) =       0.000430795718
  error estimate for blocks of size 2^( 7) =       0.000431738661

      target function =                  N/A
              le_mean =     -17.216498444198
             les_mean =     296.727733154148
             stat err =       0.000428988963
             autocorr =       1.150503980832
              std dev =       0.565609967243
             le_variance =       0.319914635045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319956845392
                                         uncertainty =       0.004449285508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319956845392
                                         uncertainty =       0.004449285508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399946682
  error estimate for blocks of size 2^( 2) =       0.000409509003
  error estimate for blocks of size 2^( 3) =       0.000418361694
  error estimate for blocks of size 2^( 4) =       0.000424885517
  error estimate for blocks of size 2^( 5) =       0.000428536021
  error estimate for blocks of size 2^( 6) =       0.000430795750
  error estimate for blocks of size 2^( 7) =       0.000431738692

      target function =                  N/A
              le_mean =     -17.216498444053
             les_mean =     296.727733211684
             stat err =       0.000428988995
             autocorr =       1.150503925814
              std dev =       0.565610022518
             le_variance =       0.319914697573

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319956814107
                                         uncertainty =       0.004449285354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319956814107
                                         uncertainty =       0.004449285354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399946663
  error estimate for blocks of size 2^( 2) =       0.000409508985
  error estimate for blocks of size 2^( 3) =       0.000418361677
  error estimate for blocks of size 2^( 4) =       0.000424885500
  error estimate for blocks of size 2^( 5) =       0.000428536005
  error estimate for blocks of size 2^( 6) =       0.000430795734
  error estimate for blocks of size 2^( 7) =       0.000431738676

      target function =                  N/A
              le_mean =     -17.216498444125
             les_mean =     296.727733182916
             stat err =       0.000428988979
             autocorr =       1.150503953318
              std dev =       0.565609994882
             le_variance =       0.319914666310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319956786731
                                         uncertainty =       0.004449285220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319956786731
                                         uncertainty =       0.004449285220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399946646
  error estimate for blocks of size 2^( 2) =       0.000409508969
  error estimate for blocks of size 2^( 3) =       0.000418361663
  error estimate for blocks of size 2^( 4) =       0.000424885486
  error estimate for blocks of size 2^( 5) =       0.000428535991
  error estimate for blocks of size 2^( 6) =       0.000430795720
  error estimate for blocks of size 2^( 7) =       0.000431738663

      target function =                  N/A
              le_mean =     -17.216498444189
             les_mean =     296.727733157744
             stat err =       0.000428988965
             autocorr =       1.150503977392
              std dev =       0.565609970698
             le_variance =       0.319914638953


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216498444198        initial  <--
     6.2500e+03     6.2500e+04             8.6009e-08       -17.216498444053
     2.5000e+04     2.5000e+05             2.1503e-08       -17.216498444125
     1.0000e+05     1.0000e+06             5.3757e-09       -17.216498444189

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7649
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278171e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227021e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565519e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0267e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.228
    reference variance = 0.153073
====================================================
  Execution time = 2.1205e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2088e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5952e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320962990511
                                         uncertainty =       0.005740792942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320962990511
                                         uncertainty =       0.005740792942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400547204
  error estimate for blocks of size 2^( 2) =       0.000410069091
  error estimate for blocks of size 2^( 3) =       0.000419297978
  error estimate for blocks of size 2^( 4) =       0.000425450253
  error estimate for blocks of size 2^( 5) =       0.000429530782
  error estimate for blocks of size 2^( 6) =       0.000430977730
  error estimate for blocks of size 2^( 7) =       0.000434164750

      target function =                  N/A
              le_mean =     -17.217118751658
             les_mean =     296.750054072929
             stat err =       0.000430030879
             autocorr =       1.152635190899
              std dev =       0.566459287745
             le_variance =       0.320876124673


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721711875166e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217118751658       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217118751660       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217118751655       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217118751656       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217118751624       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217118751635       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217118751664       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217118751656       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 7.808531e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217118751658       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217118751658       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217118751657       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217118751583       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217118751616       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217118751747       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217118751671       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217118751682       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+05 is 1.952136e-09

solving harmonic davidson linear method for identity shift 1.0000e+06, overlap shift 1.0000e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217118751658       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217118751658       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217118751658       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217118751648       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217118750739       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217118755639       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217118750765       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217118751969       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+06 is 4.880336e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.368694 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6818e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227021e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2
    reference variance = 0.243547
====================================================
  Execution time = 2.1331e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1875e-01
  Total weights = 2.0000e+06
  Execution time = 1.8721e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318826462285
                                         uncertainty =       0.005408161008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318826462285
                                         uncertainty =       0.005408161008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399219823
  error estimate for blocks of size 2^( 2) =       0.000408528462
  error estimate for blocks of size 2^( 3) =       0.000417024476
  error estimate for blocks of size 2^( 4) =       0.000423673726
  error estimate for blocks of size 2^( 5) =       0.000428005597
  error estimate for blocks of size 2^( 6) =       0.000429827864
  error estimate for blocks of size 2^( 7) =       0.000432306724

      target function =                  N/A
              le_mean =     -17.217290169650
             les_mean =     296.753833560540
             stat err =       0.000428453478
             autocorr =       1.151816112356
              std dev =       0.564582087910
             le_variance =       0.318752933989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318826467726
                                         uncertainty =       0.005408160971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318826467726
                                         uncertainty =       0.005408160971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399219826
  error estimate for blocks of size 2^( 2) =       0.000408528465
  error estimate for blocks of size 2^( 3) =       0.000417024479
  error estimate for blocks of size 2^( 4) =       0.000423673728
  error estimate for blocks of size 2^( 5) =       0.000428005600
  error estimate for blocks of size 2^( 6) =       0.000429827866
  error estimate for blocks of size 2^( 7) =       0.000432306727

      target function =                  N/A
              le_mean =     -17.217290169647
             les_mean =     296.753833565881
             stat err =       0.000428453480
             autocorr =       1.151816106776
              std dev =       0.564582092728
             le_variance =       0.318752939430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318826465006
                                         uncertainty =       0.005408160989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318826465006
                                         uncertainty =       0.005408160989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399219825
  error estimate for blocks of size 2^( 2) =       0.000408528464
  error estimate for blocks of size 2^( 3) =       0.000417024477
  error estimate for blocks of size 2^( 4) =       0.000423673727
  error estimate for blocks of size 2^( 5) =       0.000428005599
  error estimate for blocks of size 2^( 6) =       0.000429827865
  error estimate for blocks of size 2^( 7) =       0.000432306726

      target function =                  N/A
              le_mean =     -17.217290169649
             les_mean =     296.753833563210
             stat err =       0.000428453479
             autocorr =       1.151816109570
              std dev =       0.564582090319
             le_variance =       0.318752936709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318826462625
                                         uncertainty =       0.005408161006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318826462625
                                         uncertainty =       0.005408161006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399219823
  error estimate for blocks of size 2^( 2) =       0.000408528462
  error estimate for blocks of size 2^( 3) =       0.000417024476
  error estimate for blocks of size 2^( 4) =       0.000423673726
  error estimate for blocks of size 2^( 5) =       0.000428005598
  error estimate for blocks of size 2^( 6) =       0.000429827864
  error estimate for blocks of size 2^( 7) =       0.000432306724

      target function =                  N/A
              le_mean =     -17.217290169650
             les_mean =     296.753833560873
             stat err =       0.000428453478
             autocorr =       1.151816112003
              std dev =       0.564582088211
             le_variance =       0.318752934329


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217290169650        initial  <--
     6.2500e+04     6.2500e+05             7.8085e-09       -17.217290169647
     2.5000e+05     2.5000e+06             1.9521e-09       -17.217290169649
     1.0000e+06     1.0000e+07             4.8803e-10       -17.217290169650

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8095
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278171e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227021e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565519e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7904e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1757
    reference variance = 0.189718
====================================================
  Execution time = 2.1135e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1297e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5368e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312973105957
                                         uncertainty =       0.002852476850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312973105957
                                         uncertainty =       0.002852476850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395582721
  error estimate for blocks of size 2^( 2) =       0.000405272797
  error estimate for blocks of size 2^( 3) =       0.000414275400
  error estimate for blocks of size 2^( 4) =       0.000420107691
  error estimate for blocks of size 2^( 5) =       0.000423445942
  error estimate for blocks of size 2^( 6) =       0.000426496586
  error estimate for blocks of size 2^( 7) =       0.000428223624

      target function =                  N/A
              le_mean =     -17.217372891214
             les_mean =     296.750900496274
             stat err =       0.000424568461
             autocorr =       1.151916058937
              std dev =       0.559438448486
             le_variance =       0.312971377645


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721737289121e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217372891214       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217372891214       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217372891213       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217372891188       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217372891792       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217372890839       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217372891436       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217372891290       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 9.352188e-10

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217372891214       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217372891214       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217372891214       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217372891214       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217372890480       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217372891169       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217372891944       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217372891605       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+06 is 2.338048e-10

solving harmonic davidson linear method for identity shift 1.0000e+07, overlap shift 1.0000e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217372891214       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217372891214       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217372891214       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217372891214       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217372891214       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217372895661       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217372913883       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217372889517       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+07 is 5.845052e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.371290 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6682e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227021e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565519e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1622
    reference variance = 0.198293
====================================================
  Execution time = 2.0258e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2525e-01
  Total weights = 2.0000e+06
  Execution time = 1.8637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325020013828
                                         uncertainty =       0.004743895535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325020013828
                                         uncertainty =       0.004743895535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403266277
  error estimate for blocks of size 2^( 2) =       0.000413246401
  error estimate for blocks of size 2^( 3) =       0.000422222157
  error estimate for blocks of size 2^( 4) =       0.000428972041
  error estimate for blocks of size 2^( 5) =       0.000433484540
  error estimate for blocks of size 2^( 6) =       0.000436515268
  error estimate for blocks of size 2^( 7) =       0.000439580179

      target function =                  N/A
              le_mean =     -17.216479973069
             les_mean =     296.732429880997
             stat err =       0.000434638007
             autocorr =       1.161640082945
              std dev =       0.570304638348
             le_variance =       0.325247380521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325020014546
                                         uncertainty =       0.004743895554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325020014546
                                         uncertainty =       0.004743895554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403266278
  error estimate for blocks of size 2^( 2) =       0.000413246402
  error estimate for blocks of size 2^( 3) =       0.000422222157
  error estimate for blocks of size 2^( 4) =       0.000428972042
  error estimate for blocks of size 2^( 5) =       0.000433484540
  error estimate for blocks of size 2^( 6) =       0.000436515268
  error estimate for blocks of size 2^( 7) =       0.000439580179

      target function =                  N/A
              le_mean =     -17.216479973073
             les_mean =     296.732429881849
             stat err =       0.000434638007
             autocorr =       1.161640082345
              std dev =       0.570304638978
             le_variance =       0.325247381240

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325020014187
                                         uncertainty =       0.004743895544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325020014187
                                         uncertainty =       0.004743895544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403266277
  error estimate for blocks of size 2^( 2) =       0.000413246401
  error estimate for blocks of size 2^( 3) =       0.000422222157
  error estimate for blocks of size 2^( 4) =       0.000428972041
  error estimate for blocks of size 2^( 5) =       0.000433484540
  error estimate for blocks of size 2^( 6) =       0.000436515268
  error estimate for blocks of size 2^( 7) =       0.000439580179

      target function =                  N/A
              le_mean =     -17.216479973071
             les_mean =     296.732429881423
             stat err =       0.000434638007
             autocorr =       1.161640082644
              std dev =       0.570304638663
             le_variance =       0.325247380881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325020013873
                                         uncertainty =       0.004743895536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325020013873
                                         uncertainty =       0.004743895536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403266277
  error estimate for blocks of size 2^( 2) =       0.000413246401
  error estimate for blocks of size 2^( 3) =       0.000422222157
  error estimate for blocks of size 2^( 4) =       0.000428972041
  error estimate for blocks of size 2^( 5) =       0.000433484540
  error estimate for blocks of size 2^( 6) =       0.000436515268
  error estimate for blocks of size 2^( 7) =       0.000439580179

      target function =                  N/A
              le_mean =     -17.216479973070
             les_mean =     296.732429881050
             stat err =       0.000434638007
             autocorr =       1.161640082911
              std dev =       0.570304638387
             le_variance =       0.325247380566


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216479973069        initial
     6.2500e+05     6.2500e+06             9.3522e-10       -17.216479973073  <--
     2.5000e+06     2.5000e+07             2.3380e-10       -17.216479973071
     1.0000e+07     1.0000e+08             5.8451e-11       -17.216479973070

*****************************************************************************
Applying the update for shift_i =   6.2500e+05     and shift_s =   6.2500e+06
*****************************************************************************

  Execution time = 2.9689e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227021e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565519e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6503e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2068
    reference variance = 0.227381
====================================================
  Execution time = 2.1000e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1734e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6835e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317378270737
                                         uncertainty =       0.003106462031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317378270737
                                         uncertainty =       0.003106462031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398335687
  error estimate for blocks of size 2^( 2) =       0.000408254133
  error estimate for blocks of size 2^( 3) =       0.000416629306
  error estimate for blocks of size 2^( 4) =       0.000423186940
  error estimate for blocks of size 2^( 5) =       0.000428056179
  error estimate for blocks of size 2^( 6) =       0.000431147124
  error estimate for blocks of size 2^( 7) =       0.000431375213

      target function =                  N/A
              le_mean =     -17.216993332736
             les_mean =     296.742201900532
             stat err =       0.000428441364
             autocorr =       1.156869447872
              std dev =       0.563331731507
             le_variance =       0.317342639722


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721699333274e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216993332736       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216993332748       residual = 8.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216993332749       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216993332783       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216993332642       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216993332739       residual = 9.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216993332982       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216993332669       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 3.222841e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216993332736       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216993332739       residual = 8.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216993332739       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216993332352       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216993333673       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216993333137       residual = 9.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216993332411       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216993332650       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 8.057107e-10

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216993332736       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216993332737       residual = 8.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216993332737       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216993332737       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216993332538       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216993333753       residual = 9.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216993332202       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216993329856       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+06 is 2.014278e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.373894 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6695e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227021e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1886
    reference variance = 0.280581
====================================================
  Execution time = 2.0255e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2515e-01
  Total weights = 2.0000e+06
  Execution time = 1.8698e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325156750538
                                         uncertainty =       0.006065356216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325156750538
                                         uncertainty =       0.006065356216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403206349
  error estimate for blocks of size 2^( 2) =       0.000412831693
  error estimate for blocks of size 2^( 3) =       0.000421548191
  error estimate for blocks of size 2^( 4) =       0.000427614218
  error estimate for blocks of size 2^( 5) =       0.000432110377
  error estimate for blocks of size 2^( 6) =       0.000433891246
  error estimate for blocks of size 2^( 7) =       0.000434482695

      target function =                  N/A
              le_mean =     -17.216711859923
             les_mean =     296.740317824780
             stat err =       0.000432024634
             autocorr =       1.148053952816
              std dev =       0.570219887177
             le_variance =       0.325150719733

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325156752813
                                         uncertainty =       0.006065356261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325156752813
                                         uncertainty =       0.006065356261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403206350
  error estimate for blocks of size 2^( 2) =       0.000412831694
  error estimate for blocks of size 2^( 3) =       0.000421548192
  error estimate for blocks of size 2^( 4) =       0.000427614220
  error estimate for blocks of size 2^( 5) =       0.000432110378
  error estimate for blocks of size 2^( 6) =       0.000433891247
  error estimate for blocks of size 2^( 7) =       0.000434482696

      target function =                  N/A
              le_mean =     -17.216711859936
             les_mean =     296.740317827507
             stat err =       0.000432024635
             autocorr =       1.148053950580
              std dev =       0.570219889172
             le_variance =       0.325150722007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325156751675
                                         uncertainty =       0.006065356238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325156751675
                                         uncertainty =       0.006065356238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403206350
  error estimate for blocks of size 2^( 2) =       0.000412831694
  error estimate for blocks of size 2^( 3) =       0.000421548191
  error estimate for blocks of size 2^( 4) =       0.000427614219
  error estimate for blocks of size 2^( 5) =       0.000432110378
  error estimate for blocks of size 2^( 6) =       0.000433891247
  error estimate for blocks of size 2^( 7) =       0.000434482695

      target function =                  N/A
              le_mean =     -17.216711859930
             les_mean =     296.740317826143
             stat err =       0.000432024635
             autocorr =       1.148053951694
              std dev =       0.570219888175
             le_variance =       0.325150720870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325156750680
                                         uncertainty =       0.006065356219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325156750680
                                         uncertainty =       0.006065356219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403206349
  error estimate for blocks of size 2^( 2) =       0.000412831693
  error estimate for blocks of size 2^( 3) =       0.000421548191
  error estimate for blocks of size 2^( 4) =       0.000427614219
  error estimate for blocks of size 2^( 5) =       0.000432110377
  error estimate for blocks of size 2^( 6) =       0.000433891246
  error estimate for blocks of size 2^( 7) =       0.000434482695

      target function =                  N/A
              le_mean =     -17.216711859924
             les_mean =     296.740317824950
             stat err =       0.000432024634
             autocorr =       1.148053952672
              std dev =       0.570219887302
             le_variance =       0.325150719875


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216711859923        initial
     1.5625e+05     1.5625e+06             3.2228e-09       -17.216711859936  <--
     6.2500e+05     6.2500e+06             8.0571e-10       -17.216711859930
     2.5000e+06     2.5000e+07             2.0143e-10       -17.216711859924

*****************************************************************************
Applying the update for shift_i =   1.5625e+05     and shift_s =   1.5625e+06
*****************************************************************************

  Execution time = 2.9687e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278171e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6576e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2451
    reference variance = 0.401257
====================================================
  Execution time = 2.0315e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2329e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5571e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323389923271
                                         uncertainty =       0.007896199659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323389923271
                                         uncertainty =       0.007896199659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402050531
  error estimate for blocks of size 2^( 2) =       0.000411787365
  error estimate for blocks of size 2^( 3) =       0.000420467108
  error estimate for blocks of size 2^( 4) =       0.000426510129
  error estimate for blocks of size 2^( 5) =       0.000430636740
  error estimate for blocks of size 2^( 6) =       0.000432967964
  error estimate for blocks of size 2^( 7) =       0.000432571198

      target function =                  N/A
              le_mean =     -17.216506523824
             les_mean =     296.731385982780
             stat err =       0.000430671508
             autocorr =       1.147442682190
              std dev =       0.568585314232
             le_variance =       0.323289259561


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650652382e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216506523824       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216506523813       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216506523853       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216506523907       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216506523873       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216506523895       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216506523855       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216506523911       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 1.674930e-08

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216506523824       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216506523821       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216506523831       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216506523799       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216506523831       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216506523800       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216506523823       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216506524043       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 4.187339e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216506523824       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216506523823       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216506523826       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216506523831       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216506523515       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216506523663       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216506523706       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216506522815       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 1.046836e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.376528 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5882e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2067
    reference variance = 0.502871
====================================================
  Execution time = 2.3148e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2295e-01
  Total weights = 2.0000e+06
  Execution time = 1.8722e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323010697064
                                         uncertainty =       0.010851334431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323010697064
                                         uncertainty =       0.010851334431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401842471
  error estimate for blocks of size 2^( 2) =       0.000411754458
  error estimate for blocks of size 2^( 3) =       0.000420358055
  error estimate for blocks of size 2^( 4) =       0.000426516066
  error estimate for blocks of size 2^( 5) =       0.000431103502
  error estimate for blocks of size 2^( 6) =       0.000432830491
  error estimate for blocks of size 2^( 7) =       0.000433318429

      target function =                  N/A
              le_mean =     -17.217106389829
             les_mean =     296.751707020297
             stat err =       0.000430942122
             autocorr =       1.150075151155
              std dev =       0.568291072510
             le_variance =       0.322954743095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323010709225
                                         uncertainty =       0.010851334942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323010709225
                                         uncertainty =       0.010851334942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401842479
  error estimate for blocks of size 2^( 2) =       0.000411754465
  error estimate for blocks of size 2^( 3) =       0.000420358061
  error estimate for blocks of size 2^( 4) =       0.000426516072
  error estimate for blocks of size 2^( 5) =       0.000431103508
  error estimate for blocks of size 2^( 6) =       0.000432830497
  error estimate for blocks of size 2^( 7) =       0.000433318435

      target function =                  N/A
              le_mean =     -17.217106389819
             les_mean =     296.751707032132
             stat err =       0.000430942128
             autocorr =       1.150075139774
              std dev =       0.568291083207
             le_variance =       0.322954755253

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323010703144
                                         uncertainty =       0.010851334687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323010703144
                                         uncertainty =       0.010851334687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401842475
  error estimate for blocks of size 2^( 2) =       0.000411754462
  error estimate for blocks of size 2^( 3) =       0.000420358058
  error estimate for blocks of size 2^( 4) =       0.000426516069
  error estimate for blocks of size 2^( 5) =       0.000431103505
  error estimate for blocks of size 2^( 6) =       0.000432830494
  error estimate for blocks of size 2^( 7) =       0.000433318432

      target function =                  N/A
              le_mean =     -17.217106389824
             les_mean =     296.751707026214
             stat err =       0.000430942125
             autocorr =       1.150075145470
              std dev =       0.568291077859
             le_variance =       0.322954749174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323010697824
                                         uncertainty =       0.010851334463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323010697824
                                         uncertainty =       0.010851334463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401842472
  error estimate for blocks of size 2^( 2) =       0.000411754458
  error estimate for blocks of size 2^( 3) =       0.000420358055
  error estimate for blocks of size 2^( 4) =       0.000426516066
  error estimate for blocks of size 2^( 5) =       0.000431103502
  error estimate for blocks of size 2^( 6) =       0.000432830492
  error estimate for blocks of size 2^( 7) =       0.000433318429

      target function =                  N/A
              le_mean =     -17.217106389828
             les_mean =     296.751707021037
             stat err =       0.000430942122
             autocorr =       1.150075150438
              std dev =       0.568291073179
             le_variance =       0.322954743855


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217106389829        initial  <--
     3.9062e+04     3.9062e+05             1.6749e-08       -17.217106389819
     1.5625e+05     1.5625e+06             4.1873e-09       -17.217106389824
     6.2500e+05     6.2500e+06             1.0468e-09       -17.217106389828

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.5911
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278171e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8802e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1938
    reference variance = 0.141927
====================================================
  Execution time = 2.0431e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1842e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5386e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318348441162
                                         uncertainty =       0.004691879080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318348441162
                                         uncertainty =       0.004691879080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399013733
  error estimate for blocks of size 2^( 2) =       0.000408909979
  error estimate for blocks of size 2^( 3) =       0.000417820030
  error estimate for blocks of size 2^( 4) =       0.000424714076
  error estimate for blocks of size 2^( 5) =       0.000428931878
  error estimate for blocks of size 2^( 6) =       0.000431680437
  error estimate for blocks of size 2^( 7) =       0.000433425133

      target function =                  N/A
              le_mean =     -17.216416761433
             les_mean =     296.723429862669
             stat err =       0.000429687881
             autocorr =       1.159659587580
              std dev =       0.564290633021
             le_variance =       0.318423918516


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721641676143e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216416761433       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216416761434       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216416761436       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216416761459       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216416761327       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216416761514       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216416761263       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216416761379       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 1.336667e-09

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216416761433       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216416761433       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216416761434       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216416761398       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216416761423       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216416761915       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216416760823       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216416763368       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 3.341670e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216416761433       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216416761433       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216416761434       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216416760010       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216416760108       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216416764351       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216416761687       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216416760195       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+06 is 8.354173e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.379149 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5980e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278171e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1938
    reference variance = 0.20626
====================================================
  Execution time = 2.0036e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1552e-01
  Total weights = 2.0000e+06
  Execution time = 1.8691e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315329953076
                                         uncertainty =       0.002670039455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315329953076
                                         uncertainty =       0.002670039455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397188782
  error estimate for blocks of size 2^( 2) =       0.000407413154
  error estimate for blocks of size 2^( 3) =       0.000416660628
  error estimate for blocks of size 2^( 4) =       0.000423191200
  error estimate for blocks of size 2^( 5) =       0.000427628938
  error estimate for blocks of size 2^( 6) =       0.000431196765
  error estimate for blocks of size 2^( 7) =       0.000432634221

      target function =                  N/A
              le_mean =     -17.216643414679
             les_mean =     296.728328167818
             stat err =       0.000428662781
             autocorr =       1.164763105606
              std dev =       0.561709762568
             le_variance =       0.315517857364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315329954230
                                         uncertainty =       0.002670039463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315329954230
                                         uncertainty =       0.002670039463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397188783
  error estimate for blocks of size 2^( 2) =       0.000407413154
  error estimate for blocks of size 2^( 3) =       0.000416660629
  error estimate for blocks of size 2^( 4) =       0.000423191201
  error estimate for blocks of size 2^( 5) =       0.000427628938
  error estimate for blocks of size 2^( 6) =       0.000431196766
  error estimate for blocks of size 2^( 7) =       0.000432634221

      target function =                  N/A
              le_mean =     -17.216643414680
             les_mean =     296.728328169013
             stat err =       0.000428662781
             autocorr =       1.164763104537
              std dev =       0.561709763595
             le_variance =       0.315517858518

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315329953653
                                         uncertainty =       0.002670039459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315329953653
                                         uncertainty =       0.002670039459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397188783
  error estimate for blocks of size 2^( 2) =       0.000407413154
  error estimate for blocks of size 2^( 3) =       0.000416660628
  error estimate for blocks of size 2^( 4) =       0.000423191200
  error estimate for blocks of size 2^( 5) =       0.000427628938
  error estimate for blocks of size 2^( 6) =       0.000431196766
  error estimate for blocks of size 2^( 7) =       0.000432634221

      target function =                  N/A
              le_mean =     -17.216643414680
             les_mean =     296.728328168415
             stat err =       0.000428662781
             autocorr =       1.164763105065
              std dev =       0.561709763081
             le_variance =       0.315517857941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315329953148
                                         uncertainty =       0.002670039455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315329953148
                                         uncertainty =       0.002670039455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397188782
  error estimate for blocks of size 2^( 2) =       0.000407413154
  error estimate for blocks of size 2^( 3) =       0.000416660628
  error estimate for blocks of size 2^( 4) =       0.000423191200
  error estimate for blocks of size 2^( 5) =       0.000427628938
  error estimate for blocks of size 2^( 6) =       0.000431196765
  error estimate for blocks of size 2^( 7) =       0.000432634221

      target function =                  N/A
              le_mean =     -17.216643414679
             les_mean =     296.728328167892
             stat err =       0.000428662781
             autocorr =       1.164763105537
              std dev =       0.561709762632
             le_variance =       0.315517857436


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216643414679        initial
     3.9062e+05     3.9062e+06             1.3367e-09       -17.216643414680  <--
     1.5625e+06     1.5625e+07             3.3417e-10       -17.216643414680
     6.2500e+06     6.2500e+07             8.3542e-11       -17.216643414679

*****************************************************************************
Applying the update for shift_i =   3.9062e+05     and shift_s =   3.9062e+06
*****************************************************************************

  Execution time = 2.9466e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278171e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5756e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2387
    reference variance = 0.253104
====================================================
  Execution time = 2.1491e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1916e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5059e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319165195763
                                         uncertainty =       0.004589361331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319165195763
                                         uncertainty =       0.004589361331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399474271
  error estimate for blocks of size 2^( 2) =       0.000409432473
  error estimate for blocks of size 2^( 3) =       0.000418856052
  error estimate for blocks of size 2^( 4) =       0.000424794859
  error estimate for blocks of size 2^( 5) =       0.000429249913
  error estimate for blocks of size 2^( 6) =       0.000431548314
  error estimate for blocks of size 2^( 7) =       0.000434000216

      target function =                  N/A
              le_mean =     -17.216607025808
             les_mean =     296.730716707500
             stat err =       0.000429898325
             autocorr =       1.158120852368
              std dev =       0.564941931496
             le_variance =       0.319159385963


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721660702581e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216607025808       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216607025799       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216607025794       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216607025798       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216607025833       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216607025719       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216607025788       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216607025875       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 5.097252e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216607025808       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216607025806       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216607025805       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216607025806       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216607025634       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216607025888       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216607025741       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216607025833       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 1.274314e-09

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216607025808       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216607025808       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216607025808       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216607025808       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216607026076       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216607023679       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216607026244       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216607027065       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 3.185786e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.381760 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7007e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278171e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.0947
    reference variance = 0.260758
====================================================
  Execution time = 2.0178e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2291e-01
  Total weights = 2.0000e+06
  Execution time = 1.8540e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322907581546
                                         uncertainty =       0.006081185250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322907581546
                                         uncertainty =       0.006081185250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401817477
  error estimate for blocks of size 2^( 2) =       0.000411425729
  error estimate for blocks of size 2^( 3) =       0.000420138085
  error estimate for blocks of size 2^( 4) =       0.000427085456
  error estimate for blocks of size 2^( 5) =       0.000431303758
  error estimate for blocks of size 2^( 6) =       0.000434186087
  error estimate for blocks of size 2^( 7) =       0.000435120774

      target function =                  N/A
              le_mean =     -17.216912492064
             les_mean =     296.744990166813
             stat err =       0.000431924019
             autocorr =       1.155465723588
              std dev =       0.568255724888
             le_variance =       0.322914568868

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322907585053
                                         uncertainty =       0.006081185287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322907585053
                                         uncertainty =       0.006081185287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401817479
  error estimate for blocks of size 2^( 2) =       0.000411425731
  error estimate for blocks of size 2^( 3) =       0.000420138087
  error estimate for blocks of size 2^( 4) =       0.000427085457
  error estimate for blocks of size 2^( 5) =       0.000431303760
  error estimate for blocks of size 2^( 6) =       0.000434186089
  error estimate for blocks of size 2^( 7) =       0.000435120776

      target function =                  N/A
              le_mean =     -17.216912492060
             les_mean =     296.744990170184
             stat err =       0.000431924021
             autocorr =       1.155465720426
              std dev =       0.568255727973
             le_variance =       0.322914572374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322907583300
                                         uncertainty =       0.006081185269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322907583300
                                         uncertainty =       0.006081185269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401817478
  error estimate for blocks of size 2^( 2) =       0.000411425730
  error estimate for blocks of size 2^( 3) =       0.000420138086
  error estimate for blocks of size 2^( 4) =       0.000427085457
  error estimate for blocks of size 2^( 5) =       0.000431303759
  error estimate for blocks of size 2^( 6) =       0.000434186088
  error estimate for blocks of size 2^( 7) =       0.000435120775

      target function =                  N/A
              le_mean =     -17.216912492062
             les_mean =     296.744990168498
             stat err =       0.000431924020
             autocorr =       1.155465722005
              std dev =       0.568255726430
             le_variance =       0.322914570620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322907581765
                                         uncertainty =       0.006081185252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322907581765
                                         uncertainty =       0.006081185252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401817477
  error estimate for blocks of size 2^( 2) =       0.000411425729
  error estimate for blocks of size 2^( 3) =       0.000420138086
  error estimate for blocks of size 2^( 4) =       0.000427085456
  error estimate for blocks of size 2^( 5) =       0.000431303758
  error estimate for blocks of size 2^( 6) =       0.000434186087
  error estimate for blocks of size 2^( 7) =       0.000435120774

      target function =                  N/A
              le_mean =     -17.216912492064
             les_mean =     296.744990167024
             stat err =       0.000431924019
             autocorr =       1.155465723386
              std dev =       0.568255725080
             le_variance =       0.322914569087


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216912492064        initial  <--
     9.7656e+04     9.7656e+05             5.0973e-09       -17.216912492060
     3.9062e+05     3.9062e+06             1.2743e-09       -17.216912492062
     1.5625e+06     1.5625e+07             3.1858e-10       -17.216912492064

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5369
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278171e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6681e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2724
    reference variance = 0.238122
====================================================
  Execution time = 2.1010e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2340e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5406e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323412131886
                                         uncertainty =       0.006914597694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323412131886
                                         uncertainty =       0.006914597694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402122010
  error estimate for blocks of size 2^( 2) =       0.000411702437
  error estimate for blocks of size 2^( 3) =       0.000420200561
  error estimate for blocks of size 2^( 4) =       0.000426483472
  error estimate for blocks of size 2^( 5) =       0.000429794698
  error estimate for blocks of size 2^( 6) =       0.000432683893
  error estimate for blocks of size 2^( 7) =       0.000436560027

      target function =                  N/A
              le_mean =     -17.216020260204
             les_mean =     296.714757660451
             stat err =       0.000431380522
             autocorr =       1.150814628913
              std dev =       0.568686400738
             le_variance =       0.323404222384


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721602026020e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216020260204       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216020260206       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216020260208       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216020260208       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216020260222       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216020260240       residual = 8.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216020260732       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216020261107       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 5.268501e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216020260204       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216020260205       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216020260205       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216020260185       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216020258739       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216020276912       residual = 8.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216020253980       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216020260213       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 1.317124e-10

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216020260204       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216020260205       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216020260205       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216020260205       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216020259160       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216020260249       residual = 8.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216020258807       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216020250980       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+07 is 3.292815e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.384363 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6561e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278171e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1478
    reference variance = 0.151148
====================================================
  Execution time = 1.9742e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.5288e-01
  Total weights = 2.0000e+06
  Execution time = 1.8623e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353015100567
                                         uncertainty =       0.033322518156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353015100567
                                         uncertainty =       0.033322518156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420049451
  error estimate for blocks of size 2^( 2) =       0.000429141958
  error estimate for blocks of size 2^( 3) =       0.000437318583
  error estimate for blocks of size 2^( 4) =       0.000443735949
  error estimate for blocks of size 2^( 5) =       0.000448204616
  error estimate for blocks of size 2^( 6) =       0.000451087097
  error estimate for blocks of size 2^( 7) =       0.000451367324

      target function =                  N/A
              le_mean =     -17.216927204891
             les_mean =     296.775465284501
             stat err =       0.000448598747
             autocorr =       1.140552469106
              std dev =       0.594039630340
             le_variance =       0.352883082415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353015100985
                                         uncertainty =       0.033322518205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353015100985
                                         uncertainty =       0.033322518205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420049451
  error estimate for blocks of size 2^( 2) =       0.000429141959
  error estimate for blocks of size 2^( 3) =       0.000437318583
  error estimate for blocks of size 2^( 4) =       0.000443735949
  error estimate for blocks of size 2^( 5) =       0.000448204616
  error estimate for blocks of size 2^( 6) =       0.000451087098
  error estimate for blocks of size 2^( 7) =       0.000451367325

      target function =                  N/A
              le_mean =     -17.216927204892
             les_mean =     296.775465284958
             stat err =       0.000448598747
             autocorr =       1.140552468821
              std dev =       0.594039630692
             le_variance =       0.352883082833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353015100776
                                         uncertainty =       0.033322518181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353015100776
                                         uncertainty =       0.033322518181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420049451
  error estimate for blocks of size 2^( 2) =       0.000429141959
  error estimate for blocks of size 2^( 3) =       0.000437318583
  error estimate for blocks of size 2^( 4) =       0.000443735949
  error estimate for blocks of size 2^( 5) =       0.000448204616
  error estimate for blocks of size 2^( 6) =       0.000451087097
  error estimate for blocks of size 2^( 7) =       0.000451367324

      target function =                  N/A
              le_mean =     -17.216927204892
             les_mean =     296.775465284729
             stat err =       0.000448598747
             autocorr =       1.140552468956
              std dev =       0.594039630517
             le_variance =       0.352883082624

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353015100593
                                         uncertainty =       0.033322518159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353015100593
                                         uncertainty =       0.033322518159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420049451
  error estimate for blocks of size 2^( 2) =       0.000429141958
  error estimate for blocks of size 2^( 3) =       0.000437318583
  error estimate for blocks of size 2^( 4) =       0.000443735949
  error estimate for blocks of size 2^( 5) =       0.000448204616
  error estimate for blocks of size 2^( 6) =       0.000451087097
  error estimate for blocks of size 2^( 7) =       0.000451367324

      target function =                  N/A
              le_mean =     -17.216927204891
             les_mean =     296.775465284529
             stat err =       0.000448598747
             autocorr =       1.140552469091
              std dev =       0.594039630362
             le_variance =       0.352883082441


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216927204891        initial
     9.7656e+05     9.7656e+06             5.2685e-10       -17.216927204892  <--
     3.9062e+06     3.9062e+07             1.3171e-10       -17.216927204892
     1.5625e+07     1.5625e+08             3.2928e-11       -17.216927204891

*****************************************************************************
Applying the update for shift_i =   9.7656e+05     and shift_s =   9.7656e+06
*****************************************************************************

  Execution time = 2.9142e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5869e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.242
    reference variance = 0.236363
====================================================
  Execution time = 2.1797e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1418e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6513e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314038118926
                                         uncertainty =       0.002480335521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314038118926
                                         uncertainty =       0.002480335521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396347937
  error estimate for blocks of size 2^( 2) =       0.000405528622
  error estimate for blocks of size 2^( 3) =       0.000414348900
  error estimate for blocks of size 2^( 4) =       0.000420856911
  error estimate for blocks of size 2^( 5) =       0.000425220805
  error estimate for blocks of size 2^( 6) =       0.000428046778
  error estimate for blocks of size 2^( 7) =       0.000430332763

      target function =                  N/A
              le_mean =     -17.217309985548
             les_mean =     296.749946355529
             stat err =       0.000426114314
             autocorr =       1.155843521045
              std dev =       0.560520627772
             le_variance =       0.314183374158


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721730998555e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217309985548       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217309985551       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217309985554       residual = 9.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217309985557       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217309985562       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217309985594       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217309985838       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217309985421       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 2.643630e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217309985548       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217309985549       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217309985550       residual = 9.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217309985551       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217309984669       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217309985982       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217309984901       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217309984957       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 6.609079e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217309985548       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217309985549       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217309985549       residual = 9.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217309985492       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217309986454       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217309985549       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217309986509       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217309985862       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 1.652269e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.387025 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7459e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1256
    reference variance = 0.208271
====================================================
  Execution time = 2.0203e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4187e-01
  Total weights = 2.0000e+06
  Execution time = 1.8671e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342060375730
                                         uncertainty =       0.016709115600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342060375730
                                         uncertainty =       0.016709115600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413440915
  error estimate for blocks of size 2^( 2) =       0.000423032970
  error estimate for blocks of size 2^( 3) =       0.000431508530
  error estimate for blocks of size 2^( 4) =       0.000437967093
  error estimate for blocks of size 2^( 5) =       0.000442135434
  error estimate for blocks of size 2^( 6) =       0.000442651837
  error estimate for blocks of size 2^( 7) =       0.000443565116

      target function =                  N/A
              le_mean =     -17.216943819498
             les_mean =     296.765021093011
             stat err =       0.000441579870
             autocorr =       1.140753024715
              std dev =       0.584693749060
             le_variance =       0.341866780190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342060378039
                                         uncertainty =       0.016709115887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342060378039
                                         uncertainty =       0.016709115887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413440916
  error estimate for blocks of size 2^( 2) =       0.000423032971
  error estimate for blocks of size 2^( 3) =       0.000431508531
  error estimate for blocks of size 2^( 4) =       0.000437967094
  error estimate for blocks of size 2^( 5) =       0.000442135435
  error estimate for blocks of size 2^( 6) =       0.000442651838
  error estimate for blocks of size 2^( 7) =       0.000443565118

      target function =                  N/A
              le_mean =     -17.216943819506
             les_mean =     296.765021095592
             stat err =       0.000441579871
             autocorr =       1.140753023118
              std dev =       0.584693751034
             le_variance =       0.341866782498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342060376884
                                         uncertainty =       0.016709115743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342060376884
                                         uncertainty =       0.016709115743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413440916
  error estimate for blocks of size 2^( 2) =       0.000423032970
  error estimate for blocks of size 2^( 3) =       0.000431508530
  error estimate for blocks of size 2^( 4) =       0.000437967094
  error estimate for blocks of size 2^( 5) =       0.000442135435
  error estimate for blocks of size 2^( 6) =       0.000442651838
  error estimate for blocks of size 2^( 7) =       0.000443565117

      target function =                  N/A
              le_mean =     -17.216943819502
             les_mean =     296.765021094301
             stat err =       0.000441579871
             autocorr =       1.140753023922
              std dev =       0.584693750047
             le_variance =       0.341866781344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342060375874
                                         uncertainty =       0.016709115618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342060375874
                                         uncertainty =       0.016709115618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413440915
  error estimate for blocks of size 2^( 2) =       0.000423032970
  error estimate for blocks of size 2^( 3) =       0.000431508530
  error estimate for blocks of size 2^( 4) =       0.000437967093
  error estimate for blocks of size 2^( 5) =       0.000442135434
  error estimate for blocks of size 2^( 6) =       0.000442651837
  error estimate for blocks of size 2^( 7) =       0.000443565117

      target function =                  N/A
              le_mean =     -17.216943819499
             les_mean =     296.765021093172
             stat err =       0.000441579870
             autocorr =       1.140753024622
              std dev =       0.584693749184
             le_variance =       0.341866780334


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216943819498        initial
     2.4414e+05     2.4414e+06             2.6436e-09       -17.216943819506  <--
     9.7656e+05     9.7656e+06             6.6091e-10       -17.216943819502
     3.9062e+06     3.9062e+07             1.6523e-10       -17.216943819499

*****************************************************************************
Applying the update for shift_i =   2.4414e+05     and shift_s =   2.4414e+06
*****************************************************************************

  Execution time = 2.9625e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7268e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2329
    reference variance = 0.467819
====================================================
  Execution time = 2.1072e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1922e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4750e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319244356547
                                         uncertainty =       0.003866009457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319244356547
                                         uncertainty =       0.003866009457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399510840
  error estimate for blocks of size 2^( 2) =       0.000409092211
  error estimate for blocks of size 2^( 3) =       0.000417667465
  error estimate for blocks of size 2^( 4) =       0.000423860747
  error estimate for blocks of size 2^( 5) =       0.000428226632
  error estimate for blocks of size 2^( 6) =       0.000431073670
  error estimate for blocks of size 2^( 7) =       0.000430596025

      target function =                  N/A
              le_mean =     -17.217164462638
             les_mean =     296.749969796954
             stat err =       0.000428439269
             autocorr =       1.150062393559
              std dev =       0.564993648675
             le_variance =       0.319217823043


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721716446264e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217164462638       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217164462653       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217164462657       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217164462666       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217164462672       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217164462636       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217164462714       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217164462640       residual = 1.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 1.001181e-08

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217164462638       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217164462642       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217164462643       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217164462646       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217164462605       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217164462647       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217164462682       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217164462579       residual = 1.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 2.502958e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217164462638       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217164462639       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217164462639       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217164462542       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217164462146       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217164462370       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217164463043       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217164462959       residual = 1.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 6.257398e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.389571 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6558e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681214e-02 1 1  ON 11
 ud_2                -1.286581e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227023e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2288
    reference variance = 0.367
====================================================
  Execution time = 2.1014e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1767e-01
  Total weights = 2.0000e+06
  Execution time = 1.8662e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317733776312
                                         uncertainty =       0.004004734942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317733776312
                                         uncertainty =       0.004004734942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398543064
  error estimate for blocks of size 2^( 2) =       0.000408856505
  error estimate for blocks of size 2^( 3) =       0.000418048565
  error estimate for blocks of size 2^( 4) =       0.000423958936
  error estimate for blocks of size 2^( 5) =       0.000428278972
  error estimate for blocks of size 2^( 6) =       0.000431135934
  error estimate for blocks of size 2^( 7) =       0.000432673439

      target function =                  N/A
              le_mean =     -17.216533935785
             les_mean =     296.726713750947
             stat err =       0.000429011820
             autocorr =       1.158745353480
              std dev =       0.563625006331
             le_variance =       0.317673147762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317733781969
                                         uncertainty =       0.004004734978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317733781969
                                         uncertainty =       0.004004734978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398543068
  error estimate for blocks of size 2^( 2) =       0.000408856508
  error estimate for blocks of size 2^( 3) =       0.000418048568
  error estimate for blocks of size 2^( 4) =       0.000423958938
  error estimate for blocks of size 2^( 5) =       0.000428278975
  error estimate for blocks of size 2^( 6) =       0.000431135937
  error estimate for blocks of size 2^( 7) =       0.000432673442

      target function =                  N/A
              le_mean =     -17.216533935775
             les_mean =     296.726713756266
             stat err =       0.000429011823
             autocorr =       1.158745347933
              std dev =       0.563625011349
             le_variance =       0.317673153418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317733779141
                                         uncertainty =       0.004004734960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317733779141
                                         uncertainty =       0.004004734960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398543066
  error estimate for blocks of size 2^( 2) =       0.000408856507
  error estimate for blocks of size 2^( 3) =       0.000418048566
  error estimate for blocks of size 2^( 4) =       0.000423958937
  error estimate for blocks of size 2^( 5) =       0.000428278974
  error estimate for blocks of size 2^( 6) =       0.000431135936
  error estimate for blocks of size 2^( 7) =       0.000432673440

      target function =                  N/A
              le_mean =     -17.216533935780
             les_mean =     296.726713753607
             stat err =       0.000429011822
             autocorr =       1.158745350704
              std dev =       0.563625008840
             le_variance =       0.317673150590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317733776666
                                         uncertainty =       0.004004734945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317733776666
                                         uncertainty =       0.004004734945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398543064
  error estimate for blocks of size 2^( 2) =       0.000408856505
  error estimate for blocks of size 2^( 3) =       0.000418048565
  error estimate for blocks of size 2^( 4) =       0.000423958936
  error estimate for blocks of size 2^( 5) =       0.000428278973
  error estimate for blocks of size 2^( 6) =       0.000431135934
  error estimate for blocks of size 2^( 7) =       0.000432673439

      target function =                  N/A
              le_mean =     -17.216533935784
             les_mean =     296.726713751280
             stat err =       0.000429011820
             autocorr =       1.158745353132
              std dev =       0.563625006645
             le_variance =       0.317673148115


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216533935785        initial  <--
     6.1035e+04     6.1035e+05             1.0012e-08       -17.216533935775
     2.4414e+05     2.4414e+06             2.5030e-09       -17.216533935780
     9.7656e+05     9.7656e+06             6.2574e-10       -17.216533935784

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5398
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7627e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1974
    reference variance = 0.180384
====================================================
  Execution time = 2.3430e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1615e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5000e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316175314360
                                         uncertainty =       0.002964985018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316175314360
                                         uncertainty =       0.002964985018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397586101
  error estimate for blocks of size 2^( 2) =       0.000407326962
  error estimate for blocks of size 2^( 3) =       0.000415524618
  error estimate for blocks of size 2^( 4) =       0.000421690273
  error estimate for blocks of size 2^( 5) =       0.000426523897
  error estimate for blocks of size 2^( 6) =       0.000429203273
  error estimate for blocks of size 2^( 7) =       0.000429456623

      target function =                  N/A
              le_mean =     -17.216425735391
             les_mean =     296.721464359513
             stat err =       0.000426718516
             autocorr =       1.151915413709
              std dev =       0.562271656184
             le_variance =       0.316149415347


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721642573539e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216425735391       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216425735394       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216425735395       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216425735289       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216425732019       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216425735614       residual = 7.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216425735149       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216425735246       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 8.994084e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216425735391       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216425735392       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216425735392       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216425735051       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216425735392       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216425735473       residual = 7.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216425735125       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216425735200       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 2.248518e-10

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216425735391       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216425735391       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216425735391       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216425735391       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216425731743       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216425740101       residual = 7.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216425740908       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216425736132       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 5.621260e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.392162 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8940e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1861
    reference variance = 0.262335
====================================================
  Execution time = 1.9899e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1295e-01
  Total weights = 2.0000e+06
  Execution time = 1.8174e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312910064709
                                         uncertainty =       0.004038997644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312910064709
                                         uncertainty =       0.004038997644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395568718
  error estimate for blocks of size 2^( 2) =       0.000405585450
  error estimate for blocks of size 2^( 3) =       0.000414121561
  error estimate for blocks of size 2^( 4) =       0.000420318659
  error estimate for blocks of size 2^( 5) =       0.000424633366
  error estimate for blocks of size 2^( 6) =       0.000428286543
  error estimate for blocks of size 2^( 7) =       0.000429186707

      target function =                  N/A
              le_mean =     -17.215972194621
             les_mean =     296.702647671315
             stat err =       0.000425606319
             autocorr =       1.157636611826
              std dev =       0.559418646285
             le_variance =       0.312949221812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312910065633
                                         uncertainty =       0.004038997650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312910065633
                                         uncertainty =       0.004038997650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395568719
  error estimate for blocks of size 2^( 2) =       0.000405585450
  error estimate for blocks of size 2^( 3) =       0.000414121561
  error estimate for blocks of size 2^( 4) =       0.000420318659
  error estimate for blocks of size 2^( 5) =       0.000424633366
  error estimate for blocks of size 2^( 6) =       0.000428286543
  error estimate for blocks of size 2^( 7) =       0.000429186707

      target function =                  N/A
              le_mean =     -17.215972194619
             les_mean =     296.702647672167
             stat err =       0.000425606319
             autocorr =       1.157636610972
              std dev =       0.559418647112
             le_variance =       0.312949222736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312910065171
                                         uncertainty =       0.004038997647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312910065171
                                         uncertainty =       0.004038997647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395568719
  error estimate for blocks of size 2^( 2) =       0.000405585450
  error estimate for blocks of size 2^( 3) =       0.000414121561
  error estimate for blocks of size 2^( 4) =       0.000420318659
  error estimate for blocks of size 2^( 5) =       0.000424633366
  error estimate for blocks of size 2^( 6) =       0.000428286543
  error estimate for blocks of size 2^( 7) =       0.000429186707

      target function =                  N/A
              le_mean =     -17.215972194620
             les_mean =     296.702647671741
             stat err =       0.000425606319
             autocorr =       1.157636611396
              std dev =       0.559418646698
             le_variance =       0.312949222274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312910064767
                                         uncertainty =       0.004038997644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312910064767
                                         uncertainty =       0.004038997644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395568718
  error estimate for blocks of size 2^( 2) =       0.000405585450
  error estimate for blocks of size 2^( 3) =       0.000414121561
  error estimate for blocks of size 2^( 4) =       0.000420318659
  error estimate for blocks of size 2^( 5) =       0.000424633366
  error estimate for blocks of size 2^( 6) =       0.000428286543
  error estimate for blocks of size 2^( 7) =       0.000429186707

      target function =                  N/A
              le_mean =     -17.215972194621
             les_mean =     296.702647671369
             stat err =       0.000425606319
             autocorr =       1.157636611761
              std dev =       0.559418646337
             le_variance =       0.312949221870


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215972194621        initial  <--
     6.1035e+05     6.1035e+06             8.9941e-10       -17.215972194619
     2.4414e+06     2.4414e+07             2.2485e-10       -17.215972194620
     9.7656e+06     9.7656e+07             5.6213e-11       -17.215972194621

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0679
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8440e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1818
    reference variance = 0.156516
====================================================
  Execution time = 2.1155e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1545e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5415e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315258156695
                                         uncertainty =       0.003431978255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315258156695
                                         uncertainty =       0.003431978255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397145483
  error estimate for blocks of size 2^( 2) =       0.000406824560
  error estimate for blocks of size 2^( 3) =       0.000415802587
  error estimate for blocks of size 2^( 4) =       0.000421727606
  error estimate for blocks of size 2^( 5) =       0.000425428457
  error estimate for blocks of size 2^( 6) =       0.000428185383
  error estimate for blocks of size 2^( 7) =       0.000430125701

      target function =                  N/A
              le_mean =     -17.216607550694
             les_mean =     296.727024466355
             stat err =       0.000426366787
             autocorr =       1.152570442446
              std dev =       0.561648528420
             le_variance =       0.315449069477


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721660755069e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216607550694       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216607550694       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216607550694       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216607553279       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216607550694       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216607547977       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216607552703       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216607555247       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 9.248851e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216607550694       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216607550694       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216607550694       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216607537475       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216607549488       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216607548099       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216607553835       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216607553547       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 2.312206e-11

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216607550694       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216607550694       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216607550694       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216607550694       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216607520199       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216607588297       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216607539223       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216607553334       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+07 is 5.780556e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.394757 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6707e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1832
    reference variance = 0.259993
====================================================
  Execution time = 2.0993e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1642e-01
  Total weights = 2.0000e+06
  Execution time = 1.8212e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315802655103
                                         uncertainty =       0.004231070946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315802655103
                                         uncertainty =       0.004231070946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397754968
  error estimate for blocks of size 2^( 2) =       0.000407168174
  error estimate for blocks of size 2^( 3) =       0.000415777406
  error estimate for blocks of size 2^( 4) =       0.000422250532
  error estimate for blocks of size 2^( 5) =       0.000425412888
  error estimate for blocks of size 2^( 6) =       0.000428965869
  error estimate for blocks of size 2^( 7) =       0.000430556088

      target function =                  N/A
              le_mean =     -17.216979643255
             les_mean =     296.740805906905
             stat err =       0.000426796344
             autocorr =       1.151357400405
              std dev =       0.562510469999
             le_variance =       0.316418028858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315802655207
                                         uncertainty =       0.004231070947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315802655207
                                         uncertainty =       0.004231070947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397754968
  error estimate for blocks of size 2^( 2) =       0.000407168174
  error estimate for blocks of size 2^( 3) =       0.000415777406
  error estimate for blocks of size 2^( 4) =       0.000422250532
  error estimate for blocks of size 2^( 5) =       0.000425412888
  error estimate for blocks of size 2^( 6) =       0.000428965869
  error estimate for blocks of size 2^( 7) =       0.000430556088

      target function =                  N/A
              le_mean =     -17.216979643255
             les_mean =     296.740805907000
             stat err =       0.000426796344
             autocorr =       1.151357400315
              std dev =       0.562510470092
             le_variance =       0.316418028963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315802655155
                                         uncertainty =       0.004231070947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315802655155
                                         uncertainty =       0.004231070947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397754968
  error estimate for blocks of size 2^( 2) =       0.000407168174
  error estimate for blocks of size 2^( 3) =       0.000415777406
  error estimate for blocks of size 2^( 4) =       0.000422250532
  error estimate for blocks of size 2^( 5) =       0.000425412888
  error estimate for blocks of size 2^( 6) =       0.000428965869
  error estimate for blocks of size 2^( 7) =       0.000430556088

      target function =                  N/A
              le_mean =     -17.216979643255
             les_mean =     296.740805906952
             stat err =       0.000426796344
             autocorr =       1.151357400361
              std dev =       0.562510470045
             le_variance =       0.316418028910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315802655109
                                         uncertainty =       0.004231070946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315802655109
                                         uncertainty =       0.004231070946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397754968
  error estimate for blocks of size 2^( 2) =       0.000407168174
  error estimate for blocks of size 2^( 3) =       0.000415777406
  error estimate for blocks of size 2^( 4) =       0.000422250532
  error estimate for blocks of size 2^( 5) =       0.000425412888
  error estimate for blocks of size 2^( 6) =       0.000428965869
  error estimate for blocks of size 2^( 7) =       0.000430556088

      target function =                  N/A
              le_mean =     -17.216979643255
             les_mean =     296.740805906911
             stat err =       0.000426796344
             autocorr =       1.151357400394
              std dev =       0.562510470005
             le_variance =       0.316418028865


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216979643255        initial  <--
     6.1035e+06     6.1035e+07             9.2489e-11       -17.216979643255
     2.4414e+07     2.4414e+08             2.3122e-11       -17.216979643255
     9.7656e+07     9.7656e+08             5.7806e-12       -17.216979643255

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1809
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7212e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2493
    reference variance = 0.269025
====================================================
  Execution time = 2.1237e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1790e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5119e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317992140374
                                         uncertainty =       0.004807814580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317992140374
                                         uncertainty =       0.004807814580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398683342
  error estimate for blocks of size 2^( 2) =       0.000408347154
  error estimate for blocks of size 2^( 3) =       0.000417890510
  error estimate for blocks of size 2^( 4) =       0.000424190989
  error estimate for blocks of size 2^( 5) =       0.000428858020
  error estimate for blocks of size 2^( 6) =       0.000430761584
  error estimate for blocks of size 2^( 7) =       0.000432020447

      target function =                  N/A
              le_mean =     -17.216311902740
             les_mean =     296.719292187506
             stat err =       0.000428957760
             autocorr =       1.157638276376
              std dev =       0.563823389038
             le_variance =       0.317896814026


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721631190274e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216311902740       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216311902740       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216311902740       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216311912716       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216311894109       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216311880595       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216311917314       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216311909035       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+07 is 9.067753e-12

solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216311902740       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216311902740       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216311902740       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216311902740       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216311987186       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216311886650       residual = 9.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216311790054       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216311876770       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+08 is 2.266936e-12

solving harmonic davidson linear method for identity shift 9.7656e+08, overlap shift 9.7656e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216311902740       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216311902740       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216311902740       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216311902740       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216311878063       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216311638879       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216312082816       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216312596340       residual = 2.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+08 is 5.668098e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.397368 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6760e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.25
    reference variance = 0.651404
====================================================
  Execution time = 2.0897e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1409e-01
  Total weights = 2.0000e+06
  Execution time = 1.8219e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314007485873
                                         uncertainty =       0.003224144268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314007485873
                                         uncertainty =       0.003224144268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396291778
  error estimate for blocks of size 2^( 2) =       0.000405583657
  error estimate for blocks of size 2^( 3) =       0.000414488623
  error estimate for blocks of size 2^( 4) =       0.000421706032
  error estimate for blocks of size 2^( 5) =       0.000424703421
  error estimate for blocks of size 2^( 6) =       0.000427369594
  error estimate for blocks of size 2^( 7) =       0.000429786770

      target function =                  N/A
              le_mean =     -17.216983307763
             les_mean =     296.738608409954
             stat err =       0.000425891454
             autocorr =       1.154962083805
              std dev =       0.560441207619
             le_variance =       0.314094347197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314007485880
                                         uncertainty =       0.003224144268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314007485880
                                         uncertainty =       0.003224144268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396291778
  error estimate for blocks of size 2^( 2) =       0.000405583657
  error estimate for blocks of size 2^( 3) =       0.000414488623
  error estimate for blocks of size 2^( 4) =       0.000421706032
  error estimate for blocks of size 2^( 5) =       0.000424703421
  error estimate for blocks of size 2^( 6) =       0.000427369594
  error estimate for blocks of size 2^( 7) =       0.000429786770

      target function =                  N/A
              le_mean =     -17.216983307763
             les_mean =     296.738608409961
             stat err =       0.000425891454
             autocorr =       1.154962083804
              std dev =       0.560441207626
             le_variance =       0.314094347205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314007485876
                                         uncertainty =       0.003224144268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314007485876
                                         uncertainty =       0.003224144268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396291778
  error estimate for blocks of size 2^( 2) =       0.000405583657
  error estimate for blocks of size 2^( 3) =       0.000414488623
  error estimate for blocks of size 2^( 4) =       0.000421706032
  error estimate for blocks of size 2^( 5) =       0.000424703421
  error estimate for blocks of size 2^( 6) =       0.000427369594
  error estimate for blocks of size 2^( 7) =       0.000429786770

      target function =                  N/A
              le_mean =     -17.216983307763
             les_mean =     296.738608409957
             stat err =       0.000425891454
             autocorr =       1.154962083799
              std dev =       0.560441207622
             le_variance =       0.314094347201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314007485873
                                         uncertainty =       0.003224144268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314007485873
                                         uncertainty =       0.003224144268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396291778
  error estimate for blocks of size 2^( 2) =       0.000405583657
  error estimate for blocks of size 2^( 3) =       0.000414488623
  error estimate for blocks of size 2^( 4) =       0.000421706032
  error estimate for blocks of size 2^( 5) =       0.000424703421
  error estimate for blocks of size 2^( 6) =       0.000427369594
  error estimate for blocks of size 2^( 7) =       0.000429786770

      target function =                  N/A
              le_mean =     -17.216983307763
             les_mean =     296.738608409955
             stat err =       0.000425891454
             autocorr =       1.154962083805
              std dev =       0.560441207619
             le_variance =       0.314094347198


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216983307763        initial  <--
     6.1035e+07     6.1035e+08             9.0678e-12       -17.216983307763
     2.4414e+08     2.4414e+09             2.2669e-12       -17.216983307763
     9.7656e+08     9.7656e+09             5.6681e-13       -17.216983307763

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0599
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7254e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2233
    reference variance = 0.193005
====================================================
  Execution time = 2.0620e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1592e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5462e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315947503086
                                         uncertainty =       0.003149774245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315947503086
                                         uncertainty =       0.003149774245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397443793
  error estimate for blocks of size 2^( 2) =       0.000406708446
  error estimate for blocks of size 2^( 3) =       0.000415606554
  error estimate for blocks of size 2^( 4) =       0.000421714367
  error estimate for blocks of size 2^( 5) =       0.000426113458
  error estimate for blocks of size 2^( 6) =       0.000429289732
  error estimate for blocks of size 2^( 7) =       0.000431077090

      target function =                  N/A
              le_mean =     -17.216514729776
             les_mean =     296.724302419157
             stat err =       0.000427048662
             autocorr =       1.154524873235
              std dev =       0.562070401745
             le_variance =       0.315923136517


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721651472978e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+08, overlap shift 6.1035e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216514729776       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216514729776       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216514729776       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216514550187       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216514711845       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216514797203       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216514016186       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216514846029       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+08 is 8.650372e-13

solving harmonic davidson linear method for identity shift 2.4414e+09, overlap shift 2.4414e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216514729776       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216514729776       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216514729776       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216513780315       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216514609012       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216514881077       residual = 9.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216515355416       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216513764659       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+09 is 2.160399e-13

solving harmonic davidson linear method for identity shift 9.7656e+09, overlap shift 9.7656e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216514729776       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216514729776       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216514729776       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216514729776       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216510645431       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216507030489       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216514729776       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216517398749       residual = 6.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+09 is 5.428395e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.399898 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6176e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1796
    reference variance = 0.181353
====================================================
  Execution time = 1.9979e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1370e-01
  Total weights = 2.0000e+06
  Execution time = 1.8178e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313772357341
                                         uncertainty =       0.002762005640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313772357341
                                         uncertainty =       0.002762005640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396042478
  error estimate for blocks of size 2^( 2) =       0.000405525482
  error estimate for blocks of size 2^( 3) =       0.000414158584
  error estimate for blocks of size 2^( 4) =       0.000420183370
  error estimate for blocks of size 2^( 5) =       0.000424597598
  error estimate for blocks of size 2^( 6) =       0.000426234048
  error estimate for blocks of size 2^( 7) =       0.000428464777

      target function =                  N/A
              le_mean =     -17.216632237554
             les_mean =     296.726124735029
             stat err =       0.000424869948
             autocorr =       1.150875884134
              std dev =       0.560088643591
             le_variance =       0.313699288679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313772357341
                                         uncertainty =       0.002762005640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313772357341
                                         uncertainty =       0.002762005640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396042478
  error estimate for blocks of size 2^( 2) =       0.000405525482
  error estimate for blocks of size 2^( 3) =       0.000414158584
  error estimate for blocks of size 2^( 4) =       0.000420183370
  error estimate for blocks of size 2^( 5) =       0.000424597598
  error estimate for blocks of size 2^( 6) =       0.000426234048
  error estimate for blocks of size 2^( 7) =       0.000428464777

      target function =                  N/A
              le_mean =     -17.216632237554
             les_mean =     296.726124735030
             stat err =       0.000424869948
             autocorr =       1.150875884142
              std dev =       0.560088643591
             le_variance =       0.313699288680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313772357341
                                         uncertainty =       0.002762005640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313772357341
                                         uncertainty =       0.002762005640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396042478
  error estimate for blocks of size 2^( 2) =       0.000405525482
  error estimate for blocks of size 2^( 3) =       0.000414158584
  error estimate for blocks of size 2^( 4) =       0.000420183370
  error estimate for blocks of size 2^( 5) =       0.000424597598
  error estimate for blocks of size 2^( 6) =       0.000426234048
  error estimate for blocks of size 2^( 7) =       0.000428464777

      target function =                  N/A
              le_mean =     -17.216632237554
             les_mean =     296.726124735030
             stat err =       0.000424869948
             autocorr =       1.150875884138
              std dev =       0.560088643591
             le_variance =       0.313699288680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313772357341
                                         uncertainty =       0.002762005640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313772357341
                                         uncertainty =       0.002762005640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396042478
  error estimate for blocks of size 2^( 2) =       0.000405525482
  error estimate for blocks of size 2^( 3) =       0.000414158584
  error estimate for blocks of size 2^( 4) =       0.000420183370
  error estimate for blocks of size 2^( 5) =       0.000424597598
  error estimate for blocks of size 2^( 6) =       0.000426234048
  error estimate for blocks of size 2^( 7) =       0.000428464777

      target function =                  N/A
              le_mean =     -17.216632237554
             les_mean =     296.726124735029
             stat err =       0.000424869948
             autocorr =       1.150875884140
              std dev =       0.560088643591
             le_variance =       0.313699288679


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216632237554        initial  <--
     6.1035e+08     6.1035e+09             8.6504e-13       -17.216632237554
     2.4414e+09     2.4414e+10             2.1604e-13       -17.216632237554
     9.7656e+09     9.7656e+10             5.4284e-14       -17.216632237554

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1484
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5580e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2865
    reference variance = 0.369926
====================================================
  Execution time = 1.9790e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2319e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5582e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323177330334
                                         uncertainty =       0.005100577291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323177330334
                                         uncertainty =       0.005100577291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401990005
  error estimate for blocks of size 2^( 2) =       0.000412351862
  error estimate for blocks of size 2^( 3) =       0.000421035843
  error estimate for blocks of size 2^( 4) =       0.000426837955
  error estimate for blocks of size 2^( 5) =       0.000429338181
  error estimate for blocks of size 2^( 6) =       0.000430876049
  error estimate for blocks of size 2^( 7) =       0.000433467148

      target function =                  N/A
              le_mean =     -17.217043895311
             les_mean =     296.749792259439
             stat err =       0.000430129833
             autocorr =       1.144902810010
              std dev =       0.568499716757
             le_variance =       0.323191927953


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721704389531e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+09, overlap shift 6.1035e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217043895311       residual = 8.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217043895311       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217043895311       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217041294269       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217043895311       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217043810805       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217030633608       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217030831530       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217028285520       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217017243425       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217073078963       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217015174108       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217141478285       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217095882492       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217154996852       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217135543559       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217092944118       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.217389910634       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217003715510       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216367486241       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216599340105       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216505160326       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216697027080       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216328206046       residual = 7.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.217566251257       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.216791322746       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.216346923908       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.216235800671       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.217103003349       residual = 6.01e-06           smallest_sin_value = 9.99e-01
davidson iteration   29:   krylov dim =  30   energy =     -17.217147902951       residual = 5.81e-06           smallest_sin_value = 9.96e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.62e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+09 is 9.001117e-14

solving harmonic davidson linear method for identity shift 2.4414e+10, overlap shift 2.4414e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217043895311       residual = 8.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217043895311       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217043895311       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217042500999       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217043977421       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217033903423       residual = 8.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217054119892       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217024687976       residual = 8.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217028304453       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216958000337       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216972530564       residual = 7.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216942419587       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216900489788       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217772768403       residual = 8.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217304342567       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.218113844567       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.218361588100       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.218307397068       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.213495447496       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.221373551986       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.215849870088       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.212210510280       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.215408361863       residual = 4.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.205715776625       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.217061293161       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.211669247067       residual = 4.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.214449932301       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.219477461898       residual = 8.89e-04           smallest_sin_value = 9.97e-01
davidson iteration   28 stopping due to small subspace S singular value of 9.73e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+10 is 2.227937e-14

solving harmonic davidson linear method for identity shift 9.7656e+10, overlap shift 9.7656e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217043895311       residual = 8.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217043895311       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217043895311       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217043895311       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217043895311       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217040851631       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217112502411       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215942009773       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216819318333       residual = 9.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217331838504       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.218149927205       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214882453550       residual = 7.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215386440518       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.220148990469       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216251964440       residual = 9.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.212994354497       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215919133794       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.214145515103       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.218010895986       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.232165821984       residual = 3.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216487298601       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.214804564910       residual = 6.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.220262818134       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.219733417279       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.230852569084       residual = 3.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.215844677423       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.215865084834       residual = 5.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.236767203248       residual = 6.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.237143186484       residual = 5.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.218181705811       residual = 3.95e-04           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -17.234980614864       residual = 5.39e-02           smallest_sin_value = 9.91e-01
davidson iteration   31 stopping due to small subspace S singular value of 7.44e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+10 is 5.324905e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.436364 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5392e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2894
    reference variance = 0.229485
====================================================
  Execution time = 2.0748e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2076e-01
  Total weights = 2.0000e+06
  Execution time = 1.8234e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320849443638
                                         uncertainty =       0.004343945621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320849443638
                                         uncertainty =       0.004343945621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400476066
  error estimate for blocks of size 2^( 2) =       0.000409786101
  error estimate for blocks of size 2^( 3) =       0.000418474371
  error estimate for blocks of size 2^( 4) =       0.000424456914
  error estimate for blocks of size 2^( 5) =       0.000426980453
  error estimate for blocks of size 2^( 6) =       0.000428824421
  error estimate for blocks of size 2^( 7) =       0.000429044605

      target function =                  N/A
              le_mean =     -17.217231069996
             les_mean =     296.753807716561
             stat err =       0.000427326598
             autocorr =       1.138588304942
              std dev =       0.566358684333
             le_variance =       0.320762159319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320849443638
                                         uncertainty =       0.004343945621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320849443638
                                         uncertainty =       0.004343945621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400476066
  error estimate for blocks of size 2^( 2) =       0.000409786101
  error estimate for blocks of size 2^( 3) =       0.000418474371
  error estimate for blocks of size 2^( 4) =       0.000424456914
  error estimate for blocks of size 2^( 5) =       0.000426980453
  error estimate for blocks of size 2^( 6) =       0.000428824421
  error estimate for blocks of size 2^( 7) =       0.000429044605

      target function =                  N/A
              le_mean =     -17.217231069996
             les_mean =     296.753807716561
             stat err =       0.000427326598
             autocorr =       1.138588304944
              std dev =       0.566358684333
             le_variance =       0.320762159319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320849443638
                                         uncertainty =       0.004343945621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320849443638
                                         uncertainty =       0.004343945621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400476066
  error estimate for blocks of size 2^( 2) =       0.000409786101
  error estimate for blocks of size 2^( 3) =       0.000418474371
  error estimate for blocks of size 2^( 4) =       0.000424456914
  error estimate for blocks of size 2^( 5) =       0.000426980453
  error estimate for blocks of size 2^( 6) =       0.000428824421
  error estimate for blocks of size 2^( 7) =       0.000429044605

      target function =                  N/A
              le_mean =     -17.217231069996
             les_mean =     296.753807716561
             stat err =       0.000427326598
             autocorr =       1.138588304941
              std dev =       0.566358684333
             le_variance =       0.320762159319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320849443638
                                         uncertainty =       0.004343945621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320849443638
                                         uncertainty =       0.004343945621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400476066
  error estimate for blocks of size 2^( 2) =       0.000409786101
  error estimate for blocks of size 2^( 3) =       0.000418474371
  error estimate for blocks of size 2^( 4) =       0.000424456914
  error estimate for blocks of size 2^( 5) =       0.000426980453
  error estimate for blocks of size 2^( 6) =       0.000428824421
  error estimate for blocks of size 2^( 7) =       0.000429044605

      target function =                  N/A
              le_mean =     -17.217231069996
             les_mean =     296.753807716561
             stat err =       0.000427326598
             autocorr =       1.138588304943
              std dev =       0.566358684333
             le_variance =       0.320762159319


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217231069996        initial  <--
     6.1035e+09     6.1035e+10             9.0011e-14       -17.217231069996
     2.4414e+10     2.4414e+11             2.2279e-14       -17.217231069996
     9.7656e+10     9.7656e+11             5.3249e-15       -17.217231069996

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9211
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5679e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.3098
    reference variance = 0.292494
====================================================
  Execution time = 2.9932e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0629e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4848e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306274114372
                                         uncertainty =       0.002326758686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306274114372
                                         uncertainty =       0.002326758686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391334431
  error estimate for blocks of size 2^( 2) =       0.000401332247
  error estimate for blocks of size 2^( 3) =       0.000410020363
  error estimate for blocks of size 2^( 4) =       0.000416260407
  error estimate for blocks of size 2^( 5) =       0.000418923787
  error estimate for blocks of size 2^( 6) =       0.000420656435
  error estimate for blocks of size 2^( 7) =       0.000421969968

      target function =                  N/A
              le_mean =     -17.216659411496
             les_mean =     296.719646411745
             stat err =       0.000419452649
             autocorr =       1.148867021695
              std dev =       0.553430459431
             le_variance =       0.306285273426


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721665941150e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+10, overlap shift 6.1035e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216659411496       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216659411496       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216659411496       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216660773409       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216653773375       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216658555818       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216625545342       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216723246371       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216612605106       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217192123861       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216887186129       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217433974374       residual = 8.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217064749031       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217040714971       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216478494511       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.218603085755       residual = 6.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.223962013498       residual = 8.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.218378699950       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.221930611215       residual = 4.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.218120832135       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.215844936695       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.217691541001       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.213289155267       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.194205853123       residual = 7.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.211021013268       residual = 5.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.184977459311       residual = 1.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.295228734867       residual = 9.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.214178212585       residual = 1.10e-03           smallest_sin_value = 9.98e-01
davidson iteration   28 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+10 is 7.820206e-15

solving harmonic davidson linear method for identity shift 2.4414e+11, overlap shift 2.4414e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216659411496       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216659411496       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216659411496       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216659411496       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216744740937       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216668933935       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216683841478       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216856404884       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215556129657       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216739681317       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.220049353447       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217280553394       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.206636575171       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.239562742643       residual = 8.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.248420688024       residual = 1.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.222740851947       residual = 6.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.242438732412       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.209040070526       residual = 8.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.215507910617       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.209119540723       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.150307950748       residual = 6.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.250326956155       residual = 1.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.292553509118       residual = 8.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.181462524578       residual = 1.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.177950180871       residual = 2.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.241300114367       residual = 1.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.138613347896       residual = 1.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.280532890667       residual = 7.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.066068008380       residual = 4.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.270022498292       residual = 4.13e-01           smallest_sin_value = 9.97e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.76e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+11 is 1.551437e-15

solving harmonic davidson linear method for identity shift 9.7656e+11, overlap shift 9.7656e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216659411496       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216659411496       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216659411496       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216659411496       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215548713678       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216658821656       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216388212292       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.208571909676       residual = 9.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.218858935073       residual = 8.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.220560102023       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.238296263253       residual = 7.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.246422060244       residual = 1.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.202724804239       residual = 3.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.237298739076       residual = 6.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.191421118450       residual = 9.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.137642525374       residual = 9.82e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.175539276701       residual = 2.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.211409999730       residual = 3.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.312902896003       residual = 1.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.151216332277       residual = 6.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.206488198524       residual = 1.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.005315429382       residual = 6.98e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.267460484123       residual = 4.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.839352219880       residual = 2.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.335512791258       residual = 2.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.617347345254       residual = 2.52e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.274565212483       residual = 5.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.254820121839       residual = 4.20e-01           smallest_sin_value = 9.99e-01
davidson iteration   28:   krylov dim =  29   energy =     -17.569589900405       residual = 1.94e+01           smallest_sin_value = 9.96e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+11 is 4.105206e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.469667 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5459e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2083
    reference variance = 0.525041
====================================================
  Execution time = 2.1039e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1381e-01
  Total weights = 2.0000e+06
  Execution time = 1.8272e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313753091566
                                         uncertainty =       0.002943477634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313753091566
                                         uncertainty =       0.002943477634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396111151
  error estimate for blocks of size 2^( 2) =       0.000405672126
  error estimate for blocks of size 2^( 3) =       0.000414788925
  error estimate for blocks of size 2^( 4) =       0.000420362852
  error estimate for blocks of size 2^( 5) =       0.000424920342
  error estimate for blocks of size 2^( 6) =       0.000428046539
  error estimate for blocks of size 2^( 7) =       0.000428240993

      target function =                  N/A
              le_mean =     -17.216587456719
             les_mean =     296.724691585431
             stat err =       0.000425392681
             autocorr =       1.153309558344
              std dev =       0.560185761571
             le_variance =       0.313808087467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313753091566
                                         uncertainty =       0.002943477634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313753091566
                                         uncertainty =       0.002943477634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396111151
  error estimate for blocks of size 2^( 2) =       0.000405672126
  error estimate for blocks of size 2^( 3) =       0.000414788925
  error estimate for blocks of size 2^( 4) =       0.000420362852
  error estimate for blocks of size 2^( 5) =       0.000424920342
  error estimate for blocks of size 2^( 6) =       0.000428046539
  error estimate for blocks of size 2^( 7) =       0.000428240993

      target function =                  N/A
              le_mean =     -17.216587456719
             les_mean =     296.724691585431
             stat err =       0.000425392681
             autocorr =       1.153309558340
              std dev =       0.560185761571
             le_variance =       0.313808087467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313753091566
                                         uncertainty =       0.002943477634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313753091566
                                         uncertainty =       0.002943477634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396111151
  error estimate for blocks of size 2^( 2) =       0.000405672126
  error estimate for blocks of size 2^( 3) =       0.000414788925
  error estimate for blocks of size 2^( 4) =       0.000420362852
  error estimate for blocks of size 2^( 5) =       0.000424920342
  error estimate for blocks of size 2^( 6) =       0.000428046539
  error estimate for blocks of size 2^( 7) =       0.000428240993

      target function =                  N/A
              le_mean =     -17.216587456719
             les_mean =     296.724691585431
             stat err =       0.000425392681
             autocorr =       1.153309558341
              std dev =       0.560185761571
             le_variance =       0.313808087467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313753091566
                                         uncertainty =       0.002943477634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313753091566
                                         uncertainty =       0.002943477634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396111151
  error estimate for blocks of size 2^( 2) =       0.000405672126
  error estimate for blocks of size 2^( 3) =       0.000414788925
  error estimate for blocks of size 2^( 4) =       0.000420362852
  error estimate for blocks of size 2^( 5) =       0.000424920342
  error estimate for blocks of size 2^( 6) =       0.000428046539
  error estimate for blocks of size 2^( 7) =       0.000428240993

      target function =                  N/A
              le_mean =     -17.216587456719
             les_mean =     296.724691585431
             stat err =       0.000425392681
             autocorr =       1.153309558342
              std dev =       0.560185761571
             le_variance =       0.313808087467


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216587456719        initial  <--
     6.1035e+10     6.1035e+11             7.8202e-15       -17.216587456719
     2.4414e+11     2.4414e+12             1.5514e-15       -17.216587456719
     9.7656e+11     9.7656e+12             4.1052e-16       -17.216587456719

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2524
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.5983e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.267
    reference variance = 0.405085
====================================================
  Execution time = 2.0819e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1033e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5378e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310347230622
                                         uncertainty =       0.002470301901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310347230622
                                         uncertainty =       0.002470301901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393910468
  error estimate for blocks of size 2^( 2) =       0.000404139266
  error estimate for blocks of size 2^( 3) =       0.000413248187
  error estimate for blocks of size 2^( 4) =       0.000419506615
  error estimate for blocks of size 2^( 5) =       0.000423460288
  error estimate for blocks of size 2^( 6) =       0.000425265170
  error estimate for blocks of size 2^( 7) =       0.000425332186

      target function =                  N/A
              le_mean =     -17.216775132724
             les_mean =     296.727676729162
             stat err =       0.000423391065
             autocorr =       1.155282866672
              std dev =       0.557073526144
             le_variance =       0.310330913530


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721677513272e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+11, overlap shift 6.1035e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216775132724       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216775132724       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216775132724       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217149419058       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216734861446       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216730803779       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216033678082       residual = 8.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216510697555       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.229939972642       residual = 2.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213971091929       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.191805337665       residual = 9.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.164330877478       residual = 4.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.195544116617       residual = 6.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217626483476       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.154147534709       residual = 5.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.374759248743       residual = 3.68e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.198977590402       residual = 4.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.150175400112       residual = 6.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.260004190652       residual = 2.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.188360903526       residual = 1.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.231165961175       residual = 3.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.206183594286       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.237909040532       residual = 8.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.217600427060       residual = 7.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.141102249342       residual = 8.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.226908513094       residual = 2.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.809161347602       residual = 5.25e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.076071864060       residual = 3.08e+00           smallest_sin_value = 9.99e-01
davidson iteration   28 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+11 is 9.133557e-16

solving harmonic davidson linear method for identity shift 2.4414e+12, overlap shift 2.4414e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216775132724       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216775132724       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216775132724       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216215194483       residual = 5.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216745155249       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216853283412       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214090545829       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.196740233801       residual = 6.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.231046486088       residual = 3.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.221150827031       residual = 3.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.199316935228       residual = 5.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.227354565022       residual = 2.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.188238288715       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.470559661212       residual = 9.86e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.359920781872       residual = 3.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.422749269041       residual = 6.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.011063794212       residual = 6.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.315919359914       residual = 1.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.254854545464       residual = 2.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.085806895130       residual = 2.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.983208269070       residual = 8.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.321618452009       residual = 1.73e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.561560978239       residual = 1.85e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.214230134625       residual = 3.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.109825963686       residual = 1.72e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.077783248285       residual = 3.08e+00           smallest_sin_value = 9.99e-01
davidson iteration   26:   krylov dim =  27   energy =     -16.373986928641       residual = 1.08e+02           smallest_sin_value = 9.97e-01
davidson iteration   27 stopping due to small subspace S singular value of 9.76e-01
davidson solver did not converge after         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+12 is 1.622505e-16

solving harmonic davidson linear method for identity shift 9.7656e+12, overlap shift 9.7656e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216775132724       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216775132724       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216775132724       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217270065786       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216901933772       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.220384257717       residual = 2.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200600704142       residual = 4.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.229745529454       residual = 3.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.220891124764       residual = 6.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.162254005180       residual = 4.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.196626378997       residual = 6.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.040485117267       residual = 4.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.402177107374       residual = 5.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.946616288895       residual = 8.47e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.575473738327       residual = 2.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.617328048160       residual = 2.68e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.245340671969       residual = 1.49e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.325929486413       residual = 1.24e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -19.301296819793       residual = 7.01e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -15.130944671868       residual = 6.35e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -19.489417642890       residual = 8.26e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.807087735981       residual = 5.24e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.289614123296       residual = 3.21e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -18.435939664397       residual = 2.71e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -14.803370612361       residual = 9.14e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.508605858861       residual = 8.01e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -18.140355371774       residual = 2.17e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -19.602265355962       residual = 1.15e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -20.368659722029       residual = 1.78e+03           smallest_sin_value = 9.98e-01
davidson iteration   29:   krylov dim =  30   energy =     -21.622321291247       residual = 3.46e+03           smallest_sin_value = 9.97e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.35e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+12 is 2.498894e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.501964 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6397e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1891
    reference variance = 0.238982
====================================================
  Execution time = 2.0018e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1982e-01
  Total weights = 2.0000e+06
  Execution time = 1.8258e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319758481268
                                         uncertainty =       0.003292807116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319758481268
                                         uncertainty =       0.003292807116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399889216
  error estimate for blocks of size 2^( 2) =       0.000409998922
  error estimate for blocks of size 2^( 3) =       0.000418771616
  error estimate for blocks of size 2^( 4) =       0.000424801987
  error estimate for blocks of size 2^( 5) =       0.000429594347
  error estimate for blocks of size 2^( 6) =       0.000431321896
  error estimate for blocks of size 2^( 7) =       0.000432152938

      target function =                  N/A
              le_mean =     -17.216103282664
             les_mean =     296.714034849488
             stat err =       0.000429467792
             autocorr =       1.153404958087
              std dev =       0.565528752631
             le_variance =       0.319822770052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319758481268
                                         uncertainty =       0.003292807116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319758481268
                                         uncertainty =       0.003292807116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399889216
  error estimate for blocks of size 2^( 2) =       0.000409998922
  error estimate for blocks of size 2^( 3) =       0.000418771616
  error estimate for blocks of size 2^( 4) =       0.000424801987
  error estimate for blocks of size 2^( 5) =       0.000429594347
  error estimate for blocks of size 2^( 6) =       0.000431321896
  error estimate for blocks of size 2^( 7) =       0.000432152938

      target function =                  N/A
              le_mean =     -17.216103282664
             les_mean =     296.714034849488
             stat err =       0.000429467792
             autocorr =       1.153404958084
              std dev =       0.565528752631
             le_variance =       0.319822770052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319758481268
                                         uncertainty =       0.003292807116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319758481268
                                         uncertainty =       0.003292807116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399889216
  error estimate for blocks of size 2^( 2) =       0.000409998922
  error estimate for blocks of size 2^( 3) =       0.000418771616
  error estimate for blocks of size 2^( 4) =       0.000424801987
  error estimate for blocks of size 2^( 5) =       0.000429594347
  error estimate for blocks of size 2^( 6) =       0.000431321896
  error estimate for blocks of size 2^( 7) =       0.000432152938

      target function =                  N/A
              le_mean =     -17.216103282664
             les_mean =     296.714034849488
             stat err =       0.000429467792
             autocorr =       1.153404958085
              std dev =       0.565528752631
             le_variance =       0.319822770052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319758481268
                                         uncertainty =       0.003292807116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319758481268
                                         uncertainty =       0.003292807116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399889216
  error estimate for blocks of size 2^( 2) =       0.000409998922
  error estimate for blocks of size 2^( 3) =       0.000418771616
  error estimate for blocks of size 2^( 4) =       0.000424801987
  error estimate for blocks of size 2^( 5) =       0.000429594347
  error estimate for blocks of size 2^( 6) =       0.000431321896
  error estimate for blocks of size 2^( 7) =       0.000432152938

      target function =                  N/A
              le_mean =     -17.216103282664
             les_mean =     296.714034849488
             stat err =       0.000429467792
             autocorr =       1.153404958087
              std dev =       0.565528752631
             le_variance =       0.319822770052


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216103282664        initial  <--
     6.1035e+11     6.1035e+12             9.1336e-16       -17.216103282664
     2.4414e+12     2.4414e+13             1.6225e-16       -17.216103282664
     9.7656e+12     9.7656e+13             2.4989e-17       -17.216103282664

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2098
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6029e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.169
    reference variance = 0.231958
====================================================
  Execution time = 2.0985e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1429e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6346e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314290940110
                                         uncertainty =       0.002840076919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314290940110
                                         uncertainty =       0.002840076919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396413427
  error estimate for blocks of size 2^( 2) =       0.000406066089
  error estimate for blocks of size 2^( 3) =       0.000414630574
  error estimate for blocks of size 2^( 4) =       0.000421229690
  error estimate for blocks of size 2^( 5) =       0.000424498954
  error estimate for blocks of size 2^( 6) =       0.000425704651
  error estimate for blocks of size 2^( 7) =       0.000424270288

      target function =                  N/A
              le_mean =     -17.216624710465
             les_mean =     296.726453473796
             stat err =       0.000423925896
             autocorr =       1.143623790024
              std dev =       0.560613244548
             le_variance =       0.314287209963


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721662471046e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+12, overlap shift 6.1035e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216624710464       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216624710464       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.65e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.4414e+13, overlap shift 2.4414e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216624710464       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216624710464       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.65e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+13, overlap shift 9.7656e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216624710464       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216624710464       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.503017 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6630e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2328
    reference variance = 0.26128
====================================================
  Execution time = 2.0365e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1054e-01
  Total weights = 2.0000e+06
  Execution time = 1.8262e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310413403543
                                         uncertainty =       0.002896870144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310413403543
                                         uncertainty =       0.002896870144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394043074
  error estimate for blocks of size 2^( 2) =       0.000403441126
  error estimate for blocks of size 2^( 3) =       0.000411602312
  error estimate for blocks of size 2^( 4) =       0.000417708149
  error estimate for blocks of size 2^( 5) =       0.000421625362
  error estimate for blocks of size 2^( 6) =       0.000423906410
  error estimate for blocks of size 2^( 7) =       0.000424919374

      target function =                  N/A
              le_mean =     -17.216360029708
             les_mean =     296.713592406005
             stat err =       0.000422039823
             autocorr =       1.147148041411
              std dev =       0.557261059786
             le_variance =       0.310539888754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310413403543
                                         uncertainty =       0.002896870144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310413403543
                                         uncertainty =       0.002896870144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394043074
  error estimate for blocks of size 2^( 2) =       0.000403441126
  error estimate for blocks of size 2^( 3) =       0.000411602312
  error estimate for blocks of size 2^( 4) =       0.000417708149
  error estimate for blocks of size 2^( 5) =       0.000421625362
  error estimate for blocks of size 2^( 6) =       0.000423906410
  error estimate for blocks of size 2^( 7) =       0.000424919374

      target function =                  N/A
              le_mean =     -17.216360029708
             les_mean =     296.713592406005
             stat err =       0.000422039823
             autocorr =       1.147148041411
              std dev =       0.557261059786
             le_variance =       0.310539888754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310413403543
                                         uncertainty =       0.002896870144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310413403543
                                         uncertainty =       0.002896870144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394043074
  error estimate for blocks of size 2^( 2) =       0.000403441126
  error estimate for blocks of size 2^( 3) =       0.000411602312
  error estimate for blocks of size 2^( 4) =       0.000417708149
  error estimate for blocks of size 2^( 5) =       0.000421625362
  error estimate for blocks of size 2^( 6) =       0.000423906410
  error estimate for blocks of size 2^( 7) =       0.000424919374

      target function =                  N/A
              le_mean =     -17.216360029708
             les_mean =     296.713592406005
             stat err =       0.000422039823
             autocorr =       1.147148041411
              std dev =       0.557261059786
             le_variance =       0.310539888754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310413403543
                                         uncertainty =       0.002896870144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310413403543
                                         uncertainty =       0.002896870144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394043074
  error estimate for blocks of size 2^( 2) =       0.000403441126
  error estimate for blocks of size 2^( 3) =       0.000411602312
  error estimate for blocks of size 2^( 4) =       0.000417708149
  error estimate for blocks of size 2^( 5) =       0.000421625362
  error estimate for blocks of size 2^( 6) =       0.000423906410
  error estimate for blocks of size 2^( 7) =       0.000424919374

      target function =                  N/A
              le_mean =     -17.216360029708
             les_mean =     296.713592406005
             stat err =       0.000422039823
             autocorr =       1.147148041411
              std dev =       0.557261059786
             le_variance =       0.310539888754


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216360029708        initial  <--
     6.1035e+12     6.1035e+13             0.0000e+00       -17.216360029708
     2.4414e+13     2.4414e+14             0.0000e+00       -17.216360029708
     9.7656e+13     9.7656e+14             0.0000e+00       -17.216360029708

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5790
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6347e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.217
    reference variance = 0.233814
====================================================
  Execution time = 2.0435e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1105e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6413e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311151626872
                                         uncertainty =       0.002819232848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311151626872
                                         uncertainty =       0.002819232848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394366795
  error estimate for blocks of size 2^( 2) =       0.000404214629
  error estimate for blocks of size 2^( 3) =       0.000412632464
  error estimate for blocks of size 2^( 4) =       0.000419054865
  error estimate for blocks of size 2^( 5) =       0.000423455477
  error estimate for blocks of size 2^( 6) =       0.000425515039
  error estimate for blocks of size 2^( 7) =       0.000423951489

      target function =                  N/A
              le_mean =     -17.217122010091
             les_mean =     296.740340492474
             stat err =       0.000422994217
             autocorr =       1.150451141682
              std dev =       0.557718869718
             le_variance =       0.311050337639


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721712201009e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+13, overlap shift 6.1035e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217122010091       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217122010091       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.4414e+14, overlap shift 2.4414e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217122010091       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217122010091       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+14, overlap shift 9.7656e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217122010091       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217122010091       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.504056 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6085e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1714
    reference variance = 0.240924
====================================================
  Execution time = 2.0091e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3686e-01
  Total weights = 2.0000e+06
  Execution time = 1.8268e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336849229836
                                         uncertainty =       0.015726156062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336849229836
                                         uncertainty =       0.015726156062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410401064
  error estimate for blocks of size 2^( 2) =       0.000419679769
  error estimate for blocks of size 2^( 3) =       0.000428334645
  error estimate for blocks of size 2^( 4) =       0.000434969659
  error estimate for blocks of size 2^( 5) =       0.000438352617
  error estimate for blocks of size 2^( 6) =       0.000441143911
  error estimate for blocks of size 2^( 7) =       0.000440147951

      target function =                  N/A
              le_mean =     -17.216545418533
             les_mean =     296.746294046394
             stat err =       0.000438653534
             autocorr =       1.142421348839
              std dev =       0.580394750495
             le_variance =       0.336858066402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336849229836
                                         uncertainty =       0.015726156062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336849229836
                                         uncertainty =       0.015726156062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410401064
  error estimate for blocks of size 2^( 2) =       0.000419679769
  error estimate for blocks of size 2^( 3) =       0.000428334645
  error estimate for blocks of size 2^( 4) =       0.000434969659
  error estimate for blocks of size 2^( 5) =       0.000438352617
  error estimate for blocks of size 2^( 6) =       0.000441143911
  error estimate for blocks of size 2^( 7) =       0.000440147951

      target function =                  N/A
              le_mean =     -17.216545418533
             les_mean =     296.746294046394
             stat err =       0.000438653534
             autocorr =       1.142421348839
              std dev =       0.580394750495
             le_variance =       0.336858066402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336849229836
                                         uncertainty =       0.015726156062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336849229836
                                         uncertainty =       0.015726156062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410401064
  error estimate for blocks of size 2^( 2) =       0.000419679769
  error estimate for blocks of size 2^( 3) =       0.000428334645
  error estimate for blocks of size 2^( 4) =       0.000434969659
  error estimate for blocks of size 2^( 5) =       0.000438352617
  error estimate for blocks of size 2^( 6) =       0.000441143911
  error estimate for blocks of size 2^( 7) =       0.000440147951

      target function =                  N/A
              le_mean =     -17.216545418533
             les_mean =     296.746294046394
             stat err =       0.000438653534
             autocorr =       1.142421348839
              std dev =       0.580394750495
             le_variance =       0.336858066402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336849229836
                                         uncertainty =       0.015726156062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336849229836
                                         uncertainty =       0.015726156062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410401064
  error estimate for blocks of size 2^( 2) =       0.000419679769
  error estimate for blocks of size 2^( 3) =       0.000428334645
  error estimate for blocks of size 2^( 4) =       0.000434969659
  error estimate for blocks of size 2^( 5) =       0.000438352617
  error estimate for blocks of size 2^( 6) =       0.000441143911
  error estimate for blocks of size 2^( 7) =       0.000440147951

      target function =                  N/A
              le_mean =     -17.216545418533
             les_mean =     296.746294046394
             stat err =       0.000438653534
             autocorr =       1.142421348839
              std dev =       0.580394750495
             le_variance =       0.336858066402


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216545418533        initial  <--
     6.1035e+13     6.1035e+14             0.0000e+00       -17.216545418533
     2.4414e+14     2.4414e+15             0.0000e+00       -17.216545418533
     9.7656e+14     9.7656e+15             0.0000e+00       -17.216545418533

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2911
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5441e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1897
    reference variance = 0.113816
====================================================
  Execution time = 2.0664e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2343e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4497e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323456975067
                                         uncertainty =       0.007031902457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323456975067
                                         uncertainty =       0.007031902457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402136954
  error estimate for blocks of size 2^( 2) =       0.000411548146
  error estimate for blocks of size 2^( 3) =       0.000420238760
  error estimate for blocks of size 2^( 4) =       0.000426245169
  error estimate for blocks of size 2^( 5) =       0.000429648566
  error estimate for blocks of size 2^( 6) =       0.000430728853
  error estimate for blocks of size 2^( 7) =       0.000432489314

      target function =                  N/A
              le_mean =     -17.217110321238
             les_mean =     296.752315912162
             stat err =       0.000429777975
             autocorr =       1.142195230499
              std dev =       0.568707534853
             le_variance =       0.323428260199


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721711032124e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+14, overlap shift 6.1035e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217110321238       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217110321238       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217110321238       residual = 4.59e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.041744996839       residual = 6.30e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.339147333657       residual = 3.28e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.448210108888       residual = 7.65e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -19.801216317365       residual = 1.08e+03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -15.287135607544       residual = 5.62e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -14.395305215876       residual = 1.27e+03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -13.430213649529       residual = 2.37e+03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -19.571331829219       residual = 8.98e+02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -24.239800508377       residual = 7.77e+03           smallest_sin_value = 1.00e+00
davidson iteration   12 stopping due to too large eigenvalue change
davidson solver did not converge after         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+14 is 3.185735e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+15, overlap shift 2.4414e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217110321238       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217110321238       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217110321238       residual = 1.34e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217110321238       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+15 is 7.964337e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+15, overlap shift 9.7656e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217110321238       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217110321238       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217110321238       residual = 3.54e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.229938916773       residual = 3.73e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217110321244       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+15 is 4.947670e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.511645 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6132e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1475
    reference variance = 0.393286
====================================================
  Execution time = 2.0210e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1525e-01
  Total weights = 2.0000e+06
  Execution time = 1.8249e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315208479422
                                         uncertainty =       0.002730195542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315208479422
                                         uncertainty =       0.002730195542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397019324
  error estimate for blocks of size 2^( 2) =       0.000406965817
  error estimate for blocks of size 2^( 3) =       0.000415949276
  error estimate for blocks of size 2^( 4) =       0.000422570488
  error estimate for blocks of size 2^( 5) =       0.000426771767
  error estimate for blocks of size 2^( 6) =       0.000429296967
  error estimate for blocks of size 2^( 7) =       0.000431381321

      target function =                  N/A
              le_mean =     -17.215934610331
             les_mean =     296.703653037463
             stat err =       0.000427505136
             autocorr =       1.159469638497
              std dev =       0.561470113096
             le_variance =       0.315248687901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315208479422
                                         uncertainty =       0.002730195542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315208479422
                                         uncertainty =       0.002730195542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397019324
  error estimate for blocks of size 2^( 2) =       0.000406965817
  error estimate for blocks of size 2^( 3) =       0.000415949276
  error estimate for blocks of size 2^( 4) =       0.000422570488
  error estimate for blocks of size 2^( 5) =       0.000426771767
  error estimate for blocks of size 2^( 6) =       0.000429296967
  error estimate for blocks of size 2^( 7) =       0.000431381321

      target function =                  N/A
              le_mean =     -17.215934610331
             les_mean =     296.703653037463
             stat err =       0.000427505136
             autocorr =       1.159469638497
              std dev =       0.561470113096
             le_variance =       0.315248687901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315208479422
                                         uncertainty =       0.002730195542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315208479422
                                         uncertainty =       0.002730195542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397019324
  error estimate for blocks of size 2^( 2) =       0.000406965817
  error estimate for blocks of size 2^( 3) =       0.000415949276
  error estimate for blocks of size 2^( 4) =       0.000422570488
  error estimate for blocks of size 2^( 5) =       0.000426771767
  error estimate for blocks of size 2^( 6) =       0.000429296967
  error estimate for blocks of size 2^( 7) =       0.000431381321

      target function =                  N/A
              le_mean =     -17.215934610331
             les_mean =     296.703653037463
             stat err =       0.000427505136
             autocorr =       1.159469638497
              std dev =       0.561470113096
             le_variance =       0.315248687901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315208479422
                                         uncertainty =       0.002730195542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315208479422
                                         uncertainty =       0.002730195542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397019324
  error estimate for blocks of size 2^( 2) =       0.000406965817
  error estimate for blocks of size 2^( 3) =       0.000415949276
  error estimate for blocks of size 2^( 4) =       0.000422570488
  error estimate for blocks of size 2^( 5) =       0.000426771767
  error estimate for blocks of size 2^( 6) =       0.000429296967
  error estimate for blocks of size 2^( 7) =       0.000431381321

      target function =                  N/A
              le_mean =     -17.215934610331
             les_mean =     296.703653037463
             stat err =       0.000427505136
             autocorr =       1.159469638497
              std dev =       0.561470113096
             le_variance =       0.315248687901


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215934610331        initial  <--
     6.1035e+14     6.1035e+15             3.1857e-19       -17.215934610331
     2.4414e+15     2.4414e+16             7.9643e-20       -17.215934610331
     9.7656e+15     9.7656e+16             4.9477e-20       -17.215934610331

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4074
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5587e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2229
    reference variance = 0.218014
====================================================
  Execution time = 2.1243e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1728e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8649e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317277450798
                                         uncertainty =       0.003894513046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317277450798
                                         uncertainty =       0.003894513046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398293919
  error estimate for blocks of size 2^( 2) =       0.000408602558
  error estimate for blocks of size 2^( 3) =       0.000417546872
  error estimate for blocks of size 2^( 4) =       0.000423389651
  error estimate for blocks of size 2^( 5) =       0.000426600892
  error estimate for blocks of size 2^( 6) =       0.000427584137
  error estimate for blocks of size 2^( 7) =       0.000429876070

      target function =                  N/A
              le_mean =     -17.216228145471
             les_mean =     296.715787489671
             stat err =       0.000426862687
             autocorr =       1.148600595678
              std dev =       0.563272661684
             le_variance =       0.317276091401


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721622814547e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+15, overlap shift 6.1035e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216228145471       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216228145471       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216228145471       residual = 2.02e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216228145471       residual = 5.15e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.346826761983       residual = 1.25e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+15 is 1.594851e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+16, overlap shift 2.4414e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216228145471       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216228145471       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216228145471       residual = 3.66e+00           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+16 is 3.987129e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+16, overlap shift 9.7656e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216228145471       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216228145471       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216228145471       residual = 2.17e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -21.538385294458       residual = 2.90e+03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -20.614738477800       residual = 1.80e+03           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+16 is 9.967821e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.529786 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8666e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2671
    reference variance = 0.362127
====================================================
  Execution time = 2.0909e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2100e-01
  Total weights = 2.0000e+06
  Execution time = 1.8269e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320995625741
                                         uncertainty =       0.003576544386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320995625741
                                         uncertainty =       0.003576544386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400624133
  error estimate for blocks of size 2^( 2) =       0.000410735081
  error estimate for blocks of size 2^( 3) =       0.000419832563
  error estimate for blocks of size 2^( 4) =       0.000425738048
  error estimate for blocks of size 2^( 5) =       0.000430228847
  error estimate for blocks of size 2^( 6) =       0.000432168216
  error estimate for blocks of size 2^( 7) =       0.000433332994

      target function =                  N/A
              le_mean =     -17.216106564123
             les_mean =     296.715324458058
             stat err =       0.000430367026
             autocorr =       1.153994568866
              std dev =       0.566568081803
             le_variance =       0.320999391318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320995625741
                                         uncertainty =       0.003576544386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320995625741
                                         uncertainty =       0.003576544386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400624133
  error estimate for blocks of size 2^( 2) =       0.000410735081
  error estimate for blocks of size 2^( 3) =       0.000419832563
  error estimate for blocks of size 2^( 4) =       0.000425738048
  error estimate for blocks of size 2^( 5) =       0.000430228847
  error estimate for blocks of size 2^( 6) =       0.000432168216
  error estimate for blocks of size 2^( 7) =       0.000433332994

      target function =                  N/A
              le_mean =     -17.216106564123
             les_mean =     296.715324458058
             stat err =       0.000430367026
             autocorr =       1.153994568866
              std dev =       0.566568081803
             le_variance =       0.320999391318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320995625741
                                         uncertainty =       0.003576544386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320995625741
                                         uncertainty =       0.003576544386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400624133
  error estimate for blocks of size 2^( 2) =       0.000410735081
  error estimate for blocks of size 2^( 3) =       0.000419832563
  error estimate for blocks of size 2^( 4) =       0.000425738048
  error estimate for blocks of size 2^( 5) =       0.000430228847
  error estimate for blocks of size 2^( 6) =       0.000432168216
  error estimate for blocks of size 2^( 7) =       0.000433332994

      target function =                  N/A
              le_mean =     -17.216106564123
             les_mean =     296.715324458058
             stat err =       0.000430367026
             autocorr =       1.153994568866
              std dev =       0.566568081803
             le_variance =       0.320999391318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320995625741
                                         uncertainty =       0.003576544386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320995625741
                                         uncertainty =       0.003576544386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400624133
  error estimate for blocks of size 2^( 2) =       0.000410735081
  error estimate for blocks of size 2^( 3) =       0.000419832563
  error estimate for blocks of size 2^( 4) =       0.000425738048
  error estimate for blocks of size 2^( 5) =       0.000430228847
  error estimate for blocks of size 2^( 6) =       0.000432168216
  error estimate for blocks of size 2^( 7) =       0.000433332994

      target function =                  N/A
              le_mean =     -17.216106564123
             les_mean =     296.715324458058
             stat err =       0.000430367026
             autocorr =       1.153994568866
              std dev =       0.566568081803
             le_variance =       0.320999391318


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216106564123        initial  <--
     6.1035e+15     6.1035e+16             1.5949e-20       -17.216106564123
     2.4414e+16     2.4414e+17             3.9871e-21       -17.216106564123
     9.7656e+16     9.7656e+17             9.9678e-22       -17.216106564123

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0744
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9198e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1962
    reference variance = 0.161563
====================================================
  Execution time = 2.1615e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2039e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5769e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320446150996
                                         uncertainty =       0.004719549912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320446150996
                                         uncertainty =       0.004719549912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400244425
  error estimate for blocks of size 2^( 2) =       0.000409625526
  error estimate for blocks of size 2^( 3) =       0.000418814297
  error estimate for blocks of size 2^( 4) =       0.000424756385
  error estimate for blocks of size 2^( 5) =       0.000428247133
  error estimate for blocks of size 2^( 6) =       0.000430375153
  error estimate for blocks of size 2^( 7) =       0.000431089761

      target function =                  N/A
              le_mean =     -17.217143759130
             les_mean =     296.750430262441
             stat err =       0.000428617108
             autocorr =       1.146801942550
              std dev =       0.566031094639
             le_variance =       0.320391200098


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721714375913e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+16, overlap shift 6.1035e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217143759130       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217143759130       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+17, overlap shift 2.4414e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217143759130       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217143759130       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217143759130       residual = 1.46e-01           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+17 is 5.713444e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+17, overlap shift 9.7656e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217143759130       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217143759130       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217143759130       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+17 is 1.428361e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.531026 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7201e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.3018
    reference variance = 0.262463
====================================================
  Execution time = 2.2989e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2544e-01
  Total weights = 2.0000e+06
  Execution time = 1.8236e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325462462991
                                         uncertainty =       0.007515317611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325462462991
                                         uncertainty =       0.007515317611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403384935
  error estimate for blocks of size 2^( 2) =       0.000413307337
  error estimate for blocks of size 2^( 3) =       0.000422535186
  error estimate for blocks of size 2^( 4) =       0.000429008070
  error estimate for blocks of size 2^( 5) =       0.000433211501
  error estimate for blocks of size 2^( 6) =       0.000436432529
  error estimate for blocks of size 2^( 7) =       0.000437598099

      target function =                  N/A
              le_mean =     -17.217659442130
             les_mean =     296.773235314195
             stat err =       0.000434062550
             autocorr =       1.157884617999
              std dev =       0.570472446082
             le_variance =       0.325438811739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325462462991
                                         uncertainty =       0.007515317611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325462462991
                                         uncertainty =       0.007515317611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403384935
  error estimate for blocks of size 2^( 2) =       0.000413307337
  error estimate for blocks of size 2^( 3) =       0.000422535186
  error estimate for blocks of size 2^( 4) =       0.000429008070
  error estimate for blocks of size 2^( 5) =       0.000433211501
  error estimate for blocks of size 2^( 6) =       0.000436432529
  error estimate for blocks of size 2^( 7) =       0.000437598099

      target function =                  N/A
              le_mean =     -17.217659442130
             les_mean =     296.773235314195
             stat err =       0.000434062550
             autocorr =       1.157884617999
              std dev =       0.570472446082
             le_variance =       0.325438811739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325462462991
                                         uncertainty =       0.007515317611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325462462991
                                         uncertainty =       0.007515317611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403384935
  error estimate for blocks of size 2^( 2) =       0.000413307337
  error estimate for blocks of size 2^( 3) =       0.000422535186
  error estimate for blocks of size 2^( 4) =       0.000429008070
  error estimate for blocks of size 2^( 5) =       0.000433211501
  error estimate for blocks of size 2^( 6) =       0.000436432529
  error estimate for blocks of size 2^( 7) =       0.000437598099

      target function =                  N/A
              le_mean =     -17.217659442130
             les_mean =     296.773235314195
             stat err =       0.000434062550
             autocorr =       1.157884617999
              std dev =       0.570472446082
             le_variance =       0.325438811739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325462462991
                                         uncertainty =       0.007515317611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325462462991
                                         uncertainty =       0.007515317611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403384935
  error estimate for blocks of size 2^( 2) =       0.000413307337
  error estimate for blocks of size 2^( 3) =       0.000422535186
  error estimate for blocks of size 2^( 4) =       0.000429008070
  error estimate for blocks of size 2^( 5) =       0.000433211501
  error estimate for blocks of size 2^( 6) =       0.000436432529
  error estimate for blocks of size 2^( 7) =       0.000437598099

      target function =                  N/A
              le_mean =     -17.217659442130
             les_mean =     296.773235314195
             stat err =       0.000434062550
             autocorr =       1.157884617999
              std dev =       0.570472446082
             le_variance =       0.325438811739


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217659442130        initial  <--
     6.1035e+16     6.1035e+17             0.0000e+00       -17.217659442130
     2.4414e+17     2.4414e+18             5.7134e-22       -17.217659442130
     9.7656e+17     9.7656e+18             1.4284e-22       -17.217659442130

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.1763
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0123e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.246
    reference variance = 0.241464
====================================================
  Execution time = 2.0712e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1576e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5679e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315819377885
                                         uncertainty =       0.002948511439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315819377885
                                         uncertainty =       0.002948511439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397340417
  error estimate for blocks of size 2^( 2) =       0.000407023961
  error estimate for blocks of size 2^( 3) =       0.000415881237
  error estimate for blocks of size 2^( 4) =       0.000422199397
  error estimate for blocks of size 2^( 5) =       0.000426589297
  error estimate for blocks of size 2^( 6) =       0.000429692078
  error estimate for blocks of size 2^( 7) =       0.000432254725

      target function =                  N/A
              le_mean =     -17.216171925649
             les_mean =     296.712334429368
             stat err =       0.000427683874
             autocorr =       1.158564626531
              std dev =       0.561924206391
             le_variance =       0.315758813728


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721617192565e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+17, overlap shift 6.1035e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216171925649       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216171925649       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+18, overlap shift 2.4414e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216171925649       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216171925649       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+18, overlap shift 9.7656e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216171925649       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216171925649       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.532078 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6289e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.148
    reference variance = 0.309875
====================================================
  Execution time = 2.0745e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1171e-01
  Total weights = 2.0000e+06
  Execution time = 1.8260e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311707831226
                                         uncertainty =       0.002316975599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311707831226
                                         uncertainty =       0.002316975599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394786626
  error estimate for blocks of size 2^( 2) =       0.000405011444
  error estimate for blocks of size 2^( 3) =       0.000413456944
  error estimate for blocks of size 2^( 4) =       0.000419886334
  error estimate for blocks of size 2^( 5) =       0.000423499988
  error estimate for blocks of size 2^( 6) =       0.000426593722
  error estimate for blocks of size 2^( 7) =       0.000427195975

      target function =                  N/A
              le_mean =     -17.216447364029
             les_mean =     296.717772643233
             stat err =       0.000424294005
             autocorr =       1.155071653908
              std dev =       0.558312601260
             le_variance =       0.311712960725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311707831226
                                         uncertainty =       0.002316975599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311707831226
                                         uncertainty =       0.002316975599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394786626
  error estimate for blocks of size 2^( 2) =       0.000405011444
  error estimate for blocks of size 2^( 3) =       0.000413456944
  error estimate for blocks of size 2^( 4) =       0.000419886334
  error estimate for blocks of size 2^( 5) =       0.000423499988
  error estimate for blocks of size 2^( 6) =       0.000426593722
  error estimate for blocks of size 2^( 7) =       0.000427195975

      target function =                  N/A
              le_mean =     -17.216447364029
             les_mean =     296.717772643233
             stat err =       0.000424294005
             autocorr =       1.155071653908
              std dev =       0.558312601260
             le_variance =       0.311712960725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311707831226
                                         uncertainty =       0.002316975599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311707831226
                                         uncertainty =       0.002316975599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394786626
  error estimate for blocks of size 2^( 2) =       0.000405011444
  error estimate for blocks of size 2^( 3) =       0.000413456944
  error estimate for blocks of size 2^( 4) =       0.000419886334
  error estimate for blocks of size 2^( 5) =       0.000423499988
  error estimate for blocks of size 2^( 6) =       0.000426593722
  error estimate for blocks of size 2^( 7) =       0.000427195975

      target function =                  N/A
              le_mean =     -17.216447364029
             les_mean =     296.717772643233
             stat err =       0.000424294005
             autocorr =       1.155071653908
              std dev =       0.558312601260
             le_variance =       0.311712960725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311707831226
                                         uncertainty =       0.002316975599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311707831226
                                         uncertainty =       0.002316975599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394786626
  error estimate for blocks of size 2^( 2) =       0.000405011444
  error estimate for blocks of size 2^( 3) =       0.000413456944
  error estimate for blocks of size 2^( 4) =       0.000419886334
  error estimate for blocks of size 2^( 5) =       0.000423499988
  error estimate for blocks of size 2^( 6) =       0.000426593722
  error estimate for blocks of size 2^( 7) =       0.000427195975

      target function =                  N/A
              le_mean =     -17.216447364029
             les_mean =     296.717772643233
             stat err =       0.000424294005
             autocorr =       1.155071653908
              std dev =       0.558312601260
             le_variance =       0.311712960725


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216447364029        initial  <--
     6.1035e+17     6.1035e+18             0.0000e+00       -17.216447364029
     2.4414e+18     2.4414e+19             0.0000e+00       -17.216447364029
     9.7656e+18     9.7656e+19             0.0000e+00       -17.216447364029

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9363
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6358e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2032
    reference variance = 0.364912
====================================================
  Execution time = 2.0138e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1840e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4937e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314451540983
                                         uncertainty =       0.002624564229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314451540983
                                         uncertainty =       0.002624564229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399001444
  error estimate for blocks of size 2^( 2) =       0.000408383217
  error estimate for blocks of size 2^( 3) =       0.000416929675
  error estimate for blocks of size 2^( 4) =       0.000422681245
  error estimate for blocks of size 2^( 5) =       0.000424729777
  error estimate for blocks of size 2^( 6) =       0.000425920378
  error estimate for blocks of size 2^( 7) =       0.000429407318

      target function =                  N/A
              le_mean =     -17.217080882810
             les_mean =     296.746278270492
             stat err =       0.000425684679
             autocorr =       1.138222339247
              std dev =       0.564273253368
             le_variance =       0.318404304467


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721708088281e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+18, overlap shift 6.1035e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217080882810       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217080882810       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217080882811       residual = 4.56e-01           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+18 is 1.709800e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+19, overlap shift 2.4414e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217080882810       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217080882810       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217080882809       residual = 1.82e+00           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+19 is 4.274500e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+19, overlap shift 9.7656e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217080882810       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217080882810       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217080882811       residual = 7.26e+00           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+19 is 1.068625e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.533381 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5640e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2426
    reference variance = 0.168527
====================================================
  Execution time = 2.0536e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2396e-01
  Total weights = 2.0000e+06
  Execution time = 1.8249e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324049982813
                                         uncertainty =       0.009328982601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324049982813
                                         uncertainty =       0.009328982601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402469427
  error estimate for blocks of size 2^( 2) =       0.000411980730
  error estimate for blocks of size 2^( 3) =       0.000420432517
  error estimate for blocks of size 2^( 4) =       0.000427062724
  error estimate for blocks of size 2^( 5) =       0.000431502067
  error estimate for blocks of size 2^( 6) =       0.000432973323
  error estimate for blocks of size 2^( 7) =       0.000434574076

      target function =                  N/A
              le_mean =     -17.216948986476
             les_mean =     296.747295519742
             stat err =       0.000431528048
             autocorr =       1.149614589069
              std dev =       0.569177721630
             le_variance =       0.323963278800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324049982813
                                         uncertainty =       0.009328982601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324049982813
                                         uncertainty =       0.009328982601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402469427
  error estimate for blocks of size 2^( 2) =       0.000411980730
  error estimate for blocks of size 2^( 3) =       0.000420432517
  error estimate for blocks of size 2^( 4) =       0.000427062724
  error estimate for blocks of size 2^( 5) =       0.000431502067
  error estimate for blocks of size 2^( 6) =       0.000432973323
  error estimate for blocks of size 2^( 7) =       0.000434574076

      target function =                  N/A
              le_mean =     -17.216948986476
             les_mean =     296.747295519742
             stat err =       0.000431528048
             autocorr =       1.149614589069
              std dev =       0.569177721630
             le_variance =       0.323963278800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324049982813
                                         uncertainty =       0.009328982601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324049982813
                                         uncertainty =       0.009328982601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402469427
  error estimate for blocks of size 2^( 2) =       0.000411980730
  error estimate for blocks of size 2^( 3) =       0.000420432517
  error estimate for blocks of size 2^( 4) =       0.000427062724
  error estimate for blocks of size 2^( 5) =       0.000431502067
  error estimate for blocks of size 2^( 6) =       0.000432973323
  error estimate for blocks of size 2^( 7) =       0.000434574076

      target function =                  N/A
              le_mean =     -17.216948986476
             les_mean =     296.747295519742
             stat err =       0.000431528048
             autocorr =       1.149614589069
              std dev =       0.569177721630
             le_variance =       0.323963278800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324049982813
                                         uncertainty =       0.009328982601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324049982813
                                         uncertainty =       0.009328982601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402469427
  error estimate for blocks of size 2^( 2) =       0.000411980730
  error estimate for blocks of size 2^( 3) =       0.000420432517
  error estimate for blocks of size 2^( 4) =       0.000427062724
  error estimate for blocks of size 2^( 5) =       0.000431502067
  error estimate for blocks of size 2^( 6) =       0.000432973323
  error estimate for blocks of size 2^( 7) =       0.000434574076

      target function =                  N/A
              le_mean =     -17.216948986476
             les_mean =     296.747295519742
             stat err =       0.000431528048
             autocorr =       1.149614589069
              std dev =       0.569177721630
             le_variance =       0.323963278800


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216948986476        initial  <--
     6.1035e+18     6.1035e+19             1.7098e-23       -17.216948986476
     2.4414e+19     2.4414e+20             4.2745e-24       -17.216948986476
     9.7656e+19     9.7656e+20             1.0686e-24       -17.216948986476

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7266
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6126e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1872
    reference variance = 0.166119
====================================================
  Execution time = 2.0835e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2074e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4627e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320785996399
                                         uncertainty =       0.003936236341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320785996399
                                         uncertainty =       0.003936236341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400460792
  error estimate for blocks of size 2^( 2) =       0.000409966168
  error estimate for blocks of size 2^( 3) =       0.000418652415
  error estimate for blocks of size 2^( 4) =       0.000425339350
  error estimate for blocks of size 2^( 5) =       0.000429103213
  error estimate for blocks of size 2^( 6) =       0.000431797445
  error estimate for blocks of size 2^( 7) =       0.000431879376

      target function =                  N/A
              le_mean =     -17.216344866368
             les_mean =     296.723268088705
             stat err =       0.000429529846
             autocorr =       1.150447194626
              std dev =       0.566337082800
             le_variance =       0.320737691354


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721634486637e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+19, overlap shift 6.1035e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216344866368       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216344866368       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+20, overlap shift 2.4414e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216344866368       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216344866368       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+20, overlap shift 9.7656e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216344866368       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216344866368       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.534456 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6307e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2165
    reference variance = 0.462447
====================================================
  Execution time = 1.9999e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.6066e-01
  Total weights = 2.0000e+06
  Execution time = 1.8333e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360548501579
                                         uncertainty =       0.041558316479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360548501579
                                         uncertainty =       0.041558316479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424651814
  error estimate for blocks of size 2^( 2) =       0.000433640555
  error estimate for blocks of size 2^( 3) =       0.000441662530
  error estimate for blocks of size 2^( 4) =       0.000447842306
  error estimate for blocks of size 2^( 5) =       0.000451079941
  error estimate for blocks of size 2^( 6) =       0.000454118923
  error estimate for blocks of size 2^( 7) =       0.000455268589

      target function =                  N/A
              le_mean =     -17.216606576745
             les_mean =     296.772200164350
             stat err =       0.000452077440
             autocorr =       1.133338655967
              std dev =       0.600548354632
             le_variance =       0.360658326252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360548501579
                                         uncertainty =       0.041558316479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360548501579
                                         uncertainty =       0.041558316479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424651814
  error estimate for blocks of size 2^( 2) =       0.000433640555
  error estimate for blocks of size 2^( 3) =       0.000441662530
  error estimate for blocks of size 2^( 4) =       0.000447842306
  error estimate for blocks of size 2^( 5) =       0.000451079941
  error estimate for blocks of size 2^( 6) =       0.000454118923
  error estimate for blocks of size 2^( 7) =       0.000455268589

      target function =                  N/A
              le_mean =     -17.216606576745
             les_mean =     296.772200164350
             stat err =       0.000452077440
             autocorr =       1.133338655967
              std dev =       0.600548354632
             le_variance =       0.360658326252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360548501579
                                         uncertainty =       0.041558316479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360548501579
                                         uncertainty =       0.041558316479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424651814
  error estimate for blocks of size 2^( 2) =       0.000433640555
  error estimate for blocks of size 2^( 3) =       0.000441662530
  error estimate for blocks of size 2^( 4) =       0.000447842306
  error estimate for blocks of size 2^( 5) =       0.000451079941
  error estimate for blocks of size 2^( 6) =       0.000454118923
  error estimate for blocks of size 2^( 7) =       0.000455268589

      target function =                  N/A
              le_mean =     -17.216606576745
             les_mean =     296.772200164350
             stat err =       0.000452077440
             autocorr =       1.133338655967
              std dev =       0.600548354632
             le_variance =       0.360658326252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360548501579
                                         uncertainty =       0.041558316479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360548501579
                                         uncertainty =       0.041558316479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424651814
  error estimate for blocks of size 2^( 2) =       0.000433640555
  error estimate for blocks of size 2^( 3) =       0.000441662530
  error estimate for blocks of size 2^( 4) =       0.000447842306
  error estimate for blocks of size 2^( 5) =       0.000451079941
  error estimate for blocks of size 2^( 6) =       0.000454118923
  error estimate for blocks of size 2^( 7) =       0.000455268589

      target function =                  N/A
              le_mean =     -17.216606576745
             les_mean =     296.772200164350
             stat err =       0.000452077440
             autocorr =       1.133338655967
              std dev =       0.600548354632
             le_variance =       0.360658326252


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216606576745        initial  <--
     6.1035e+19     6.1035e+20             0.0000e+00       -17.216606576745
     2.4414e+20     2.4414e+21             0.0000e+00       -17.216606576745
     9.7656e+20     9.7656e+21             0.0000e+00       -17.216606576745

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2108
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6070e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2116
    reference variance = 0.324304
====================================================
  Execution time = 2.0149e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4458e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344657923756
                                         uncertainty =       0.027540336064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344657923756
                                         uncertainty =       0.027540336064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415077532
  error estimate for blocks of size 2^( 2) =       0.000424155259
  error estimate for blocks of size 2^( 3) =       0.000432457307
  error estimate for blocks of size 2^( 4) =       0.000439093124
  error estimate for blocks of size 2^( 5) =       0.000443294876
  error estimate for blocks of size 2^( 6) =       0.000445778394
  error estimate for blocks of size 2^( 7) =       0.000446857310

      target function =                  N/A
              le_mean =     -17.216821709343
             les_mean =     296.763528314755
             stat err =       0.000443755926
             autocorr =       1.142956966839
              std dev =       0.587008275706
             le_variance =       0.344578715747


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721682170934e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+20, overlap shift 6.1035e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216821709343       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216821709343       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+21, overlap shift 2.4414e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216821709343       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216821709343       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+21, overlap shift 9.7656e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216821709343       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216821709343       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.535546 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5663e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1526
    reference variance = 0.345443
====================================================
  Execution time = 2.2507e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2262e-01
  Total weights = 2.0000e+06
  Execution time = 1.8173e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322616174079
                                         uncertainty =       0.004034235936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322616174079
                                         uncertainty =       0.004034235936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401633397
  error estimate for blocks of size 2^( 2) =       0.000411348486
  error estimate for blocks of size 2^( 3) =       0.000419968267
  error estimate for blocks of size 2^( 4) =       0.000425498327
  error estimate for blocks of size 2^( 5) =       0.000430851936
  error estimate for blocks of size 2^( 6) =       0.000432663202
  error estimate for blocks of size 2^( 7) =       0.000433896780

      target function =                  N/A
              le_mean =     -17.216709178488
             les_mean =     296.737693547035
             stat err =       0.000430727561
             autocorr =       1.150126702601
              std dev =       0.567995397614
             le_variance =       0.322618771711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322616174079
                                         uncertainty =       0.004034235936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322616174079
                                         uncertainty =       0.004034235936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401633397
  error estimate for blocks of size 2^( 2) =       0.000411348486
  error estimate for blocks of size 2^( 3) =       0.000419968267
  error estimate for blocks of size 2^( 4) =       0.000425498327
  error estimate for blocks of size 2^( 5) =       0.000430851936
  error estimate for blocks of size 2^( 6) =       0.000432663202
  error estimate for blocks of size 2^( 7) =       0.000433896780

      target function =                  N/A
              le_mean =     -17.216709178488
             les_mean =     296.737693547035
             stat err =       0.000430727561
             autocorr =       1.150126702601
              std dev =       0.567995397614
             le_variance =       0.322618771711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322616174079
                                         uncertainty =       0.004034235936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322616174079
                                         uncertainty =       0.004034235936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401633397
  error estimate for blocks of size 2^( 2) =       0.000411348486
  error estimate for blocks of size 2^( 3) =       0.000419968267
  error estimate for blocks of size 2^( 4) =       0.000425498327
  error estimate for blocks of size 2^( 5) =       0.000430851936
  error estimate for blocks of size 2^( 6) =       0.000432663202
  error estimate for blocks of size 2^( 7) =       0.000433896780

      target function =                  N/A
              le_mean =     -17.216709178488
             les_mean =     296.737693547035
             stat err =       0.000430727561
             autocorr =       1.150126702601
              std dev =       0.567995397614
             le_variance =       0.322618771711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322616174079
                                         uncertainty =       0.004034235936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322616174079
                                         uncertainty =       0.004034235936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401633397
  error estimate for blocks of size 2^( 2) =       0.000411348486
  error estimate for blocks of size 2^( 3) =       0.000419968267
  error estimate for blocks of size 2^( 4) =       0.000425498327
  error estimate for blocks of size 2^( 5) =       0.000430851936
  error estimate for blocks of size 2^( 6) =       0.000432663202
  error estimate for blocks of size 2^( 7) =       0.000433896780

      target function =                  N/A
              le_mean =     -17.216709178488
             les_mean =     296.737693547035
             stat err =       0.000430727561
             autocorr =       1.150126702601
              std dev =       0.567995397614
             le_variance =       0.322618771711


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216709178488        initial  <--
     6.1035e+20     6.1035e+21             0.0000e+00       -17.216709178488
     2.4414e+21     2.4414e+22             0.0000e+00       -17.216709178488
     9.7656e+21     9.7656e+22             0.0000e+00       -17.216709178488

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.6703
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7574e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.3483
    reference variance = 0.458736
====================================================
  Execution time = 2.0033e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1216e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5405e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312169591795
                                         uncertainty =       0.002608981606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312169591795
                                         uncertainty =       0.002608981606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395069452
  error estimate for blocks of size 2^( 2) =       0.000405177815
  error estimate for blocks of size 2^( 3) =       0.000414017081
  error estimate for blocks of size 2^( 4) =       0.000420734073
  error estimate for blocks of size 2^( 5) =       0.000424339054
  error estimate for blocks of size 2^( 6) =       0.000426968913
  error estimate for blocks of size 2^( 7) =       0.000427893398

      target function =                  N/A
              le_mean =     -17.216282023792
             les_mean =     296.712526310393
             stat err =       0.000424983859
             autocorr =       1.157172149269
              std dev =       0.558712577022
             le_variance =       0.312159743723


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721628202379e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+21, overlap shift 6.1035e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216282023792       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216282023792       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216282023792       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+21 is 1.508879e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+22, overlap shift 2.4414e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216282023792       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216282023792       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216282023792       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+22 is 3.772199e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+22, overlap shift 9.7656e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216282023792       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216282023792       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216282023792       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+22 is 9.430497e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.536998 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5583e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1405
    reference variance = 0.319996
====================================================
  Execution time = 1.9869e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1831e-01
  Total weights = 2.0000e+06
  Execution time = 1.8168e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318400280548
                                         uncertainty =       0.009248987283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318400280548
                                         uncertainty =       0.009248987283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398944927
  error estimate for blocks of size 2^( 2) =       0.000408932007
  error estimate for blocks of size 2^( 3) =       0.000417516752
  error estimate for blocks of size 2^( 4) =       0.000424186250
  error estimate for blocks of size 2^( 5) =       0.000428076898
  error estimate for blocks of size 2^( 6) =       0.000430415418
  error estimate for blocks of size 2^( 7) =       0.000433987115

      target function =                  N/A
              le_mean =     -17.217170376986
             les_mean =     296.749269739829
             stat err =       0.000429166420
             autocorr =       1.157245695982
              std dev =       0.564193325765
             le_variance =       0.318314108838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318400280548
                                         uncertainty =       0.009248987283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318400280548
                                         uncertainty =       0.009248987283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398944927
  error estimate for blocks of size 2^( 2) =       0.000408932007
  error estimate for blocks of size 2^( 3) =       0.000417516752
  error estimate for blocks of size 2^( 4) =       0.000424186250
  error estimate for blocks of size 2^( 5) =       0.000428076898
  error estimate for blocks of size 2^( 6) =       0.000430415418
  error estimate for blocks of size 2^( 7) =       0.000433987115

      target function =                  N/A
              le_mean =     -17.217170376986
             les_mean =     296.749269739829
             stat err =       0.000429166420
             autocorr =       1.157245695982
              std dev =       0.564193325765
             le_variance =       0.318314108838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318400280548
                                         uncertainty =       0.009248987283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318400280548
                                         uncertainty =       0.009248987283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398944927
  error estimate for blocks of size 2^( 2) =       0.000408932007
  error estimate for blocks of size 2^( 3) =       0.000417516752
  error estimate for blocks of size 2^( 4) =       0.000424186250
  error estimate for blocks of size 2^( 5) =       0.000428076898
  error estimate for blocks of size 2^( 6) =       0.000430415418
  error estimate for blocks of size 2^( 7) =       0.000433987115

      target function =                  N/A
              le_mean =     -17.217170376986
             les_mean =     296.749269739829
             stat err =       0.000429166420
             autocorr =       1.157245695982
              std dev =       0.564193325765
             le_variance =       0.318314108838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318400280548
                                         uncertainty =       0.009248987283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318400280548
                                         uncertainty =       0.009248987283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398944927
  error estimate for blocks of size 2^( 2) =       0.000408932007
  error estimate for blocks of size 2^( 3) =       0.000417516752
  error estimate for blocks of size 2^( 4) =       0.000424186250
  error estimate for blocks of size 2^( 5) =       0.000428076898
  error estimate for blocks of size 2^( 6) =       0.000430415418
  error estimate for blocks of size 2^( 7) =       0.000433987115

      target function =                  N/A
              le_mean =     -17.217170376986
             les_mean =     296.749269739829
             stat err =       0.000429166420
             autocorr =       1.157245695982
              std dev =       0.564193325765
             le_variance =       0.318314108838


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217170376986        initial  <--
     6.1035e+21     6.1035e+22             1.5089e-26       -17.217170376986
     2.4414e+22     2.4414e+23             3.7722e-27       -17.217170376986
     9.7656e+22     9.7656e+23             9.4305e-28       -17.217170376986

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0175
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5159e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1733
    reference variance = 0.256461
====================================================
  Execution time = 2.0318e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1680e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5471e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316828707819
                                         uncertainty =       0.003999658755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316828707819
                                         uncertainty =       0.003999658755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397996431
  error estimate for blocks of size 2^( 2) =       0.000407853544
  error estimate for blocks of size 2^( 3) =       0.000416690115
  error estimate for blocks of size 2^( 4) =       0.000423568661
  error estimate for blocks of size 2^( 5) =       0.000428040146
  error estimate for blocks of size 2^( 6) =       0.000428744658
  error estimate for blocks of size 2^( 7) =       0.000431129017

      target function =                  N/A
              le_mean =     -17.216306188513
             les_mean =     296.718000936812
             stat err =       0.000427870620
             autocorr =       1.155757121315
              std dev =       0.562851950863
             le_variance =       0.316802318591


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721630618851e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+22, overlap shift 6.1035e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216306188513       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216306188513       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216306188513       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+23, overlap shift 2.4414e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216306188513       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216306188513       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216306188513       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+23, overlap shift 9.7656e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216306188513       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216306188513       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216306188513       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.538371 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5874e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2011
    reference variance = 0.140156
====================================================
  Execution time = 2.0203e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2740e-01
  Total weights = 2.0000e+06
  Execution time = 1.8249e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327503766969
                                         uncertainty =       0.013898845866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327503766969
                                         uncertainty =       0.013898845866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404595705
  error estimate for blocks of size 2^( 2) =       0.000413870346
  error estimate for blocks of size 2^( 3) =       0.000421774294
  error estimate for blocks of size 2^( 4) =       0.000428673699
  error estimate for blocks of size 2^( 5) =       0.000432418161
  error estimate for blocks of size 2^( 6) =       0.000435813513
  error estimate for blocks of size 2^( 7) =       0.000435702144

      target function =                  N/A
              le_mean =     -17.217297886340
             les_mean =     296.762741712043
             stat err =       0.000433151879
             autocorr =       1.146140528597
              std dev =       0.572184733079
             le_variance =       0.327395368768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327503766969
                                         uncertainty =       0.013898845866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327503766969
                                         uncertainty =       0.013898845866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404595705
  error estimate for blocks of size 2^( 2) =       0.000413870346
  error estimate for blocks of size 2^( 3) =       0.000421774294
  error estimate for blocks of size 2^( 4) =       0.000428673699
  error estimate for blocks of size 2^( 5) =       0.000432418161
  error estimate for blocks of size 2^( 6) =       0.000435813513
  error estimate for blocks of size 2^( 7) =       0.000435702144

      target function =                  N/A
              le_mean =     -17.217297886340
             les_mean =     296.762741712043
             stat err =       0.000433151879
             autocorr =       1.146140528597
              std dev =       0.572184733079
             le_variance =       0.327395368768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327503766969
                                         uncertainty =       0.013898845866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327503766969
                                         uncertainty =       0.013898845866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404595705
  error estimate for blocks of size 2^( 2) =       0.000413870346
  error estimate for blocks of size 2^( 3) =       0.000421774294
  error estimate for blocks of size 2^( 4) =       0.000428673699
  error estimate for blocks of size 2^( 5) =       0.000432418161
  error estimate for blocks of size 2^( 6) =       0.000435813513
  error estimate for blocks of size 2^( 7) =       0.000435702144

      target function =                  N/A
              le_mean =     -17.217297886340
             les_mean =     296.762741712043
             stat err =       0.000433151879
             autocorr =       1.146140528597
              std dev =       0.572184733079
             le_variance =       0.327395368768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327503766969
                                         uncertainty =       0.013898845866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327503766969
                                         uncertainty =       0.013898845866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404595705
  error estimate for blocks of size 2^( 2) =       0.000413870346
  error estimate for blocks of size 2^( 3) =       0.000421774294
  error estimate for blocks of size 2^( 4) =       0.000428673699
  error estimate for blocks of size 2^( 5) =       0.000432418161
  error estimate for blocks of size 2^( 6) =       0.000435813513
  error estimate for blocks of size 2^( 7) =       0.000435702144

      target function =                  N/A
              le_mean =     -17.217297886340
             les_mean =     296.762741712043
             stat err =       0.000433151879
             autocorr =       1.146140528597
              std dev =       0.572184733079
             le_variance =       0.327395368768


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217297886340        initial  <--
     6.1035e+22     6.1035e+23             0.0000e+00       -17.217297886340
     2.4414e+23     2.4414e+24             0.0000e+00       -17.217297886340
     9.7656e+23     9.7656e+24             0.0000e+00       -17.217297886340

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3962
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5542e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1641
    reference variance = 0.230149
====================================================
  Execution time = 2.0404e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1506e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5078e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315096045293
                                         uncertainty =       0.003514717545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315096045293
                                         uncertainty =       0.003514717545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396898722
  error estimate for blocks of size 2^( 2) =       0.000406635950
  error estimate for blocks of size 2^( 3) =       0.000415824519
  error estimate for blocks of size 2^( 4) =       0.000422422821
  error estimate for blocks of size 2^( 5) =       0.000426679394
  error estimate for blocks of size 2^( 6) =       0.000427171167
  error estimate for blocks of size 2^( 7) =       0.000430700148

      target function =                  N/A
              le_mean =     -17.217479577543
             les_mean =     296.756660036260
             stat err =       0.000426743382
             autocorr =       1.156043536574
              std dev =       0.561299555206
             le_variance =       0.315057190675


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721747957754e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+23, overlap shift 6.1035e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217479577543       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217479577543       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+24, overlap shift 2.4414e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217479577543       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217479577543       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+24, overlap shift 9.7656e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217479577543       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217479577543       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.539425 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5921e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2072
    reference variance = 0.148691
====================================================
  Execution time = 2.1127e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1970e-01
  Total weights = 2.0000e+06
  Execution time = 1.8211e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319560630897
                                         uncertainty =       0.004663232965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319560630897
                                         uncertainty =       0.004663232965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399814369
  error estimate for blocks of size 2^( 2) =       0.000409212776
  error estimate for blocks of size 2^( 3) =       0.000418323089
  error estimate for blocks of size 2^( 4) =       0.000424792447
  error estimate for blocks of size 2^( 5) =       0.000428800905
  error estimate for blocks of size 2^( 6) =       0.000431496751
  error estimate for blocks of size 2^( 7) =       0.000433296719

      target function =                  N/A
              le_mean =     -17.216948209450
             les_mean =     296.743008546849
             stat err =       0.000429596705
             autocorr =       1.154529640061
              std dev =       0.565422903524
             le_variance =       0.319703059829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319560630897
                                         uncertainty =       0.004663232965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319560630897
                                         uncertainty =       0.004663232965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399814369
  error estimate for blocks of size 2^( 2) =       0.000409212776
  error estimate for blocks of size 2^( 3) =       0.000418323089
  error estimate for blocks of size 2^( 4) =       0.000424792447
  error estimate for blocks of size 2^( 5) =       0.000428800905
  error estimate for blocks of size 2^( 6) =       0.000431496751
  error estimate for blocks of size 2^( 7) =       0.000433296719

      target function =                  N/A
              le_mean =     -17.216948209450
             les_mean =     296.743008546849
             stat err =       0.000429596705
             autocorr =       1.154529640061
              std dev =       0.565422903524
             le_variance =       0.319703059829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319560630897
                                         uncertainty =       0.004663232965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319560630897
                                         uncertainty =       0.004663232965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399814369
  error estimate for blocks of size 2^( 2) =       0.000409212776
  error estimate for blocks of size 2^( 3) =       0.000418323089
  error estimate for blocks of size 2^( 4) =       0.000424792447
  error estimate for blocks of size 2^( 5) =       0.000428800905
  error estimate for blocks of size 2^( 6) =       0.000431496751
  error estimate for blocks of size 2^( 7) =       0.000433296719

      target function =                  N/A
              le_mean =     -17.216948209450
             les_mean =     296.743008546849
             stat err =       0.000429596705
             autocorr =       1.154529640061
              std dev =       0.565422903524
             le_variance =       0.319703059829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319560630897
                                         uncertainty =       0.004663232965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319560630897
                                         uncertainty =       0.004663232965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399814369
  error estimate for blocks of size 2^( 2) =       0.000409212776
  error estimate for blocks of size 2^( 3) =       0.000418323089
  error estimate for blocks of size 2^( 4) =       0.000424792447
  error estimate for blocks of size 2^( 5) =       0.000428800905
  error estimate for blocks of size 2^( 6) =       0.000431496751
  error estimate for blocks of size 2^( 7) =       0.000433296719

      target function =                  N/A
              le_mean =     -17.216948209450
             les_mean =     296.743008546849
             stat err =       0.000429596705
             autocorr =       1.154529640061
              std dev =       0.565422903524
             le_variance =       0.319703059829


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216948209450        initial  <--
     6.1035e+23     6.1035e+24             0.0000e+00       -17.216948209450
     2.4414e+24     2.4414e+25             0.0000e+00       -17.216948209450
     9.7656e+24     9.7656e+25             0.0000e+00       -17.216948209450

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2975
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6562e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2569
    reference variance = 0.268667
====================================================
  Execution time = 2.0278e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2746e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6060e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327455745076
                                         uncertainty =       0.008634759477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327455745076
                                         uncertainty =       0.008634759477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404635264
  error estimate for blocks of size 2^( 2) =       0.000414106874
  error estimate for blocks of size 2^( 3) =       0.000423116102
  error estimate for blocks of size 2^( 4) =       0.000429573689
  error estimate for blocks of size 2^( 5) =       0.000433515830
  error estimate for blocks of size 2^( 6) =       0.000437818962
  error estimate for blocks of size 2^( 7) =       0.000438860382

      target function =                  N/A
              le_mean =     -17.216512850603
             les_mean =     296.735773964729
             stat err =       0.000434942216
             autocorr =       1.155408793075
              std dev =       0.572240677936
             le_variance =       0.327459393485


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721651285060e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+24, overlap shift 6.1035e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216512850603       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216512850603       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+25, overlap shift 2.4414e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216512850603       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216512850603       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+25, overlap shift 9.7656e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216512850603       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216512850603       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.540493 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5896e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.217
    reference variance = 0.239368
====================================================
  Execution time = 2.0109e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4360e-01
  Total weights = 2.0000e+06
  Execution time = 1.8148e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343609857312
                                         uncertainty =       0.025808690412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343609857312
                                         uncertainty =       0.025808690412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414487001
  error estimate for blocks of size 2^( 2) =       0.000424158660
  error estimate for blocks of size 2^( 3) =       0.000432204033
  error estimate for blocks of size 2^( 4) =       0.000437643107
  error estimate for blocks of size 2^( 5) =       0.000441762733
  error estimate for blocks of size 2^( 6) =       0.000444836023
  error estimate for blocks of size 2^( 7) =       0.000447771147

      target function =                  N/A
              le_mean =     -17.217289689276
             les_mean =     296.778663021263
             stat err =       0.000443003252
             autocorr =       1.142331095581
              std dev =       0.586173138764
             le_variance =       0.343598948609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343609857312
                                         uncertainty =       0.025808690412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343609857312
                                         uncertainty =       0.025808690412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414487001
  error estimate for blocks of size 2^( 2) =       0.000424158660
  error estimate for blocks of size 2^( 3) =       0.000432204033
  error estimate for blocks of size 2^( 4) =       0.000437643107
  error estimate for blocks of size 2^( 5) =       0.000441762733
  error estimate for blocks of size 2^( 6) =       0.000444836023
  error estimate for blocks of size 2^( 7) =       0.000447771147

      target function =                  N/A
              le_mean =     -17.217289689276
             les_mean =     296.778663021263
             stat err =       0.000443003252
             autocorr =       1.142331095581
              std dev =       0.586173138764
             le_variance =       0.343598948609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343609857312
                                         uncertainty =       0.025808690412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343609857312
                                         uncertainty =       0.025808690412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414487001
  error estimate for blocks of size 2^( 2) =       0.000424158660
  error estimate for blocks of size 2^( 3) =       0.000432204033
  error estimate for blocks of size 2^( 4) =       0.000437643107
  error estimate for blocks of size 2^( 5) =       0.000441762733
  error estimate for blocks of size 2^( 6) =       0.000444836023
  error estimate for blocks of size 2^( 7) =       0.000447771147

      target function =                  N/A
              le_mean =     -17.217289689276
             les_mean =     296.778663021263
             stat err =       0.000443003252
             autocorr =       1.142331095581
              std dev =       0.586173138764
             le_variance =       0.343598948609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343609857312
                                         uncertainty =       0.025808690412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343609857312
                                         uncertainty =       0.025808690412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414487001
  error estimate for blocks of size 2^( 2) =       0.000424158660
  error estimate for blocks of size 2^( 3) =       0.000432204033
  error estimate for blocks of size 2^( 4) =       0.000437643107
  error estimate for blocks of size 2^( 5) =       0.000441762733
  error estimate for blocks of size 2^( 6) =       0.000444836023
  error estimate for blocks of size 2^( 7) =       0.000447771147

      target function =                  N/A
              le_mean =     -17.217289689276
             les_mean =     296.778663021263
             stat err =       0.000443003252
             autocorr =       1.142331095581
              std dev =       0.586173138764
             le_variance =       0.343598948609


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217289689276        initial  <--
     6.1035e+24     6.1035e+25             0.0000e+00       -17.217289689276
     2.4414e+25     2.4414e+26             0.0000e+00       -17.217289689276
     9.7656e+25     9.7656e+26             0.0000e+00       -17.217289689276

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2524
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5593e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2324
    reference variance = 0.257113
====================================================
  Execution time = 2.0202e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1500e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5833e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315045549488
                                         uncertainty =       0.003454943608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315045549488
                                         uncertainty =       0.003454943608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396860835
  error estimate for blocks of size 2^( 2) =       0.000407239030
  error estimate for blocks of size 2^( 3) =       0.000416119506
  error estimate for blocks of size 2^( 4) =       0.000423174738
  error estimate for blocks of size 2^( 5) =       0.000427139825
  error estimate for blocks of size 2^( 6) =       0.000429664179
  error estimate for blocks of size 2^( 7) =       0.000432463373

      target function =                  N/A
              le_mean =     -17.216967257675
             les_mean =     296.738958439480
             stat err =       0.000428110529
             autocorr =       1.163684725346
              std dev =       0.561245975598
             le_variance =       0.314997045125


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721696725768e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+25, overlap shift 6.1035e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216967257675       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216967257675       residual = 9.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216967257675       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+25 is 2.067353e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+26, overlap shift 2.4414e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216967257675       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216967257675       residual = 9.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216967257675       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+26 is 5.168382e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+26, overlap shift 9.7656e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216967257675       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216967257675       residual = 9.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216967257675       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+26 is 1.292096e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.541839 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5795e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1856
    reference variance = 0.186344
====================================================
  Execution time = 2.0212e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1589e-01
  Total weights = 2.0000e+06
  Execution time = 1.8295e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316007347804
                                         uncertainty =       0.003314095794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316007347804
                                         uncertainty =       0.003314095794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397421922
  error estimate for blocks of size 2^( 2) =       0.000407131851
  error estimate for blocks of size 2^( 3) =       0.000415903940
  error estimate for blocks of size 2^( 4) =       0.000422192608
  error estimate for blocks of size 2^( 5) =       0.000426289021
  error estimate for blocks of size 2^( 6) =       0.000430098580
  error estimate for blocks of size 2^( 7) =       0.000431009133

      target function =                  N/A
              le_mean =     -17.216743998450
             les_mean =     296.732162119006
             stat err =       0.000427397336
             autocorr =       1.156538198570
              std dev =       0.562039472620
             le_variance =       0.315888368783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316007347804
                                         uncertainty =       0.003314095794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316007347804
                                         uncertainty =       0.003314095794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397421922
  error estimate for blocks of size 2^( 2) =       0.000407131851
  error estimate for blocks of size 2^( 3) =       0.000415903940
  error estimate for blocks of size 2^( 4) =       0.000422192608
  error estimate for blocks of size 2^( 5) =       0.000426289021
  error estimate for blocks of size 2^( 6) =       0.000430098580
  error estimate for blocks of size 2^( 7) =       0.000431009133

      target function =                  N/A
              le_mean =     -17.216743998450
             les_mean =     296.732162119006
             stat err =       0.000427397336
             autocorr =       1.156538198570
              std dev =       0.562039472620
             le_variance =       0.315888368783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316007347804
                                         uncertainty =       0.003314095794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316007347804
                                         uncertainty =       0.003314095794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397421922
  error estimate for blocks of size 2^( 2) =       0.000407131851
  error estimate for blocks of size 2^( 3) =       0.000415903940
  error estimate for blocks of size 2^( 4) =       0.000422192608
  error estimate for blocks of size 2^( 5) =       0.000426289021
  error estimate for blocks of size 2^( 6) =       0.000430098580
  error estimate for blocks of size 2^( 7) =       0.000431009133

      target function =                  N/A
              le_mean =     -17.216743998450
             les_mean =     296.732162119006
             stat err =       0.000427397336
             autocorr =       1.156538198570
              std dev =       0.562039472620
             le_variance =       0.315888368783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316007347804
                                         uncertainty =       0.003314095794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316007347804
                                         uncertainty =       0.003314095794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397421922
  error estimate for blocks of size 2^( 2) =       0.000407131851
  error estimate for blocks of size 2^( 3) =       0.000415903940
  error estimate for blocks of size 2^( 4) =       0.000422192608
  error estimate for blocks of size 2^( 5) =       0.000426289021
  error estimate for blocks of size 2^( 6) =       0.000430098580
  error estimate for blocks of size 2^( 7) =       0.000431009133

      target function =                  N/A
              le_mean =     -17.216743998450
             les_mean =     296.732162119006
             stat err =       0.000427397336
             autocorr =       1.156538198570
              std dev =       0.562039472620
             le_variance =       0.315888368783


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216743998450        initial  <--
     6.1035e+25     6.1035e+26             2.0674e-30       -17.216743998450
     2.4414e+26     2.4414e+27             5.1684e-31       -17.216743998450
     9.7656e+26     9.7656e+27             1.2921e-31       -17.216743998450

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.5964
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8825e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1679
    reference variance = 0.163882
====================================================
  Execution time = 2.1676e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2508e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6489e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325099630097
                                         uncertainty =       0.004224477465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325099630097
                                         uncertainty =       0.004224477465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403165033
  error estimate for blocks of size 2^( 2) =       0.000412451390
  error estimate for blocks of size 2^( 3) =       0.000421004869
  error estimate for blocks of size 2^( 4) =       0.000427002487
  error estimate for blocks of size 2^( 5) =       0.000430972596
  error estimate for blocks of size 2^( 6) =       0.000431890821
  error estimate for blocks of size 2^( 7) =       0.000434210318

      target function =                  N/A
              le_mean =     -17.216886183003
             les_mean =     296.746253763558
             stat err =       0.000431019056
             autocorr =       1.142949983488
              std dev =       0.570161457489
             le_variance =       0.325084087606


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721688618300e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+26, overlap shift 6.1035e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216886183003       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216886183003       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+27, overlap shift 2.4414e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216886183003       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216886183003       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+27, overlap shift 9.7656e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216886183003       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216886183003       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.542914 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7334e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1994
    reference variance = 0.216953
====================================================
  Execution time = 2.0575e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2282e-01
  Total weights = 2.0000e+06
  Execution time = 1.8237e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322921860998
                                         uncertainty =       0.007695989204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322921860998
                                         uncertainty =       0.007695989204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401756448
  error estimate for blocks of size 2^( 2) =       0.000411886506
  error estimate for blocks of size 2^( 3) =       0.000420772250
  error estimate for blocks of size 2^( 4) =       0.000427187937
  error estimate for blocks of size 2^( 5) =       0.000431357442
  error estimate for blocks of size 2^( 6) =       0.000433469881
  error estimate for blocks of size 2^( 7) =       0.000433476148

      target function =                  N/A
              le_mean =     -17.216764681398
             les_mean =     296.739802419728
             stat err =       0.000431372852
             autocorr =       1.152868861085
              std dev =       0.568169417063
             le_variance =       0.322816486486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322921860998
                                         uncertainty =       0.007695989204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322921860998
                                         uncertainty =       0.007695989204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401756448
  error estimate for blocks of size 2^( 2) =       0.000411886506
  error estimate for blocks of size 2^( 3) =       0.000420772250
  error estimate for blocks of size 2^( 4) =       0.000427187937
  error estimate for blocks of size 2^( 5) =       0.000431357442
  error estimate for blocks of size 2^( 6) =       0.000433469881
  error estimate for blocks of size 2^( 7) =       0.000433476148

      target function =                  N/A
              le_mean =     -17.216764681398
             les_mean =     296.739802419728
             stat err =       0.000431372852
             autocorr =       1.152868861085
              std dev =       0.568169417063
             le_variance =       0.322816486486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322921860998
                                         uncertainty =       0.007695989204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322921860998
                                         uncertainty =       0.007695989204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401756448
  error estimate for blocks of size 2^( 2) =       0.000411886506
  error estimate for blocks of size 2^( 3) =       0.000420772250
  error estimate for blocks of size 2^( 4) =       0.000427187937
  error estimate for blocks of size 2^( 5) =       0.000431357442
  error estimate for blocks of size 2^( 6) =       0.000433469881
  error estimate for blocks of size 2^( 7) =       0.000433476148

      target function =                  N/A
              le_mean =     -17.216764681398
             les_mean =     296.739802419728
             stat err =       0.000431372852
             autocorr =       1.152868861085
              std dev =       0.568169417063
             le_variance =       0.322816486486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322921860998
                                         uncertainty =       0.007695989204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322921860998
                                         uncertainty =       0.007695989204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401756448
  error estimate for blocks of size 2^( 2) =       0.000411886506
  error estimate for blocks of size 2^( 3) =       0.000420772250
  error estimate for blocks of size 2^( 4) =       0.000427187937
  error estimate for blocks of size 2^( 5) =       0.000431357442
  error estimate for blocks of size 2^( 6) =       0.000433469881
  error estimate for blocks of size 2^( 7) =       0.000433476148

      target function =                  N/A
              le_mean =     -17.216764681398
             les_mean =     296.739802419728
             stat err =       0.000431372852
             autocorr =       1.152868861085
              std dev =       0.568169417063
             le_variance =       0.322816486486


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216764681398        initial  <--
     6.1035e+26     6.1035e+27             0.0000e+00       -17.216764681398
     2.4414e+27     2.4414e+28             0.0000e+00       -17.216764681398
     9.7656e+27     9.7656e+28             0.0000e+00       -17.216764681398

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7622
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7320e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1836
    reference variance = 0.614582
====================================================
  Execution time = 2.2538e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2384e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5285e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323878977297
                                         uncertainty =       0.005663795805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323878977297
                                         uncertainty =       0.005663795805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402394350
  error estimate for blocks of size 2^( 2) =       0.000411783613
  error estimate for blocks of size 2^( 3) =       0.000420789910
  error estimate for blocks of size 2^( 4) =       0.000427381351
  error estimate for blocks of size 2^( 5) =       0.000431420846
  error estimate for blocks of size 2^( 6) =       0.000432819965
  error estimate for blocks of size 2^( 7) =       0.000432832724

      target function =                  N/A
              le_mean =     -17.216953231991
             les_mean =     296.747320856363
             stat err =       0.000431113721
             autocorr =       1.147836268282
              std dev =       0.569071547112
             le_variance =       0.323842425733


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721695323199e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+27, overlap shift 6.1035e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216953231991       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216953231991       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216953231953       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+28, overlap shift 2.4414e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216953231991       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216953231991       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216953231953       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+28, overlap shift 9.7656e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216953231991       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216953231991       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216953231953       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.544253 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8076e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1481
    reference variance = 0.198249
====================================================
  Execution time = 2.2379e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1954e-01
  Total weights = 2.0000e+06
  Execution time = 1.8169e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318379862953
                                         uncertainty =       0.004115638963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318379862953
                                         uncertainty =       0.004115638963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399711712
  error estimate for blocks of size 2^( 2) =       0.000409590937
  error estimate for blocks of size 2^( 3) =       0.000418188861
  error estimate for blocks of size 2^( 4) =       0.000424783733
  error estimate for blocks of size 2^( 5) =       0.000429345099
  error estimate for blocks of size 2^( 6) =       0.000431506440
  error estimate for blocks of size 2^( 7) =       0.000431680264

      target function =                  N/A
              le_mean =     -17.216025439725
             les_mean =     296.711070686157
             stat err =       0.000429328884
             autocorr =       1.153682934455
              std dev =       0.565277723470
             le_variance =       0.319538904651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318379862953
                                         uncertainty =       0.004115638963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318379862953
                                         uncertainty =       0.004115638963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399711712
  error estimate for blocks of size 2^( 2) =       0.000409590937
  error estimate for blocks of size 2^( 3) =       0.000418188861
  error estimate for blocks of size 2^( 4) =       0.000424783733
  error estimate for blocks of size 2^( 5) =       0.000429345099
  error estimate for blocks of size 2^( 6) =       0.000431506440
  error estimate for blocks of size 2^( 7) =       0.000431680264

      target function =                  N/A
              le_mean =     -17.216025439725
             les_mean =     296.711070686157
             stat err =       0.000429328884
             autocorr =       1.153682934455
              std dev =       0.565277723470
             le_variance =       0.319538904651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318379862953
                                         uncertainty =       0.004115638963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318379862953
                                         uncertainty =       0.004115638963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399711712
  error estimate for blocks of size 2^( 2) =       0.000409590937
  error estimate for blocks of size 2^( 3) =       0.000418188861
  error estimate for blocks of size 2^( 4) =       0.000424783733
  error estimate for blocks of size 2^( 5) =       0.000429345099
  error estimate for blocks of size 2^( 6) =       0.000431506440
  error estimate for blocks of size 2^( 7) =       0.000431680264

      target function =                  N/A
              le_mean =     -17.216025439725
             les_mean =     296.711070686157
             stat err =       0.000429328884
             autocorr =       1.153682934455
              std dev =       0.565277723470
             le_variance =       0.319538904651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318379862953
                                         uncertainty =       0.004115638963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318379862953
                                         uncertainty =       0.004115638963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399711712
  error estimate for blocks of size 2^( 2) =       0.000409590937
  error estimate for blocks of size 2^( 3) =       0.000418188861
  error estimate for blocks of size 2^( 4) =       0.000424783733
  error estimate for blocks of size 2^( 5) =       0.000429345099
  error estimate for blocks of size 2^( 6) =       0.000431506440
  error estimate for blocks of size 2^( 7) =       0.000431680264

      target function =                  N/A
              le_mean =     -17.216025439725
             les_mean =     296.711070686157
             stat err =       0.000429328884
             autocorr =       1.153682934455
              std dev =       0.565277723470
             le_variance =       0.319538904651


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216025439725        initial  <--
     6.1035e+27     6.1035e+28             0.0000e+00       -17.216025439725
     2.4414e+28     2.4414e+29             0.0000e+00       -17.216025439725
     9.7656e+28     9.7656e+29             0.0000e+00       -17.216025439725

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.5262
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9923e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2386
    reference variance = 0.271948
====================================================
  Execution time = 2.0426e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1512e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5062e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315005671026
                                         uncertainty =       0.002988235888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315005671026
                                         uncertainty =       0.002988235888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396939270
  error estimate for blocks of size 2^( 2) =       0.000406945159
  error estimate for blocks of size 2^( 3) =       0.000415832388
  error estimate for blocks of size 2^( 4) =       0.000422642130
  error estimate for blocks of size 2^( 5) =       0.000426302401
  error estimate for blocks of size 2^( 6) =       0.000427477705
  error estimate for blocks of size 2^( 7) =       0.000428807502

      target function =                  N/A
              le_mean =     -17.216829049829
             les_mean =     296.734323940809
             stat err =       0.000426307434
             autocorr =       1.153447096947
              std dev =       0.561356898368
             le_variance =       0.315121567345


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721682904983e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+28, overlap shift 6.1035e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216829049829       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216829049829       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.231778791331       residual = 6.45e+09           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216829049867       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+28 is 1.408643e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+29, overlap shift 2.4414e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216829049829       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216829049829       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.302115165325       residual = 2.58e+10           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+29 is 3.521606e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+29, overlap shift 9.7656e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216829049829       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216829049829       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.208460661299       residual = 1.03e+11           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+29 is 8.804016e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.545632 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5942e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1953
    reference variance = 0.226487
====================================================
  Execution time = 2.0371e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1590e-01
  Total weights = 2.0000e+06
  Execution time = 1.8110e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315957208438
                                         uncertainty =       0.004982135984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315957208438
                                         uncertainty =       0.004982135984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397431316
  error estimate for blocks of size 2^( 2) =       0.000407549028
  error estimate for blocks of size 2^( 3) =       0.000416088834
  error estimate for blocks of size 2^( 4) =       0.000422228454
  error estimate for blocks of size 2^( 5) =       0.000425715977
  error estimate for blocks of size 2^( 6) =       0.000427400265
  error estimate for blocks of size 2^( 7) =       0.000429038964

      target function =                  N/A
              le_mean =     -17.217023437251
             les_mean =     296.741799182497
             stat err =       0.000426095915
             autocorr =       1.149451289904
              std dev =       0.562052756939
             le_variance =       0.315903301583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315957208438
                                         uncertainty =       0.004982135984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315957208438
                                         uncertainty =       0.004982135984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397431316
  error estimate for blocks of size 2^( 2) =       0.000407549028
  error estimate for blocks of size 2^( 3) =       0.000416088834
  error estimate for blocks of size 2^( 4) =       0.000422228454
  error estimate for blocks of size 2^( 5) =       0.000425715977
  error estimate for blocks of size 2^( 6) =       0.000427400265
  error estimate for blocks of size 2^( 7) =       0.000429038964

      target function =                  N/A
              le_mean =     -17.217023437251
             les_mean =     296.741799182497
             stat err =       0.000426095915
             autocorr =       1.149451289904
              std dev =       0.562052756939
             le_variance =       0.315903301583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315957208438
                                         uncertainty =       0.004982135984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315957208438
                                         uncertainty =       0.004982135984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397431316
  error estimate for blocks of size 2^( 2) =       0.000407549028
  error estimate for blocks of size 2^( 3) =       0.000416088834
  error estimate for blocks of size 2^( 4) =       0.000422228454
  error estimate for blocks of size 2^( 5) =       0.000425715977
  error estimate for blocks of size 2^( 6) =       0.000427400265
  error estimate for blocks of size 2^( 7) =       0.000429038964

      target function =                  N/A
              le_mean =     -17.217023437251
             les_mean =     296.741799182497
             stat err =       0.000426095915
             autocorr =       1.149451289904
              std dev =       0.562052756939
             le_variance =       0.315903301583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315957208438
                                         uncertainty =       0.004982135984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315957208438
                                         uncertainty =       0.004982135984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397431316
  error estimate for blocks of size 2^( 2) =       0.000407549028
  error estimate for blocks of size 2^( 3) =       0.000416088834
  error estimate for blocks of size 2^( 4) =       0.000422228454
  error estimate for blocks of size 2^( 5) =       0.000425715977
  error estimate for blocks of size 2^( 6) =       0.000427400265
  error estimate for blocks of size 2^( 7) =       0.000429038964

      target function =                  N/A
              le_mean =     -17.217023437251
             les_mean =     296.741799182497
             stat err =       0.000426095915
             autocorr =       1.149451289904
              std dev =       0.562052756939
             le_variance =       0.315903301583


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217023437251        initial  <--
     6.1035e+28     6.1035e+29             1.4086e-33       -17.217023437251
     2.4414e+29     2.4414e+30             3.5216e-34       -17.217023437251
     9.7656e+29     9.7656e+30             8.8040e-35       -17.217023437251

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4851
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.262018e-02 1 1  ON 1
 uu_2                -4.278172e-02 1 1  ON 2
 uu_3                -9.884287e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423938e-01 1 1  ON 5
 uu_6                -1.201307e-01 1 1  ON 6
 uu_7                -5.137652e-02 1 1  ON 7
 uu_8                 9.089112e-02 1 1  ON 8
 uu_9                 1.284472e-01 1 1  ON 9
 ud_0                 3.554887e-01 1 1  ON 10
 ud_1                 9.681213e-02 1 1  ON 11
 ud_2                -1.286580e-02 1 1  ON 12
 ud_3                -7.434678e-02 1 1  ON 13
 ud_4                -1.230091e-01 1 1  ON 14
 ud_5                -1.556256e-01 1 1  ON 15
 ud_6                -1.583008e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                -8.227022e-03 1 1  ON 18
 ud_9                 9.246268e-02 1 1  ON 19
 eO_0                -7.892370e-01 1 1  ON 20
 eO_1                -4.676657e-01 1 1  ON 21
 eO_2                -5.565518e-02 1 1  ON 22
 eO_3                 2.073244e-01 1 1  ON 23
 eO_4                 3.123492e-01 1 1  ON 24
 eO_5                 3.338853e-01 1 1  ON 25
 eO_6                 2.676231e-01 1 1  ON 26
 eO_7                 1.297992e-01 1 1  ON 27
 eO_8                 3.111769e-02 1 1  ON 28
 eO_9                 1.924250e-02 1 1  ON 29
eH1_0                -1.844740e-01 1 1  ON 30
eH1_1                -1.056872e-01 1 1  ON 31
eH1_2                -6.402021e-02 1 1  ON 32
eH1_3                -2.669409e-02 1 1  ON 33
eH1_4                 1.879061e-02 1 1  ON 34
eH1_5                 3.146874e-02 1 1  ON 35
eH1_6                 7.771135e-02 1 1  ON 36
eH1_7                 1.090684e-01 1 1  ON 37
eH1_8                 1.002796e-01 1 1  ON 38
eH1_9                 2.728791e-02 1 1  ON 39
eH2_0                -1.851347e-01 1 1  ON 40
eH2_1                -1.062665e-01 1 1  ON 41
eH2_2                -6.452697e-02 1 1  ON 42
eH2_3                -2.738208e-02 1 1  ON 43
eH2_4                 1.762627e-02 1 1  ON 44
eH2_5                 3.021967e-02 1 1  ON 45
eH2_6                 7.594590e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041100e-01 1 1  ON 48
eH2_9                 2.922316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6399e+01 secs
  Total Execution time = 2.3428e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
