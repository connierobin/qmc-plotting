Rank =    0  Free Memory = 79539 MB
Rank =   32  Free Memory = 78078 MB
Rank =   33  Free Memory = 78078 MB
Rank =   34  Free Memory = 78078 MB
Rank =   35  Free Memory = 78078 MB
Rank =   36  Free Memory = 78078 MB
Rank =   37  Free Memory = 78078 MB
Rank =   38  Free Memory = 78078 MB
Rank =   39  Free Memory = 78078 MB
Rank =   40  Free Memory = 78078 MB
Rank =   41  Free Memory = 78078 MB
Rank =   42  Free Memory = 78078 MB
Rank =   43  Free Memory = 78078 MB
Rank =   44  Free Memory = 78078 MB
Rank =   45  Free Memory = 78078 MB
Rank =   46  Free Memory = 78078 MB
Rank =   47  Free Memory = 78078 MB
Rank =   48  Free Memory = 78078 MB
Rank =   49  Free Memory = 78078 MB
Rank =   50  Free Memory = 78078 MB
Rank =   51  Free Memory = 78078 MB
Rank =   52  Free Memory = 78078 MB
Rank =   53  Free Memory = 78078 MB
Rank =   54  Free Memory = 78078 MB
Rank =   55  Free Memory = 78078 MB
Rank =   56  Free Memory = 78078 MB
Rank =   57  Free Memory = 78078 MB
Rank =   58  Free Memory = 78078 MB
Rank =   59  Free Memory = 78078 MB
Rank =   60  Free Memory = 78078 MB
  Input file(s): opt_h2o_gs_gvptt_run003f.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvptt_run003f.xml
Rank =   61  Free Memory = 78078 MB
Rank =   62  Free Memory = 78078 MB
Rank =   63  Free Memory = 78078 MB
Rank =   64  Free Memory = 78726 MB
Rank =   65  Free Memory = 78726 MB
Rank =   66  Free Memory = 78725 MB
Rank =   67  Free Memory = 78725 MB
Rank =   68  Free Memory = 78725 MB
Rank =   69  Free Memory = 78725 MB
Rank =   70  Free Memory = 78725 MB
Rank =   71  Free Memory = 78725 MB
Rank =   72  Free Memory = 78725 MB
Rank =   73  Free Memory = 78725 MB
Rank =   74  Free Memory = 78725 MB
Rank =   75  Free Memory = 78725 MB
Rank =   76  Free Memory = 78725 MB
Rank =   77  Free Memory = 78725 MB
Rank =   78  Free Memory = 78725 MB
Rank =   79  Free Memory = 78725 MB
Rank =   80  Free Memory = 78725 MB
Rank =   81  Free Memory = 78725 MB
Rank =   82  Free Memory = 78725 MB
Rank =   83  Free Memory = 78725 MB
Rank =   84  Free Memory = 78725 MB
Rank =   85  Free Memory = 78725 MB
Rank =   86  Free Memory = 78725 MB
Rank =   87  Free Memory = 78725 MB
Rank =   88  Free Memory = 78725 MB
Rank =   89  Free Memory = 78725 MB
Rank =   90  Free Memory = 78725 MB
Rank =   91  Free Memory = 78725 MB
Rank =   92  Free Memory = 78725 MB
Rank =   93  Free Memory = 78725 MB
Rank =   94  Free Memory = 78725 MB
Rank =   95  Free Memory = 78725 MB
Rank =   96  Free Memory = 78654 MB
Rank =   97  Free Memory = 78654 MB
Rank =   98  Free Memory = 78654 MB
Rank =   99  Free Memory = 78654 MB
Rank =  100  Free Memory = 78654 MB
Rank =  101  Free Memory = 78654 MB
Rank =  102  Free Memory = 78654 MB
Rank =  103  Free Memory = 78654 MB
Rank =  104  Free Memory = 78654 MB
Rank =  105  Free Memory = 78654 MB
Rank =  106  Free Memory = 78654 MB
Rank =  107  Free Memory = 78654 MB
Rank =  108  Free Memory = 78654 MB
Rank =  109  Free Memory = 78654 MB
Rank =  110  Free Memory = 78654 MB
Rank =  111  Free Memory = 78654 MB
Rank =  112  Free Memory = 78654 MB
Rank =  113  Free Memory = 78654 MB
Rank =  114  Free Memory = 78654 MB
Rank =  115  Free Memory = 78654 MB
Rank =  116  Free Memory = 78654 MB
Rank =  117  Free Memory = 78654 MB
Rank =  118  Free Memory = 78654 MB
Rank =  119  Free Memory = 78654 MB
Rank =  120  Free Memory = 78654 MB
Rank =  121  Free Memory = 78654 MB
Rank =  122  Free Memory = 78654 MB
Rank =  123  Free Memory = 78654 MB
Rank =  124  Free Memory = 78654 MB
Rank =  125  Free Memory = 78654 MB
Rank =  126  Free Memory = 78654 MB
Rank =  127  Free Memory = 78654 MB
Rank =   31  Free Memory = 79521 MB
Rank =    1  Free Memory = 79539 MB
Rank =    2  Free Memory = 79539 MB
Rank =    3  Free Memory = 79539 MB
Rank =    4  Free Memory = 79538 MB
Rank =    5  Free Memory = 79538 MB
Rank =    6  Free Memory = 79537 MB
Rank =    7  Free Memory = 79537 MB
Rank =    8  Free Memory = 79537 MB
Rank =    9  Free Memory = 79537 MB
Rank =   10  Free Memory = 79537 MB
Rank =   11  Free Memory = 79537 MB
Rank =   12  Free Memory = 79537 MB
Rank =   13  Free Memory = 79537 MB
Rank =   14  Free Memory = 79536 MB
Rank =   15  Free Memory = 79522 MB
Rank =   16  Free Memory = 79521 MB
Rank =   17  Free Memory = 79521 MB
Rank =   18  Free Memory = 79521 MB
Rank =   19  Free Memory = 79521 MB
Rank =   20  Free Memory = 79521 MB
Rank =   21  Free Memory = 79521 MB
Rank =   22  Free Memory = 79521 MB
Rank =   23  Free Memory = 79521 MB
Rank =   24  Free Memory = 79521 MB
Rank =   25  Free Memory = 79521 MB
Rank =   26  Free Memory = 79521 MB
Rank =   27  Free Memory = 79521 MB
Rank =   28  Free Memory = 79521 MB
Rank =   29  Free Memory = 79521 MB
Rank =   30  Free Memory = 79521 MB

  Project = H2O
  date    = 2023-04-09 18:27:35 PDT
  host    = n0096.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 519

  Range of prime numbers to use as seeds over processors and threads = 3733-4817


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.098000e-01    1         1  ON     0
     uu_1                 4.810422e-02    1         1  ON     1
     uu_2                -4.517452e-02    1         1  ON     2
     uu_3                -9.942900e-02    1         1  ON     3
     uu_4                -1.325366e-01    1         1  ON     4
     uu_5                -1.385152e-01    1         1  ON     5
     uu_6                -1.150449e-01    1         1  ON     6
     uu_7                -4.257158e-02    1         1  ON     7
     uu_8                 9.777373e-02    1         1  ON     8
     uu_9                 1.225505e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.463231e-01    1         1  ON     0
     ud_1                 9.089905e-02    1         1  ON     1
     ud_2                -1.344790e-02    1         1  ON     2
     ud_3                -7.172925e-02    1         1  ON     3
     ud_4                -1.199510e-01    1         1  ON     4
     ud_5                -1.535074e-01    1         1  ON     5
     ud_6                -1.556998e-01    1         1  ON     6
     ud_7                -1.107672e-01    1         1  ON     7
     ud_8                 1.407801e-03    1         1  ON     8
     ud_9                 9.244352e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.561679e-01    1         1  ON     0
     eO_1                -4.427567e-01    1         1  ON     1
     eO_2                -4.536668e-02    1         1  ON     2
     eO_3                 2.044045e-01    1         1  ON     3
     eO_4                 2.979160e-01    1         1  ON     4
     eO_5                 3.141659e-01    1         1  ON     5
     eO_6                 2.539434e-01    1         1  ON     6
     eO_7                 1.158792e-01    1         1  ON     7
     eO_8                 2.853293e-02    1         1  ON     8
     eO_9                 1.861835e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.815315e-01    1         1  ON     0
     eH1_1                -1.033513e-01    1         1  ON     1
     eH1_2                -6.278690e-02    1         1  ON     2
     eH1_3                -2.665635e-02    1         1  ON     3
     eH1_4                 1.894694e-02    1         1  ON     4
     eH1_5                 3.447160e-02    1         1  ON     5
     eH1_6                 7.840214e-02    1         1  ON     6
     eH1_7                 1.093415e-01    1         1  ON     7
     eH1_8                 9.261207e-02    1         1  ON     8
     eH1_9                 2.499365e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.833813e-01    1         1  ON     0
     eH2_1                -1.046244e-01    1         1  ON     1
     eH2_2                -6.407604e-02    1         1  ON     2
     eH2_3                -2.758511e-02    1         1  ON     3
     eH2_4                 1.792720e-02    1         1  ON     4
     eH2_5                 3.386828e-02    1         1  ON     5
     eH2_6                 7.883749e-02    1         1  ON     6
     eH2_7                 1.133602e-01    1         1  ON     7
     eH2_8                 9.618838e-02    1         1  ON     8
     eH2_9                 2.707314e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.704478e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.7181e+00 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2836
    reference variance = 0.263941
====================================================
  Execution time = 2.1048e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0815e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4294e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308141859896
                                         uncertainty =       0.003882415223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308141859896
                                         uncertainty =       0.003882415223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392521472
  error estimate for blocks of size 2^( 2) =       0.000402171003
  error estimate for blocks of size 2^( 3) =       0.000411670172
  error estimate for blocks of size 2^( 4) =       0.000417929838
  error estimate for blocks of size 2^( 5) =       0.000421529116
  error estimate for blocks of size 2^( 6) =       0.000423487102
  error estimate for blocks of size 2^( 7) =       0.000423948492

      target function =                  N/A
              le_mean =     -17.216240477803
             les_mean =     296.707082247901
             stat err =       0.000421723637
             autocorr =       1.154327515805
              std dev =       0.555109189634
             le_variance =       0.308146212416


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721624047780e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216240477803       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216262094979       residual = 7.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216268379492       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216272679066       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216280382693       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216284208719       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216283805377       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216282897536       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216284387804       residual = 9.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216284130355       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216284369082       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216284094416       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 4.133516e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216240477803       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216250017063       residual = 9.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216252820377       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216255117437       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216258109783       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216258816193       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216258686419       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216258774353       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216258618857       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216258760052       residual = 4.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.276972e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216240477803       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216243426682       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216244318765       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216245126063       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216246053001       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216246072955       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216246122496       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216246144536       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216246111706       residual = 6.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 3.434899e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.119865 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6602e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  2.099265e-01                 1 1 ON  0
uu_1  4.820608e-02                 1 1 ON  1
uu_2  -4.529534e-02                1 1 ON  2
uu_3  -9.943619e-02                1 1 ON  3
uu_4  -1.324533e-01                1 1 ON  4
uu_5  -1.385913e-01                1 1 ON  5
uu_6  -1.151056e-01                1 1 ON  6
uu_7  -4.267247e-02                1 1 ON  7
uu_8  9.769713e-02                 1 1 ON  8
uu_9  1.226043e-01                 1 1 ON  9
ud_0  3.473140e-01                 1 1 ON  10
ud_1  9.148068e-02                 1 1 ON  11
ud_2  -1.401704e-02                1 1 ON  12
ud_3  -7.237379e-02                1 1 ON  13
ud_4  -1.201301e-01                1 1 ON  14
ud_5  -1.534496e-01                1 1 ON  15
ud_6  -1.557888e-01                1 1 ON  16
ud_7  -1.108620e-01                1 1 ON  17
ud_8  1.286118e-03                 1 1 ON  18
ud_9  9.244208e-02                 1 1 ON  19
eO_0  -7.574448e-01                1 1 ON  20
eO_1  -4.434170e-01                1 1 ON  21
eO_2  -4.457282e-02                1 1 ON  22
eO_3  2.050092e-01                 1 1 ON  23
eO_4  2.981780e-01                 1 1 ON  24
eO_5  3.142310e-01                 1 1 ON  25
eO_6  2.540183e-01                 1 1 ON  26
eO_7  1.159828e-01                 1 1 ON  27
eO_8  2.854942e-02                 1 1 ON  28
eO_9  1.862791e-02                 1 1 ON  29
eH1_0 -1.816445e-01                1 1 ON  30
eH1_1 -1.032907e-01                1 1 ON  31
eH1_2 -6.286410e-02                1 1 ON  32
eH1_3 -2.656695e-02                1 1 ON  33
eH1_4 1.899250e-02                 1 1 ON  34
eH1_5 3.435518e-02                 1 1 ON  35
eH1_6 7.841515e-02                 1 1 ON  36
eH1_7 1.093544e-01                 1 1 ON  37
eH1_8 9.267822e-02                 1 1 ON  38
eH1_9 2.500662e-02                 1 1 ON  39
eH2_0 -1.834698e-01                1 1 ON  40
eH2_1 -1.046583e-01                1 1 ON  41
eH2_2 -6.409862e-02                1 1 ON  42
eH2_3 -2.746170e-02                1 1 ON  43
eH2_4 1.798190e-02                 1 1 ON  44
eH2_5 3.381222e-02                 1 1 ON  45
eH2_6 7.877190e-02                 1 1 ON  46
eH2_7 1.133295e-01                 1 1 ON  47
eH2_8 9.627208e-02                 1 1 ON  48
eH2_9 2.710039e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2103
    reference variance = 0.283777
====================================================
  Execution time = 2.0115e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2110e-01
  Total weights = 2.0000e+06
  Execution time = 1.8245e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320279296173
                                         uncertainty =       0.004695091199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320279296173
                                         uncertainty =       0.004695091199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400131399
  error estimate for blocks of size 2^( 2) =       0.000410305762
  error estimate for blocks of size 2^( 3) =       0.000419135746
  error estimate for blocks of size 2^( 4) =       0.000425342833
  error estimate for blocks of size 2^( 5) =       0.000429784872
  error estimate for blocks of size 2^( 6) =       0.000431746004
  error estimate for blocks of size 2^( 7) =       0.000433738290

      target function =                  N/A
              le_mean =     -17.216911263160
             les_mean =     296.742243556731
             stat err =       0.000430153000
             autocorr =       1.155688112420
              std dev =       0.565871251542
             le_variance =       0.320210273322

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322665551651
                                         uncertainty =       0.004715597280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322665551651
                                         uncertainty =       0.004715597280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401619297
  error estimate for blocks of size 2^( 2) =       0.000411685018
  error estimate for blocks of size 2^( 3) =       0.000420413878
  error estimate for blocks of size 2^( 4) =       0.000426514257
  error estimate for blocks of size 2^( 5) =       0.000430913693
  error estimate for blocks of size 2^( 6) =       0.000432853980
  error estimate for blocks of size 2^( 7) =       0.000434832779

      target function =                  N/A
              le_mean =     -17.216916029421
             les_mean =     296.744793521956
             stat err =       0.000431278677
             autocorr =       1.153152727364
              std dev =       0.567975456429
             le_variance =       0.322596119106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322116602538
                                         uncertainty =       0.004708230216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322116602538
                                         uncertainty =       0.004708230216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401277545
  error estimate for blocks of size 2^( 2) =       0.000411362685
  error estimate for blocks of size 2^( 3) =       0.000420110418
  error estimate for blocks of size 2^( 4) =       0.000426229930
  error estimate for blocks of size 2^( 5) =       0.000430634193
  error estimate for blocks of size 2^( 6) =       0.000432572047
  error estimate for blocks of size 2^( 7) =       0.000434550995

      target function =                  N/A
              le_mean =     -17.216913279622
             les_mean =     296.744150053350
             stat err =       0.000430996791
             autocorr =       1.153608261691
              std dev =       0.567492146505
             le_variance =       0.322047336345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320534018092
                                         uncertainty =       0.004696717692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320534018092
                                         uncertainty =       0.004696717692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400290500
  error estimate for blocks of size 2^( 2) =       0.000410450424
  error estimate for blocks of size 2^( 3) =       0.000419267281
  error estimate for blocks of size 2^( 4) =       0.000425460815
  error estimate for blocks of size 2^( 5) =       0.000429896764
  error estimate for blocks of size 2^( 6) =       0.000431853790
  error estimate for blocks of size 2^( 7) =       0.000433843781

      target function =                  N/A
              le_mean =     -17.216909449199
             les_mean =     296.742435789714
             stat err =       0.000430263787
             autocorr =       1.155364517888
              std dev =       0.566096253317
             le_variance =       0.320464968019


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216911263160        initial
     2.5000e-01     2.5000e+00             4.1335e-03       -17.216916029421  <--
     1.0000e+00     1.0000e+01             1.2770e-03       -17.216913279622
     4.0000e+00     4.0000e+01             3.4349e-04       -17.216909449199

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9347e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 2.103164e-01 1 1  ON 0
 uu_1                 4.842802e-02 1 1  ON 1
 uu_2                -4.536964e-02 1 1  ON 2
 uu_3                -9.952184e-02 1 1  ON 3
 uu_4                -1.324427e-01 1 1  ON 4
 uu_5                -1.388070e-01 1 1  ON 5
 uu_6                -1.152545e-01 1 1  ON 6
 uu_7                -4.294694e-02 1 1  ON 7
 uu_8                 9.747403e-02 1 1  ON 8
 uu_9                 1.227696e-01 1 1  ON 9
 ud_0                 3.489758e-01 1 1  ON 10
 ud_1                 9.226703e-02 1 1  ON 11
 ud_2                -1.458112e-02 1 1  ON 12
 ud_3                -7.345734e-02 1 1  ON 13
 ud_4                -1.206669e-01 1 1  ON 14
 ud_5                -1.533691e-01 1 1  ON 15
 ud_6                -1.558230e-01 1 1  ON 16
 ud_7                -1.110395e-01 1 1  ON 17
 ud_8                 9.412121e-04 1 1  ON 18
 ud_9                 9.244207e-02 1 1  ON 19
 eO_0                -7.603014e-01 1 1  ON 20
 eO_1                -4.449594e-01 1 1  ON 21
 eO_2                -4.367064e-02 1 1  ON 22
 eO_3                 2.064325e-01 1 1  ON 23
 eO_4                 2.992207e-01 1 1  ON 24
 eO_5                 3.145742e-01 1 1  ON 25
 eO_6                 2.542805e-01 1 1  ON 26
 eO_7                 1.163056e-01 1 1  ON 27
 eO_8                 2.860080e-02 1 1  ON 28
 eO_9                 1.865716e-02 1 1  ON 29
eH1_0                -1.819136e-01 1 1  ON 30
eH1_1                -1.033139e-01 1 1  ON 31
eH1_2                -6.293190e-02 1 1  ON 32
eH1_3                -2.643202e-02 1 1  ON 33
eH1_4                 1.902887e-02 1 1  ON 34
eH1_5                 3.411489e-02 1 1  ON 35
eH1_6                 7.851926e-02 1 1  ON 36
eH1_7                 1.094144e-01 1 1  ON 37
eH1_8                 9.288427e-02 1 1  ON 38
eH1_9                 2.504679e-02 1 1  ON 39
eH2_0                -1.837126e-01 1 1  ON 40
eH2_1                -1.047961e-01 1 1  ON 41
eH2_2                -6.407796e-02 1 1  ON 42
eH2_3                -2.725667e-02 1 1  ON 43
eH2_4                 1.806237e-02 1 1  ON 44
eH2_5                 3.372036e-02 1 1  ON 45
eH2_6                 7.864322e-02 1 1  ON 46
eH2_7                 1.132568e-01 1 1  ON 47
eH2_8                 9.653077e-02 1 1  ON 48
eH2_9                 2.718411e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6017e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7247e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1918
    reference variance = 0.293356
====================================================
  Execution time = 2.0308e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1664e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5557e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316670913644
                                         uncertainty =       0.004534022361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316670913644
                                         uncertainty =       0.004534022361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397893721
  error estimate for blocks of size 2^( 2) =       0.000407265068
  error estimate for blocks of size 2^( 3) =       0.000416189187
  error estimate for blocks of size 2^( 4) =       0.000421740411
  error estimate for blocks of size 2^( 5) =       0.000426044236
  error estimate for blocks of size 2^( 6) =       0.000427450427
  error estimate for blocks of size 2^( 7) =       0.000428070641

      target function =                  N/A
              le_mean =     -17.217146908395
             les_mean =     296.746786333283
             stat err =       0.000425826429
             autocorr =       1.145331098471
              std dev =       0.562706696566
             le_variance =       0.316638826360


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721714690839e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217146908395       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217156640793       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217156379676       residual = 9.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217160557453       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217163593024       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217166228879       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217173681291       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217171828984       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217175775402       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217174231537       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217175565231       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217175566496       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217175767176       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217175443628       residual = 8.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 8.592412e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217146908395       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217153452732       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217153302529       residual = 8.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217155026793       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217156716631       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217157776809       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217159690976       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217159373663       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217160153637       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217159548113       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217159771729       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 3.166614e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217146908395       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217149741086       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217149716645       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217150166578       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217150624624       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217151022543       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217151316557       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217151314621       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217151373880       residual = 7.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 9.709055e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.125148 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5873e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.106075e-01 1 1  ON 0
 uu_1                 4.877648e-02 1 1  ON 1
 uu_2                -4.514736e-02 1 1  ON 2
 uu_3                -9.954298e-02 1 1  ON 3
 uu_4                -1.324175e-01 1 1  ON 4
 uu_5                -1.389509e-01 1 1  ON 5
 uu_6                -1.156634e-01 1 1  ON 6
 uu_7                -4.346902e-02 1 1  ON 7
 uu_8                 9.709531e-02 1 1  ON 8
 uu_9                 1.229907e-01 1 1  ON 9
 ud_0                 3.501924e-01 1 1  ON 10
 ud_1                 9.291190e-02 1 1  ON 11
 ud_2                -1.490137e-02 1 1  ON 12
 ud_3                -7.427539e-02 1 1  ON 13
 ud_4                -1.213899e-01 1 1  ON 14
 ud_5                -1.533904e-01 1 1  ON 15
 ud_6                -1.558531e-01 1 1  ON 16
 ud_7                -1.110981e-01 1 1  ON 17
 ud_8                 6.075387e-04 1 1  ON 18
 ud_9                 9.251854e-02 1 1  ON 19
 eO_0                -7.634680e-01 1 1  ON 20
 eO_1                -4.464936e-01 1 1  ON 21
 eO_2                -4.324943e-02 1 1  ON 22
 eO_3                 2.079461e-01 1 1  ON 23
 eO_4                 3.004244e-01 1 1  ON 24
 eO_5                 3.150554e-01 1 1  ON 25
 eO_6                 2.546617e-01 1 1  ON 26
 eO_7                 1.168133e-01 1 1  ON 27
 eO_8                 2.871262e-02 1 1  ON 28
 eO_9                 1.869717e-02 1 1  ON 29
eH1_0                -1.824357e-01 1 1  ON 30
eH1_1                -1.037306e-01 1 1  ON 31
eH1_2                -6.292702e-02 1 1  ON 32
eH1_3                -2.650178e-02 1 1  ON 33
eH1_4                 1.935572e-02 1 1  ON 34
eH1_5                 3.429676e-02 1 1  ON 35
eH1_6                 7.859688e-02 1 1  ON 36
eH1_7                 1.094226e-01 1 1  ON 37
eH1_8                 9.316299e-02 1 1  ON 38
eH1_9                 2.514215e-02 1 1  ON 39
eH2_0                -1.842166e-01 1 1  ON 40
eH2_1                -1.048277e-01 1 1  ON 41
eH2_2                -6.400280e-02 1 1  ON 42
eH2_3                -2.718152e-02 1 1  ON 43
eH2_4                 1.822006e-02 1 1  ON 44
eH2_5                 3.372264e-02 1 1  ON 45
eH2_6                 7.855663e-02 1 1  ON 46
eH2_7                 1.131274e-01 1 1  ON 47
eH2_8                 9.677617e-02 1 1  ON 48
eH2_9                 2.732233e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.256
    reference variance = 0.280009
====================================================
  Execution time = 2.0111e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2515e-01
  Total weights = 2.0000e+06
  Execution time = 1.8283e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323967485174
                                         uncertainty =       0.006650888780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323967485174
                                         uncertainty =       0.006650888780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402557540
  error estimate for blocks of size 2^( 2) =       0.000411525118
  error estimate for blocks of size 2^( 3) =       0.000420160854
  error estimate for blocks of size 2^( 4) =       0.000426181998
  error estimate for blocks of size 2^( 5) =       0.000430069537
  error estimate for blocks of size 2^( 6) =       0.000432410941
  error estimate for blocks of size 2^( 7) =       0.000431621464

      target function =                  N/A
              le_mean =     -17.217492872888
             les_mean =     296.766165812251
             stat err =       0.000430070985
             autocorr =       1.141364486450
              std dev =       0.569302333000
             le_variance =       0.324105146360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326071730781
                                         uncertainty =       0.006725664968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326071730781
                                         uncertainty =       0.006725664968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403863234
  error estimate for blocks of size 2^( 2) =       0.000412747068
  error estimate for blocks of size 2^( 3) =       0.000421300000
  error estimate for blocks of size 2^( 4) =       0.000427247691
  error estimate for blocks of size 2^( 5) =       0.000431108905
  error estimate for blocks of size 2^( 6) =       0.000433468774
  error estimate for blocks of size 2^( 7) =       0.000432686650

      target function =                  N/A
              le_mean =     -17.217485043411
             les_mean =     296.768002080690
             stat err =       0.000431128005
             autocorr =       1.139577410321
              std dev =       0.571148863019
             le_variance =       0.326211023728

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326096058263
                                         uncertainty =       0.006722689389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326096058263
                                         uncertainty =       0.006722689389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403878296
  error estimate for blocks of size 2^( 2) =       0.000412758351
  error estimate for blocks of size 2^( 3) =       0.000421312453
  error estimate for blocks of size 2^( 4) =       0.000427267092
  error estimate for blocks of size 2^( 5) =       0.000431137103
  error estimate for blocks of size 2^( 6) =       0.000433487224
  error estimate for blocks of size 2^( 7) =       0.000432709401

      target function =                  N/A
              le_mean =     -17.217483928243
             les_mean =     296.767988011511
             stat err =       0.000431150205
             autocorr =       1.139609771434
              std dev =       0.571170163196
             le_variance =       0.326235355326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324326823277
                                         uncertainty =       0.006663229521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324326823277
                                         uncertainty =       0.006663229521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402780824
  error estimate for blocks of size 2^( 2) =       0.000411730607
  error estimate for blocks of size 2^( 3) =       0.000420350289
  error estimate for blocks of size 2^( 4) =       0.000426359246
  error estimate for blocks of size 2^( 5) =       0.000430244287
  error estimate for blocks of size 2^( 6) =       0.000432586124
  error estimate for blocks of size 2^( 7) =       0.000431798469

      target function =                  N/A
              le_mean =     -17.217488788410
             les_mean =     296.766384800880
             stat err =       0.000430247031
             autocorr =       1.141032969823
              std dev =       0.569618103734
             le_variance =       0.324464784101


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217492872888        initial  <--
     6.2500e-02     6.2500e-01             8.5924e-03       -17.217485043411
     2.5000e-01     2.5000e+00             3.1666e-03       -17.217483928243
     1.0000e+00     1.0000e+01             9.7091e-04       -17.217488788410

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3318
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.103164e-01 1 1  ON 0
 uu_1                 4.842802e-02 1 1  ON 1
 uu_2                -4.536964e-02 1 1  ON 2
 uu_3                -9.952184e-02 1 1  ON 3
 uu_4                -1.324427e-01 1 1  ON 4
 uu_5                -1.388070e-01 1 1  ON 5
 uu_6                -1.152545e-01 1 1  ON 6
 uu_7                -4.294694e-02 1 1  ON 7
 uu_8                 9.747403e-02 1 1  ON 8
 uu_9                 1.227696e-01 1 1  ON 9
 ud_0                 3.489758e-01 1 1  ON 10
 ud_1                 9.226703e-02 1 1  ON 11
 ud_2                -1.458112e-02 1 1  ON 12
 ud_3                -7.345734e-02 1 1  ON 13
 ud_4                -1.206669e-01 1 1  ON 14
 ud_5                -1.533691e-01 1 1  ON 15
 ud_6                -1.558230e-01 1 1  ON 16
 ud_7                -1.110395e-01 1 1  ON 17
 ud_8                 9.412121e-04 1 1  ON 18
 ud_9                 9.244207e-02 1 1  ON 19
 eO_0                -7.603014e-01 1 1  ON 20
 eO_1                -4.449594e-01 1 1  ON 21
 eO_2                -4.367064e-02 1 1  ON 22
 eO_3                 2.064325e-01 1 1  ON 23
 eO_4                 2.992207e-01 1 1  ON 24
 eO_5                 3.145742e-01 1 1  ON 25
 eO_6                 2.542805e-01 1 1  ON 26
 eO_7                 1.163056e-01 1 1  ON 27
 eO_8                 2.860080e-02 1 1  ON 28
 eO_9                 1.865716e-02 1 1  ON 29
eH1_0                -1.819136e-01 1 1  ON 30
eH1_1                -1.033139e-01 1 1  ON 31
eH1_2                -6.293190e-02 1 1  ON 32
eH1_3                -2.643202e-02 1 1  ON 33
eH1_4                 1.902887e-02 1 1  ON 34
eH1_5                 3.411489e-02 1 1  ON 35
eH1_6                 7.851926e-02 1 1  ON 36
eH1_7                 1.094144e-01 1 1  ON 37
eH1_8                 9.288427e-02 1 1  ON 38
eH1_9                 2.504679e-02 1 1  ON 39
eH2_0                -1.837126e-01 1 1  ON 40
eH2_1                -1.047961e-01 1 1  ON 41
eH2_2                -6.407796e-02 1 1  ON 42
eH2_3                -2.725667e-02 1 1  ON 43
eH2_4                 1.806237e-02 1 1  ON 44
eH2_5                 3.372036e-02 1 1  ON 45
eH2_6                 7.864322e-02 1 1  ON 46
eH2_7                 1.132568e-01 1 1  ON 47
eH2_8                 9.653077e-02 1 1  ON 48
eH2_9                 2.718411e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5261e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7235e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2373
    reference variance = 0.205673
====================================================
  Execution time = 2.0453e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1363e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5819e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313643794072
                                         uncertainty =       0.003688383124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313643794072
                                         uncertainty =       0.003688383124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395995966
  error estimate for blocks of size 2^( 2) =       0.000405785112
  error estimate for blocks of size 2^( 3) =       0.000414676283
  error estimate for blocks of size 2^( 4) =       0.000421015276
  error estimate for blocks of size 2^( 5) =       0.000425006485
  error estimate for blocks of size 2^( 6) =       0.000426867400
  error estimate for blocks of size 2^( 7) =       0.000428779844

      target function =                  N/A
              le_mean =     -17.216971617435
             les_mean =     296.737737128731
             stat err =       0.000425417251
             autocorr =       1.154113898843
              std dev =       0.560022865598
             le_variance =       0.313625609992


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721697161743e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216971617435       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216975385839       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216978872240       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216978945489       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216980088575       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216980384293       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216980396409       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216980778986       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216980854462       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216980759397       residual = 4.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 1.377353e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216971617435       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216972814414       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216974064642       residual = 8.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216974173406       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216974580631       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216974537604       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216974499643       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216974578820       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216974600647       residual = 2.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 3.755848e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216971617435       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216971938387       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216972288361       residual = 9.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216972327332       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216972445649       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216972420293       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216972408469       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216972428589       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 9.579743e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.128322 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6041e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.103305e-01 1 1  ON 0
 uu_1                 4.846682e-02 1 1  ON 1
 uu_2                -4.535859e-02 1 1  ON 2
 uu_3                -9.954252e-02 1 1  ON 3
 uu_4                -1.324410e-01 1 1  ON 4
 uu_5                -1.388330e-01 1 1  ON 5
 uu_6                -1.152876e-01 1 1  ON 6
 uu_7                -4.296749e-02 1 1  ON 7
 uu_8                 9.745449e-02 1 1  ON 8
 uu_9                 1.227953e-01 1 1  ON 9
 ud_0                 3.492376e-01 1 1  ON 10
 ud_1                 9.237729e-02 1 1  ON 11
 ud_2                -1.468700e-02 1 1  ON 12
 ud_3                -7.359423e-02 1 1  ON 13
 ud_4                -1.207509e-01 1 1  ON 14
 ud_5                -1.533518e-01 1 1  ON 15
 ud_6                -1.558476e-01 1 1  ON 16
 ud_7                -1.110624e-01 1 1  ON 17
 ud_8                 9.016495e-04 1 1  ON 18
 ud_9                 9.244398e-02 1 1  ON 19
 eO_0                -7.606770e-01 1 1  ON 20
 eO_1                -4.451675e-01 1 1  ON 21
 eO_2                -4.351154e-02 1 1  ON 22
 eO_3                 2.065705e-01 1 1  ON 23
 eO_4                 2.993381e-01 1 1  ON 24
 eO_5                 3.146386e-01 1 1  ON 25
 eO_6                 2.543206e-01 1 1  ON 26
 eO_7                 1.163537e-01 1 1  ON 27
 eO_8                 2.861140e-02 1 1  ON 28
 eO_9                 1.866045e-02 1 1  ON 29
eH1_0                -1.819579e-01 1 1  ON 30
eH1_1                -1.033279e-01 1 1  ON 31
eH1_2                -6.291917e-02 1 1  ON 32
eH1_3                -2.642790e-02 1 1  ON 33
eH1_4                 1.904053e-02 1 1  ON 34
eH1_5                 3.408079e-02 1 1  ON 35
eH1_6                 7.852552e-02 1 1  ON 36
eH1_7                 1.094294e-01 1 1  ON 37
eH1_8                 9.291625e-02 1 1  ON 38
eH1_9                 2.505488e-02 1 1  ON 39
eH2_0                -1.837164e-01 1 1  ON 40
eH2_1                -1.047896e-01 1 1  ON 41
eH2_2                -6.411819e-02 1 1  ON 42
eH2_3                -2.725505e-02 1 1  ON 43
eH2_4                 1.808867e-02 1 1  ON 44
eH2_5                 3.372267e-02 1 1  ON 45
eH2_6                 7.862357e-02 1 1  ON 46
eH2_7                 1.132420e-01 1 1  ON 47
eH2_8                 9.655749e-02 1 1  ON 48
eH2_9                 2.719517e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.336
    reference variance = 0.667713
====================================================
  Execution time = 2.1568e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1693e-01
  Total weights = 2.0000e+06
  Execution time = 1.8247e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316676078674
                                         uncertainty =       0.004428463850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316676078674
                                         uncertainty =       0.004428463850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397920484
  error estimate for blocks of size 2^( 2) =       0.000407932582
  error estimate for blocks of size 2^( 3) =       0.000416933183
  error estimate for blocks of size 2^( 4) =       0.000422787880
  error estimate for blocks of size 2^( 5) =       0.000427139648
  error estimate for blocks of size 2^( 6) =       0.000428680414
  error estimate for blocks of size 2^( 7) =       0.000431469721

      target function =                  N/A
              le_mean =     -17.216528778969
             les_mean =     296.725544462290
             stat err =       0.000427519416
             autocorr =       1.154301057259
              std dev =       0.562744545575
             le_variance =       0.316681423574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317443971656
                                         uncertainty =       0.004437214016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317443971656
                                         uncertainty =       0.004437214016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398402663
  error estimate for blocks of size 2^( 2) =       0.000408386274
  error estimate for blocks of size 2^( 3) =       0.000417357056
  error estimate for blocks of size 2^( 4) =       0.000423191245
  error estimate for blocks of size 2^( 5) =       0.000427538880
  error estimate for blocks of size 2^( 6) =       0.000429071120
  error estimate for blocks of size 2^( 7) =       0.000431864653

      target function =                  N/A
              le_mean =     -17.216532396797
             les_mean =     296.726436975384
             stat err =       0.000427916474
             autocorr =       1.153648611450
              std dev =       0.563426449643
             le_variance =       0.317449364157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317167463114
                                         uncertainty =       0.004434487740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317167463114
                                         uncertainty =       0.004434487740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398229103
  error estimate for blocks of size 2^( 2) =       0.000408222545
  error estimate for blocks of size 2^( 3) =       0.000417204597
  error estimate for blocks of size 2^( 4) =       0.000423046248
  error estimate for blocks of size 2^( 5) =       0.000427395747
  error estimate for blocks of size 2^( 6) =       0.000428931495
  error estimate for blocks of size 2^( 7) =       0.000431724837

      target function =                  N/A
              le_mean =     -17.216530721962
             les_mean =     296.726102778823
             stat err =       0.000427774582
             autocorr =       1.153888804155
              std dev =       0.563180998561
             le_variance =       0.317172837141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316742451208
                                         uncertainty =       0.004429309463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316742451208
                                         uncertainty =       0.004429309463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397962184
  error estimate for blocks of size 2^( 2) =       0.000407971690
  error estimate for blocks of size 2^( 3) =       0.000416969784
  error estimate for blocks of size 2^( 4) =       0.000422822706
  error estimate for blocks of size 2^( 5) =       0.000427174187
  error estimate for blocks of size 2^( 6) =       0.000428714292
  error estimate for blocks of size 2^( 7) =       0.000431504209

      target function =                  N/A
              le_mean =     -17.216528959737
             les_mean =     296.725617063069
             stat err =       0.000427553849
             autocorr =       1.154245071123
              std dev =       0.562803518109
             le_variance =       0.316747799996


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216528778969        initial
     6.2500e-01     6.2500e+00             1.3774e-03       -17.216532396797  <--
     2.5000e+00     2.5000e+01             3.7558e-04       -17.216530721962
     1.0000e+01     1.0000e+02             9.5797e-05       -17.216528959737

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.0768e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.104080e-01 1 1  ON 0
 uu_1                 4.856367e-02 1 1  ON 1
 uu_2                -4.533076e-02 1 1  ON 2
 uu_3                -9.959699e-02 1 1  ON 3
 uu_4                -1.324764e-01 1 1  ON 4
 uu_5                -1.389026e-01 1 1  ON 5
 uu_6                -1.153774e-01 1 1  ON 6
 uu_7                -4.302493e-02 1 1  ON 7
 uu_8                 9.739779e-02 1 1  ON 8
 uu_9                 1.228717e-01 1 1  ON 9
 ud_0                 3.498107e-01 1 1  ON 10
 ud_1                 9.261970e-02 1 1  ON 11
 ud_2                -1.485600e-02 1 1  ON 12
 ud_3                -7.390923e-02 1 1  ON 13
 ud_4                -1.209786e-01 1 1  ON 14
 ud_5                -1.533218e-01 1 1  ON 15
 ud_6                -1.558872e-01 1 1  ON 16
 ud_7                -1.111163e-01 1 1  ON 17
 ud_8                 7.872594e-04 1 1  ON 18
 ud_9                 9.245016e-02 1 1  ON 19
 eO_0                -7.616787e-01 1 1  ON 20
 eO_1                -4.457295e-01 1 1  ON 21
 eO_2                -4.322672e-02 1 1  ON 22
 eO_3                 2.069605e-01 1 1  ON 23
 eO_4                 2.997025e-01 1 1  ON 24
 eO_5                 3.148453e-01 1 1  ON 25
 eO_6                 2.544447e-01 1 1  ON 26
 eO_7                 1.164974e-01 1 1  ON 27
 eO_8                 2.864309e-02 1 1  ON 28
 eO_9                 1.867026e-02 1 1  ON 29
eH1_0                -1.820818e-01 1 1  ON 30
eH1_1                -1.033692e-01 1 1  ON 31
eH1_2                -6.288795e-02 1 1  ON 32
eH1_3                -2.642526e-02 1 1  ON 33
eH1_4                 1.906271e-02 1 1  ON 34
eH1_5                 3.399165e-02 1 1  ON 35
eH1_6                 7.854937e-02 1 1  ON 36
eH1_7                 1.094763e-01 1 1  ON 37
eH1_8                 9.301178e-02 1 1  ON 38
eH1_9                 2.507903e-02 1 1  ON 39
eH2_0                -1.837341e-01 1 1  ON 40
eH2_1                -1.048006e-01 1 1  ON 41
eH2_2                -6.419547e-02 1 1  ON 42
eH2_3                -2.726199e-02 1 1  ON 43
eH2_4                 1.814624e-02 1 1  ON 44
eH2_5                 3.374319e-02 1 1  ON 45
eH2_6                 7.857474e-02 1 1  ON 46
eH2_7                 1.132014e-01 1 1  ON 47
eH2_8                 9.663744e-02 1 1  ON 48
eH2_9                 2.722812e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7382e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7253e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2008
    reference variance = 0.226707
====================================================
  Execution time = 2.0498e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1562e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315694787231
                                         uncertainty =       0.003872082495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315694787231
                                         uncertainty =       0.003872082495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397250913
  error estimate for blocks of size 2^( 2) =       0.000407308512
  error estimate for blocks of size 2^( 3) =       0.000416096485
  error estimate for blocks of size 2^( 4) =       0.000422036277
  error estimate for blocks of size 2^( 5) =       0.000426320711
  error estimate for blocks of size 2^( 6) =       0.000428764012
  error estimate for blocks of size 2^( 7) =       0.000431790858

      target function =                  N/A
              le_mean =     -17.216368379195
             les_mean =     296.718956586135
             stat err =       0.000427227965
             autocorr =       1.156616905934
              std dev =       0.561797628854
             le_variance =       0.315616575786


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721636837920e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216368379195       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216367774115       residual = 8.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216370104117       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216369833921       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216378381768       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216383919378       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216380044983       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216380366987       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216380156906       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216380355550       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216380588969       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216380616985       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 3.986643e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216368379195       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216368078210       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216369084546       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216368830733       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216371533003       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216373503276       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216372432562       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216372406235       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216372290571       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216372286420       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 1.224246e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216368379195       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216368279209       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216368554344       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216368481306       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216369138331       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216369671250       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216369460580       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216369468143       residual = 9.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 3.282593e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.132204 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6099e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.107132e-01 1 1  ON 0
 uu_1                 4.877848e-02 1 1  ON 1
 uu_2                -4.530642e-02 1 1  ON 2
 uu_3                -9.960105e-02 1 1  ON 3
 uu_4                -1.325047e-01 1 1  ON 4
 uu_5                -1.389646e-01 1 1  ON 5
 uu_6                -1.155935e-01 1 1  ON 6
 uu_7                -4.323362e-02 1 1  ON 7
 uu_8                 9.725547e-02 1 1  ON 8
 uu_9                 1.229259e-01 1 1  ON 9
 ud_0                 3.503769e-01 1 1  ON 10
 ud_1                 9.295215e-02 1 1  ON 11
 ud_2                -1.496336e-02 1 1  ON 12
 ud_3                -7.428168e-02 1 1  ON 13
 ud_4                -1.211495e-01 1 1  ON 14
 ud_5                -1.531802e-01 1 1  ON 15
 ud_6                -1.559027e-01 1 1  ON 16
 ud_7                -1.112657e-01 1 1  ON 17
 ud_8                 5.405761e-04 1 1  ON 18
 ud_9                 9.241400e-02 1 1  ON 19
 eO_0                -7.629030e-01 1 1  ON 20
 eO_1                -4.465011e-01 1 1  ON 21
 eO_2                -4.303332e-02 1 1  ON 22
 eO_3                 2.076189e-01 1 1  ON 23
 eO_4                 3.002000e-01 1 1  ON 24
 eO_5                 3.151551e-01 1 1  ON 25
 eO_6                 2.545693e-01 1 1  ON 26
 eO_7                 1.166812e-01 1 1  ON 27
 eO_8                 2.866499e-02 1 1  ON 28
 eO_9                 1.867340e-02 1 1  ON 29
eH1_0                -1.822076e-01 1 1  ON 30
eH1_1                -1.033906e-01 1 1  ON 31
eH1_2                -6.300042e-02 1 1  ON 32
eH1_3                -2.634021e-02 1 1  ON 33
eH1_4                 1.909860e-02 1 1  ON 34
eH1_5                 3.416435e-02 1 1  ON 35
eH1_6                 7.846586e-02 1 1  ON 36
eH1_7                 1.094016e-01 1 1  ON 37
eH1_8                 9.310326e-02 1 1  ON 38
eH1_9                 2.510239e-02 1 1  ON 39
eH2_0                -1.838736e-01 1 1  ON 40
eH2_1                -1.047488e-01 1 1  ON 41
eH2_2                -6.423181e-02 1 1  ON 42
eH2_3                -2.725059e-02 1 1  ON 43
eH2_4                 1.818502e-02 1 1  ON 44
eH2_5                 3.375847e-02 1 1  ON 45
eH2_6                 7.856054e-02 1 1  ON 46
eH2_7                 1.131710e-01 1 1  ON 47
eH2_8                 9.671455e-02 1 1  ON 48
eH2_9                 2.724904e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2133
    reference variance = 0.267196
====================================================
  Execution time = 1.9949e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1499e-01
  Total weights = 2.0000e+06
  Execution time = 1.8242e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314403048394
                                         uncertainty =       0.003045068999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314403048394
                                         uncertainty =       0.003045068999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396518935
  error estimate for blocks of size 2^( 2) =       0.000406475881
  error estimate for blocks of size 2^( 3) =       0.000415131820
  error estimate for blocks of size 2^( 4) =       0.000421633835
  error estimate for blocks of size 2^( 5) =       0.000425682306
  error estimate for blocks of size 2^( 6) =       0.000429860969
  error estimate for blocks of size 2^( 7) =       0.000431395608

      target function =                  N/A
              le_mean =     -17.217036998114
             les_mean =     296.740817368530
             stat err =       0.000427143180
             autocorr =       1.160430381676
              std dev =       0.560762455343
             le_variance =       0.314454531323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315727055204
                                         uncertainty =       0.003058128614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315727055204
                                         uncertainty =       0.003058128614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397353090
  error estimate for blocks of size 2^( 2) =       0.000407261718
  error estimate for blocks of size 2^( 3) =       0.000415866094
  error estimate for blocks of size 2^( 4) =       0.000422328033
  error estimate for blocks of size 2^( 5) =       0.000426356216
  error estimate for blocks of size 2^( 6) =       0.000430536459
  error estimate for blocks of size 2^( 7) =       0.000432095621

      target function =                  N/A
              le_mean =     -17.217039363091
             les_mean =     296.742223227914
             stat err =       0.000427829082
             autocorr =       1.159277528930
              std dev =       0.561942128330
             le_variance =       0.315778955592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315475869897
                                         uncertainty =       0.003055148473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315475869897
                                         uncertainty =       0.003055148473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397195005
  error estimate for blocks of size 2^( 2) =       0.000407113266
  error estimate for blocks of size 2^( 3) =       0.000415727536
  error estimate for blocks of size 2^( 4) =       0.000422197207
  error estimate for blocks of size 2^( 5) =       0.000426228293
  error estimate for blocks of size 2^( 6) =       0.000430406322
  error estimate for blocks of size 2^( 7) =       0.000431962249

      target function =                  N/A
              le_mean =     -17.217037201637
             les_mean =     296.741897588388
             stat err =       0.000427698517
             autocorr =       1.159492472666
              std dev =       0.561718562629
             le_variance =       0.315527743601

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314567794658
                                         uncertainty =       0.003046596167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314567794658
                                         uncertainty =       0.003046596167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396622836
  error estimate for blocks of size 2^( 2) =       0.000406573468
  error estimate for blocks of size 2^( 3) =       0.000415222698
  error estimate for blocks of size 2^( 4) =       0.000421719551
  error estimate for blocks of size 2^( 5) =       0.000425765139
  error estimate for blocks of size 2^( 6) =       0.000429943620
  error estimate for blocks of size 2^( 7) =       0.000431481599

      target function =                  N/A
              le_mean =     -17.217036431435
             les_mean =     296.740962671925
             stat err =       0.000427227477
             autocorr =       1.160280309324
              std dev =       0.560909393645
             le_variance =       0.314619347879


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217036998114        initial
     1.5625e-01     1.5625e+00             3.9866e-03       -17.217039363091  <--
     6.2500e-01     6.2500e+00             1.2242e-03       -17.217037201637
     2.5000e+00     2.5000e+01             3.2826e-04       -17.217036431435

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 3.2750e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.114519e-01 1 1  ON 0
 uu_1                 4.929458e-02 1 1  ON 1
 uu_2                -4.506613e-02 1 1  ON 2
 uu_3                -9.956377e-02 1 1  ON 3
 uu_4                -1.326303e-01 1 1  ON 4
 uu_5                -1.392464e-01 1 1  ON 5
 uu_6                -1.160903e-01 1 1  ON 6
 uu_7                -4.379568e-02 1 1  ON 7
 uu_8                 9.684152e-02 1 1  ON 8
 uu_9                 1.230873e-01 1 1  ON 9
 ud_0                 3.513117e-01 1 1  ON 10
 ud_1                 9.350794e-02 1 1  ON 11
 ud_2                -1.491720e-02 1 1  ON 12
 ud_3                -7.467923e-02 1 1  ON 13
 ud_4                -1.215080e-01 1 1  ON 14
 ud_5                -1.531285e-01 1 1  ON 15
 ud_6                -1.557972e-01 1 1  ON 16
 ud_7                -1.115719e-01 1 1  ON 17
 ud_8                -1.590714e-04 1 1  ON 18
 ud_9                 9.230925e-02 1 1  ON 19
 eO_0                -7.656654e-01 1 1  ON 20
 eO_1                -4.483704e-01 1 1  ON 21
 eO_2                -4.325776e-02 1 1  ON 22
 eO_3                 2.087759e-01 1 1  ON 23
 eO_4                 3.017711e-01 1 1  ON 24
 eO_5                 3.162283e-01 1 1  ON 25
 eO_6                 2.549864e-01 1 1  ON 26
 eO_7                 1.172338e-01 1 1  ON 27
 eO_8                 2.873082e-02 1 1  ON 28
 eO_9                 1.868269e-02 1 1  ON 29
eH1_0                -1.824979e-01 1 1  ON 30
eH1_1                -1.035448e-01 1 1  ON 31
eH1_2                -6.314315e-02 1 1  ON 32
eH1_3                -2.622878e-02 1 1  ON 33
eH1_4                 1.913857e-02 1 1  ON 34
eH1_5                 3.457348e-02 1 1  ON 35
eH1_6                 7.830954e-02 1 1  ON 36
eH1_7                 1.092121e-01 1 1  ON 37
eH1_8                 9.337861e-02 1 1  ON 38
eH1_9                 2.517213e-02 1 1  ON 39
eH2_0                -1.841374e-01 1 1  ON 40
eH2_1                -1.047912e-01 1 1  ON 41
eH2_2                -6.427466e-02 1 1  ON 42
eH2_3                -2.722011e-02 1 1  ON 43
eH2_4                 1.818035e-02 1 1  ON 44
eH2_5                 3.380314e-02 1 1  ON 45
eH2_6                 7.859047e-02 1 1  ON 46
eH2_7                 1.131082e-01 1 1  ON 47
eH2_8                 9.694799e-02 1 1  ON 48
eH2_9                 2.731169e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9265e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7241e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1617
    reference variance = 0.232485
====================================================
  Execution time = 2.0377e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1070e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5138e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310723347091
                                         uncertainty =       0.002515978933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310723347091
                                         uncertainty =       0.002515978933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394144183
  error estimate for blocks of size 2^( 2) =       0.000403916239
  error estimate for blocks of size 2^( 3) =       0.000413214010
  error estimate for blocks of size 2^( 4) =       0.000420048598
  error estimate for blocks of size 2^( 5) =       0.000423900891
  error estimate for blocks of size 2^( 6) =       0.000426373976
  error estimate for blocks of size 2^( 7) =       0.000428170372

      target function =                  N/A
              le_mean =     -17.216879844910
             les_mean =     296.731650712195
             stat err =       0.000424623459
             autocorr =       1.160640512110
              std dev =       0.557404048672
             le_variance =       0.310699273476


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721687984491e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216879844910       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216879873909       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216882586554       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216885901602       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216889900699       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216894063040       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216900720288       residual = 9.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216899244990       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216899529614       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216901801221       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216903260785       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216902639000       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216903262347       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216902425987       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216902691451       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216902746020       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 9.121627e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216879844910       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216879866051       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216881605519       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216883041500       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216885459644       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216887501697       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216889274198       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216888321663       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216888489861       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216888735377       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216888889371       residual = 6.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 3.233891e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216879844910       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216879855055       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216880585233       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216881046849       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216881885387       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216882736104       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216882815707       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216882633338       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216882706687       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 9.971592e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137747 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5899e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.118766e-01 1 1  ON 0
 uu_1                 4.964146e-02 1 1  ON 1
 uu_2                -4.478267e-02 1 1  ON 2
 uu_3                -9.943869e-02 1 1  ON 3
 uu_4                -1.329034e-01 1 1  ON 4
 uu_5                -1.394315e-01 1 1  ON 5
 uu_6                -1.165139e-01 1 1  ON 6
 uu_7                -4.454445e-02 1 1  ON 7
 uu_8                 9.624194e-02 1 1  ON 8
 uu_9                 1.234752e-01 1 1  ON 9
 ud_0                 3.520801e-01 1 1  ON 10
 ud_1                 9.390864e-02 1 1  ON 11
 ud_2                -1.495015e-02 1 1  ON 12
 ud_3                -7.491247e-02 1 1  ON 13
 ud_4                -1.220699e-01 1 1  ON 14
 ud_5                -1.535184e-01 1 1  ON 15
 ud_6                -1.556460e-01 1 1  ON 16
 ud_7                -1.117697e-01 1 1  ON 17
 ud_8                -7.573795e-04 1 1  ON 18
 ud_9                 9.237827e-02 1 1  ON 19
 eO_0                -7.688993e-01 1 1  ON 20
 eO_1                -4.502092e-01 1 1  ON 21
 eO_2                -4.396082e-02 1 1  ON 22
 eO_3                 2.099212e-01 1 1  ON 23
 eO_4                 3.036678e-01 1 1  ON 24
 eO_5                 3.173438e-01 1 1  ON 25
 eO_6                 2.554529e-01 1 1  ON 26
 eO_7                 1.180240e-01 1 1  ON 27
 eO_8                 2.891163e-02 1 1  ON 28
 eO_9                 1.876603e-02 1 1  ON 29
eH1_0                -1.829314e-01 1 1  ON 30
eH1_1                -1.036877e-01 1 1  ON 31
eH1_2                -6.271642e-02 1 1  ON 32
eH1_3                -2.594321e-02 1 1  ON 33
eH1_4                 1.943686e-02 1 1  ON 34
eH1_5                 3.394732e-02 1 1  ON 35
eH1_6                 7.806785e-02 1 1  ON 36
eH1_7                 1.091148e-01 1 1  ON 37
eH1_8                 9.368758e-02 1 1  ON 38
eH1_9                 2.526063e-02 1 1  ON 39
eH2_0                -1.841387e-01 1 1  ON 40
eH2_1                -1.051194e-01 1 1  ON 41
eH2_2                -6.421631e-02 1 1  ON 42
eH2_3                -2.712861e-02 1 1  ON 43
eH2_4                 1.824524e-02 1 1  ON 44
eH2_5                 3.333271e-02 1 1  ON 45
eH2_6                 7.869556e-02 1 1  ON 46
eH2_7                 1.128829e-01 1 1  ON 47
eH2_8                 9.736757e-02 1 1  ON 48
eH2_9                 2.751993e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.152
    reference variance = 0.254474
====================================================
  Execution time = 2.0322e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2006e-01
  Total weights = 2.0000e+06
  Execution time = 1.8540e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319438969815
                                         uncertainty =       0.004533479911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319438969815
                                         uncertainty =       0.004533479911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399646412
  error estimate for blocks of size 2^( 2) =       0.000409409029
  error estimate for blocks of size 2^( 3) =       0.000418019768
  error estimate for blocks of size 2^( 4) =       0.000424705733
  error estimate for blocks of size 2^( 5) =       0.000429081505
  error estimate for blocks of size 2^( 6) =       0.000429454126
  error estimate for blocks of size 2^( 7) =       0.000431780104

      target function =                  N/A
              le_mean =     -17.216450116118
             les_mean =     296.725588950548
             stat err =       0.000428755367
             autocorr =       1.150978741003
              std dev =       0.565185376223
             le_variance =       0.319434509496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320723341144
                                         uncertainty =       0.004558541181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320723341144
                                         uncertainty =       0.004558541181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400448832
  error estimate for blocks of size 2^( 2) =       0.000410165209
  error estimate for blocks of size 2^( 3) =       0.000418726418
  error estimate for blocks of size 2^( 4) =       0.000425375523
  error estimate for blocks of size 2^( 5) =       0.000429719051
  error estimate for blocks of size 2^( 6) =       0.000430070016
  error estimate for blocks of size 2^( 7) =       0.000432385237

      target function =                  N/A
              le_mean =     -17.216448347768
             les_mean =     296.726812084941
             stat err =       0.000429387457
             autocorr =       1.149753248252
              std dev =       0.566320169093
             le_variance =       0.320718533922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320710156532
                                         uncertainty =       0.004556518711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320710156532
                                         uncertainty =       0.004556518711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400440667
  error estimate for blocks of size 2^( 2) =       0.000410158351
  error estimate for blocks of size 2^( 3) =       0.000418726886
  error estimate for blocks of size 2^( 4) =       0.000425383445
  error estimate for blocks of size 2^( 5) =       0.000429728654
  error estimate for blocks of size 2^( 6) =       0.000430081126
  error estimate for blocks of size 2^( 7) =       0.000432400193

      target function =                  N/A
              le_mean =     -17.216449483222
             les_mean =     296.726838102774
             stat err =       0.000429398355
             autocorr =       1.149858502268
              std dev =       0.566308621500
             le_variance =       0.320705454785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319673080039
                                         uncertainty =       0.004537488943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319673080039
                                         uncertainty =       0.004537488943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399792815
  error estimate for blocks of size 2^( 2) =       0.000409546296
  error estimate for blocks of size 2^( 3) =       0.000418149299
  error estimate for blocks of size 2^( 4) =       0.000424829760
  error estimate for blocks of size 2^( 5) =       0.000429199111
  error estimate for blocks of size 2^( 6) =       0.000429567337
  error estimate for blocks of size 2^( 7) =       0.000431892242

      target function =                  N/A
              le_mean =     -17.216449215797
             les_mean =     296.725792029700
             stat err =       0.000428872112
             autocorr =       1.150762351389
              std dev =       0.565392420734
             le_variance =       0.319668589423


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216450116118        initial  <--
     3.9062e-02     3.9062e-01             9.1216e-03       -17.216448347768
     1.5625e-01     1.5625e+00             3.2339e-03       -17.216449483222
     6.2500e-01     6.2500e+00             9.9716e-04       -17.216449215797

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7198
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.114519e-01 1 1  ON 0
 uu_1                 4.929458e-02 1 1  ON 1
 uu_2                -4.506613e-02 1 1  ON 2
 uu_3                -9.956377e-02 1 1  ON 3
 uu_4                -1.326303e-01 1 1  ON 4
 uu_5                -1.392464e-01 1 1  ON 5
 uu_6                -1.160903e-01 1 1  ON 6
 uu_7                -4.379568e-02 1 1  ON 7
 uu_8                 9.684152e-02 1 1  ON 8
 uu_9                 1.230873e-01 1 1  ON 9
 ud_0                 3.513117e-01 1 1  ON 10
 ud_1                 9.350794e-02 1 1  ON 11
 ud_2                -1.491720e-02 1 1  ON 12
 ud_3                -7.467923e-02 1 1  ON 13
 ud_4                -1.215080e-01 1 1  ON 14
 ud_5                -1.531285e-01 1 1  ON 15
 ud_6                -1.557972e-01 1 1  ON 16
 ud_7                -1.115719e-01 1 1  ON 17
 ud_8                -1.590714e-04 1 1  ON 18
 ud_9                 9.230925e-02 1 1  ON 19
 eO_0                -7.656654e-01 1 1  ON 20
 eO_1                -4.483704e-01 1 1  ON 21
 eO_2                -4.325776e-02 1 1  ON 22
 eO_3                 2.087759e-01 1 1  ON 23
 eO_4                 3.017711e-01 1 1  ON 24
 eO_5                 3.162283e-01 1 1  ON 25
 eO_6                 2.549864e-01 1 1  ON 26
 eO_7                 1.172338e-01 1 1  ON 27
 eO_8                 2.873082e-02 1 1  ON 28
 eO_9                 1.868269e-02 1 1  ON 29
eH1_0                -1.824979e-01 1 1  ON 30
eH1_1                -1.035448e-01 1 1  ON 31
eH1_2                -6.314315e-02 1 1  ON 32
eH1_3                -2.622878e-02 1 1  ON 33
eH1_4                 1.913857e-02 1 1  ON 34
eH1_5                 3.457348e-02 1 1  ON 35
eH1_6                 7.830954e-02 1 1  ON 36
eH1_7                 1.092121e-01 1 1  ON 37
eH1_8                 9.337861e-02 1 1  ON 38
eH1_9                 2.517213e-02 1 1  ON 39
eH2_0                -1.841374e-01 1 1  ON 40
eH2_1                -1.047912e-01 1 1  ON 41
eH2_2                -6.427466e-02 1 1  ON 42
eH2_3                -2.722011e-02 1 1  ON 43
eH2_4                 1.818035e-02 1 1  ON 44
eH2_5                 3.380314e-02 1 1  ON 45
eH2_6                 7.859047e-02 1 1  ON 46
eH2_7                 1.131082e-01 1 1  ON 47
eH2_8                 9.694799e-02 1 1  ON 48
eH2_9                 2.731169e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5996e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2741
    reference variance = 0.414815
====================================================
  Execution time = 2.0222e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.5653e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5214e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356659868727
                                         uncertainty =       0.036907113043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356659868727
                                         uncertainty =       0.036907113043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422215881
  error estimate for blocks of size 2^( 2) =       0.000430980334
  error estimate for blocks of size 2^( 3) =       0.000439342459
  error estimate for blocks of size 2^( 4) =       0.000445495443
  error estimate for blocks of size 2^( 5) =       0.000449680327
  error estimate for blocks of size 2^( 6) =       0.000451522912
  error estimate for blocks of size 2^( 7) =       0.000451257858

      target function =                  N/A
              le_mean =     -17.216628351578
             les_mean =     296.768824118325
             stat err =       0.000449489135
             autocorr =       1.133363619926
              std dev =       0.597103425081
             le_variance =       0.356532500244


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721662835158e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216628351578       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216629321151       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216631738249       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216629902474       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216629976541       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216630432869       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216631109950       residual = 9.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216630962254       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216630998407       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 1.444857e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216628351578       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216628661385       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216629603577       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216628972280       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216628796354       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216628973534       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216629088664       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216629111576       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 4.138313e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216628351578       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216628434817       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216628709585       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216628536686       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216628463907       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216628511287       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216628540756       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216628547902       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 1.085526e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140596 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5749e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.114356e-01 1 1  ON 0
 uu_1                 4.934784e-02 1 1  ON 1
 uu_2                -4.502660e-02 1 1  ON 2
 uu_3                -9.955449e-02 1 1  ON 3
 uu_4                -1.326377e-01 1 1  ON 4
 uu_5                -1.392239e-01 1 1  ON 5
 uu_6                -1.161419e-01 1 1  ON 6
 uu_7                -4.385461e-02 1 1  ON 7
 uu_8                 9.679830e-02 1 1  ON 8
 uu_9                 1.231148e-01 1 1  ON 9
 ud_0                 3.515068e-01 1 1  ON 10
 ud_1                 9.356675e-02 1 1  ON 11
 ud_2                -1.493321e-02 1 1  ON 12
 ud_3                -7.471855e-02 1 1  ON 13
 ud_4                -1.216111e-01 1 1  ON 14
 ud_5                -1.531875e-01 1 1  ON 15
 ud_6                -1.557754e-01 1 1  ON 16
 ud_7                -1.115740e-01 1 1  ON 17
 ud_8                -2.283101e-04 1 1  ON 18
 ud_9                 9.230013e-02 1 1  ON 19
 eO_0                -7.660792e-01 1 1  ON 20
 eO_1                -4.485297e-01 1 1  ON 21
 eO_2                -4.325925e-02 1 1  ON 22
 eO_3                 2.088866e-01 1 1  ON 23
 eO_4                 3.019558e-01 1 1  ON 24
 eO_5                 3.163398e-01 1 1  ON 25
 eO_6                 2.550643e-01 1 1  ON 26
 eO_7                 1.173103e-01 1 1  ON 27
 eO_8                 2.874011e-02 1 1  ON 28
 eO_9                 1.868449e-02 1 1  ON 29
eH1_0                -1.825321e-01 1 1  ON 30
eH1_1                -1.035950e-01 1 1  ON 31
eH1_2                -6.312376e-02 1 1  ON 32
eH1_3                -2.621940e-02 1 1  ON 33
eH1_4                 1.917629e-02 1 1  ON 34
eH1_5                 3.453148e-02 1 1  ON 35
eH1_6                 7.831429e-02 1 1  ON 36
eH1_7                 1.092198e-01 1 1  ON 37
eH1_8                 9.341779e-02 1 1  ON 38
eH1_9                 2.517768e-02 1 1  ON 39
eH2_0                -1.841469e-01 1 1  ON 40
eH2_1                -1.048037e-01 1 1  ON 41
eH2_2                -6.430680e-02 1 1  ON 42
eH2_3                -2.719957e-02 1 1  ON 43
eH2_4                 1.814441e-02 1 1  ON 44
eH2_5                 3.380379e-02 1 1  ON 45
eH2_6                 7.860901e-02 1 1  ON 46
eH2_7                 1.130995e-01 1 1  ON 47
eH2_8                 9.699092e-02 1 1  ON 48
eH2_9                 2.732439e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1703
    reference variance = 0.135293
====================================================
  Execution time = 2.0826e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1472e-01
  Total weights = 2.0000e+06
  Execution time = 1.8444e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314589173581
                                         uncertainty =       0.003087150635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314589173581
                                         uncertainty =       0.003087150635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396589394
  error estimate for blocks of size 2^( 2) =       0.000406400559
  error estimate for blocks of size 2^( 3) =       0.000415224579
  error estimate for blocks of size 2^( 4) =       0.000422348023
  error estimate for blocks of size 2^( 5) =       0.000426508209
  error estimate for blocks of size 2^( 6) =       0.000428306956
  error estimate for blocks of size 2^( 7) =       0.000429853249

      target function =                  N/A
              le_mean =     -17.216334389630
             les_mean =     296.716735953288
             stat err =       0.000426754109
             autocorr =       1.157905805016
              std dev =       0.560862099831
             le_variance =       0.314566295027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315036378911
                                         uncertainty =       0.003091617768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315036378911
                                         uncertainty =       0.003091617768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396871204
  error estimate for blocks of size 2^( 2) =       0.000406666065
  error estimate for blocks of size 2^( 3) =       0.000415472724
  error estimate for blocks of size 2^( 4) =       0.000422582684
  error estimate for blocks of size 2^( 5) =       0.000426737855
  error estimate for blocks of size 2^( 6) =       0.000428531574
  error estimate for blocks of size 2^( 7) =       0.000430079940

      target function =                  N/A
              le_mean =     -17.216336076349
             les_mean =     296.717241242177
             stat err =       0.000426983013
             autocorr =       1.157502711126
              std dev =       0.561260639884
             le_variance =       0.315013505883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314907590438
                                         uncertainty =       0.003090382149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314907590438
                                         uncertainty =       0.003090382149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396790080
  error estimate for blocks of size 2^( 2) =       0.000406589435
  error estimate for blocks of size 2^( 3) =       0.000415401761
  error estimate for blocks of size 2^( 4) =       0.000422516165
  error estimate for blocks of size 2^( 5) =       0.000426673546
  error estimate for blocks of size 2^( 6) =       0.000428468356
  error estimate for blocks of size 2^( 7) =       0.000430015660

      target function =                  N/A
              le_mean =     -17.216335624618
             les_mean =     296.717096916811
             stat err =       0.000426918432
             autocorr =       1.157625805735
              std dev =       0.561145912198
             le_variance =       0.314884734777

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314634209830
                                         uncertainty =       0.003087609735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314634209830
                                         uncertainty =       0.003087609735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396617785
  error estimate for blocks of size 2^( 2) =       0.000406427242
  error estimate for blocks of size 2^( 3) =       0.000415249613
  error estimate for blocks of size 2^( 4) =       0.000422371783
  error estimate for blocks of size 2^( 5) =       0.000426531595
  error estimate for blocks of size 2^( 6) =       0.000428329788
  error estimate for blocks of size 2^( 7) =       0.000429876184

      target function =                  N/A
              le_mean =     -17.216334538953
             les_mean =     296.716786134909
             stat err =       0.000426777338
             autocorr =       1.157866075598
              std dev =       0.560902250897
             le_variance =       0.314611335062


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216334389630        initial
     3.9062e-01     3.9062e+00             1.4449e-03       -17.216336076349  <--
     1.5625e+00     1.5625e+01             4.1383e-04       -17.216335624618
     6.2500e+00     6.2500e+01             1.0855e-04       -17.216334538953

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 3.0145e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.114999e-01 1 1  ON 0
 uu_1                 4.948385e-02 1 1  ON 1
 uu_2                -4.494287e-02 1 1  ON 2
 uu_3                -9.953191e-02 1 1  ON 3
 uu_4                -1.326820e-01 1 1  ON 4
 uu_5                -1.392045e-01 1 1  ON 5
 uu_6                -1.162834e-01 1 1  ON 6
 uu_7                -4.402422e-02 1 1  ON 7
 uu_8                 9.667023e-02 1 1  ON 8
 uu_9                 1.231963e-01 1 1  ON 9
 ud_0                 3.518920e-01 1 1  ON 10
 ud_1                 9.375466e-02 1 1  ON 11
 ud_2                -1.491279e-02 1 1  ON 12
 ud_3                -7.479594e-02 1 1  ON 13
 ud_4                -1.218418e-01 1 1  ON 14
 ud_5                -1.533604e-01 1 1  ON 15
 ud_6                -1.557238e-01 1 1  ON 16
 ud_7                -1.115755e-01 1 1  ON 17
 ud_8                -4.304837e-04 1 1  ON 18
 ud_9                 9.227334e-02 1 1  ON 19
 eO_0                -7.671102e-01 1 1  ON 20
 eO_1                -4.490744e-01 1 1  ON 21
 eO_2                -4.335655e-02 1 1  ON 22
 eO_3                 2.091802e-01 1 1  ON 23
 eO_4                 3.024918e-01 1 1  ON 24
 eO_5                 3.166803e-01 1 1  ON 25
 eO_6                 2.552996e-01 1 1  ON 26
 eO_7                 1.175381e-01 1 1  ON 27
 eO_8                 2.876780e-02 1 1  ON 28
 eO_9                 1.868982e-02 1 1  ON 29
eH1_0                -1.826251e-01 1 1  ON 30
eH1_1                -1.036981e-01 1 1  ON 31
eH1_2                -6.308339e-02 1 1  ON 32
eH1_3                -2.621077e-02 1 1  ON 33
eH1_4                 1.925367e-02 1 1  ON 34
eH1_5                 3.441710e-02 1 1  ON 35
eH1_6                 7.833231e-02 1 1  ON 36
eH1_7                 1.092441e-01 1 1  ON 37
eH1_8                 9.353448e-02 1 1  ON 38
eH1_9                 2.519423e-02 1 1  ON 39
eH2_0                -1.841788e-01 1 1  ON 40
eH2_1                -1.048719e-01 1 1  ON 41
eH2_2                -6.435934e-02 1 1  ON 42
eH2_3                -2.716698e-02 1 1  ON 43
eH2_4                 1.806943e-02 1 1  ON 44
eH2_5                 3.379045e-02 1 1  ON 45
eH2_6                 7.866490e-02 1 1  ON 46
eH2_7                 1.130764e-01 1 1  ON 47
eH2_8                 9.711898e-02 1 1  ON 48
eH2_9                 2.736219e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5925e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2792
    reference variance = 0.966338
====================================================
  Execution time = 2.0308e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2268e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5284e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322629423446
                                         uncertainty =       0.005229161852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322629423446
                                         uncertainty =       0.005229161852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401673321
  error estimate for blocks of size 2^( 2) =       0.000411160909
  error estimate for blocks of size 2^( 3) =       0.000419942857
  error estimate for blocks of size 2^( 4) =       0.000426497699
  error estimate for blocks of size 2^( 5) =       0.000430174306
  error estimate for blocks of size 2^( 6) =       0.000432651271
  error estimate for blocks of size 2^( 7) =       0.000434776995

      target function =                  N/A
              le_mean =     -17.217343613110
             les_mean =     296.759603844035
             stat err =       0.000431025068
             autocorr =       1.151487117341
              std dev =       0.568051858083
             le_variance =       0.322682913472


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721734361311e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217343613110       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217343767346       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217343828861       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217343721825       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217343044567       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217343424879       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217343908026       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217344420576       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217345763016       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217346017152       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217345304708       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217345566075       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 3.955125e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217343613110       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217343683614       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217343680416       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217343431369       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217343663724       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217343792142       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217343783473       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217343731805       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217343940304       residual = 8.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 1.240933e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217343613110       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217343635341       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217343627500       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217343500792       residual = 9.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217343700904       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217343724913       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217343661525       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217343666564       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 3.469075e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144338 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5844e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.117324e-01 1 1  ON 0
 uu_1                 4.958505e-02 1 1  ON 1
 uu_2                -4.484411e-02 1 1  ON 2
 uu_3                -9.950167e-02 1 1  ON 3
 uu_4                -1.327497e-01 1 1  ON 4
 uu_5                -1.393887e-01 1 1  ON 5
 uu_6                -1.162854e-01 1 1  ON 6
 uu_7                -4.433549e-02 1 1  ON 7
 uu_8                 9.645343e-02 1 1  ON 8
 uu_9                 1.233506e-01 1 1  ON 9
 ud_0                 3.520741e-01 1 1  ON 10
 ud_1                 9.395693e-02 1 1  ON 11
 ud_2                -1.481289e-02 1 1  ON 12
 ud_3                -7.488132e-02 1 1  ON 13
 ud_4                -1.220482e-01 1 1  ON 14
 ud_5                -1.536885e-01 1 1  ON 15
 ud_6                -1.555498e-01 1 1  ON 16
 ud_7                -1.115128e-01 1 1  ON 17
 ud_8                -6.568041e-04 1 1  ON 18
 ud_9                 9.228683e-02 1 1  ON 19
 eO_0                -7.683512e-01 1 1  ON 20
 eO_1                -4.497290e-01 1 1  ON 21
 eO_2                -4.362062e-02 1 1  ON 22
 eO_3                 2.095429e-01 1 1  ON 23
 eO_4                 3.030354e-01 1 1  ON 24
 eO_5                 3.172087e-01 1 1  ON 25
 eO_6                 2.556574e-01 1 1  ON 26
 eO_7                 1.178363e-01 1 1  ON 27
 eO_8                 2.881479e-02 1 1  ON 28
 eO_9                 1.870455e-02 1 1  ON 29
eH1_0                -1.827409e-01 1 1  ON 30
eH1_1                -1.036745e-01 1 1  ON 31
eH1_2                -6.301793e-02 1 1  ON 32
eH1_3                -2.628068e-02 1 1  ON 33
eH1_4                 1.917077e-02 1 1  ON 34
eH1_5                 3.431287e-02 1 1  ON 35
eH1_6                 7.832376e-02 1 1  ON 36
eH1_7                 1.092587e-01 1 1  ON 37
eH1_8                 9.372751e-02 1 1  ON 38
eH1_9                 2.526335e-02 1 1  ON 39
eH2_0                -1.843958e-01 1 1  ON 40
eH2_1                -1.050290e-01 1 1  ON 41
eH2_2                -6.423210e-02 1 1  ON 42
eH2_3                -2.719630e-02 1 1  ON 43
eH2_4                 1.819157e-02 1 1  ON 44
eH2_5                 3.372664e-02 1 1  ON 45
eH2_6                 7.864761e-02 1 1  ON 46
eH2_7                 1.130633e-01 1 1  ON 47
eH2_8                 9.730078e-02 1 1  ON 48
eH2_9                 2.741896e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2512
    reference variance = 0.33329
====================================================
  Execution time = 2.0035e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2304e-01
  Total weights = 2.0000e+06
  Execution time = 1.8256e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323041737452
                                         uncertainty =       0.006015947570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323041737452
                                         uncertainty =       0.006015947570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401838178
  error estimate for blocks of size 2^( 2) =       0.000411711400
  error estimate for blocks of size 2^( 3) =       0.000420568131
  error estimate for blocks of size 2^( 4) =       0.000426839726
  error estimate for blocks of size 2^( 5) =       0.000430503987
  error estimate for blocks of size 2^( 6) =       0.000433419723
  error estimate for blocks of size 2^( 7) =       0.000436251769

      target function =                  N/A
              le_mean =     -17.217475670597
             les_mean =     296.764416149334
             stat err =       0.000431753801
             autocorr =       1.154436228763
              std dev =       0.568285001737
             le_variance =       0.322947843200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323434624883
                                         uncertainty =       0.006035183615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323434624883
                                         uncertainty =       0.006035183615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402082441
  error estimate for blocks of size 2^( 2) =       0.000411944588
  error estimate for blocks of size 2^( 3) =       0.000420781714
  error estimate for blocks of size 2^( 4) =       0.000427035889
  error estimate for blocks of size 2^( 5) =       0.000430691206
  error estimate for blocks of size 2^( 6) =       0.000433598780
  error estimate for blocks of size 2^( 7) =       0.000436410436

      target function =                  N/A
              le_mean =     -17.217479689634
             les_mean =     296.764947279441
             stat err =       0.000431934078
             autocorr =       1.153997117496
              std dev =       0.568630440758
             le_variance =       0.323340578157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323221007213
                                         uncertainty =       0.006026431992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323221007213
                                         uncertainty =       0.006026431992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401949635
  error estimate for blocks of size 2^( 2) =       0.000411818711
  error estimate for blocks of size 2^( 3) =       0.000420665083
  error estimate for blocks of size 2^( 4) =       0.000426925751
  error estimate for blocks of size 2^( 5) =       0.000430586278
  error estimate for blocks of size 2^( 6) =       0.000433496977
  error estimate for blocks of size 2^( 7) =       0.000436313066

      target function =                  N/A
              le_mean =     -17.217478609945
             les_mean =     296.764696540690
             stat err =       0.000431830518
             autocorr =       1.154206153358
              std dev =       0.568442625359
             le_variance =       0.323127018325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323051378528
                                         uncertainty =       0.006016674469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323051378528
                                         uncertainty =       0.006016674469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401844171
  error estimate for blocks of size 2^( 2) =       0.000411717208
  error estimate for blocks of size 2^( 3) =       0.000420572788
  error estimate for blocks of size 2^( 4) =       0.000426843029
  error estimate for blocks of size 2^( 5) =       0.000430507032
  error estimate for blocks of size 2^( 6) =       0.000433422005
  error estimate for blocks of size 2^( 7) =       0.000436251804

      target function =                  N/A
              le_mean =     -17.217475999421
             les_mean =     296.764437105165
             stat err =       0.000431755968
             autocorr =       1.154413378531
              std dev =       0.568293477006
             le_variance =       0.322957476007


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217475670597        initial
     9.7656e-02     9.7656e-01             3.9551e-03       -17.217479689634  <--
     3.9062e-01     3.9062e+00             1.2409e-03       -17.217478609945
     1.5625e+00     1.5625e+01             3.4691e-04       -17.217475999421

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 2.9245e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.123281e-01 1 1  ON 0
 uu_1                 5.002095e-02 1 1  ON 1
 uu_2                -4.455884e-02 1 1  ON 2
 uu_3                -9.939154e-02 1 1  ON 3
 uu_4                -1.328763e-01 1 1  ON 4
 uu_5                -1.398254e-01 1 1  ON 5
 uu_6                -1.165243e-01 1 1  ON 6
 uu_7                -4.526295e-02 1 1  ON 7
 uu_8                 9.580561e-02 1 1  ON 8
 uu_9                 1.238077e-01 1 1  ON 9
 ud_0                 3.525476e-01 1 1  ON 10
 ud_1                 9.436170e-02 1 1  ON 11
 ud_2                -1.458952e-02 1 1  ON 12
 ud_3                -7.492088e-02 1 1  ON 13
 ud_4                -1.223727e-01 1 1  ON 14
 ud_5                -1.542465e-01 1 1  ON 15
 ud_6                -1.555415e-01 1 1  ON 16
 ud_7                -1.114216e-01 1 1  ON 17
 ud_8                -1.311813e-03 1 1  ON 18
 ud_9                 9.232835e-02 1 1  ON 19
 eO_0                -7.710654e-01 1 1  ON 20
 eO_1                -4.516667e-01 1 1  ON 21
 eO_2                -4.456717e-02 1 1  ON 22
 eO_3                 2.098864e-01 1 1  ON 23
 eO_4                 3.045601e-01 1 1  ON 24
 eO_5                 3.187781e-01 1 1  ON 25
 eO_6                 2.567138e-01 1 1  ON 26
 eO_7                 1.187327e-01 1 1  ON 27
 eO_8                 2.895682e-02 1 1  ON 28
 eO_9                 1.874843e-02 1 1  ON 29
eH1_0                -1.829195e-01 1 1  ON 30
eH1_1                -1.037211e-01 1 1  ON 31
eH1_2                -6.298965e-02 1 1  ON 32
eH1_3                -2.634731e-02 1 1  ON 33
eH1_4                 1.897079e-02 1 1  ON 34
eH1_5                 3.396248e-02 1 1  ON 35
eH1_6                 7.826958e-02 1 1  ON 36
eH1_7                 1.092948e-01 1 1  ON 37
eH1_8                 9.430538e-02 1 1  ON 38
eH1_9                 2.547095e-02 1 1  ON 39
eH2_0                -1.847760e-01 1 1  ON 40
eH2_1                -1.052812e-01 1 1  ON 41
eH2_2                -6.415547e-02 1 1  ON 42
eH2_3                -2.724095e-02 1 1  ON 43
eH2_4                 1.832999e-02 1 1  ON 44
eH2_5                 3.355669e-02 1 1  ON 45
eH2_6                 7.858519e-02 1 1  ON 46
eH2_7                 1.130148e-01 1 1  ON 47
eH2_8                 9.784410e-02 1 1  ON 48
eH2_9                 2.758939e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5400e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7230e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.291
    reference variance = 0.414033
====================================================
  Execution time = 2.0330e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1839e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6044e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318501335166
                                         uncertainty =       0.003814918477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318501335166
                                         uncertainty =       0.003814918477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398995690
  error estimate for blocks of size 2^( 2) =       0.000408366104
  error estimate for blocks of size 2^( 3) =       0.000417238141
  error estimate for blocks of size 2^( 4) =       0.000423945390
  error estimate for blocks of size 2^( 5) =       0.000427668663
  error estimate for blocks of size 2^( 6) =       0.000430962294
  error estimate for blocks of size 2^( 7) =       0.000431841944

      target function =                  N/A
              le_mean =     -17.216759914771
             les_mean =     296.735216925317
             stat err =       0.000428604573
             autocorr =       1.153923961448
              std dev =       0.564265116444
             le_variance =       0.318395121635


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721675991477e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216759914771       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216760985447       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216762182159       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216761363854       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216767162016       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216765690282       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216771408273       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216769946580       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216773226966       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216775975734       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216776406501       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216776057207       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216774953524       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216777758552       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216777695166       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216777216561       residual = 8.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 1.050989e-02

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216759914771       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216760755028       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216761609387       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216760502632       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216764037116       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216763069949       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216764854869       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216764120030       residual = 9.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216765110961       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216764942907       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216765381521       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216765003729       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 3.391111e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216759914771       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216760366319       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216760769186       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216759865079       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216761152112       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216760781408       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216761045925       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216760986899       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216761203831       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 9.641539e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150284 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5944e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.128221e-01 1 1  ON 0
 uu_1                 5.033946e-02 1 1  ON 1
 uu_2                -4.431539e-02 1 1  ON 2
 uu_3                -9.948759e-02 1 1  ON 3
 uu_4                -1.330619e-01 1 1  ON 4
 uu_5                -1.403728e-01 1 1  ON 5
 uu_6                -1.169133e-01 1 1  ON 6
 uu_7                -4.607580e-02 1 1  ON 7
 uu_8                 9.535052e-02 1 1  ON 8
 uu_9                 1.244698e-01 1 1  ON 9
 ud_0                 3.531533e-01 1 1  ON 10
 ud_1                 9.469612e-02 1 1  ON 11
 ud_2                -1.447696e-02 1 1  ON 12
 ud_3                -7.511501e-02 1 1  ON 13
 ud_4                -1.229101e-01 1 1  ON 14
 ud_5                -1.545767e-01 1 1  ON 15
 ud_6                -1.558675e-01 1 1  ON 16
 ud_7                -1.113219e-01 1 1  ON 17
 ud_8                -1.968787e-03 1 1  ON 18
 ud_9                 9.251756e-02 1 1  ON 19
 eO_0                -7.744565e-01 1 1  ON 20
 eO_1                -4.544779e-01 1 1  ON 21
 eO_2                -4.623718e-02 1 1  ON 22
 eO_3                 2.100599e-01 1 1  ON 23
 eO_4                 3.069822e-01 1 1  ON 24
 eO_5                 3.209876e-01 1 1  ON 25
 eO_6                 2.579735e-01 1 1  ON 26
 eO_7                 1.200951e-01 1 1  ON 27
 eO_8                 2.925966e-02 1 1  ON 28
 eO_9                 1.882118e-02 1 1  ON 29
eH1_0                -1.832344e-01 1 1  ON 30
eH1_1                -1.039811e-01 1 1  ON 31
eH1_2                -6.285057e-02 1 1  ON 32
eH1_3                -2.617957e-02 1 1  ON 33
eH1_4                 1.847096e-02 1 1  ON 34
eH1_5                 3.359503e-02 1 1  ON 35
eH1_6                 7.840135e-02 1 1  ON 36
eH1_7                 1.091934e-01 1 1  ON 37
eH1_8                 9.502868e-02 1 1  ON 38
eH1_9                 2.575206e-02 1 1  ON 39
eH2_0                -1.849348e-01 1 1  ON 40
eH2_1                -1.057111e-01 1 1  ON 41
eH2_2                -6.395837e-02 1 1  ON 42
eH2_3                -2.706640e-02 1 1  ON 43
eH2_4                 1.850661e-02 1 1  ON 44
eH2_5                 3.247933e-02 1 1  ON 45
eH2_6                 7.833967e-02 1 1  ON 46
eH2_7                 1.132530e-01 1 1  ON 47
eH2_8                 9.865214e-02 1 1  ON 48
eH2_9                 2.782736e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1913
    reference variance = 0.345342
====================================================
  Execution time = 1.9840e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2330e-01
  Total weights = 2.0000e+06
  Execution time = 1.8365e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322852033070
                                         uncertainty =       0.004339459400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322852033070
                                         uncertainty =       0.004339459400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401796957
  error estimate for blocks of size 2^( 2) =       0.000411467191
  error estimate for blocks of size 2^( 3) =       0.000420051949
  error estimate for blocks of size 2^( 4) =       0.000426714588
  error estimate for blocks of size 2^( 5) =       0.000430799749
  error estimate for blocks of size 2^( 6) =       0.000432691153
  error estimate for blocks of size 2^( 7) =       0.000434977128

      target function =                  N/A
              le_mean =     -17.216698167521
             les_mean =     296.737577219147
             stat err =       0.000431295655
             autocorr =       1.152223898457
              std dev =       0.568226705692
             le_variance =       0.322881589062

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323782864836
                                         uncertainty =       0.004344630084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323782864836
                                         uncertainty =       0.004344630084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402376028
  error estimate for blocks of size 2^( 2) =       0.000412020162
  error estimate for blocks of size 2^( 3) =       0.000420565582
  error estimate for blocks of size 2^( 4) =       0.000427198502
  error estimate for blocks of size 2^( 5) =       0.000431260418
  error estimate for blocks of size 2^( 6) =       0.000433128675
  error estimate for blocks of size 2^( 7) =       0.000435407863

      target function =                  N/A
              le_mean =     -17.216701728057
             les_mean =     296.738631166719
             stat err =       0.000431748864
             autocorr =       1.151325727618
              std dev =       0.569045635905
             le_variance =       0.323812935743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323693725362
                                         uncertainty =       0.004341218312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323693725362
                                         uncertainty =       0.004341218312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402320642
  error estimate for blocks of size 2^( 2) =       0.000411967905
  error estimate for blocks of size 2^( 3) =       0.000420522369
  error estimate for blocks of size 2^( 4) =       0.000427164299
  error estimate for blocks of size 2^( 5) =       0.000431234379
  error estimate for blocks of size 2^( 6) =       0.000433105431
  error estimate for blocks of size 2^( 7) =       0.000435396194

      target function =                  N/A
              le_mean =     -17.216701630206
             les_mean =     296.738538658926
             stat err =       0.000431725076
             autocorr =       1.151515846169
              std dev =       0.568967307703
             le_variance =       0.323723797235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323013004701
                                         uncertainty =       0.004339349916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323013004701
                                         uncertainty =       0.004339349916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401897161
  error estimate for blocks of size 2^( 2) =       0.000411562342
  error estimate for blocks of size 2^( 3) =       0.000420141762
  error estimate for blocks of size 2^( 4) =       0.000426800674
  error estimate for blocks of size 2^( 5) =       0.000430883745
  error estimate for blocks of size 2^( 6) =       0.000432771701
  error estimate for blocks of size 2^( 7) =       0.000435060267

      target function =                  N/A
              le_mean =     -17.216698398598
             les_mean =     296.737746242554
             stat err =       0.000431379097
             autocorr =       1.152095066774
              std dev =       0.568368415545
             le_variance =       0.323042655789


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216698167521        initial
     2.4414e-02     2.4414e-01             1.0510e-02       -17.216701728057  <--
     9.7656e-02     9.7656e-01             3.3911e-03       -17.216701630206
     3.9062e-01     3.9062e+00             9.6415e-04       -17.216698398598

*****************************************************************************
Applying the update for shift_i =   2.4414e-02     and shift_s =   2.4414e-01
*****************************************************************************

  Execution time = 2.9102e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.136648e-01 1 1  ON 0
 uu_1                 5.107297e-02 1 1  ON 1
 uu_2                -4.385875e-02 1 1  ON 2
 uu_3                -9.939646e-02 1 1  ON 3
 uu_4                -1.334562e-01 1 1  ON 4
 uu_5                -1.413989e-01 1 1  ON 5
 uu_6                -1.183329e-01 1 1  ON 6
 uu_7                -4.827750e-02 1 1  ON 7
 uu_8                 9.396609e-02 1 1  ON 8
 uu_9                 1.264409e-01 1 1  ON 9
 ud_0                 3.540052e-01 1 1  ON 10
 ud_1                 9.537485e-02 1 1  ON 11
 ud_2                -1.406538e-02 1 1  ON 12
 ud_3                -7.508357e-02 1 1  ON 13
 ud_4                -1.233961e-01 1 1  ON 14
 ud_5                -1.554600e-01 1 1  ON 15
 ud_6                -1.570860e-01 1 1  ON 16
 ud_7                -1.115042e-01 1 1  ON 17
 ud_8                -3.879188e-03 1 1  ON 18
 ud_9                 9.308967e-02 1 1  ON 19
 eO_0                -7.815752e-01 1 1  ON 20
 eO_1                -4.607611e-01 1 1  ON 21
 eO_2                -5.077199e-02 1 1  ON 22
 eO_3                 2.085294e-01 1 1  ON 23
 eO_4                 3.099745e-01 1 1  ON 24
 eO_5                 3.277102e-01 1 1  ON 25
 eO_6                 2.621919e-01 1 1  ON 26
 eO_7                 1.242782e-01 1 1  ON 27
 eO_8                 3.017942e-02 1 1  ON 28
 eO_9                 1.904104e-02 1 1  ON 29
eH1_0                -1.836366e-01 1 1  ON 30
eH1_1                -1.044163e-01 1 1  ON 31
eH1_2                -6.311443e-02 1 1  ON 32
eH1_3                -2.633343e-02 1 1  ON 33
eH1_4                 1.799516e-02 1 1  ON 34
eH1_5                 3.234537e-02 1 1  ON 35
eH1_6                 7.819704e-02 1 1  ON 36
eH1_7                 1.089858e-01 1 1  ON 37
eH1_8                 9.725956e-02 1 1  ON 38
eH1_9                 2.660806e-02 1 1  ON 39
eH2_0                -1.855568e-01 1 1  ON 40
eH2_1                -1.061474e-01 1 1  ON 41
eH2_2                -6.413503e-02 1 1  ON 42
eH2_3                -2.714653e-02 1 1  ON 43
eH2_4                 1.827759e-02 1 1  ON 44
eH2_5                 3.095059e-02 1 1  ON 45
eH2_6                 7.727704e-02 1 1  ON 46
eH2_7                 1.139503e-01 1 1  ON 47
eH2_8                 1.011246e-01 1 1  ON 48
eH2_9                 2.855305e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5216e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7231e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.3169
    reference variance = 1.67032
====================================================
  Execution time = 2.0753e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4248e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5280e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342460229299
                                         uncertainty =       0.013916231524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342460229299
                                         uncertainty =       0.013916231524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413811587
  error estimate for blocks of size 2^( 2) =       0.000422789770
  error estimate for blocks of size 2^( 3) =       0.000431247204
  error estimate for blocks of size 2^( 4) =       0.000438227912
  error estimate for blocks of size 2^( 5) =       0.000442606659
  error estimate for blocks of size 2^( 6) =       0.000444703507
  error estimate for blocks of size 2^( 7) =       0.000446768211

      target function =                  N/A
              le_mean =     -17.216944006739
             les_mean =     296.765640818208
             stat err =       0.000443076572
             autocorr =       1.146442509256
              std dev =       0.585217957920
             le_variance =       0.342480058272


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721694400674e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-03, overlap shift 6.1035e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216944006739       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216944620248       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216946097640       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216942927726       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216943974661       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216945856866       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216947889581       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216954734700       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216963754757       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216965255632       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216962682481       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216960921063       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216964850765       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216966584615       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216965231301       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216965298546       residual = 9.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216964782695       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216965196777       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216964188826       residual = 7.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216965697712       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216966463034       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216966236879       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216966230273       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216966922038       residual = 1.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-03 is 1.989871e-02

solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216944006739       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216944566325       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216945857282       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216943196924       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216944056309       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216945804871       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216947147737       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216951556051       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216956472802       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216956179730       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216954217745       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216952725263       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216954165959       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216954164382       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216953699204       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216953589594       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 6.364383e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216944006739       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216944420765       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216945277922       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216943655300       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216944277852       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216945557608       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216945880390       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216947349299       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216948354365       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216947799114       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216947363619       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216947243691       residual = 2.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 1.954183e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162639 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6297e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.151195e-01 1 1  ON 0
 uu_1                 5.263915e-02 1 1  ON 1
 uu_2                -4.268480e-02 1 1  ON 2
 uu_3                -9.874113e-02 1 1  ON 3
 uu_4                -1.336047e-01 1 1  ON 4
 uu_5                -1.421894e-01 1 1  ON 5
 uu_6                -1.200578e-01 1 1  ON 6
 uu_7                -5.121652e-02 1 1  ON 7
 uu_8                 9.144266e-02 1 1  ON 8
 uu_9                 1.281554e-01 1 1  ON 9
 ud_0                 3.553319e-01 1 1  ON 10
 ud_1                 9.670114e-02 1 1  ON 11
 ud_2                -1.291963e-02 1 1  ON 12
 ud_3                -7.429906e-02 1 1  ON 13
 ud_4                -1.229226e-01 1 1  ON 14
 ud_5                -1.556707e-01 1 1  ON 15
 ud_6                -1.583848e-01 1 1  ON 16
 ud_7                -1.119557e-01 1 1  ON 17
 ud_8                -7.683594e-03 1 1  ON 18
 ud_9                 9.249487e-02 1 1  ON 19
 eO_0                -7.879396e-01 1 1  ON 20
 eO_1                -4.665936e-01 1 1  ON 21
 eO_2                -5.516238e-02 1 1  ON 22
 eO_3                 2.079644e-01 1 1  ON 23
 eO_4                 3.122291e-01 1 1  ON 24
 eO_5                 3.329323e-01 1 1  ON 25
 eO_6                 2.664362e-01 1 1  ON 26
 eO_7                 1.287727e-01 1 1  ON 27
 eO_8                 3.096892e-02 1 1  ON 28
 eO_9                 1.920692e-02 1 1  ON 29
eH1_0                -1.842066e-01 1 1  ON 30
eH1_1                -1.054652e-01 1 1  ON 31
eH1_2                -6.416023e-02 1 1  ON 32
eH1_3                -2.651970e-02 1 1  ON 33
eH1_4                 1.878922e-02 1 1  ON 34
eH1_5                 3.162150e-02 1 1  ON 35
eH1_6                 7.791508e-02 1 1  ON 36
eH1_7                 1.089673e-01 1 1  ON 37
eH1_8                 9.969168e-02 1 1  ON 38
eH1_9                 2.713115e-02 1 1  ON 39
eH2_0                -1.847374e-01 1 1  ON 40
eH2_1                -1.061910e-01 1 1  ON 41
eH2_2                -6.422591e-02 1 1  ON 42
eH2_3                -2.725823e-02 1 1  ON 43
eH2_4                 1.743578e-02 1 1  ON 44
eH2_5                 2.967472e-02 1 1  ON 45
eH2_6                 7.617727e-02 1 1  ON 46
eH2_7                 1.134884e-01 1 1  ON 47
eH2_8                 1.036385e-01 1 1  ON 48
eH2_9                 2.906346e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.0966
    reference variance = 0.266385
====================================================
  Execution time = 2.0889e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1257e-01
  Total weights = 2.0000e+06
  Execution time = 1.8210e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312119268695
                                         uncertainty =       0.002931360348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312119268695
                                         uncertainty =       0.002931360348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395061690
  error estimate for blocks of size 2^( 2) =       0.000404923962
  error estimate for blocks of size 2^( 3) =       0.000413030204
  error estimate for blocks of size 2^( 4) =       0.000419850232
  error estimate for blocks of size 2^( 5) =       0.000423287516
  error estimate for blocks of size 2^( 6) =       0.000424680821
  error estimate for blocks of size 2^( 7) =       0.000425851186

      target function =                  N/A
              le_mean =     -17.217071632291
             les_mean =     296.739702912699
             stat err =       0.000423417439
             autocorr =       1.148702716637
              std dev =       0.558701599550
             le_variance =       0.312147477340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312961635806
                                         uncertainty =       0.002938602167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312961635806
                                         uncertainty =       0.002938602167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395594625
  error estimate for blocks of size 2^( 2) =       0.000405421215
  error estimate for blocks of size 2^( 3) =       0.000413463874
  error estimate for blocks of size 2^( 4) =       0.000420228506
  error estimate for blocks of size 2^( 5) =       0.000423625120
  error estimate for blocks of size 2^( 6) =       0.000425037219
  error estimate for blocks of size 2^( 7) =       0.000426233954

      target function =                  N/A
              le_mean =     -17.217075415534
             les_mean =     296.740675922484
             stat err =       0.000423781200
             autocorr =       1.147579042136
              std dev =       0.559455283984
             le_variance =       0.312990214778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312991024379
                                         uncertainty =       0.002938560109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312991024379
                                         uncertainty =       0.002938560109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395613289
  error estimate for blocks of size 2^( 2) =       0.000405445818
  error estimate for blocks of size 2^( 3) =       0.000413497350
  error estimate for blocks of size 2^( 4) =       0.000420269644
  error estimate for blocks of size 2^( 5) =       0.000423669435
  error estimate for blocks of size 2^( 6) =       0.000425091040
  error estimate for blocks of size 2^( 7) =       0.000426305162

      target function =                  N/A
              le_mean =     -17.217077260805
             les_mean =     296.740768996844
             stat err =       0.000423833820
             autocorr =       1.147755742396
              std dev =       0.559481678718
             le_variance =       0.313019748821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312281170769
                                         uncertainty =       0.002932547093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312281170769
                                         uncertainty =       0.002932547093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395164195
  error estimate for blocks of size 2^( 2) =       0.000405019034
  error estimate for blocks of size 2^( 3) =       0.000413112910
  error estimate for blocks of size 2^( 4) =       0.000419922338
  error estimate for blocks of size 2^( 5) =       0.000423351910
  error estimate for blocks of size 2^( 6) =       0.000424754017
  error estimate for blocks of size 2^( 7) =       0.000425939450

      target function =                  N/A
              le_mean =     -17.217070201909
             les_mean =     296.739815663998
             stat err =       0.000423491929
             autocorr =       1.148510842717
              std dev =       0.558846564523
             le_variance =       0.312309482680


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217071632291        initial
     6.1035e-03     6.1035e-02             1.9899e-02       -17.217075415534
     2.4414e-02     2.4414e-01             6.3644e-03       -17.217077260805  <--
     9.7656e-02     9.7656e-01             1.9542e-03       -17.217070201909

*****************************************************************************
Applying the update for shift_i =   2.4414e-02     and shift_s =   2.4414e-01
*****************************************************************************

  Execution time = 3.0109e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.151195e-01 1 1  ON 0
 uu_1                 5.263915e-02 1 1  ON 1
 uu_2                -4.268480e-02 1 1  ON 2
 uu_3                -9.874113e-02 1 1  ON 3
 uu_4                -1.336047e-01 1 1  ON 4
 uu_5                -1.421894e-01 1 1  ON 5
 uu_6                -1.200578e-01 1 1  ON 6
 uu_7                -5.121652e-02 1 1  ON 7
 uu_8                 9.144266e-02 1 1  ON 8
 uu_9                 1.281554e-01 1 1  ON 9
 ud_0                 3.553319e-01 1 1  ON 10
 ud_1                 9.670114e-02 1 1  ON 11
 ud_2                -1.291963e-02 1 1  ON 12
 ud_3                -7.429906e-02 1 1  ON 13
 ud_4                -1.229226e-01 1 1  ON 14
 ud_5                -1.556707e-01 1 1  ON 15
 ud_6                -1.583848e-01 1 1  ON 16
 ud_7                -1.119557e-01 1 1  ON 17
 ud_8                -7.683594e-03 1 1  ON 18
 ud_9                 9.249487e-02 1 1  ON 19
 eO_0                -7.879396e-01 1 1  ON 20
 eO_1                -4.665936e-01 1 1  ON 21
 eO_2                -5.516238e-02 1 1  ON 22
 eO_3                 2.079644e-01 1 1  ON 23
 eO_4                 3.122291e-01 1 1  ON 24
 eO_5                 3.329323e-01 1 1  ON 25
 eO_6                 2.664362e-01 1 1  ON 26
 eO_7                 1.287727e-01 1 1  ON 27
 eO_8                 3.096892e-02 1 1  ON 28
 eO_9                 1.920692e-02 1 1  ON 29
eH1_0                -1.842066e-01 1 1  ON 30
eH1_1                -1.054652e-01 1 1  ON 31
eH1_2                -6.416023e-02 1 1  ON 32
eH1_3                -2.651970e-02 1 1  ON 33
eH1_4                 1.878922e-02 1 1  ON 34
eH1_5                 3.162150e-02 1 1  ON 35
eH1_6                 7.791508e-02 1 1  ON 36
eH1_7                 1.089673e-01 1 1  ON 37
eH1_8                 9.969168e-02 1 1  ON 38
eH1_9                 2.713115e-02 1 1  ON 39
eH2_0                -1.847374e-01 1 1  ON 40
eH2_1                -1.061910e-01 1 1  ON 41
eH2_2                -6.422591e-02 1 1  ON 42
eH2_3                -2.725823e-02 1 1  ON 43
eH2_4                 1.743578e-02 1 1  ON 44
eH2_5                 2.967472e-02 1 1  ON 45
eH2_6                 7.617727e-02 1 1  ON 46
eH2_7                 1.134884e-01 1 1  ON 47
eH2_8                 1.036385e-01 1 1  ON 48
eH2_9                 2.906346e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7175e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7229e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1974
    reference variance = 0.241299
====================================================
  Execution time = 2.3137e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2505e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5387e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324992333248
                                         uncertainty =       0.005364481685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324992333248
                                         uncertainty =       0.005364481685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403141814
  error estimate for blocks of size 2^( 2) =       0.000412978903
  error estimate for blocks of size 2^( 3) =       0.000421475679
  error estimate for blocks of size 2^( 4) =       0.000427975700
  error estimate for blocks of size 2^( 5) =       0.000430875177
  error estimate for blocks of size 2^( 6) =       0.000432933226
  error estimate for blocks of size 2^( 7) =       0.000431213080

      target function =                  N/A
              le_mean =     -17.216891431271
             les_mean =     296.746397038277
             stat err =       0.000430749296
             autocorr =       1.141651260770
              std dev =       0.570128621122
             le_variance =       0.325046644623


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721689143127e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-03, overlap shift 6.1035e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216891431271       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216890011507       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216889801574       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216888378379       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216887170763       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216889207744       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216894056521       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216891046413       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216892474436       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216889627362       residual = 9.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216893895193       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216905245027       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216906906336       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216907487996       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216905101281       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216906526382       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216904809867       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216905741821       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216905293067       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216904772557       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216905347901       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216905224007       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-03 is 2.185861e-02

solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216891431271       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216890145886       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216889907411       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216888622826       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216887607423       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216889481626       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216893068791       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216890640416       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216891377822       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216889773620       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216891537643       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216894973914       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216895386885       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216894599740       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216894274073       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 5.600925e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216891431271       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216890498883       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216890214607       residual = 8.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216889303093       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216888709057       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216890102502       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216891588488       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216890331178       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216890540935       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216890165714       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216890474588       residual = 6.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 1.719809e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172500 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8689e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.164768e-01 1 1  ON 0
 uu_1                 5.345310e-02 1 1  ON 1
 uu_2                -4.214196e-02 1 1  ON 2
 uu_3                -9.851935e-02 1 1  ON 3
 uu_4                -1.338212e-01 1 1  ON 4
 uu_5                -1.430812e-01 1 1  ON 5
 uu_6                -1.220371e-01 1 1  ON 6
 uu_7                -5.320933e-02 1 1  ON 7
 uu_8                 8.881552e-02 1 1  ON 8
 uu_9                 1.303198e-01 1 1  ON 9
 ud_0                 3.559517e-01 1 1  ON 10
 ud_1                 9.703303e-02 1 1  ON 11
 ud_2                -1.265391e-02 1 1  ON 12
 ud_3                -7.428360e-02 1 1  ON 13
 ud_4                -1.228113e-01 1 1  ON 14
 ud_5                -1.562884e-01 1 1  ON 15
 ud_6                -1.599037e-01 1 1  ON 16
 ud_7                -1.126709e-01 1 1  ON 17
 ud_8                -9.100799e-03 1 1  ON 18
 ud_9                 9.334795e-02 1 1  ON 19
 eO_0                -7.935406e-01 1 1  ON 20
 eO_1                -4.710203e-01 1 1  ON 21
 eO_2                -5.869671e-02 1 1  ON 22
 eO_3                 2.055651e-01 1 1  ON 23
 eO_4                 3.126876e-01 1 1  ON 24
 eO_5                 3.372330e-01 1 1  ON 25
 eO_6                 2.710238e-01 1 1  ON 26
 eO_7                 1.337911e-01 1 1  ON 27
 eO_8                 3.197608e-02 1 1  ON 28
 eO_9                 1.964436e-02 1 1  ON 29
eH1_0                -1.846312e-01 1 1  ON 30
eH1_1                -1.058407e-01 1 1  ON 31
eH1_2                -6.439171e-02 1 1  ON 32
eH1_3                -2.696799e-02 1 1  ON 33
eH1_4                 1.878052e-02 1 1  ON 34
eH1_5                 3.113242e-02 1 1  ON 35
eH1_6                 7.552782e-02 1 1  ON 36
eH1_7                 1.085420e-01 1 1  ON 37
eH1_8                 1.029793e-01 1 1  ON 38
eH1_9                 2.842320e-02 1 1  ON 39
eH2_0                -1.864687e-01 1 1  ON 40
eH2_1                -1.070707e-01 1 1  ON 41
eH2_2                -6.580019e-02 1 1  ON 42
eH2_3                -2.877477e-02 1 1  ON 43
eH2_4                 1.746433e-02 1 1  ON 44
eH2_5                 2.991531e-02 1 1  ON 45
eH2_6                 7.753436e-02 1 1  ON 46
eH2_7                 1.133811e-01 1 1  ON 47
eH2_8                 1.062814e-01 1 1  ON 48
eH2_9                 3.001858e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1366
    reference variance = 0.276221
====================================================
  Execution time = 1.9550e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3623e-01
  Total weights = 2.0000e+06
  Execution time = 1.8134e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335434896705
                                         uncertainty =       0.014539055303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335434896705
                                         uncertainty =       0.014539055303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409522164
  error estimate for blocks of size 2^( 2) =       0.000419067790
  error estimate for blocks of size 2^( 3) =       0.000427747121
  error estimate for blocks of size 2^( 4) =       0.000434066556
  error estimate for blocks of size 2^( 5) =       0.000437595038
  error estimate for blocks of size 2^( 6) =       0.000439947727
  error estimate for blocks of size 2^( 7) =       0.000440148230

      target function =                  N/A
              le_mean =     -17.216897941280
             les_mean =     296.756991358699
             stat err =       0.000437939388
             autocorr =       1.143597482193
              std dev =       0.579151798707
             le_variance =       0.335416805946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336759009306
                                         uncertainty =       0.014825973540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336759009306
                                         uncertainty =       0.014825973540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410329670
  error estimate for blocks of size 2^( 2) =       0.000419848579
  error estimate for blocks of size 2^( 3) =       0.000428478240
  error estimate for blocks of size 2^( 4) =       0.000434751083
  error estimate for blocks of size 2^( 5) =       0.000438259646
  error estimate for blocks of size 2^( 6) =       0.000440623349
  error estimate for blocks of size 2^( 7) =       0.000440811351

      target function =                  N/A
              le_mean =     -17.216897061163
             les_mean =     296.758285123246
             stat err =       0.000438611357
             autocorr =       1.142599166870
              std dev =       0.580293785024
             le_variance =       0.336740876937

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337091947608
                                         uncertainty =       0.014873301905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337091947608
                                         uncertainty =       0.014873301905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410532524
  error estimate for blocks of size 2^( 2) =       0.000420054309
  error estimate for blocks of size 2^( 3) =       0.000428689210
  error estimate for blocks of size 2^( 4) =       0.000434970886
  error estimate for blocks of size 2^( 5) =       0.000438486889
  error estimate for blocks of size 2^( 6) =       0.000440861798
  error estimate for blocks of size 2^( 7) =       0.000441046652

      target function =                  N/A
              le_mean =     -17.216895025444
             les_mean =     296.758548054757
             stat err =       0.000438841556
             autocorr =       1.142668760286
              std dev =       0.580580662904
             le_variance =       0.337073906138

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335870916316
                                         uncertainty =       0.014626346951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335870916316
                                         uncertainty =       0.014626346951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409788281
  error estimate for blocks of size 2^( 2) =       0.000419327786
  error estimate for blocks of size 2^( 3) =       0.000427996116
  error estimate for blocks of size 2^( 4) =       0.000434307288
  error estimate for blocks of size 2^( 5) =       0.000437833301
  error estimate for blocks of size 2^( 6) =       0.000440193695
  error estimate for blocks of size 2^( 7) =       0.000440388776

      target function =                  N/A
              le_mean =     -17.216894208405
             les_mean =     296.757298886508
             stat err =       0.000438180765
             autocorr =       1.143371990252
              std dev =       0.579528145151
             le_variance =       0.335852871023


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216897941280        initial  <--
     6.1035e-03     6.1035e-02             2.1859e-02       -17.216897061163
     2.4414e-02     2.4414e-01             5.6009e-03       -17.216895025444
     9.7656e-02     9.7656e-01             1.7198e-03       -17.216894208405

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.6925
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.151195e-01 1 1  ON 0
 uu_1                 5.263915e-02 1 1  ON 1
 uu_2                -4.268480e-02 1 1  ON 2
 uu_3                -9.874113e-02 1 1  ON 3
 uu_4                -1.336047e-01 1 1  ON 4
 uu_5                -1.421894e-01 1 1  ON 5
 uu_6                -1.200578e-01 1 1  ON 6
 uu_7                -5.121652e-02 1 1  ON 7
 uu_8                 9.144266e-02 1 1  ON 8
 uu_9                 1.281554e-01 1 1  ON 9
 ud_0                 3.553319e-01 1 1  ON 10
 ud_1                 9.670114e-02 1 1  ON 11
 ud_2                -1.291963e-02 1 1  ON 12
 ud_3                -7.429906e-02 1 1  ON 13
 ud_4                -1.229226e-01 1 1  ON 14
 ud_5                -1.556707e-01 1 1  ON 15
 ud_6                -1.583848e-01 1 1  ON 16
 ud_7                -1.119557e-01 1 1  ON 17
 ud_8                -7.683594e-03 1 1  ON 18
 ud_9                 9.249487e-02 1 1  ON 19
 eO_0                -7.879396e-01 1 1  ON 20
 eO_1                -4.665936e-01 1 1  ON 21
 eO_2                -5.516238e-02 1 1  ON 22
 eO_3                 2.079644e-01 1 1  ON 23
 eO_4                 3.122291e-01 1 1  ON 24
 eO_5                 3.329323e-01 1 1  ON 25
 eO_6                 2.664362e-01 1 1  ON 26
 eO_7                 1.287727e-01 1 1  ON 27
 eO_8                 3.096892e-02 1 1  ON 28
 eO_9                 1.920692e-02 1 1  ON 29
eH1_0                -1.842066e-01 1 1  ON 30
eH1_1                -1.054652e-01 1 1  ON 31
eH1_2                -6.416023e-02 1 1  ON 32
eH1_3                -2.651970e-02 1 1  ON 33
eH1_4                 1.878922e-02 1 1  ON 34
eH1_5                 3.162150e-02 1 1  ON 35
eH1_6                 7.791508e-02 1 1  ON 36
eH1_7                 1.089673e-01 1 1  ON 37
eH1_8                 9.969168e-02 1 1  ON 38
eH1_9                 2.713115e-02 1 1  ON 39
eH2_0                -1.847374e-01 1 1  ON 40
eH2_1                -1.061910e-01 1 1  ON 41
eH2_2                -6.422591e-02 1 1  ON 42
eH2_3                -2.725823e-02 1 1  ON 43
eH2_4                 1.743578e-02 1 1  ON 44
eH2_5                 2.967472e-02 1 1  ON 45
eH2_6                 7.617727e-02 1 1  ON 46
eH2_7                 1.134884e-01 1 1  ON 47
eH2_8                 1.036385e-01 1 1  ON 48
eH2_9                 2.906346e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7395e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2127
    reference variance = 0.223417
====================================================
  Execution time = 2.0573e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2037e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6170e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320375028253
                                         uncertainty =       0.005043785440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320375028253
                                         uncertainty =       0.005043785440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400231638
  error estimate for blocks of size 2^( 2) =       0.000409617047
  error estimate for blocks of size 2^( 3) =       0.000418019603
  error estimate for blocks of size 2^( 4) =       0.000424596582
  error estimate for blocks of size 2^( 5) =       0.000428955843
  error estimate for blocks of size 2^( 6) =       0.000432474016
  error estimate for blocks of size 2^( 7) =       0.000434406261

      target function =                  N/A
              le_mean =     -17.217437359079
             les_mean =     296.760519782056
             stat err =       0.000430108176
             autocorr =       1.154868571235
              std dev =       0.566013010835
             le_variance =       0.320370728435


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721743735908e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217437359079       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217438503177       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217440801727       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217441357547       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217442509251       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217442009766       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217442593506       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217443727708       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217442646478       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217444041392       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217444239795       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217444116553       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 2.499126e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217437359079       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217438071965       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217439341051       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217440113178       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217440477724       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217439918548       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217440317323       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217440385267       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217440192156       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217440424135       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 7.126661e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217437359079       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217437643369       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217438123197       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217438629440       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217438702503       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217438434539       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217438558129       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217438533371       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.100384e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176280 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6197e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.150030e-01 1 1  ON 0
 uu_1                 5.268895e-02 1 1  ON 1
 uu_2                -4.255396e-02 1 1  ON 2
 uu_3                -9.863653e-02 1 1  ON 3
 uu_4                -1.334082e-01 1 1  ON 4
 uu_5                -1.423229e-01 1 1  ON 5
 uu_6                -1.205578e-01 1 1  ON 6
 uu_7                -5.140748e-02 1 1  ON 7
 uu_8                 9.131409e-02 1 1  ON 8
 uu_9                 1.283895e-01 1 1  ON 9
 ud_0                 3.554288e-01 1 1  ON 10
 ud_1                 9.677835e-02 1 1  ON 11
 ud_2                -1.286777e-02 1 1  ON 12
 ud_3                -7.427686e-02 1 1  ON 13
 ud_4                -1.229993e-01 1 1  ON 14
 ud_5                -1.557084e-01 1 1  ON 15
 ud_6                -1.585766e-01 1 1  ON 16
 ud_7                -1.120110e-01 1 1  ON 17
 ud_8                -7.923581e-03 1 1  ON 18
 ud_9                 9.251953e-02 1 1  ON 19
 eO_0                -7.886523e-01 1 1  ON 20
 eO_1                -4.670702e-01 1 1  ON 21
 eO_2                -5.543756e-02 1 1  ON 22
 eO_3                 2.074693e-01 1 1  ON 23
 eO_4                 3.124681e-01 1 1  ON 24
 eO_5                 3.333615e-01 1 1  ON 25
 eO_6                 2.670137e-01 1 1  ON 26
 eO_7                 1.293119e-01 1 1  ON 27
 eO_8                 3.105039e-02 1 1  ON 28
 eO_9                 1.924212e-02 1 1  ON 29
eH1_0                -1.845335e-01 1 1  ON 30
eH1_1                -1.057217e-01 1 1  ON 31
eH1_2                -6.413271e-02 1 1  ON 32
eH1_3                -2.674848e-02 1 1  ON 33
eH1_4                 1.895581e-02 1 1  ON 34
eH1_5                 3.167407e-02 1 1  ON 35
eH1_6                 7.782360e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.001113e-01 1 1  ON 38
eH1_9                 2.724381e-02 1 1  ON 39
eH2_0                -1.849117e-01 1 1  ON 40
eH2_1                -1.059933e-01 1 1  ON 41
eH2_2                -6.434943e-02 1 1  ON 42
eH2_3                -2.734652e-02 1 1  ON 43
eH2_4                 1.764122e-02 1 1  ON 44
eH2_5                 2.957358e-02 1 1  ON 45
eH2_6                 7.595647e-02 1 1  ON 46
eH2_7                 1.133977e-01 1 1  ON 47
eH2_8                 1.039112e-01 1 1  ON 48
eH2_9                 2.914190e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1875
    reference variance = 0.257443
====================================================
  Execution time = 1.9909e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2321e-01
  Total weights = 2.0000e+06
  Execution time = 1.8104e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323274450036
                                         uncertainty =       0.005080873118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323274450036
                                         uncertainty =       0.005080873118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402025279
  error estimate for blocks of size 2^( 2) =       0.000411876053
  error estimate for blocks of size 2^( 3) =       0.000420266809
  error estimate for blocks of size 2^( 4) =       0.000427088077
  error estimate for blocks of size 2^( 5) =       0.000430240039
  error estimate for blocks of size 2^( 6) =       0.000432952988
  error estimate for blocks of size 2^( 7) =       0.000437058429

      target function =                  N/A
              le_mean =     -17.216917956589
             les_mean =     296.745512412784
             stat err =       0.000431834883
             autocorr =       1.153795174718
              std dev =       0.568549602502
             le_variance =       0.323248650505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323321842516
                                         uncertainty =       0.005083464393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323321842516
                                         uncertainty =       0.005083464393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402054679
  error estimate for blocks of size 2^( 2) =       0.000411905476
  error estimate for blocks of size 2^( 3) =       0.000420291210
  error estimate for blocks of size 2^( 4) =       0.000427117206
  error estimate for blocks of size 2^( 5) =       0.000430263839
  error estimate for blocks of size 2^( 6) =       0.000432973111
  error estimate for blocks of size 2^( 7) =       0.000437071923

      target function =                  N/A
              le_mean =     -17.216917423006
             les_mean =     296.745541318214
             stat err =       0.000431856520
             autocorr =       1.153742047918
              std dev =       0.568591179378
             le_variance =       0.323295929267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323202059261
                                         uncertainty =       0.005081228601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323202059261
                                         uncertainty =       0.005081228601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401980154
  error estimate for blocks of size 2^( 2) =       0.000411835250
  error estimate for blocks of size 2^( 3) =       0.000420225960
  error estimate for blocks of size 2^( 4) =       0.000427056845
  error estimate for blocks of size 2^( 5) =       0.000430205195
  error estimate for blocks of size 2^( 6) =       0.000432912165
  error estimate for blocks of size 2^( 7) =       0.000437010196

      target function =                  N/A
              le_mean =     -17.216917668150
             les_mean =     296.745429918810
             stat err =       0.000431796100
             autocorr =       1.153846951881
              std dev =       0.568485785704
             le_variance =       0.323176088548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323260344850
                                         uncertainty =       0.005080955806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323260344850
                                         uncertainty =       0.005080955806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402016483
  error estimate for blocks of size 2^( 2) =       0.000411867933
  error estimate for blocks of size 2^( 3) =       0.000420258575
  error estimate for blocks of size 2^( 4) =       0.000427081816
  error estimate for blocks of size 2^( 5) =       0.000430232922
  error estimate for blocks of size 2^( 6) =       0.000432944293
  error estimate for blocks of size 2^( 7) =       0.000437048095

      target function =                  N/A
              le_mean =     -17.216917719130
             les_mean =     296.745490091604
             stat err =       0.000431826782
             autocorr =       1.153802369505
              std dev =       0.568537163190
             le_variance =       0.323234505928


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216917956589        initial  <--
     6.1035e-02     6.1035e-01             2.4991e-03       -17.216917423006
     2.4414e-01     2.4414e+00             7.1267e-04       -17.216917668150
     9.7656e-01     9.7656e+00             2.1004e-04       -17.216917719130

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0267
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.151195e-01 1 1  ON 0
 uu_1                 5.263915e-02 1 1  ON 1
 uu_2                -4.268480e-02 1 1  ON 2
 uu_3                -9.874113e-02 1 1  ON 3
 uu_4                -1.336047e-01 1 1  ON 4
 uu_5                -1.421894e-01 1 1  ON 5
 uu_6                -1.200578e-01 1 1  ON 6
 uu_7                -5.121652e-02 1 1  ON 7
 uu_8                 9.144266e-02 1 1  ON 8
 uu_9                 1.281554e-01 1 1  ON 9
 ud_0                 3.553319e-01 1 1  ON 10
 ud_1                 9.670114e-02 1 1  ON 11
 ud_2                -1.291963e-02 1 1  ON 12
 ud_3                -7.429906e-02 1 1  ON 13
 ud_4                -1.229226e-01 1 1  ON 14
 ud_5                -1.556707e-01 1 1  ON 15
 ud_6                -1.583848e-01 1 1  ON 16
 ud_7                -1.119557e-01 1 1  ON 17
 ud_8                -7.683594e-03 1 1  ON 18
 ud_9                 9.249487e-02 1 1  ON 19
 eO_0                -7.879396e-01 1 1  ON 20
 eO_1                -4.665936e-01 1 1  ON 21
 eO_2                -5.516238e-02 1 1  ON 22
 eO_3                 2.079644e-01 1 1  ON 23
 eO_4                 3.122291e-01 1 1  ON 24
 eO_5                 3.329323e-01 1 1  ON 25
 eO_6                 2.664362e-01 1 1  ON 26
 eO_7                 1.287727e-01 1 1  ON 27
 eO_8                 3.096892e-02 1 1  ON 28
 eO_9                 1.920692e-02 1 1  ON 29
eH1_0                -1.842066e-01 1 1  ON 30
eH1_1                -1.054652e-01 1 1  ON 31
eH1_2                -6.416023e-02 1 1  ON 32
eH1_3                -2.651970e-02 1 1  ON 33
eH1_4                 1.878922e-02 1 1  ON 34
eH1_5                 3.162150e-02 1 1  ON 35
eH1_6                 7.791508e-02 1 1  ON 36
eH1_7                 1.089673e-01 1 1  ON 37
eH1_8                 9.969168e-02 1 1  ON 38
eH1_9                 2.713115e-02 1 1  ON 39
eH2_0                -1.847374e-01 1 1  ON 40
eH2_1                -1.061910e-01 1 1  ON 41
eH2_2                -6.422591e-02 1 1  ON 42
eH2_3                -2.725823e-02 1 1  ON 43
eH2_4                 1.743578e-02 1 1  ON 44
eH2_5                 2.967472e-02 1 1  ON 45
eH2_6                 7.617727e-02 1 1  ON 46
eH2_7                 1.134884e-01 1 1  ON 47
eH2_8                 1.036385e-01 1 1  ON 48
eH2_9                 2.906346e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5323e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1995
    reference variance = 0.472896
====================================================
  Execution time = 2.0526e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1652e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6480e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316543900518
                                         uncertainty =       0.003205354227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316543900518
                                         uncertainty =       0.003205354227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397819819
  error estimate for blocks of size 2^( 2) =       0.000407562880
  error estimate for blocks of size 2^( 3) =       0.000416407214
  error estimate for blocks of size 2^( 4) =       0.000422407258
  error estimate for blocks of size 2^( 5) =       0.000426663407
  error estimate for blocks of size 2^( 6) =       0.000429733949
  error estimate for blocks of size 2^( 7) =       0.000431166449

      target function =                  N/A
              le_mean =     -17.216312697305
             les_mean =     296.717943950273
             stat err =       0.000427492766
             autocorr =       1.154741323471
              std dev =       0.562602183734
             le_variance =       0.316521217143


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721631269731e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216312697305       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216313270415       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216312754302       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216312591975       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216311917686       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216311997390       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216311906377       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216312001420       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 2.612489e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216312697305       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216312892218       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216312725203       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216312694387       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216312504766       residual = 9.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216312485608       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216312486141       residual = 9.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 7.505652e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216312697305       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216312750858       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216312705651       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216312699492       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216312651297       residual = 8.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216312643254       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216312643327       residual = 6.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.015438e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178626 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6180e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.151898e-01 1 1  ON 0
 uu_1                 5.265069e-02 1 1  ON 1
 uu_2                -4.270836e-02 1 1  ON 2
 uu_3                -9.872785e-02 1 1  ON 3
 uu_4                -1.336058e-01 1 1  ON 4
 uu_5                -1.421968e-01 1 1  ON 5
 uu_6                -1.200889e-01 1 1  ON 6
 uu_7                -5.125613e-02 1 1  ON 7
 uu_8                 9.140955e-02 1 1  ON 8
 uu_9                 1.281736e-01 1 1  ON 9
 ud_0                 3.553644e-01 1 1  ON 10
 ud_1                 9.673538e-02 1 1  ON 11
 ud_2                -1.292007e-02 1 1  ON 12
 ud_3                -7.431125e-02 1 1  ON 13
 ud_4                -1.229210e-01 1 1  ON 14
 ud_5                -1.556358e-01 1 1  ON 15
 ud_6                -1.583762e-01 1 1  ON 16
 ud_7                -1.120112e-01 1 1  ON 17
 ud_8                -7.735784e-03 1 1  ON 18
 ud_9                 9.248618e-02 1 1  ON 19
 eO_0                -7.879898e-01 1 1  ON 20
 eO_1                -4.666686e-01 1 1  ON 21
 eO_2                -5.514440e-02 1 1  ON 22
 eO_3                 2.079049e-01 1 1  ON 23
 eO_4                 3.122518e-01 1 1  ON 24
 eO_5                 3.329866e-01 1 1  ON 25
 eO_6                 2.664781e-01 1 1  ON 26
 eO_7                 1.288104e-01 1 1  ON 27
 eO_8                 3.097570e-02 1 1  ON 28
 eO_9                 1.920906e-02 1 1  ON 29
eH1_0                -1.842783e-01 1 1  ON 30
eH1_1                -1.054627e-01 1 1  ON 31
eH1_2                -6.414432e-02 1 1  ON 32
eH1_3                -2.654791e-02 1 1  ON 33
eH1_4                 1.882264e-02 1 1  ON 34
eH1_5                 3.165844e-02 1 1  ON 35
eH1_6                 7.789091e-02 1 1  ON 36
eH1_7                 1.089648e-01 1 1  ON 37
eH1_8                 9.971906e-02 1 1  ON 38
eH1_9                 2.713902e-02 1 1  ON 39
eH2_0                -1.847160e-01 1 1  ON 40
eH2_1                -1.061702e-01 1 1  ON 41
eH2_2                -6.424118e-02 1 1  ON 42
eH2_3                -2.725776e-02 1 1  ON 43
eH2_4                 1.744508e-02 1 1  ON 44
eH2_5                 2.965007e-02 1 1  ON 45
eH2_6                 7.613960e-02 1 1  ON 46
eH2_7                 1.134789e-01 1 1  ON 47
eH2_8                 1.036664e-01 1 1  ON 48
eH2_9                 2.907006e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2541
    reference variance = 0.326404
====================================================
  Execution time = 2.0582e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1472e-01
  Total weights = 2.0000e+06
  Execution time = 1.8112e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314670902114
                                         uncertainty =       0.002144443475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314670902114
                                         uncertainty =       0.002144443475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396664388
  error estimate for blocks of size 2^( 2) =       0.000406432757
  error estimate for blocks of size 2^( 3) =       0.000415558475
  error estimate for blocks of size 2^( 4) =       0.000422302886
  error estimate for blocks of size 2^( 5) =       0.000426860251
  error estimate for blocks of size 2^( 6) =       0.000429525871
  error estimate for blocks of size 2^( 7) =       0.000430548119

      target function =                  N/A
              le_mean =     -17.217603806594
             les_mean =     296.760565957647
             stat err =       0.000427309282
             autocorr =       1.160481518839
              std dev =       0.560968157872
             le_variance =       0.314685274146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314779625512
                                         uncertainty =       0.002145137298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314779625512
                                         uncertainty =       0.002145137298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396732948
  error estimate for blocks of size 2^( 2) =       0.000406498919
  error estimate for blocks of size 2^( 3) =       0.000415623075
  error estimate for blocks of size 2^( 4) =       0.000422364392
  error estimate for blocks of size 2^( 5) =       0.000426922581
  error estimate for blocks of size 2^( 6) =       0.000429584756
  error estimate for blocks of size 2^( 7) =       0.000430602662

      target function =                  N/A
              le_mean =     -17.217603536100
             les_mean =     296.760665433575
             stat err =       0.000427368598
             autocorr =       1.160402555375
              std dev =       0.561065116231
             le_variance =       0.314794064651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314738501077
                                         uncertainty =       0.002144914446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314738501077
                                         uncertainty =       0.002144914446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396707018
  error estimate for blocks of size 2^( 2) =       0.000406473981
  error estimate for blocks of size 2^( 3) =       0.000415598857
  error estimate for blocks of size 2^( 4) =       0.000422341122
  error estimate for blocks of size 2^( 5) =       0.000426899027
  error estimate for blocks of size 2^( 6) =       0.000429562346
  error estimate for blocks of size 2^( 7) =       0.000430581857

      target function =                  N/A
              le_mean =     -17.217603484129
             les_mean =     296.760622495607
             stat err =       0.000427346088
             autocorr =       1.160432005693
              std dev =       0.561028445158
             le_variance =       0.314752916277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314679759401
                                         uncertainty =       0.002144506727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314679759401
                                         uncertainty =       0.002144506727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396669974
  error estimate for blocks of size 2^( 2) =       0.000406438157
  error estimate for blocks of size 2^( 3) =       0.000415563764
  error estimate for blocks of size 2^( 4) =       0.000422307871
  error estimate for blocks of size 2^( 5) =       0.000426865314
  error estimate for blocks of size 2^( 6) =       0.000429530628
  error estimate for blocks of size 2^( 7) =       0.000430552504

      target function =                  N/A
              le_mean =     -17.217603754434
             les_mean =     296.760573024578
             stat err =       0.000427314079
             autocorr =       1.160474891527
              std dev =       0.560976057623
             le_variance =       0.314694137226


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217603806594        initial  <--
     6.1035e-01     6.1035e+00             2.6125e-04       -17.217603536100
     2.4414e+00     2.4414e+01             7.5057e-05       -17.217603484129
     9.7656e+00     9.7656e+01             2.0154e-05       -17.217603754434

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6974
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.151195e-01 1 1  ON 0
 uu_1                 5.263915e-02 1 1  ON 1
 uu_2                -4.268480e-02 1 1  ON 2
 uu_3                -9.874113e-02 1 1  ON 3
 uu_4                -1.336047e-01 1 1  ON 4
 uu_5                -1.421894e-01 1 1  ON 5
 uu_6                -1.200578e-01 1 1  ON 6
 uu_7                -5.121652e-02 1 1  ON 7
 uu_8                 9.144266e-02 1 1  ON 8
 uu_9                 1.281554e-01 1 1  ON 9
 ud_0                 3.553319e-01 1 1  ON 10
 ud_1                 9.670114e-02 1 1  ON 11
 ud_2                -1.291963e-02 1 1  ON 12
 ud_3                -7.429906e-02 1 1  ON 13
 ud_4                -1.229226e-01 1 1  ON 14
 ud_5                -1.556707e-01 1 1  ON 15
 ud_6                -1.583848e-01 1 1  ON 16
 ud_7                -1.119557e-01 1 1  ON 17
 ud_8                -7.683594e-03 1 1  ON 18
 ud_9                 9.249487e-02 1 1  ON 19
 eO_0                -7.879396e-01 1 1  ON 20
 eO_1                -4.665936e-01 1 1  ON 21
 eO_2                -5.516238e-02 1 1  ON 22
 eO_3                 2.079644e-01 1 1  ON 23
 eO_4                 3.122291e-01 1 1  ON 24
 eO_5                 3.329323e-01 1 1  ON 25
 eO_6                 2.664362e-01 1 1  ON 26
 eO_7                 1.287727e-01 1 1  ON 27
 eO_8                 3.096892e-02 1 1  ON 28
 eO_9                 1.920692e-02 1 1  ON 29
eH1_0                -1.842066e-01 1 1  ON 30
eH1_1                -1.054652e-01 1 1  ON 31
eH1_2                -6.416023e-02 1 1  ON 32
eH1_3                -2.651970e-02 1 1  ON 33
eH1_4                 1.878922e-02 1 1  ON 34
eH1_5                 3.162150e-02 1 1  ON 35
eH1_6                 7.791508e-02 1 1  ON 36
eH1_7                 1.089673e-01 1 1  ON 37
eH1_8                 9.969168e-02 1 1  ON 38
eH1_9                 2.713115e-02 1 1  ON 39
eH2_0                -1.847374e-01 1 1  ON 40
eH2_1                -1.061910e-01 1 1  ON 41
eH2_2                -6.422591e-02 1 1  ON 42
eH2_3                -2.725823e-02 1 1  ON 43
eH2_4                 1.743578e-02 1 1  ON 44
eH2_5                 2.967472e-02 1 1  ON 45
eH2_6                 7.617727e-02 1 1  ON 46
eH2_7                 1.134884e-01 1 1  ON 47
eH2_8                 1.036385e-01 1 1  ON 48
eH2_9                 2.906346e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6310e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2911
    reference variance = 0.321728
====================================================
  Execution time = 2.0096e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2593e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6158e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326008386822
                                         uncertainty =       0.008783305242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326008386822
                                         uncertainty =       0.008783305242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403686372
  error estimate for blocks of size 2^( 2) =       0.000413084133
  error estimate for blocks of size 2^( 3) =       0.000421768334
  error estimate for blocks of size 2^( 4) =       0.000427870852
  error estimate for blocks of size 2^( 5) =       0.000431063380
  error estimate for blocks of size 2^( 6) =       0.000432732147
  error estimate for blocks of size 2^( 7) =       0.000433264107

      target function =                  N/A
              le_mean =     -17.217432221647
             les_mean =     296.765897517492
             stat err =       0.000431232622
             autocorr =       1.141129774241
              std dev =       0.570898741839
             le_variance =       0.325925373433


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721743222165e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217432221647       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217432278655       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217432220237       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217432221146       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217432242558       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217432247591       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217432266625       residual = 6.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 3.457907e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217432221647       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217432236470       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217432221689       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217432221586       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217432226477       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217432227897       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217432233141       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 8.791834e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217432221647       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217432225391       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217432221684       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217432221637       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217432222824       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217432223190       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217432224526       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.206792e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180893 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5719e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.151259e-01 1 1  ON 0
 uu_1                 5.263801e-02 1 1  ON 1
 uu_2                -4.268754e-02 1 1  ON 2
 uu_3                -9.874102e-02 1 1  ON 3
 uu_4                -1.336073e-01 1 1  ON 4
 uu_5                -1.421896e-01 1 1  ON 5
 uu_6                -1.200603e-01 1 1  ON 6
 uu_7                -5.121841e-02 1 1  ON 7
 uu_8                 9.144083e-02 1 1  ON 8
 uu_9                 1.281579e-01 1 1  ON 9
 ud_0                 3.553317e-01 1 1  ON 10
 ud_1                 9.670293e-02 1 1  ON 11
 ud_2                -1.291672e-02 1 1  ON 12
 ud_3                -7.430052e-02 1 1  ON 13
 ud_4                -1.229237e-01 1 1  ON 14
 ud_5                -1.556689e-01 1 1  ON 15
 ud_6                -1.583862e-01 1 1  ON 16
 ud_7                -1.119586e-01 1 1  ON 17
 ud_8                -7.686923e-03 1 1  ON 18
 ud_9                 9.249537e-02 1 1  ON 19
 eO_0                -7.879484e-01 1 1  ON 20
 eO_1                -4.665969e-01 1 1  ON 21
 eO_2                -5.516235e-02 1 1  ON 22
 eO_3                 2.079586e-01 1 1  ON 23
 eO_4                 3.122289e-01 1 1  ON 24
 eO_5                 3.329389e-01 1 1  ON 25
 eO_6                 2.664412e-01 1 1  ON 26
 eO_7                 1.287773e-01 1 1  ON 27
 eO_8                 3.096977e-02 1 1  ON 28
 eO_9                 1.920740e-02 1 1  ON 29
eH1_0                -1.842089e-01 1 1  ON 30
eH1_1                -1.054688e-01 1 1  ON 31
eH1_2                -6.415758e-02 1 1  ON 32
eH1_3                -2.651904e-02 1 1  ON 33
eH1_4                 1.878907e-02 1 1  ON 34
eH1_5                 3.162121e-02 1 1  ON 35
eH1_6                 7.791338e-02 1 1  ON 36
eH1_7                 1.089679e-01 1 1  ON 37
eH1_8                 9.969467e-02 1 1  ON 38
eH1_9                 2.713211e-02 1 1  ON 39
eH2_0                -1.847388e-01 1 1  ON 40
eH2_1                -1.061924e-01 1 1  ON 41
eH2_2                -6.423360e-02 1 1  ON 42
eH2_3                -2.726040e-02 1 1  ON 43
eH2_4                 1.744006e-02 1 1  ON 44
eH2_5                 2.967961e-02 1 1  ON 45
eH2_6                 7.617665e-02 1 1  ON 46
eH2_7                 1.134878e-01 1 1  ON 47
eH2_8                 1.036414e-01 1 1  ON 48
eH2_9                 2.906442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.288
    reference variance = 0.289114
====================================================
  Execution time = 2.0341e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3014e-01
  Total weights = 2.0000e+06
  Execution time = 1.8072e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330221787989
                                         uncertainty =       0.008284636681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330221787989
                                         uncertainty =       0.008284636681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406290406
  error estimate for blocks of size 2^( 2) =       0.000416069023
  error estimate for blocks of size 2^( 3) =       0.000424769441
  error estimate for blocks of size 2^( 4) =       0.000430767425
  error estimate for blocks of size 2^( 5) =       0.000434040491
  error estimate for blocks of size 2^( 6) =       0.000435436498
  error estimate for blocks of size 2^( 7) =       0.000436930110

      target function =                  N/A
              le_mean =     -17.217111542176
             les_mean =     296.759073478018
             stat err =       0.000434293631
             autocorr =       1.142598861102
              std dev =       0.574581401872
             le_variance =       0.330143787377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330222870042
                                         uncertainty =       0.008284409060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330222870042
                                         uncertainty =       0.008284409060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406291063
  error estimate for blocks of size 2^( 2) =       0.000416069624
  error estimate for blocks of size 2^( 3) =       0.000424769958
  error estimate for blocks of size 2^( 4) =       0.000430767823
  error estimate for blocks of size 2^( 5) =       0.000434040654
  error estimate for blocks of size 2^( 6) =       0.000435437157
  error estimate for blocks of size 2^( 7) =       0.000436930515

      target function =                  N/A
              le_mean =     -17.217111676807
             les_mean =     296.759079182951
             stat err =       0.000434294037
             autocorr =       1.142597300505
              std dev =       0.574582332105
             le_variance =       0.330144856367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330222109197
                                         uncertainty =       0.008284514123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330222109197
                                         uncertainty =       0.008284514123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406290599
  error estimate for blocks of size 2^( 2) =       0.000416069194
  error estimate for blocks of size 2^( 3) =       0.000424769582
  error estimate for blocks of size 2^( 4) =       0.000430767509
  error estimate for blocks of size 2^( 5) =       0.000434040457
  error estimate for blocks of size 2^( 6) =       0.000435436725
  error estimate for blocks of size 2^( 7) =       0.000436930204

      target function =                  N/A
              le_mean =     -17.217111609676
             les_mean =     296.759076116805
             stat err =       0.000434293723
             autocorr =       1.142598260695
              std dev =       0.574581675507
             le_variance =       0.330144101829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330221820504
                                         uncertainty =       0.008284621063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330221820504
                                         uncertainty =       0.008284621063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406290425
  error estimate for blocks of size 2^( 2) =       0.000416069040
  error estimate for blocks of size 2^( 3) =       0.000424769455
  error estimate for blocks of size 2^( 4) =       0.000430767432
  error estimate for blocks of size 2^( 5) =       0.000434040482
  error estimate for blocks of size 2^( 6) =       0.000435436523
  error estimate for blocks of size 2^( 7) =       0.000436930117

      target function =                  N/A
              le_mean =     -17.217111550552
             les_mean =     296.759073798129
             stat err =       0.000434293638
             autocorr =       1.142598791891
              std dev =       0.574581429425
             le_variance =       0.330143819040


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217111542176        initial
     6.1035e+00     6.1035e+01             3.4579e-05       -17.217111676807  <--
     2.4414e+01     2.4414e+02             8.7918e-06       -17.217111609676
     9.7656e+01     9.7656e+02             2.2068e-06       -17.217111550552

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 2.9439e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.151444e-01 1 1  ON 0
 uu_1                 5.263462e-02 1 1  ON 1
 uu_2                -4.269520e-02 1 1  ON 2
 uu_3                -9.874075e-02 1 1  ON 3
 uu_4                -1.336149e-01 1 1  ON 4
 uu_5                -1.421902e-01 1 1  ON 5
 uu_6                -1.200678e-01 1 1  ON 6
 uu_7                -5.122401e-02 1 1  ON 7
 uu_8                 9.143541e-02 1 1  ON 8
 uu_9                 1.281653e-01 1 1  ON 9
 ud_0                 3.553313e-01 1 1  ON 10
 ud_1                 9.670855e-02 1 1  ON 11
 ud_2                -1.290890e-02 1 1  ON 12
 ud_3                -7.430454e-02 1 1  ON 13
 ud_4                -1.229272e-01 1 1  ON 14
 ud_5                -1.556637e-01 1 1  ON 15
 ud_6                -1.583904e-01 1 1  ON 16
 ud_7                -1.119670e-01 1 1  ON 17
 ud_8                -7.696759e-03 1 1  ON 18
 ud_9                 9.249685e-02 1 1  ON 19
 eO_0                -7.879742e-01 1 1  ON 20
 eO_1                -4.666069e-01 1 1  ON 21
 eO_2                -5.516219e-02 1 1  ON 22
 eO_3                 2.079414e-01 1 1  ON 23
 eO_4                 3.122284e-01 1 1  ON 24
 eO_5                 3.329583e-01 1 1  ON 25
 eO_6                 2.664559e-01 1 1  ON 26
 eO_7                 1.287909e-01 1 1  ON 27
 eO_8                 3.097228e-02 1 1  ON 28
 eO_9                 1.920881e-02 1 1  ON 29
eH1_0                -1.842160e-01 1 1  ON 30
eH1_1                -1.054792e-01 1 1  ON 31
eH1_2                -6.415012e-02 1 1  ON 32
eH1_3                -2.651721e-02 1 1  ON 33
eH1_4                 1.878909e-02 1 1  ON 34
eH1_5                 3.162024e-02 1 1  ON 35
eH1_6                 7.790827e-02 1 1  ON 36
eH1_7                 1.089696e-01 1 1  ON 37
eH1_8                 9.970350e-02 1 1  ON 38
eH1_9                 2.713493e-02 1 1  ON 39
eH2_0                -1.847431e-01 1 1  ON 40
eH2_1                -1.061971e-01 1 1  ON 41
eH2_2                -6.425584e-02 1 1  ON 42
eH2_3                -2.726709e-02 1 1  ON 43
eH2_4                 1.745283e-02 1 1  ON 44
eH2_5                 2.969438e-02 1 1  ON 45
eH2_6                 7.617489e-02 1 1  ON 46
eH2_7                 1.134862e-01 1 1  ON 47
eH2_8                 1.036500e-01 1 1  ON 48
eH2_9                 2.906726e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5320e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2382
    reference variance = 0.239991
====================================================
  Execution time = 2.0605e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2071e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5286e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320750051128
                                         uncertainty =       0.005294473729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320750051128
                                         uncertainty =       0.005294473729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400446322
  error estimate for blocks of size 2^( 2) =       0.000409520480
  error estimate for blocks of size 2^( 3) =       0.000417906630
  error estimate for blocks of size 2^( 4) =       0.000424045267
  error estimate for blocks of size 2^( 5) =       0.000428416384
  error estimate for blocks of size 2^( 6) =       0.000430236400
  error estimate for blocks of size 2^( 7) =       0.000430427524

      target function =                  N/A
              le_mean =     -17.215951531260
             les_mean =     296.709701480608
             stat err =       0.000428281394
             autocorr =       1.143851892619
              std dev =       0.566316620164
             le_variance =       0.320714514274


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721595153126e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215951531260       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215951295071       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215951199781       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215951314545       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215951371606       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215951348708       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215951320930       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215951399708       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.475241e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215951531260       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215951464692       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215951433666       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215951455683       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215951461104       residual = 9.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215951469084       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215951457988       residual = 7.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 3.786070e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215951531260       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215951514070       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215951505746       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215951510619       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215951510955       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215951514017       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215951511159       residual = 6.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 9.529940e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183357 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6141e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.151582e-01 1 1  ON 0
 uu_1                 5.263367e-02 1 1  ON 1
 uu_2                -4.270655e-02 1 1  ON 2
 uu_3                -9.874181e-02 1 1  ON 3
 uu_4                -1.336189e-01 1 1  ON 4
 uu_5                -1.421884e-01 1 1  ON 5
 uu_6                -1.200732e-01 1 1  ON 6
 uu_7                -5.122711e-02 1 1  ON 7
 uu_8                 9.142751e-02 1 1  ON 8
 uu_9                 1.281726e-01 1 1  ON 9
 ud_0                 3.553432e-01 1 1  ON 10
 ud_1                 9.672198e-02 1 1  ON 11
 ud_2                -1.291701e-02 1 1  ON 12
 ud_3                -7.429391e-02 1 1  ON 13
 ud_4                -1.229319e-01 1 1  ON 14
 ud_5                -1.556761e-01 1 1  ON 15
 ud_6                -1.583861e-01 1 1  ON 16
 ud_7                -1.119743e-01 1 1  ON 17
 ud_8                -7.711314e-03 1 1  ON 18
 ud_9                 9.249634e-02 1 1  ON 19
 eO_0                -7.880121e-01 1 1  ON 20
 eO_1                -4.666200e-01 1 1  ON 21
 eO_2                -5.516495e-02 1 1  ON 22
 eO_3                 2.079200e-01 1 1  ON 23
 eO_4                 3.122379e-01 1 1  ON 24
 eO_5                 3.329752e-01 1 1  ON 25
 eO_6                 2.664818e-01 1 1  ON 26
 eO_7                 1.288099e-01 1 1  ON 27
 eO_8                 3.097434e-02 1 1  ON 28
 eO_9                 1.920984e-02 1 1  ON 29
eH1_0                -1.842349e-01 1 1  ON 30
eH1_1                -1.054663e-01 1 1  ON 31
eH1_2                -6.413851e-02 1 1  ON 32
eH1_3                -2.654794e-02 1 1  ON 33
eH1_4                 1.879579e-02 1 1  ON 34
eH1_5                 3.161845e-02 1 1  ON 35
eH1_6                 7.790754e-02 1 1  ON 36
eH1_7                 1.089755e-01 1 1  ON 37
eH1_8                 9.971470e-02 1 1  ON 38
eH1_9                 2.713695e-02 1 1  ON 39
eH2_0                -1.847526e-01 1 1  ON 40
eH2_1                -1.061929e-01 1 1  ON 41
eH2_2                -6.425654e-02 1 1  ON 42
eH2_3                -2.727660e-02 1 1  ON 43
eH2_4                 1.744508e-02 1 1  ON 44
eH2_5                 2.970434e-02 1 1  ON 45
eH2_6                 7.617271e-02 1 1  ON 46
eH2_7                 1.134847e-01 1 1  ON 47
eH2_8                 1.036622e-01 1 1  ON 48
eH2_9                 2.907123e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2429
    reference variance = 0.233738
====================================================
  Execution time = 2.0702e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3753e-01
  Total weights = 2.0000e+06
  Execution time = 1.8143e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337492557043
                                         uncertainty =       0.016392196492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337492557043
                                         uncertainty =       0.016392196492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410798553
  error estimate for blocks of size 2^( 2) =       0.000420680443
  error estimate for blocks of size 2^( 3) =       0.000429546892
  error estimate for blocks of size 2^( 4) =       0.000435521993
  error estimate for blocks of size 2^( 5) =       0.000440345641
  error estimate for blocks of size 2^( 6) =       0.000443968693
  error estimate for blocks of size 2^( 7) =       0.000447255599

      target function =                  N/A
              le_mean =     -17.217404632387
             les_mean =     296.776533008656
             stat err =       0.000441772981
             autocorr =       1.156486299011
              std dev =       0.580956884860
             le_variance =       0.337510902066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337551070965
                                         uncertainty =       0.016396246676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337551070965
                                         uncertainty =       0.016396246676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410834185
  error estimate for blocks of size 2^( 2) =       0.000420714665
  error estimate for blocks of size 2^( 3) =       0.000429580208
  error estimate for blocks of size 2^( 4) =       0.000435553571
  error estimate for blocks of size 2^( 5) =       0.000440377363
  error estimate for blocks of size 2^( 6) =       0.000443999863
  error estimate for blocks of size 2^( 7) =       0.000447285488

      target function =                  N/A
              le_mean =     -17.217404650664
             les_mean =     296.776592190703
             stat err =       0.000441804071
             autocorr =       1.156448455975
              std dev =       0.581007276028
             le_variance =       0.337569454797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337527036861
                                         uncertainty =       0.016394618844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337527036861
                                         uncertainty =       0.016394618844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410819551
  error estimate for blocks of size 2^( 2) =       0.000420700506
  error estimate for blocks of size 2^( 3) =       0.000429566337
  error estimate for blocks of size 2^( 4) =       0.000435540411
  error estimate for blocks of size 2^( 5) =       0.000440364219
  error estimate for blocks of size 2^( 6) =       0.000443986717
  error estimate for blocks of size 2^( 7) =       0.000447272934

      target function =                  N/A
              le_mean =     -17.217404615585
             les_mean =     296.776566934632
             stat err =       0.000441791070
             autocorr =       1.156462779833
              std dev =       0.580986580417
             le_variance =       0.337545406625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337496984638
                                         uncertainty =       0.016392508673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337496984638
                                         uncertainty =       0.016392508673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410801249
  error estimate for blocks of size 2^( 2) =       0.000420683017
  error estimate for blocks of size 2^( 3) =       0.000429549385
  error estimate for blocks of size 2^( 4) =       0.000435524353
  error estimate for blocks of size 2^( 5) =       0.000440348025
  error estimate for blocks of size 2^( 6) =       0.000443971000
  error estimate for blocks of size 2^( 7) =       0.000447257820

      target function =                  N/A
              le_mean =     -17.217404628491
             les_mean =     296.776537305390
             stat err =       0.000441775299
             autocorr =       1.156483253747
              std dev =       0.580960698286
             le_variance =       0.337515332953


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217404632387        initial
     1.5259e+00     1.5259e+01             1.4752e-04       -17.217404650664  <--
     6.1035e+00     6.1035e+01             3.7861e-05       -17.217404615585
     2.4414e+01     2.4414e+02             9.5299e-06       -17.217404628491

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 2.9852e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.151957e-01 1 1  ON 0
 uu_1                 5.262998e-02 1 1  ON 1
 uu_2                -4.273117e-02 1 1  ON 2
 uu_3                -9.874894e-02 1 1  ON 3
 uu_4                -1.336288e-01 1 1  ON 4
 uu_5                -1.421860e-01 1 1  ON 5
 uu_6                -1.200905e-01 1 1  ON 6
 uu_7                -5.123676e-02 1 1  ON 7
 uu_8                 9.140260e-02 1 1  ON 8
 uu_9                 1.281958e-01 1 1  ON 9
 ud_0                 3.553782e-01 1 1  ON 10
 ud_1                 9.674990e-02 1 1  ON 11
 ud_2                -1.292393e-02 1 1  ON 12
 ud_3                -7.427314e-02 1 1  ON 13
 ud_4                -1.229394e-01 1 1  ON 14
 ud_5                -1.557100e-01 1 1  ON 15
 ud_6                -1.583744e-01 1 1  ON 16
 ud_7                -1.119976e-01 1 1  ON 17
 ud_8                -7.757189e-03 1 1  ON 18
 ud_9                 9.249478e-02 1 1  ON 19
 eO_0                -7.881217e-01 1 1  ON 20
 eO_1                -4.666680e-01 1 1  ON 21
 eO_2                -5.518605e-02 1 1  ON 22
 eO_3                 2.078628e-01 1 1  ON 23
 eO_4                 3.122669e-01 1 1  ON 24
 eO_5                 3.330278e-01 1 1  ON 25
 eO_6                 2.665639e-01 1 1  ON 26
 eO_7                 1.288703e-01 1 1  ON 27
 eO_8                 3.098089e-02 1 1  ON 28
 eO_9                 1.921311e-02 1 1  ON 29
eH1_0                -1.842871e-01 1 1  ON 30
eH1_1                -1.054318e-01 1 1  ON 31
eH1_2                -6.411240e-02 1 1  ON 32
eH1_3                -2.662941e-02 1 1  ON 33
eH1_4                 1.880848e-02 1 1  ON 34
eH1_5                 3.161428e-02 1 1  ON 35
eH1_6                 7.790565e-02 1 1  ON 36
eH1_7                 1.089944e-01 1 1  ON 37
eH1_8                 9.975021e-02 1 1  ON 38
eH1_9                 2.714339e-02 1 1  ON 39
eH2_0                -1.847811e-01 1 1  ON 40
eH2_1                -1.061865e-01 1 1  ON 41
eH2_2                -6.425972e-02 1 1  ON 42
eH2_3                -2.730224e-02 1 1  ON 43
eH2_4                 1.742475e-02 1 1  ON 44
eH2_5                 2.973404e-02 1 1  ON 45
eH2_6                 7.616497e-02 1 1  ON 46
eH2_7                 1.134801e-01 1 1  ON 47
eH2_8                 1.037009e-01 1 1  ON 48
eH2_9                 2.908381e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6491e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1879
    reference variance = 0.321296
====================================================
  Execution time = 2.0430e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1978e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5917e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319802620475
                                         uncertainty =       0.004454255992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319802620475
                                         uncertainty =       0.004454255992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399859890
  error estimate for blocks of size 2^( 2) =       0.000409775503
  error estimate for blocks of size 2^( 3) =       0.000418362138
  error estimate for blocks of size 2^( 4) =       0.000424463725
  error estimate for blocks of size 2^( 5) =       0.000428125515
  error estimate for blocks of size 2^( 6) =       0.000432091369
  error estimate for blocks of size 2^( 7) =       0.000433247943

      target function =                  N/A
              le_mean =     -17.216873824876
             les_mean =     296.740520004660
             stat err =       0.000429482138
             autocorr =       1.153651217662
              std dev =       0.565487279106
             le_variance =       0.319775862831


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721687382488e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216873824877       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216875086351       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216875982543       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216876565734       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216876949158       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216876812411       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216876611714       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216876641127       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216876764035       residual = 6.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 4.825834e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216873824877       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216874309722       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216874643550       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216874789003       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216874898022       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216874872582       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216874845509       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216874833989       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.281084e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216873824877       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216873964900       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216874062717       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216874098784       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216874121414       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216874114446       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216874111006       residual = 7.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 3.162397e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.186000 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6028e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.152034e-01 1 1  ON 0
 uu_1                 5.263533e-02 1 1  ON 1
 uu_2                -4.275301e-02 1 1  ON 2
 uu_3                -9.875010e-02 1 1  ON 3
 uu_4                -1.336255e-01 1 1  ON 4
 uu_5                -1.422259e-01 1 1  ON 5
 uu_6                -1.200452e-01 1 1  ON 6
 uu_7                -5.124281e-02 1 1  ON 7
 uu_8                 9.135366e-02 1 1  ON 8
 uu_9                 1.282204e-01 1 1  ON 9
 ud_0                 3.553804e-01 1 1  ON 10
 ud_1                 9.673732e-02 1 1  ON 11
 ud_2                -1.287475e-02 1 1  ON 12
 ud_3                -7.429170e-02 1 1  ON 13
 ud_4                -1.229728e-01 1 1  ON 14
 ud_5                -1.556991e-01 1 1  ON 15
 ud_6                -1.583505e-01 1 1  ON 16
 ud_7                -1.119842e-01 1 1  ON 17
 ud_8                -7.814292e-03 1 1  ON 18
 ud_9                 9.248637e-02 1 1  ON 19
 eO_0                -7.882498e-01 1 1  ON 20
 eO_1                -4.667747e-01 1 1  ON 21
 eO_2                -5.519378e-02 1 1  ON 22
 eO_3                 2.078125e-01 1 1  ON 23
 eO_4                 3.122762e-01 1 1  ON 24
 eO_5                 3.330940e-01 1 1  ON 25
 eO_6                 2.666709e-01 1 1  ON 26
 eO_7                 1.289649e-01 1 1  ON 27
 eO_8                 3.099165e-02 1 1  ON 28
 eO_9                 1.921497e-02 1 1  ON 29
eH1_0                -1.842307e-01 1 1  ON 30
eH1_1                -1.054192e-01 1 1  ON 31
eH1_2                -6.410754e-02 1 1  ON 32
eH1_3                -2.668794e-02 1 1  ON 33
eH1_4                 1.874869e-02 1 1  ON 34
eH1_5                 3.162444e-02 1 1  ON 35
eH1_6                 7.787717e-02 1 1  ON 36
eH1_7                 1.089828e-01 1 1  ON 37
eH1_8                 9.980365e-02 1 1  ON 38
eH1_9                 2.716029e-02 1 1  ON 39
eH2_0                -1.848041e-01 1 1  ON 40
eH2_1                -1.061581e-01 1 1  ON 41
eH2_2                -6.427693e-02 1 1  ON 42
eH2_3                -2.740399e-02 1 1  ON 43
eH2_4                 1.745147e-02 1 1  ON 44
eH2_5                 2.977029e-02 1 1  ON 45
eH2_6                 7.614970e-02 1 1  ON 46
eH2_7                 1.134853e-01 1 1  ON 47
eH2_8                 1.037471e-01 1 1  ON 48
eH2_9                 2.909568e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2433
    reference variance = 0.140307
====================================================
  Execution time = 2.2332e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2433e-01
  Total weights = 2.0000e+06
  Execution time = 1.8172e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324454116737
                                         uncertainty =       0.007537330520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324454116737
                                         uncertainty =       0.007537330520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402701326
  error estimate for blocks of size 2^( 2) =       0.000412800357
  error estimate for blocks of size 2^( 3) =       0.000421356775
  error estimate for blocks of size 2^( 4) =       0.000426775827
  error estimate for blocks of size 2^( 5) =       0.000430802442
  error estimate for blocks of size 2^( 6) =       0.000432598276
  error estimate for blocks of size 2^( 7) =       0.000433134106

      target function =                  N/A
              le_mean =     -17.216458948386
             les_mean =     296.730795274636
             stat err =       0.000430827663
             autocorr =       1.144566533392
              std dev =       0.569505676315
             le_variance =       0.324336715355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324450767036
                                         uncertainty =       0.007534152710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324450767036
                                         uncertainty =       0.007534152710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402699218
  error estimate for blocks of size 2^( 2) =       0.000412801574
  error estimate for blocks of size 2^( 3) =       0.000421359701
  error estimate for blocks of size 2^( 4) =       0.000426778848
  error estimate for blocks of size 2^( 5) =       0.000430805232
  error estimate for blocks of size 2^( 6) =       0.000432601481
  error estimate for blocks of size 2^( 7) =       0.000433131801

      target function =                  N/A
              le_mean =     -17.216459067921
             les_mean =     296.730795996228
             stat err =       0.000430829340
             autocorr =       1.144587425847
              std dev =       0.569502696228
             le_variance =       0.324333321011

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324437035333
                                         uncertainty =       0.007534243819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324437035333
                                         uncertainty =       0.007534243819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402690701
  error estimate for blocks of size 2^( 2) =       0.000412792789
  error estimate for blocks of size 2^( 3) =       0.000421351170
  error estimate for blocks of size 2^( 4) =       0.000426771562
  error estimate for blocks of size 2^( 5) =       0.000430798438
  error estimate for blocks of size 2^( 6) =       0.000432594507
  error estimate for blocks of size 2^( 7) =       0.000433125124

      target function =                  N/A
              le_mean =     -17.216459326173
             les_mean =     296.730791168407
             stat err =       0.000430822408
             autocorr =       1.144599009977
              std dev =       0.569490650327
             le_variance =       0.324319600810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324452266137
                                         uncertainty =       0.007536916000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324452266137
                                         uncertainty =       0.007536916000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402700173
  error estimate for blocks of size 2^( 2) =       0.000412799638
  error estimate for blocks of size 2^( 3) =       0.000421356342
  error estimate for blocks of size 2^( 4) =       0.000426775614
  error estimate for blocks of size 2^( 5) =       0.000430802263
  error estimate for blocks of size 2^( 6) =       0.000432598114
  error estimate for blocks of size 2^( 7) =       0.000433133132

      target function =                  N/A
              le_mean =     -17.216458982503
             les_mean =     296.730794593505
             stat err =       0.000430827281
             autocorr =       1.144571052695
              std dev =       0.569504046914
             le_variance =       0.324334859451


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216458948386        initial
     3.8147e-01     3.8147e+00             4.8258e-04       -17.216459067921
     1.5259e+00     1.5259e+01             1.2811e-04       -17.216459326173  <--
     6.1035e+00     6.1035e+01             3.1624e-05       -17.216458982503

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 3.1660e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.152034e-01 1 1  ON 0
 uu_1                 5.263533e-02 1 1  ON 1
 uu_2                -4.275301e-02 1 1  ON 2
 uu_3                -9.875010e-02 1 1  ON 3
 uu_4                -1.336255e-01 1 1  ON 4
 uu_5                -1.422259e-01 1 1  ON 5
 uu_6                -1.200452e-01 1 1  ON 6
 uu_7                -5.124281e-02 1 1  ON 7
 uu_8                 9.135366e-02 1 1  ON 8
 uu_9                 1.282204e-01 1 1  ON 9
 ud_0                 3.553804e-01 1 1  ON 10
 ud_1                 9.673732e-02 1 1  ON 11
 ud_2                -1.287475e-02 1 1  ON 12
 ud_3                -7.429170e-02 1 1  ON 13
 ud_4                -1.229728e-01 1 1  ON 14
 ud_5                -1.556991e-01 1 1  ON 15
 ud_6                -1.583505e-01 1 1  ON 16
 ud_7                -1.119842e-01 1 1  ON 17
 ud_8                -7.814292e-03 1 1  ON 18
 ud_9                 9.248637e-02 1 1  ON 19
 eO_0                -7.882498e-01 1 1  ON 20
 eO_1                -4.667747e-01 1 1  ON 21
 eO_2                -5.519378e-02 1 1  ON 22
 eO_3                 2.078125e-01 1 1  ON 23
 eO_4                 3.122762e-01 1 1  ON 24
 eO_5                 3.330940e-01 1 1  ON 25
 eO_6                 2.666709e-01 1 1  ON 26
 eO_7                 1.289649e-01 1 1  ON 27
 eO_8                 3.099165e-02 1 1  ON 28
 eO_9                 1.921497e-02 1 1  ON 29
eH1_0                -1.842307e-01 1 1  ON 30
eH1_1                -1.054192e-01 1 1  ON 31
eH1_2                -6.410754e-02 1 1  ON 32
eH1_3                -2.668794e-02 1 1  ON 33
eH1_4                 1.874869e-02 1 1  ON 34
eH1_5                 3.162444e-02 1 1  ON 35
eH1_6                 7.787717e-02 1 1  ON 36
eH1_7                 1.089828e-01 1 1  ON 37
eH1_8                 9.980365e-02 1 1  ON 38
eH1_9                 2.716029e-02 1 1  ON 39
eH2_0                -1.848041e-01 1 1  ON 40
eH2_1                -1.061581e-01 1 1  ON 41
eH2_2                -6.427693e-02 1 1  ON 42
eH2_3                -2.740399e-02 1 1  ON 43
eH2_4                 1.745147e-02 1 1  ON 44
eH2_5                 2.977029e-02 1 1  ON 45
eH2_6                 7.614970e-02 1 1  ON 46
eH2_7                 1.134853e-01 1 1  ON 47
eH2_8                 1.037471e-01 1 1  ON 48
eH2_9                 2.909568e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7879e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1883
    reference variance = 0.337403
====================================================
  Execution time = 2.0673e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1781e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5357e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317807167385
                                         uncertainty =       0.003068930457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317807167385
                                         uncertainty =       0.003068930457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398629655
  error estimate for blocks of size 2^( 2) =       0.000408192908
  error estimate for blocks of size 2^( 3) =       0.000416050186
  error estimate for blocks of size 2^( 4) =       0.000422336671
  error estimate for blocks of size 2^( 5) =       0.000426181365
  error estimate for blocks of size 2^( 6) =       0.000428546469
  error estimate for blocks of size 2^( 7) =       0.000431308663

      target function =                  N/A
              le_mean =     -17.216192424636
             les_mean =     296.715092647197
             stat err =       0.000427093292
             autocorr =       1.147905911603
              std dev =       0.563747464754
             le_variance =       0.317811204016


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721619242464e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216192424636       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216192583065       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216193762066       residual = 9.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216194750896       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216193602471       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216195160228       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216195108892       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216195024427       residual = 8.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 4.118718e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216192424636       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216192474911       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216192962759       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216193284388       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216192947747       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216193352356       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216193290293       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.223811e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216192424636       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216192438112       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216192581985       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216192671004       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216192595791       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216192687394       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216192671039       residual = 2.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 3.240448e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188388 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6215e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.152921e-01 1 1  ON 0
 uu_1                 5.267573e-02 1 1  ON 1
 uu_2                -4.273081e-02 1 1  ON 2
 uu_3                -9.876031e-02 1 1  ON 3
 uu_4                -1.336464e-01 1 1  ON 4
 uu_5                -1.422696e-01 1 1  ON 5
 uu_6                -1.200829e-01 1 1  ON 6
 uu_7                -5.126102e-02 1 1  ON 7
 uu_8                 9.129389e-02 1 1  ON 8
 uu_9                 1.282343e-01 1 1  ON 9
 ud_0                 3.553697e-01 1 1  ON 10
 ud_1                 9.673010e-02 1 1  ON 11
 ud_2                -1.286747e-02 1 1  ON 12
 ud_3                -7.430464e-02 1 1  ON 13
 ud_4                -1.229290e-01 1 1  ON 14
 ud_5                -1.556362e-01 1 1  ON 15
 ud_6                -1.583494e-01 1 1  ON 16
 ud_7                -1.120174e-01 1 1  ON 17
 ud_8                -7.867042e-03 1 1  ON 18
 ud_9                 9.247522e-02 1 1  ON 19
 eO_0                -7.883325e-01 1 1  ON 20
 eO_1                -4.668971e-01 1 1  ON 21
 eO_2                -5.519838e-02 1 1  ON 22
 eO_3                 2.077727e-01 1 1  ON 23
 eO_4                 3.122807e-01 1 1  ON 24
 eO_5                 3.331792e-01 1 1  ON 25
 eO_6                 2.667519e-01 1 1  ON 26
 eO_7                 1.290346e-01 1 1  ON 27
 eO_8                 3.099977e-02 1 1  ON 28
 eO_9                 1.921551e-02 1 1  ON 29
eH1_0                -1.842533e-01 1 1  ON 30
eH1_1                -1.055009e-01 1 1  ON 31
eH1_2                -6.408119e-02 1 1  ON 32
eH1_3                -2.664994e-02 1 1  ON 33
eH1_4                 1.871804e-02 1 1  ON 34
eH1_5                 3.164522e-02 1 1  ON 35
eH1_6                 7.786741e-02 1 1  ON 36
eH1_7                 1.089812e-01 1 1  ON 37
eH1_8                 9.985062e-02 1 1  ON 38
eH1_9                 2.717305e-02 1 1  ON 39
eH2_0                -1.848667e-01 1 1  ON 40
eH2_1                -1.061703e-01 1 1  ON 41
eH2_2                -6.432212e-02 1 1  ON 42
eH2_3                -2.735483e-02 1 1  ON 43
eH2_4                 1.746173e-02 1 1  ON 44
eH2_5                 2.984466e-02 1 1  ON 45
eH2_6                 7.614107e-02 1 1  ON 46
eH2_7                 1.134442e-01 1 1  ON 47
eH2_8                 1.037741e-01 1 1  ON 48
eH2_9                 2.910500e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2629
    reference variance = 0.301753
====================================================
  Execution time = 1.9890e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2258e-01
  Total weights = 2.0000e+06
  Execution time = 1.8231e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322674084953
                                         uncertainty =       0.004206211459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322674084953
                                         uncertainty =       0.004206211459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401605938
  error estimate for blocks of size 2^( 2) =       0.000411444345
  error estimate for blocks of size 2^( 3) =       0.000420292676
  error estimate for blocks of size 2^( 4) =       0.000427016119
  error estimate for blocks of size 2^( 5) =       0.000431167166
  error estimate for blocks of size 2^( 6) =       0.000433503461
  error estimate for blocks of size 2^( 7) =       0.000433463459

      target function =                  N/A
              le_mean =     -17.217059485724
             les_mean =     296.749711831832
             stat err =       0.000431287552
             autocorr =       1.153276907533
              std dev =       0.567956563629
             le_variance =       0.322574658169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322690664518
                                         uncertainty =       0.004206876351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322690664518
                                         uncertainty =       0.004206876351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401616252
  error estimate for blocks of size 2^( 2) =       0.000411454732
  error estimate for blocks of size 2^( 3) =       0.000420303559
  error estimate for blocks of size 2^( 4) =       0.000427028675
  error estimate for blocks of size 2^( 5) =       0.000431182939
  error estimate for blocks of size 2^( 6) =       0.000433522645
  error estimate for blocks of size 2^( 7) =       0.000433487634

      target function =                  N/A
              le_mean =     -17.217059799126
             les_mean =     296.749739192868
             stat err =       0.000431305473
             autocorr =       1.153313513840
              std dev =       0.567971150221
             le_variance =       0.322591227484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322679315621
                                         uncertainty =       0.004206639667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322679315621
                                         uncertainty =       0.004206639667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401609187
  error estimate for blocks of size 2^( 2) =       0.000411447917
  error estimate for blocks of size 2^( 3) =       0.000420296701
  error estimate for blocks of size 2^( 4) =       0.000427021271
  error estimate for blocks of size 2^( 5) =       0.000431174586
  error estimate for blocks of size 2^( 6) =       0.000433513417
  error estimate for blocks of size 2^( 7) =       0.000433477404

      target function =                  N/A
              le_mean =     -17.217059769319
             les_mean =     296.749726817894
             stat err =       0.000431296670
             autocorr =       1.153307005940
              std dev =       0.567961159646
             le_variance =       0.322579878867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322674766883
                                         uncertainty =       0.004206278020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322674766883
                                         uncertainty =       0.004206278020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401606361
  error estimate for blocks of size 2^( 2) =       0.000411444840
  error estimate for blocks of size 2^( 3) =       0.000420293249
  error estimate for blocks of size 2^( 4) =       0.000427016845
  error estimate for blocks of size 2^( 5) =       0.000431168232
  error estimate for blocks of size 2^( 6) =       0.000433504874
  error estimate for blocks of size 2^( 7) =       0.000433465475

      target function =                  N/A
              le_mean =     -17.217059502569
             les_mean =     296.749713092297
             stat err =       0.000431288857
             autocorr =       1.153281454313
              std dev =       0.567957162626
             le_variance =       0.322575338578


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217059485724        initial
     3.8147e-01     3.8147e+00             4.1187e-04       -17.217059799126  <--
     1.5259e+00     1.5259e+01             1.2238e-04       -17.217059769319
     6.1035e+00     6.1035e+01             3.2404e-05       -17.217059502569

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 2.9118e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.155073e-01 1 1  ON 0
 uu_1                 5.278368e-02 1 1  ON 1
 uu_2                -4.267160e-02 1 1  ON 2
 uu_3                -9.877002e-02 1 1  ON 3
 uu_4                -1.336777e-01 1 1  ON 4
 uu_5                -1.423915e-01 1 1  ON 5
 uu_6                -1.201908e-01 1 1  ON 6
 uu_7                -5.131269e-02 1 1  ON 7
 uu_8                 9.111921e-02 1 1  ON 8
 uu_9                 1.282753e-01 1 1  ON 9
 ud_0                 3.553514e-01 1 1  ON 10
 ud_1                 9.672888e-02 1 1  ON 11
 ud_2                -1.285188e-02 1 1  ON 12
 ud_3                -7.429969e-02 1 1  ON 13
 ud_4                -1.228599e-01 1 1  ON 14
 ud_5                -1.554852e-01 1 1  ON 15
 ud_6                -1.583306e-01 1 1  ON 16
 ud_7                -1.121084e-01 1 1  ON 17
 ud_8                -8.021357e-03 1 1  ON 18
 ud_9                 9.244237e-02 1 1  ON 19
 eO_0                -7.885959e-01 1 1  ON 20
 eO_1                -4.671866e-01 1 1  ON 21
 eO_2                -5.528416e-02 1 1  ON 22
 eO_3                 2.076723e-01 1 1  ON 23
 eO_4                 3.122929e-01 1 1  ON 24
 eO_5                 3.334335e-01 1 1  ON 25
 eO_6                 2.669922e-01 1 1  ON 26
 eO_7                 1.292398e-01 1 1  ON 27
 eO_8                 3.102365e-02 1 1  ON 28
 eO_9                 1.921708e-02 1 1  ON 29
eH1_0                -1.843336e-01 1 1  ON 30
eH1_1                -1.056458e-01 1 1  ON 31
eH1_2                -6.405175e-02 1 1  ON 32
eH1_3                -2.657686e-02 1 1  ON 33
eH1_4                 1.865018e-02 1 1  ON 34
eH1_5                 3.169107e-02 1 1  ON 35
eH1_6                 7.783599e-02 1 1  ON 36
eH1_7                 1.089774e-01 1 1  ON 37
eH1_8                 9.998880e-02 1 1  ON 38
eH1_9                 2.721058e-02 1 1  ON 39
eH2_0                -1.850424e-01 1 1  ON 40
eH2_1                -1.062022e-01 1 1  ON 41
eH2_2                -6.441956e-02 1 1  ON 42
eH2_3                -2.727632e-02 1 1  ON 43
eH2_4                 1.749974e-02 1 1  ON 44
eH2_5                 3.006717e-02 1 1  ON 45
eH2_6                 7.612039e-02 1 1  ON 46
eH2_7                 1.133252e-01 1 1  ON 47
eH2_8                 1.038536e-01 1 1  ON 48
eH2_9                 2.913240e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5394e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1565
    reference variance = 0.275254
====================================================
  Execution time = 2.0527e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2606e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5155e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326083074496
                                         uncertainty =       0.006380869014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326083074496
                                         uncertainty =       0.006380869014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403770290
  error estimate for blocks of size 2^( 2) =       0.000413489336
  error estimate for blocks of size 2^( 3) =       0.000422462820
  error estimate for blocks of size 2^( 4) =       0.000429586578
  error estimate for blocks of size 2^( 5) =       0.000433081456
  error estimate for blocks of size 2^( 6) =       0.000436298919
  error estimate for blocks of size 2^( 7) =       0.000437502033

      target function =                  N/A
              le_mean =     -17.216436017677
             les_mean =     296.731729881687
             stat err =       0.000434117247
             autocorr =       1.155966798512
              std dev =       0.571017420022
             le_variance =       0.326060893968


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721643601768e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216436017677       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216438098626       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216440376246       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216439950537       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216439072149       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216439567085       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216440080399       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216439816943       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216440840266       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216440904964       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216440848302       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 1.890979e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216436017677       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216437036824       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216438126236       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216438161864       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216437686089       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216438130202       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216438210369       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216438012632       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216438153515       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 5.425240e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216436017677       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216436352812       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216436727149       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216436799308       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216436668874       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216436862431       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216436807884       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.377454e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191733 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6049e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.157630e-01 1 1  ON 0
 uu_1                 5.265320e-02 1 1  ON 1
 uu_2                -4.277996e-02 1 1  ON 2
 uu_3                -9.886932e-02 1 1  ON 3
 uu_4                -1.337473e-01 1 1  ON 4
 uu_5                -1.423584e-01 1 1  ON 5
 uu_6                -1.201552e-01 1 1  ON 6
 uu_7                -5.138157e-02 1 1  ON 7
 uu_8                 9.095677e-02 1 1  ON 8
 uu_9                 1.283950e-01 1 1  ON 9
 ud_0                 3.554835e-01 1 1  ON 10
 ud_1                 9.682138e-02 1 1  ON 11
 ud_2                -1.288058e-02 1 1  ON 12
 ud_3                -7.435467e-02 1 1  ON 13
 ud_4                -1.230607e-01 1 1  ON 14
 ud_5                -1.555988e-01 1 1  ON 15
 ud_6                -1.583410e-01 1 1  ON 16
 ud_7                -1.120188e-01 1 1  ON 17
 ud_8                -8.143943e-03 1 1  ON 18
 ud_9                 9.246569e-02 1 1  ON 19
 eO_0                -7.891384e-01 1 1  ON 20
 eO_1                -4.675678e-01 1 1  ON 21
 eO_2                -5.548112e-02 1 1  ON 22
 eO_3                 2.075443e-01 1 1  ON 23
 eO_4                 3.123196e-01 1 1  ON 24
 eO_5                 3.336650e-01 1 1  ON 25
 eO_6                 2.674545e-01 1 1  ON 26
 eO_7                 1.296600e-01 1 1  ON 27
 eO_8                 3.109350e-02 1 1  ON 28
 eO_9                 1.923624e-02 1 1  ON 29
eH1_0                -1.843522e-01 1 1  ON 30
eH1_1                -1.056729e-01 1 1  ON 31
eH1_2                -6.407404e-02 1 1  ON 32
eH1_3                -2.664938e-02 1 1  ON 33
eH1_4                 1.869961e-02 1 1  ON 34
eH1_5                 3.152448e-02 1 1  ON 35
eH1_6                 7.776341e-02 1 1  ON 36
eH1_7                 1.090354e-01 1 1  ON 37
eH1_8                 1.001906e-01 1 1  ON 38
eH1_9                 2.727015e-02 1 1  ON 39
eH2_0                -1.851051e-01 1 1  ON 40
eH2_1                -1.062782e-01 1 1  ON 41
eH2_2                -6.450262e-02 1 1  ON 42
eH2_3                -2.736708e-02 1 1  ON 43
eH2_4                 1.765487e-02 1 1  ON 44
eH2_5                 3.023452e-02 1 1  ON 45
eH2_6                 7.593626e-02 1 1  ON 46
eH2_7                 1.132209e-01 1 1  ON 47
eH2_8                 1.040369e-01 1 1  ON 48
eH2_9                 2.919774e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1858
    reference variance = 0.180055
====================================================
  Execution time = 2.0379e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1936e-01
  Total weights = 2.0000e+06
  Execution time = 1.8154e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319153444078
                                         uncertainty =       0.004405713836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319153444078
                                         uncertainty =       0.004405713836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399480854
  error estimate for blocks of size 2^( 2) =       0.000408893557
  error estimate for blocks of size 2^( 3) =       0.000417545076
  error estimate for blocks of size 2^( 4) =       0.000424056389
  error estimate for blocks of size 2^( 5) =       0.000427366690
  error estimate for blocks of size 2^( 6) =       0.000429854421
  error estimate for blocks of size 2^( 7) =       0.000431181562

      target function =                  N/A
              le_mean =     -17.217637852177
             les_mean =     296.766222954294
             stat err =       0.000428114766
             autocorr =       1.148493323139
              std dev =       0.564951241396
             le_variance =       0.319169905154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319551863826
                                         uncertainty =       0.004409903557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319551863826
                                         uncertainty =       0.004409903557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399730285
  error estimate for blocks of size 2^( 2) =       0.000409135615
  error estimate for blocks of size 2^( 3) =       0.000417773447
  error estimate for blocks of size 2^( 4) =       0.000424274466
  error estimate for blocks of size 2^( 5) =       0.000427579173
  error estimate for blocks of size 2^( 6) =       0.000430067994
  error estimate for blocks of size 2^( 7) =       0.000431386035

      target function =                  N/A
              le_mean =     -17.217637881994
             les_mean =     296.766622677693
             stat err =       0.000428326917
             autocorr =       1.148197579461
              std dev =       0.565303990782
             le_variance =       0.319568601994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319538614831
                                         uncertainty =       0.004408903196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319538614831
                                         uncertainty =       0.004408903196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399722037
  error estimate for blocks of size 2^( 2) =       0.000409128342
  error estimate for blocks of size 2^( 3) =       0.000417767476
  error estimate for blocks of size 2^( 4) =       0.000424270734
  error estimate for blocks of size 2^( 5) =       0.000427577884
  error estimate for blocks of size 2^( 6) =       0.000430068783
  error estimate for blocks of size 2^( 7) =       0.000431384706

      target function =                  N/A
              le_mean =     -17.217637894061
             les_mean =     296.766609905265
             stat err =       0.000428325527
             autocorr =       1.148237512440
              std dev =       0.565292326183
             le_variance =       0.319555414042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319216253607
                                         uncertainty =       0.004406156684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319216253607
                                         uncertainty =       0.004406156684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399520201
  error estimate for blocks of size 2^( 2) =       0.000408931917
  error estimate for blocks of size 2^( 3) =       0.000417581336
  error estimate for blocks of size 2^( 4) =       0.000424091377
  error estimate for blocks of size 2^( 5) =       0.000427401377
  error estimate for blocks of size 2^( 6) =       0.000429889896
  error estimate for blocks of size 2^( 7) =       0.000431214781

      target function =                  N/A
              le_mean =     -17.217637749435
             les_mean =     296.766282292751
             stat err =       0.000428149358
             autocorr =       1.148452684014
              std dev =       0.565006886325
             le_variance =       0.319232781595


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217637852177        initial
     9.5367e-02     9.5367e-01             1.8910e-03       -17.217637881994
     3.8147e-01     3.8147e+00             5.4252e-04       -17.217637894061  <--
     1.5259e+00     1.5259e+01             1.3775e-04       -17.217637749435

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 2.9541e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.157630e-01 1 1  ON 0
 uu_1                 5.265320e-02 1 1  ON 1
 uu_2                -4.277996e-02 1 1  ON 2
 uu_3                -9.886932e-02 1 1  ON 3
 uu_4                -1.337473e-01 1 1  ON 4
 uu_5                -1.423584e-01 1 1  ON 5
 uu_6                -1.201552e-01 1 1  ON 6
 uu_7                -5.138157e-02 1 1  ON 7
 uu_8                 9.095677e-02 1 1  ON 8
 uu_9                 1.283950e-01 1 1  ON 9
 ud_0                 3.554835e-01 1 1  ON 10
 ud_1                 9.682138e-02 1 1  ON 11
 ud_2                -1.288058e-02 1 1  ON 12
 ud_3                -7.435467e-02 1 1  ON 13
 ud_4                -1.230607e-01 1 1  ON 14
 ud_5                -1.555988e-01 1 1  ON 15
 ud_6                -1.583410e-01 1 1  ON 16
 ud_7                -1.120188e-01 1 1  ON 17
 ud_8                -8.143943e-03 1 1  ON 18
 ud_9                 9.246569e-02 1 1  ON 19
 eO_0                -7.891384e-01 1 1  ON 20
 eO_1                -4.675678e-01 1 1  ON 21
 eO_2                -5.548112e-02 1 1  ON 22
 eO_3                 2.075443e-01 1 1  ON 23
 eO_4                 3.123196e-01 1 1  ON 24
 eO_5                 3.336650e-01 1 1  ON 25
 eO_6                 2.674545e-01 1 1  ON 26
 eO_7                 1.296600e-01 1 1  ON 27
 eO_8                 3.109350e-02 1 1  ON 28
 eO_9                 1.923624e-02 1 1  ON 29
eH1_0                -1.843522e-01 1 1  ON 30
eH1_1                -1.056729e-01 1 1  ON 31
eH1_2                -6.407404e-02 1 1  ON 32
eH1_3                -2.664938e-02 1 1  ON 33
eH1_4                 1.869961e-02 1 1  ON 34
eH1_5                 3.152448e-02 1 1  ON 35
eH1_6                 7.776341e-02 1 1  ON 36
eH1_7                 1.090354e-01 1 1  ON 37
eH1_8                 1.001906e-01 1 1  ON 38
eH1_9                 2.727015e-02 1 1  ON 39
eH2_0                -1.851051e-01 1 1  ON 40
eH2_1                -1.062782e-01 1 1  ON 41
eH2_2                -6.450262e-02 1 1  ON 42
eH2_3                -2.736708e-02 1 1  ON 43
eH2_4                 1.765487e-02 1 1  ON 44
eH2_5                 3.023452e-02 1 1  ON 45
eH2_6                 7.593626e-02 1 1  ON 46
eH2_7                 1.132209e-01 1 1  ON 47
eH2_8                 1.040369e-01 1 1  ON 48
eH2_9                 2.919774e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5916e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2168
    reference variance = 0.178641
====================================================
  Execution time = 2.2192e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 5.0126e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4821e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501282220385
                                         uncertainty =       0.179208698663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501282220385
                                         uncertainty =       0.179208698663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500631191
  error estimate for blocks of size 2^( 2) =       0.000508488211
  error estimate for blocks of size 2^( 3) =       0.000515392839
  error estimate for blocks of size 2^( 4) =       0.000520551880
  error estimate for blocks of size 2^( 5) =       0.000524407612
  error estimate for blocks of size 2^( 6) =       0.000524506876
  error estimate for blocks of size 2^( 7) =       0.000523372261

      target function =                  N/A
              le_mean =     -17.216449846871
             les_mean =     296.907408257195
             stat err =       0.000523209657
             autocorr =       1.092234009252
              std dev =       0.707999419500
             le_variance =       0.501263178012


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721644984687e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216449846871       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216451039639       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216451684871       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216452391534       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216453857625       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216451843563       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216452368050       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216452548994       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216452771997       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216452801368       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216453358198       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 1.730184e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216449846871       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216450472416       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216450726340       residual = 9.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216450946080       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216451636604       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216450799718       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216451175342       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216451159634       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216451133844       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 4.544782e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216449846871       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216450062412       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216450102429       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216450119941       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216450369723       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216450233389       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216450277106       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.180017e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194947 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7681e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.156464e-01 1 1  ON 0
 uu_1                 5.269916e-02 1 1  ON 1
 uu_2                -4.269319e-02 1 1  ON 2
 uu_3                -9.884042e-02 1 1  ON 3
 uu_4                -1.336891e-01 1 1  ON 4
 uu_5                -1.425471e-01 1 1  ON 5
 uu_6                -1.201156e-01 1 1  ON 6
 uu_7                -5.138972e-02 1 1  ON 7
 uu_8                 9.076813e-02 1 1  ON 8
 uu_9                 1.284880e-01 1 1  ON 9
 ud_0                 3.554923e-01 1 1  ON 10
 ud_1                 9.695006e-02 1 1  ON 11
 ud_2                -1.271587e-02 1 1  ON 12
 ud_3                -7.408331e-02 1 1  ON 13
 ud_4                -1.227510e-01 1 1  ON 14
 ud_5                -1.557418e-01 1 1  ON 15
 ud_6                -1.584394e-01 1 1  ON 16
 ud_7                -1.124465e-01 1 1  ON 17
 ud_8                -8.404047e-03 1 1  ON 18
 ud_9                 9.243444e-02 1 1  ON 19
 eO_0                -7.893354e-01 1 1  ON 20
 eO_1                -4.677130e-01 1 1  ON 21
 eO_2                -5.571540e-02 1 1  ON 22
 eO_3                 2.071251e-01 1 1  ON 23
 eO_4                 3.120092e-01 1 1  ON 24
 eO_5                 3.341195e-01 1 1  ON 25
 eO_6                 2.678984e-01 1 1  ON 26
 eO_7                 1.300086e-01 1 1  ON 27
 eO_8                 3.113096e-02 1 1  ON 28
 eO_9                 1.925066e-02 1 1  ON 29
eH1_0                -1.845797e-01 1 1  ON 30
eH1_1                -1.055550e-01 1 1  ON 31
eH1_2                -6.393926e-02 1 1  ON 32
eH1_3                -2.677627e-02 1 1  ON 33
eH1_4                 1.873036e-02 1 1  ON 34
eH1_5                 3.147840e-02 1 1  ON 35
eH1_6                 7.763489e-02 1 1  ON 36
eH1_7                 1.090631e-01 1 1  ON 37
eH1_8                 1.003610e-01 1 1  ON 38
eH1_9                 2.731285e-02 1 1  ON 39
eH2_0                -1.848583e-01 1 1  ON 40
eH2_1                -1.063334e-01 1 1  ON 41
eH2_2                -6.466577e-02 1 1  ON 42
eH2_3                -2.748848e-02 1 1  ON 43
eH2_4                 1.776943e-02 1 1  ON 44
eH2_5                 3.007791e-02 1 1  ON 45
eH2_6                 7.583116e-02 1 1  ON 46
eH2_7                 1.132218e-01 1 1  ON 47
eH2_8                 1.042093e-01 1 1  ON 48
eH2_9                 2.923961e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2601
    reference variance = 0.25465
====================================================
  Execution time = 1.9978e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.4811e-01
  Total weights = 2.0000e+06
  Execution time = 1.8143e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348321357882
                                         uncertainty =       0.026443803932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348321357882
                                         uncertainty =       0.026443803932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417287574
  error estimate for blocks of size 2^( 2) =       0.000426770681
  error estimate for blocks of size 2^( 3) =       0.000434757914
  error estimate for blocks of size 2^( 4) =       0.000441030586
  error estimate for blocks of size 2^( 5) =       0.000446410413
  error estimate for blocks of size 2^( 6) =       0.000446341486
  error estimate for blocks of size 2^( 7) =       0.000447335959

      target function =                  N/A
              le_mean =     -17.216094225429
             les_mean =     296.742158042898
             stat err =       0.000445279611
             autocorr =       1.138661704918
              std dev =       0.590133746013
             le_variance =       0.348257838183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348052946168
                                         uncertainty =       0.026465832799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348052946168
                                         uncertainty =       0.026465832799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417126844
  error estimate for blocks of size 2^( 2) =       0.000426616024
  error estimate for blocks of size 2^( 3) =       0.000434608023
  error estimate for blocks of size 2^( 4) =       0.000440883610
  error estimate for blocks of size 2^( 5) =       0.000446255610
  error estimate for blocks of size 2^( 6) =       0.000446185686
  error estimate for blocks of size 2^( 7) =       0.000447182957

      target function =                  N/A
              le_mean =     -17.216092607663
             les_mean =     296.741834108909
             stat err =       0.000445126966
             autocorr =       1.138758236493
              std dev =       0.589906439430
             le_variance =       0.347989607281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348027862446
                                         uncertainty =       0.026467790859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348027862446
                                         uncertainty =       0.026467790859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417111824
  error estimate for blocks of size 2^( 2) =       0.000426602447
  error estimate for blocks of size 2^( 3) =       0.000434595969
  error estimate for blocks of size 2^( 4) =       0.000440872631
  error estimate for blocks of size 2^( 5) =       0.000446247018
  error estimate for blocks of size 2^( 6) =       0.000446178518
  error estimate for blocks of size 2^( 7) =       0.000447177900

      target function =                  N/A
              le_mean =     -17.216092739158
             les_mean =     296.741813576301
             stat err =       0.000445119017
             autocorr =       1.138799574635
              std dev =       0.589885198139
             le_variance =       0.347964546983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348259660085
                                         uncertainty =       0.026446886773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348259660085
                                         uncertainty =       0.026446886773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417250633
  error estimate for blocks of size 2^( 2) =       0.000426735158
  error estimate for blocks of size 2^( 3) =       0.000434723636
  error estimate for blocks of size 2^( 4) =       0.000440997121
  error estimate for blocks of size 2^( 5) =       0.000446376096
  error estimate for blocks of size 2^( 6) =       0.000446307523
  error estimate for blocks of size 2^( 7) =       0.000447302983

      target function =                  N/A
              le_mean =     -17.216093886348
             les_mean =     296.742084710318
             stat err =       0.000445245931
             autocorr =       1.138691058868
              std dev =       0.590081503578
             le_variance =       0.348196180865


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216094225429        initial  <--
     9.5367e-02     9.5367e-01             1.7302e-03       -17.216092607663
     3.8147e-01     3.8147e+00             4.5448e-04       -17.216092739158
     1.5259e+00     1.5259e+01             1.1800e-04       -17.216093886348

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1335
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.157630e-01 1 1  ON 0
 uu_1                 5.265320e-02 1 1  ON 1
 uu_2                -4.277996e-02 1 1  ON 2
 uu_3                -9.886932e-02 1 1  ON 3
 uu_4                -1.337473e-01 1 1  ON 4
 uu_5                -1.423584e-01 1 1  ON 5
 uu_6                -1.201552e-01 1 1  ON 6
 uu_7                -5.138157e-02 1 1  ON 7
 uu_8                 9.095677e-02 1 1  ON 8
 uu_9                 1.283950e-01 1 1  ON 9
 ud_0                 3.554835e-01 1 1  ON 10
 ud_1                 9.682138e-02 1 1  ON 11
 ud_2                -1.288058e-02 1 1  ON 12
 ud_3                -7.435467e-02 1 1  ON 13
 ud_4                -1.230607e-01 1 1  ON 14
 ud_5                -1.555988e-01 1 1  ON 15
 ud_6                -1.583410e-01 1 1  ON 16
 ud_7                -1.120188e-01 1 1  ON 17
 ud_8                -8.143943e-03 1 1  ON 18
 ud_9                 9.246569e-02 1 1  ON 19
 eO_0                -7.891384e-01 1 1  ON 20
 eO_1                -4.675678e-01 1 1  ON 21
 eO_2                -5.548112e-02 1 1  ON 22
 eO_3                 2.075443e-01 1 1  ON 23
 eO_4                 3.123196e-01 1 1  ON 24
 eO_5                 3.336650e-01 1 1  ON 25
 eO_6                 2.674545e-01 1 1  ON 26
 eO_7                 1.296600e-01 1 1  ON 27
 eO_8                 3.109350e-02 1 1  ON 28
 eO_9                 1.923624e-02 1 1  ON 29
eH1_0                -1.843522e-01 1 1  ON 30
eH1_1                -1.056729e-01 1 1  ON 31
eH1_2                -6.407404e-02 1 1  ON 32
eH1_3                -2.664938e-02 1 1  ON 33
eH1_4                 1.869961e-02 1 1  ON 34
eH1_5                 3.152448e-02 1 1  ON 35
eH1_6                 7.776341e-02 1 1  ON 36
eH1_7                 1.090354e-01 1 1  ON 37
eH1_8                 1.001906e-01 1 1  ON 38
eH1_9                 2.727015e-02 1 1  ON 39
eH2_0                -1.851051e-01 1 1  ON 40
eH2_1                -1.062782e-01 1 1  ON 41
eH2_2                -6.450262e-02 1 1  ON 42
eH2_3                -2.736708e-02 1 1  ON 43
eH2_4                 1.765487e-02 1 1  ON 44
eH2_5                 3.023452e-02 1 1  ON 45
eH2_6                 7.593626e-02 1 1  ON 46
eH2_7                 1.132209e-01 1 1  ON 47
eH2_8                 1.040369e-01 1 1  ON 48
eH2_9                 2.919774e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6882e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2204
    reference variance = 0.208993
====================================================
  Execution time = 2.0293e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1075e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5651e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310901677548
                                         uncertainty =       0.002467749902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310901677548
                                         uncertainty =       0.002467749902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394175432
  error estimate for blocks of size 2^( 2) =       0.000403991770
  error estimate for blocks of size 2^( 3) =       0.000412590425
  error estimate for blocks of size 2^( 4) =       0.000418448255
  error estimate for blocks of size 2^( 5) =       0.000422655041
  error estimate for blocks of size 2^( 6) =       0.000424062967
  error estimate for blocks of size 2^( 7) =       0.000425783832

      target function =                  N/A
              le_mean =     -17.216834748035
             les_mean =     296.730147128693
             stat err =       0.000422737524
             autocorr =       1.150171210847
              std dev =       0.557448242381
             le_variance =       0.310748542933


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721683474803e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216834748035       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216834860782       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216834716054       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216835069680       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216835051482       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216835088474       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216835181323       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216835104776       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 2.194921e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216834748035       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216834779234       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216834735584       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216834838115       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216834848709       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216834851049       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216834861061       residual = 6.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 5.668802e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216834748035       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216834756049       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216834744547       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216834771204       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216834775360       residual = 7.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216834775546       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216834777348       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.424606e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.197343 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5865e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.157441e-01 1 1  ON 0
 uu_1                 5.264186e-02 1 1  ON 1
 uu_2                -4.278113e-02 1 1  ON 2
 uu_3                -9.886190e-02 1 1  ON 3
 uu_4                -1.337338e-01 1 1  ON 4
 uu_5                -1.423688e-01 1 1  ON 5
 uu_6                -1.201464e-01 1 1  ON 6
 uu_7                -5.137905e-02 1 1  ON 7
 uu_8                 9.094153e-02 1 1  ON 8
 uu_9                 1.284071e-01 1 1  ON 9
 ud_0                 3.554818e-01 1 1  ON 10
 ud_1                 9.681463e-02 1 1  ON 11
 ud_2                -1.287277e-02 1 1  ON 12
 ud_3                -7.435305e-02 1 1  ON 13
 ud_4                -1.230464e-01 1 1  ON 14
 ud_5                -1.556072e-01 1 1  ON 15
 ud_6                -1.583286e-01 1 1  ON 16
 ud_7                -1.120287e-01 1 1  ON 17
 ud_8                -8.163309e-03 1 1  ON 18
 ud_9                 9.246498e-02 1 1  ON 19
 eO_0                -7.891574e-01 1 1  ON 20
 eO_1                -4.675842e-01 1 1  ON 21
 eO_2                -5.552908e-02 1 1  ON 22
 eO_3                 2.074876e-01 1 1  ON 23
 eO_4                 3.123272e-01 1 1  ON 24
 eO_5                 3.337183e-01 1 1  ON 25
 eO_6                 2.674940e-01 1 1  ON 26
 eO_7                 1.296921e-01 1 1  ON 27
 eO_8                 3.109910e-02 1 1  ON 28
 eO_9                 1.923769e-02 1 1  ON 29
eH1_0                -1.843847e-01 1 1  ON 30
eH1_1                -1.056787e-01 1 1  ON 31
eH1_2                -6.405703e-02 1 1  ON 32
eH1_3                -2.666317e-02 1 1  ON 33
eH1_4                 1.872731e-02 1 1  ON 34
eH1_5                 3.151011e-02 1 1  ON 35
eH1_6                 7.775102e-02 1 1  ON 36
eH1_7                 1.090438e-01 1 1  ON 37
eH1_8                 1.002115e-01 1 1  ON 38
eH1_9                 2.727416e-02 1 1  ON 39
eH2_0                -1.851118e-01 1 1  ON 40
eH2_1                -1.062742e-01 1 1  ON 41
eH2_2                -6.451031e-02 1 1  ON 42
eH2_3                -2.736767e-02 1 1  ON 43
eH2_4                 1.764479e-02 1 1  ON 44
eH2_5                 3.023101e-02 1 1  ON 45
eH2_6                 7.593964e-02 1 1  ON 46
eH2_7                 1.132188e-01 1 1  ON 47
eH2_8                 1.040537e-01 1 1  ON 48
eH2_9                 2.920362e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1879
    reference variance = 0.21029
====================================================
  Execution time = 1.9789e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2155e-01
  Total weights = 2.0000e+06
  Execution time = 1.8228e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321647163990
                                         uncertainty =       0.003768198735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321647163990
                                         uncertainty =       0.003768198735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400977934
  error estimate for blocks of size 2^( 2) =       0.000411004150
  error estimate for blocks of size 2^( 3) =       0.000419741223
  error estimate for blocks of size 2^( 4) =       0.000426901273
  error estimate for blocks of size 2^( 5) =       0.000431494210
  error estimate for blocks of size 2^( 6) =       0.000433301656
  error estimate for blocks of size 2^( 7) =       0.000434342994

      target function =                  N/A
              le_mean =     -17.217349671641
             les_mean =     296.758696162174
             stat err =       0.000431510033
             autocorr =       1.158086098232
              std dev =       0.567068432732
             le_variance =       0.321566607402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321589599353
                                         uncertainty =       0.003767539634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321589599353
                                         uncertainty =       0.003767539634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400942051
  error estimate for blocks of size 2^( 2) =       0.000410969619
  error estimate for blocks of size 2^( 3) =       0.000419708441
  error estimate for blocks of size 2^( 4) =       0.000426869910
  error estimate for blocks of size 2^( 5) =       0.000431463333
  error estimate for blocks of size 2^( 6) =       0.000433271631
  error estimate for blocks of size 2^( 7) =       0.000434314094

      target function =                  N/A
              le_mean =     -17.217349794332
             les_mean =     296.758642835358
             stat err =       0.000431479742
             autocorr =       1.158130785340
              std dev =       0.567017685555
             le_variance =       0.321509055733

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321616694398
                                         uncertainty =       0.003767895567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321616694398
                                         uncertainty =       0.003767895567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400958939
  error estimate for blocks of size 2^( 2) =       0.000410985936
  error estimate for blocks of size 2^( 3) =       0.000419723935
  error estimate for blocks of size 2^( 4) =       0.000426884748
  error estimate for blocks of size 2^( 5) =       0.000431477930
  error estimate for blocks of size 2^( 6) =       0.000433285898
  error estimate for blocks of size 2^( 7) =       0.000434327927

      target function =                  N/A
              le_mean =     -17.217349730829
             les_mean =     296.758667734246
             stat err =       0.000431494125
             autocorr =       1.158110435258
              std dev =       0.567041569335
             le_variance =       0.321536141354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321643291328
                                         uncertainty =       0.003768160817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321643291328
                                         uncertainty =       0.003768160817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400975520
  error estimate for blocks of size 2^( 2) =       0.000411001837
  error estimate for blocks of size 2^( 3) =       0.000419739029
  error estimate for blocks of size 2^( 4) =       0.000426899176
  error estimate for blocks of size 2^( 5) =       0.000431492147
  error estimate for blocks of size 2^( 6) =       0.000433299664
  error estimate for blocks of size 2^( 7) =       0.000434341092

      target function =                  N/A
              le_mean =     -17.217349677803
             les_mean =     296.758692501993
             stat err =       0.000431508020
             autocorr =       1.158089236927
              std dev =       0.567065018351
             le_variance =       0.321562735037


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217349671641        initial
     9.5367e-01     9.5367e+00             2.1949e-04       -17.217349794332  <--
     3.8147e+00     3.8147e+01             5.6688e-05       -17.217349730829
     1.5259e+01     1.5259e+02             1.4246e-05       -17.217349677803

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 2.8990e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.156924e-01 1 1  ON 0
 uu_1                 5.261290e-02 1 1  ON 1
 uu_2                -4.277985e-02 1 1  ON 2
 uu_3                -9.884166e-02 1 1  ON 3
 uu_4                -1.337047e-01 1 1  ON 4
 uu_5                -1.423959e-01 1 1  ON 5
 uu_6                -1.201247e-01 1 1  ON 6
 uu_7                -5.137332e-02 1 1  ON 7
 uu_8                 9.089386e-02 1 1  ON 8
 uu_9                 1.284449e-01 1 1  ON 9
 ud_0                 3.554773e-01 1 1  ON 10
 ud_1                 9.680429e-02 1 1  ON 11
 ud_2                -1.285819e-02 1 1  ON 12
 ud_3                -7.434259e-02 1 1  ON 13
 ud_4                -1.230079e-01 1 1  ON 14
 ud_5                -1.556254e-01 1 1  ON 15
 ud_6                -1.582970e-01 1 1  ON 16
 ud_7                -1.120615e-01 1 1  ON 17
 ud_8                -8.223832e-03 1 1  ON 18
 ud_9                 9.246270e-02 1 1  ON 19
 eO_0                -7.892129e-01 1 1  ON 20
 eO_1                -4.676565e-01 1 1  ON 21
 eO_2                -5.566593e-02 1 1  ON 22
 eO_3                 2.073248e-01 1 1  ON 23
 eO_4                 3.123461e-01 1 1  ON 24
 eO_5                 3.338807e-01 1 1  ON 25
 eO_6                 2.676165e-01 1 1  ON 26
 eO_7                 1.297923e-01 1 1  ON 27
 eO_8                 3.111660e-02 1 1  ON 28
 eO_9                 1.924223e-02 1 1  ON 29
eH1_0                -1.844716e-01 1 1  ON 30
eH1_1                -1.056880e-01 1 1  ON 31
eH1_2                -6.401877e-02 1 1  ON 32
eH1_3                -2.669266e-02 1 1  ON 33
eH1_4                 1.878939e-02 1 1  ON 34
eH1_5                 3.146794e-02 1 1  ON 35
eH1_6                 7.771255e-02 1 1  ON 36
eH1_7                 1.090693e-01 1 1  ON 37
eH1_8                 1.002766e-01 1 1  ON 38
eH1_9                 2.728669e-02 1 1  ON 39
eH2_0                -1.851313e-01 1 1  ON 40
eH2_1                -1.062686e-01 1 1  ON 41
eH2_2                -6.452451e-02 1 1  ON 42
eH2_3                -2.737876e-02 1 1  ON 43
eH2_4                 1.762232e-02 1 1  ON 44
eH2_5                 3.021975e-02 1 1  ON 45
eH2_6                 7.594758e-02 1 1  ON 46
eH2_7                 1.132116e-01 1 1  ON 47
eH2_8                 1.041063e-01 1 1  ON 48
eH2_9                 2.922197e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5080e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1213
    reference variance = 0.248429
====================================================
  Execution time = 2.2589e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2336e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5267e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323398647892
                                         uncertainty =       0.004674704192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323398647892
                                         uncertainty =       0.004674704192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402093030
  error estimate for blocks of size 2^( 2) =       0.000411504258
  error estimate for blocks of size 2^( 3) =       0.000419703187
  error estimate for blocks of size 2^( 4) =       0.000425290169
  error estimate for blocks of size 2^( 5) =       0.000429590166
  error estimate for blocks of size 2^( 6) =       0.000431932910
  error estimate for blocks of size 2^( 7) =       0.000431088357

      target function =                  N/A
              le_mean =     -17.216489677090
             les_mean =     296.730874249964
             stat err =       0.000429475401
             autocorr =       1.140836732882
              std dev =       0.568645417005
             le_variance =       0.323357610281


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721648967709e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216489677090       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216489812942       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216490233360       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216490981051       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216491309737       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216492013353       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216491700682       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216491745114       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216491580997       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 6.470840e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216489677090       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216489726265       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216489917750       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216490158434       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216490205559       residual = 8.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216490391594       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216490319820       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216490302321       residual = 1.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 1.850329e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216489677090       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216489690934       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216489750913       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216489813794       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216489825244       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216489863562       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216489845598       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 5.021269e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.200079 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8122e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.156302e-01 1 1  ON 0
 uu_1                 5.263549e-02 1 1  ON 1
 uu_2                -4.277338e-02 1 1  ON 2
 uu_3                -9.879305e-02 1 1  ON 3
 uu_4                -1.337160e-01 1 1  ON 4
 uu_5                -1.424459e-01 1 1  ON 5
 uu_6                -1.201472e-01 1 1  ON 6
 uu_7                -5.135359e-02 1 1  ON 7
 uu_8                 9.081804e-02 1 1  ON 8
 uu_9                 1.284901e-01 1 1  ON 9
 ud_0                 3.555222e-01 1 1  ON 10
 ud_1                 9.677354e-02 1 1  ON 11
 ud_2                -1.284204e-02 1 1  ON 12
 ud_3                -7.431534e-02 1 1  ON 13
 ud_4                -1.230416e-01 1 1  ON 14
 ud_5                -1.555714e-01 1 1  ON 15
 ud_6                -1.583267e-01 1 1  ON 16
 ud_7                -1.120554e-01 1 1  ON 17
 ud_8                -8.321444e-03 1 1  ON 18
 ud_9                 9.244828e-02 1 1  ON 19
 eO_0                -7.893979e-01 1 1  ON 20
 eO_1                -4.677261e-01 1 1  ON 21
 eO_2                -5.576623e-02 1 1  ON 22
 eO_3                 2.071819e-01 1 1  ON 23
 eO_4                 3.123569e-01 1 1  ON 24
 eO_5                 3.340220e-01 1 1  ON 25
 eO_6                 2.677778e-01 1 1  ON 26
 eO_7                 1.299468e-01 1 1  ON 27
 eO_8                 3.113490e-02 1 1  ON 28
 eO_9                 1.924601e-02 1 1  ON 29
eH1_0                -1.844651e-01 1 1  ON 30
eH1_1                -1.056768e-01 1 1  ON 31
eH1_2                -6.397693e-02 1 1  ON 32
eH1_3                -2.679603e-02 1 1  ON 33
eH1_4                 1.867691e-02 1 1  ON 34
eH1_5                 3.148667e-02 1 1  ON 35
eH1_6                 7.769636e-02 1 1  ON 36
eH1_7                 1.090929e-01 1 1  ON 37
eH1_8                 1.003646e-01 1 1  ON 38
eH1_9                 2.731626e-02 1 1  ON 39
eH2_0                -1.851577e-01 1 1  ON 40
eH2_1                -1.062410e-01 1 1  ON 41
eH2_2                -6.454255e-02 1 1  ON 42
eH2_3                -2.746925e-02 1 1  ON 43
eH2_4                 1.757317e-02 1 1  ON 44
eH2_5                 3.021839e-02 1 1  ON 45
eH2_6                 7.595735e-02 1 1  ON 46
eH2_7                 1.132266e-01 1 1  ON 47
eH2_8                 1.042015e-01 1 1  ON 48
eH2_9                 2.925400e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2056
    reference variance = 0.183413
====================================================
  Execution time = 2.0128e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1958e-01
  Total weights = 2.0000e+06
  Execution time = 1.8209e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319557507495
                                         uncertainty =       0.004834465180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319557507495
                                         uncertainty =       0.004834465180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399723411
  error estimate for blocks of size 2^( 2) =       0.000409019774
  error estimate for blocks of size 2^( 3) =       0.000417278957
  error estimate for blocks of size 2^( 4) =       0.000423667992
  error estimate for blocks of size 2^( 5) =       0.000427250590
  error estimate for blocks of size 2^( 6) =       0.000429049756
  error estimate for blocks of size 2^( 7) =       0.000430766075

      target function =                  N/A
              le_mean =     -17.217168771197
             les_mean =     296.750457946660
             stat err =       0.000427683603
             autocorr =       1.144790538567
              std dev =       0.565294268981
             le_variance =       0.319557610543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319597387100
                                         uncertainty =       0.004834141219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319597387100
                                         uncertainty =       0.004834141219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399748362
  error estimate for blocks of size 2^( 2) =       0.000409043361
  error estimate for blocks of size 2^( 3) =       0.000417302536
  error estimate for blocks of size 2^( 4) =       0.000423690408
  error estimate for blocks of size 2^( 5) =       0.000427272658
  error estimate for blocks of size 2^( 6) =       0.000429073160
  error estimate for blocks of size 2^( 7) =       0.000430790077

      target function =                  N/A
              le_mean =     -17.217168589031
             les_mean =     296.750491569274
             stat err =       0.000427706576
             autocorr =       1.144770604872
              std dev =       0.565329555190
             le_variance =       0.319597505971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319603223374
                                         uncertainty =       0.004834579068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319603223374
                                         uncertainty =       0.004834579068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399752011
  error estimate for blocks of size 2^( 2) =       0.000409046844
  error estimate for blocks of size 2^( 3) =       0.000417306397
  error estimate for blocks of size 2^( 4) =       0.000423695154
  error estimate for blocks of size 2^( 5) =       0.000427277464
  error estimate for blocks of size 2^( 6) =       0.000429078661
  error estimate for blocks of size 2^( 7) =       0.000430795438

      target function =                  N/A
              le_mean =     -17.217168748618
             les_mean =     296.750502898452
             stat err =       0.000427711679
             autocorr =       1.144777024980
              std dev =       0.565334714890
             le_variance =       0.319603339860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319567867942
                                         uncertainty =       0.004834540612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319567867942
                                         uncertainty =       0.004834540612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399729892
  error estimate for blocks of size 2^( 2) =       0.000409025913
  error estimate for blocks of size 2^( 3) =       0.000417285094
  error estimate for blocks of size 2^( 4) =       0.000423674070
  error estimate for blocks of size 2^( 5) =       0.000427256584
  error estimate for blocks of size 2^( 6) =       0.000429056072
  error estimate for blocks of size 2^( 7) =       0.000430772530

      target function =                  N/A
              le_mean =     -17.217168752055
             les_mean =     296.750467650722
             stat err =       0.000427689814
             autocorr =       1.144786660704
              std dev =       0.565303435123
             le_variance =       0.319567973762


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217168771197        initial  <--
     2.3842e-01     2.3842e+00             6.4708e-04       -17.217168589031
     9.5367e-01     9.5367e+00             1.8503e-04       -17.217168748618
     3.8147e+00     3.8147e+01             5.0213e-05       -17.217168752055

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3283
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.156924e-01 1 1  ON 0
 uu_1                 5.261290e-02 1 1  ON 1
 uu_2                -4.277985e-02 1 1  ON 2
 uu_3                -9.884166e-02 1 1  ON 3
 uu_4                -1.337047e-01 1 1  ON 4
 uu_5                -1.423959e-01 1 1  ON 5
 uu_6                -1.201247e-01 1 1  ON 6
 uu_7                -5.137332e-02 1 1  ON 7
 uu_8                 9.089386e-02 1 1  ON 8
 uu_9                 1.284449e-01 1 1  ON 9
 ud_0                 3.554773e-01 1 1  ON 10
 ud_1                 9.680429e-02 1 1  ON 11
 ud_2                -1.285819e-02 1 1  ON 12
 ud_3                -7.434259e-02 1 1  ON 13
 ud_4                -1.230079e-01 1 1  ON 14
 ud_5                -1.556254e-01 1 1  ON 15
 ud_6                -1.582970e-01 1 1  ON 16
 ud_7                -1.120615e-01 1 1  ON 17
 ud_8                -8.223832e-03 1 1  ON 18
 ud_9                 9.246270e-02 1 1  ON 19
 eO_0                -7.892129e-01 1 1  ON 20
 eO_1                -4.676565e-01 1 1  ON 21
 eO_2                -5.566593e-02 1 1  ON 22
 eO_3                 2.073248e-01 1 1  ON 23
 eO_4                 3.123461e-01 1 1  ON 24
 eO_5                 3.338807e-01 1 1  ON 25
 eO_6                 2.676165e-01 1 1  ON 26
 eO_7                 1.297923e-01 1 1  ON 27
 eO_8                 3.111660e-02 1 1  ON 28
 eO_9                 1.924223e-02 1 1  ON 29
eH1_0                -1.844716e-01 1 1  ON 30
eH1_1                -1.056880e-01 1 1  ON 31
eH1_2                -6.401877e-02 1 1  ON 32
eH1_3                -2.669266e-02 1 1  ON 33
eH1_4                 1.878939e-02 1 1  ON 34
eH1_5                 3.146794e-02 1 1  ON 35
eH1_6                 7.771255e-02 1 1  ON 36
eH1_7                 1.090693e-01 1 1  ON 37
eH1_8                 1.002766e-01 1 1  ON 38
eH1_9                 2.728669e-02 1 1  ON 39
eH2_0                -1.851313e-01 1 1  ON 40
eH2_1                -1.062686e-01 1 1  ON 41
eH2_2                -6.452451e-02 1 1  ON 42
eH2_3                -2.737876e-02 1 1  ON 43
eH2_4                 1.762232e-02 1 1  ON 44
eH2_5                 3.021975e-02 1 1  ON 45
eH2_6                 7.594758e-02 1 1  ON 46
eH2_7                 1.132116e-01 1 1  ON 47
eH2_8                 1.041063e-01 1 1  ON 48
eH2_9                 2.922197e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7842e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1951
    reference variance = 0.213041
====================================================
  Execution time = 2.0856e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2148e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5256e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321527513403
                                         uncertainty =       0.003198804560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321527513403
                                         uncertainty =       0.003198804560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400922194
  error estimate for blocks of size 2^( 2) =       0.000410722366
  error estimate for blocks of size 2^( 3) =       0.000419036562
  error estimate for blocks of size 2^( 4) =       0.000425313986
  error estimate for blocks of size 2^( 5) =       0.000429691760
  error estimate for blocks of size 2^( 6) =       0.000431148515
  error estimate for blocks of size 2^( 7) =       0.000433984742

      target function =                  N/A
              le_mean =     -17.216776056765
             les_mean =     296.738854839882
             stat err =       0.000430034751
             autocorr =       1.150500751627
              std dev =       0.566989604683
             le_variance =       0.321477211819


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721677605677e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216776056765       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216776150738       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216776209817       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216776190656       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216776072140       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216776106320       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216776135256       residual = 6.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 7.463235e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216776056765       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216776081300       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216776096987       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216776092095       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216776060267       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216776070073       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216776073280       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 1.886984e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216776056765       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216776062968       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216776066953       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216776065724       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216776057656       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216776060134       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216776060646       residual = 3.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 4.727603e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.202328 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6388e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.156791e-01 1 1  ON 0
 uu_1                 5.261602e-02 1 1  ON 1
 uu_2                -4.277341e-02 1 1  ON 2
 uu_3                -9.884175e-02 1 1  ON 3
 uu_4                -1.337000e-01 1 1  ON 4
 uu_5                -1.423908e-01 1 1  ON 5
 uu_6                -1.201268e-01 1 1  ON 6
 uu_7                -5.137921e-02 1 1  ON 7
 uu_8                 9.088658e-02 1 1  ON 8
 uu_9                 1.284495e-01 1 1  ON 9
 ud_0                 3.554780e-01 1 1  ON 10
 ud_1                 9.680031e-02 1 1  ON 11
 ud_2                -1.285033e-02 1 1  ON 12
 ud_3                -7.434210e-02 1 1  ON 13
 ud_4                -1.229988e-01 1 1  ON 14
 ud_5                -1.556258e-01 1 1  ON 15
 ud_6                -1.582947e-01 1 1  ON 16
 ud_7                -1.120671e-01 1 1  ON 17
 ud_8                -8.235721e-03 1 1  ON 18
 ud_9                 9.246030e-02 1 1  ON 19
 eO_0                -7.892262e-01 1 1  ON 20
 eO_1                -4.676674e-01 1 1  ON 21
 eO_2                -5.567933e-02 1 1  ON 22
 eO_3                 2.073153e-01 1 1  ON 23
 eO_4                 3.123463e-01 1 1  ON 24
 eO_5                 3.338996e-01 1 1  ON 25
 eO_6                 2.676308e-01 1 1  ON 26
 eO_7                 1.298038e-01 1 1  ON 27
 eO_8                 3.111798e-02 1 1  ON 28
 eO_9                 1.924266e-02 1 1  ON 29
eH1_0                -1.844747e-01 1 1  ON 30
eH1_1                -1.056827e-01 1 1  ON 31
eH1_2                -6.401180e-02 1 1  ON 32
eH1_3                -2.670323e-02 1 1  ON 33
eH1_4                 1.877734e-02 1 1  ON 34
eH1_5                 3.147065e-02 1 1  ON 35
eH1_6                 7.771677e-02 1 1  ON 36
eH1_7                 1.090686e-01 1 1  ON 37
eH1_8                 1.002819e-01 1 1  ON 38
eH1_9                 2.728822e-02 1 1  ON 39
eH2_0                -1.851391e-01 1 1  ON 40
eH2_1                -1.062730e-01 1 1  ON 41
eH2_2                -6.452364e-02 1 1  ON 42
eH2_3                -2.738178e-02 1 1  ON 43
eH2_4                 1.763797e-02 1 1  ON 44
eH2_5                 3.021906e-02 1 1  ON 45
eH2_6                 7.594095e-02 1 1  ON 46
eH2_7                 1.132083e-01 1 1  ON 47
eH2_8                 1.041129e-01 1 1  ON 48
eH2_9                 2.922394e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2013
    reference variance = 0.318908
====================================================
  Execution time = 2.0852e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1496e-01
  Total weights = 2.0000e+06
  Execution time = 1.8187e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315061574022
                                         uncertainty =       0.002889988900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315061574022
                                         uncertainty =       0.002889988900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396841934
  error estimate for blocks of size 2^( 2) =       0.000406646155
  error estimate for blocks of size 2^( 3) =       0.000415143130
  error estimate for blocks of size 2^( 4) =       0.000422028909
  error estimate for blocks of size 2^( 5) =       0.000427202856
  error estimate for blocks of size 2^( 6) =       0.000429429762
  error estimate for blocks of size 2^( 7) =       0.000430693284

      target function =                  N/A
              le_mean =     -17.216062464702
             les_mean =     296.707773671710
             stat err =       0.000427338703
             autocorr =       1.159603026172
              std dev =       0.561219244752
             le_variance =       0.314967040680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315029657382
                                         uncertainty =       0.002889763822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315029657382
                                         uncertainty =       0.002889763822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396821847
  error estimate for blocks of size 2^( 2) =       0.000406626866
  error estimate for blocks of size 2^( 3) =       0.000415124436
  error estimate for blocks of size 2^( 4) =       0.000422011480
  error estimate for blocks of size 2^( 5) =       0.000427185909
  error estimate for blocks of size 2^( 6) =       0.000429412230
  error estimate for blocks of size 2^( 7) =       0.000430676199

      target function =                  N/A
              le_mean =     -17.216062340500
             les_mean =     296.707737510923
             stat err =       0.000427321455
             autocorr =       1.159626811334
              std dev =       0.561190837780
             le_variance =       0.314935156408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315044652591
                                         uncertainty =       0.002889870878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315044652591
                                         uncertainty =       0.002889870878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396831285
  error estimate for blocks of size 2^( 2) =       0.000406635946
  error estimate for blocks of size 2^( 3) =       0.000415133246
  error estimate for blocks of size 2^( 4) =       0.000422019726
  error estimate for blocks of size 2^( 5) =       0.000427193950
  error estimate for blocks of size 2^( 6) =       0.000429420545
  error estimate for blocks of size 2^( 7) =       0.000430684264

      target function =                  N/A
              le_mean =     -17.216062392006
             les_mean =     296.707754265109
             stat err =       0.000427329621
             autocorr =       1.159615975077
              std dev =       0.561204184901
             le_variance =       0.314950137150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315059420983
                                         uncertainty =       0.002889973956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315059420983
                                         uncertainty =       0.002889973956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396840579
  error estimate for blocks of size 2^( 2) =       0.000406644856
  error estimate for blocks of size 2^( 3) =       0.000415141873
  error estimate for blocks of size 2^( 4) =       0.000422027742
  error estimate for blocks of size 2^( 5) =       0.000427201725
  error estimate for blocks of size 2^( 6) =       0.000429428592
  error estimate for blocks of size 2^( 7) =       0.000430692137

      target function =                  N/A
              le_mean =     -17.216062454895
             les_mean =     296.707771183306
             stat err =       0.000427337549
             autocorr =       1.159604683208
              std dev =       0.561217328622
             le_variance =       0.314964889946


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216062464702        initial  <--
     2.3842e+00     2.3842e+01             7.4632e-05       -17.216062340500
     9.5367e+00     9.5367e+01             1.8870e-05       -17.216062392006
     3.8147e+01     3.8147e+02             4.7276e-06       -17.216062454895

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0374
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.156924e-01 1 1  ON 0
 uu_1                 5.261290e-02 1 1  ON 1
 uu_2                -4.277985e-02 1 1  ON 2
 uu_3                -9.884166e-02 1 1  ON 3
 uu_4                -1.337047e-01 1 1  ON 4
 uu_5                -1.423959e-01 1 1  ON 5
 uu_6                -1.201247e-01 1 1  ON 6
 uu_7                -5.137332e-02 1 1  ON 7
 uu_8                 9.089386e-02 1 1  ON 8
 uu_9                 1.284449e-01 1 1  ON 9
 ud_0                 3.554773e-01 1 1  ON 10
 ud_1                 9.680429e-02 1 1  ON 11
 ud_2                -1.285819e-02 1 1  ON 12
 ud_3                -7.434259e-02 1 1  ON 13
 ud_4                -1.230079e-01 1 1  ON 14
 ud_5                -1.556254e-01 1 1  ON 15
 ud_6                -1.582970e-01 1 1  ON 16
 ud_7                -1.120615e-01 1 1  ON 17
 ud_8                -8.223832e-03 1 1  ON 18
 ud_9                 9.246270e-02 1 1  ON 19
 eO_0                -7.892129e-01 1 1  ON 20
 eO_1                -4.676565e-01 1 1  ON 21
 eO_2                -5.566593e-02 1 1  ON 22
 eO_3                 2.073248e-01 1 1  ON 23
 eO_4                 3.123461e-01 1 1  ON 24
 eO_5                 3.338807e-01 1 1  ON 25
 eO_6                 2.676165e-01 1 1  ON 26
 eO_7                 1.297923e-01 1 1  ON 27
 eO_8                 3.111660e-02 1 1  ON 28
 eO_9                 1.924223e-02 1 1  ON 29
eH1_0                -1.844716e-01 1 1  ON 30
eH1_1                -1.056880e-01 1 1  ON 31
eH1_2                -6.401877e-02 1 1  ON 32
eH1_3                -2.669266e-02 1 1  ON 33
eH1_4                 1.878939e-02 1 1  ON 34
eH1_5                 3.146794e-02 1 1  ON 35
eH1_6                 7.771255e-02 1 1  ON 36
eH1_7                 1.090693e-01 1 1  ON 37
eH1_8                 1.002766e-01 1 1  ON 38
eH1_9                 2.728669e-02 1 1  ON 39
eH2_0                -1.851313e-01 1 1  ON 40
eH2_1                -1.062686e-01 1 1  ON 41
eH2_2                -6.452451e-02 1 1  ON 42
eH2_3                -2.737876e-02 1 1  ON 43
eH2_4                 1.762232e-02 1 1  ON 44
eH2_5                 3.021975e-02 1 1  ON 45
eH2_6                 7.594758e-02 1 1  ON 46
eH2_7                 1.132116e-01 1 1  ON 47
eH2_8                 1.041063e-01 1 1  ON 48
eH2_9                 2.922197e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7308e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1737
    reference variance = 0.282088
====================================================
  Execution time = 2.0209e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2429e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5706e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324370412368
                                         uncertainty =       0.004841673055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324370412368
                                         uncertainty =       0.004841673055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402674247
  error estimate for blocks of size 2^( 2) =       0.000412162626
  error estimate for blocks of size 2^( 3) =       0.000420312541
  error estimate for blocks of size 2^( 4) =       0.000426451202
  error estimate for blocks of size 2^( 5) =       0.000430641092
  error estimate for blocks of size 2^( 6) =       0.000432570825
  error estimate for blocks of size 2^( 7) =       0.000434129848

      target function =                  N/A
              le_mean =     -17.217301818404
             les_mean =     296.759774843044
             stat err =       0.000430948242
             autocorr =       1.145361325894
              std dev =       0.569467382018
             le_variance =       0.324293099182


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721730181840e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217301818404       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217301836143       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217301814379       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217301813664       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217301820848       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217301820429       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217301821771       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 9.524633e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217301818404       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217301822862       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217301817386       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217301817145       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217301818922       residual = 7.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217301818831       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217301819190       residual = 5.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.390432e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217301818404       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217301819520       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217301818148       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217301818085       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217301818527       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217301818505       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217301818597       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 5.981936e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.204567 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5785e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.156930e-01 1 1  ON 0
 uu_1                 5.261317e-02 1 1  ON 1
 uu_2                -4.277955e-02 1 1  ON 2
 uu_3                -9.884232e-02 1 1  ON 3
 uu_4                -1.337047e-01 1 1  ON 4
 uu_5                -1.423957e-01 1 1  ON 5
 uu_6                -1.201254e-01 1 1  ON 6
 uu_7                -5.137402e-02 1 1  ON 7
 uu_8                 9.089321e-02 1 1  ON 8
 uu_9                 1.284454e-01 1 1  ON 9
 ud_0                 3.554783e-01 1 1  ON 10
 ud_1                 9.680464e-02 1 1  ON 11
 ud_2                -1.285826e-02 1 1  ON 12
 ud_3                -7.434191e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556265e-01 1 1  ON 15
 ud_6                -1.582975e-01 1 1  ON 16
 ud_7                -1.120618e-01 1 1  ON 17
 ud_8                -8.224756e-03 1 1  ON 18
 ud_9                 9.246265e-02 1 1  ON 19
 eO_0                -7.892153e-01 1 1  ON 20
 eO_1                -4.676572e-01 1 1  ON 21
 eO_2                -5.566683e-02 1 1  ON 22
 eO_3                 2.073236e-01 1 1  ON 23
 eO_4                 3.123467e-01 1 1  ON 24
 eO_5                 3.338824e-01 1 1  ON 25
 eO_6                 2.676176e-01 1 1  ON 26
 eO_7                 1.297936e-01 1 1  ON 27
 eO_8                 3.111680e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844723e-01 1 1  ON 30
eH1_1                -1.056862e-01 1 1  ON 31
eH1_2                -6.401928e-02 1 1  ON 32
eH1_3                -2.669286e-02 1 1  ON 33
eH1_4                 1.878831e-02 1 1  ON 34
eH1_5                 3.146784e-02 1 1  ON 35
eH1_6                 7.771267e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002771e-01 1 1  ON 38
eH1_9                 2.728689e-02 1 1  ON 39
eH2_0                -1.851307e-01 1 1  ON 40
eH2_1                -1.062688e-01 1 1  ON 41
eH2_2                -6.452448e-02 1 1  ON 42
eH2_3                -2.737934e-02 1 1  ON 43
eH2_4                 1.762167e-02 1 1  ON 44
eH2_5                 3.021955e-02 1 1  ON 45
eH2_6                 7.594772e-02 1 1  ON 46
eH2_7                 1.132114e-01 1 1  ON 47
eH2_8                 1.041069e-01 1 1  ON 48
eH2_9                 2.922227e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.167
    reference variance = 0.215001
====================================================
  Execution time = 1.9827e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1349e-01
  Total weights = 2.0000e+06
  Execution time = 1.8310e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313342803352
                                         uncertainty =       0.002652098983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313342803352
                                         uncertainty =       0.002652098983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395912824
  error estimate for blocks of size 2^( 2) =       0.000405591364
  error estimate for blocks of size 2^( 3) =       0.000414663129
  error estimate for blocks of size 2^( 4) =       0.000421628266
  error estimate for blocks of size 2^( 5) =       0.000424295134
  error estimate for blocks of size 2^( 6) =       0.000427113771
  error estimate for blocks of size 2^( 7) =       0.000429670570

      target function =                  N/A
              le_mean =     -17.216669051879
             les_mean =     296.727187013241
             stat err =       0.000425676935
             autocorr =       1.156008694690
              std dev =       0.559905284896
             le_variance =       0.313493928055

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313347323290
                                         uncertainty =       0.002652150930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313347323290
                                         uncertainty =       0.002652150930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395915680
  error estimate for blocks of size 2^( 2) =       0.000405594091
  error estimate for blocks of size 2^( 3) =       0.000414665705
  error estimate for blocks of size 2^( 4) =       0.000421630724
  error estimate for blocks of size 2^( 5) =       0.000424297596
  error estimate for blocks of size 2^( 6) =       0.000427116190
  error estimate for blocks of size 2^( 7) =       0.000429672998

      target function =                  N/A
              le_mean =     -17.216668995838
             les_mean =     296.727189606508
             stat err =       0.000425679377
             autocorr =       1.156005277890
              std dev =       0.559909323919
             le_variance =       0.313498451011

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313345078308
                                         uncertainty =       0.002652125204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313345078308
                                         uncertainty =       0.002652125204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395914261
  error estimate for blocks of size 2^( 2) =       0.000405592736
  error estimate for blocks of size 2^( 3) =       0.000414664426
  error estimate for blocks of size 2^( 4) =       0.000421629503
  error estimate for blocks of size 2^( 5) =       0.000424296373
  error estimate for blocks of size 2^( 6) =       0.000427114988
  error estimate for blocks of size 2^( 7) =       0.000429671792

      target function =                  N/A
              le_mean =     -17.216669023490
             les_mean =     296.727188312202
             stat err =       0.000425678164
             autocorr =       1.156006972498
              std dev =       0.559907317825
             le_variance =       0.313496204554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313343088174
                                         uncertainty =       0.002652102268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313343088174
                                         uncertainty =       0.002652102268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395913004
  error estimate for blocks of size 2^( 2) =       0.000405591536
  error estimate for blocks of size 2^( 3) =       0.000414663292
  error estimate for blocks of size 2^( 4) =       0.000421628421
  error estimate for blocks of size 2^( 5) =       0.000424295289
  error estimate for blocks of size 2^( 6) =       0.000427113923
  error estimate for blocks of size 2^( 7) =       0.000429670723

      target function =                  N/A
              le_mean =     -17.216669048315
             les_mean =     296.727187175547
             stat err =       0.000425677089
             autocorr =       1.156008478971
              std dev =       0.559905539417
             le_variance =       0.313494213070


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216669051879        initial  <--
     2.3842e+01     2.3842e+02             9.5246e-06       -17.216668995838
     9.5367e+01     9.5367e+02             2.3904e-06       -17.216669023490
     3.8147e+02     3.8147e+03             5.9819e-07       -17.216669048315

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0831
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.156924e-01 1 1  ON 0
 uu_1                 5.261290e-02 1 1  ON 1
 uu_2                -4.277985e-02 1 1  ON 2
 uu_3                -9.884166e-02 1 1  ON 3
 uu_4                -1.337047e-01 1 1  ON 4
 uu_5                -1.423959e-01 1 1  ON 5
 uu_6                -1.201247e-01 1 1  ON 6
 uu_7                -5.137332e-02 1 1  ON 7
 uu_8                 9.089386e-02 1 1  ON 8
 uu_9                 1.284449e-01 1 1  ON 9
 ud_0                 3.554773e-01 1 1  ON 10
 ud_1                 9.680429e-02 1 1  ON 11
 ud_2                -1.285819e-02 1 1  ON 12
 ud_3                -7.434259e-02 1 1  ON 13
 ud_4                -1.230079e-01 1 1  ON 14
 ud_5                -1.556254e-01 1 1  ON 15
 ud_6                -1.582970e-01 1 1  ON 16
 ud_7                -1.120615e-01 1 1  ON 17
 ud_8                -8.223832e-03 1 1  ON 18
 ud_9                 9.246270e-02 1 1  ON 19
 eO_0                -7.892129e-01 1 1  ON 20
 eO_1                -4.676565e-01 1 1  ON 21
 eO_2                -5.566593e-02 1 1  ON 22
 eO_3                 2.073248e-01 1 1  ON 23
 eO_4                 3.123461e-01 1 1  ON 24
 eO_5                 3.338807e-01 1 1  ON 25
 eO_6                 2.676165e-01 1 1  ON 26
 eO_7                 1.297923e-01 1 1  ON 27
 eO_8                 3.111660e-02 1 1  ON 28
 eO_9                 1.924223e-02 1 1  ON 29
eH1_0                -1.844716e-01 1 1  ON 30
eH1_1                -1.056880e-01 1 1  ON 31
eH1_2                -6.401877e-02 1 1  ON 32
eH1_3                -2.669266e-02 1 1  ON 33
eH1_4                 1.878939e-02 1 1  ON 34
eH1_5                 3.146794e-02 1 1  ON 35
eH1_6                 7.771255e-02 1 1  ON 36
eH1_7                 1.090693e-01 1 1  ON 37
eH1_8                 1.002766e-01 1 1  ON 38
eH1_9                 2.728669e-02 1 1  ON 39
eH2_0                -1.851313e-01 1 1  ON 40
eH2_1                -1.062686e-01 1 1  ON 41
eH2_2                -6.452451e-02 1 1  ON 42
eH2_3                -2.737876e-02 1 1  ON 43
eH2_4                 1.762232e-02 1 1  ON 44
eH2_5                 3.021975e-02 1 1  ON 45
eH2_6                 7.594758e-02 1 1  ON 46
eH2_7                 1.132116e-01 1 1  ON 47
eH2_8                 1.041063e-01 1 1  ON 48
eH2_9                 2.922197e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4889e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2051
    reference variance = 0.244688
====================================================
  Execution time = 2.0824e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2054e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5493e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319930471729
                                         uncertainty =       0.005256883365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319930471729
                                         uncertainty =       0.005256883365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400335577
  error estimate for blocks of size 2^( 2) =       0.000409463492
  error estimate for blocks of size 2^( 3) =       0.000417956926
  error estimate for blocks of size 2^( 4) =       0.000424305040
  error estimate for blocks of size 2^( 5) =       0.000428521102
  error estimate for blocks of size 2^( 6) =       0.000430719881
  error estimate for blocks of size 2^( 7) =       0.000432552057

      target function =                  N/A
              le_mean =     -17.217413624872
             les_mean =     296.759868918623
             stat err =       0.000429024520
             autocorr =       1.148459948907
              std dev =       0.566160002963
             le_variance =       0.320537148955


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721741362487e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217413624872       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217413627402       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217413628220       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217413626776       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217413624929       residual = 8.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217413625181       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217413625095       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 8.574900e-07

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217413624872       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217413625505       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217413625710       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217413625349       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217413624886       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217413624950       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217413624928       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.144125e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217413624872       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217413625031       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217413625082       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217413624992       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217413624876       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217413624895       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217413624886       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 5.360562e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.206846 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6380e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.156922e-01 1 1  ON 0
 uu_1                 5.261291e-02 1 1  ON 1
 uu_2                -4.277980e-02 1 1  ON 2
 uu_3                -9.884165e-02 1 1  ON 3
 uu_4                -1.337047e-01 1 1  ON 4
 uu_5                -1.423959e-01 1 1  ON 5
 uu_6                -1.201248e-01 1 1  ON 6
 uu_7                -5.137339e-02 1 1  ON 7
 uu_8                 9.089380e-02 1 1  ON 8
 uu_9                 1.284449e-01 1 1  ON 9
 ud_0                 3.554772e-01 1 1  ON 10
 ud_1                 9.680438e-02 1 1  ON 11
 ud_2                -1.285820e-02 1 1  ON 12
 ud_3                -7.434251e-02 1 1  ON 13
 ud_4                -1.230079e-01 1 1  ON 14
 ud_5                -1.556254e-01 1 1  ON 15
 ud_6                -1.582970e-01 1 1  ON 16
 ud_7                -1.120615e-01 1 1  ON 17
 ud_8                -8.223937e-03 1 1  ON 18
 ud_9                 9.246271e-02 1 1  ON 19
 eO_0                -7.892131e-01 1 1  ON 20
 eO_1                -4.676566e-01 1 1  ON 21
 eO_2                -5.566599e-02 1 1  ON 22
 eO_3                 2.073246e-01 1 1  ON 23
 eO_4                 3.123462e-01 1 1  ON 24
 eO_5                 3.338809e-01 1 1  ON 25
 eO_6                 2.676166e-01 1 1  ON 26
 eO_7                 1.297924e-01 1 1  ON 27
 eO_8                 3.111662e-02 1 1  ON 28
 eO_9                 1.924224e-02 1 1  ON 29
eH1_0                -1.844716e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401881e-02 1 1  ON 32
eH1_3                -2.669270e-02 1 1  ON 33
eH1_4                 1.878937e-02 1 1  ON 34
eH1_5                 3.146804e-02 1 1  ON 35
eH1_6                 7.771257e-02 1 1  ON 36
eH1_7                 1.090693e-01 1 1  ON 37
eH1_8                 1.002766e-01 1 1  ON 38
eH1_9                 2.728672e-02 1 1  ON 39
eH2_0                -1.851314e-01 1 1  ON 40
eH2_1                -1.062686e-01 1 1  ON 41
eH2_2                -6.452460e-02 1 1  ON 42
eH2_3                -2.737881e-02 1 1  ON 43
eH2_4                 1.762233e-02 1 1  ON 44
eH2_5                 3.021980e-02 1 1  ON 45
eH2_6                 7.594755e-02 1 1  ON 46
eH2_7                 1.132116e-01 1 1  ON 47
eH2_8                 1.041063e-01 1 1  ON 48
eH2_9                 2.922199e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2352
    reference variance = 0.409706
====================================================
  Execution time = 2.1788e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2410e-01
  Total weights = 2.0000e+06
  Execution time = 1.8219e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324174832589
                                         uncertainty =       0.004995739164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324174832589
                                         uncertainty =       0.004995739164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402552748
  error estimate for blocks of size 2^( 2) =       0.000411896285
  error estimate for blocks of size 2^( 3) =       0.000420119415
  error estimate for blocks of size 2^( 4) =       0.000427003195
  error estimate for blocks of size 2^( 5) =       0.000430908640
  error estimate for blocks of size 2^( 6) =       0.000434502465
  error estimate for blocks of size 2^( 7) =       0.000434731915

      target function =                  N/A
              le_mean =     -17.216757786497
             les_mean =     296.740845947220
             stat err =       0.000431786554
             autocorr =       1.150515928034
              std dev =       0.569295556247
             le_variance =       0.324097430362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324174451088
                                         uncertainty =       0.004995763773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324174451088
                                         uncertainty =       0.004995763773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402552511
  error estimate for blocks of size 2^( 2) =       0.000411896049
  error estimate for blocks of size 2^( 3) =       0.000420119182
  error estimate for blocks of size 2^( 4) =       0.000427002960
  error estimate for blocks of size 2^( 5) =       0.000430908404
  error estimate for blocks of size 2^( 6) =       0.000434502219
  error estimate for blocks of size 2^( 7) =       0.000434731669

      target function =                  N/A
              le_mean =     -17.216757789751
             les_mean =     296.740845677783
             stat err =       0.000431786313
             autocorr =       1.150516000469
              std dev =       0.569295221199
             le_variance =       0.324097048880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324174641533
                                         uncertainty =       0.004995751488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324174641533
                                         uncertainty =       0.004995751488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402552630
  error estimate for blocks of size 2^( 2) =       0.000411896167
  error estimate for blocks of size 2^( 3) =       0.000420119298
  error estimate for blocks of size 2^( 4) =       0.000427003078
  error estimate for blocks of size 2^( 5) =       0.000430908522
  error estimate for blocks of size 2^( 6) =       0.000434502342
  error estimate for blocks of size 2^( 7) =       0.000434731792

      target function =                  N/A
              le_mean =     -17.216757788128
             les_mean =     296.740845812317
             stat err =       0.000431786433
             autocorr =       1.150515964343
              std dev =       0.569295388455
             le_variance =       0.324097239316

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324174808697
                                         uncertainty =       0.004995740705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324174808697
                                         uncertainty =       0.004995740705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402552733
  error estimate for blocks of size 2^( 2) =       0.000411896270
  error estimate for blocks of size 2^( 3) =       0.000420119400
  error estimate for blocks of size 2^( 4) =       0.000427003181
  error estimate for blocks of size 2^( 5) =       0.000430908625
  error estimate for blocks of size 2^( 6) =       0.000434502450
  error estimate for blocks of size 2^( 7) =       0.000434731899

      target function =                  N/A
              le_mean =     -17.216757786701
             les_mean =     296.740845930350
             stat err =       0.000431786539
             autocorr =       1.150515932572
              std dev =       0.569295535264
             le_variance =       0.324097406472


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216757786497        initial
     2.3842e+02     2.3842e+03             8.5749e-07       -17.216757789751  <--
     9.5367e+02     9.5367e+03             2.1441e-07       -17.216757788128
     3.8147e+03     3.8147e+04             5.3606e-08       -17.216757786701

*****************************************************************************
Applying the update for shift_i =   2.3842e+02     and shift_s =   2.3842e+03
*****************************************************************************

  Execution time = 3.0981e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.156918e-01 1 1  ON 0
 uu_1                 5.261293e-02 1 1  ON 1
 uu_2                -4.277966e-02 1 1  ON 2
 uu_3                -9.884159e-02 1 1  ON 3
 uu_4                -1.337046e-01 1 1  ON 4
 uu_5                -1.423957e-01 1 1  ON 5
 uu_6                -1.201249e-01 1 1  ON 6
 uu_7                -5.137361e-02 1 1  ON 7
 uu_8                 9.089363e-02 1 1  ON 8
 uu_9                 1.284452e-01 1 1  ON 9
 ud_0                 3.554770e-01 1 1  ON 10
 ud_1                 9.680463e-02 1 1  ON 11
 ud_2                -1.285821e-02 1 1  ON 12
 ud_3                -7.434230e-02 1 1  ON 13
 ud_4                -1.230079e-01 1 1  ON 14
 ud_5                -1.556255e-01 1 1  ON 15
 ud_6                -1.582971e-01 1 1  ON 16
 ud_7                -1.120617e-01 1 1  ON 17
 ud_8                -8.224252e-03 1 1  ON 18
 ud_9                 9.246274e-02 1 1  ON 19
 eO_0                -7.892136e-01 1 1  ON 20
 eO_1                -4.676566e-01 1 1  ON 21
 eO_2                -5.566618e-02 1 1  ON 22
 eO_3                 2.073239e-01 1 1  ON 23
 eO_4                 3.123463e-01 1 1  ON 24
 eO_5                 3.338812e-01 1 1  ON 25
 eO_6                 2.676169e-01 1 1  ON 26
 eO_7                 1.297928e-01 1 1  ON 27
 eO_8                 3.111668e-02 1 1  ON 28
 eO_9                 1.924228e-02 1 1  ON 29
eH1_0                -1.844716e-01 1 1  ON 30
eH1_1                -1.056884e-01 1 1  ON 31
eH1_2                -6.401890e-02 1 1  ON 32
eH1_3                -2.669281e-02 1 1  ON 33
eH1_4                 1.878931e-02 1 1  ON 34
eH1_5                 3.146834e-02 1 1  ON 35
eH1_6                 7.771263e-02 1 1  ON 36
eH1_7                 1.090693e-01 1 1  ON 37
eH1_8                 1.002768e-01 1 1  ON 38
eH1_9                 2.728682e-02 1 1  ON 39
eH2_0                -1.851314e-01 1 1  ON 40
eH2_1                -1.062685e-01 1 1  ON 41
eH2_2                -6.452487e-02 1 1  ON 42
eH2_3                -2.737895e-02 1 1  ON 43
eH2_4                 1.762235e-02 1 1  ON 44
eH2_5                 3.021995e-02 1 1  ON 45
eH2_6                 7.594744e-02 1 1  ON 46
eH2_7                 1.132116e-01 1 1  ON 47
eH2_8                 1.041066e-01 1 1  ON 48
eH2_9                 2.922207e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8330e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2554
    reference variance = 0.260546
====================================================
  Execution time = 2.0596e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2304e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5710e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323115141461
                                         uncertainty =       0.003663700426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323115141461
                                         uncertainty =       0.003663700426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401898705
  error estimate for blocks of size 2^( 2) =       0.000411120044
  error estimate for blocks of size 2^( 3) =       0.000419920248
  error estimate for blocks of size 2^( 4) =       0.000426252708
  error estimate for blocks of size 2^( 5) =       0.000430562670
  error estimate for blocks of size 2^( 6) =       0.000433418761
  error estimate for blocks of size 2^( 7) =       0.000434265791

      target function =                  N/A
              le_mean =     -17.216976981523
             les_mean =     296.747341358474
             stat err =       0.000431124983
             autocorr =       1.150729287561
              std dev =       0.568370598915
             le_variance =       0.323045137711


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721697698152e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216976981523       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216976983073       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216976985534       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216976982257       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216976983153       residual = 9.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216976987206       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216976987061       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 4.373077e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216976981523       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216976981912       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216976982529       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216976981707       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216976981934       residual = 9.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216976982953       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216976982919       residual = 4.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.094420e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216976981523       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216976981620       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216976981775       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216976981569       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216976981626       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216976981881       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216976981873       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.736771e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.209090 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6173e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.156919e-01 1 1  ON 0
 uu_1                 5.261312e-02 1 1  ON 1
 uu_2                -4.277966e-02 1 1  ON 2
 uu_3                -9.884160e-02 1 1  ON 3
 uu_4                -1.337048e-01 1 1  ON 4
 uu_5                -1.423963e-01 1 1  ON 5
 uu_6                -1.201251e-01 1 1  ON 6
 uu_7                -5.137350e-02 1 1  ON 7
 uu_8                 9.089354e-02 1 1  ON 8
 uu_9                 1.284454e-01 1 1  ON 9
 ud_0                 3.554766e-01 1 1  ON 10
 ud_1                 9.680466e-02 1 1  ON 11
 ud_2                -1.285813e-02 1 1  ON 12
 ud_3                -7.434188e-02 1 1  ON 13
 ud_4                -1.230078e-01 1 1  ON 14
 ud_5                -1.556253e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120619e-01 1 1  ON 17
 ud_8                -8.224516e-03 1 1  ON 18
 ud_9                 9.246276e-02 1 1  ON 19
 eO_0                -7.892141e-01 1 1  ON 20
 eO_1                -4.676566e-01 1 1  ON 21
 eO_2                -5.566661e-02 1 1  ON 22
 eO_3                 2.073228e-01 1 1  ON 23
 eO_4                 3.123466e-01 1 1  ON 24
 eO_5                 3.338818e-01 1 1  ON 25
 eO_6                 2.676174e-01 1 1  ON 26
 eO_7                 1.297934e-01 1 1  ON 27
 eO_8                 3.111681e-02 1 1  ON 28
 eO_9                 1.924230e-02 1 1  ON 29
eH1_0                -1.844717e-01 1 1  ON 30
eH1_1                -1.056886e-01 1 1  ON 31
eH1_2                -6.401925e-02 1 1  ON 32
eH1_3                -2.669310e-02 1 1  ON 33
eH1_4                 1.878943e-02 1 1  ON 34
eH1_5                 3.146841e-02 1 1  ON 35
eH1_6                 7.771260e-02 1 1  ON 36
eH1_7                 1.090694e-01 1 1  ON 37
eH1_8                 1.002772e-01 1 1  ON 38
eH1_9                 2.728695e-02 1 1  ON 39
eH2_0                -1.851315e-01 1 1  ON 40
eH2_1                -1.062682e-01 1 1  ON 41
eH2_2                -6.452537e-02 1 1  ON 42
eH2_3                -2.737911e-02 1 1  ON 43
eH2_4                 1.762231e-02 1 1  ON 44
eH2_5                 3.022034e-02 1 1  ON 45
eH2_6                 7.594709e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041069e-01 1 1  ON 48
eH2_9                 2.922220e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.179
    reference variance = 0.263216
====================================================
  Execution time = 2.0639e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3380e-01
  Total weights = 2.0000e+06
  Execution time = 1.8162e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333839953964
                                         uncertainty =       0.012058555855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333839953964
                                         uncertainty =       0.012058555855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408534067
  error estimate for blocks of size 2^( 2) =       0.000417823950
  error estimate for blocks of size 2^( 3) =       0.000426169776
  error estimate for blocks of size 2^( 4) =       0.000432107030
  error estimate for blocks of size 2^( 5) =       0.000435557286
  error estimate for blocks of size 2^( 6) =       0.000437591149
  error estimate for blocks of size 2^( 7) =       0.000437041857

      target function =                  N/A
              le_mean =     -17.216554393649
             les_mean =     296.743545189796
             stat err =       0.000435574331
             autocorr =       1.136757953903
              std dev =       0.577754417757
             le_variance =       0.333800167238

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333839114121
                                         uncertainty =       0.012058480527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333839114121
                                         uncertainty =       0.012058480527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408533553
  error estimate for blocks of size 2^( 2) =       0.000417823455
  error estimate for blocks of size 2^( 3) =       0.000426169296
  error estimate for blocks of size 2^( 4) =       0.000432106565
  error estimate for blocks of size 2^( 5) =       0.000435556808
  error estimate for blocks of size 2^( 6) =       0.000437590649
  error estimate for blocks of size 2^( 7) =       0.000437041307

      target function =                  N/A
              le_mean =     -17.216554390324
             les_mean =     296.743544236369
             stat err =       0.000435573832
             autocorr =       1.136758208386
              std dev =       0.577753691699
             le_variance =       0.333799328272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333839532289
                                         uncertainty =       0.012058518041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333839532289
                                         uncertainty =       0.012058518041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408533809
  error estimate for blocks of size 2^( 2) =       0.000417823701
  error estimate for blocks of size 2^( 3) =       0.000426169535
  error estimate for blocks of size 2^( 4) =       0.000432106796
  error estimate for blocks of size 2^( 5) =       0.000435557046
  error estimate for blocks of size 2^( 6) =       0.000437590898
  error estimate for blocks of size 2^( 7) =       0.000437041581

      target function =                  N/A
              le_mean =     -17.216554391974
             les_mean =     296.743544710897
             stat err =       0.000435574080
             autocorr =       1.136758081584
              std dev =       0.577754053213
             le_variance =       0.333799746004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333839901197
                                         uncertainty =       0.012058551124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333839901197
                                         uncertainty =       0.012058551124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408534034
  error estimate for blocks of size 2^( 2) =       0.000417823919
  error estimate for blocks of size 2^( 3) =       0.000426169745
  error estimate for blocks of size 2^( 4) =       0.000432107001
  error estimate for blocks of size 2^( 5) =       0.000435557256
  error estimate for blocks of size 2^( 6) =       0.000437591118
  error estimate for blocks of size 2^( 7) =       0.000437041822

      target function =                  N/A
              le_mean =     -17.216554393438
             les_mean =     296.743545129849
             stat err =       0.000435574299
             autocorr =       1.136757969885
              std dev =       0.577754372139
             le_variance =       0.333800114526


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216554393649        initial  <--
     5.9605e+01     5.9605e+02             4.3731e-06       -17.216554390324
     2.3842e+02     2.3842e+03             1.0944e-06       -17.216554391974
     9.5367e+02     9.5367e+03             2.7368e-07       -17.216554393438

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8235
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.156918e-01 1 1  ON 0
 uu_1                 5.261293e-02 1 1  ON 1
 uu_2                -4.277966e-02 1 1  ON 2
 uu_3                -9.884159e-02 1 1  ON 3
 uu_4                -1.337046e-01 1 1  ON 4
 uu_5                -1.423957e-01 1 1  ON 5
 uu_6                -1.201249e-01 1 1  ON 6
 uu_7                -5.137361e-02 1 1  ON 7
 uu_8                 9.089363e-02 1 1  ON 8
 uu_9                 1.284452e-01 1 1  ON 9
 ud_0                 3.554770e-01 1 1  ON 10
 ud_1                 9.680463e-02 1 1  ON 11
 ud_2                -1.285821e-02 1 1  ON 12
 ud_3                -7.434230e-02 1 1  ON 13
 ud_4                -1.230079e-01 1 1  ON 14
 ud_5                -1.556255e-01 1 1  ON 15
 ud_6                -1.582971e-01 1 1  ON 16
 ud_7                -1.120617e-01 1 1  ON 17
 ud_8                -8.224252e-03 1 1  ON 18
 ud_9                 9.246274e-02 1 1  ON 19
 eO_0                -7.892136e-01 1 1  ON 20
 eO_1                -4.676566e-01 1 1  ON 21
 eO_2                -5.566618e-02 1 1  ON 22
 eO_3                 2.073239e-01 1 1  ON 23
 eO_4                 3.123463e-01 1 1  ON 24
 eO_5                 3.338812e-01 1 1  ON 25
 eO_6                 2.676169e-01 1 1  ON 26
 eO_7                 1.297928e-01 1 1  ON 27
 eO_8                 3.111668e-02 1 1  ON 28
 eO_9                 1.924228e-02 1 1  ON 29
eH1_0                -1.844716e-01 1 1  ON 30
eH1_1                -1.056884e-01 1 1  ON 31
eH1_2                -6.401890e-02 1 1  ON 32
eH1_3                -2.669281e-02 1 1  ON 33
eH1_4                 1.878931e-02 1 1  ON 34
eH1_5                 3.146834e-02 1 1  ON 35
eH1_6                 7.771263e-02 1 1  ON 36
eH1_7                 1.090693e-01 1 1  ON 37
eH1_8                 1.002768e-01 1 1  ON 38
eH1_9                 2.728682e-02 1 1  ON 39
eH2_0                -1.851314e-01 1 1  ON 40
eH2_1                -1.062685e-01 1 1  ON 41
eH2_2                -6.452487e-02 1 1  ON 42
eH2_3                -2.737895e-02 1 1  ON 43
eH2_4                 1.762235e-02 1 1  ON 44
eH2_5                 3.021995e-02 1 1  ON 45
eH2_6                 7.594744e-02 1 1  ON 46
eH2_7                 1.132116e-01 1 1  ON 47
eH2_8                 1.041066e-01 1 1  ON 48
eH2_9                 2.922207e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6545e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.15
    reference variance = 0.271111
====================================================
  Execution time = 2.2683e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2057e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5151e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319965046602
                                         uncertainty =       0.003750107663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319965046602
                                         uncertainty =       0.003750107663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400355606
  error estimate for blocks of size 2^( 2) =       0.000410055207
  error estimate for blocks of size 2^( 3) =       0.000418701392
  error estimate for blocks of size 2^( 4) =       0.000425211640
  error estimate for blocks of size 2^( 5) =       0.000429145581
  error estimate for blocks of size 2^( 6) =       0.000432170093
  error estimate for blocks of size 2^( 7) =       0.000432729014

      target function =                  N/A
              le_mean =     -17.216942365242
             les_mean =     296.743673470987
             stat err =       0.000429814082
             autocorr =       1.152575677652
              std dev =       0.566188328381
             le_variance =       0.320569223194


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721694236524e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216942365242       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216942366013       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216942366525       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216942367460       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216942367034       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216942367070       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216942367274       residual = 6.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 3.459688e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216942365242       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216942365435       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216942365563       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216942365797       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216942365691       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216942365700       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216942365753       residual = 6.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 8.649482e-08

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216942365242       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216942365291       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216942365323       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216942365387       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216942365354       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216942365353       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216942365382       residual = 6.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.162387e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.211320 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8205e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.156918e-01 1 1  ON 0
 uu_1                 5.261292e-02 1 1  ON 1
 uu_2                -4.277965e-02 1 1  ON 2
 uu_3                -9.884157e-02 1 1  ON 3
 uu_4                -1.337046e-01 1 1  ON 4
 uu_5                -1.423957e-01 1 1  ON 5
 uu_6                -1.201249e-01 1 1  ON 6
 uu_7                -5.137364e-02 1 1  ON 7
 uu_8                 9.089361e-02 1 1  ON 8
 uu_9                 1.284452e-01 1 1  ON 9
 ud_0                 3.554771e-01 1 1  ON 10
 ud_1                 9.680462e-02 1 1  ON 11
 ud_2                -1.285818e-02 1 1  ON 12
 ud_3                -7.434232e-02 1 1  ON 13
 ud_4                -1.230079e-01 1 1  ON 14
 ud_5                -1.556255e-01 1 1  ON 15
 ud_6                -1.582972e-01 1 1  ON 16
 ud_7                -1.120617e-01 1 1  ON 17
 ud_8                -8.224287e-03 1 1  ON 18
 ud_9                 9.246274e-02 1 1  ON 19
 eO_0                -7.892136e-01 1 1  ON 20
 eO_1                -4.676566e-01 1 1  ON 21
 eO_2                -5.566625e-02 1 1  ON 22
 eO_3                 2.073238e-01 1 1  ON 23
 eO_4                 3.123463e-01 1 1  ON 24
 eO_5                 3.338813e-01 1 1  ON 25
 eO_6                 2.676170e-01 1 1  ON 26
 eO_7                 1.297929e-01 1 1  ON 27
 eO_8                 3.111669e-02 1 1  ON 28
 eO_9                 1.924228e-02 1 1  ON 29
eH1_0                -1.844716e-01 1 1  ON 30
eH1_1                -1.056885e-01 1 1  ON 31
eH1_2                -6.401891e-02 1 1  ON 32
eH1_3                -2.669283e-02 1 1  ON 33
eH1_4                 1.878931e-02 1 1  ON 34
eH1_5                 3.146836e-02 1 1  ON 35
eH1_6                 7.771261e-02 1 1  ON 36
eH1_7                 1.090693e-01 1 1  ON 37
eH1_8                 1.002768e-01 1 1  ON 38
eH1_9                 2.728683e-02 1 1  ON 39
eH2_0                -1.851314e-01 1 1  ON 40
eH2_1                -1.062685e-01 1 1  ON 41
eH2_2                -6.452489e-02 1 1  ON 42
eH2_3                -2.737899e-02 1 1  ON 43
eH2_4                 1.762242e-02 1 1  ON 44
eH2_5                 3.021994e-02 1 1  ON 45
eH2_6                 7.594742e-02 1 1  ON 46
eH2_7                 1.132116e-01 1 1  ON 47
eH2_8                 1.041066e-01 1 1  ON 48
eH2_9                 2.922208e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2037
    reference variance = 0.191839
====================================================
  Execution time = 1.9907e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1963e-01
  Total weights = 2.0000e+06
  Execution time = 1.8246e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319720830738
                                         uncertainty =       0.003372222295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319720830738
                                         uncertainty =       0.003372222295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399768797
  error estimate for blocks of size 2^( 2) =       0.000409254570
  error estimate for blocks of size 2^( 3) =       0.000417209075
  error estimate for blocks of size 2^( 4) =       0.000423245088
  error estimate for blocks of size 2^( 5) =       0.000426519798
  error estimate for blocks of size 2^( 6) =       0.000428783076
  error estimate for blocks of size 2^( 7) =       0.000432848556

      target function =                  N/A
              le_mean =     -17.217722380183
             les_mean =     296.769593982864
             stat err =       0.000427849130
             autocorr =       1.145416723926
              std dev =       0.565358454098
             le_variance =       0.319630181620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319720937206
                                         uncertainty =       0.003372222707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319720937206
                                         uncertainty =       0.003372222707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399768863
  error estimate for blocks of size 2^( 2) =       0.000409254635
  error estimate for blocks of size 2^( 3) =       0.000417209137
  error estimate for blocks of size 2^( 4) =       0.000423245148
  error estimate for blocks of size 2^( 5) =       0.000426519856
  error estimate for blocks of size 2^( 6) =       0.000428783130
  error estimate for blocks of size 2^( 7) =       0.000432848611

      target function =                  N/A
              le_mean =     -17.217722380975
             les_mean =     296.769594116584
             stat err =       0.000427849186
             autocorr =       1.145416645666
              std dev =       0.565358548232
             le_variance =       0.319630288059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319720883990
                                         uncertainty =       0.003372222501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319720883990
                                         uncertainty =       0.003372222501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399768830
  error estimate for blocks of size 2^( 2) =       0.000409254603
  error estimate for blocks of size 2^( 3) =       0.000417209106
  error estimate for blocks of size 2^( 4) =       0.000423245118
  error estimate for blocks of size 2^( 5) =       0.000426519827
  error estimate for blocks of size 2^( 6) =       0.000428783103
  error estimate for blocks of size 2^( 7) =       0.000432848584

      target function =                  N/A
              le_mean =     -17.217722380579
             les_mean =     296.769594049738
             stat err =       0.000427849158
             autocorr =       1.145416684794
              std dev =       0.565358501181
             le_variance =       0.319630234858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319720837395
                                         uncertainty =       0.003372222321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319720837395
                                         uncertainty =       0.003372222321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399768801
  error estimate for blocks of size 2^( 2) =       0.000409254574
  error estimate for blocks of size 2^( 3) =       0.000417209079
  error estimate for blocks of size 2^( 4) =       0.000423245092
  error estimate for blocks of size 2^( 5) =       0.000426519802
  error estimate for blocks of size 2^( 6) =       0.000428783079
  error estimate for blocks of size 2^( 7) =       0.000432848559

      target function =                  N/A
              le_mean =     -17.217722380233
             les_mean =     296.769593991223
             stat err =       0.000427849133
             autocorr =       1.145416719041
              std dev =       0.565358459984
             le_variance =       0.319630188276


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217722380183        initial
     5.9605e+02     5.9605e+03             3.4597e-07       -17.217722380975  <--
     2.3842e+03     2.3842e+04             8.6495e-08       -17.217722380579
     9.5367e+03     9.5367e+04             2.1624e-08       -17.217722380233

*****************************************************************************
Applying the update for shift_i =   5.9605e+02     and shift_s =   5.9605e+03
*****************************************************************************

  Execution time = 2.9109e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.156919e-01 1 1  ON 0
 uu_1                 5.261289e-02 1 1  ON 1
 uu_2                -4.277962e-02 1 1  ON 2
 uu_3                -9.884151e-02 1 1  ON 3
 uu_4                -1.337047e-01 1 1  ON 4
 uu_5                -1.423957e-01 1 1  ON 5
 uu_6                -1.201249e-01 1 1  ON 6
 uu_7                -5.137373e-02 1 1  ON 7
 uu_8                 9.089352e-02 1 1  ON 8
 uu_9                 1.284452e-01 1 1  ON 9
 ud_0                 3.554772e-01 1 1  ON 10
 ud_1                 9.680459e-02 1 1  ON 11
 ud_2                -1.285808e-02 1 1  ON 12
 ud_3                -7.434239e-02 1 1  ON 13
 ud_4                -1.230079e-01 1 1  ON 14
 ud_5                -1.556253e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120617e-01 1 1  ON 17
 ud_8                -8.224392e-03 1 1  ON 18
 ud_9                 9.246273e-02 1 1  ON 19
 eO_0                -7.892137e-01 1 1  ON 20
 eO_1                -4.676566e-01 1 1  ON 21
 eO_2                -5.566646e-02 1 1  ON 22
 eO_3                 2.073236e-01 1 1  ON 23
 eO_4                 3.123464e-01 1 1  ON 24
 eO_5                 3.338814e-01 1 1  ON 25
 eO_6                 2.676171e-01 1 1  ON 26
 eO_7                 1.297930e-01 1 1  ON 27
 eO_8                 3.111671e-02 1 1  ON 28
 eO_9                 1.924229e-02 1 1  ON 29
eH1_0                -1.844717e-01 1 1  ON 30
eH1_1                -1.056885e-01 1 1  ON 31
eH1_2                -6.401891e-02 1 1  ON 32
eH1_3                -2.669287e-02 1 1  ON 33
eH1_4                 1.878931e-02 1 1  ON 34
eH1_5                 3.146842e-02 1 1  ON 35
eH1_6                 7.771256e-02 1 1  ON 36
eH1_7                 1.090693e-01 1 1  ON 37
eH1_8                 1.002769e-01 1 1  ON 38
eH1_9                 2.728685e-02 1 1  ON 39
eH2_0                -1.851314e-01 1 1  ON 40
eH2_1                -1.062685e-01 1 1  ON 41
eH2_2                -6.452497e-02 1 1  ON 42
eH2_3                -2.737911e-02 1 1  ON 43
eH2_4                 1.762263e-02 1 1  ON 44
eH2_5                 3.021993e-02 1 1  ON 45
eH2_6                 7.594736e-02 1 1  ON 46
eH2_7                 1.132116e-01 1 1  ON 47
eH2_8                 1.041067e-01 1 1  ON 48
eH2_9                 2.922210e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7438e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1787
    reference variance = 0.588765
====================================================
  Execution time = 2.1308e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1871e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4589e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318571955408
                                         uncertainty =       0.005835190708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318571955408
                                         uncertainty =       0.005835190708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399190174
  error estimate for blocks of size 2^( 2) =       0.000409079497
  error estimate for blocks of size 2^( 3) =       0.000417740256
  error estimate for blocks of size 2^( 4) =       0.000423634885
  error estimate for blocks of size 2^( 5) =       0.000426181627
  error estimate for blocks of size 2^( 6) =       0.000428898487
  error estimate for blocks of size 2^( 7) =       0.000429887472

      target function =                  N/A
              le_mean =     -17.215947886681
             les_mean =     296.707567067777
             stat err =       0.000427150618
             autocorr =       1.144991841734
              std dev =       0.564540158189
             le_variance =       0.318705590208


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721594788668e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215947886681       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215947886383       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215947885352       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215947889601       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215947894107       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215947891677       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215947891621       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.284115e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215947886681       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215947886607       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215947886348       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215947887413       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215947888539       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215947887933       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215947887919       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 3.212488e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215947886681       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215947886663       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215947886598       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215947886864       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215947887146       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215947886994       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215947886990       residual = 4.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 8.032598e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213575 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6773e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.156919e-01 1 1  ON 0
 uu_1                 5.261293e-02 1 1  ON 1
 uu_2                -4.277954e-02 1 1  ON 2
 uu_3                -9.884145e-02 1 1  ON 3
 uu_4                -1.337048e-01 1 1  ON 4
 uu_5                -1.423958e-01 1 1  ON 5
 uu_6                -1.201250e-01 1 1  ON 6
 uu_7                -5.137377e-02 1 1  ON 7
 uu_8                 9.089340e-02 1 1  ON 8
 uu_9                 1.284453e-01 1 1  ON 9
 ud_0                 3.554771e-01 1 1  ON 10
 ud_1                 9.680462e-02 1 1  ON 11
 ud_2                -1.285798e-02 1 1  ON 12
 ud_3                -7.434233e-02 1 1  ON 13
 ud_4                -1.230078e-01 1 1  ON 14
 ud_5                -1.556255e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120618e-01 1 1  ON 17
 ud_8                -8.224540e-03 1 1  ON 18
 ud_9                 9.246277e-02 1 1  ON 19
 eO_0                -7.892139e-01 1 1  ON 20
 eO_1                -4.676569e-01 1 1  ON 21
 eO_2                -5.566661e-02 1 1  ON 22
 eO_3                 2.073235e-01 1 1  ON 23
 eO_4                 3.123465e-01 1 1  ON 24
 eO_5                 3.338816e-01 1 1  ON 25
 eO_6                 2.676173e-01 1 1  ON 26
 eO_7                 1.297932e-01 1 1  ON 27
 eO_8                 3.111672e-02 1 1  ON 28
 eO_9                 1.924231e-02 1 1  ON 29
eH1_0                -1.844719e-01 1 1  ON 30
eH1_1                -1.056884e-01 1 1  ON 31
eH1_2                -6.401881e-02 1 1  ON 32
eH1_3                -2.669318e-02 1 1  ON 33
eH1_4                 1.878947e-02 1 1  ON 34
eH1_5                 3.146848e-02 1 1  ON 35
eH1_6                 7.771247e-02 1 1  ON 36
eH1_7                 1.090693e-01 1 1  ON 37
eH1_8                 1.002770e-01 1 1  ON 38
eH1_9                 2.728689e-02 1 1  ON 39
eH2_0                -1.851316e-01 1 1  ON 40
eH2_1                -1.062685e-01 1 1  ON 41
eH2_2                -6.452494e-02 1 1  ON 42
eH2_3                -2.737920e-02 1 1  ON 43
eH2_4                 1.762270e-02 1 1  ON 44
eH2_5                 3.022000e-02 1 1  ON 45
eH2_6                 7.594723e-02 1 1  ON 46
eH2_7                 1.132116e-01 1 1  ON 47
eH2_8                 1.041068e-01 1 1  ON 48
eH2_9                 2.922214e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2541
    reference variance = 0.259161
====================================================
  Execution time = 2.0494e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1660e-01
  Total weights = 2.0000e+06
  Execution time = 1.8246e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316609364120
                                         uncertainty =       0.003276230014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316609364120
                                         uncertainty =       0.003276230014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397867372
  error estimate for blocks of size 2^( 2) =       0.000407287365
  error estimate for blocks of size 2^( 3) =       0.000415965202
  error estimate for blocks of size 2^( 4) =       0.000421727597
  error estimate for blocks of size 2^( 5) =       0.000425373509
  error estimate for blocks of size 2^( 6) =       0.000427164789
  error estimate for blocks of size 2^( 7) =       0.000430413114

      target function =                  N/A
              le_mean =     -17.216598156825
             les_mean =     296.727848826164
             stat err =       0.000426169752
             autocorr =       1.147330646519
              std dev =       0.562669433028
             le_variance =       0.316596890864

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316608716863
                                         uncertainty =       0.003276228924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316608716863
                                         uncertainty =       0.003276228924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397866965
  error estimate for blocks of size 2^( 2) =       0.000407286983
  error estimate for blocks of size 2^( 3) =       0.000415964838
  error estimate for blocks of size 2^( 4) =       0.000421727245
  error estimate for blocks of size 2^( 5) =       0.000425373154
  error estimate for blocks of size 2^( 6) =       0.000427164431
  error estimate for blocks of size 2^( 7) =       0.000430412768

      target function =                  N/A
              le_mean =     -17.216598160717
             les_mean =     296.727848313215
             stat err =       0.000426169399
             autocorr =       1.147331091587
              std dev =       0.562668858139
             le_variance =       0.316596243919

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316609039862
                                         uncertainty =       0.003276229467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316609039862
                                         uncertainty =       0.003276229467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397867168
  error estimate for blocks of size 2^( 2) =       0.000407287174
  error estimate for blocks of size 2^( 3) =       0.000415965020
  error estimate for blocks of size 2^( 4) =       0.000421727421
  error estimate for blocks of size 2^( 5) =       0.000425373331
  error estimate for blocks of size 2^( 6) =       0.000427164610
  error estimate for blocks of size 2^( 7) =       0.000430412940

      target function =                  N/A
              le_mean =     -17.216598158772
             les_mean =     296.727848569083
             stat err =       0.000426169576
             autocorr =       1.147330869498
              std dev =       0.562669145025
             le_variance =       0.316596566763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316609323568
                                         uncertainty =       0.003276229945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316609323568
                                         uncertainty =       0.003276229945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397867346
  error estimate for blocks of size 2^( 2) =       0.000407287341
  error estimate for blocks of size 2^( 3) =       0.000415965179
  error estimate for blocks of size 2^( 4) =       0.000421727575
  error estimate for blocks of size 2^( 5) =       0.000425373487
  error estimate for blocks of size 2^( 6) =       0.000427164767
  error estimate for blocks of size 2^( 7) =       0.000430413092

      target function =                  N/A
              le_mean =     -17.216598157068
             les_mean =     296.727848794006
             stat err =       0.000426169730
             autocorr =       1.147330674402
              std dev =       0.562669397009
             le_variance =       0.316596850331


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216598156825        initial
     1.4901e+02     1.4901e+03             1.2841e-06       -17.216598160717  <--
     5.9605e+02     5.9605e+03             3.2125e-07       -17.216598158772
     2.3842e+03     2.3842e+04             8.0326e-08       -17.216598157068

*****************************************************************************
Applying the update for shift_i =   1.4901e+02     and shift_s =   1.4901e+03
*****************************************************************************

  Execution time = 2.9707e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261306e-02 1 1  ON 1
 uu_2                -4.277932e-02 1 1  ON 2
 uu_3                -9.884127e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201253e-01 1 1  ON 6
 uu_7                -5.137388e-02 1 1  ON 7
 uu_8                 9.089305e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285767e-02 1 1  ON 12
 ud_3                -7.434213e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.224982e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892147e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566708e-02 1 1  ON 22
 eO_3                 2.073233e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676181e-01 1 1  ON 26
 eO_7                 1.297938e-01 1 1  ON 27
 eO_8                 3.111677e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844725e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401849e-02 1 1  ON 32
eH1_3                -2.669412e-02 1 1  ON 33
eH1_4                 1.878997e-02 1 1  ON 34
eH1_5                 3.146865e-02 1 1  ON 35
eH1_6                 7.771219e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728700e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452486e-02 1 1  ON 42
eH2_3                -2.737948e-02 1 1  ON 43
eH2_4                 1.762290e-02 1 1  ON 44
eH2_5                 3.022023e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6492e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2205
    reference variance = 0.346431
====================================================
  Execution time = 2.0697e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1723e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4918e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317247890597
                                         uncertainty =       0.003665453184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317247890597
                                         uncertainty =       0.003665453184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398264644
  error estimate for blocks of size 2^( 2) =       0.000407688393
  error estimate for blocks of size 2^( 3) =       0.000416491506
  error estimate for blocks of size 2^( 4) =       0.000422857091
  error estimate for blocks of size 2^( 5) =       0.000426856541
  error estimate for blocks of size 2^( 6) =       0.000429343156
  error estimate for blocks of size 2^( 7) =       0.000432812802

      target function =                  N/A
              le_mean =     -17.216352237886
             les_mean =     296.720013673184
             stat err =       0.000427967398
             autocorr =       1.154723130810
              std dev =       0.563231260520
             le_variance =       0.317229452826


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721635223789e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216352237886       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216352226183       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216352229021       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216352235152       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216352245212       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216352237294       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216352233591       residual = 7.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 4.755497e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216352237886       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216352234947       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216352235650       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216352237191       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216352239728       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216352237755       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216352236816       residual = 7.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.189862e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216352237886       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216352237151       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216352237326       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216352237712       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216352238347       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216352237855       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216352237619       residual = 7.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 2.975274e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.215745 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6195e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.156910e-01 1 1  ON 0
 uu_1                 5.261320e-02 1 1  ON 1
 uu_2                -4.277853e-02 1 1  ON 2
 uu_3                -9.884121e-02 1 1  ON 3
 uu_4                -1.337048e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201256e-01 1 1  ON 6
 uu_7                -5.137425e-02 1 1  ON 7
 uu_8                 9.089259e-02 1 1  ON 8
 uu_9                 1.284459e-01 1 1  ON 9
 ud_0                 3.554766e-01 1 1  ON 10
 ud_1                 9.680508e-02 1 1  ON 11
 ud_2                -1.285781e-02 1 1  ON 12
 ud_3                -7.434197e-02 1 1  ON 13
 ud_4                -1.230068e-01 1 1  ON 14
 ud_5                -1.556259e-01 1 1  ON 15
 ud_6                -1.582974e-01 1 1  ON 16
 ud_7                -1.120625e-01 1 1  ON 17
 ud_8                -8.225627e-03 1 1  ON 18
 ud_9                 9.246279e-02 1 1  ON 19
 eO_0                -7.892157e-01 1 1  ON 20
 eO_1                -4.676583e-01 1 1  ON 21
 eO_2                -5.566760e-02 1 1  ON 22
 eO_3                 2.073224e-01 1 1  ON 23
 eO_4                 3.123465e-01 1 1  ON 24
 eO_5                 3.338834e-01 1 1  ON 25
 eO_6                 2.676190e-01 1 1  ON 26
 eO_7                 1.297946e-01 1 1  ON 27
 eO_8                 3.111689e-02 1 1  ON 28
 eO_9                 1.924241e-02 1 1  ON 29
eH1_0                -1.844727e-01 1 1  ON 30
eH1_1                -1.056874e-01 1 1  ON 31
eH1_2                -6.401799e-02 1 1  ON 32
eH1_3                -2.669424e-02 1 1  ON 33
eH1_4                 1.878927e-02 1 1  ON 34
eH1_5                 3.146842e-02 1 1  ON 35
eH1_6                 7.771182e-02 1 1  ON 36
eH1_7                 1.090691e-01 1 1  ON 37
eH1_8                 1.002778e-01 1 1  ON 38
eH1_9                 2.728710e-02 1 1  ON 39
eH2_0                -1.851325e-01 1 1  ON 40
eH2_1                -1.062686e-01 1 1  ON 41
eH2_2                -6.452542e-02 1 1  ON 42
eH2_3                -2.737955e-02 1 1  ON 43
eH2_4                 1.762272e-02 1 1  ON 44
eH2_5                 3.022049e-02 1 1  ON 45
eH2_6                 7.594717e-02 1 1  ON 46
eH2_7                 1.132116e-01 1 1  ON 47
eH2_8                 1.041077e-01 1 1  ON 48
eH2_9                 2.922242e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2462
    reference variance = 0.18921
====================================================
  Execution time = 2.0426e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1757e-01
  Total weights = 2.0000e+06
  Execution time = 1.8259e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317644295956
                                         uncertainty =       0.003628584832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317644295956
                                         uncertainty =       0.003628584832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398478223
  error estimate for blocks of size 2^( 2) =       0.000408080757
  error estimate for blocks of size 2^( 3) =       0.000416386144
  error estimate for blocks of size 2^( 4) =       0.000423589363
  error estimate for blocks of size 2^( 5) =       0.000427989758
  error estimate for blocks of size 2^( 6) =       0.000429884897
  error estimate for blocks of size 2^( 7) =       0.000430644713

      target function =                  N/A
              le_mean =     -17.216509605777
             les_mean =     296.725772634869
             stat err =       0.000428027183
             autocorr =       1.153807925740
              std dev =       0.563533306767
             le_variance =       0.317569787836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317641676098
                                         uncertainty =       0.003628594928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317641676098
                                         uncertainty =       0.003628594928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398476579
  error estimate for blocks of size 2^( 2) =       0.000408079157
  error estimate for blocks of size 2^( 3) =       0.000416384585
  error estimate for blocks of size 2^( 4) =       0.000423587822
  error estimate for blocks of size 2^( 5) =       0.000427988221
  error estimate for blocks of size 2^( 6) =       0.000429883412
  error estimate for blocks of size 2^( 7) =       0.000430643266

      target function =                  N/A
              le_mean =     -17.216509567823
             les_mean =     296.725768708430
             stat err =       0.000428025680
             autocorr =       1.153809343188
              std dev =       0.563530982534
             le_variance =       0.317567168276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317642973142
                                         uncertainty =       0.003628589937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317642973142
                                         uncertainty =       0.003628589937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398477393
  error estimate for blocks of size 2^( 2) =       0.000408079949
  error estimate for blocks of size 2^( 3) =       0.000416385357
  error estimate for blocks of size 2^( 4) =       0.000423588585
  error estimate for blocks of size 2^( 5) =       0.000427988982
  error estimate for blocks of size 2^( 6) =       0.000429884147
  error estimate for blocks of size 2^( 7) =       0.000430643983

      target function =                  N/A
              le_mean =     -17.216509586580
             les_mean =     296.725770651207
             stat err =       0.000428026424
             autocorr =       1.153808641905
              std dev =       0.563532133222
             le_variance =       0.317568465174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317644130180
                                         uncertainty =       0.003628585472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317644130180
                                         uncertainty =       0.003628585472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398478119
  error estimate for blocks of size 2^( 2) =       0.000408080656
  error estimate for blocks of size 2^( 3) =       0.000416386045
  error estimate for blocks of size 2^( 4) =       0.000423589266
  error estimate for blocks of size 2^( 5) =       0.000427989661
  error estimate for blocks of size 2^( 6) =       0.000429884803
  error estimate for blocks of size 2^( 7) =       0.000430644621

      target function =                  N/A
              le_mean =     -17.216509603369
             les_mean =     296.725772386184
             stat err =       0.000428027088
             autocorr =       1.153808015488
              std dev =       0.563533159697
             le_variance =       0.317569622079


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216509605777        initial  <--
     3.7253e+01     3.7253e+02             4.7555e-06       -17.216509567823
     1.4901e+02     1.4901e+03             1.1899e-06       -17.216509586580
     5.9605e+02     5.9605e+03             2.9753e-07       -17.216509603369

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6591
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261306e-02 1 1  ON 1
 uu_2                -4.277932e-02 1 1  ON 2
 uu_3                -9.884127e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201253e-01 1 1  ON 6
 uu_7                -5.137388e-02 1 1  ON 7
 uu_8                 9.089305e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285767e-02 1 1  ON 12
 ud_3                -7.434213e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.224982e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892147e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566708e-02 1 1  ON 22
 eO_3                 2.073233e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676181e-01 1 1  ON 26
 eO_7                 1.297938e-01 1 1  ON 27
 eO_8                 3.111677e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844725e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401849e-02 1 1  ON 32
eH1_3                -2.669412e-02 1 1  ON 33
eH1_4                 1.878997e-02 1 1  ON 34
eH1_5                 3.146865e-02 1 1  ON 35
eH1_6                 7.771219e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728700e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452486e-02 1 1  ON 42
eH2_3                -2.737948e-02 1 1  ON 43
eH2_4                 1.762290e-02 1 1  ON 44
eH2_5                 3.022023e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5868e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2502
    reference variance = 0.194285
====================================================
  Execution time = 2.0523e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1514e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5895e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315261638475
                                         uncertainty =       0.002879236375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315261638475
                                         uncertainty =       0.002879236375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396953704
  error estimate for blocks of size 2^( 2) =       0.000406616332
  error estimate for blocks of size 2^( 3) =       0.000415560194
  error estimate for blocks of size 2^( 4) =       0.000421633265
  error estimate for blocks of size 2^( 5) =       0.000424903125
  error estimate for blocks of size 2^( 6) =       0.000427098696
  error estimate for blocks of size 2^( 7) =       0.000428720989

      target function =                  N/A
              le_mean =     -17.216543750741
             les_mean =     296.724523050207
             stat err =       0.000425589019
             autocorr =       1.149479179613
              std dev =       0.561377312143
             le_variance =       0.315144486589


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721654375074e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216543750741       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216543750982       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216543750931       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216543752239       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216543752607       residual = 9.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216543752434       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216543752402       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 4.822825e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216543750741       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216543750801       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216543750789       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216543751115       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216543751207       residual = 9.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216543751165       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216543751155       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.206234e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216543750741       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216543750756       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216543750753       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216543750835       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216543750859       residual = 9.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216543750851       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216543750845       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 3.015916e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.218077 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6118e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.156921e-01 1 1  ON 0
 uu_1                 5.261310e-02 1 1  ON 1
 uu_2                -4.277932e-02 1 1  ON 2
 uu_3                -9.884128e-02 1 1  ON 3
 uu_4                -1.337054e-01 1 1  ON 4
 uu_5                -1.423961e-01 1 1  ON 5
 uu_6                -1.201254e-01 1 1  ON 6
 uu_7                -5.137393e-02 1 1  ON 7
 uu_8                 9.089301e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285771e-02 1 1  ON 12
 ud_3                -7.434213e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.225032e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892148e-01 1 1  ON 20
 eO_1                -4.676580e-01 1 1  ON 21
 eO_2                -5.566716e-02 1 1  ON 22
 eO_3                 2.073232e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338823e-01 1 1  ON 25
 eO_6                 2.676182e-01 1 1  ON 26
 eO_7                 1.297939e-01 1 1  ON 27
 eO_8                 3.111679e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844725e-01 1 1  ON 30
eH1_1                -1.056880e-01 1 1  ON 31
eH1_2                -6.401853e-02 1 1  ON 32
eH1_3                -2.669418e-02 1 1  ON 33
eH1_4                 1.878987e-02 1 1  ON 34
eH1_5                 3.146865e-02 1 1  ON 35
eH1_6                 7.771222e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728702e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452485e-02 1 1  ON 42
eH2_3                -2.737952e-02 1 1  ON 43
eH2_4                 1.762296e-02 1 1  ON 44
eH2_5                 3.022017e-02 1 1  ON 45
eH2_6                 7.594679e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922227e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1888
    reference variance = 0.34212
====================================================
  Execution time = 2.0539e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1583e-01
  Total weights = 2.0000e+06
  Execution time = 1.8270e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315864942166
                                         uncertainty =       0.002659968340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315864942166
                                         uncertainty =       0.002659968340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397383933
  error estimate for blocks of size 2^( 2) =       0.000407241612
  error estimate for blocks of size 2^( 3) =       0.000415222447
  error estimate for blocks of size 2^( 4) =       0.000421196987
  error estimate for blocks of size 2^( 5) =       0.000424986049
  error estimate for blocks of size 2^( 6) =       0.000427781428
  error estimate for blocks of size 2^( 7) =       0.000428976871

      target function =                  N/A
              le_mean =     -17.217231629163
             les_mean =     296.748892795447
             stat err =       0.000425735333
             autocorr =       1.147780342664
              std dev =       0.561985748134
             le_variance =       0.315827981106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315865111707
                                         uncertainty =       0.002659968121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315865111707
                                         uncertainty =       0.002659968121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397384040
  error estimate for blocks of size 2^( 2) =       0.000407241716
  error estimate for blocks of size 2^( 3) =       0.000415222546
  error estimate for blocks of size 2^( 4) =       0.000421197082
  error estimate for blocks of size 2^( 5) =       0.000424986139
  error estimate for blocks of size 2^( 6) =       0.000427781525
  error estimate for blocks of size 2^( 7) =       0.000428976968

      target function =                  N/A
              le_mean =     -17.217231628375
             les_mean =     296.748892937889
             stat err =       0.000425735429
             autocorr =       1.147780239873
              std dev =       0.561985899022
             le_variance =       0.315828150700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315865026981
                                         uncertainty =       0.002659968231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315865026981
                                         uncertainty =       0.002659968231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397383987
  error estimate for blocks of size 2^( 2) =       0.000407241664
  error estimate for blocks of size 2^( 3) =       0.000415222496
  error estimate for blocks of size 2^( 4) =       0.000421197034
  error estimate for blocks of size 2^( 5) =       0.000424986094
  error estimate for blocks of size 2^( 6) =       0.000427781477
  error estimate for blocks of size 2^( 7) =       0.000428976920

      target function =                  N/A
              le_mean =     -17.217231628768
             les_mean =     296.748892866696
             stat err =       0.000425735381
             autocorr =       1.147780291230
              std dev =       0.561985823618
             le_variance =       0.315828065948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315864952769
                                         uncertainty =       0.002659968327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315864952769
                                         uncertainty =       0.002659968327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397383940
  error estimate for blocks of size 2^( 2) =       0.000407241618
  error estimate for blocks of size 2^( 3) =       0.000415222453
  error estimate for blocks of size 2^( 4) =       0.000421196993
  error estimate for blocks of size 2^( 5) =       0.000424986054
  error estimate for blocks of size 2^( 6) =       0.000427781434
  error estimate for blocks of size 2^( 7) =       0.000428976877

      target function =                  N/A
              le_mean =     -17.217231629114
             les_mean =     296.748892804354
             stat err =       0.000425735339
             autocorr =       1.147780336235
              std dev =       0.561985757571
             le_variance =       0.315827991713


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217231629163        initial  <--
     3.7253e+02     3.7253e+03             4.8228e-07       -17.217231628375
     1.4901e+03     1.4901e+04             1.2062e-07       -17.217231628768
     5.9605e+03     5.9605e+04             3.0159e-08       -17.217231629114

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7881
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261306e-02 1 1  ON 1
 uu_2                -4.277932e-02 1 1  ON 2
 uu_3                -9.884127e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201253e-01 1 1  ON 6
 uu_7                -5.137388e-02 1 1  ON 7
 uu_8                 9.089305e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285767e-02 1 1  ON 12
 ud_3                -7.434213e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.224982e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892147e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566708e-02 1 1  ON 22
 eO_3                 2.073233e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676181e-01 1 1  ON 26
 eO_7                 1.297938e-01 1 1  ON 27
 eO_8                 3.111677e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844725e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401849e-02 1 1  ON 32
eH1_3                -2.669412e-02 1 1  ON 33
eH1_4                 1.878997e-02 1 1  ON 34
eH1_5                 3.146865e-02 1 1  ON 35
eH1_6                 7.771219e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728700e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452486e-02 1 1  ON 42
eH2_3                -2.737948e-02 1 1  ON 43
eH2_4                 1.762290e-02 1 1  ON 44
eH2_5                 3.022023e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5935e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2767
    reference variance = 0.251806
====================================================
  Execution time = 2.0762e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1705e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5429e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317116231760
                                         uncertainty =       0.002843893555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317116231760
                                         uncertainty =       0.002843893555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398153244
  error estimate for blocks of size 2^( 2) =       0.000407654394
  error estimate for blocks of size 2^( 3) =       0.000416129800
  error estimate for blocks of size 2^( 4) =       0.000422327765
  error estimate for blocks of size 2^( 5) =       0.000425552194
  error estimate for blocks of size 2^( 6) =       0.000425161099
  error estimate for blocks of size 2^( 7) =       0.000427061324

      target function =                  N/A
              le_mean =     -17.217365505742
             les_mean =     296.754726811113
             stat err =       0.000425025595
             autocorr =       1.139540203383
              std dev =       0.563073717479
             le_variance =       0.317052011315


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721736550574e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217365505742       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217365505807       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217365505816       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217365505724       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217365505747       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217365505762       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217365505756       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 5.681681e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217365505742       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217365505758       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217365505761       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217365505738       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217365505737       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217365505727       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217365505743       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.420483e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217365505742       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217365505746       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217365505747       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217365505741       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217365505673       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217365505740       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217365505635       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 3.551247e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.220287 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6311e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261306e-02 1 1  ON 1
 uu_2                -4.277932e-02 1 1  ON 2
 uu_3                -9.884127e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201253e-01 1 1  ON 6
 uu_7                -5.137388e-02 1 1  ON 7
 uu_8                 9.089304e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285767e-02 1 1  ON 12
 ud_3                -7.434213e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.224988e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892147e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566709e-02 1 1  ON 22
 eO_3                 2.073233e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676181e-01 1 1  ON 26
 eO_7                 1.297938e-01 1 1  ON 27
 eO_8                 3.111677e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844725e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401849e-02 1 1  ON 32
eH1_3                -2.669412e-02 1 1  ON 33
eH1_4                 1.878997e-02 1 1  ON 34
eH1_5                 3.146865e-02 1 1  ON 35
eH1_6                 7.771219e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728700e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452486e-02 1 1  ON 42
eH2_3                -2.737948e-02 1 1  ON 43
eH2_4                 1.762290e-02 1 1  ON 44
eH2_5                 3.022024e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2457
    reference variance = 0.242192
====================================================
  Execution time = 2.0149e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2068e-01
  Total weights = 2.0000e+06
  Execution time = 1.8205e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320722053784
                                         uncertainty =       0.004505380053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320722053784
                                         uncertainty =       0.004505380053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400426765
  error estimate for blocks of size 2^( 2) =       0.000409783302
  error estimate for blocks of size 2^( 3) =       0.000418426197
  error estimate for blocks of size 2^( 4) =       0.000424639255
  error estimate for blocks of size 2^( 5) =       0.000427948191
  error estimate for blocks of size 2^( 6) =       0.000431295319
  error estimate for blocks of size 2^( 7) =       0.000433906617

      target function =                  N/A
              le_mean =     -17.216742283849
             les_mean =     296.736897896305
             stat err =       0.000429447345
             autocorr =       1.150200754093
              std dev =       0.566288961727
             le_variance =       0.320683188174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320722042451
                                         uncertainty =       0.004505379965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320722042451
                                         uncertainty =       0.004505379965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400426758
  error estimate for blocks of size 2^( 2) =       0.000409783295
  error estimate for blocks of size 2^( 3) =       0.000418426190
  error estimate for blocks of size 2^( 4) =       0.000424639249
  error estimate for blocks of size 2^( 5) =       0.000427948185
  error estimate for blocks of size 2^( 6) =       0.000431295312
  error estimate for blocks of size 2^( 7) =       0.000433906611

      target function =                  N/A
              le_mean =     -17.216742283802
             les_mean =     296.736897883325
             stat err =       0.000429447339
             autocorr =       1.150200761820
              std dev =       0.566288951708
             le_variance =       0.320683176827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320722048118
                                         uncertainty =       0.004505380009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320722048118
                                         uncertainty =       0.004505380009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400426761
  error estimate for blocks of size 2^( 2) =       0.000409783298
  error estimate for blocks of size 2^( 3) =       0.000418426194
  error estimate for blocks of size 2^( 4) =       0.000424639252
  error estimate for blocks of size 2^( 5) =       0.000427948188
  error estimate for blocks of size 2^( 6) =       0.000431295316
  error estimate for blocks of size 2^( 7) =       0.000433906614

      target function =                  N/A
              le_mean =     -17.216742283825
             les_mean =     296.736897889814
             stat err =       0.000429447342
             autocorr =       1.150200757951
              std dev =       0.566288956718
             le_variance =       0.320683182501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320722053076
                                         uncertainty =       0.004505380048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320722053076
                                         uncertainty =       0.004505380048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400426765
  error estimate for blocks of size 2^( 2) =       0.000409783301
  error estimate for blocks of size 2^( 3) =       0.000418426197
  error estimate for blocks of size 2^( 4) =       0.000424639254
  error estimate for blocks of size 2^( 5) =       0.000427948190
  error estimate for blocks of size 2^( 6) =       0.000431295318
  error estimate for blocks of size 2^( 7) =       0.000433906617

      target function =                  N/A
              le_mean =     -17.216742283846
             les_mean =     296.736897895493
             stat err =       0.000429447345
             autocorr =       1.150200754576
              std dev =       0.566288961101
             le_variance =       0.320683187465


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216742283849        initial  <--
     3.7253e+03     3.7253e+04             5.6817e-08       -17.216742283802
     1.4901e+04     1.4901e+05             1.4205e-08       -17.216742283825
     5.9605e+04     5.9605e+05             3.5512e-09       -17.216742283846

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3483
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261306e-02 1 1  ON 1
 uu_2                -4.277932e-02 1 1  ON 2
 uu_3                -9.884127e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201253e-01 1 1  ON 6
 uu_7                -5.137388e-02 1 1  ON 7
 uu_8                 9.089305e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285767e-02 1 1  ON 12
 ud_3                -7.434213e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.224982e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892147e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566708e-02 1 1  ON 22
 eO_3                 2.073233e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676181e-01 1 1  ON 26
 eO_7                 1.297938e-01 1 1  ON 27
 eO_8                 3.111677e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844725e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401849e-02 1 1  ON 32
eH1_3                -2.669412e-02 1 1  ON 33
eH1_4                 1.878997e-02 1 1  ON 34
eH1_5                 3.146865e-02 1 1  ON 35
eH1_6                 7.771219e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728700e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452486e-02 1 1  ON 42
eH2_3                -2.737948e-02 1 1  ON 43
eH2_4                 1.762290e-02 1 1  ON 44
eH2_5                 3.022023e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5696e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2703
    reference variance = 0.491611
====================================================
  Execution time = 2.0774e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1067e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5681e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310685517822
                                         uncertainty =       0.002484594798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310685517822
                                         uncertainty =       0.002484594798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394123852
  error estimate for blocks of size 2^( 2) =       0.000404010049
  error estimate for blocks of size 2^( 3) =       0.000413219483
  error estimate for blocks of size 2^( 4) =       0.000419668888
  error estimate for blocks of size 2^( 5) =       0.000424017912
  error estimate for blocks of size 2^( 6) =       0.000424732543
  error estimate for blocks of size 2^( 7) =       0.000424697352

      target function =                  N/A
              le_mean =     -17.216707881864
             les_mean =     296.725697355702
             stat err =       0.000423279174
             autocorr =       1.153422354484
              std dev =       0.557375296910
             le_variance =       0.310667221605


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721670788186e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216707881864       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216707881864       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216707881867       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216707881855       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216707881858       residual = 9.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216707881860       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216707881887       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 7.241029e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216707881864       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216707881864       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216707881865       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216707881857       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216707881845       residual = 9.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216707881819       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216707881869       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 1.810260e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216707881864       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216707881864       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216707881864       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216707881863       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216707882346       residual = 9.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216707881848       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216707882207       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 4.525650e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.222501 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6348e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261306e-02 1 1  ON 1
 uu_2                -4.277932e-02 1 1  ON 2
 uu_3                -9.884127e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201253e-01 1 1  ON 6
 uu_7                -5.137388e-02 1 1  ON 7
 uu_8                 9.089305e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285767e-02 1 1  ON 12
 ud_3                -7.434213e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.224982e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892147e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566708e-02 1 1  ON 22
 eO_3                 2.073233e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676181e-01 1 1  ON 26
 eO_7                 1.297938e-01 1 1  ON 27
 eO_8                 3.111677e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844725e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401849e-02 1 1  ON 32
eH1_3                -2.669412e-02 1 1  ON 33
eH1_4                 1.878997e-02 1 1  ON 34
eH1_5                 3.146865e-02 1 1  ON 35
eH1_6                 7.771219e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728700e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452486e-02 1 1  ON 42
eH2_3                -2.737948e-02 1 1  ON 43
eH2_4                 1.762290e-02 1 1  ON 44
eH2_5                 3.022024e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2698
    reference variance = 0.429522
====================================================
  Execution time = 2.2107e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1490e-01
  Total weights = 2.0000e+06
  Execution time = 1.8131e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314947159614
                                         uncertainty =       0.002196048589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314947159614
                                         uncertainty =       0.002196048589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396800832
  error estimate for blocks of size 2^( 2) =       0.000406640210
  error estimate for blocks of size 2^( 3) =       0.000415045692
  error estimate for blocks of size 2^( 4) =       0.000421340161
  error estimate for blocks of size 2^( 5) =       0.000424961962
  error estimate for blocks of size 2^( 6) =       0.000426730223
  error estimate for blocks of size 2^( 7) =       0.000426374303

      target function =                  N/A
              le_mean =     -17.217028178060
             les_mean =     296.740960927041
             stat err =       0.000424851662
             autocorr =       1.146382362319
              std dev =       0.561161118029
             le_variance =       0.314901800387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314947161120
                                         uncertainty =       0.002196048603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314947161120
                                         uncertainty =       0.002196048603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396800833
  error estimate for blocks of size 2^( 2) =       0.000406640211
  error estimate for blocks of size 2^( 3) =       0.000415045693
  error estimate for blocks of size 2^( 4) =       0.000421340162
  error estimate for blocks of size 2^( 5) =       0.000424961963
  error estimate for blocks of size 2^( 6) =       0.000426730224
  error estimate for blocks of size 2^( 7) =       0.000426374304

      target function =                  N/A
              le_mean =     -17.217028178064
             les_mean =     296.740960928688
             stat err =       0.000424851663
             autocorr =       1.146382361353
              std dev =       0.561161119371
             le_variance =       0.314901801893

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314947160367
                                         uncertainty =       0.002196048596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314947160367
                                         uncertainty =       0.002196048596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396800832
  error estimate for blocks of size 2^( 2) =       0.000406640210
  error estimate for blocks of size 2^( 3) =       0.000415045692
  error estimate for blocks of size 2^( 4) =       0.000421340162
  error estimate for blocks of size 2^( 5) =       0.000424961962
  error estimate for blocks of size 2^( 6) =       0.000426730223
  error estimate for blocks of size 2^( 7) =       0.000426374304

      target function =                  N/A
              le_mean =     -17.217028178062
             les_mean =     296.740960927865
             stat err =       0.000424851663
             autocorr =       1.146382361835
              std dev =       0.561161118700
             le_variance =       0.314901801140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314947159708
                                         uncertainty =       0.002196048590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314947159708
                                         uncertainty =       0.002196048590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396800832
  error estimate for blocks of size 2^( 2) =       0.000406640210
  error estimate for blocks of size 2^( 3) =       0.000415045692
  error estimate for blocks of size 2^( 4) =       0.000421340161
  error estimate for blocks of size 2^( 5) =       0.000424961962
  error estimate for blocks of size 2^( 6) =       0.000426730223
  error estimate for blocks of size 2^( 7) =       0.000426374303

      target function =                  N/A
              le_mean =     -17.217028178060
             les_mean =     296.740960927144
             stat err =       0.000424851662
             autocorr =       1.146382362254
              std dev =       0.561161118113
             le_variance =       0.314901800481


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217028178060        initial
     3.7253e+04     3.7253e+05             7.2410e-09       -17.217028178064  <--
     1.4901e+05     1.4901e+06             1.8103e-09       -17.217028178062
     5.9605e+05     5.9605e+06             4.5256e-10       -17.217028178060

*****************************************************************************
Applying the update for shift_i =   3.7253e+04     and shift_s =   3.7253e+05
*****************************************************************************

  Execution time = 3.1274e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261306e-02 1 1  ON 1
 uu_2                -4.277932e-02 1 1  ON 2
 uu_3                -9.884127e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201253e-01 1 1  ON 6
 uu_7                -5.137388e-02 1 1  ON 7
 uu_8                 9.089305e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285767e-02 1 1  ON 12
 ud_3                -7.434213e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.224985e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892147e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566708e-02 1 1  ON 22
 eO_3                 2.073233e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676181e-01 1 1  ON 26
 eO_7                 1.297938e-01 1 1  ON 27
 eO_8                 3.111677e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844725e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401849e-02 1 1  ON 32
eH1_3                -2.669412e-02 1 1  ON 33
eH1_4                 1.878997e-02 1 1  ON 34
eH1_5                 3.146865e-02 1 1  ON 35
eH1_6                 7.771219e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728700e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452486e-02 1 1  ON 42
eH2_3                -2.737948e-02 1 1  ON 43
eH2_4                 1.762290e-02 1 1  ON 44
eH2_5                 3.022024e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7665e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.3602
    reference variance = 0.634581
====================================================
  Execution time = 2.0389e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1898e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4699e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318998374269
                                         uncertainty =       0.003967280171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318998374269
                                         uncertainty =       0.003967280171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399361914
  error estimate for blocks of size 2^( 2) =       0.000409006388
  error estimate for blocks of size 2^( 3) =       0.000417739362
  error estimate for blocks of size 2^( 4) =       0.000424191724
  error estimate for blocks of size 2^( 5) =       0.000427587359
  error estimate for blocks of size 2^( 6) =       0.000427747447
  error estimate for blocks of size 2^( 7) =       0.000429976584

      target function =                  N/A
              le_mean =     -17.217515844597
             les_mean =     296.761831576249
             stat err =       0.000427375779
             autocorr =       1.145213661520
              std dev =       0.564783035149
             le_variance =       0.318979876792


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721751584460e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217515844597       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217515844655       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217515844705       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217515844728       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217515844785       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217515844785       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217515844765       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217515844744       residual = 2.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 2.359694e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217515844597       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217515844612       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217515844624       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217515844630       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217515844652       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217515844656       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217515844655       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217515844644       residual = 2.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 5.899336e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217515844597       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217515844601       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217515844604       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217515844580       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217515844608       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217515844675       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217515844759       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217515844508       residual = 2.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 1.474840e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.225127 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5866e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261306e-02 1 1  ON 1
 uu_2                -4.277932e-02 1 1  ON 2
 uu_3                -9.884127e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201253e-01 1 1  ON 6
 uu_7                -5.137388e-02 1 1  ON 7
 uu_8                 9.089304e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285767e-02 1 1  ON 12
 ud_3                -7.434213e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.224987e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892147e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566708e-02 1 1  ON 22
 eO_3                 2.073233e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676181e-01 1 1  ON 26
 eO_7                 1.297938e-01 1 1  ON 27
 eO_8                 3.111677e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844725e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401849e-02 1 1  ON 32
eH1_3                -2.669412e-02 1 1  ON 33
eH1_4                 1.878997e-02 1 1  ON 34
eH1_5                 3.146865e-02 1 1  ON 35
eH1_6                 7.771219e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728700e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452487e-02 1 1  ON 42
eH2_3                -2.737948e-02 1 1  ON 43
eH2_4                 1.762290e-02 1 1  ON 44
eH2_5                 3.022024e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2638
    reference variance = 0.354126
====================================================
  Execution time = 1.9928e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1483e-01
  Total weights = 2.0000e+06
  Execution time = 1.8169e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314876227863
                                         uncertainty =       0.003224046653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314876227863
                                         uncertainty =       0.003224046653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396758556
  error estimate for blocks of size 2^( 2) =       0.000406503357
  error estimate for blocks of size 2^( 3) =       0.000414925390
  error estimate for blocks of size 2^( 4) =       0.000420835844
  error estimate for blocks of size 2^( 5) =       0.000425117117
  error estimate for blocks of size 2^( 6) =       0.000426306589
  error estimate for blocks of size 2^( 7) =       0.000426666919

      target function =                  N/A
              le_mean =     -17.216187067467
             les_mean =     296.711931688007
             stat err =       0.000424731617
             autocorr =       1.145978792060
              std dev =       0.561101330792
             le_variance =       0.314834703417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314876221374
                                         uncertainty =       0.003224046533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314876221374
                                         uncertainty =       0.003224046533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396758552
  error estimate for blocks of size 2^( 2) =       0.000406503353
  error estimate for blocks of size 2^( 3) =       0.000414925386
  error estimate for blocks of size 2^( 4) =       0.000420835840
  error estimate for blocks of size 2^( 5) =       0.000425117113
  error estimate for blocks of size 2^( 6) =       0.000426306586
  error estimate for blocks of size 2^( 7) =       0.000426666915

      target function =                  N/A
              le_mean =     -17.216187067698
             les_mean =     296.711931689489
             stat err =       0.000424731613
             autocorr =       1.145978795957
              std dev =       0.561101325014
             le_variance =       0.314834696933

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314876224618
                                         uncertainty =       0.003224046593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314876224618
                                         uncertainty =       0.003224046593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396758554
  error estimate for blocks of size 2^( 2) =       0.000406503355
  error estimate for blocks of size 2^( 3) =       0.000414925388
  error estimate for blocks of size 2^( 4) =       0.000420835842
  error estimate for blocks of size 2^( 5) =       0.000425117115
  error estimate for blocks of size 2^( 6) =       0.000426306587
  error estimate for blocks of size 2^( 7) =       0.000426666917

      target function =                  N/A
              le_mean =     -17.216187067582
             les_mean =     296.711931688748
             stat err =       0.000424731615
             autocorr =       1.145978794014
              std dev =       0.561101327903
             le_variance =       0.314834700175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314876227457
                                         uncertainty =       0.003224046645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314876227457
                                         uncertainty =       0.003224046645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396758556
  error estimate for blocks of size 2^( 2) =       0.000406503356
  error estimate for blocks of size 2^( 3) =       0.000414925390
  error estimate for blocks of size 2^( 4) =       0.000420835843
  error estimate for blocks of size 2^( 5) =       0.000425117117
  error estimate for blocks of size 2^( 6) =       0.000426306589
  error estimate for blocks of size 2^( 7) =       0.000426666918

      target function =                  N/A
              le_mean =     -17.216187067481
             les_mean =     296.711931688100
             stat err =       0.000424731617
             autocorr =       1.145978792304
              std dev =       0.561101330431
             le_variance =       0.314834703012


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216187067467        initial
     9.3132e+03     9.3132e+04             2.3597e-08       -17.216187067698  <--
     3.7253e+04     3.7253e+05             5.8993e-09       -17.216187067582
     1.4901e+05     1.4901e+06             1.4748e-09       -17.216187067481

*****************************************************************************
Applying the update for shift_i =   9.3132e+03     and shift_s =   9.3132e+04
*****************************************************************************

  Execution time = 2.9110e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261307e-02 1 1  ON 1
 uu_2                -4.277932e-02 1 1  ON 2
 uu_3                -9.884127e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201253e-01 1 1  ON 6
 uu_7                -5.137388e-02 1 1  ON 7
 uu_8                 9.089304e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285767e-02 1 1  ON 12
 ud_3                -7.434212e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.224993e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892147e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566710e-02 1 1  ON 22
 eO_3                 2.073233e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676181e-01 1 1  ON 26
 eO_7                 1.297938e-01 1 1  ON 27
 eO_8                 3.111678e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844725e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401849e-02 1 1  ON 32
eH1_3                -2.669413e-02 1 1  ON 33
eH1_4                 1.878997e-02 1 1  ON 34
eH1_5                 3.146863e-02 1 1  ON 35
eH1_6                 7.771219e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728700e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452487e-02 1 1  ON 42
eH2_3                -2.737949e-02 1 1  ON 43
eH2_4                 1.762291e-02 1 1  ON 44
eH2_5                 3.022024e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5538e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1493
    reference variance = 0.201402
====================================================
  Execution time = 2.0275e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2329e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4387e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323247862001
                                         uncertainty =       0.005847935837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323247862001
                                         uncertainty =       0.005847935837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402051044
  error estimate for blocks of size 2^( 2) =       0.000411291996
  error estimate for blocks of size 2^( 3) =       0.000419959326
  error estimate for blocks of size 2^( 4) =       0.000426950862
  error estimate for blocks of size 2^( 5) =       0.000431966674
  error estimate for blocks of size 2^( 6) =       0.000434345902
  error estimate for blocks of size 2^( 7) =       0.000435989080

      target function =                  N/A
              le_mean =     -17.216739204733
             les_mean =     296.739398766712
             stat err =       0.000432313129
             autocorr =       1.156203983728
              std dev =       0.568586039735
             le_variance =       0.323290084581


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721673920473e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216739204733       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216739204955       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216739205142       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216739204980       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216739204889       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216739204953       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216739204956       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 7.331500e-08

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216739204733       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216739204788       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216739204835       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216739204796       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216739204772       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216739204790       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216739204782       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 1.832923e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216739204733       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216739204746       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216739204758       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216739204755       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216739204742       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216739204747       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216739204747       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 4.582337e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.227389 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5720e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261308e-02 1 1  ON 1
 uu_2                -4.277931e-02 1 1  ON 2
 uu_3                -9.884127e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201253e-01 1 1  ON 6
 uu_7                -5.137388e-02 1 1  ON 7
 uu_8                 9.089304e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285766e-02 1 1  ON 12
 ud_3                -7.434212e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.224997e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892147e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566711e-02 1 1  ON 22
 eO_3                 2.073233e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676181e-01 1 1  ON 26
 eO_7                 1.297939e-01 1 1  ON 27
 eO_8                 3.111678e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844725e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401849e-02 1 1  ON 32
eH1_3                -2.669413e-02 1 1  ON 33
eH1_4                 1.878996e-02 1 1  ON 34
eH1_5                 3.146863e-02 1 1  ON 35
eH1_6                 7.771218e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728701e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452489e-02 1 1  ON 42
eH2_3                -2.737950e-02 1 1  ON 43
eH2_4                 1.762292e-02 1 1  ON 44
eH2_5                 3.022024e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1595
    reference variance = 0.24668
====================================================
  Execution time = 2.0616e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2501e-01
  Total weights = 2.0000e+06
  Execution time = 1.8191e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325053313455
                                         uncertainty =       0.006600845215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325053313455
                                         uncertainty =       0.006600845215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403116795
  error estimate for blocks of size 2^( 2) =       0.000412428219
  error estimate for blocks of size 2^( 3) =       0.000420997698
  error estimate for blocks of size 2^( 4) =       0.000427071283
  error estimate for blocks of size 2^( 5) =       0.000430909971
  error estimate for blocks of size 2^( 6) =       0.000433665088
  error estimate for blocks of size 2^( 7) =       0.000434293252

      target function =                  N/A
              le_mean =     -17.216694899493
             les_mean =     296.739589400553
             stat err =       0.000431484898
             autocorr =       1.145696050183
              std dev =       0.570093238713
             le_variance =       0.325006300826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325053284243
                                         uncertainty =       0.006600844196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325053284243
                                         uncertainty =       0.006600844196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403116777
  error estimate for blocks of size 2^( 2) =       0.000412428201
  error estimate for blocks of size 2^( 3) =       0.000420997681
  error estimate for blocks of size 2^( 4) =       0.000427071267
  error estimate for blocks of size 2^( 5) =       0.000430909954
  error estimate for blocks of size 2^( 6) =       0.000433665069
  error estimate for blocks of size 2^( 7) =       0.000434293234

      target function =                  N/A
              le_mean =     -17.216694899550
             les_mean =     296.739589373277
             stat err =       0.000431484881
             autocorr =       1.145696061169
              std dev =       0.570093213071
             le_variance =       0.325006271590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325053298847
                                         uncertainty =       0.006600844705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325053298847
                                         uncertainty =       0.006600844705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403116786
  error estimate for blocks of size 2^( 2) =       0.000412428210
  error estimate for blocks of size 2^( 3) =       0.000420997689
  error estimate for blocks of size 2^( 4) =       0.000427071275
  error estimate for blocks of size 2^( 5) =       0.000430909963
  error estimate for blocks of size 2^( 6) =       0.000433665079
  error estimate for blocks of size 2^( 7) =       0.000434293243

      target function =                  N/A
              le_mean =     -17.216694899521
             les_mean =     296.739589386912
             stat err =       0.000431484890
             autocorr =       1.145696055677
              std dev =       0.570093225890
             le_variance =       0.325006286205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325053311629
                                         uncertainty =       0.006600845151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325053311629
                                         uncertainty =       0.006600845151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403116794
  error estimate for blocks of size 2^( 2) =       0.000412428217
  error estimate for blocks of size 2^( 3) =       0.000420997697
  error estimate for blocks of size 2^( 4) =       0.000427071282
  error estimate for blocks of size 2^( 5) =       0.000430909970
  error estimate for blocks of size 2^( 6) =       0.000433665087
  error estimate for blocks of size 2^( 7) =       0.000434293251

      target function =                  N/A
              le_mean =     -17.216694899497
             les_mean =     296.739589398848
             stat err =       0.000431484897
             autocorr =       1.145696050877
              std dev =       0.570093237110
             le_variance =       0.325006298999


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216694899493        initial
     2.3283e+03     2.3283e+04             7.3315e-08       -17.216694899550  <--
     9.3132e+03     9.3132e+04             1.8329e-08       -17.216694899521
     3.7253e+04     3.7253e+05             4.5823e-09       -17.216694899497

*****************************************************************************
Applying the update for shift_i =   2.3283e+03     and shift_s =   2.3283e+04
*****************************************************************************

  Execution time = 2.9796e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261309e-02 1 1  ON 1
 uu_2                -4.277930e-02 1 1  ON 2
 uu_3                -9.884128e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201254e-01 1 1  ON 6
 uu_7                -5.137389e-02 1 1  ON 7
 uu_8                 9.089303e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285764e-02 1 1  ON 12
 ud_3                -7.434211e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.225009e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892148e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566716e-02 1 1  ON 22
 eO_3                 2.073232e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676182e-01 1 1  ON 26
 eO_7                 1.297939e-01 1 1  ON 27
 eO_8                 3.111679e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844724e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401847e-02 1 1  ON 32
eH1_3                -2.669413e-02 1 1  ON 33
eH1_4                 1.878994e-02 1 1  ON 34
eH1_5                 3.146862e-02 1 1  ON 35
eH1_6                 7.771215e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728702e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452492e-02 1 1  ON 42
eH2_3                -2.737952e-02 1 1  ON 43
eH2_4                 1.762293e-02 1 1  ON 44
eH2_5                 3.022024e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922227e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5542e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.256
    reference variance = 0.191475
====================================================
  Execution time = 2.1051e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1767e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4850e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317672392142
                                         uncertainty =       0.003201792247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317672392142
                                         uncertainty =       0.003201792247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398539803
  error estimate for blocks of size 2^( 2) =       0.000408741824
  error estimate for blocks of size 2^( 3) =       0.000417717434
  error estimate for blocks of size 2^( 4) =       0.000424202382
  error estimate for blocks of size 2^( 5) =       0.000427189909
  error estimate for blocks of size 2^( 6) =       0.000428867781
  error estimate for blocks of size 2^( 7) =       0.000429623984

      target function =                  N/A
              le_mean =     -17.216500558413
             les_mean =     296.725559267915
             stat err =       0.000427471014
             autocorr =       1.150455803729
              std dev =       0.563620394328
             le_variance =       0.317667948903


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650055841e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216500558413       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216500558636       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216500559295       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216500559207       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216500559307       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216500559474       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216500559506       residual = 5.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 3.753065e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216500558413       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216500558469       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216500558634       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216500558612       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216500558637       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216500558678       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216500558686       residual = 5.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 9.384376e-08

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216500558413       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216500558427       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216500558468       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216500558463       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216500558470       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216500558483       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216500558482       residual = 5.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 2.346201e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.229572 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6543e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261313e-02 1 1  ON 1
 uu_2                -4.277929e-02 1 1  ON 2
 uu_3                -9.884127e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201254e-01 1 1  ON 6
 uu_7                -5.137391e-02 1 1  ON 7
 uu_8                 9.089299e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680477e-02 1 1  ON 11
 ud_2                -1.285764e-02 1 1  ON 12
 ud_3                -7.434207e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582974e-01 1 1  ON 16
 ud_7                -1.120622e-01 1 1  ON 17
 ud_8                -8.225051e-03 1 1  ON 18
 ud_9                 9.246286e-02 1 1  ON 19
 eO_0                -7.892149e-01 1 1  ON 20
 eO_1                -4.676580e-01 1 1  ON 21
 eO_2                -5.566722e-02 1 1  ON 22
 eO_3                 2.073232e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338823e-01 1 1  ON 25
 eO_6                 2.676182e-01 1 1  ON 26
 eO_7                 1.297940e-01 1 1  ON 27
 eO_8                 3.111679e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844725e-01 1 1  ON 30
eH1_1                -1.056880e-01 1 1  ON 31
eH1_2                -6.401844e-02 1 1  ON 32
eH1_3                -2.669412e-02 1 1  ON 33
eH1_4                 1.878990e-02 1 1  ON 34
eH1_5                 3.146859e-02 1 1  ON 35
eH1_6                 7.771212e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002775e-01 1 1  ON 38
eH1_9                 2.728703e-02 1 1  ON 39
eH2_0                -1.851322e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452494e-02 1 1  ON 42
eH2_3                -2.737952e-02 1 1  ON 43
eH2_4                 1.762295e-02 1 1  ON 44
eH2_5                 3.022027e-02 1 1  ON 45
eH2_6                 7.594682e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041073e-01 1 1  ON 48
eH2_9                 2.922228e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2169
    reference variance = 0.245061
====================================================
  Execution time = 2.0332e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1867e-01
  Total weights = 2.0000e+06
  Execution time = 1.8272e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318667943590
                                         uncertainty =       0.003624368078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318667943590
                                         uncertainty =       0.003624368078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399170454
  error estimate for blocks of size 2^( 2) =       0.000408612728
  error estimate for blocks of size 2^( 3) =       0.000417183524
  error estimate for blocks of size 2^( 4) =       0.000423335182
  error estimate for blocks of size 2^( 5) =       0.000427628583
  error estimate for blocks of size 2^( 6) =       0.000429942939
  error estimate for blocks of size 2^( 7) =       0.000430822508

      target function =                  N/A
              le_mean =     -17.217119651791
             les_mean =     296.747883047951
             stat err =       0.000427932303
             autocorr =       1.149299890762
              std dev =       0.564512270182
             le_variance =       0.318674103186

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318667973449
                                         uncertainty =       0.003624369123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318667973449
                                         uncertainty =       0.003624369123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399170473
  error estimate for blocks of size 2^( 2) =       0.000408612742
  error estimate for blocks of size 2^( 3) =       0.000417183537
  error estimate for blocks of size 2^( 4) =       0.000423335192
  error estimate for blocks of size 2^( 5) =       0.000427628595
  error estimate for blocks of size 2^( 6) =       0.000429942952
  error estimate for blocks of size 2^( 7) =       0.000430822519

      target function =                  N/A
              le_mean =     -17.217119651180
             les_mean =     296.747883056873
             stat err =       0.000427932315
             autocorr =       1.149299844817
              std dev =       0.564512296739
             le_variance =       0.318674133170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318667958524
                                         uncertainty =       0.003624368600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318667958524
                                         uncertainty =       0.003624368600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399170464
  error estimate for blocks of size 2^( 2) =       0.000408612735
  error estimate for blocks of size 2^( 3) =       0.000417183531
  error estimate for blocks of size 2^( 4) =       0.000423335187
  error estimate for blocks of size 2^( 5) =       0.000427628589
  error estimate for blocks of size 2^( 6) =       0.000429942945
  error estimate for blocks of size 2^( 7) =       0.000430822514

      target function =                  N/A
              le_mean =     -17.217119651486
             les_mean =     296.747883052417
             stat err =       0.000427932309
             autocorr =       1.149299867770
              std dev =       0.564512283465
             le_variance =       0.318674118182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318667945457
                                         uncertainty =       0.003624368143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318667945457
                                         uncertainty =       0.003624368143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399170455
  error estimate for blocks of size 2^( 2) =       0.000408612728
  error estimate for blocks of size 2^( 3) =       0.000417183525
  error estimate for blocks of size 2^( 4) =       0.000423335182
  error estimate for blocks of size 2^( 5) =       0.000427628584
  error estimate for blocks of size 2^( 6) =       0.000429942940
  error estimate for blocks of size 2^( 7) =       0.000430822509

      target function =                  N/A
              le_mean =     -17.217119651753
             les_mean =     296.747883048509
             stat err =       0.000427932304
             autocorr =       1.149299887891
              std dev =       0.564512271842
             le_variance =       0.318674105061


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217119651791        initial  <--
     5.8208e+02     5.8208e+03             3.7531e-07       -17.217119651180
     2.3283e+03     2.3283e+04             9.3844e-08       -17.217119651486
     9.3132e+03     9.3132e+04             2.3462e-08       -17.217119651753

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5653
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261309e-02 1 1  ON 1
 uu_2                -4.277930e-02 1 1  ON 2
 uu_3                -9.884128e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201254e-01 1 1  ON 6
 uu_7                -5.137389e-02 1 1  ON 7
 uu_8                 9.089303e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285764e-02 1 1  ON 12
 ud_3                -7.434211e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.225009e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892148e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566716e-02 1 1  ON 22
 eO_3                 2.073232e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676182e-01 1 1  ON 26
 eO_7                 1.297939e-01 1 1  ON 27
 eO_8                 3.111679e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844724e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401847e-02 1 1  ON 32
eH1_3                -2.669413e-02 1 1  ON 33
eH1_4                 1.878994e-02 1 1  ON 34
eH1_5                 3.146862e-02 1 1  ON 35
eH1_6                 7.771215e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728702e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452492e-02 1 1  ON 42
eH2_3                -2.737952e-02 1 1  ON 43
eH2_4                 1.762293e-02 1 1  ON 44
eH2_5                 3.022024e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922227e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6653e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2373
    reference variance = 0.182398
====================================================
  Execution time = 2.0262e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3572e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5220e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335835766833
                                         uncertainty =       0.016247477640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335835766833
                                         uncertainty =       0.016247477640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409704863
  error estimate for blocks of size 2^( 2) =       0.000418781247
  error estimate for blocks of size 2^( 3) =       0.000427271063
  error estimate for blocks of size 2^( 4) =       0.000433667884
  error estimate for blocks of size 2^( 5) =       0.000438097446
  error estimate for blocks of size 2^( 6) =       0.000439504501
  error estimate for blocks of size 2^( 7) =       0.000441836972

      target function =                  N/A
              le_mean =     -17.216651409824
             les_mean =     296.748801748436
             stat err =       0.000438276701
             autocorr =       1.144338554597
              std dev =       0.579410173267
             le_variance =       0.335716148886


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721665140982e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216651409824       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216651409750       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216651409660       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216651409721       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216651409790       residual = 9.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216651409779       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216651409772       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 4.312223e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216651409824       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216651409806       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216651409783       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216651409807       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216651409815       residual = 9.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216651409813       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216651409803       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 1.078083e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216651409824       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216651409820       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216651409814       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216651409818       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216651409812       residual = 9.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216651409818       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216651409833       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.695226e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.231799 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5790e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261309e-02 1 1  ON 1
 uu_2                -4.277930e-02 1 1  ON 2
 uu_3                -9.884129e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201254e-01 1 1  ON 6
 uu_7                -5.137388e-02 1 1  ON 7
 uu_8                 9.089303e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680474e-02 1 1  ON 11
 ud_2                -1.285764e-02 1 1  ON 12
 ud_3                -7.434211e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.225012e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892148e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566716e-02 1 1  ON 22
 eO_3                 2.073232e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338823e-01 1 1  ON 25
 eO_6                 2.676182e-01 1 1  ON 26
 eO_7                 1.297939e-01 1 1  ON 27
 eO_8                 3.111679e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844724e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401847e-02 1 1  ON 32
eH1_3                -2.669414e-02 1 1  ON 33
eH1_4                 1.878993e-02 1 1  ON 34
eH1_5                 3.146862e-02 1 1  ON 35
eH1_6                 7.771215e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002775e-01 1 1  ON 38
eH1_9                 2.728702e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452492e-02 1 1  ON 42
eH2_3                -2.737953e-02 1 1  ON 43
eH2_4                 1.762293e-02 1 1  ON 44
eH2_5                 3.022024e-02 1 1  ON 45
eH2_6                 7.594684e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922227e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2842
    reference variance = 0.288406
====================================================
  Execution time = 2.0096e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1272e-01
  Total weights = 2.0000e+06
  Execution time = 1.8184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312779027463
                                         uncertainty =       0.002779317608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312779027463
                                         uncertainty =       0.002779317608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395425121
  error estimate for blocks of size 2^( 2) =       0.000405065869
  error estimate for blocks of size 2^( 3) =       0.000413390507
  error estimate for blocks of size 2^( 4) =       0.000420135386
  error estimate for blocks of size 2^( 5) =       0.000423830745
  error estimate for blocks of size 2^( 6) =       0.000425317968
  error estimate for blocks of size 2^( 7) =       0.000429648974

      target function =                  N/A
              le_mean =     -17.216902351855
             les_mean =     296.734448489248
             stat err =       0.000424733268
             autocorr =       1.153729631172
              std dev =       0.559215568731
             le_variance =       0.312722052311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312779030073
                                         uncertainty =       0.002779317511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312779030073
                                         uncertainty =       0.002779317511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395425122
  error estimate for blocks of size 2^( 2) =       0.000405065870
  error estimate for blocks of size 2^( 3) =       0.000413390508
  error estimate for blocks of size 2^( 4) =       0.000420135387
  error estimate for blocks of size 2^( 5) =       0.000423830745
  error estimate for blocks of size 2^( 6) =       0.000425317968
  error estimate for blocks of size 2^( 7) =       0.000429648973

      target function =                  N/A
              le_mean =     -17.216902351813
             les_mean =     296.734448490436
             stat err =       0.000424733268
             autocorr =       1.153729621195
              std dev =       0.559215571060
             le_variance =       0.312722054916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312779028768
                                         uncertainty =       0.002779317560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312779028768
                                         uncertainty =       0.002779317560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395425122
  error estimate for blocks of size 2^( 2) =       0.000405065870
  error estimate for blocks of size 2^( 3) =       0.000413390508
  error estimate for blocks of size 2^( 4) =       0.000420135387
  error estimate for blocks of size 2^( 5) =       0.000423830745
  error estimate for blocks of size 2^( 6) =       0.000425317968
  error estimate for blocks of size 2^( 7) =       0.000429648973

      target function =                  N/A
              le_mean =     -17.216902351834
             les_mean =     296.734448489842
             stat err =       0.000424733268
             autocorr =       1.153729626194
              std dev =       0.559215569895
             le_variance =       0.312722053613

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312779027626
                                         uncertainty =       0.002779317602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312779027626
                                         uncertainty =       0.002779317602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395425121
  error estimate for blocks of size 2^( 2) =       0.000405065869
  error estimate for blocks of size 2^( 3) =       0.000413390507
  error estimate for blocks of size 2^( 4) =       0.000420135386
  error estimate for blocks of size 2^( 5) =       0.000423830745
  error estimate for blocks of size 2^( 6) =       0.000425317968
  error estimate for blocks of size 2^( 7) =       0.000429648973

      target function =                  N/A
              le_mean =     -17.216902351852
             les_mean =     296.734448489323
             stat err =       0.000424733268
             autocorr =       1.153729630550
              std dev =       0.559215568877
             le_variance =       0.312722052474


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216902351855        initial  <--
     5.8208e+03     5.8208e+04             4.3122e-08       -17.216902351813
     2.3283e+04     2.3283e+05             1.0781e-08       -17.216902351834
     9.3132e+04     9.3132e+05             2.6952e-09       -17.216902351852

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3000
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261309e-02 1 1  ON 1
 uu_2                -4.277930e-02 1 1  ON 2
 uu_3                -9.884128e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201254e-01 1 1  ON 6
 uu_7                -5.137389e-02 1 1  ON 7
 uu_8                 9.089303e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285764e-02 1 1  ON 12
 ud_3                -7.434211e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.225009e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892148e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566716e-02 1 1  ON 22
 eO_3                 2.073232e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676182e-01 1 1  ON 26
 eO_7                 1.297939e-01 1 1  ON 27
 eO_8                 3.111679e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844724e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401847e-02 1 1  ON 32
eH1_3                -2.669413e-02 1 1  ON 33
eH1_4                 1.878994e-02 1 1  ON 34
eH1_5                 3.146862e-02 1 1  ON 35
eH1_6                 7.771215e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728702e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452492e-02 1 1  ON 42
eH2_3                -2.737952e-02 1 1  ON 43
eH2_4                 1.762293e-02 1 1  ON 44
eH2_5                 3.022024e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922227e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5254e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1741
    reference variance = 0.22366
====================================================
  Execution time = 2.0223e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1331e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5984e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313402497593
                                         uncertainty =       0.002682417907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313402497593
                                         uncertainty =       0.002682417907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395798476
  error estimate for blocks of size 2^( 2) =       0.000405380359
  error estimate for blocks of size 2^( 3) =       0.000414129460
  error estimate for blocks of size 2^( 4) =       0.000421125577
  error estimate for blocks of size 2^( 5) =       0.000425289321
  error estimate for blocks of size 2^( 6) =       0.000428795100
  error estimate for blocks of size 2^( 7) =       0.000428932579

      target function =                  N/A
              le_mean =     -17.216519132903
             les_mean =     296.721843764858
             stat err =       0.000426035644
             autocorr =       1.158626975362
              std dev =       0.559743573334
             le_variance =       0.313312867889


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721651913290e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216519132903       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216519132908       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216519132918       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216519132913       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216519132880       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216519132886       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216519132920       residual = 5.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 3.676514e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216519132903       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216519132904       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216519132907       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216519132894       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216519132905       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216519133017       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216519132893       residual = 5.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 9.191302e-10

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216519132903       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216519132904       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216519132904       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216519132904       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216519133477       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216519132931       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216519133005       residual = 5.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 2.297825e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.234033 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5828e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261309e-02 1 1  ON 1
 uu_2                -4.277930e-02 1 1  ON 2
 uu_3                -9.884128e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201254e-01 1 1  ON 6
 uu_7                -5.137389e-02 1 1  ON 7
 uu_8                 9.089303e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285764e-02 1 1  ON 12
 ud_3                -7.434211e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.225010e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892148e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566716e-02 1 1  ON 22
 eO_3                 2.073232e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676182e-01 1 1  ON 26
 eO_7                 1.297939e-01 1 1  ON 27
 eO_8                 3.111679e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844724e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401847e-02 1 1  ON 32
eH1_3                -2.669413e-02 1 1  ON 33
eH1_4                 1.878994e-02 1 1  ON 34
eH1_5                 3.146862e-02 1 1  ON 35
eH1_6                 7.771215e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728702e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452492e-02 1 1  ON 42
eH2_3                -2.737952e-02 1 1  ON 43
eH2_4                 1.762293e-02 1 1  ON 44
eH2_5                 3.022024e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922227e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1664
    reference variance = 0.242583
====================================================
  Execution time = 2.2081e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2772e-01
  Total weights = 2.0000e+06
  Execution time = 1.8265e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327768131477
                                         uncertainty =       0.008700815087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327768131477
                                         uncertainty =       0.008700815087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404793617
  error estimate for blocks of size 2^( 2) =       0.000414278513
  error estimate for blocks of size 2^( 3) =       0.000422650805
  error estimate for blocks of size 2^( 4) =       0.000429494172
  error estimate for blocks of size 2^( 5) =       0.000433695317
  error estimate for blocks of size 2^( 6) =       0.000437106242
  error estimate for blocks of size 2^( 7) =       0.000437891118

      target function =                  N/A
              le_mean =     -17.216793249568
             les_mean =     296.745685379420
             stat err =       0.000434546712
             autocorr =       1.152406303717
              std dev =       0.572464623287
             le_variance =       0.327715744915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327768131177
                                         uncertainty =       0.008700815106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327768131177
                                         uncertainty =       0.008700815106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404793617
  error estimate for blocks of size 2^( 2) =       0.000414278513
  error estimate for blocks of size 2^( 3) =       0.000422650805
  error estimate for blocks of size 2^( 4) =       0.000429494171
  error estimate for blocks of size 2^( 5) =       0.000433695317
  error estimate for blocks of size 2^( 6) =       0.000437106242
  error estimate for blocks of size 2^( 7) =       0.000437891117

      target function =                  N/A
              le_mean =     -17.216793249566
             les_mean =     296.745685379074
             stat err =       0.000434546712
             autocorr =       1.152406303380
              std dev =       0.572464623024
             le_variance =       0.327715744614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327768131327
                                         uncertainty =       0.008700815096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327768131327
                                         uncertainty =       0.008700815096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404793617
  error estimate for blocks of size 2^( 2) =       0.000414278513
  error estimate for blocks of size 2^( 3) =       0.000422650805
  error estimate for blocks of size 2^( 4) =       0.000429494172
  error estimate for blocks of size 2^( 5) =       0.000433695317
  error estimate for blocks of size 2^( 6) =       0.000437106242
  error estimate for blocks of size 2^( 7) =       0.000437891118

      target function =                  N/A
              le_mean =     -17.216793249567
             les_mean =     296.745685379247
             stat err =       0.000434546712
             autocorr =       1.152406303551
              std dev =       0.572464623156
             le_variance =       0.327715744765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327768131458
                                         uncertainty =       0.008700815088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327768131458
                                         uncertainty =       0.008700815088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404793617
  error estimate for blocks of size 2^( 2) =       0.000414278513
  error estimate for blocks of size 2^( 3) =       0.000422650805
  error estimate for blocks of size 2^( 4) =       0.000429494172
  error estimate for blocks of size 2^( 5) =       0.000433695317
  error estimate for blocks of size 2^( 6) =       0.000437106242
  error estimate for blocks of size 2^( 7) =       0.000437891118

      target function =                  N/A
              le_mean =     -17.216793249568
             les_mean =     296.745685379399
             stat err =       0.000434546712
             autocorr =       1.152406303703
              std dev =       0.572464623271
             le_variance =       0.327715744897


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216793249568        initial  <--
     5.8208e+04     5.8208e+05             3.6765e-09       -17.216793249566
     2.3283e+05     2.3283e+06             9.1913e-10       -17.216793249567
     9.3132e+05     9.3132e+06             2.2978e-10       -17.216793249568

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.3101
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261309e-02 1 1  ON 1
 uu_2                -4.277930e-02 1 1  ON 2
 uu_3                -9.884128e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201254e-01 1 1  ON 6
 uu_7                -5.137389e-02 1 1  ON 7
 uu_8                 9.089303e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285764e-02 1 1  ON 12
 ud_3                -7.434211e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.225009e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892148e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566716e-02 1 1  ON 22
 eO_3                 2.073232e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676182e-01 1 1  ON 26
 eO_7                 1.297939e-01 1 1  ON 27
 eO_8                 3.111679e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844724e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401847e-02 1 1  ON 32
eH1_3                -2.669413e-02 1 1  ON 33
eH1_4                 1.878994e-02 1 1  ON 34
eH1_5                 3.146862e-02 1 1  ON 35
eH1_6                 7.771215e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728702e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452492e-02 1 1  ON 42
eH2_3                -2.737952e-02 1 1  ON 43
eH2_4                 1.762293e-02 1 1  ON 44
eH2_5                 3.022024e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922227e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7145e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1564
    reference variance = 0.493849
====================================================
  Execution time = 2.0573e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3660e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5056e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336668404285
                                         uncertainty =       0.014648132665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336668404285
                                         uncertainty =       0.014648132665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410246290
  error estimate for blocks of size 2^( 2) =       0.000419649213
  error estimate for blocks of size 2^( 3) =       0.000428198615
  error estimate for blocks of size 2^( 4) =       0.000434392993
  error estimate for blocks of size 2^( 5) =       0.000437872347
  error estimate for blocks of size 2^( 6) =       0.000440862739
  error estimate for blocks of size 2^( 7) =       0.000440031597

      target function =                  N/A
              le_mean =     -17.217109997745
             les_mean =     296.765480542735
             stat err =       0.000438289919
             autocorr =       1.141388886349
              std dev =       0.580175866955
             le_variance =       0.336604036597


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721710999774e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217109997745       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217109997745       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217109997745       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217109997619       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217109997946       residual = 8.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217109997565       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217109997690       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 3.343779e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217109997745       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217109997745       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217109997745       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217109997745       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217109997012       residual = 8.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217109997257       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217109997299       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 8.359458e-11

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217109997745       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217109997745       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217109997745       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217109997745       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217109998502       residual = 8.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217109998793       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217109999062       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 2.089861e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.236270 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6084e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261309e-02 1 1  ON 1
 uu_2                -4.277930e-02 1 1  ON 2
 uu_3                -9.884128e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201254e-01 1 1  ON 6
 uu_7                -5.137389e-02 1 1  ON 7
 uu_8                 9.089303e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285764e-02 1 1  ON 12
 ud_3                -7.434211e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.225009e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892148e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566716e-02 1 1  ON 22
 eO_3                 2.073232e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676182e-01 1 1  ON 26
 eO_7                 1.297939e-01 1 1  ON 27
 eO_8                 3.111679e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844724e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401847e-02 1 1  ON 32
eH1_3                -2.669413e-02 1 1  ON 33
eH1_4                 1.878994e-02 1 1  ON 34
eH1_5                 3.146862e-02 1 1  ON 35
eH1_6                 7.771215e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728702e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452492e-02 1 1  ON 42
eH2_3                -2.737952e-02 1 1  ON 43
eH2_4                 1.762293e-02 1 1  ON 44
eH2_5                 3.022024e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922227e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2245
    reference variance = 0.209373
====================================================
  Execution time = 1.9949e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2353e-01
  Total weights = 2.0000e+06
  Execution time = 1.8239e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323613291293
                                         uncertainty =       0.003990645657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323613291293
                                         uncertainty =       0.003990645657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402198520
  error estimate for blocks of size 2^( 2) =       0.000412085779
  error estimate for blocks of size 2^( 3) =       0.000421303642
  error estimate for blocks of size 2^( 4) =       0.000427729063
  error estimate for blocks of size 2^( 5) =       0.000432136797
  error estimate for blocks of size 2^( 6) =       0.000435023194
  error estimate for blocks of size 2^( 7) =       0.000437169657

      target function =                  N/A
              le_mean =     -17.216568900950
             les_mean =     296.733771858802
             stat err =       0.000433014678
             autocorr =       1.159109055383
              std dev =       0.568794602118
             le_variance =       0.323527299398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323613291406
                                         uncertainty =       0.003990645660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323613291406
                                         uncertainty =       0.003990645660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402198520
  error estimate for blocks of size 2^( 2) =       0.000412085779
  error estimate for blocks of size 2^( 3) =       0.000421303642
  error estimate for blocks of size 2^( 4) =       0.000427729063
  error estimate for blocks of size 2^( 5) =       0.000432136798
  error estimate for blocks of size 2^( 6) =       0.000435023194
  error estimate for blocks of size 2^( 7) =       0.000437169658

      target function =                  N/A
              le_mean =     -17.216568900948
             les_mean =     296.733771858841
             stat err =       0.000433014678
             autocorr =       1.159109055334
              std dev =       0.568794602217
             le_variance =       0.323527299512

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323613291350
                                         uncertainty =       0.003990645658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323613291350
                                         uncertainty =       0.003990645658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402198520
  error estimate for blocks of size 2^( 2) =       0.000412085779
  error estimate for blocks of size 2^( 3) =       0.000421303642
  error estimate for blocks of size 2^( 4) =       0.000427729063
  error estimate for blocks of size 2^( 5) =       0.000432136797
  error estimate for blocks of size 2^( 6) =       0.000435023194
  error estimate for blocks of size 2^( 7) =       0.000437169658

      target function =                  N/A
              le_mean =     -17.216568900949
             les_mean =     296.733771858822
             stat err =       0.000433014678
             autocorr =       1.159109055356
              std dev =       0.568794602168
             le_variance =       0.323527299455

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323613291300
                                         uncertainty =       0.003990645657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323613291300
                                         uncertainty =       0.003990645657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402198520
  error estimate for blocks of size 2^( 2) =       0.000412085779
  error estimate for blocks of size 2^( 3) =       0.000421303642
  error estimate for blocks of size 2^( 4) =       0.000427729063
  error estimate for blocks of size 2^( 5) =       0.000432136797
  error estimate for blocks of size 2^( 6) =       0.000435023194
  error estimate for blocks of size 2^( 7) =       0.000437169657

      target function =                  N/A
              le_mean =     -17.216568900950
             les_mean =     296.733771858804
             stat err =       0.000433014678
             autocorr =       1.159109055385
              std dev =       0.568794602124
             le_variance =       0.323527299405


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216568900950        initial  <--
     5.8208e+05     5.8208e+06             3.3438e-10       -17.216568900948
     2.3283e+06     2.3283e+07             8.3595e-11       -17.216568900949
     9.3132e+06     9.3132e+07             2.0899e-11       -17.216568900950

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1679
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261309e-02 1 1  ON 1
 uu_2                -4.277930e-02 1 1  ON 2
 uu_3                -9.884128e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201254e-01 1 1  ON 6
 uu_7                -5.137389e-02 1 1  ON 7
 uu_8                 9.089303e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285764e-02 1 1  ON 12
 ud_3                -7.434211e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.225009e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892148e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566716e-02 1 1  ON 22
 eO_3                 2.073232e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676182e-01 1 1  ON 26
 eO_7                 1.297939e-01 1 1  ON 27
 eO_8                 3.111679e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844724e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401847e-02 1 1  ON 32
eH1_3                -2.669413e-02 1 1  ON 33
eH1_4                 1.878994e-02 1 1  ON 34
eH1_5                 3.146862e-02 1 1  ON 35
eH1_6                 7.771215e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728702e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452492e-02 1 1  ON 42
eH2_3                -2.737952e-02 1 1  ON 43
eH2_4                 1.762293e-02 1 1  ON 44
eH2_5                 3.022024e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922227e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5330e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2768
    reference variance = 0.304044
====================================================
  Execution time = 2.0491e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1844e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5803e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318424989428
                                         uncertainty =       0.003126626451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318424989428
                                         uncertainty =       0.003126626451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399026955
  error estimate for blocks of size 2^( 2) =       0.000408689912
  error estimate for blocks of size 2^( 3) =       0.000416559427
  error estimate for blocks of size 2^( 4) =       0.000422753592
  error estimate for blocks of size 2^( 5) =       0.000426044473
  error estimate for blocks of size 2^( 6) =       0.000427425073
  error estimate for blocks of size 2^( 7) =       0.000428874777

      target function =                  N/A
              le_mean =     -17.216955371478
             les_mean =     296.741997126047
             stat err =       0.000426274479
             autocorr =       1.141232670936
              std dev =       0.564309331652
             le_variance =       0.318445021790


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721695537148e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216955371478       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216955371478       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216955371479       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216955371578       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216955371054       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216955372099       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216955376403       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 2.750802e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216955371478       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216955371478       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216955371478       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216955376391       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216955371300       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216955371478       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216955360488       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 6.876991e-12

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216955371478       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216955371478       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216955371478       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216955371549       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216955420297       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216955390185       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216955358527       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 1.719096e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.238514 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6078e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261309e-02 1 1  ON 1
 uu_2                -4.277930e-02 1 1  ON 2
 uu_3                -9.884128e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201254e-01 1 1  ON 6
 uu_7                -5.137389e-02 1 1  ON 7
 uu_8                 9.089303e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285764e-02 1 1  ON 12
 ud_3                -7.434211e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.225009e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892148e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566716e-02 1 1  ON 22
 eO_3                 2.073232e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676182e-01 1 1  ON 26
 eO_7                 1.297939e-01 1 1  ON 27
 eO_8                 3.111679e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844724e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401847e-02 1 1  ON 32
eH1_3                -2.669413e-02 1 1  ON 33
eH1_4                 1.878994e-02 1 1  ON 34
eH1_5                 3.146862e-02 1 1  ON 35
eH1_6                 7.771215e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728702e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452492e-02 1 1  ON 42
eH2_3                -2.737952e-02 1 1  ON 43
eH2_4                 1.762293e-02 1 1  ON 44
eH2_5                 3.022024e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922227e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2861
    reference variance = 0.523406
====================================================
  Execution time = 2.0050e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1757e-01
  Total weights = 2.0000e+06
  Execution time = 1.8285e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317607721599
                                         uncertainty =       0.002819285959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317607721599
                                         uncertainty =       0.002819285959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398475326
  error estimate for blocks of size 2^( 2) =       0.000408695469
  error estimate for blocks of size 2^( 3) =       0.000417318325
  error estimate for blocks of size 2^( 4) =       0.000424206624
  error estimate for blocks of size 2^( 5) =       0.000428252058
  error estimate for blocks of size 2^( 6) =       0.000431523555
  error estimate for blocks of size 2^( 7) =       0.000432807500

      target function =                  N/A
              le_mean =     -17.217423657547
             les_mean =     296.757242414935
             stat err =       0.000429197435
             autocorr =       1.160142578877
              std dev =       0.563529209752
             le_variance =       0.317565170244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317607721610
                                         uncertainty =       0.002819285959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317607721610
                                         uncertainty =       0.002819285959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398475326
  error estimate for blocks of size 2^( 2) =       0.000408695469
  error estimate for blocks of size 2^( 3) =       0.000417318325
  error estimate for blocks of size 2^( 4) =       0.000424206624
  error estimate for blocks of size 2^( 5) =       0.000428252058
  error estimate for blocks of size 2^( 6) =       0.000431523555
  error estimate for blocks of size 2^( 7) =       0.000432807500

      target function =                  N/A
              le_mean =     -17.217423657548
             les_mean =     296.757242414950
             stat err =       0.000429197435
             autocorr =       1.160142578872
              std dev =       0.563529209762
             le_variance =       0.317565170255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317607721605
                                         uncertainty =       0.002819285959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317607721605
                                         uncertainty =       0.002819285959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398475326
  error estimate for blocks of size 2^( 2) =       0.000408695469
  error estimate for blocks of size 2^( 3) =       0.000417318325
  error estimate for blocks of size 2^( 4) =       0.000424206624
  error estimate for blocks of size 2^( 5) =       0.000428252058
  error estimate for blocks of size 2^( 6) =       0.000431523555
  error estimate for blocks of size 2^( 7) =       0.000432807500

      target function =                  N/A
              le_mean =     -17.217423657547
             les_mean =     296.757242414942
             stat err =       0.000429197435
             autocorr =       1.160142578872
              std dev =       0.563529209757
             le_variance =       0.317565170249

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317607721600
                                         uncertainty =       0.002819285959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317607721600
                                         uncertainty =       0.002819285959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398475326
  error estimate for blocks of size 2^( 2) =       0.000408695469
  error estimate for blocks of size 2^( 3) =       0.000417318325
  error estimate for blocks of size 2^( 4) =       0.000424206624
  error estimate for blocks of size 2^( 5) =       0.000428252058
  error estimate for blocks of size 2^( 6) =       0.000431523555
  error estimate for blocks of size 2^( 7) =       0.000432807500

      target function =                  N/A
              le_mean =     -17.217423657547
             les_mean =     296.757242414936
             stat err =       0.000429197435
             autocorr =       1.160142578874
              std dev =       0.563529209753
             le_variance =       0.317565170245


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217423657547        initial
     5.8208e+06     5.8208e+07             2.7508e-11       -17.217423657548  <--
     2.3283e+07     2.3283e+08             6.8770e-12       -17.217423657547
     9.3132e+07     9.3132e+08             1.7191e-12       -17.217423657547

*****************************************************************************
Applying the update for shift_i =   5.8208e+06     and shift_s =   5.8208e+07
*****************************************************************************

  Execution time = 2.9292e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261309e-02 1 1  ON 1
 uu_2                -4.277930e-02 1 1  ON 2
 uu_3                -9.884128e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201254e-01 1 1  ON 6
 uu_7                -5.137389e-02 1 1  ON 7
 uu_8                 9.089303e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285764e-02 1 1  ON 12
 ud_3                -7.434211e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.225009e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892148e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566716e-02 1 1  ON 22
 eO_3                 2.073232e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676182e-01 1 1  ON 26
 eO_7                 1.297939e-01 1 1  ON 27
 eO_8                 3.111679e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844724e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401847e-02 1 1  ON 32
eH1_3                -2.669413e-02 1 1  ON 33
eH1_4                 1.878994e-02 1 1  ON 34
eH1_5                 3.146862e-02 1 1  ON 35
eH1_6                 7.771215e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728702e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452492e-02 1 1  ON 42
eH2_3                -2.737952e-02 1 1  ON 43
eH2_4                 1.762293e-02 1 1  ON 44
eH2_5                 3.022024e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922227e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5399e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1661
    reference variance = 0.135747
====================================================
  Execution time = 2.0291e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2307e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5611e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323069884806
                                         uncertainty =       0.009050445503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323069884806
                                         uncertainty =       0.009050445503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401915164
  error estimate for blocks of size 2^( 2) =       0.000411821471
  error estimate for blocks of size 2^( 3) =       0.000420236139
  error estimate for blocks of size 2^( 4) =       0.000426760788
  error estimate for blocks of size 2^( 5) =       0.000430226096
  error estimate for blocks of size 2^( 6) =       0.000433236979
  error estimate for blocks of size 2^( 7) =       0.000432590576

      target function =                  N/A
              le_mean =     -17.217509781421
             les_mean =     296.765714509393
             stat err =       0.000430703610
             autocorr =       1.148386925250
              std dev =       0.568393875420
             le_variance =       0.323071597615


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721750978142e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217509781421       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217509781421       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217509781421       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217509781421       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217509781421       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217509781541       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217509781346       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.928824e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217509781421       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217509781421       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217509781421       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217509781421       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217509781520       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217509783489       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217509783889       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 4.822044e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217509781421       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217509781421       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217509781421       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217509781421       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217509781421       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217509782196       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217509788197       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 1.205514e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.240737 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5858e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261309e-02 1 1  ON 1
 uu_2                -4.277930e-02 1 1  ON 2
 uu_3                -9.884128e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201254e-01 1 1  ON 6
 uu_7                -5.137389e-02 1 1  ON 7
 uu_8                 9.089303e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285764e-02 1 1  ON 12
 ud_3                -7.434211e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.225009e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892148e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566716e-02 1 1  ON 22
 eO_3                 2.073232e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676182e-01 1 1  ON 26
 eO_7                 1.297939e-01 1 1  ON 27
 eO_8                 3.111679e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844724e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401847e-02 1 1  ON 32
eH1_3                -2.669413e-02 1 1  ON 33
eH1_4                 1.878994e-02 1 1  ON 34
eH1_5                 3.146862e-02 1 1  ON 35
eH1_6                 7.771215e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728702e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452492e-02 1 1  ON 42
eH2_3                -2.737952e-02 1 1  ON 43
eH2_4                 1.762293e-02 1 1  ON 44
eH2_5                 3.022024e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922227e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1824
    reference variance = 0.549299
====================================================
  Execution time = 2.0273e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2496e-01
  Total weights = 2.0000e+06
  Execution time = 1.8199e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324831156469
                                         uncertainty =       0.005521915047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324831156469
                                         uncertainty =       0.005521915047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403085640
  error estimate for blocks of size 2^( 2) =       0.000412600880
  error estimate for blocks of size 2^( 3) =       0.000421798632
  error estimate for blocks of size 2^( 4) =       0.000427743717
  error estimate for blocks of size 2^( 5) =       0.000432490107
  error estimate for blocks of size 2^( 6) =       0.000435584198
  error estimate for blocks of size 2^( 7) =       0.000437371562

      target function =                  N/A
              le_mean =     -17.216201874419
             les_mean =     296.722562885371
             stat err =       0.000433297396
             autocorr =       1.155520098031
              std dev =       0.570049179535
             le_variance =       0.324956067088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324831156385
                                         uncertainty =       0.005521915039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324831156385
                                         uncertainty =       0.005521915039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403085640
  error estimate for blocks of size 2^( 2) =       0.000412600879
  error estimate for blocks of size 2^( 3) =       0.000421798632
  error estimate for blocks of size 2^( 4) =       0.000427743717
  error estimate for blocks of size 2^( 5) =       0.000432490107
  error estimate for blocks of size 2^( 6) =       0.000435584198
  error estimate for blocks of size 2^( 7) =       0.000437371562

      target function =                  N/A
              le_mean =     -17.216201874419
             les_mean =     296.722562885289
             stat err =       0.000433297396
             autocorr =       1.155520098079
              std dev =       0.570049179462
             le_variance =       0.324956067005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324831156427
                                         uncertainty =       0.005521915043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324831156427
                                         uncertainty =       0.005521915043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403085640
  error estimate for blocks of size 2^( 2) =       0.000412600879
  error estimate for blocks of size 2^( 3) =       0.000421798632
  error estimate for blocks of size 2^( 4) =       0.000427743717
  error estimate for blocks of size 2^( 5) =       0.000432490107
  error estimate for blocks of size 2^( 6) =       0.000435584198
  error estimate for blocks of size 2^( 7) =       0.000437371562

      target function =                  N/A
              le_mean =     -17.216201874419
             les_mean =     296.722562885330
             stat err =       0.000433297396
             autocorr =       1.155520098066
              std dev =       0.570049179498
             le_variance =       0.324956067047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324831156463
                                         uncertainty =       0.005521915047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324831156463
                                         uncertainty =       0.005521915047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403085640
  error estimate for blocks of size 2^( 2) =       0.000412600879
  error estimate for blocks of size 2^( 3) =       0.000421798632
  error estimate for blocks of size 2^( 4) =       0.000427743717
  error estimate for blocks of size 2^( 5) =       0.000432490107
  error estimate for blocks of size 2^( 6) =       0.000435584198
  error estimate for blocks of size 2^( 7) =       0.000437371562

      target function =                  N/A
              le_mean =     -17.216201874419
             les_mean =     296.722562885366
             stat err =       0.000433297396
             autocorr =       1.155520098037
              std dev =       0.570049179530
             le_variance =       0.324956067083


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216201874419        initial
     1.4552e+06     1.4552e+07             1.9288e-10       -17.216201874419  <--
     5.8208e+06     5.8208e+07             4.8220e-11       -17.216201874419
     2.3283e+07     2.3283e+08             1.2055e-11       -17.216201874419

*****************************************************************************
Applying the update for shift_i =   1.4552e+06     and shift_s =   1.4552e+07
*****************************************************************************

  Execution time = 2.9451e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261309e-02 1 1  ON 1
 uu_2                -4.277930e-02 1 1  ON 2
 uu_3                -9.884128e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201254e-01 1 1  ON 6
 uu_7                -5.137389e-02 1 1  ON 7
 uu_8                 9.089303e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285764e-02 1 1  ON 12
 ud_3                -7.434211e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.225009e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892148e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566716e-02 1 1  ON 22
 eO_3                 2.073232e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676182e-01 1 1  ON 26
 eO_7                 1.297939e-01 1 1  ON 27
 eO_8                 3.111679e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844724e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401847e-02 1 1  ON 32
eH1_3                -2.669413e-02 1 1  ON 33
eH1_4                 1.878994e-02 1 1  ON 34
eH1_5                 3.146862e-02 1 1  ON 35
eH1_6                 7.771215e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728702e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452492e-02 1 1  ON 42
eH2_3                -2.737952e-02 1 1  ON 43
eH2_4                 1.762293e-02 1 1  ON 44
eH2_5                 3.022024e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922227e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5408e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.199
    reference variance = 0.343398
====================================================
  Execution time = 2.1035e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2269e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5618e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322705652462
                                         uncertainty =       0.006266098382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322705652462
                                         uncertainty =       0.006266098382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401677394
  error estimate for blocks of size 2^( 2) =       0.000410963739
  error estimate for blocks of size 2^( 3) =       0.000419908380
  error estimate for blocks of size 2^( 4) =       0.000426511133
  error estimate for blocks of size 2^( 5) =       0.000430387702
  error estimate for blocks of size 2^( 6) =       0.000431676105
  error estimate for blocks of size 2^( 7) =       0.000433614557

      target function =                  N/A
              le_mean =     -17.216863752309
             les_mean =     296.743086761773
             stat err =       0.000430547374
             autocorr =       1.148912906889
              std dev =       0.568057618159
             le_variance =       0.322689457548


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721686375231e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216863752309       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216863752309       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216863752309       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216863752256       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216863752351       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216863752232       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216863752563       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 4.510567e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216863752309       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216863752309       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216863752309       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216863753882       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216863752811       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216863752360       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216863751744       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.127636e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216863752309       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216863752309       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216863752309       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216863756998       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216863752974       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216863751737       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216863754804       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 2.819073e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.242954 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6602e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261309e-02 1 1  ON 1
 uu_2                -4.277930e-02 1 1  ON 2
 uu_3                -9.884128e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201254e-01 1 1  ON 6
 uu_7                -5.137389e-02 1 1  ON 7
 uu_8                 9.089303e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285764e-02 1 1  ON 12
 ud_3                -7.434211e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.225009e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892148e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566716e-02 1 1  ON 22
 eO_3                 2.073232e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676182e-01 1 1  ON 26
 eO_7                 1.297939e-01 1 1  ON 27
 eO_8                 3.111679e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844724e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401847e-02 1 1  ON 32
eH1_3                -2.669413e-02 1 1  ON 33
eH1_4                 1.878994e-02 1 1  ON 34
eH1_5                 3.146862e-02 1 1  ON 35
eH1_6                 7.771215e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728702e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452492e-02 1 1  ON 42
eH2_3                -2.737952e-02 1 1  ON 43
eH2_4                 1.762293e-02 1 1  ON 44
eH2_5                 3.022024e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922227e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2127
    reference variance = 0.26385
====================================================
  Execution time = 2.0073e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1699e-01
  Total weights = 2.0000e+06
  Execution time = 1.8169e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317066538217
                                         uncertainty =       0.003252168704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317066538217
                                         uncertainty =       0.003252168704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398117283
  error estimate for blocks of size 2^( 2) =       0.000408074127
  error estimate for blocks of size 2^( 3) =       0.000417006793
  error estimate for blocks of size 2^( 4) =       0.000423339879
  error estimate for blocks of size 2^( 5) =       0.000427201294
  error estimate for blocks of size 2^( 6) =       0.000429422830
  error estimate for blocks of size 2^( 7) =       0.000429989931

      target function =                  N/A
              le_mean =     -17.216766368454
             les_mean =     296.734038769447
             stat err =       0.000427488483
             autocorr =       1.152993278932
              std dev =       0.563022861000
             le_variance =       0.316994742008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317066538459
                                         uncertainty =       0.003252168705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317066538459
                                         uncertainty =       0.003252168705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398117283
  error estimate for blocks of size 2^( 2) =       0.000408074127
  error estimate for blocks of size 2^( 3) =       0.000417006793
  error estimate for blocks of size 2^( 4) =       0.000423339879
  error estimate for blocks of size 2^( 5) =       0.000427201294
  error estimate for blocks of size 2^( 6) =       0.000429422830
  error estimate for blocks of size 2^( 7) =       0.000429989931

      target function =                  N/A
              le_mean =     -17.216766368454
             les_mean =     296.734038769683
             stat err =       0.000427488484
             autocorr =       1.152993278722
              std dev =       0.563022861215
             le_variance =       0.316994742250

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317066538338
                                         uncertainty =       0.003252168704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317066538338
                                         uncertainty =       0.003252168704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398117283
  error estimate for blocks of size 2^( 2) =       0.000408074127
  error estimate for blocks of size 2^( 3) =       0.000417006793
  error estimate for blocks of size 2^( 4) =       0.000423339879
  error estimate for blocks of size 2^( 5) =       0.000427201294
  error estimate for blocks of size 2^( 6) =       0.000429422830
  error estimate for blocks of size 2^( 7) =       0.000429989931

      target function =                  N/A
              le_mean =     -17.216766368454
             les_mean =     296.734038769565
             stat err =       0.000427488484
             autocorr =       1.152993278831
              std dev =       0.563022861107
             le_variance =       0.316994742129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317066538232
                                         uncertainty =       0.003252168704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317066538232
                                         uncertainty =       0.003252168704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398117283
  error estimate for blocks of size 2^( 2) =       0.000408074127
  error estimate for blocks of size 2^( 3) =       0.000417006793
  error estimate for blocks of size 2^( 4) =       0.000423339879
  error estimate for blocks of size 2^( 5) =       0.000427201294
  error estimate for blocks of size 2^( 6) =       0.000429422830
  error estimate for blocks of size 2^( 7) =       0.000429989931

      target function =                  N/A
              le_mean =     -17.216766368454
             les_mean =     296.734038769461
             stat err =       0.000427488483
             autocorr =       1.152993278920
              std dev =       0.563022861013
             le_variance =       0.316994742023


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216766368454        initial  <--
     3.6380e+05     3.6380e+06             4.5106e-10       -17.216766368454
     1.4552e+06     1.4552e+07             1.1276e-10       -17.216766368454
     5.8208e+06     5.8208e+07             2.8191e-11       -17.216766368454

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2530
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261309e-02 1 1  ON 1
 uu_2                -4.277930e-02 1 1  ON 2
 uu_3                -9.884128e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201254e-01 1 1  ON 6
 uu_7                -5.137389e-02 1 1  ON 7
 uu_8                 9.089303e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285764e-02 1 1  ON 12
 ud_3                -7.434211e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.225009e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892148e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566716e-02 1 1  ON 22
 eO_3                 2.073232e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676182e-01 1 1  ON 26
 eO_7                 1.297939e-01 1 1  ON 27
 eO_8                 3.111679e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844724e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401847e-02 1 1  ON 32
eH1_3                -2.669413e-02 1 1  ON 33
eH1_4                 1.878994e-02 1 1  ON 34
eH1_5                 3.146862e-02 1 1  ON 35
eH1_6                 7.771215e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728702e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452492e-02 1 1  ON 42
eH2_3                -2.737952e-02 1 1  ON 43
eH2_4                 1.762293e-02 1 1  ON 44
eH2_5                 3.022024e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922227e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5895e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.3546
    reference variance = 0.763821
====================================================
  Execution time = 2.0484e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1815e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5878e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318185883186
                                         uncertainty =       0.004179397984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318185883186
                                         uncertainty =       0.004179397984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398845263
  error estimate for blocks of size 2^( 2) =       0.000407825059
  error estimate for blocks of size 2^( 3) =       0.000416270224
  error estimate for blocks of size 2^( 4) =       0.000422764907
  error estimate for blocks of size 2^( 5) =       0.000426504114
  error estimate for blocks of size 2^( 6) =       0.000428765080
  error estimate for blocks of size 2^( 7) =       0.000430310981

      target function =                  N/A
              le_mean =     -17.216766218932
             les_mean =     296.735193965837
             stat err =       0.000427086271
             autocorr =       1.146627476998
              std dev =       0.564052380155
             le_variance =       0.318155087558


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721676621893e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216766218932       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216766218932       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216766218932       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216766218195       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216766217925       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216766218642       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216766221474       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+06 is 4.879592e-11

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216766218932       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216766218932       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216766218932       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216766218932       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216766221060       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216766222510       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216766219658       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 1.219887e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216766218932       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216766218932       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216766218932       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216766222278       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216766213954       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216766227013       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216766187272       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 3.049699e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.245184 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6077e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261309e-02 1 1  ON 1
 uu_2                -4.277930e-02 1 1  ON 2
 uu_3                -9.884128e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201254e-01 1 1  ON 6
 uu_7                -5.137389e-02 1 1  ON 7
 uu_8                 9.089303e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285764e-02 1 1  ON 12
 ud_3                -7.434211e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.225009e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892148e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566716e-02 1 1  ON 22
 eO_3                 2.073232e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676182e-01 1 1  ON 26
 eO_7                 1.297939e-01 1 1  ON 27
 eO_8                 3.111679e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844724e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401847e-02 1 1  ON 32
eH1_3                -2.669413e-02 1 1  ON 33
eH1_4                 1.878994e-02 1 1  ON 34
eH1_5                 3.146862e-02 1 1  ON 35
eH1_6                 7.771215e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728702e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452492e-02 1 1  ON 42
eH2_3                -2.737952e-02 1 1  ON 43
eH2_4                 1.762293e-02 1 1  ON 44
eH2_5                 3.022024e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922227e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2041
    reference variance = 0.338792
====================================================
  Execution time = 6.3917e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1820e-01
  Total weights = 2.0000e+06
  Execution time = 1.8152e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318110616928
                                         uncertainty =       0.003892417904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318110616928
                                         uncertainty =       0.003892417904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398875122
  error estimate for blocks of size 2^( 2) =       0.000408773396
  error estimate for blocks of size 2^( 3) =       0.000417195459
  error estimate for blocks of size 2^( 4) =       0.000424662341
  error estimate for blocks of size 2^( 5) =       0.000428688891
  error estimate for blocks of size 2^( 6) =       0.000431783500
  error estimate for blocks of size 2^( 7) =       0.000433904839

      target function =                  N/A
              le_mean =     -17.216065736510
             les_mean =     296.711122010334
             stat err =       0.000429759893
             autocorr =       1.160854704679
              std dev =       0.564094606954
             le_variance =       0.318202725595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318110616951
                                         uncertainty =       0.003892417904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318110616951
                                         uncertainty =       0.003892417904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398875122
  error estimate for blocks of size 2^( 2) =       0.000408773396
  error estimate for blocks of size 2^( 3) =       0.000417195459
  error estimate for blocks of size 2^( 4) =       0.000424662341
  error estimate for blocks of size 2^( 5) =       0.000428688891
  error estimate for blocks of size 2^( 6) =       0.000431783500
  error estimate for blocks of size 2^( 7) =       0.000433904839

      target function =                  N/A
              le_mean =     -17.216065736510
             les_mean =     296.711122010353
             stat err =       0.000429759893
             autocorr =       1.160854704662
              std dev =       0.564094606974
             le_variance =       0.318202725617

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318110616939
                                         uncertainty =       0.003892417904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318110616939
                                         uncertainty =       0.003892417904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398875122
  error estimate for blocks of size 2^( 2) =       0.000408773396
  error estimate for blocks of size 2^( 3) =       0.000417195459
  error estimate for blocks of size 2^( 4) =       0.000424662341
  error estimate for blocks of size 2^( 5) =       0.000428688891
  error estimate for blocks of size 2^( 6) =       0.000431783500
  error estimate for blocks of size 2^( 7) =       0.000433904839

      target function =                  N/A
              le_mean =     -17.216065736510
             les_mean =     296.711122010344
             stat err =       0.000429759893
             autocorr =       1.160854704665
              std dev =       0.564094606964
             le_variance =       0.318202725606

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318110616929
                                         uncertainty =       0.003892417904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318110616929
                                         uncertainty =       0.003892417904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398875122
  error estimate for blocks of size 2^( 2) =       0.000408773396
  error estimate for blocks of size 2^( 3) =       0.000417195459
  error estimate for blocks of size 2^( 4) =       0.000424662341
  error estimate for blocks of size 2^( 5) =       0.000428688891
  error estimate for blocks of size 2^( 6) =       0.000431783500
  error estimate for blocks of size 2^( 7) =       0.000433904839

      target function =                  N/A
              le_mean =     -17.216065736510
             les_mean =     296.711122010335
             stat err =       0.000429759893
             autocorr =       1.160854704684
              std dev =       0.564094606955
             le_variance =       0.318202725596


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216065736510        initial  <--
     3.6380e+06     3.6380e+07             4.8796e-11       -17.216065736510
     1.4552e+07     1.4552e+08             1.2199e-11       -17.216065736510
     5.8208e+07     5.8208e+08             3.0497e-12       -17.216065736510

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 73.0672
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.156920e-01 1 1  ON 0
 uu_1                 5.261309e-02 1 1  ON 1
 uu_2                -4.277930e-02 1 1  ON 2
 uu_3                -9.884128e-02 1 1  ON 3
 uu_4                -1.337053e-01 1 1  ON 4
 uu_5                -1.423960e-01 1 1  ON 5
 uu_6                -1.201254e-01 1 1  ON 6
 uu_7                -5.137389e-02 1 1  ON 7
 uu_8                 9.089303e-02 1 1  ON 8
 uu_9                 1.284456e-01 1 1  ON 9
 ud_0                 3.554769e-01 1 1  ON 10
 ud_1                 9.680473e-02 1 1  ON 11
 ud_2                -1.285764e-02 1 1  ON 12
 ud_3                -7.434211e-02 1 1  ON 13
 ud_4                -1.230076e-01 1 1  ON 14
 ud_5                -1.556260e-01 1 1  ON 15
 ud_6                -1.582973e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                -8.225009e-03 1 1  ON 18
 ud_9                 9.246287e-02 1 1  ON 19
 eO_0                -7.892148e-01 1 1  ON 20
 eO_1                -4.676579e-01 1 1  ON 21
 eO_2                -5.566716e-02 1 1  ON 22
 eO_3                 2.073232e-01 1 1  ON 23
 eO_4                 3.123468e-01 1 1  ON 24
 eO_5                 3.338822e-01 1 1  ON 25
 eO_6                 2.676182e-01 1 1  ON 26
 eO_7                 1.297939e-01 1 1  ON 27
 eO_8                 3.111679e-02 1 1  ON 28
 eO_9                 1.924238e-02 1 1  ON 29
eH1_0                -1.844724e-01 1 1  ON 30
eH1_1                -1.056881e-01 1 1  ON 31
eH1_2                -6.401847e-02 1 1  ON 32
eH1_3                -2.669413e-02 1 1  ON 33
eH1_4                 1.878994e-02 1 1  ON 34
eH1_5                 3.146862e-02 1 1  ON 35
eH1_6                 7.771215e-02 1 1  ON 36
eH1_7                 1.090692e-01 1 1  ON 37
eH1_8                 1.002774e-01 1 1  ON 38
eH1_9                 2.728702e-02 1 1  ON 39
eH2_0                -1.851321e-01 1 1  ON 40
eH2_1                -1.062684e-01 1 1  ON 41
eH2_2                -6.452492e-02 1 1  ON 42
eH2_3                -2.737952e-02 1 1  ON 43
eH2_4                 1.762293e-02 1 1  ON 44
eH2_5                 3.022024e-02 1 1  ON 45
eH2_6                 7.594683e-02 1 1  ON 46
eH2_7                 1.132115e-01 1 1  ON 47
eH2_8                 1.041072e-01 1 1  ON 48
eH2_9                 2.922227e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9380e+01 secs
  Total Execution time = 2.3589e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
