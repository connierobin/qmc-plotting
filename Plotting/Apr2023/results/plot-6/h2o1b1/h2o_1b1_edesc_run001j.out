Rank =    0  Free Memory = 89734 MB
Rank =    1  Free Memory = 89727 MB
Rank =    2  Free Memory = 89723 MB
Rank =    3  Free Memory = 89723 MB
Rank =    4  Free Memory = 89723 MB
Rank =    5  Free Memory = 89723 MB
Rank =    6  Free Memory = 89723 MB
Rank =    7  Free Memory = 89723 MB
Rank =    8  Free Memory = 89723 MB
Rank =    9  Free Memory = 89723 MB
Rank =   10  Free Memory = 89723 MB
Rank =   11  Free Memory = 89723 MB
Rank =   12  Free Memory = 89722 MB
Rank =   13  Free Memory = 89722 MB
Rank =   14  Free Memory = 89721 MB
Rank =   15  Free Memory = 89714 MB
Rank =   16  Free Memory = 89712 MB
Rank =   17  Free Memory = 89709 MB
Rank =   18  Free Memory = 89709 MB
Rank =   19  Free Memory = 89709 MB
Rank =   20  Free Memory = 89709 MB
Rank =   21  Free Memory = 89709 MB
Rank =   22  Free Memory = 89709 MB
Rank =   23  Free Memory = 89709 MB
Rank =   24  Free Memory = 89709 MB
Rank =   25  Free Memory = 89709 MB
Rank =   26  Free Memory = 89709 MB
Rank =   27  Free Memory = 89709 MB
Rank =   28  Free Memory = 89709 MB
Rank =   29  Free Memory = 89709 MB
Rank =   30  Free Memory = 89709 MB
Rank =   31  Free Memory = 89709 MB
Rank =   32  Free Memory = 89709 MB
Rank =   33  Free Memory = 89709 MB
Rank =   34  Free Memory = 89709 MB
Rank =   35  Free Memory = 89709 MB
Rank =   36  Free Memory = 89709 MB
Rank =   37  Free Memory = 89709 MB
Rank =   38  Free Memory = 89709 MB
Rank =   39  Free Memory = 89709 MB
Rank =   40  Free Memory = 89692 MB
Rank =   41  Free Memory = 89692 MB
Rank =   42  Free Memory = 89692 MB
Rank =   43  Free Memory = 89692 MB
Rank =   44  Free Memory = 89691 MB
Rank =   45  Free Memory = 89691 MB
Rank =   46  Free Memory = 89691 MB
Rank =   47  Free Memory = 89691 MB
Rank =   48  Free Memory = 89691 MB
Rank =   49  Free Memory = 89691 MB
Rank =   50  Free Memory = 89691 MB
Rank =   51  Free Memory = 89691 MB
Rank =   52  Free Memory = 89691 MB
Rank =   53  Free Memory = 89691 MB
Rank =   54  Free Memory = 89691 MB
Rank =   55  Free Memory = 89691 MB
Rank =   56  Free Memory = 89691 MB
Rank =   57  Free Memory = 89691 MB
Rank =   58  Free Memory = 89691 MB
Rank =   59  Free Memory = 89691 MB
Rank =   60  Free Memory = 89691 MB
Rank =   61  Free Memory = 89691 MB
Rank =   62  Free Memory = 89691 MB
Rank =   63  Free Memory = 89691 MB
Rank =   64  Free Memory = 89691 MB
Rank =   65  Free Memory = 89691 MB
Rank =   66  Free Memory = 89691 MB
Rank =   67  Free Memory = 89691 MB
Rank =   68  Free Memory = 89691 MB
Rank =   69  Free Memory = 89691 MB
Rank =   70  Free Memory = 89691 MB
Rank =   71  Free Memory = 89691 MB
Rank =   72  Free Memory = 89691 MB
Rank =   73  Free Memory = 89691 MB
Rank =   74  Free Memory = 89691 MB
Rank =   75  Free Memory = 89691 MB
Rank =   76  Free Memory = 89691 MB
Rank =   77  Free Memory = 89691 MB
Rank =   78  Free Memory = 89691 MB
Rank =   79  Free Memory = 89691 MB
Rank =   80  Free Memory = 89009 MB
Rank =   81  Free Memory = 89009 MB
Rank =   82  Free Memory = 89009 MB
Rank =   83  Free Memory = 89009 MB
Rank =   84  Free Memory = 89009 MB
Rank =   85  Free Memory = 89009 MB
Rank =   86  Free Memory = 89009 MB
Rank =   87  Free Memory = 89009 MB
Rank =   88  Free Memory = 89009 MB
Rank =   89  Free Memory = 89009 MB
Rank =   90  Free Memory = 89009 MB
Rank =   91  Free Memory = 89009 MB
Rank =   92  Free Memory = 89009 MB
Rank =   93  Free Memory = 89009 MB
Rank =   94  Free Memory = 89009 MB
Rank =   95  Free Memory = 89009 MB
Rank =   96  Free Memory = 89009 MB
Rank =   97  Free Memory = 89009 MB
Rank =   98  Free Memory = 89009 MB
Rank =   99  Free Memory = 89009 MB
Rank =  100  Free Memory = 89009 MB
Rank =  101  Free Memory = 89009 MB
Rank =  102  Free Memory = 89009 MB
Rank =  103  Free Memory = 89009 MB
Rank =  104  Free Memory = 89009 MB
Rank =  105  Free Memory = 89009 MB
Rank =  106  Free Memory = 89009 MB
Rank =  107  Free Memory = 89009 MB
Rank =  108  Free Memory = 89009 MB
Rank =  109  Free Memory = 89009 MB
Rank =  110  Free Memory = 89009 MB
Rank =  111  Free Memory = 89009 MB
Rank =  112  Free Memory = 89009 MB
Rank =  113  Free Memory = 89009 MB
Rank =  114  Free Memory = 89009 MB
Rank =  115  Free Memory = 89009 MB
Rank =  116  Free Memory = 89009 MB
Rank =  117  Free Memory = 89009 MB
Rank =  118  Free Memory = 89009 MB
Rank =  119  Free Memory = 89009 MB
Rank =  120  Free Memory = 90755 MB
Rank =  121  Free Memory = 90755 MB
Rank =  127  Free Memory = 90755 MB
Rank =  122  Free Memory = 90755 MB
Rank =  123  Free Memory = 90755 MB
Rank =  124  Free Memory = 90755 MB
Rank =  125  Free Memory = 90755 MB
Rank =  126  Free Memory = 90755 MB
  Input file(s): opt_h2o_1b1_edesc_run001j.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 40
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_edesc_run001j.xml

  Project = H2O
  date    = 2023-03-08 12:53:14 PST
  host    = n0140.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 442

  Range of prime numbers to use as seeds over processors and threads = 3119-4157


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.081483e-01    1         1  ON     0
     uu_1                 1.417681e-01    1         1  ON     1
     uu_2                 4.119616e-02    1         1  ON     2
     uu_3                -2.024880e-02    1         1  ON     3
     uu_4                -6.380440e-02    1         1  ON     4
     uu_5                -9.658011e-02    1         1  ON     5
     uu_6                -1.231270e-01    1         1  ON     6
     uu_7                -1.364427e-01    1         1  ON     7
     uu_8                -1.290781e-01    1         1  ON     8
     uu_9                -9.978680e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.434613e-01    1         1  ON     0
     ud_1                 1.774866e-01    1         1  ON     1
     ud_2                 5.731343e-02    1         1  ON     2
     ud_3                -1.306822e-02    1         1  ON     3
     ud_4                -6.886896e-02    1         1  ON     4
     ud_5                -1.077646e-01    1         1  ON     5
     ud_6                -1.325691e-01    1         1  ON     6
     ud_7                -1.467504e-01    1         1  ON     7
     ud_8                -1.454794e-01    1         1  ON     8
     ud_9                -1.351164e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.647234e-01    1         1  ON     0
     eO_1                -4.429685e-01    1         1  ON     1
     eO_2                -2.112840e-02    1         1  ON     2
     eO_3                 3.007372e-01    1         1  ON     3
     eO_4                 5.262983e-01    1         1  ON     4
     eO_5                 4.823828e-01    1         1  ON     5
     eO_6                 2.508016e-01    1         1  ON     6
     eO_7                -4.899114e-02    1         1  ON     7
     eO_8                -2.108355e-01    1         1  ON     8
     eO_9                -7.178344e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.368207e-01    1         1  ON     0
     eH1_1                -1.377207e-01    1         1  ON     1
     eH1_2                -9.204312e-02    1         1  ON     2
     eH1_3                -3.799846e-02    1         1  ON     3
     eH1_4                 7.292529e-03    1         1  ON     4
     eH1_5                 4.117151e-02    1         1  ON     5
     eH1_6                 9.663406e-02    1         1  ON     6
     eH1_7                 1.470854e-01    1         1  ON     7
     eH1_8                 1.643039e-01    1         1  ON     8
     eH1_9                 5.149609e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.336049e-01    1         1  ON     0
     eH2_1                -1.347556e-01    1         1  ON     1
     eH2_2                -8.894326e-02    1         1  ON     2
     eH2_3                -3.492963e-02    1         1  ON     3
     eH2_4                 1.108828e-02    1         1  ON     4
     eH2_5                 4.339658e-02    1         1  ON     5
     eH2_6                 9.947767e-02    1         1  ON     6
     eH2_7                 1.513522e-01    1         1  ON     7
     eH2_8                 1.698053e-01    1         1  ON     8
     eH2_9                 3.490022e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.105945e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.0179e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8583
    reference variance = 0.352277
====================================================
  Execution time = 5.0030e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3742e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.3106e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337483654214
                                         uncertainty =       0.003380517567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337483654214
                                         uncertainty =       0.003380517567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410742392
  error estimate for blocks of size 2^( 2) =       0.000423476410
  error estimate for blocks of size 2^( 3) =       0.000436690619
  error estimate for blocks of size 2^( 4) =       0.000449553747
  error estimate for blocks of size 2^( 5) =       0.000461860114
  error estimate for blocks of size 2^( 6) =       0.000470095742
  error estimate for blocks of size 2^( 7) =       0.000476255023

      target function =                  N/A
              le_mean =     -16.922989843817
             les_mean =     286.725003711173
             stat err =       0.000464441157
             autocorr =       1.278563607871
              std dev =       0.580877462083
             le_variance =       0.337418625956


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.692298984382e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922989843817       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923017371632       residual = 7.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923022959756       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923026878909       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923025213021       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923029343548       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923032135649       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923033005317       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923031954064       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.923031776344       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.923031966862       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.923032125839       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.663605e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922989843817       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922999118575       residual = 5.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923000434304       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923001525609       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923000362176       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923001409306       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923002075918       residual = 9.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923002108724       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923002041110       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.923002041965       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 5.206862e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922989843817       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922992383237       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922992704871       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922992994030       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922992651604       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922992878592       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922992988517       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922992997361       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.922992992797       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.447349e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.107746 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3252e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.082438e-01                 1 1 ON  0
uu_1  1.419299e-01                 1 1 ON  1
uu_2  4.139191e-02                 1 1 ON  2
uu_3  -2.015969e-02                1 1 ON  3
uu_4  -6.400833e-02                1 1 ON  4
uu_5  -9.660516e-02                1 1 ON  5
uu_6  -1.232165e-01                1 1 ON  6
uu_7  -1.366403e-01                1 1 ON  7
uu_8  -1.292531e-01                1 1 ON  8
uu_9  -9.985172e-02                1 1 ON  9
ud_0  4.431567e-01                 1 1 ON  10
ud_1  1.769659e-01                 1 1 ON  11
ud_2  5.691350e-02                 1 1 ON  12
ud_3  -1.325453e-02                1 1 ON  13
ud_4  -6.880966e-02                1 1 ON  14
ud_5  -1.075427e-01                1 1 ON  15
ud_6  -1.321280e-01                1 1 ON  16
ud_7  -1.464116e-01                1 1 ON  17
ud_8  -1.453172e-01                1 1 ON  18
ud_9  -1.349912e-01                1 1 ON  19
eO_0  -7.649417e-01                1 1 ON  20
eO_1  -4.433490e-01                1 1 ON  21
eO_2  -2.127006e-02                1 1 ON  22
eO_3  3.006943e-01                 1 1 ON  23
eO_4  5.265938e-01                 1 1 ON  24
eO_5  4.827872e-01                 1 1 ON  25
eO_6  2.510692e-01                 1 1 ON  26
eO_7  -4.892115e-02                1 1 ON  27
eO_8  -2.109529e-01                1 1 ON  28
eO_9  -7.190183e-02                1 1 ON  29
eH1_0 -2.367619e-01                1 1 ON  30
eH1_1 -1.377415e-01                1 1 ON  31
eH1_2 -9.230700e-02                1 1 ON  32
eH1_3 -3.789224e-02                1 1 ON  33
eH1_4 7.156268e-03                 1 1 ON  34
eH1_5 4.105664e-02                 1 1 ON  35
eH1_6 9.644127e-02                 1 1 ON  36
eH1_7 1.471205e-01                 1 1 ON  37
eH1_8 1.645066e-01                 1 1 ON  38
eH1_9 5.175790e-02                 1 1 ON  39
eH2_0 -2.335428e-01                1 1 ON  40
eH2_1 -1.347648e-01                1 1 ON  41
eH2_2 -8.908322e-02                1 1 ON  42
eH2_3 -3.489656e-02                1 1 ON  43
eH2_4 1.094185e-02                 1 1 ON  44
eH2_5 4.339620e-02                 1 1 ON  45
eH2_6 9.941490e-02                 1 1 ON  46
eH2_7 1.513831e-01                 1 1 ON  47
eH2_8 1.698685e-01                 1 1 ON  48
eH2_9 3.506733e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9023
    reference variance = 0.259456
====================================================
  Execution time = 4.3362e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6922e+01
  VMC Evar = 3.3274e-01
  Total weights = 2.0000e+06
  Execution time = 4.1181e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332699751795
                                         uncertainty =       0.003486529783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332699751795
                                         uncertainty =       0.003486529783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407837095
  error estimate for blocks of size 2^( 2) =       0.000421434045
  error estimate for blocks of size 2^( 3) =       0.000434865085
  error estimate for blocks of size 2^( 4) =       0.000447193238
  error estimate for blocks of size 2^( 5) =       0.000459352597
  error estimate for blocks of size 2^( 6) =       0.000469431531
  error estimate for blocks of size 2^( 7) =       0.000474960311

      target function =                  N/A
              le_mean =     -16.922195443356
             les_mean =     286.693360648699
             stat err =       0.000462734419
             autocorr =       1.287330799832
              std dev =       0.576768750791
             le_variance =       0.332662191889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332762647583
                                         uncertainty =       0.003490683953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332762647583
                                         uncertainty =       0.003490683953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407875606
  error estimate for blocks of size 2^( 2) =       0.000421438652
  error estimate for blocks of size 2^( 3) =       0.000434834628
  error estimate for blocks of size 2^( 4) =       0.000447121654
  error estimate for blocks of size 2^( 5) =       0.000459230586
  error estimate for blocks of size 2^( 6) =       0.000469276731
  error estimate for blocks of size 2^( 7) =       0.000474767958

      target function =                  N/A
              le_mean =     -16.922197830835
             les_mean =     286.693504278936
             stat err =       0.000462599232
             autocorr =       1.286335786020
              std dev =       0.576823213270
             le_variance =       0.332725019367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332868983222
                                         uncertainty =       0.003490012994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332868983222
                                         uncertainty =       0.003490012994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407940750
  error estimate for blocks of size 2^( 2) =       0.000421508470
  error estimate for blocks of size 2^( 3) =       0.000434911131
  error estimate for blocks of size 2^( 4) =       0.000447211470
  error estimate for blocks of size 2^( 5) =       0.000459336119
  error estimate for blocks of size 2^( 6) =       0.000469397310
  error estimate for blocks of size 2^( 7) =       0.000474904784

      target function =                  N/A
              le_mean =     -16.922192419789
             les_mean =     286.693427437264
             stat err =       0.000462712421
             autocorr =       1.286554340661
              std dev =       0.576915341541
             le_variance =       0.332831311305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332733283236
                                         uncertainty =       0.003487052268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332733283236
                                         uncertainty =       0.003487052268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407857636
  error estimate for blocks of size 2^( 2) =       0.000421449785
  error estimate for blocks of size 2^( 3) =       0.000434876268
  error estimate for blocks of size 2^( 4) =       0.000447200255
  error estimate for blocks of size 2^( 5) =       0.000459354449
  error estimate for blocks of size 2^( 6) =       0.000469431084
  error estimate for blocks of size 2^( 7) =       0.000474956919

      target function =                  N/A
              le_mean =     -16.922194241449
             les_mean =     286.693353481595
             stat err =       0.000462735676
             autocorr =       1.287208127631
              std dev =       0.576797800453
             le_variance =       0.332695702608


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.922195443356        initial
     2.5000e-01     2.5000e+00             1.6636e-03       -16.922197830835  <--
     1.0000e+00     1.0000e+01             5.2069e-04       -16.922192419789
     4.0000e+00     4.0000e+01             1.4473e-04       -16.922194241449

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 6.4089e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.085710e-01 1 1  ON 0
 uu_1                 1.423248e-01 1 1  ON 1
 uu_2                 4.176205e-02 1 1  ON 2
 uu_3                -2.000805e-02 1 1  ON 3
 uu_4                -6.429047e-02 1 1  ON 4
 uu_5                -9.681667e-02 1 1  ON 5
 uu_6                -1.234480e-01 1 1  ON 6
 uu_7                -1.371095e-01 1 1  ON 7
 uu_8                -1.297465e-01 1 1  ON 8
 uu_9                -1.000514e-01 1 1  ON 9
 ud_0                 4.421712e-01 1 1  ON 10
 ud_1                 1.758715e-01 1 1  ON 11
 ud_2                 5.601661e-02 1 1  ON 12
 ud_3                -1.378278e-02 1 1  ON 13
 ud_4                -6.882051e-02 1 1  ON 14
 ud_5                -1.070808e-01 1 1  ON 15
 ud_6                -1.311607e-01 1 1  ON 16
 ud_7                -1.454599e-01 1 1  ON 17
 ud_8                -1.447624e-01 1 1  ON 18
 ud_9                -1.346013e-01 1 1  ON 19
 eO_0                -7.656117e-01 1 1  ON 20
 eO_1                -4.443319e-01 1 1  ON 21
 eO_2                -2.184405e-02 1 1  ON 22
 eO_3                 3.005327e-01 1 1  ON 23
 eO_4                 5.274012e-01 1 1  ON 24
 eO_5                 4.840464e-01 1 1  ON 25
 eO_6                 2.519361e-01 1 1  ON 26
 eO_7                -4.869848e-02 1 1  ON 27
 eO_8                -2.113065e-01 1 1  ON 28
 eO_9                -7.226031e-02 1 1  ON 29
eH1_0                -2.366296e-01 1 1  ON 30
eH1_1                -1.378424e-01 1 1  ON 31
eH1_2                -9.278350e-02 1 1  ON 32
eH1_3                -3.786959e-02 1 1  ON 33
eH1_4                 6.808134e-03 1 1  ON 34
eH1_5                 4.069586e-02 1 1  ON 35
eH1_6                 9.588023e-02 1 1  ON 36
eH1_7                 1.472260e-01 1 1  ON 37
eH1_8                 1.651104e-01 1 1  ON 38
eH1_9                 5.254718e-02 1 1  ON 39
eH2_0                -2.333783e-01 1 1  ON 40
eH2_1                -1.347821e-01 1 1  ON 41
eH2_2                -8.935868e-02 1 1  ON 42
eH2_3                -3.497231e-02 1 1  ON 43
eH2_4                 1.057719e-02 1 1  ON 44
eH2_5                 4.332214e-02 1 1  ON 45
eH2_6                 9.923068e-02 1 1  ON 46
eH2_7                 1.514988e-01 1 1  ON 47
eH2_8                 1.700681e-01 1 1  ON 48
eH2_9                 3.557224e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2736e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6880e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9736
    reference variance = 0.179478
====================================================
  Execution time = 4.4182e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3830e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1936e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338403836701
                                         uncertainty =       0.004232022971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338403836701
                                         uncertainty =       0.004232022971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411280237
  error estimate for blocks of size 2^( 2) =       0.000424105674
  error estimate for blocks of size 2^( 3) =       0.000437878750
  error estimate for blocks of size 2^( 4) =       0.000450800617
  error estimate for blocks of size 2^( 5) =       0.000463579320
  error estimate for blocks of size 2^( 6) =       0.000473584880
  error estimate for blocks of size 2^( 7) =       0.000480241498

      target function =                  N/A
              le_mean =     -16.923504492491
             les_mean =     286.743307004712
             stat err =       0.000467051579
             autocorr =       1.289596978130
              std dev =       0.581638088942
             le_variance =       0.338302866508


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692350449249e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923504492491       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923547096463       residual = 7.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923560015117       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923569516209       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923576374669       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923576583387       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923574607888       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923580465474       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923580814301       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.923579604863       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.923581234764       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.923582890342       residual = 8.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.923583849043       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.923582947285       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.923583209763       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 6.130089e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923504492491       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923525434943       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923529592616       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923533078508       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923534043295       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923535175100       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923533871868       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923534824401       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923534868032       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.923534808506       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.923535204566       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.625770e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923504492491       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923511395591       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923512499175       residual = 8.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923513673346       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923513323492       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923513937824       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923513554978       residual = 8.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923513624317       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923513717408       residual = 5.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 4.474083e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116863 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6134e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.088509e-01 1 1  ON 0
 uu_1                 1.429013e-01 1 1  ON 1
 uu_2                 4.224506e-02 1 1  ON 2
 uu_3                -1.986437e-02 1 1  ON 3
 uu_4                -6.427226e-02 1 1  ON 4
 uu_5                -9.702835e-02 1 1  ON 5
 uu_6                -1.235682e-01 1 1  ON 6
 uu_7                -1.373425e-01 1 1  ON 7
 uu_8                -1.302018e-01 1 1  ON 8
 uu_9                -1.005980e-01 1 1  ON 9
 ud_0                 4.407602e-01 1 1  ON 10
 ud_1                 1.747587e-01 1 1  ON 11
 ud_2                 5.516782e-02 1 1  ON 12
 ud_3                -1.436452e-02 1 1  ON 13
 ud_4                -6.872559e-02 1 1  ON 14
 ud_5                -1.066179e-01 1 1  ON 15
 ud_6                -1.303506e-01 1 1  ON 16
 ud_7                -1.441118e-01 1 1  ON 17
 ud_8                -1.441023e-01 1 1  ON 18
 ud_9                -1.343065e-01 1 1  ON 19
 eO_0                -7.665924e-01 1 1  ON 20
 eO_1                -4.453167e-01 1 1  ON 21
 eO_2                -2.268892e-02 1 1  ON 22
 eO_3                 3.001787e-01 1 1  ON 23
 eO_4                 5.285003e-01 1 1  ON 24
 eO_5                 4.856722e-01 1 1  ON 25
 eO_6                 2.532224e-01 1 1  ON 26
 eO_7                -4.832476e-02 1 1  ON 27
 eO_8                -2.118388e-01 1 1  ON 28
 eO_9                -7.283982e-02 1 1  ON 29
eH1_0                -2.362585e-01 1 1  ON 30
eH1_1                -1.377959e-01 1 1  ON 31
eH1_2                -9.312358e-02 1 1  ON 32
eH1_3                -3.791805e-02 1 1  ON 33
eH1_4                 6.719578e-03 1 1  ON 34
eH1_5                 4.042489e-02 1 1  ON 35
eH1_6                 9.554558e-02 1 1  ON 36
eH1_7                 1.472322e-01 1 1  ON 37
eH1_8                 1.653214e-01 1 1  ON 38
eH1_9                 5.307019e-02 1 1  ON 39
eH2_0                -2.330370e-01 1 1  ON 40
eH2_1                -1.347358e-01 1 1  ON 41
eH2_2                -8.993851e-02 1 1  ON 42
eH2_3                -3.493588e-02 1 1  ON 43
eH2_4                 9.852929e-03 1 1  ON 44
eH2_5                 4.278878e-02 1 1  ON 45
eH2_6                 9.890714e-02 1 1  ON 46
eH2_7                 1.515515e-01 1 1  ON 47
eH2_8                 1.707773e-01 1 1  ON 48
eH2_9                 3.651408e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9105
    reference variance = 0.325143
====================================================
  Execution time = 4.3536e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3393e-01
  Total weights = 2.0000e+06
  Execution time = 4.0798e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334240562042
                                         uncertainty =       0.005041290867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334240562042
                                         uncertainty =       0.005041290867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408815633
  error estimate for blocks of size 2^( 2) =       0.000421472176
  error estimate for blocks of size 2^( 3) =       0.000435033614
  error estimate for blocks of size 2^( 4) =       0.000447688874
  error estimate for blocks of size 2^( 5) =       0.000458277254
  error estimate for blocks of size 2^( 6) =       0.000468691581
  error estimate for blocks of size 2^( 7) =       0.000476215833

      target function =                  N/A
              le_mean =     -16.923791945784
             les_mean =     286.748994100267
             stat err =       0.000462718385
             autocorr =       1.281086701161
              std dev =       0.578152612377
             le_variance =       0.334260443199

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333761229045
                                         uncertainty =       0.005030075164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333761229045
                                         uncertainty =       0.005030075164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408522024
  error estimate for blocks of size 2^( 2) =       0.000421175876
  error estimate for blocks of size 2^( 3) =       0.000434721346
  error estimate for blocks of size 2^( 4) =       0.000447329824
  error estimate for blocks of size 2^( 5) =       0.000457870436
  error estimate for blocks of size 2^( 6) =       0.000468234298
  error estimate for blocks of size 2^( 7) =       0.000475741483

      target function =                  N/A
              le_mean =     -16.923789781624
             les_mean =     286.748440893917
             stat err =       0.000462294010
             autocorr =       1.280576662885
              std dev =       0.577737386877
             le_variance =       0.333780488196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333617451940
                                         uncertainty =       0.005024180757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333617451940
                                         uncertainty =       0.005024180757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408434119
  error estimate for blocks of size 2^( 2) =       0.000421088996
  error estimate for blocks of size 2^( 3) =       0.000434643350
  error estimate for blocks of size 2^( 4) =       0.000447267125
  error estimate for blocks of size 2^( 5) =       0.000457829285
  error estimate for blocks of size 2^( 6) =       0.000468207760
  error estimate for blocks of size 2^( 7) =       0.000475725418

      target function =                  N/A
              le_mean =     -16.923782301467
             les_mean =     286.748044080363
             stat err =       0.000462257397
             autocorr =       1.280925022675
              std dev =       0.577613070954
             le_variance =       0.333636859737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334097197919
                                         uncertainty =       0.005037427076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334097197919
                                         uncertainty =       0.005037427076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408727911
  error estimate for blocks of size 2^( 2) =       0.000421383570
  error estimate for blocks of size 2^( 3) =       0.000434943543
  error estimate for blocks of size 2^( 4) =       0.000447593564
  error estimate for blocks of size 2^( 5) =       0.000458178833
  error estimate for blocks of size 2^( 6) =       0.000468588233
  error estimate for blocks of size 2^( 7) =       0.000476111978

      target function =                  N/A
              le_mean =     -16.923786474080
             les_mean =     286.748665464055
             stat err =       0.000462618152
             autocorr =       1.281081463089
              std dev =       0.578028555397
             le_variance =       0.334117010855


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923791945784        initial  <--
     6.2500e-02     6.2500e-01             6.1301e-03       -16.923789781624
     2.5000e-01     2.5000e+00             1.6258e-03       -16.923782301467
     1.0000e+00     1.0000e+01             4.4741e-04       -16.923786474080

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.9959
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.085710e-01 1 1  ON 0
 uu_1                 1.423248e-01 1 1  ON 1
 uu_2                 4.176205e-02 1 1  ON 2
 uu_3                -2.000805e-02 1 1  ON 3
 uu_4                -6.429047e-02 1 1  ON 4
 uu_5                -9.681667e-02 1 1  ON 5
 uu_6                -1.234480e-01 1 1  ON 6
 uu_7                -1.371095e-01 1 1  ON 7
 uu_8                -1.297465e-01 1 1  ON 8
 uu_9                -1.000514e-01 1 1  ON 9
 ud_0                 4.421712e-01 1 1  ON 10
 ud_1                 1.758715e-01 1 1  ON 11
 ud_2                 5.601661e-02 1 1  ON 12
 ud_3                -1.378278e-02 1 1  ON 13
 ud_4                -6.882051e-02 1 1  ON 14
 ud_5                -1.070808e-01 1 1  ON 15
 ud_6                -1.311607e-01 1 1  ON 16
 ud_7                -1.454599e-01 1 1  ON 17
 ud_8                -1.447624e-01 1 1  ON 18
 ud_9                -1.346013e-01 1 1  ON 19
 eO_0                -7.656117e-01 1 1  ON 20
 eO_1                -4.443319e-01 1 1  ON 21
 eO_2                -2.184405e-02 1 1  ON 22
 eO_3                 3.005327e-01 1 1  ON 23
 eO_4                 5.274012e-01 1 1  ON 24
 eO_5                 4.840464e-01 1 1  ON 25
 eO_6                 2.519361e-01 1 1  ON 26
 eO_7                -4.869848e-02 1 1  ON 27
 eO_8                -2.113065e-01 1 1  ON 28
 eO_9                -7.226031e-02 1 1  ON 29
eH1_0                -2.366296e-01 1 1  ON 30
eH1_1                -1.378424e-01 1 1  ON 31
eH1_2                -9.278350e-02 1 1  ON 32
eH1_3                -3.786959e-02 1 1  ON 33
eH1_4                 6.808134e-03 1 1  ON 34
eH1_5                 4.069586e-02 1 1  ON 35
eH1_6                 9.588023e-02 1 1  ON 36
eH1_7                 1.472260e-01 1 1  ON 37
eH1_8                 1.651104e-01 1 1  ON 38
eH1_9                 5.254718e-02 1 1  ON 39
eH2_0                -2.333783e-01 1 1  ON 40
eH2_1                -1.347821e-01 1 1  ON 41
eH2_2                -8.935868e-02 1 1  ON 42
eH2_3                -3.497231e-02 1 1  ON 43
eH2_4                 1.057719e-02 1 1  ON 44
eH2_5                 4.332214e-02 1 1  ON 45
eH2_6                 9.923068e-02 1 1  ON 46
eH2_7                 1.514988e-01 1 1  ON 47
eH2_8                 1.700681e-01 1 1  ON 48
eH2_9                 3.557224e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2014e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.905
    reference variance = 0.206162
====================================================
  Execution time = 4.4090e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3585e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1908e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335506203381
                                         uncertainty =       0.003580396451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335506203381
                                         uncertainty =       0.003580396451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409788412
  error estimate for blocks of size 2^( 2) =       0.000422454003
  error estimate for blocks of size 2^( 3) =       0.000435766275
  error estimate for blocks of size 2^( 4) =       0.000447542299
  error estimate for blocks of size 2^( 5) =       0.000456663320
  error estimate for blocks of size 2^( 6) =       0.000463354529
  error estimate for blocks of size 2^( 7) =       0.000467013453

      target function =                  N/A
              le_mean =     -16.922812904768
             les_mean =     286.717449527097
             stat err =       0.000458643400
             autocorr =       1.252653482985
              std dev =       0.579528329976
             le_variance =       0.335853085245


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692281290477e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922812904768       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922816596019       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922820248108       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922820088732       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922822690464       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922823419771       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922823395104       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922823311916       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.922823398439       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.922823382627       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 5.540377e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922812904768       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922813948989       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922814909068       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922814813507       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922815401581       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922815707000       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922815701540       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922815684189       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.922815695988       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.523478e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922812904768       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922813174701       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922813417967       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922813388648       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922813529671       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922813613499       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922813613838       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922813610610       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.922813612423       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 3.866195e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123067 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6010e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.086033e-01 1 1  ON 0
 uu_1                 1.424175e-01 1 1  ON 1
 uu_2                 4.183562e-02 1 1  ON 2
 uu_3                -1.998745e-02 1 1  ON 3
 uu_4                -6.427774e-02 1 1  ON 4
 uu_5                -9.688302e-02 1 1  ON 5
 uu_6                -1.234608e-01 1 1  ON 6
 uu_7                -1.371394e-01 1 1  ON 7
 uu_8                -1.298593e-01 1 1  ON 8
 uu_9                -1.001256e-01 1 1  ON 9
 ud_0                 4.420189e-01 1 1  ON 10
 ud_1                 1.757305e-01 1 1  ON 11
 ud_2                 5.592942e-02 1 1  ON 12
 ud_3                -1.386922e-02 1 1  ON 13
 ud_4                -6.880333e-02 1 1  ON 14
 ud_5                -1.069602e-01 1 1  ON 15
 ud_6                -1.310526e-01 1 1  ON 16
 ud_7                -1.453222e-01 1 1  ON 17
 ud_8                -1.447274e-01 1 1  ON 18
 ud_9                -1.345755e-01 1 1  ON 19
 eO_0                -7.656999e-01 1 1  ON 20
 eO_1                -4.444162e-01 1 1  ON 21
 eO_2                -2.191068e-02 1 1  ON 22
 eO_3                 3.005174e-01 1 1  ON 23
 eO_4                 5.275068e-01 1 1  ON 24
 eO_5                 4.841679e-01 1 1  ON 25
 eO_6                 2.520632e-01 1 1  ON 26
 eO_7                -4.865517e-02 1 1  ON 27
 eO_8                -2.113924e-01 1 1  ON 28
 eO_9                -7.231153e-02 1 1  ON 29
eH1_0                -2.366225e-01 1 1  ON 30
eH1_1                -1.378653e-01 1 1  ON 31
eH1_2                -9.284305e-02 1 1  ON 32
eH1_3                -3.787538e-02 1 1  ON 33
eH1_4                 6.815348e-03 1 1  ON 34
eH1_5                 4.065903e-02 1 1  ON 35
eH1_6                 9.581773e-02 1 1  ON 36
eH1_7                 1.472325e-01 1 1  ON 37
eH1_8                 1.652048e-01 1 1  ON 38
eH1_9                 5.261653e-02 1 1  ON 39
eH2_0                -2.333487e-01 1 1  ON 40
eH2_1                -1.347592e-01 1 1  ON 41
eH2_2                -8.945273e-02 1 1  ON 42
eH2_3                -3.491012e-02 1 1  ON 43
eH2_4                 1.052615e-02 1 1  ON 44
eH2_5                 4.334995e-02 1 1  ON 45
eH2_6                 9.915764e-02 1 1  ON 46
eH2_7                 1.514575e-01 1 1  ON 47
eH2_8                 1.701163e-01 1 1  ON 48
eH2_9                 3.564534e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9723
    reference variance = 0.169793
====================================================
  Execution time = 4.3916e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3411e-01
  Total weights = 2.0000e+06
  Execution time = 4.7957e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334177385712
                                         uncertainty =       0.002923629462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334177385712
                                         uncertainty =       0.002923629462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408746031
  error estimate for blocks of size 2^( 2) =       0.000421738823
  error estimate for blocks of size 2^( 3) =       0.000434539180
  error estimate for blocks of size 2^( 4) =       0.000447892798
  error estimate for blocks of size 2^( 5) =       0.000458529461
  error estimate for blocks of size 2^( 6) =       0.000468831170
  error estimate for blocks of size 2^( 7) =       0.000475420304

      target function =                  N/A
              le_mean =     -16.924173699481
             les_mean =     286.761801879249
             stat err =       0.000462668433
             autocorr =       1.281246350822
              std dev =       0.578054180948
             le_variance =       0.334146636112

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334080297682
                                         uncertainty =       0.002922663186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334080297682
                                         uncertainty =       0.002922663186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408686661
  error estimate for blocks of size 2^( 2) =       0.000421674728
  error estimate for blocks of size 2^( 3) =       0.000434469163
  error estimate for blocks of size 2^( 4) =       0.000447812422
  error estimate for blocks of size 2^( 5) =       0.000458435251
  error estimate for blocks of size 2^( 6) =       0.000468724215
  error estimate for blocks of size 2^( 7) =       0.000475308375

      target function =                  N/A
              le_mean =     -16.924171176129
             les_mean =     286.761619406320
             stat err =       0.000462570066
             autocorr =       1.281073721526
              std dev =       0.577970219335
             le_variance =       0.334049574438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334107884311
                                         uncertainty =       0.002922928527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334107884311
                                         uncertainty =       0.002922928527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408703539
  error estimate for blocks of size 2^( 2) =       0.000421693769
  error estimate for blocks of size 2^( 3) =       0.000434490958
  error estimate for blocks of size 2^( 4) =       0.000447839208
  error estimate for blocks of size 2^( 5) =       0.000458468403
  error estimate for blocks of size 2^( 6) =       0.000468763622
  error estimate for blocks of size 2^( 7) =       0.000475350467

      target function =                  N/A
              le_mean =     -16.924171984380
             les_mean =     286.761674354869
             stat err =       0.000462605425
             autocorr =       1.281163766073
              std dev =       0.577994087360
             le_variance =       0.334077165023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334168018531
                                         uncertainty =       0.002923535384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334168018531
                                         uncertainty =       0.002923535384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408740305
  error estimate for blocks of size 2^( 2) =       0.000421732742
  error estimate for blocks of size 2^( 3) =       0.000434532668
  error estimate for blocks of size 2^( 4) =       0.000447885594
  error estimate for blocks of size 2^( 5) =       0.000458521297
  error estimate for blocks of size 2^( 6) =       0.000468822214
  error estimate for blocks of size 2^( 7) =       0.000475411087

      target function =                  N/A
              le_mean =     -16.924173425122
             les_mean =     286.761783230261
             stat err =       0.000462660048
             autocorr =       1.281235808045
              std dev =       0.578046082687
             le_variance =       0.334137273710


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924173699481        initial  <--
     6.2500e-01     6.2500e+00             5.5404e-04       -16.924171176129
     2.5000e+00     2.5000e+01             1.5235e-04       -16.924171984380
     1.0000e+01     1.0000e+02             3.8662e-05       -16.924173425122

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.0679
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.085710e-01 1 1  ON 0
 uu_1                 1.423248e-01 1 1  ON 1
 uu_2                 4.176205e-02 1 1  ON 2
 uu_3                -2.000805e-02 1 1  ON 3
 uu_4                -6.429047e-02 1 1  ON 4
 uu_5                -9.681667e-02 1 1  ON 5
 uu_6                -1.234480e-01 1 1  ON 6
 uu_7                -1.371095e-01 1 1  ON 7
 uu_8                -1.297465e-01 1 1  ON 8
 uu_9                -1.000514e-01 1 1  ON 9
 ud_0                 4.421712e-01 1 1  ON 10
 ud_1                 1.758715e-01 1 1  ON 11
 ud_2                 5.601661e-02 1 1  ON 12
 ud_3                -1.378278e-02 1 1  ON 13
 ud_4                -6.882051e-02 1 1  ON 14
 ud_5                -1.070808e-01 1 1  ON 15
 ud_6                -1.311607e-01 1 1  ON 16
 ud_7                -1.454599e-01 1 1  ON 17
 ud_8                -1.447624e-01 1 1  ON 18
 ud_9                -1.346013e-01 1 1  ON 19
 eO_0                -7.656117e-01 1 1  ON 20
 eO_1                -4.443319e-01 1 1  ON 21
 eO_2                -2.184405e-02 1 1  ON 22
 eO_3                 3.005327e-01 1 1  ON 23
 eO_4                 5.274012e-01 1 1  ON 24
 eO_5                 4.840464e-01 1 1  ON 25
 eO_6                 2.519361e-01 1 1  ON 26
 eO_7                -4.869848e-02 1 1  ON 27
 eO_8                -2.113065e-01 1 1  ON 28
 eO_9                -7.226031e-02 1 1  ON 29
eH1_0                -2.366296e-01 1 1  ON 30
eH1_1                -1.378424e-01 1 1  ON 31
eH1_2                -9.278350e-02 1 1  ON 32
eH1_3                -3.786959e-02 1 1  ON 33
eH1_4                 6.808134e-03 1 1  ON 34
eH1_5                 4.069586e-02 1 1  ON 35
eH1_6                 9.588023e-02 1 1  ON 36
eH1_7                 1.472260e-01 1 1  ON 37
eH1_8                 1.651104e-01 1 1  ON 38
eH1_9                 5.254718e-02 1 1  ON 39
eH2_0                -2.333783e-01 1 1  ON 40
eH2_1                -1.347821e-01 1 1  ON 41
eH2_2                -8.935868e-02 1 1  ON 42
eH2_3                -3.497231e-02 1 1  ON 43
eH2_4                 1.057719e-02 1 1  ON 44
eH2_5                 4.332214e-02 1 1  ON 45
eH2_6                 9.923068e-02 1 1  ON 46
eH2_7                 1.514988e-01 1 1  ON 47
eH2_8                 1.700681e-01 1 1  ON 48
eH2_9                 3.557224e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2209e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8825
    reference variance = 0.571977
====================================================
  Execution time = 4.4661e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4133e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1937e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341357471758
                                         uncertainty =       0.007975975083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341357471758
                                         uncertainty =       0.007975975083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413117829
  error estimate for blocks of size 2^( 2) =       0.000426130948
  error estimate for blocks of size 2^( 3) =       0.000439541564
  error estimate for blocks of size 2^( 4) =       0.000451955273
  error estimate for blocks of size 2^( 5) =       0.000464740493
  error estimate for blocks of size 2^( 6) =       0.000475299743
  error estimate for blocks of size 2^( 7) =       0.000483526513

      target function =                  N/A
              le_mean =     -16.923558312332
             les_mean =     286.748158461276
             stat err =       0.000468880505
             autocorr =       1.288179776350
              std dev =       0.584236836440
             le_variance =       0.341332681054


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692355831233e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923558312332       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923559509334       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923559661974       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923559905388       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923559827501       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923559926376       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923559930351       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923559913755       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923559926417       residual = 2.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 7.440432e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923558312332       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923558615747       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923558653453       residual = 7.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923558714925       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923558694757       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923558719978       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923558720842       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923558716445       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923558719340       residual = 1.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.905750e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923558312332       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923558388450       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923558397848       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923558413255       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923558408170       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923558414510       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923558414721       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923558413610       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923558414312       residual = 1.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 4.795086e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.128219 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6609e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.085735e-01 1 1  ON 0
 uu_1                 1.423309e-01 1 1  ON 1
 uu_2                 4.176946e-02 1 1  ON 2
 uu_3                -2.000454e-02 1 1  ON 3
 uu_4                -6.429484e-02 1 1  ON 4
 uu_5                -9.682215e-02 1 1  ON 5
 uu_6                -1.234479e-01 1 1  ON 6
 uu_7                -1.371065e-01 1 1  ON 7
 uu_8                -1.297516e-01 1 1  ON 8
 uu_9                -1.000611e-01 1 1  ON 9
 ud_0                 4.421604e-01 1 1  ON 10
 ud_1                 1.758525e-01 1 1  ON 11
 ud_2                 5.600538e-02 1 1  ON 12
 ud_3                -1.378862e-02 1 1  ON 13
 ud_4                -6.881680e-02 1 1  ON 14
 ud_5                -1.070713e-01 1 1  ON 15
 ud_6                -1.311502e-01 1 1  ON 16
 ud_7                -1.454448e-01 1 1  ON 17
 ud_8                -1.447539e-01 1 1  ON 18
 ud_9                -1.345994e-01 1 1  ON 19
 eO_0                -7.656166e-01 1 1  ON 20
 eO_1                -4.443428e-01 1 1  ON 21
 eO_2                -2.185452e-02 1 1  ON 22
 eO_3                 3.005276e-01 1 1  ON 23
 eO_4                 5.274160e-01 1 1  ON 24
 eO_5                 4.840606e-01 1 1  ON 25
 eO_6                 2.519466e-01 1 1  ON 26
 eO_7                -4.869271e-02 1 1  ON 27
 eO_8                -2.113131e-01 1 1  ON 28
 eO_9                -7.226649e-02 1 1  ON 29
eH1_0                -2.366240e-01 1 1  ON 30
eH1_1                -1.378495e-01 1 1  ON 31
eH1_2                -9.278775e-02 1 1  ON 32
eH1_3                -3.786842e-02 1 1  ON 33
eH1_4                 6.805497e-03 1 1  ON 34
eH1_5                 4.069247e-02 1 1  ON 35
eH1_6                 9.587981e-02 1 1  ON 36
eH1_7                 1.472271e-01 1 1  ON 37
eH1_8                 1.651146e-01 1 1  ON 38
eH1_9                 5.255302e-02 1 1  ON 39
eH2_0                -2.333789e-01 1 1  ON 40
eH2_1                -1.347790e-01 1 1  ON 41
eH2_2                -8.936253e-02 1 1  ON 42
eH2_3                -3.497081e-02 1 1  ON 43
eH2_4                 1.057381e-02 1 1  ON 44
eH2_5                 4.332020e-02 1 1  ON 45
eH2_6                 9.922614e-02 1 1  ON 46
eH2_7                 1.514975e-01 1 1  ON 47
eH2_8                 1.700723e-01 1 1  ON 48
eH2_9                 3.557913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.942
    reference variance = 0.182392
====================================================
  Execution time = 4.3337e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4856e-01
  Total weights = 2.0000e+06
  Execution time = 4.0902e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348637967803
                                         uncertainty =       0.005526022729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348637967803
                                         uncertainty =       0.005526022729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417467277
  error estimate for blocks of size 2^( 2) =       0.000430236389
  error estimate for blocks of size 2^( 3) =       0.000444039552
  error estimate for blocks of size 2^( 4) =       0.000456834959
  error estimate for blocks of size 2^( 5) =       0.000467685520
  error estimate for blocks of size 2^( 6) =       0.000475717821
  error estimate for blocks of size 2^( 7) =       0.000481881627

      target function =                  N/A
              le_mean =     -16.923574147321
             les_mean =     286.755919600918
             stat err =       0.000470529982
             autocorr =       1.270368522094
              std dev =       0.590387885498
             le_variance =       0.348557855342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348640962387
                                         uncertainty =       0.005526336222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348640962387
                                         uncertainty =       0.005526336222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417469072
  error estimate for blocks of size 2^( 2) =       0.000430237243
  error estimate for blocks of size 2^( 3) =       0.000444039384
  error estimate for blocks of size 2^( 4) =       0.000456833475
  error estimate for blocks of size 2^( 5) =       0.000467682213
  error estimate for blocks of size 2^( 6) =       0.000475711818
  error estimate for blocks of size 2^( 7) =       0.000481873801

      target function =                  N/A
              le_mean =     -16.923574249216
             les_mean =     286.755926047072
             stat err =       0.000470525327
             autocorr =       1.270332462091
              std dev =       0.590390423880
             le_variance =       0.348560852609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348640204335
                                         uncertainty =       0.005526190954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348640204335
                                         uncertainty =       0.005526190954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417468618
  error estimate for blocks of size 2^( 2) =       0.000430237228
  error estimate for blocks of size 2^( 3) =       0.000444039851
  error estimate for blocks of size 2^( 4) =       0.000456834581
  error estimate for blocks of size 2^( 5) =       0.000467684210
  error estimate for blocks of size 2^( 6) =       0.000475715145
  error estimate for blocks of size 2^( 7) =       0.000481878044

      target function =                  N/A
              le_mean =     -16.923574192254
             les_mean =     286.755923359676
             stat err =       0.000470527995
             autocorr =       1.270349637867
              std dev =       0.590389780750
             le_variance =       0.348560093214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348638271821
                                         uncertainty =       0.005526044144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348638271821
                                         uncertainty =       0.005526044144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417467460
  error estimate for blocks of size 2^( 2) =       0.000430236507
  error estimate for blocks of size 2^( 3) =       0.000444039602
  error estimate for blocks of size 2^( 4) =       0.000456834923
  error estimate for blocks of size 2^( 5) =       0.000467685367
  error estimate for blocks of size 2^( 6) =       0.000475717497
  error estimate for blocks of size 2^( 7) =       0.000481881189

      target function =                  N/A
              le_mean =     -16.923574152312
             les_mean =     286.755920074040
             stat err =       0.000470529744
             autocorr =       1.270366129468
              std dev =       0.590388143112
             le_variance =       0.348558159528


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923574147321        initial
     6.2500e+00     6.2500e+01             7.4404e-05       -16.923574249216  <--
     2.5000e+01     2.5000e+02             1.9057e-05       -16.923574192254
     1.0000e+02     1.0000e+03             4.7951e-06       -16.923574152312

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 6.4016e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.085811e-01 1 1  ON 0
 uu_1                 1.423493e-01 1 1  ON 1
 uu_2                 4.179089e-02 1 1  ON 2
 uu_3                -1.999424e-02 1 1  ON 3
 uu_4                -6.430755e-02 1 1  ON 4
 uu_5                -9.683819e-02 1 1  ON 5
 uu_6                -1.234478e-01 1 1  ON 6
 uu_7                -1.370975e-01 1 1  ON 7
 uu_8                -1.297666e-01 1 1  ON 8
 uu_9                -1.000898e-01 1 1  ON 9
 ud_0                 4.421268e-01 1 1  ON 10
 ud_1                 1.757971e-01 1 1  ON 11
 ud_2                 5.597204e-02 1 1  ON 12
 ud_3                -1.380576e-02 1 1  ON 13
 ud_4                -6.880625e-02 1 1  ON 14
 ud_5                -1.070434e-01 1 1  ON 15
 ud_6                -1.311186e-01 1 1  ON 16
 ud_7                -1.454000e-01 1 1  ON 17
 ud_8                -1.447282e-01 1 1  ON 18
 ud_9                -1.345934e-01 1 1  ON 19
 eO_0                -7.656313e-01 1 1  ON 20
 eO_1                -4.443757e-01 1 1  ON 21
 eO_2                -2.188580e-02 1 1  ON 22
 eO_3                 3.005124e-01 1 1  ON 23
 eO_4                 5.274603e-01 1 1  ON 24
 eO_5                 4.841034e-01 1 1  ON 25
 eO_6                 2.519778e-01 1 1  ON 26
 eO_7                -4.867547e-02 1 1  ON 27
 eO_8                -2.113327e-01 1 1  ON 28
 eO_9                -7.228497e-02 1 1  ON 29
eH1_0                -2.366075e-01 1 1  ON 30
eH1_1                -1.378700e-01 1 1  ON 31
eH1_2                -9.280035e-02 1 1  ON 32
eH1_3                -3.786550e-02 1 1  ON 33
eH1_4                 6.797668e-03 1 1  ON 34
eH1_5                 4.068224e-02 1 1  ON 35
eH1_6                 9.587855e-02 1 1  ON 36
eH1_7                 1.472304e-01 1 1  ON 37
eH1_8                 1.651272e-01 1 1  ON 38
eH1_9                 5.257052e-02 1 1  ON 39
eH2_0                -2.333803e-01 1 1  ON 40
eH2_1                -1.347698e-01 1 1  ON 41
eH2_2                -8.937365e-02 1 1  ON 42
eH2_3                -3.496675e-02 1 1  ON 43
eH2_4                 1.056381e-02 1 1  ON 44
eH2_5                 4.331430e-02 1 1  ON 45
eH2_6                 9.921253e-02 1 1  ON 46
eH2_7                 1.514934e-01 1 1  ON 47
eH2_8                 1.700847e-01 1 1  ON 48
eH2_9                 3.559976e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2063e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9294
    reference variance = 0.318983
====================================================
  Execution time = 4.4538e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4573e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1992e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345745453553
                                         uncertainty =       0.005637467351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345745453553
                                         uncertainty =       0.005637467351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415770302
  error estimate for blocks of size 2^( 2) =       0.000428431728
  error estimate for blocks of size 2^( 3) =       0.000441424380
  error estimate for blocks of size 2^( 4) =       0.000454644769
  error estimate for blocks of size 2^( 5) =       0.000465086166
  error estimate for blocks of size 2^( 6) =       0.000473841689
  error estimate for blocks of size 2^( 7) =       0.000480013385

      target function =                  N/A
              le_mean =     -16.923514996065
             les_mean =     286.751089537071
             stat err =       0.000468396502
             autocorr =       1.269171633842
              std dev =       0.587987999784
             le_variance =       0.345729887890


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692351499607e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923514996065       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923519095202       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923519776791       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923519972631       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923520541909       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923520455714       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923520695389       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923520585673       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923520541320       residual = 5.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 2.731766e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923514996065       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923516080020       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923516250456       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923516311823       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923516446597       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923516433424       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923516479591       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923516460935       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923516444467       residual = 2.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 7.250957e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923514996065       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923515271023       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923515313672       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923515330029       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923515363181       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923515360374       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923515370830       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923515366913       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923515362569       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.843019e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133416 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6541e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.085754e-01 1 1  ON 0
 uu_1                 1.423620e-01 1 1  ON 1
 uu_2                 4.181491e-02 1 1  ON 2
 uu_3                -1.998288e-02 1 1  ON 3
 uu_4                -6.430183e-02 1 1  ON 4
 uu_5                -9.685765e-02 1 1  ON 5
 uu_6                -1.234631e-01 1 1  ON 6
 uu_7                -1.370971e-01 1 1  ON 7
 uu_8                -1.297795e-01 1 1  ON 8
 uu_9                -1.001070e-01 1 1  ON 9
 ud_0                 4.420542e-01 1 1  ON 10
 ud_1                 1.757498e-01 1 1  ON 11
 ud_2                 5.592681e-02 1 1  ON 12
 ud_3                -1.383335e-02 1 1  ON 13
 ud_4                -6.879939e-02 1 1  ON 14
 ud_5                -1.070041e-01 1 1  ON 15
 ud_6                -1.310752e-01 1 1  ON 16
 ud_7                -1.453585e-01 1 1  ON 17
 ud_8                -1.446954e-01 1 1  ON 18
 ud_9                -1.345765e-01 1 1  ON 19
 eO_0                -7.656903e-01 1 1  ON 20
 eO_1                -4.443966e-01 1 1  ON 21
 eO_2                -2.191823e-02 1 1  ON 22
 eO_3                 3.005022e-01 1 1  ON 23
 eO_4                 5.275195e-01 1 1  ON 24
 eO_5                 4.841577e-01 1 1  ON 25
 eO_6                 2.520178e-01 1 1  ON 26
 eO_7                -4.866217e-02 1 1  ON 27
 eO_8                -2.113521e-01 1 1  ON 28
 eO_9                -7.230611e-02 1 1  ON 29
eH1_0                -2.366076e-01 1 1  ON 30
eH1_1                -1.378794e-01 1 1  ON 31
eH1_2                -9.282434e-02 1 1  ON 32
eH1_3                -3.787073e-02 1 1  ON 33
eH1_4                 6.789071e-03 1 1  ON 34
eH1_5                 4.066108e-02 1 1  ON 35
eH1_6                 9.587043e-02 1 1  ON 36
eH1_7                 1.472486e-01 1 1  ON 37
eH1_8                 1.651596e-01 1 1  ON 38
eH1_9                 5.259634e-02 1 1  ON 39
eH2_0                -2.333536e-01 1 1  ON 40
eH2_1                -1.347567e-01 1 1  ON 41
eH2_2                -8.941173e-02 1 1  ON 42
eH2_3                -3.495299e-02 1 1  ON 43
eH2_4                 1.051726e-02 1 1  ON 44
eH2_5                 4.330066e-02 1 1  ON 45
eH2_6                 9.920780e-02 1 1  ON 46
eH2_7                 1.514982e-01 1 1  ON 47
eH2_8                 1.701041e-01 1 1  ON 48
eH2_9                 3.562473e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8772
    reference variance = 0.271595
====================================================
  Execution time = 4.3660e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3824e-01
  Total weights = 2.0000e+06
  Execution time = 4.0891e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338292379009
                                         uncertainty =       0.005271814721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338292379009
                                         uncertainty =       0.005271814721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411255434
  error estimate for blocks of size 2^( 2) =       0.000424416293
  error estimate for blocks of size 2^( 3) =       0.000437640968
  error estimate for blocks of size 2^( 4) =       0.000450372441
  error estimate for blocks of size 2^( 5) =       0.000460318639
  error estimate for blocks of size 2^( 6) =       0.000469428651
  error estimate for blocks of size 2^( 7) =       0.000472557162

      target function =                  N/A
              le_mean =     -16.923452127253
             les_mean =     286.741493798768
             stat err =       0.000463169223
             autocorr =       1.268399574171
              std dev =       0.581603012792
             le_variance =       0.338262064488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338207892755
                                         uncertainty =       0.005270085185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338207892755
                                         uncertainty =       0.005270085185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411204022
  error estimate for blocks of size 2^( 2) =       0.000424363760
  error estimate for blocks of size 2^( 3) =       0.000437586078
  error estimate for blocks of size 2^( 4) =       0.000450313403
  error estimate for blocks of size 2^( 5) =       0.000460255301
  error estimate for blocks of size 2^( 6) =       0.000469356737
  error estimate for blocks of size 2^( 7) =       0.000472485776

      target function =                  N/A
              le_mean =     -16.923451430257
             les_mean =     286.741385637802
             stat err =       0.000463102804
             autocorr =       1.268352925267
              std dev =       0.581530304130
             le_variance =       0.338177494622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338244071083
                                         uncertainty =       0.005270848284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338244071083
                                         uncertainty =       0.005270848284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411226036
  error estimate for blocks of size 2^( 2) =       0.000424386247
  error estimate for blocks of size 2^( 3) =       0.000437609613
  error estimate for blocks of size 2^( 4) =       0.000450338853
  error estimate for blocks of size 2^( 5) =       0.000460283088
  error estimate for blocks of size 2^( 6) =       0.000469388533
  error estimate for blocks of size 2^( 7) =       0.000472517405

      target function =                  N/A
              le_mean =     -16.923451694290
             les_mean =     286.741430785594
             stat err =       0.000463131970
             autocorr =       1.268376874173
              std dev =       0.581561437614
             le_variance =       0.338213705719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338286081381
                                         uncertainty =       0.005271690201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338286081381
                                         uncertainty =       0.005271690201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411251602
  error estimate for blocks of size 2^( 2) =       0.000424412373
  error estimate for blocks of size 2^( 3) =       0.000437636876
  error estimate for blocks of size 2^( 4) =       0.000450368062
  error estimate for blocks of size 2^( 5) =       0.000460314021
  error estimate for blocks of size 2^( 6) =       0.000469423451
  error estimate for blocks of size 2^( 7) =       0.000472552010

      target function =                  N/A
              le_mean =     -16.923452062380
             les_mean =     286.741485298672
             stat err =       0.000463164386
             autocorr =       1.268396721523
              std dev =       0.581597592962
             le_variance =       0.338255760139


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923452127253        initial  <--
     1.5625e+00     1.5625e+01             2.7318e-04       -16.923451430257
     6.2500e+00     6.2500e+01             7.2510e-05       -16.923451694290
     2.5000e+01     2.5000e+02             1.8430e-05       -16.923452062380

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.3039
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.085811e-01 1 1  ON 0
 uu_1                 1.423493e-01 1 1  ON 1
 uu_2                 4.179089e-02 1 1  ON 2
 uu_3                -1.999424e-02 1 1  ON 3
 uu_4                -6.430755e-02 1 1  ON 4
 uu_5                -9.683819e-02 1 1  ON 5
 uu_6                -1.234478e-01 1 1  ON 6
 uu_7                -1.370975e-01 1 1  ON 7
 uu_8                -1.297666e-01 1 1  ON 8
 uu_9                -1.000898e-01 1 1  ON 9
 ud_0                 4.421268e-01 1 1  ON 10
 ud_1                 1.757971e-01 1 1  ON 11
 ud_2                 5.597204e-02 1 1  ON 12
 ud_3                -1.380576e-02 1 1  ON 13
 ud_4                -6.880625e-02 1 1  ON 14
 ud_5                -1.070434e-01 1 1  ON 15
 ud_6                -1.311186e-01 1 1  ON 16
 ud_7                -1.454000e-01 1 1  ON 17
 ud_8                -1.447282e-01 1 1  ON 18
 ud_9                -1.345934e-01 1 1  ON 19
 eO_0                -7.656313e-01 1 1  ON 20
 eO_1                -4.443757e-01 1 1  ON 21
 eO_2                -2.188580e-02 1 1  ON 22
 eO_3                 3.005124e-01 1 1  ON 23
 eO_4                 5.274603e-01 1 1  ON 24
 eO_5                 4.841034e-01 1 1  ON 25
 eO_6                 2.519778e-01 1 1  ON 26
 eO_7                -4.867547e-02 1 1  ON 27
 eO_8                -2.113327e-01 1 1  ON 28
 eO_9                -7.228497e-02 1 1  ON 29
eH1_0                -2.366075e-01 1 1  ON 30
eH1_1                -1.378700e-01 1 1  ON 31
eH1_2                -9.280035e-02 1 1  ON 32
eH1_3                -3.786550e-02 1 1  ON 33
eH1_4                 6.797668e-03 1 1  ON 34
eH1_5                 4.068224e-02 1 1  ON 35
eH1_6                 9.587855e-02 1 1  ON 36
eH1_7                 1.472304e-01 1 1  ON 37
eH1_8                 1.651272e-01 1 1  ON 38
eH1_9                 5.257052e-02 1 1  ON 39
eH2_0                -2.333803e-01 1 1  ON 40
eH2_1                -1.347698e-01 1 1  ON 41
eH2_2                -8.937365e-02 1 1  ON 42
eH2_3                -3.496675e-02 1 1  ON 43
eH2_4                 1.056381e-02 1 1  ON 44
eH2_5                 4.331430e-02 1 1  ON 45
eH2_6                 9.921253e-02 1 1  ON 46
eH2_7                 1.514934e-01 1 1  ON 47
eH2_8                 1.700847e-01 1 1  ON 48
eH2_9                 3.559976e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2085e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9449
    reference variance = 0.281808
====================================================
  Execution time = 4.7575e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4243e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1923e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342468110628
                                         uncertainty =       0.004591252493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342468110628
                                         uncertainty =       0.004591252493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413778822
  error estimate for blocks of size 2^( 2) =       0.000426943611
  error estimate for blocks of size 2^( 3) =       0.000440984988
  error estimate for blocks of size 2^( 4) =       0.000454817598
  error estimate for blocks of size 2^( 5) =       0.000466253363
  error estimate for blocks of size 2^( 6) =       0.000476398700
  error estimate for blocks of size 2^( 7) =       0.000482012682

      target function =                  N/A
              le_mean =     -16.923918517703
             les_mean =     286.761443650253
             stat err =       0.000469870586
             autocorr =       1.289495999889
              std dev =       0.585171622349
             le_variance =       0.342425827602


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692391851770e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923918517703       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923918976910       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923919085121       residual = 8.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923919125718       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923919249757       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923919289471       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923919280153       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923919275223       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923919271098       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 2.973802e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923918517703       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923918633173       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923918660226       residual = 8.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923918670592       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923918701606       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923918711772       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923918709499       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923918708347       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923918707328       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 7.453559e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923918517703       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923918546613       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923918553376       residual = 8.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923918555981       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923918563735       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923918566292       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923918565727       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923918565444       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923918565191       residual = 1.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 1.864538e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138643 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9509e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.085783e-01 1 1  ON 0
 uu_1                 1.423511e-01 1 1  ON 1
 uu_2                 4.179274e-02 1 1  ON 2
 uu_3                -1.999242e-02 1 1  ON 3
 uu_4                -6.430755e-02 1 1  ON 4
 uu_5                -9.683894e-02 1 1  ON 5
 uu_6                -1.234485e-01 1 1  ON 6
 uu_7                -1.370977e-01 1 1  ON 7
 uu_8                -1.297693e-01 1 1  ON 8
 uu_9                -1.000910e-01 1 1  ON 9
 ud_0                 4.421193e-01 1 1  ON 10
 ud_1                 1.757900e-01 1 1  ON 11
 ud_2                 5.596860e-02 1 1  ON 12
 ud_3                -1.380985e-02 1 1  ON 13
 ud_4                -6.880452e-02 1 1  ON 14
 ud_5                -1.070410e-01 1 1  ON 15
 ud_6                -1.311158e-01 1 1  ON 16
 ud_7                -1.453942e-01 1 1  ON 17
 ud_8                -1.447245e-01 1 1  ON 18
 ud_9                -1.345892e-01 1 1  ON 19
 eO_0                -7.656367e-01 1 1  ON 20
 eO_1                -4.443769e-01 1 1  ON 21
 eO_2                -2.189149e-02 1 1  ON 22
 eO_3                 3.005106e-01 1 1  ON 23
 eO_4                 5.274665e-01 1 1  ON 24
 eO_5                 4.841100e-01 1 1  ON 25
 eO_6                 2.519800e-01 1 1  ON 26
 eO_7                -4.867325e-02 1 1  ON 27
 eO_8                -2.113339e-01 1 1  ON 28
 eO_9                -7.228660e-02 1 1  ON 29
eH1_0                -2.366087e-01 1 1  ON 30
eH1_1                -1.378709e-01 1 1  ON 31
eH1_2                -9.280237e-02 1 1  ON 32
eH1_3                -3.786484e-02 1 1  ON 33
eH1_4                 6.796171e-03 1 1  ON 34
eH1_5                 4.068061e-02 1 1  ON 35
eH1_6                 9.587864e-02 1 1  ON 36
eH1_7                 1.472319e-01 1 1  ON 37
eH1_8                 1.651296e-01 1 1  ON 38
eH1_9                 5.257305e-02 1 1  ON 39
eH2_0                -2.333813e-01 1 1  ON 40
eH2_1                -1.347694e-01 1 1  ON 41
eH2_2                -8.937742e-02 1 1  ON 42
eH2_3                -3.496457e-02 1 1  ON 43
eH2_4                 1.056081e-02 1 1  ON 44
eH2_5                 4.331347e-02 1 1  ON 45
eH2_6                 9.921139e-02 1 1  ON 46
eH2_7                 1.514930e-01 1 1  ON 47
eH2_8                 1.700873e-01 1 1  ON 48
eH2_9                 3.560400e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8849
    reference variance = 0.207412
====================================================
  Execution time = 4.3336e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.4201e-01
  Total weights = 2.0000e+06
  Execution time = 4.0832e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342072837469
                                         uncertainty =       0.004776485685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342072837469
                                         uncertainty =       0.004776485685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413526893
  error estimate for blocks of size 2^( 2) =       0.000426358106
  error estimate for blocks of size 2^( 3) =       0.000439467764
  error estimate for blocks of size 2^( 4) =       0.000452019923
  error estimate for blocks of size 2^( 5) =       0.000463732307
  error estimate for blocks of size 2^( 6) =       0.000471395535
  error estimate for blocks of size 2^( 7) =       0.000476629276

      target function =                  N/A
              le_mean =     -16.922878967981
             les_mean =     286.725841375835
             stat err =       0.000465944260
             autocorr =       1.269581005511
              std dev =       0.584815340002
             le_variance =       0.342008981901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342060072366
                                         uncertainty =       0.004776433459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342060072366
                                         uncertainty =       0.004776433459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413519178
  error estimate for blocks of size 2^( 2) =       0.000426350456
  error estimate for blocks of size 2^( 3) =       0.000439460109
  error estimate for blocks of size 2^( 4) =       0.000452012028
  error estimate for blocks of size 2^( 5) =       0.000463723688
  error estimate for blocks of size 2^( 6) =       0.000471385813
  error estimate for blocks of size 2^( 7) =       0.000476619350

      target function =                  N/A
              le_mean =     -16.922878891745
             les_mean =     286.725826035436
             stat err =       0.000465935220
             autocorr =       1.269579107223
              std dev =       0.584804430364
             le_variance =       0.341996221773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342066398083
                                         uncertainty =       0.004776459831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342066398083
                                         uncertainty =       0.004776459831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413523001
  error estimate for blocks of size 2^( 2) =       0.000426354248
  error estimate for blocks of size 2^( 3) =       0.000439463904
  error estimate for blocks of size 2^( 4) =       0.000452015942
  error estimate for blocks of size 2^( 5) =       0.000463727964
  error estimate for blocks of size 2^( 6) =       0.000471390637
  error estimate for blocks of size 2^( 7) =       0.000476624274

      target function =                  N/A
              le_mean =     -16.922878927873
             les_mean =     286.725833581498
             stat err =       0.000465939704
             autocorr =       1.269580072235
              std dev =       0.584809836669
             le_variance =       0.342002545065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342072030336
                                         uncertainty =       0.004776482463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342072030336
                                         uncertainty =       0.004776482463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413526405
  error estimate for blocks of size 2^( 2) =       0.000426357623
  error estimate for blocks of size 2^( 3) =       0.000439467280
  error estimate for blocks of size 2^( 4) =       0.000452019424
  error estimate for blocks of size 2^( 5) =       0.000463731763
  error estimate for blocks of size 2^( 6) =       0.000471394921
  error estimate for blocks of size 2^( 7) =       0.000476628649

      target function =                  N/A
              le_mean =     -16.922878962813
             les_mean =     286.725840394101
             stat err =       0.000465943689
             autocorr =       1.269580888924
              std dev =       0.584814650201
             le_variance =       0.342008175089


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.922878967981        initial  <--
     1.5625e+01     1.5625e+02             2.9738e-05       -16.922878891745
     6.2500e+01     6.2500e+02             7.4536e-06       -16.922878927873
     2.5000e+02     2.5000e+03             1.8645e-06       -16.922878962813

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.9698
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.085811e-01 1 1  ON 0
 uu_1                 1.423493e-01 1 1  ON 1
 uu_2                 4.179089e-02 1 1  ON 2
 uu_3                -1.999424e-02 1 1  ON 3
 uu_4                -6.430755e-02 1 1  ON 4
 uu_5                -9.683819e-02 1 1  ON 5
 uu_6                -1.234478e-01 1 1  ON 6
 uu_7                -1.370975e-01 1 1  ON 7
 uu_8                -1.297666e-01 1 1  ON 8
 uu_9                -1.000898e-01 1 1  ON 9
 ud_0                 4.421268e-01 1 1  ON 10
 ud_1                 1.757971e-01 1 1  ON 11
 ud_2                 5.597204e-02 1 1  ON 12
 ud_3                -1.380576e-02 1 1  ON 13
 ud_4                -6.880625e-02 1 1  ON 14
 ud_5                -1.070434e-01 1 1  ON 15
 ud_6                -1.311186e-01 1 1  ON 16
 ud_7                -1.454000e-01 1 1  ON 17
 ud_8                -1.447282e-01 1 1  ON 18
 ud_9                -1.345934e-01 1 1  ON 19
 eO_0                -7.656313e-01 1 1  ON 20
 eO_1                -4.443757e-01 1 1  ON 21
 eO_2                -2.188580e-02 1 1  ON 22
 eO_3                 3.005124e-01 1 1  ON 23
 eO_4                 5.274603e-01 1 1  ON 24
 eO_5                 4.841034e-01 1 1  ON 25
 eO_6                 2.519778e-01 1 1  ON 26
 eO_7                -4.867547e-02 1 1  ON 27
 eO_8                -2.113327e-01 1 1  ON 28
 eO_9                -7.228497e-02 1 1  ON 29
eH1_0                -2.366075e-01 1 1  ON 30
eH1_1                -1.378700e-01 1 1  ON 31
eH1_2                -9.280035e-02 1 1  ON 32
eH1_3                -3.786550e-02 1 1  ON 33
eH1_4                 6.797668e-03 1 1  ON 34
eH1_5                 4.068224e-02 1 1  ON 35
eH1_6                 9.587855e-02 1 1  ON 36
eH1_7                 1.472304e-01 1 1  ON 37
eH1_8                 1.651272e-01 1 1  ON 38
eH1_9                 5.257052e-02 1 1  ON 39
eH2_0                -2.333803e-01 1 1  ON 40
eH2_1                -1.347698e-01 1 1  ON 41
eH2_2                -8.937365e-02 1 1  ON 42
eH2_3                -3.496675e-02 1 1  ON 43
eH2_4                 1.056381e-02 1 1  ON 44
eH2_5                 4.331430e-02 1 1  ON 45
eH2_6                 9.921253e-02 1 1  ON 46
eH2_7                 1.514934e-01 1 1  ON 47
eH2_8                 1.700847e-01 1 1  ON 48
eH2_9                 3.559976e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2349e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9764
    reference variance = 0.276154
====================================================
  Execution time = 4.6374e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.5438e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2385e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354448804599
                                         uncertainty =       0.018129906493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354448804599
                                         uncertainty =       0.018129906493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420939472
  error estimate for blocks of size 2^( 2) =       0.000433343662
  error estimate for blocks of size 2^( 3) =       0.000445729483
  error estimate for blocks of size 2^( 4) =       0.000457250858
  error estimate for blocks of size 2^( 5) =       0.000468789885
  error estimate for blocks of size 2^( 6) =       0.000476830092
  error estimate for blocks of size 2^( 7) =       0.000479966538

      target function =                  N/A
              le_mean =     -16.923560257352
             les_mean =     286.761271685787
             stat err =       0.000470709343
             autocorr =       1.250450006929
              std dev =       0.595298310740
             le_variance =       0.354380078770


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692356025735e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923560257352       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923560279276       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923560279607       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923560275783       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923560285243       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923560289453       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923560288843       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923560288379       residual = 9.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 2.495723e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923560257352       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923560262836       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923560262918       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923560261961       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923560264324       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923560265377       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923560265225       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923560265108       residual = 8.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 6.246868e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923560257352       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923560258723       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923560258743       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923560258504       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923560259095       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923560259356       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923560259322       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923560259289       residual = 8.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 1.562191e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.142951 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8770e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.085811e-01 1 1  ON 0
 uu_1                 1.423495e-01 1 1  ON 1
 uu_2                 4.179111e-02 1 1  ON 2
 uu_3                -1.999409e-02 1 1  ON 3
 uu_4                -6.430751e-02 1 1  ON 4
 uu_5                -9.683819e-02 1 1  ON 5
 uu_6                -1.234479e-01 1 1  ON 6
 uu_7                -1.370978e-01 1 1  ON 7
 uu_8                -1.297671e-01 1 1  ON 8
 uu_9                -1.000900e-01 1 1  ON 9
 ud_0                 4.421264e-01 1 1  ON 10
 ud_1                 1.757965e-01 1 1  ON 11
 ud_2                 5.597172e-02 1 1  ON 12
 ud_3                -1.380600e-02 1 1  ON 13
 ud_4                -6.880614e-02 1 1  ON 14
 ud_5                -1.070430e-01 1 1  ON 15
 ud_6                -1.311182e-01 1 1  ON 16
 ud_7                -1.453995e-01 1 1  ON 17
 ud_8                -1.447280e-01 1 1  ON 18
 ud_9                -1.345933e-01 1 1  ON 19
 eO_0                -7.656318e-01 1 1  ON 20
 eO_1                -4.443757e-01 1 1  ON 21
 eO_2                -2.188622e-02 1 1  ON 22
 eO_3                 3.005122e-01 1 1  ON 23
 eO_4                 5.274608e-01 1 1  ON 24
 eO_5                 4.841039e-01 1 1  ON 25
 eO_6                 2.519783e-01 1 1  ON 26
 eO_7                -4.867535e-02 1 1  ON 27
 eO_8                -2.113330e-01 1 1  ON 28
 eO_9                -7.228518e-02 1 1  ON 29
eH1_0                -2.366075e-01 1 1  ON 30
eH1_1                -1.378700e-01 1 1  ON 31
eH1_2                -9.280050e-02 1 1  ON 32
eH1_3                -3.786546e-02 1 1  ON 33
eH1_4                 6.797647e-03 1 1  ON 34
eH1_5                 4.068213e-02 1 1  ON 35
eH1_6                 9.587832e-02 1 1  ON 36
eH1_7                 1.472305e-01 1 1  ON 37
eH1_8                 1.651275e-01 1 1  ON 38
eH1_9                 5.257073e-02 1 1  ON 39
eH2_0                -2.333801e-01 1 1  ON 40
eH2_1                -1.347697e-01 1 1  ON 41
eH2_2                -8.937390e-02 1 1  ON 42
eH2_3                -3.496654e-02 1 1  ON 43
eH2_4                 1.056348e-02 1 1  ON 44
eH2_5                 4.331426e-02 1 1  ON 45
eH2_6                 9.921232e-02 1 1  ON 46
eH2_7                 1.514933e-01 1 1  ON 47
eH2_8                 1.700848e-01 1 1  ON 48
eH2_9                 3.560004e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9869
    reference variance = 0.186329
====================================================
  Execution time = 4.3435e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.6214e-01
  Total weights = 2.0000e+06
  Execution time = 4.0790e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362212834007
                                         uncertainty =       0.010488554336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362212834007
                                         uncertainty =       0.010488554336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425523917
  error estimate for blocks of size 2^( 2) =       0.000442571735
  error estimate for blocks of size 2^( 3) =       0.000463919831
  error estimate for blocks of size 2^( 4) =       0.000492486796
  error estimate for blocks of size 2^( 5) =       0.000522669010
  error estimate for blocks of size 2^( 6) =       0.000565173134
  error estimate for blocks of size 2^( 7) =       0.000616981065

      target function =                  N/A
              le_mean =     -16.923402297206
             les_mean =     286.763686340465
             stat err =       0.000549327501
             autocorr =       1.666536126881
              std dev =       0.601781695006
             le_variance =       0.362141208445

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362213169354
                                         uncertainty =       0.010488542397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362213169354
                                         uncertainty =       0.010488542397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425524114
  error estimate for blocks of size 2^( 2) =       0.000442571894
  error estimate for blocks of size 2^( 3) =       0.000463919930
  error estimate for blocks of size 2^( 4) =       0.000492486805
  error estimate for blocks of size 2^( 5) =       0.000522668909
  error estimate for blocks of size 2^( 6) =       0.000565172915
  error estimate for blocks of size 2^( 7) =       0.000616980783

      target function =                  N/A
              le_mean =     -16.923402310482
             les_mean =     286.763687125289
             stat err =       0.000549327353
             autocorr =       1.666533683942
              std dev =       0.601781973762
             le_variance =       0.362141543945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362213002866
                                         uncertainty =       0.010488548367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362213002866
                                         uncertainty =       0.010488548367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425524017
  error estimate for blocks of size 2^( 2) =       0.000442571815
  error estimate for blocks of size 2^( 3) =       0.000463919881
  error estimate for blocks of size 2^( 4) =       0.000492486801
  error estimate for blocks of size 2^( 5) =       0.000522668960
  error estimate for blocks of size 2^( 6) =       0.000565173024
  error estimate for blocks of size 2^( 7) =       0.000616980924

      target function =                  N/A
              le_mean =     -16.923402303847
             les_mean =     286.763686734152
             stat err =       0.000549327427
             autocorr =       1.666534902114
              std dev =       0.601781835370
             le_variance =       0.362141377381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362212855149
                                         uncertainty =       0.010488553590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362212855149
                                         uncertainty =       0.010488553590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425523930
  error estimate for blocks of size 2^( 2) =       0.000442571745
  error estimate for blocks of size 2^( 3) =       0.000463919838
  error estimate for blocks of size 2^( 4) =       0.000492486796
  error estimate for blocks of size 2^( 5) =       0.000522669004
  error estimate for blocks of size 2^( 6) =       0.000565173120
  error estimate for blocks of size 2^( 7) =       0.000616981048

      target function =                  N/A
              le_mean =     -16.923402298036
             les_mean =     286.763686389694
             stat err =       0.000549327492
             autocorr =       1.666535973683
              std dev =       0.601781712581
             le_variance =       0.362141229597


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923402297206        initial
     1.5625e+02     1.5625e+03             2.4957e-06       -16.923402310482  <--
     6.2500e+02     6.2500e+03             6.2469e-07       -16.923402303847
     2.5000e+03     2.5000e+04             1.5622e-07       -16.923402298036

*****************************************************************************
Applying the update for shift_i =   1.5625e+02     and shift_s =   1.5625e+03
*****************************************************************************

  Execution time = 6.4059e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.085813e-01 1 1  ON 0
 uu_1                 1.423503e-01 1 1  ON 1
 uu_2                 4.179178e-02 1 1  ON 2
 uu_3                -1.999364e-02 1 1  ON 3
 uu_4                -6.430736e-02 1 1  ON 4
 uu_5                -9.683819e-02 1 1  ON 5
 uu_6                -1.234479e-01 1 1  ON 6
 uu_7                -1.370986e-01 1 1  ON 7
 uu_8                -1.297683e-01 1 1  ON 8
 uu_9                -1.000907e-01 1 1  ON 9
 ud_0                 4.421254e-01 1 1  ON 10
 ud_1                 1.757946e-01 1 1  ON 11
 ud_2                 5.597076e-02 1 1  ON 12
 ud_3                -1.380674e-02 1 1  ON 13
 ud_4                -6.880582e-02 1 1  ON 14
 ud_5                -1.070418e-01 1 1  ON 15
 ud_6                -1.311170e-01 1 1  ON 16
 ud_7                -1.453979e-01 1 1  ON 17
 ud_8                -1.447274e-01 1 1  ON 18
 ud_9                -1.345933e-01 1 1  ON 19
 eO_0                -7.656332e-01 1 1  ON 20
 eO_1                -4.443756e-01 1 1  ON 21
 eO_2                -2.188747e-02 1 1  ON 22
 eO_3                 3.005117e-01 1 1  ON 23
 eO_4                 5.274623e-01 1 1  ON 24
 eO_5                 4.841055e-01 1 1  ON 25
 eO_6                 2.519798e-01 1 1  ON 26
 eO_7                -4.867502e-02 1 1  ON 27
 eO_8                -2.113339e-01 1 1  ON 28
 eO_9                -7.228582e-02 1 1  ON 29
eH1_0                -2.366077e-01 1 1  ON 30
eH1_1                -1.378698e-01 1 1  ON 31
eH1_2                -9.280094e-02 1 1  ON 32
eH1_3                -3.786534e-02 1 1  ON 33
eH1_4                 6.797584e-03 1 1  ON 34
eH1_5                 4.068181e-02 1 1  ON 35
eH1_6                 9.587763e-02 1 1  ON 36
eH1_7                 1.472306e-01 1 1  ON 37
eH1_8                 1.651281e-01 1 1  ON 38
eH1_9                 5.257139e-02 1 1  ON 39
eH2_0                -2.333795e-01 1 1  ON 40
eH2_1                -1.347694e-01 1 1  ON 41
eH2_2                -8.937465e-02 1 1  ON 42
eH2_3                -3.496593e-02 1 1  ON 43
eH2_4                 1.056246e-02 1 1  ON 44
eH2_5                 4.331416e-02 1 1  ON 45
eH2_6                 9.921168e-02 1 1  ON 46
eH2_7                 1.514931e-01 1 1  ON 47
eH2_8                 1.700851e-01 1 1  ON 48
eH2_9                 3.560088e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2284e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9667
    reference variance = 0.473211
====================================================
  Execution time = 4.4354e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4155e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1964e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341622492866
                                         uncertainty =       0.005233813037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341622492866
                                         uncertainty =       0.005233813037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413249714
  error estimate for blocks of size 2^( 2) =       0.000426328299
  error estimate for blocks of size 2^( 3) =       0.000439892099
  error estimate for blocks of size 2^( 4) =       0.000452427782
  error estimate for blocks of size 2^( 5) =       0.000465999677
  error estimate for blocks of size 2^( 6) =       0.000477231864
  error estimate for blocks of size 2^( 7) =       0.000482531673

      target function =                  N/A
              le_mean =     -16.923660269828
             les_mean =     286.751827409308
             stat err =       0.000469547749
             autocorr =       1.291024259141
              std dev =       0.584423349574
             le_variance =       0.341550651528


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692366026983e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923660269828       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923660465301       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923660493154       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923660519914       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923660512141       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923660521282       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923660524044       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923660523120       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923660524544       residual = 1.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.068827e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923660269828       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923660318809       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923660325770       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923660332495       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923660330518       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923660332770       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923660333474       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923660333245       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923660333596       residual = 1.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 2.673647e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923660269828       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923660282080       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923660283820       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923660285504       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923660285007       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923660285568       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923660285745       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923660285686       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923660285777       residual = 1.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 6.685103e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147991 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6328e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.085813e-01 1 1  ON 0
 uu_1                 1.423502e-01 1 1  ON 1
 uu_2                 4.179270e-02 1 1  ON 2
 uu_3                -1.999350e-02 1 1  ON 3
 uu_4                -6.430733e-02 1 1  ON 4
 uu_5                -9.683855e-02 1 1  ON 5
 uu_6                -1.234478e-01 1 1  ON 6
 uu_7                -1.370991e-01 1 1  ON 7
 uu_8                -1.297689e-01 1 1  ON 8
 uu_9                -1.000911e-01 1 1  ON 9
 ud_0                 4.421228e-01 1 1  ON 10
 ud_1                 1.757925e-01 1 1  ON 11
 ud_2                 5.596907e-02 1 1  ON 12
 ud_3                -1.380798e-02 1 1  ON 13
 ud_4                -6.880536e-02 1 1  ON 14
 ud_5                -1.070407e-01 1 1  ON 15
 ud_6                -1.311164e-01 1 1  ON 16
 ud_7                -1.453959e-01 1 1  ON 17
 ud_8                -1.447256e-01 1 1  ON 18
 ud_9                -1.345919e-01 1 1  ON 19
 eO_0                -7.656354e-01 1 1  ON 20
 eO_1                -4.443768e-01 1 1  ON 21
 eO_2                -2.188887e-02 1 1  ON 22
 eO_3                 3.005109e-01 1 1  ON 23
 eO_4                 5.274650e-01 1 1  ON 24
 eO_5                 4.841076e-01 1 1  ON 25
 eO_6                 2.519813e-01 1 1  ON 26
 eO_7                -4.867431e-02 1 1  ON 27
 eO_8                -2.113346e-01 1 1  ON 28
 eO_9                -7.228647e-02 1 1  ON 29
eH1_0                -2.366077e-01 1 1  ON 30
eH1_1                -1.378696e-01 1 1  ON 31
eH1_2                -9.280196e-02 1 1  ON 32
eH1_3                -3.786544e-02 1 1  ON 33
eH1_4                 6.796466e-03 1 1  ON 34
eH1_5                 4.068147e-02 1 1  ON 35
eH1_6                 9.587743e-02 1 1  ON 36
eH1_7                 1.472308e-01 1 1  ON 37
eH1_8                 1.651293e-01 1 1  ON 38
eH1_9                 5.257252e-02 1 1  ON 39
eH2_0                -2.333790e-01 1 1  ON 40
eH2_1                -1.347695e-01 1 1  ON 41
eH2_2                -8.937570e-02 1 1  ON 42
eH2_3                -3.496582e-02 1 1  ON 43
eH2_4                 1.056126e-02 1 1  ON 44
eH2_5                 4.331363e-02 1 1  ON 45
eH2_6                 9.921170e-02 1 1  ON 46
eH2_7                 1.514929e-01 1 1  ON 47
eH2_8                 1.700857e-01 1 1  ON 48
eH2_9                 3.560243e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9476
    reference variance = 0.193853
====================================================
  Execution time = 4.7065e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3703e-01
  Total weights = 2.0000e+06
  Execution time = 4.0700e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336981148907
                                         uncertainty =       0.003651719329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336981148907
                                         uncertainty =       0.003651719329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410505240
  error estimate for blocks of size 2^( 2) =       0.000423079502
  error estimate for blocks of size 2^( 3) =       0.000435804581
  error estimate for blocks of size 2^( 4) =       0.000448859473
  error estimate for blocks of size 2^( 5) =       0.000459878711
  error estimate for blocks of size 2^( 6) =       0.000470233714
  error estimate for blocks of size 2^( 7) =       0.000473959405

      target function =                  N/A
              le_mean =     -16.923262501136
             les_mean =     286.733842618419
             stat err =       0.000463232826
             autocorr =       1.273389437687
              std dev =       0.580542078205
             le_variance =       0.337029104567

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336978121286
                                         uncertainty =       0.003651697573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336978121286
                                         uncertainty =       0.003651697573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410503394
  error estimate for blocks of size 2^( 2) =       0.000423077650
  error estimate for blocks of size 2^( 3) =       0.000435802769
  error estimate for blocks of size 2^( 4) =       0.000448857617
  error estimate for blocks of size 2^( 5) =       0.000459876687
  error estimate for blocks of size 2^( 6) =       0.000470231632
  error estimate for blocks of size 2^( 7) =       0.000473957143

      target function =                  N/A
              le_mean =     -16.923262518706
             les_mean =     286.733840181666
             stat err =       0.000463230770
             autocorr =       1.273389588483
              std dev =       0.580539467351
             le_variance =       0.337026073152

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336979628038
                                         uncertainty =       0.003651708510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336979628038
                                         uncertainty =       0.003651708510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410504313
  error estimate for blocks of size 2^( 2) =       0.000423078572
  error estimate for blocks of size 2^( 3) =       0.000435803671
  error estimate for blocks of size 2^( 4) =       0.000448858541
  error estimate for blocks of size 2^( 5) =       0.000459877695
  error estimate for blocks of size 2^( 6) =       0.000470232670
  error estimate for blocks of size 2^( 7) =       0.000473958272

      target function =                  N/A
              le_mean =     -16.923262509892
             les_mean =     286.733841391999
             stat err =       0.000463231795
             autocorr =       1.273389521315
              std dev =       0.580540766697
             le_variance =       0.337027581797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336980958542
                                         uncertainty =       0.003651717978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336980958542
                                         uncertainty =       0.003651717978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410505124
  error estimate for blocks of size 2^( 2) =       0.000423079386
  error estimate for blocks of size 2^( 3) =       0.000435804467
  error estimate for blocks of size 2^( 4) =       0.000448859356
  error estimate for blocks of size 2^( 5) =       0.000459878584
  error estimate for blocks of size 2^( 6) =       0.000470233584
  error estimate for blocks of size 2^( 7) =       0.000473959264

      target function =                  N/A
              le_mean =     -16.923262502219
             les_mean =     286.733842464474
             stat err =       0.000463232697
             autocorr =       1.273389448331
              std dev =       0.580541914046
             le_variance =       0.337028913964


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923262501136        initial
     3.9062e+01     3.9062e+02             1.0688e-05       -16.923262518706  <--
     1.5625e+02     1.5625e+03             2.6736e-06       -16.923262509892
     6.2500e+02     6.2500e+03             6.6851e-07       -16.923262502219

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 6.7633e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.085815e-01 1 1  ON 0
 uu_1                 1.423502e-01 1 1  ON 1
 uu_2                 4.179543e-02 1 1  ON 2
 uu_3                -1.999306e-02 1 1  ON 3
 uu_4                -6.430725e-02 1 1  ON 4
 uu_5                -9.683964e-02 1 1  ON 5
 uu_6                -1.234474e-01 1 1  ON 6
 uu_7                -1.371005e-01 1 1  ON 7
 uu_8                -1.297707e-01 1 1  ON 8
 uu_9                -1.000924e-01 1 1  ON 9
 ud_0                 4.421149e-01 1 1  ON 10
 ud_1                 1.757863e-01 1 1  ON 11
 ud_2                 5.596400e-02 1 1  ON 12
 ud_3                -1.381170e-02 1 1  ON 13
 ud_4                -6.880400e-02 1 1  ON 14
 ud_5                -1.070376e-01 1 1  ON 15
 ud_6                -1.311146e-01 1 1  ON 16
 ud_7                -1.453900e-01 1 1  ON 17
 ud_8                -1.447205e-01 1 1  ON 18
 ud_9                -1.345878e-01 1 1  ON 19
 eO_0                -7.656420e-01 1 1  ON 20
 eO_1                -4.443804e-01 1 1  ON 21
 eO_2                -2.189306e-02 1 1  ON 22
 eO_3                 3.005083e-01 1 1  ON 23
 eO_4                 5.274730e-01 1 1  ON 24
 eO_5                 4.841140e-01 1 1  ON 25
 eO_6                 2.519861e-01 1 1  ON 26
 eO_7                -4.867217e-02 1 1  ON 27
 eO_8                -2.113367e-01 1 1  ON 28
 eO_9                -7.228841e-02 1 1  ON 29
eH1_0                -2.366077e-01 1 1  ON 30
eH1_1                -1.378692e-01 1 1  ON 31
eH1_2                -9.280498e-02 1 1  ON 32
eH1_3                -3.786577e-02 1 1  ON 33
eH1_4                 6.793119e-03 1 1  ON 34
eH1_5                 4.068046e-02 1 1  ON 35
eH1_6                 9.587682e-02 1 1  ON 36
eH1_7                 1.472314e-01 1 1  ON 37
eH1_8                 1.651329e-01 1 1  ON 38
eH1_9                 5.257591e-02 1 1  ON 39
eH2_0                -2.333778e-01 1 1  ON 40
eH2_1                -1.347696e-01 1 1  ON 41
eH2_2                -8.937882e-02 1 1  ON 42
eH2_3                -3.496551e-02 1 1  ON 43
eH2_4                 1.055769e-02 1 1  ON 44
eH2_5                 4.331204e-02 1 1  ON 45
eH2_6                 9.921174e-02 1 1  ON 46
eH2_7                 1.514924e-01 1 1  ON 47
eH2_8                 1.700875e-01 1 1  ON 48
eH2_9                 3.560707e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2398e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6929e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9509
    reference variance = 0.492353
====================================================
  Execution time = 4.4730e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.5803e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2077e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358171022669
                                         uncertainty =       0.015560230300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358171022669
                                         uncertainty =       0.015560230300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423100196
  error estimate for blocks of size 2^( 2) =       0.000435517945
  error estimate for blocks of size 2^( 3) =       0.000447722088
  error estimate for blocks of size 2^( 4) =       0.000459618468
  error estimate for blocks of size 2^( 5) =       0.000471071331
  error estimate for blocks of size 2^( 6) =       0.000478808455
  error estimate for blocks of size 2^( 7) =       0.000483738560

      target function =                  N/A
              le_mean =     -16.923714998491
             les_mean =     286.770156722402
             stat err =       0.000473309203
             autocorr =       1.251421021686
              std dev =       0.598354035054
             le_variance =       0.358027551266


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692371499849e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923714998491       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923715512799       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923715661172       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923715926504       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923715924928       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923715942578       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923715953320       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923715949738       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923715939082       residual = 1.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 4.252545e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923714998491       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923715128191       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923715165475       residual = 7.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923715233377       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923715232809       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923715237282       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923715239810       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923715238843       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923715236246       residual = 1.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.069682e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923714998491       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923715030987       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923715040320       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923715057397       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923715057245       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923715058367       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923715058989       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923715058742       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923715058097       residual = 1.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 2.678304e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153411 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6819e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.085833e-01 1 1  ON 0
 uu_1                 1.423527e-01 1 1  ON 1
 uu_2                 4.179966e-02 1 1  ON 2
 uu_3                -1.999170e-02 1 1  ON 3
 uu_4                -6.430941e-02 1 1  ON 4
 uu_5                -9.684245e-02 1 1  ON 5
 uu_6                -1.234486e-01 1 1  ON 6
 uu_7                -1.371011e-01 1 1  ON 7
 uu_8                -1.297743e-01 1 1  ON 8
 uu_9                -1.000946e-01 1 1  ON 9
 ud_0                 4.421042e-01 1 1  ON 10
 ud_1                 1.757775e-01 1 1  ON 11
 ud_2                 5.595658e-02 1 1  ON 12
 ud_3                -1.381672e-02 1 1  ON 13
 ud_4                -6.880058e-02 1 1  ON 14
 ud_5                -1.070310e-01 1 1  ON 15
 ud_6                -1.311065e-01 1 1  ON 16
 ud_7                -1.453825e-01 1 1  ON 17
 ud_8                -1.447164e-01 1 1  ON 18
 ud_9                -1.345862e-01 1 1  ON 19
 eO_0                -7.656515e-01 1 1  ON 20
 eO_1                -4.443840e-01 1 1  ON 21
 eO_2                -2.190018e-02 1 1  ON 22
 eO_3                 3.005089e-01 1 1  ON 23
 eO_4                 5.274825e-01 1 1  ON 24
 eO_5                 4.841215e-01 1 1  ON 25
 eO_6                 2.519932e-01 1 1  ON 26
 eO_7                -4.866917e-02 1 1  ON 27
 eO_8                -2.113398e-01 1 1  ON 28
 eO_9                -7.229211e-02 1 1  ON 29
eH1_0                -2.366060e-01 1 1  ON 30
eH1_1                -1.378694e-01 1 1  ON 31
eH1_2                -9.280825e-02 1 1  ON 32
eH1_3                -3.786585e-02 1 1  ON 33
eH1_4                 6.789108e-03 1 1  ON 34
eH1_5                 4.067878e-02 1 1  ON 35
eH1_6                 9.587746e-02 1 1  ON 36
eH1_7                 1.472308e-01 1 1  ON 37
eH1_8                 1.651359e-01 1 1  ON 38
eH1_9                 5.258039e-02 1 1  ON 39
eH2_0                -2.333788e-01 1 1  ON 40
eH2_1                -1.347682e-01 1 1  ON 41
eH2_2                -8.938338e-02 1 1  ON 42
eH2_3                -3.496341e-02 1 1  ON 43
eH2_4                 1.055275e-02 1 1  ON 44
eH2_5                 4.331100e-02 1 1  ON 45
eH2_6                 9.920869e-02 1 1  ON 46
eH2_7                 1.514940e-01 1 1  ON 47
eH2_8                 1.700916e-01 1 1  ON 48
eH2_9                 3.561243e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.0043
    reference variance = 0.330747
====================================================
  Execution time = 4.5528e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4149e-01
  Total weights = 2.0000e+06
  Execution time = 4.4418e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341566209397
                                         uncertainty =       0.005913149821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341566209397
                                         uncertainty =       0.005913149821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413214876
  error estimate for blocks of size 2^( 2) =       0.000426092673
  error estimate for blocks of size 2^( 3) =       0.000439343077
  error estimate for blocks of size 2^( 4) =       0.000451862221
  error estimate for blocks of size 2^( 5) =       0.000463460288
  error estimate for blocks of size 2^( 6) =       0.000471570759
  error estimate for blocks of size 2^( 7) =       0.000478622869

      target function =                  N/A
              le_mean =     -16.923822408738
             les_mean =     286.757257818646
             stat err =       0.000466379034
             autocorr =       1.273873027180
              std dev =       0.584374081293
             le_variance =       0.341493066887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341556949819
                                         uncertainty =       0.005913019152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341556949819
                                         uncertainty =       0.005913019152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413209275
  error estimate for blocks of size 2^( 2) =       0.000426087023
  error estimate for blocks of size 2^( 3) =       0.000439336953
  error estimate for blocks of size 2^( 4) =       0.000451855219
  error estimate for blocks of size 2^( 5) =       0.000463452282
  error estimate for blocks of size 2^( 6) =       0.000471562494
  error estimate for blocks of size 2^( 7) =       0.000478613982

      target function =                  N/A
              le_mean =     -16.923822428392
             les_mean =     286.757249226132
             stat err =       0.000466370994
             autocorr =       1.273863640588
              std dev =       0.584366160164
             le_variance =       0.341483809145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341561514531
                                         uncertainty =       0.005913085180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341561514531
                                         uncertainty =       0.005913085180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413212036
  error estimate for blocks of size 2^( 2) =       0.000426089809
  error estimate for blocks of size 2^( 3) =       0.000439339970
  error estimate for blocks of size 2^( 4) =       0.000451858670
  error estimate for blocks of size 2^( 5) =       0.000463456232
  error estimate for blocks of size 2^( 6) =       0.000471566571
  error estimate for blocks of size 2^( 7) =       0.000478618366

      target function =                  N/A
              le_mean =     -16.923822417869
             les_mean =     286.757253433764
             stat err =       0.000466374960
             autocorr =       1.273868278942
              std dev =       0.584370065056
             le_variance =       0.341488372934

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341565619883
                                         uncertainty =       0.005913141762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341565619883
                                         uncertainty =       0.005913141762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413214519
  error estimate for blocks of size 2^( 2) =       0.000426092313
  error estimate for blocks of size 2^( 3) =       0.000439342686
  error estimate for blocks of size 2^( 4) =       0.000451861775
  error estimate for blocks of size 2^( 5) =       0.000463459779
  error estimate for blocks of size 2^( 6) =       0.000471570233
  error estimate for blocks of size 2^( 7) =       0.000478622303

      target function =                  N/A
              le_mean =     -16.923822409680
             les_mean =     286.757257261135
             stat err =       0.000466378522
             autocorr =       1.273872430746
              std dev =       0.584373576992
             le_variance =       0.341492477486


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923822408738        initial
     9.7656e+00     9.7656e+01             4.2525e-05       -16.923822428392  <--
     3.9062e+01     3.9062e+02             1.0697e-05       -16.923822417869
     1.5625e+02     1.5625e+03             2.6783e-06       -16.923822409680

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 6.6594e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.085889e-01 1 1  ON 0
 uu_1                 1.423602e-01 1 1  ON 1
 uu_2                 4.181200e-02 1 1  ON 2
 uu_3                -1.998760e-02 1 1  ON 3
 uu_4                -6.431585e-02 1 1  ON 4
 uu_5                -9.685075e-02 1 1  ON 5
 uu_6                -1.234523e-01 1 1  ON 6
 uu_7                -1.371031e-01 1 1  ON 7
 uu_8                -1.297852e-01 1 1  ON 8
 uu_9                -1.001014e-01 1 1  ON 9
 ud_0                 4.420724e-01 1 1  ON 10
 ud_1                 1.757515e-01 1 1  ON 11
 ud_2                 5.593446e-02 1 1  ON 12
 ud_3                -1.383160e-02 1 1  ON 13
 ud_4                -6.879077e-02 1 1  ON 14
 ud_5                -1.070115e-01 1 1  ON 15
 ud_6                -1.310825e-01 1 1  ON 16
 ud_7                -1.453600e-01 1 1  ON 17
 ud_8                -1.447040e-01 1 1  ON 18
 ud_9                -1.345811e-01 1 1  ON 19
 eO_0                -7.656795e-01 1 1  ON 20
 eO_1                -4.443954e-01 1 1  ON 21
 eO_2                -2.192132e-02 1 1  ON 22
 eO_3                 3.005105e-01 1 1  ON 23
 eO_4                 5.275112e-01 1 1  ON 24
 eO_5                 4.841440e-01 1 1  ON 25
 eO_6                 2.520147e-01 1 1  ON 26
 eO_7                -4.866022e-02 1 1  ON 27
 eO_8                -2.113493e-01 1 1  ON 28
 eO_9                -7.230319e-02 1 1  ON 29
eH1_0                -2.366009e-01 1 1  ON 30
eH1_1                -1.378700e-01 1 1  ON 31
eH1_2                -9.281785e-02 1 1  ON 32
eH1_3                -3.786626e-02 1 1  ON 33
eH1_4                 6.777177e-03 1 1  ON 34
eH1_5                 4.067367e-02 1 1  ON 35
eH1_6                 9.587937e-02 1 1  ON 36
eH1_7                 1.472291e-01 1 1  ON 37
eH1_8                 1.651448e-01 1 1  ON 38
eH1_9                 5.259379e-02 1 1  ON 39
eH2_0                -2.333816e-01 1 1  ON 40
eH2_1                -1.347641e-01 1 1  ON 41
eH2_2                -8.939672e-02 1 1  ON 42
eH2_3                -3.495745e-02 1 1  ON 43
eH2_4                 1.053816e-02 1 1  ON 44
eH2_5                 4.330776e-02 1 1  ON 45
eH2_6                 9.919954e-02 1 1  ON 46
eH2_7                 1.514987e-01 1 1  ON 47
eH2_8                 1.701040e-01 1 1  ON 48
eH2_9                 3.562847e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2342e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6934e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8474
    reference variance = 0.300757
====================================================
  Execution time = 4.4322e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3525e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1900e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335310199776
                                         uncertainty =       0.003755838357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335310199776
                                         uncertainty =       0.003755838357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409421411
  error estimate for blocks of size 2^( 2) =       0.000422357032
  error estimate for blocks of size 2^( 3) =       0.000434935070
  error estimate for blocks of size 2^( 4) =       0.000446988169
  error estimate for blocks of size 2^( 5) =       0.000457332505
  error estimate for blocks of size 2^( 6) =       0.000464403217
  error estimate for blocks of size 2^( 7) =       0.000468062969

      target function =                  N/A
              le_mean =     -16.922934929542
             les_mean =     286.720978245196
             stat err =       0.000459196715
             autocorr =       1.257929910439
              std dev =       0.579009311938
             le_variance =       0.335251783311


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692293492954e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922934929542       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922937500178       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922937825743       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922938068185       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922938010642       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922937889333       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922938205964       residual = 8.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922938173139       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.922938141442       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.674198e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922934929542       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922935596502       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922935677634       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922935747156       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922935733665       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922935701001       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922935773810       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922935770618       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.922935761066       residual = 2.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 4.313356e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922934929542       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922935097873       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922935118147       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922935136189       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922935132900       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922935124590       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922935142282       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922935141836       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.922935139396       residual = 1.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.087061e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159214 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6234e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.085944e-01 1 1  ON 0
 uu_1                 1.423792e-01 1 1  ON 1
 uu_2                 4.183127e-02 1 1  ON 2
 uu_3                -1.997164e-02 1 1  ON 3
 uu_4                -6.430602e-02 1 1  ON 4
 uu_5                -9.685812e-02 1 1  ON 5
 uu_6                -1.234534e-01 1 1  ON 6
 uu_7                -1.371028e-01 1 1  ON 7
 uu_8                -1.298181e-01 1 1  ON 8
 uu_9                -1.001296e-01 1 1  ON 9
 ud_0                 4.420315e-01 1 1  ON 10
 ud_1                 1.757235e-01 1 1  ON 11
 ud_2                 5.591199e-02 1 1  ON 12
 ud_3                -1.384785e-02 1 1  ON 13
 ud_4                -6.877235e-02 1 1  ON 14
 ud_5                -1.069835e-01 1 1  ON 15
 ud_6                -1.310394e-01 1 1  ON 16
 ud_7                -1.453192e-01 1 1  ON 17
 ud_8                -1.447009e-01 1 1  ON 18
 ud_9                -1.345910e-01 1 1  ON 19
 eO_0                -7.657219e-01 1 1  ON 20
 eO_1                -4.444053e-01 1 1  ON 21
 eO_2                -2.193613e-02 1 1  ON 22
 eO_3                 3.005066e-01 1 1  ON 23
 eO_4                 5.275501e-01 1 1  ON 24
 eO_5                 4.841738e-01 1 1  ON 25
 eO_6                 2.520468e-01 1 1  ON 26
 eO_7                -4.864726e-02 1 1  ON 27
 eO_8                -2.113717e-01 1 1  ON 28
 eO_9                -7.232066e-02 1 1  ON 29
eH1_0                -2.365883e-01 1 1  ON 30
eH1_1                -1.378823e-01 1 1  ON 31
eH1_2                -9.281992e-02 1 1  ON 32
eH1_3                -3.786175e-02 1 1  ON 33
eH1_4                 6.764126e-03 1 1  ON 34
eH1_5                 4.066182e-02 1 1  ON 35
eH1_6                 9.587171e-02 1 1  ON 36
eH1_7                 1.472330e-01 1 1  ON 37
eH1_8                 1.651615e-01 1 1  ON 38
eH1_9                 5.260630e-02 1 1  ON 39
eH2_0                -2.333788e-01 1 1  ON 40
eH2_1                -1.347596e-01 1 1  ON 41
eH2_2                -8.940526e-02 1 1  ON 42
eH2_3                -3.494706e-02 1 1  ON 43
eH2_4                 1.052254e-02 1 1  ON 44
eH2_5                 4.331436e-02 1 1  ON 45
eH2_6                 9.919036e-02 1 1  ON 46
eH2_7                 1.514987e-01 1 1  ON 47
eH2_8                 1.701066e-01 1 1  ON 48
eH2_9                 3.563889e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9365
    reference variance = 0.200655
====================================================
  Execution time = 4.3303e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3136e-01
  Total weights = 2.0000e+06
  Execution time = 4.1031e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331432305973
                                         uncertainty =       0.003214646455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331432305973
                                         uncertainty =       0.003214646455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407050027
  error estimate for blocks of size 2^( 2) =       0.000420032096
  error estimate for blocks of size 2^( 3) =       0.000433759139
  error estimate for blocks of size 2^( 4) =       0.000447338868
  error estimate for blocks of size 2^( 5) =       0.000458313912
  error estimate for blocks of size 2^( 6) =       0.000467272759
  error estimate for blocks of size 2^( 7) =       0.000474564185

      target function =                  N/A
              le_mean =     -16.923874366596
             les_mean =     286.748902859505
             stat err =       0.000461872431
             autocorr =       1.287503755382
              std dev =       0.575655668665
             le_variance =       0.331379448867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331375055975
                                         uncertainty =       0.003216216437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331375055975
                                         uncertainty =       0.003216216437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407014841
  error estimate for blocks of size 2^( 2) =       0.000419996299
  error estimate for blocks of size 2^( 3) =       0.000433722482
  error estimate for blocks of size 2^( 4) =       0.000447298647
  error estimate for blocks of size 2^( 5) =       0.000458272577
  error estimate for blocks of size 2^( 6) =       0.000467230361
  error estimate for blocks of size 2^( 7) =       0.000474515708

      target function =                  N/A
              le_mean =     -16.923874563821
             les_mean =     286.748852248138
             stat err =       0.000461829323
             autocorr =       1.287486007911
              std dev =       0.575605908466
             le_variance =       0.331322161861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331400952921
                                         uncertainty =       0.003215517974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331400952921
                                         uncertainty =       0.003215517974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407030757
  error estimate for blocks of size 2^( 2) =       0.000420012536
  error estimate for blocks of size 2^( 3) =       0.000433739124
  error estimate for blocks of size 2^( 4) =       0.000447316986
  error estimate for blocks of size 2^( 5) =       0.000458291543
  error estimate for blocks of size 2^( 6) =       0.000467249911
  error estimate for blocks of size 2^( 7) =       0.000474538279

      target function =                  N/A
              le_mean =     -16.923874434916
             les_mean =     286.748873797981
             stat err =       0.000461849180
             autocorr =       1.287496027117
              std dev =       0.575628417347
             le_variance =       0.331348074857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331428279628
                                         uncertainty =       0.003214758565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331428279628
                                         uncertainty =       0.003214758565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407047552
  error estimate for blocks of size 2^( 2) =       0.000420029584
  error estimate for blocks of size 2^( 3) =       0.000433756569
  error estimate for blocks of size 2^( 4) =       0.000447336060
  error estimate for blocks of size 2^( 5) =       0.000458311045
  error estimate for blocks of size 2^( 6) =       0.000467269834
  error estimate for blocks of size 2^( 7) =       0.000474560877

      target function =                  N/A
              le_mean =     -16.923874370937
             les_mean =     286.748898977394
             stat err =       0.000461869454
             autocorr =       1.287502812232
              std dev =       0.575652169121
             le_variance =       0.331375419814


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923874366596        initial
     2.4414e+00     2.4414e+01             1.6742e-04       -16.923874563821  <--
     9.7656e+00     9.7656e+01             4.3134e-05       -16.923874434916
     3.9062e+01     3.9062e+02             1.0871e-05       -16.923874370937

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 6.4116e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.086157e-01 1 1  ON 0
 uu_1                 1.424356e-01 1 1  ON 1
 uu_2                 4.188605e-02 1 1  ON 2
 uu_3                -1.992460e-02 1 1  ON 3
 uu_4                -6.427943e-02 1 1  ON 4
 uu_5                -9.687680e-02 1 1  ON 5
 uu_6                -1.234586e-01 1 1  ON 6
 uu_7                -1.371033e-01 1 1  ON 7
 uu_8                -1.299154e-01 1 1  ON 8
 uu_9                -1.002136e-01 1 1  ON 9
 ud_0                 4.419159e-01 1 1  ON 10
 ud_1                 1.756425e-01 1 1  ON 11
 ud_2                 5.584550e-02 1 1  ON 12
 ud_3                -1.389339e-02 1 1  ON 13
 ud_4                -6.872432e-02 1 1  ON 14
 ud_5                -1.069015e-01 1 1  ON 15
 ud_6                -1.309151e-01 1 1  ON 16
 ud_7                -1.451981e-01 1 1  ON 17
 ud_8                -1.446903e-01 1 1  ON 18
 ud_9                -1.346203e-01 1 1  ON 19
 eO_0                -7.658384e-01 1 1  ON 20
 eO_1                -4.444430e-01 1 1  ON 21
 eO_2                -2.198117e-02 1 1  ON 22
 eO_3                 3.004939e-01 1 1  ON 23
 eO_4                 5.276656e-01 1 1  ON 24
 eO_5                 4.842640e-01 1 1  ON 25
 eO_6                 2.521422e-01 1 1  ON 26
 eO_7                -4.860884e-02 1 1  ON 27
 eO_8                -2.114383e-01 1 1  ON 28
 eO_9                -7.237269e-02 1 1  ON 29
eH1_0                -2.365514e-01 1 1  ON 30
eH1_1                -1.379159e-01 1 1  ON 31
eH1_2                -9.282524e-02 1 1  ON 32
eH1_3                -3.785166e-02 1 1  ON 33
eH1_4                 6.726753e-03 1 1  ON 34
eH1_5                 4.062540e-02 1 1  ON 35
eH1_6                 9.584879e-02 1 1  ON 36
eH1_7                 1.472447e-01 1 1  ON 37
eH1_8                 1.652111e-01 1 1  ON 38
eH1_9                 5.264348e-02 1 1  ON 39
eH2_0                -2.333693e-01 1 1  ON 40
eH2_1                -1.347469e-01 1 1  ON 41
eH2_2                -8.942690e-02 1 1  ON 42
eH2_3                -3.492086e-02 1 1  ON 43
eH2_4                 1.047858e-02 1 1  ON 44
eH2_5                 4.333212e-02 1 1  ON 45
eH2_6                 9.916323e-02 1 1  ON 46
eH2_7                 1.514988e-01 1 1  ON 47
eH2_8                 1.701140e-01 1 1  ON 48
eH2_9                 3.566980e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2036e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6930e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9243
    reference variance = 0.31099
====================================================
  Execution time = 4.7989e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6922e+01
  VMC Evar = 3.3426e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1898e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334195698090
                                         uncertainty =       0.003028453573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334195698090
                                         uncertainty =       0.003028453573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408814390
  error estimate for blocks of size 2^( 2) =       0.000422110242
  error estimate for blocks of size 2^( 3) =       0.000435855586
  error estimate for blocks of size 2^( 4) =       0.000448859969
  error estimate for blocks of size 2^( 5) =       0.000461106323
  error estimate for blocks of size 2^( 6) =       0.000472048864
  error estimate for blocks of size 2^( 7) =       0.000480421805

      target function =                  N/A
              le_mean =     -16.922329456904
             les_mean =     286.699492492235
             stat err =       0.000465609240
             autocorr =       1.297151887857
              std dev =       0.578150855195
             le_variance =       0.334258411363


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692232945690e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922329456904       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922342905516       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922345353395       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922345613268       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922347358363       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922347674361       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922346891443       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922346946340       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.922347329036       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.922347582847       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 6.897191e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922329456904       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922333263575       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922333806548       residual = 9.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922333881549       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922334522843       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922334494681       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922334243992       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922334251930       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.922334342394       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.833906e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922329456904       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922330441102       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922330570940       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922330590833       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922330766677       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922330755869       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922330694195       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922330688694       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.922330710353       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 4.786485e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164949 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9953e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.086096e-01 1 1  ON 0
 uu_1                 1.424375e-01 1 1  ON 1
 uu_2                 4.196328e-02 1 1  ON 2
 uu_3                -1.991514e-02 1 1  ON 3
 uu_4                -6.429441e-02 1 1  ON 4
 uu_5                -9.690737e-02 1 1  ON 5
 uu_6                -1.234880e-01 1 1  ON 6
 uu_7                -1.371020e-01 1 1  ON 7
 uu_8                -1.299435e-01 1 1  ON 8
 uu_9                -1.002544e-01 1 1  ON 9
 ud_0                 4.417470e-01 1 1  ON 10
 ud_1                 1.754591e-01 1 1  ON 11
 ud_2                 5.572334e-02 1 1  ON 12
 ud_3                -1.395067e-02 1 1  ON 13
 ud_4                -6.877060e-02 1 1  ON 14
 ud_5                -1.068273e-01 1 1  ON 15
 ud_6                -1.308185e-01 1 1  ON 16
 ud_7                -1.450476e-01 1 1  ON 17
 ud_8                -1.445716e-01 1 1  ON 18
 ud_9                -1.345305e-01 1 1  ON 19
 eO_0                -7.659299e-01 1 1  ON 20
 eO_1                -4.445720e-01 1 1  ON 21
 eO_2                -2.212103e-02 1 1  ON 22
 eO_3                 3.004440e-01 1 1  ON 23
 eO_4                 5.278476e-01 1 1  ON 24
 eO_5                 4.844208e-01 1 1  ON 25
 eO_6                 2.522594e-01 1 1  ON 26
 eO_7                -4.855907e-02 1 1  ON 27
 eO_8                -2.114744e-01 1 1  ON 28
 eO_9                -7.242131e-02 1 1  ON 29
eH1_0                -2.365720e-01 1 1  ON 30
eH1_1                -1.379171e-01 1 1  ON 31
eH1_2                -9.284855e-02 1 1  ON 32
eH1_3                -3.788381e-02 1 1  ON 33
eH1_4                 6.691359e-03 1 1  ON 34
eH1_5                 4.055898e-02 1 1  ON 35
eH1_6                 9.583319e-02 1 1  ON 36
eH1_7                 1.472920e-01 1 1  ON 37
eH1_8                 1.652939e-01 1 1  ON 38
eH1_9                 5.270573e-02 1 1  ON 39
eH2_0                -2.333553e-01 1 1  ON 40
eH2_1                -1.347045e-01 1 1  ON 41
eH2_2                -8.946177e-02 1 1  ON 42
eH2_3                -3.492756e-02 1 1  ON 43
eH2_4                 1.039163e-02 1 1  ON 44
eH2_5                 4.328068e-02 1 1  ON 45
eH2_6                 9.911974e-02 1 1  ON 46
eH2_7                 1.514881e-01 1 1  ON 47
eH2_8                 1.701826e-01 1 1  ON 48
eH2_9                 3.576719e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8972
    reference variance = 0.263817
====================================================
  Execution time = 4.3447e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3978e-01
  Total weights = 2.0000e+06
  Execution time = 4.0709e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339945312043
                                         uncertainty =       0.003913256120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339945312043
                                         uncertainty =       0.003913256120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412210224
  error estimate for blocks of size 2^( 2) =       0.000425650456
  error estimate for blocks of size 2^( 3) =       0.000438852405
  error estimate for blocks of size 2^( 4) =       0.000451473518
  error estimate for blocks of size 2^( 5) =       0.000462886281
  error estimate for blocks of size 2^( 6) =       0.000471560352
  error estimate for blocks of size 2^( 7) =       0.000477000781

      target function =                  N/A
              le_mean =     -16.923024768564
             les_mean =     286.728601684896
             stat err =       0.000465730233
             autocorr =       1.276530936242
              std dev =       0.582953289190
             le_variance =       0.339834537377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339767317748
                                         uncertainty =       0.003911130790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339767317748
                                         uncertainty =       0.003911130790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412102297
  error estimate for blocks of size 2^( 2) =       0.000425544254
  error estimate for blocks of size 2^( 3) =       0.000438746225
  error estimate for blocks of size 2^( 4) =       0.000451360428
  error estimate for blocks of size 2^( 5) =       0.000462753011
  error estimate for blocks of size 2^( 6) =       0.000471411359
  error estimate for blocks of size 2^( 7) =       0.000476832194

      target function =                  N/A
              le_mean =     -16.923026901311
             les_mean =     286.728495939156
             stat err =       0.000465589248
             autocorr =       1.276426507094
              std dev =       0.582800657585
             le_variance =       0.339656606481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339840531945
                                         uncertainty =       0.003911994900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339840531945
                                         uncertainty =       0.003911994900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412146699
  error estimate for blocks of size 2^( 2) =       0.000425587938
  error estimate for blocks of size 2^( 3) =       0.000438790280
  error estimate for blocks of size 2^( 4) =       0.000451407417
  error estimate for blocks of size 2^( 5) =       0.000462809049
  error estimate for blocks of size 2^( 6) =       0.000471475479
  error estimate for blocks of size 2^( 7) =       0.000476906297

      target function =                  N/A
              le_mean =     -16.923025448357
             les_mean =     286.728519959108
             stat err =       0.000465649561
             autocorr =       1.276482141595
              std dev =       0.582863451620
             le_variance =       0.339729803235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339932275123
                                         uncertainty =       0.003913098936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339932275123
                                         uncertainty =       0.003913098936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412202321
  error estimate for blocks of size 2^( 2) =       0.000425642651
  error estimate for blocks of size 2^( 3) =       0.000438844637
  error estimate for blocks of size 2^( 4) =       0.000451465187
  error estimate for blocks of size 2^( 5) =       0.000462876482
  error estimate for blocks of size 2^( 6) =       0.000471549606
  error estimate for blocks of size 2^( 7) =       0.000476988858

      target function =                  N/A
              le_mean =     -16.923024794027
             les_mean =     286.728589516074
             stat err =       0.000465720033
             autocorr =       1.276523968721
              std dev =       0.582942112673
             le_variance =       0.339821506728


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923024768564        initial
     6.1035e-01     6.1035e+00             6.8972e-04       -16.923026901311  <--
     2.4414e+00     2.4414e+01             1.8339e-04       -16.923025448357
     9.7656e+00     9.7656e+01             4.7865e-05       -16.923024794027

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 6.4033e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.086151e-01 1 1  ON 0
 uu_1                 1.424849e-01 1 1  ON 1
 uu_2                 4.211999e-02 1 1  ON 2
 uu_3                -1.987902e-02 1 1  ON 3
 uu_4                -6.433239e-02 1 1  ON 4
 uu_5                -9.699598e-02 1 1  ON 5
 uu_6                -1.235695e-01 1 1  ON 6
 uu_7                -1.371124e-01 1 1  ON 7
 uu_8                -1.300302e-01 1 1  ON 8
 uu_9                -1.003764e-01 1 1  ON 9
 ud_0                 4.412772e-01 1 1  ON 10
 ud_1                 1.749872e-01 1 1  ON 11
 ud_2                 5.538512e-02 1 1  ON 12
 ud_3                -1.414650e-02 1 1  ON 13
 ud_4                -6.889137e-02 1 1  ON 14
 ud_5                -1.066823e-01 1 1  ON 15
 ud_6                -1.305563e-01 1 1  ON 16
 ud_7                -1.446309e-01 1 1  ON 17
 ud_8                -1.442198e-01 1 1  ON 18
 ud_9                -1.342568e-01 1 1  ON 19
 eO_0                -7.662101e-01 1 1  ON 20
 eO_1                -4.449640e-01 1 1  ON 21
 eO_2                -2.250798e-02 1 1  ON 22
 eO_3                 3.002920e-01 1 1  ON 23
 eO_4                 5.283553e-01 1 1  ON 24
 eO_5                 4.849048e-01 1 1  ON 25
 eO_6                 2.526227e-01 1 1  ON 26
 eO_7                -4.841256e-02 1 1  ON 27
 eO_8                -2.115849e-01 1 1  ON 28
 eO_9                -7.256880e-02 1 1  ON 29
eH1_0                -2.366219e-01 1 1  ON 30
eH1_1                -1.379244e-01 1 1  ON 31
eH1_2                -9.291875e-02 1 1  ON 32
eH1_3                -3.797525e-02 1 1  ON 33
eH1_4                 6.577327e-03 1 1  ON 34
eH1_5                 4.035995e-02 1 1  ON 35
eH1_6                 9.577880e-02 1 1  ON 36
eH1_7                 1.474322e-01 1 1  ON 37
eH1_8                 1.655435e-01 1 1  ON 38
eH1_9                 5.289478e-02 1 1  ON 39
eH2_0                -2.333047e-01 1 1  ON 40
eH2_1                -1.346151e-01 1 1  ON 41
eH2_2                -8.954401e-02 1 1  ON 42
eH2_3                -3.495808e-02 1 1  ON 43
eH2_4                 1.016072e-02 1 1  ON 44
eH2_5                 4.311216e-02 1 1  ON 45
eH2_6                 9.898421e-02 1 1  ON 46
eH2_7                 1.514579e-01 1 1  ON 47
eH2_8                 1.703896e-01 1 1  ON 48
eH2_9                 3.606231e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2399e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6928e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8493
    reference variance = 0.260347
====================================================
  Execution time = 4.7280e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3612e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2111e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336130317901
                                         uncertainty =       0.003536174062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336130317901
                                         uncertainty =       0.003536174062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409952634
  error estimate for blocks of size 2^( 2) =       0.000422659835
  error estimate for blocks of size 2^( 3) =       0.000435978379
  error estimate for blocks of size 2^( 4) =       0.000448405916
  error estimate for blocks of size 2^( 5) =       0.000458862724
  error estimate for blocks of size 2^( 6) =       0.000466856004
  error estimate for blocks of size 2^( 7) =       0.000469023054

      target function =                  N/A
              le_mean =     -16.922869497148
             les_mean =     286.719634173579
             stat err =       0.000460786924
             autocorr =       1.263376898635
              std dev =       0.579760574829
             le_variance =       0.336122324126


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692286949715e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922869497148       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922880014117       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922883219176       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922887570895       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922888165378       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922888045817       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922887254194       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922888666683       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.922889859310       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.922890233884       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.922890087978       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.922889765007       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 2.433815e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922869497148       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922873309391       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922874054795       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922875605748       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922874900241       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922875055752       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922875006643       residual = 8.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922875259242       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.922875408701       residual = 7.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 6.027275e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922869497148       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922870571000       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922870737990       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922871195854       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922870909418       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922870943684       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922870911397       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922870953014       residual = 6.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.480981e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.171743 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9404e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.086951e-01 1 1  ON 0
 uu_1                 1.426678e-01 1 1  ON 1
 uu_2                 4.224625e-02 1 1  ON 2
 uu_3                -1.981296e-02 1 1  ON 3
 uu_4                -6.425965e-02 1 1  ON 4
 uu_5                -9.714743e-02 1 1  ON 5
 uu_6                -1.235732e-01 1 1  ON 6
 uu_7                -1.370470e-01 1 1  ON 7
 uu_8                -1.302846e-01 1 1  ON 8
 uu_9                -1.006661e-01 1 1  ON 9
 ud_0                 4.408400e-01 1 1  ON 10
 ud_1                 1.746495e-01 1 1  ON 11
 ud_2                 5.509457e-02 1 1  ON 12
 ud_3                -1.434250e-02 1 1  ON 13
 ud_4                -6.889941e-02 1 1  ON 14
 ud_5                -1.063238e-01 1 1  ON 15
 ud_6                -1.303380e-01 1 1  ON 16
 ud_7                -1.442574e-01 1 1  ON 17
 ud_8                -1.439791e-01 1 1  ON 18
 ud_9                -1.341666e-01 1 1  ON 19
 eO_0                -7.665083e-01 1 1  ON 20
 eO_1                -4.453011e-01 1 1  ON 21
 eO_2                -2.290571e-02 1 1  ON 22
 eO_3                 3.001840e-01 1 1  ON 23
 eO_4                 5.287348e-01 1 1  ON 24
 eO_5                 4.855075e-01 1 1  ON 25
 eO_6                 2.530812e-01 1 1  ON 26
 eO_7                -4.819609e-02 1 1  ON 27
 eO_8                -2.118480e-01 1 1  ON 28
 eO_9                -7.279924e-02 1 1  ON 29
eH1_0                -2.365639e-01 1 1  ON 30
eH1_1                -1.379398e-01 1 1  ON 31
eH1_2                -9.301194e-02 1 1  ON 32
eH1_3                -3.803383e-02 1 1  ON 33
eH1_4                 6.548665e-03 1 1  ON 34
eH1_5                 4.024681e-02 1 1  ON 35
eH1_6                 9.572205e-02 1 1  ON 36
eH1_7                 1.473969e-01 1 1  ON 37
eH1_8                 1.656901e-01 1 1  ON 38
eH1_9                 5.308384e-02 1 1  ON 39
eH2_0                -2.332043e-01 1 1  ON 40
eH2_1                -1.346863e-01 1 1  ON 41
eH2_2                -8.966543e-02 1 1  ON 42
eH2_3                -3.494629e-02 1 1  ON 43
eH2_4                 1.003817e-02 1 1  ON 44
eH2_5                 4.296597e-02 1 1  ON 45
eH2_6                 9.877708e-02 1 1  ON 46
eH2_7                 1.514301e-01 1 1  ON 47
eH2_8                 1.706788e-01 1 1  ON 48
eH2_9                 3.638234e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9625
    reference variance = 0.257434
====================================================
  Execution time = 4.3239e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 4.0328e-01
  Total weights = 2.0000e+06
  Execution time = 4.1157e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.403611346925
                                         uncertainty =       0.067349621587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.403611346925
                                         uncertainty =       0.067349621587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000449150322
  error estimate for blocks of size 2^( 2) =       0.000460866269
  error estimate for blocks of size 2^( 3) =       0.000473187422
  error estimate for blocks of size 2^( 4) =       0.000484860269
  error estimate for blocks of size 2^( 5) =       0.000495410102
  error estimate for blocks of size 2^( 6) =       0.000504057116
  error estimate for blocks of size 2^( 7) =       0.000509815326

      target function =                  N/A
              le_mean =     -16.924369825285
             les_mean =     286.837765805173
             stat err =       0.000498535703
             autocorr =       1.231995442646
              std dev =       0.635194477226
             le_variance =       0.403472023898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.403148256293
                                         uncertainty =       0.067129567744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.403148256293
                                         uncertainty =       0.067129567744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000448892629
  error estimate for blocks of size 2^( 2) =       0.000460613621
  error estimate for blocks of size 2^( 3) =       0.000472933410
  error estimate for blocks of size 2^( 4) =       0.000484597392
  error estimate for blocks of size 2^( 5) =       0.000495121118
  error estimate for blocks of size 2^( 6) =       0.000503718685
  error estimate for blocks of size 2^( 7) =       0.000509477156

      target function =                  N/A
              le_mean =     -16.924364256372
             les_mean =     286.837114466386
             stat err =       0.000498228588
             autocorr =       1.231891156388
              std dev =       0.634830044589
             le_variance =       0.403009185513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.403237358351
                                         uncertainty =       0.067184315445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.403237358351
                                         uncertainty =       0.067184315445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000448942220
  error estimate for blocks of size 2^( 2) =       0.000460662105
  error estimate for blocks of size 2^( 3) =       0.000472982316
  error estimate for blocks of size 2^( 4) =       0.000484650571
  error estimate for blocks of size 2^( 5) =       0.000495183634
  error estimate for blocks of size 2^( 6) =       0.000503798733
  error estimate for blocks of size 2^( 7) =       0.000509560168

      target function =                  N/A
              le_mean =     -16.924363946956
             les_mean =     286.837193040820
             stat err =       0.000498298276
             autocorr =       1.231963584593
              std dev =       0.634900175894
             le_variance =       0.403098233350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.403547269431
                                         uncertainty =       0.067322960474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.403547269431
                                         uncertainty =       0.067322960474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000449114672
  error estimate for blocks of size 2^( 2) =       0.000460831264
  error estimate for blocks of size 2^( 3) =       0.000473152263
  error estimate for blocks of size 2^( 4) =       0.000484824513
  error estimate for blocks of size 2^( 5) =       0.000495371974
  error estimate for blocks of size 2^( 6) =       0.000504014645
  error estimate for blocks of size 2^( 7) =       0.000509773566

      target function =                  N/A
              le_mean =     -16.924368542155
             les_mean =     286.837658326602
             stat err =       0.000498496174
             autocorr =       1.231995645336
              std dev =       0.635144060528
             le_variance =       0.403407977624


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924369825285        initial  <--
     1.5259e-01     1.5259e+00             2.4338e-03       -16.924364256372
     6.1035e-01     6.1035e+00             6.0273e-04       -16.924363946956
     2.4414e+00     2.4414e+01             1.4810e-04       -16.924368542155

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.9715
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.086151e-01 1 1  ON 0
 uu_1                 1.424849e-01 1 1  ON 1
 uu_2                 4.211999e-02 1 1  ON 2
 uu_3                -1.987902e-02 1 1  ON 3
 uu_4                -6.433239e-02 1 1  ON 4
 uu_5                -9.699598e-02 1 1  ON 5
 uu_6                -1.235695e-01 1 1  ON 6
 uu_7                -1.371124e-01 1 1  ON 7
 uu_8                -1.300302e-01 1 1  ON 8
 uu_9                -1.003764e-01 1 1  ON 9
 ud_0                 4.412772e-01 1 1  ON 10
 ud_1                 1.749872e-01 1 1  ON 11
 ud_2                 5.538512e-02 1 1  ON 12
 ud_3                -1.414650e-02 1 1  ON 13
 ud_4                -6.889137e-02 1 1  ON 14
 ud_5                -1.066823e-01 1 1  ON 15
 ud_6                -1.305563e-01 1 1  ON 16
 ud_7                -1.446309e-01 1 1  ON 17
 ud_8                -1.442198e-01 1 1  ON 18
 ud_9                -1.342568e-01 1 1  ON 19
 eO_0                -7.662101e-01 1 1  ON 20
 eO_1                -4.449640e-01 1 1  ON 21
 eO_2                -2.250798e-02 1 1  ON 22
 eO_3                 3.002920e-01 1 1  ON 23
 eO_4                 5.283553e-01 1 1  ON 24
 eO_5                 4.849048e-01 1 1  ON 25
 eO_6                 2.526227e-01 1 1  ON 26
 eO_7                -4.841256e-02 1 1  ON 27
 eO_8                -2.115849e-01 1 1  ON 28
 eO_9                -7.256880e-02 1 1  ON 29
eH1_0                -2.366219e-01 1 1  ON 30
eH1_1                -1.379244e-01 1 1  ON 31
eH1_2                -9.291875e-02 1 1  ON 32
eH1_3                -3.797525e-02 1 1  ON 33
eH1_4                 6.577327e-03 1 1  ON 34
eH1_5                 4.035995e-02 1 1  ON 35
eH1_6                 9.577880e-02 1 1  ON 36
eH1_7                 1.474322e-01 1 1  ON 37
eH1_8                 1.655435e-01 1 1  ON 38
eH1_9                 5.289478e-02 1 1  ON 39
eH2_0                -2.333047e-01 1 1  ON 40
eH2_1                -1.346151e-01 1 1  ON 41
eH2_2                -8.954401e-02 1 1  ON 42
eH2_3                -3.495808e-02 1 1  ON 43
eH2_4                 1.016072e-02 1 1  ON 44
eH2_5                 4.311216e-02 1 1  ON 45
eH2_6                 9.898421e-02 1 1  ON 46
eH2_7                 1.514579e-01 1 1  ON 47
eH2_8                 1.703896e-01 1 1  ON 48
eH2_9                 3.606231e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2338e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6926e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9998
    reference variance = 0.279825
====================================================
  Execution time = 4.4428e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3824e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1873e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338304270811
                                         uncertainty =       0.003300135146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338304270811
                                         uncertainty =       0.003300135146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411244112
  error estimate for blocks of size 2^( 2) =       0.000424030922
  error estimate for blocks of size 2^( 3) =       0.000437209540
  error estimate for blocks of size 2^( 4) =       0.000450596583
  error estimate for blocks of size 2^( 5) =       0.000462057945
  error estimate for blocks of size 2^( 6) =       0.000471635182
  error estimate for blocks of size 2^( 7) =       0.000477641939

      target function =                  N/A
              le_mean =     -16.923253111797
             les_mean =     286.734739155381
             stat err =       0.000465482912
             autocorr =       1.281173952882
              std dev =       0.581586999976
             le_variance =       0.338243438541


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692325311180e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923253111797       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923254637904       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923255125351       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923255338350       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923256352438       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923256694553       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923256491005       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923256487827       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923256500615       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 2.762276e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923253111797       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923253511813       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923253636232       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923253711275       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923253979367       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923254055555       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923254002156       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923254005268       residual = 9.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 6.825248e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923253111797       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923253213028       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923253244323       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923253264940       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923253332727       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923253351687       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923253337931       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923253338823       residual = 8.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.705095e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176365 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6311e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.086508e-01 1 1  ON 0
 uu_1                 1.425143e-01 1 1  ON 1
 uu_2                 4.211342e-02 1 1  ON 2
 uu_3                -1.987479e-02 1 1  ON 3
 uu_4                -6.433694e-02 1 1  ON 4
 uu_5                -9.700048e-02 1 1  ON 5
 uu_6                -1.235838e-01 1 1  ON 6
 uu_7                -1.371102e-01 1 1  ON 7
 uu_8                -1.300635e-01 1 1  ON 8
 uu_9                -1.004072e-01 1 1  ON 9
 ud_0                 4.412365e-01 1 1  ON 10
 ud_1                 1.749556e-01 1 1  ON 11
 ud_2                 5.534662e-02 1 1  ON 12
 ud_3                -1.417463e-02 1 1  ON 13
 ud_4                -6.888524e-02 1 1  ON 14
 ud_5                -1.066590e-01 1 1  ON 15
 ud_6                -1.305343e-01 1 1  ON 16
 ud_7                -1.445904e-01 1 1  ON 17
 ud_8                -1.441918e-01 1 1  ON 18
 ud_9                -1.342440e-01 1 1  ON 19
 eO_0                -7.662573e-01 1 1  ON 20
 eO_1                -4.450031e-01 1 1  ON 21
 eO_2                -2.251063e-02 1 1  ON 22
 eO_3                 3.002621e-01 1 1  ON 23
 eO_4                 5.284037e-01 1 1  ON 24
 eO_5                 4.849730e-01 1 1  ON 25
 eO_6                 2.526611e-01 1 1  ON 26
 eO_7                -4.839585e-02 1 1  ON 27
 eO_8                -2.116113e-01 1 1  ON 28
 eO_9                -7.259204e-02 1 1  ON 29
eH1_0                -2.366151e-01 1 1  ON 30
eH1_1                -1.379294e-01 1 1  ON 31
eH1_2                -9.293214e-02 1 1  ON 32
eH1_3                -3.798109e-02 1 1  ON 33
eH1_4                 6.554629e-03 1 1  ON 34
eH1_5                 4.034938e-02 1 1  ON 35
eH1_6                 9.576935e-02 1 1  ON 36
eH1_7                 1.474387e-01 1 1  ON 37
eH1_8                 1.655652e-01 1 1  ON 38
eH1_9                 5.292123e-02 1 1  ON 39
eH2_0                -2.332874e-01 1 1  ON 40
eH2_1                -1.346211e-01 1 1  ON 41
eH2_2                -8.956236e-02 1 1  ON 42
eH2_3                -3.495010e-02 1 1  ON 43
eH2_4                 1.013104e-02 1 1  ON 44
eH2_5                 4.311064e-02 1 1  ON 45
eH2_6                 9.897547e-02 1 1  ON 46
eH2_7                 1.514512e-01 1 1  ON 47
eH2_8                 1.704033e-01 1 1  ON 48
eH2_9                 3.609405e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9487
    reference variance = 0.402202
====================================================
  Execution time = 4.6159e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3993e-01
  Total weights = 2.0000e+06
  Execution time = 4.0740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339976530351
                                         uncertainty =       0.003690444432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339976530351
                                         uncertainty =       0.003690444432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412257468
  error estimate for blocks of size 2^( 2) =       0.000425022044
  error estimate for blocks of size 2^( 3) =       0.000438635524
  error estimate for blocks of size 2^( 4) =       0.000450357883
  error estimate for blocks of size 2^( 5) =       0.000462526904
  error estimate for blocks of size 2^( 6) =       0.000472652866
  error estimate for blocks of size 2^( 7) =       0.000479090844

      target function =                  N/A
              le_mean =     -16.923058695822
             les_mean =     286.729827892255
             stat err =       0.000466157124
             autocorr =       1.278579062742
              std dev =       0.583020102551
             le_variance =       0.339912439979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340027619692
                                         uncertainty =       0.003690594279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340027619692
                                         uncertainty =       0.003690594279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412288443
  error estimate for blocks of size 2^( 2) =       0.000425049663
  error estimate for blocks of size 2^( 3) =       0.000438658926
  error estimate for blocks of size 2^( 4) =       0.000450375938
  error estimate for blocks of size 2^( 5) =       0.000462538365
  error estimate for blocks of size 2^( 6) =       0.000472659596
  error estimate for blocks of size 2^( 7) =       0.000479091550

      target function =                  N/A
              le_mean =     -16.923059770630
             les_mean =     286.729915350210
             stat err =       0.000466166362
             autocorr =       1.278437624681
              std dev =       0.583063907202
             le_variance =       0.339963519882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340004647763
                                         uncertainty =       0.003690516972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340004647763
                                         uncertainty =       0.003690516972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412274516
  error estimate for blocks of size 2^( 2) =       0.000425037186
  error estimate for blocks of size 2^( 3) =       0.000438648319
  error estimate for blocks of size 2^( 4) =       0.000450367794
  error estimate for blocks of size 2^( 5) =       0.000462533302
  error estimate for blocks of size 2^( 6) =       0.000472656899
  error estimate for blocks of size 2^( 7) =       0.000479091655

      target function =                  N/A
              le_mean =     -16.923059218721
             les_mean =     286.729873704178
             stat err =       0.000466162413
             autocorr =       1.278502329333
              std dev =       0.583044212578
             le_variance =       0.339940553821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339980247944
                                         uncertainty =       0.003690455120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339980247944
                                         uncertainty =       0.003690455120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412259722
  error estimate for blocks of size 2^( 2) =       0.000425024048
  error estimate for blocks of size 2^( 3) =       0.000438637224
  error estimate for blocks of size 2^( 4) =       0.000450359210
  error estimate for blocks of size 2^( 5) =       0.000462527783
  error estimate for blocks of size 2^( 6) =       0.000472653446
  error estimate for blocks of size 2^( 7) =       0.000479091006

      target function =                  N/A
              le_mean =     -16.923058757115
             les_mean =     286.729833683952
             stat err =       0.000466157861
             autocorr =       1.278569123094
              std dev =       0.583023290405
             le_variance =       0.339916157154


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923058695822        initial
     1.5259e+00     1.5259e+01             2.7623e-04       -16.923059770630  <--
     6.1035e+00     6.1035e+01             6.8252e-05       -16.923059218721
     2.4414e+01     2.4414e+02             1.7051e-05       -16.923058757115

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 6.6706e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.087552e-01 1 1  ON 0
 uu_1                 1.425923e-01 1 1  ON 1
 uu_2                 4.210364e-02 1 1  ON 2
 uu_3                -1.986542e-02 1 1  ON 3
 uu_4                -6.435119e-02 1 1  ON 4
 uu_5                -9.701640e-02 1 1  ON 5
 uu_6                -1.236197e-01 1 1  ON 6
 uu_7                -1.371026e-01 1 1  ON 7
 uu_8                -1.301619e-01 1 1  ON 8
 uu_9                -1.005004e-01 1 1  ON 9
 ud_0                 4.411215e-01 1 1  ON 10
 ud_1                 1.748571e-01 1 1  ON 11
 ud_2                 5.524085e-02 1 1  ON 12
 ud_3                -1.425294e-02 1 1  ON 13
 ud_4                -6.887613e-02 1 1  ON 14
 ud_5                -1.065996e-01 1 1  ON 15
 ud_6                -1.304706e-01 1 1  ON 16
 ud_7                -1.444719e-01 1 1  ON 17
 ud_8                -1.441054e-01 1 1  ON 18
 ud_9                -1.342031e-01 1 1  ON 19
 eO_0                -7.663915e-01 1 1  ON 20
 eO_1                -4.451186e-01 1 1  ON 21
 eO_2                -2.253916e-02 1 1  ON 22
 eO_3                 3.001814e-01 1 1  ON 23
 eO_4                 5.285453e-01 1 1  ON 24
 eO_5                 4.851810e-01 1 1  ON 25
 eO_6                 2.527808e-01 1 1  ON 26
 eO_7                -4.834448e-02 1 1  ON 27
 eO_8                -2.116916e-01 1 1  ON 28
 eO_9                -7.266327e-02 1 1  ON 29
eH1_0                -2.365985e-01 1 1  ON 30
eH1_1                -1.379478e-01 1 1  ON 31
eH1_2                -9.297006e-02 1 1  ON 32
eH1_3                -3.800069e-02 1 1  ON 33
eH1_4                 6.492067e-03 1 1  ON 34
eH1_5                 4.031685e-02 1 1  ON 35
eH1_6                 9.573968e-02 1 1  ON 36
eH1_7                 1.474588e-01 1 1  ON 37
eH1_8                 1.656314e-01 1 1  ON 38
eH1_9                 5.300258e-02 1 1  ON 39
eH2_0                -2.332411e-01 1 1  ON 40
eH2_1                -1.346407e-01 1 1  ON 41
eH2_2                -8.961053e-02 1 1  ON 42
eH2_3                -3.493588e-02 1 1  ON 43
eH2_4                 1.005226e-02 1 1  ON 44
eH2_5                 4.310289e-02 1 1  ON 45
eH2_6                 9.894777e-02 1 1  ON 46
eH2_7                 1.514316e-01 1 1  ON 47
eH2_8                 1.704455e-01 1 1  ON 48
eH2_9                 3.619160e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2302e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6930e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9472
    reference variance = 0.195781
====================================================
  Execution time = 4.4536e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3746e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1869e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337544614479
                                         uncertainty =       0.003242448765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337544614479
                                         uncertainty =       0.003242448765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410768953
  error estimate for blocks of size 2^( 2) =       0.000423903666
  error estimate for blocks of size 2^( 3) =       0.000437448954
  error estimate for blocks of size 2^( 4) =       0.000451159877
  error estimate for blocks of size 2^( 5) =       0.000463681490
  error estimate for blocks of size 2^( 6) =       0.000473787234
  error estimate for blocks of size 2^( 7) =       0.000481408417

      target function =                  N/A
              le_mean =     -16.922932624337
             les_mean =     286.723110705146
             stat err =       0.000467509255
             autocorr =       1.295344250821
              std dev =       0.580915024797
             le_variance =       0.337462266035


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692293262434e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922932624337       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922934384587       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922938034523       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922943440736       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922943180446       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922945220950       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922945968139       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922945268255       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.922945103657       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.922944948114       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.922945050027       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 1.093107e-03

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922932624337       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922933145477       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922934030761       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922935804613       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922935529429       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922936087042       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922936197147       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922936051411       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.922936034851       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 2.724767e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922932624337       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922932760913       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922932977347       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922933456341       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922933366934       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922933514194       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922933530613       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922933502552       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 6.726413e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181916 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6416e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.088444e-01 1 1  ON 0
 uu_1                 1.426381e-01 1 1  ON 1
 uu_2                 4.216413e-02 1 1  ON 2
 uu_3                -1.983932e-02 1 1  ON 3
 uu_4                -6.440212e-02 1 1  ON 4
 uu_5                -9.705356e-02 1 1  ON 5
 uu_6                -1.236285e-01 1 1  ON 6
 uu_7                -1.371228e-01 1 1  ON 7
 uu_8                -1.302539e-01 1 1  ON 8
 uu_9                -1.005946e-01 1 1  ON 9
 ud_0                 4.409461e-01 1 1  ON 10
 ud_1                 1.747282e-01 1 1  ON 11
 ud_2                 5.509459e-02 1 1  ON 12
 ud_3                -1.433714e-02 1 1  ON 13
 ud_4                -6.884412e-02 1 1  ON 14
 ud_5                -1.065603e-01 1 1  ON 15
 ud_6                -1.303375e-01 1 1  ON 16
 ud_7                -1.442459e-01 1 1  ON 17
 ud_8                -1.439546e-01 1 1  ON 18
 ud_9                -1.341959e-01 1 1  ON 19
 eO_0                -7.665292e-01 1 1  ON 20
 eO_1                -4.452573e-01 1 1  ON 21
 eO_2                -2.273062e-02 1 1  ON 22
 eO_3                 3.001174e-01 1 1  ON 23
 eO_4                 5.287641e-01 1 1  ON 24
 eO_5                 4.854535e-01 1 1  ON 25
 eO_6                 2.529493e-01 1 1  ON 26
 eO_7                -4.825413e-02 1 1  ON 27
 eO_8                -2.117738e-01 1 1  ON 28
 eO_9                -7.277989e-02 1 1  ON 29
eH1_0                -2.365685e-01 1 1  ON 30
eH1_1                -1.379477e-01 1 1  ON 31
eH1_2                -9.299894e-02 1 1  ON 32
eH1_3                -3.807436e-02 1 1  ON 33
eH1_4                 6.445728e-03 1 1  ON 34
eH1_5                 4.028052e-02 1 1  ON 35
eH1_6                 9.575197e-02 1 1  ON 36
eH1_7                 1.474702e-01 1 1  ON 37
eH1_8                 1.656694e-01 1 1  ON 38
eH1_9                 5.309890e-02 1 1  ON 39
eH2_0                -2.332684e-01 1 1  ON 40
eH2_1                -1.346579e-01 1 1  ON 41
eH2_2                -8.972549e-02 1 1  ON 42
eH2_3                -3.491809e-02 1 1  ON 43
eH2_4                 1.001584e-02 1 1  ON 44
eH2_5                 4.308649e-02 1 1  ON 45
eH2_6                 9.889458e-02 1 1  ON 46
eH2_7                 1.513900e-01 1 1  ON 47
eH2_8                 1.705525e-01 1 1  ON 48
eH2_9                 3.636618e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8415
    reference variance = 0.487775
====================================================
  Execution time = 4.6873e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.5368e-01
  Total weights = 2.0000e+06
  Execution time = 4.0736e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353784760081
                                         uncertainty =       0.012778675434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353784760081
                                         uncertainty =       0.012778675434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420535665
  error estimate for blocks of size 2^( 2) =       0.000432873503
  error estimate for blocks of size 2^( 3) =       0.000445238999
  error estimate for blocks of size 2^( 4) =       0.000457659961
  error estimate for blocks of size 2^( 5) =       0.000466447650
  error estimate for blocks of size 2^( 6) =       0.000474627324
  error estimate for blocks of size 2^( 7) =       0.000479863826

      target function =                  N/A
              le_mean =     -16.922977742589
             les_mean =     286.740875989722
             stat err =       0.000469649690
             autocorr =       1.247218127422
              std dev =       0.594727240350
             le_variance =       0.353700490415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353737544532
                                         uncertainty =       0.012762036626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353737544532
                                         uncertainty =       0.012762036626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420507687
  error estimate for blocks of size 2^( 2) =       0.000432842571
  error estimate for blocks of size 2^( 3) =       0.000445202304
  error estimate for blocks of size 2^( 4) =       0.000457610468
  error estimate for blocks of size 2^( 5) =       0.000466383624
  error estimate for blocks of size 2^( 6) =       0.000474543516
  error estimate for blocks of size 2^( 7) =       0.000479752170

      target function =                  N/A
              le_mean =     -16.922979496330
             les_mean =     286.740888285612
             stat err =       0.000469572445
             autocorr =       1.246973802970
              std dev =       0.594687673692
             le_variance =       0.353653429242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353742962771
                                         uncertainty =       0.012768238206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353742962771
                                         uncertainty =       0.012768238206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420510873
  error estimate for blocks of size 2^( 2) =       0.000432846932
  error estimate for blocks of size 2^( 3) =       0.000445209420
  error estimate for blocks of size 2^( 4) =       0.000457622840
  error estimate for blocks of size 2^( 5) =       0.000466402545
  error estimate for blocks of size 2^( 6) =       0.000474572268
  error estimate for blocks of size 2^( 7) =       0.000479793073

      target function =                  N/A
              le_mean =     -16.922978370947
             les_mean =     286.740855554676
             stat err =       0.000469597681
             autocorr =       1.247088944810
              std dev =       0.594692179172
             le_variance =       0.353658787968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353778596303
                                         uncertainty =       0.012777194280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353778596303
                                         uncertainty =       0.012777194280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420532008
  error estimate for blocks of size 2^( 2) =       0.000432869591
  error estimate for blocks of size 2^( 3) =       0.000445234676
  error estimate for blocks of size 2^( 4) =       0.000457654599
  error estimate for blocks of size 2^( 5) =       0.000466441236
  error estimate for blocks of size 2^( 6) =       0.000474619694
  error estimate for blocks of size 2^( 7) =       0.000479854173

      target function =                  N/A
              le_mean =     -16.922977767976
             les_mean =     286.740870697973
             stat err =       0.000469642426
             autocorr =       1.247201232022
              std dev =       0.594722069054
             le_variance =       0.353694339420


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.922977742589        initial
     3.8147e-01     3.8147e+00             1.0931e-03       -16.922979496330  <--
     1.5259e+00     1.5259e+01             2.7248e-04       -16.922978370947
     6.1035e+00     6.1035e+01             6.7264e-05       -16.922977767976

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 6.7449e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.090716e-01 1 1  ON 0
 uu_1                 1.427813e-01 1 1  ON 1
 uu_2                 4.230765e-02 1 1  ON 2
 uu_3                -1.977252e-02 1 1  ON 3
 uu_4                -6.449366e-02 1 1  ON 4
 uu_5                -9.717197e-02 1 1  ON 5
 uu_6                -1.236678e-01 1 1  ON 6
 uu_7                -1.371780e-01 1 1  ON 7
 uu_8                -1.305045e-01 1 1  ON 8
 uu_9                -1.008684e-01 1 1  ON 9
 ud_0                 4.405236e-01 1 1  ON 10
 ud_1                 1.743639e-01 1 1  ON 11
 ud_2                 5.474699e-02 1 1  ON 12
 ud_3                -1.456260e-02 1 1  ON 13
 ud_4                -6.884928e-02 1 1  ON 14
 ud_5                -1.064792e-01 1 1  ON 15
 ud_6                -1.300075e-01 1 1  ON 16
 ud_7                -1.436475e-01 1 1  ON 17
 ud_8                -1.434867e-01 1 1  ON 18
 ud_9                -1.341501e-01 1 1  ON 19
 eO_0                -7.669442e-01 1 1  ON 20
 eO_1                -4.456802e-01 1 1  ON 21
 eO_2                -2.325628e-02 1 1  ON 22
 eO_3                 2.999085e-01 1 1  ON 23
 eO_4                 5.293606e-01 1 1  ON 24
 eO_5                 4.862741e-01 1 1  ON 25
 eO_6                 2.534807e-01 1 1  ON 26
 eO_7                -4.797727e-02 1 1  ON 27
 eO_8                -2.120163e-01 1 1  ON 28
 eO_9                -7.313123e-02 1 1  ON 29
eH1_0                -2.364918e-01 1 1  ON 30
eH1_1                -1.379715e-01 1 1  ON 31
eH1_2                -9.309587e-02 1 1  ON 32
eH1_3                -3.824285e-02 1 1  ON 33
eH1_4                 6.304545e-03 1 1  ON 34
eH1_5                 4.015987e-02 1 1  ON 35
eH1_6                 9.577822e-02 1 1  ON 36
eH1_7                 1.475126e-01 1 1  ON 37
eH1_8                 1.657897e-01 1 1  ON 38
eH1_9                 5.339276e-02 1 1  ON 39
eH2_0                -2.333412e-01 1 1  ON 40
eH2_1                -1.347321e-01 1 1  ON 41
eH2_2                -8.996830e-02 1 1  ON 42
eH2_3                -3.494393e-02 1 1  ON 43
eH2_4                 9.912622e-03 1 1  ON 44
eH2_5                 4.300863e-02 1 1  ON 45
eH2_6                 9.873257e-02 1 1  ON 46
eH2_7                 1.512730e-01 1 1  ON 47
eH2_8                 1.708752e-01 1 1  ON 48
eH2_9                 3.689491e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2387e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6928e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.943
    reference variance = 0.38924
====================================================
  Execution time = 4.4585e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4147e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2004e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341487353743
                                         uncertainty =       0.005019756522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341487353743
                                         uncertainty =       0.005019756522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413203194
  error estimate for blocks of size 2^( 2) =       0.000426302051
  error estimate for blocks of size 2^( 3) =       0.000439364133
  error estimate for blocks of size 2^( 4) =       0.000451703056
  error estimate for blocks of size 2^( 5) =       0.000462060300
  error estimate for blocks of size 2^( 6) =       0.000468541458
  error estimate for blocks of size 2^( 7) =       0.000472223760

      target function =                  N/A
              le_mean =     -16.924029579282
             les_mean =     286.764250788433
             stat err =       0.000463632144
             autocorr =       1.258982624783
              std dev =       0.584357560698
             le_variance =       0.341473758745


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692402957928e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924029579282       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924058080704       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924057368606       residual = 9.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924059297407       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924058750949       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924065698030       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924068882187       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924072923546       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924074536747       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.924073331887       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.924072174153       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.924071446846       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.924072084605       residual = 7.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 4.316083e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924029579282       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924041309318       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924040428814       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924041524745       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924041798387       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924044185817       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924044606505       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924044980191       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924044843348       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.924044514830       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.924044492323       residual = 1.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 1.176569e-03

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924029579282       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924033076846       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924032765657       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924033222701       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924033390327       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924033861859       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924033877287       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924033897177       residual = 6.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 2.961925e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.189401 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6603e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.092298e-01 1 1  ON 0
 uu_1                 1.429598e-01 1 1  ON 1
 uu_2                 4.253262e-02 1 1  ON 2
 uu_3                -1.956499e-02 1 1  ON 3
 uu_4                -6.439959e-02 1 1  ON 4
 uu_5                -9.737177e-02 1 1  ON 5
 uu_6                -1.238920e-01 1 1  ON 6
 uu_7                -1.374383e-01 1 1  ON 7
 uu_8                -1.308640e-01 1 1  ON 8
 uu_9                -1.011252e-01 1 1  ON 9
 ud_0                 4.397800e-01 1 1  ON 10
 ud_1                 1.737341e-01 1 1  ON 11
 ud_2                 5.428619e-02 1 1  ON 12
 ud_3                -1.495905e-02 1 1  ON 13
 ud_4                -6.903254e-02 1 1  ON 14
 ud_5                -1.062026e-01 1 1  ON 15
 ud_6                -1.296685e-01 1 1  ON 16
 ud_7                -1.430940e-01 1 1  ON 17
 ud_8                -1.426424e-01 1 1  ON 18
 ud_9                -1.338023e-01 1 1  ON 19
 eO_0                -7.674599e-01 1 1  ON 20
 eO_1                -4.461585e-01 1 1  ON 21
 eO_2                -2.378329e-02 1 1  ON 22
 eO_3                 2.995035e-01 1 1  ON 23
 eO_4                 5.298267e-01 1 1  ON 24
 eO_5                 4.874507e-01 1 1  ON 25
 eO_6                 2.542744e-01 1 1  ON 26
 eO_7                -4.777377e-02 1 1  ON 27
 eO_8                -2.123449e-01 1 1  ON 28
 eO_9                -7.347047e-02 1 1  ON 29
eH1_0                -2.364137e-01 1 1  ON 30
eH1_1                -1.380131e-01 1 1  ON 31
eH1_2                -9.328448e-02 1 1  ON 32
eH1_3                -3.849996e-02 1 1  ON 33
eH1_4                 6.264215e-03 1 1  ON 34
eH1_5                 3.999345e-02 1 1  ON 35
eH1_6                 9.556545e-02 1 1  ON 36
eH1_7                 1.476294e-01 1 1  ON 37
eH1_8                 1.660794e-01 1 1  ON 38
eH1_9                 5.375142e-02 1 1  ON 39
eH2_0                -2.331991e-01 1 1  ON 40
eH2_1                -1.347908e-01 1 1  ON 41
eH2_2                -9.008867e-02 1 1  ON 42
eH2_3                -3.514372e-02 1 1  ON 43
eH2_4                 9.605455e-03 1 1  ON 44
eH2_5                 4.283980e-02 1 1  ON 45
eH2_6                 9.858089e-02 1 1  ON 46
eH2_7                 1.512905e-01 1 1  ON 47
eH2_8                 1.711763e-01 1 1  ON 48
eH2_9                 3.741965e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9746
    reference variance = 0.566503
====================================================
  Execution time = 4.2981e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3763e-01
  Total weights = 2.0000e+06
  Execution time = 4.0688e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337927801057
                                         uncertainty =       0.004466804080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337927801057
                                         uncertainty =       0.004466804080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410991386
  error estimate for blocks of size 2^( 2) =       0.000423321449
  error estimate for blocks of size 2^( 3) =       0.000436600512
  error estimate for blocks of size 2^( 4) =       0.000448795269
  error estimate for blocks of size 2^( 5) =       0.000459906927
  error estimate for blocks of size 2^( 6) =       0.000469323174
  error estimate for blocks of size 2^( 7) =       0.000475846321

      target function =                  N/A
              le_mean =     -16.923616068513
             les_mean =     286.746608504261
             stat err =       0.000463467923
             autocorr =       1.271668528980
              std dev =       0.581229592097
             le_variance =       0.337827838730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337552934115
                                         uncertainty =       0.004464646279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337552934115
                                         uncertainty =       0.004464646279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410763353
  error estimate for blocks of size 2^( 2) =       0.000423106195
  error estimate for blocks of size 2^( 3) =       0.000436388111
  error estimate for blocks of size 2^( 4) =       0.000448568085
  error estimate for blocks of size 2^( 5) =       0.000459646868
  error estimate for blocks of size 2^( 6) =       0.000469015251
  error estimate for blocks of size 2^( 7) =       0.000475485212

      target function =                  N/A
              le_mean =     -16.923616818019
             les_mean =     286.746259099151
             stat err =       0.000463178854
             autocorr =       1.271493272081
              std dev =       0.580907105087
             le_variance =       0.337453064741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337530005871
                                         uncertainty =       0.004464226458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337530005871
                                         uncertainty =       0.004464226458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410749383
  error estimate for blocks of size 2^( 2) =       0.000423092992
  error estimate for blocks of size 2^( 3) =       0.000436379343
  error estimate for blocks of size 2^( 4) =       0.000448566792
  error estimate for blocks of size 2^( 5) =       0.000459658910
  error estimate for blocks of size 2^( 6) =       0.000469044161
  error estimate for blocks of size 2^( 7) =       0.000475535826

      target function =                  N/A
              le_mean =     -16.923613705562
             les_mean =     286.746130797112
             stat err =       0.000463201422
             autocorr =       1.271703685096
              std dev =       0.580887347712
             le_variance =       0.337430110732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337843092557
                                         uncertainty =       0.004466210499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337843092557
                                         uncertainty =       0.004466210499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410939864
  error estimate for blocks of size 2^( 2) =       0.000423272590
  error estimate for blocks of size 2^( 3) =       0.000436553391
  error estimate for blocks of size 2^( 4) =       0.000448747240
  error estimate for blocks of size 2^( 5) =       0.000459856315
  error estimate for blocks of size 2^( 6) =       0.000469268338
  error estimate for blocks of size 2^( 7) =       0.000475787387

      target function =                  N/A
              le_mean =     -16.923614847273
             les_mean =     286.746482473526
             stat err =       0.000463414820
             autocorr =       1.271695958442
              std dev =       0.581156728921
             le_variance =       0.337743143570


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923616068513        initial
     9.5367e-02     9.5367e-01             4.3161e-03       -16.923616818019  <--
     3.8147e-01     3.8147e+00             1.1766e-03       -16.923613705562
     1.5259e+00     1.5259e+01             2.9619e-04       -16.923614847273

*****************************************************************************
Applying the update for shift_i =   9.5367e-02     and shift_s =   9.5367e-01
*****************************************************************************

  Execution time = 6.3552e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.097524e-01 1 1  ON 0
 uu_1                 1.434688e-01 1 1  ON 1
 uu_2                 4.300099e-02 1 1  ON 2
 uu_3                -1.919394e-02 1 1  ON 3
 uu_4                -6.429254e-02 1 1  ON 4
 uu_5                -9.770359e-02 1 1  ON 5
 uu_6                -1.244379e-01 1 1  ON 6
 uu_7                -1.380719e-01 1 1  ON 7
 uu_8                -1.318488e-01 1 1  ON 8
 uu_9                -1.018890e-01 1 1  ON 9
 ud_0                 4.383762e-01 1 1  ON 10
 ud_1                 1.725469e-01 1 1  ON 11
 ud_2                 5.323684e-02 1 1  ON 12
 ud_3                -1.580404e-02 1 1  ON 13
 ud_4                -6.957814e-02 1 1  ON 14
 ud_5                -1.061712e-01 1 1  ON 15
 ud_6                -1.292105e-01 1 1  ON 16
 ud_7                -1.419878e-01 1 1  ON 17
 ud_8                -1.405446e-01 1 1  ON 18
 ud_9                -1.326828e-01 1 1  ON 19
 eO_0                -7.689490e-01 1 1  ON 20
 eO_1                -4.476372e-01 1 1  ON 21
 eO_2                -2.516458e-02 1 1  ON 22
 eO_3                 2.985691e-01 1 1  ON 23
 eO_4                 5.309112e-01 1 1  ON 24
 eO_5                 4.905902e-01 1 1  ON 25
 eO_6                 2.567811e-01 1 1  ON 26
 eO_7                -4.711281e-02 1 1  ON 27
 eO_8                -2.133198e-01 1 1  ON 28
 eO_9                -7.446888e-02 1 1  ON 29
eH1_0                -2.363128e-01 1 1  ON 30
eH1_1                -1.382285e-01 1 1  ON 31
eH1_2                -9.363867e-02 1 1  ON 32
eH1_3                -3.898841e-02 1 1  ON 33
eH1_4                 5.959841e-03 1 1  ON 34
eH1_5                 3.952714e-02 1 1  ON 35
eH1_6                 9.488020e-02 1 1  ON 36
eH1_7                 1.479232e-01 1 1  ON 37
eH1_8                 1.669394e-01 1 1  ON 38
eH1_9                 5.481679e-02 1 1  ON 39
eH2_0                -2.329979e-01 1 1  ON 40
eH2_1                -1.349688e-01 1 1  ON 41
eH2_2                -9.036873e-02 1 1  ON 42
eH2_3                -3.561225e-02 1 1  ON 43
eH2_4                 8.910117e-03 1 1  ON 44
eH2_5                 4.224410e-02 1 1  ON 45
eH2_6                 9.800972e-02 1 1  ON 46
eH2_7                 1.513407e-01 1 1  ON 47
eH2_8                 1.720880e-01 1 1  ON 48
eH2_9                 3.897716e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2016e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6930e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9332
    reference variance = 0.178325
====================================================
  Execution time = 4.7585e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3469e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1963e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334698086748
                                         uncertainty =       0.002544258987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334698086748
                                         uncertainty =       0.002544258987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409079974
  error estimate for blocks of size 2^( 2) =       0.000422186640
  error estimate for blocks of size 2^( 3) =       0.000434653476
  error estimate for blocks of size 2^( 4) =       0.000446603766
  error estimate for blocks of size 2^( 5) =       0.000456643701
  error estimate for blocks of size 2^( 6) =       0.000464500785
  error estimate for blocks of size 2^( 7) =       0.000471479557

      target function =                  N/A
              le_mean =     -16.923620335680
             les_mean =     286.743617948420
             stat err =       0.000459806952
             autocorr =       1.263381836174
              std dev =       0.578526446683
             le_variance =       0.334692849512


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692362033568e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923620335680       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923621356889       residual = 9.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923624239872       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923625678653       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923625109172       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923630848906       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923636910541       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923647484231       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923647673361       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.923650427356       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.923652286863       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.923650550218       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.923651605651       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.923650204536       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.923649038532       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.923648481783       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.923648789324       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.923649062559       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-02 is 1.174327e-02

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923620335680       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923621071896       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923622658318       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923623602405       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923622791123       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923627136343       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923630371358       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923631844808       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923631267274       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.923631363614       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.923631758409       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.923631332537       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.923631272680       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 3.267669e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923620335680       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923620683560       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923621261058       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923621646154       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923621304063       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923622991988       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923623849340       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923623563231       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923623552144       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.923623587306       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 8.267204e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201881 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9566e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.112910e-01 1 1  ON 0
 uu_1                 1.446229e-01 1 1  ON 1
 uu_2                 4.375645e-02 1 1  ON 2
 uu_3                -1.871890e-02 1 1  ON 3
 uu_4                -6.417031e-02 1 1  ON 4
 uu_5                -9.791311e-02 1 1  ON 5
 uu_6                -1.241483e-01 1 1  ON 6
 uu_7                -1.387585e-01 1 1  ON 7
 uu_8                -1.333098e-01 1 1  ON 8
 uu_9                -1.040705e-01 1 1  ON 9
 ud_0                 4.377446e-01 1 1  ON 10
 ud_1                 1.720720e-01 1 1  ON 11
 ud_2                 5.294990e-02 1 1  ON 12
 ud_3                -1.583608e-02 1 1  ON 13
 ud_4                -6.962535e-02 1 1  ON 14
 ud_5                -1.059338e-01 1 1  ON 15
 ud_6                -1.286486e-01 1 1  ON 16
 ud_7                -1.412892e-01 1 1  ON 17
 ud_8                -1.394757e-01 1 1  ON 18
 ud_9                -1.329275e-01 1 1  ON 19
 eO_0                -7.708321e-01 1 1  ON 20
 eO_1                -4.491690e-01 1 1  ON 21
 eO_2                -2.677586e-02 1 1  ON 22
 eO_3                 2.981531e-01 1 1  ON 23
 eO_4                 5.326121e-01 1 1  ON 24
 eO_5                 4.935390e-01 1 1  ON 25
 eO_6                 2.600487e-01 1 1  ON 26
 eO_7                -4.572705e-02 1 1  ON 27
 eO_8                -2.151299e-01 1 1  ON 28
 eO_9                -7.618910e-02 1 1  ON 29
eH1_0                -2.364608e-01 1 1  ON 30
eH1_1                -1.381307e-01 1 1  ON 31
eH1_2                -9.357604e-02 1 1  ON 32
eH1_3                -3.889404e-02 1 1  ON 33
eH1_4                 5.246963e-03 1 1  ON 34
eH1_5                 3.859732e-02 1 1  ON 35
eH1_6                 9.327515e-02 1 1  ON 36
eH1_7                 1.477762e-01 1 1  ON 37
eH1_8                 1.684800e-01 1 1  ON 38
eH1_9                 5.661532e-02 1 1  ON 39
eH2_0                -2.329502e-01 1 1  ON 40
eH2_1                -1.348613e-01 1 1  ON 41
eH2_2                -9.026477e-02 1 1  ON 42
eH2_3                -3.557691e-02 1 1  ON 43
eH2_4                 8.461358e-03 1 1  ON 44
eH2_5                 4.231558e-02 1 1  ON 45
eH2_6                 9.745232e-02 1 1  ON 46
eH2_7                 1.505296e-01 1 1  ON 47
eH2_8                 1.724199e-01 1 1  ON 48
eH2_9                 4.033374e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9406
    reference variance = 0.260271
====================================================
  Execution time = 4.3640e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.4091e-01
  Total weights = 2.0000e+06
  Execution time = 4.0689e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340910848840
                                         uncertainty =       0.004491878916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340910848840
                                         uncertainty =       0.004491878916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412812262
  error estimate for blocks of size 2^( 2) =       0.000425448147
  error estimate for blocks of size 2^( 3) =       0.000438556429
  error estimate for blocks of size 2^( 4) =       0.000450999803
  error estimate for blocks of size 2^( 5) =       0.000461554519
  error estimate for blocks of size 2^( 6) =       0.000470362824
  error estimate for blocks of size 2^( 7) =       0.000474751094

      target function =                  N/A
              le_mean =     -16.923168387451
             les_mean =     286.734456026583
             stat err =       0.000464417060
             autocorr =       1.265642797877
              std dev =       0.583804699338
             le_variance =       0.340827926969

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341296301877
                                         uncertainty =       0.004499947790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341296301877
                                         uncertainty =       0.004499947790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413045368
  error estimate for blocks of size 2^( 2) =       0.000425664396
  error estimate for blocks of size 2^( 3) =       0.000438749000
  error estimate for blocks of size 2^( 4) =       0.000451159135
  error estimate for blocks of size 2^( 5) =       0.000461672608
  error estimate for blocks of size 2^( 6) =       0.000470461763
  error estimate for blocks of size 2^( 7) =       0.000474868995

      target function =                  N/A
              le_mean =     -16.923159485513
             les_mean =     286.734539754179
             stat err =       0.000464540625
             autocorr =       1.264887459593
              std dev =       0.584134361841
             le_variance =       0.341212952683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341103248310
                                         uncertainty =       0.004501041747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341103248310
                                         uncertainty =       0.004501041747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412928559
  error estimate for blocks of size 2^( 2) =       0.000425554262
  error estimate for blocks of size 2^( 3) =       0.000438653065
  error estimate for blocks of size 2^( 4) =       0.000451080953
  error estimate for blocks of size 2^( 5) =       0.000461612367
  error estimate for blocks of size 2^( 6) =       0.000470410720
  error estimate for blocks of size 2^( 7) =       0.000474833260

      target function =                  N/A
              le_mean =     -16.923160629467
             les_mean =     286.734385509922
             stat err =       0.000464484325
             autocorr =       1.265296431839
              std dev =       0.583969168443
             le_variance =       0.341019989692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340932308368
                                         uncertainty =       0.004493967481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340932308368
                                         uncertainty =       0.004493967481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412825216
  error estimate for blocks of size 2^( 2) =       0.000425458828
  error estimate for blocks of size 2^( 3) =       0.000438566127
  error estimate for blocks of size 2^( 4) =       0.000451007534
  error estimate for blocks of size 2^( 5) =       0.000461559214
  error estimate for blocks of size 2^( 6) =       0.000470365599
  error estimate for blocks of size 2^( 7) =       0.000474763146

      target function =                  N/A
              le_mean =     -16.923164974482
             les_mean =     286.734361900545
             stat err =       0.000464423873
             autocorr =       1.265600504303
              std dev =       0.583823018930
             le_variance =       0.340849317432


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923168387451        initial  <--
     2.3842e-02     2.3842e-01             1.1743e-02       -16.923159485513
     9.5367e-02     9.5367e-01             3.2677e-03       -16.923160629467
     3.8147e-01     3.8147e+00             8.2672e-04       -16.923164974482

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.1700
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.097524e-01 1 1  ON 0
 uu_1                 1.434688e-01 1 1  ON 1
 uu_2                 4.300099e-02 1 1  ON 2
 uu_3                -1.919394e-02 1 1  ON 3
 uu_4                -6.429254e-02 1 1  ON 4
 uu_5                -9.770359e-02 1 1  ON 5
 uu_6                -1.244379e-01 1 1  ON 6
 uu_7                -1.380719e-01 1 1  ON 7
 uu_8                -1.318488e-01 1 1  ON 8
 uu_9                -1.018890e-01 1 1  ON 9
 ud_0                 4.383762e-01 1 1  ON 10
 ud_1                 1.725469e-01 1 1  ON 11
 ud_2                 5.323684e-02 1 1  ON 12
 ud_3                -1.580404e-02 1 1  ON 13
 ud_4                -6.957814e-02 1 1  ON 14
 ud_5                -1.061712e-01 1 1  ON 15
 ud_6                -1.292105e-01 1 1  ON 16
 ud_7                -1.419878e-01 1 1  ON 17
 ud_8                -1.405446e-01 1 1  ON 18
 ud_9                -1.326828e-01 1 1  ON 19
 eO_0                -7.689490e-01 1 1  ON 20
 eO_1                -4.476372e-01 1 1  ON 21
 eO_2                -2.516458e-02 1 1  ON 22
 eO_3                 2.985691e-01 1 1  ON 23
 eO_4                 5.309112e-01 1 1  ON 24
 eO_5                 4.905902e-01 1 1  ON 25
 eO_6                 2.567811e-01 1 1  ON 26
 eO_7                -4.711281e-02 1 1  ON 27
 eO_8                -2.133198e-01 1 1  ON 28
 eO_9                -7.446888e-02 1 1  ON 29
eH1_0                -2.363128e-01 1 1  ON 30
eH1_1                -1.382285e-01 1 1  ON 31
eH1_2                -9.363867e-02 1 1  ON 32
eH1_3                -3.898841e-02 1 1  ON 33
eH1_4                 5.959841e-03 1 1  ON 34
eH1_5                 3.952714e-02 1 1  ON 35
eH1_6                 9.488020e-02 1 1  ON 36
eH1_7                 1.479232e-01 1 1  ON 37
eH1_8                 1.669394e-01 1 1  ON 38
eH1_9                 5.481679e-02 1 1  ON 39
eH2_0                -2.329979e-01 1 1  ON 40
eH2_1                -1.349688e-01 1 1  ON 41
eH2_2                -9.036873e-02 1 1  ON 42
eH2_3                -3.561225e-02 1 1  ON 43
eH2_4                 8.910117e-03 1 1  ON 44
eH2_5                 4.224410e-02 1 1  ON 45
eH2_6                 9.800972e-02 1 1  ON 46
eH2_7                 1.513407e-01 1 1  ON 47
eH2_8                 1.720880e-01 1 1  ON 48
eH2_9                 3.897716e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2374e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6930e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9856
    reference variance = 0.662511
====================================================
  Execution time = 4.7817e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3810e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1953e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337587858681
                                         uncertainty =       0.006970216871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337587858681
                                         uncertainty =       0.006970216871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411158838
  error estimate for blocks of size 2^( 2) =       0.000423920808
  error estimate for blocks of size 2^( 3) =       0.000436831936
  error estimate for blocks of size 2^( 4) =       0.000449959794
  error estimate for blocks of size 2^( 5) =       0.000459980787
  error estimate for blocks of size 2^( 6) =       0.000469357269
  error estimate for blocks of size 2^( 7) =       0.000477785859

      target function =                  N/A
              le_mean =     -16.922693333787
             les_mean =     286.715652680931
             stat err =       0.000464270927
             autocorr =       1.275039729732
              std dev =       0.581466405385
             le_variance =       0.338103180592


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692269333379e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922693333787       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922693800360       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922695419972       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922696744731       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922697664448       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922701075023       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922701018995       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922699287446       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.922700151953       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.922700267365       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.922700271539       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 1.261170e-03

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922693333787       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922693485862       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922693853984       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922694120897       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922694439766       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922695228526       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922695222969       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922694948384       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.922694995261       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 3.198997e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922693333787       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922693374930       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922693459135       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922693488649       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922693565991       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922693745513       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922693761090       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922693724344       residual = 8.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 7.909661e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.207763 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9782e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.097733e-01 1 1  ON 0
 uu_1                 1.436213e-01 1 1  ON 1
 uu_2                 4.307334e-02 1 1  ON 2
 uu_3                -1.911925e-02 1 1  ON 3
 uu_4                -6.427656e-02 1 1  ON 4
 uu_5                -9.771580e-02 1 1  ON 5
 uu_6                -1.245457e-01 1 1  ON 6
 uu_7                -1.381630e-01 1 1  ON 7
 uu_8                -1.319355e-01 1 1  ON 8
 uu_9                -1.020165e-01 1 1  ON 9
 ud_0                 4.382623e-01 1 1  ON 10
 ud_1                 1.724146e-01 1 1  ON 11
 ud_2                 5.309148e-02 1 1  ON 12
 ud_3                -1.580812e-02 1 1  ON 13
 ud_4                -6.965617e-02 1 1  ON 14
 ud_5                -1.061990e-01 1 1  ON 15
 ud_6                -1.290052e-01 1 1  ON 16
 ud_7                -1.418474e-01 1 1  ON 17
 ud_8                -1.404037e-01 1 1  ON 18
 ud_9                -1.326168e-01 1 1  ON 19
 eO_0                -7.691395e-01 1 1  ON 20
 eO_1                -4.478733e-01 1 1  ON 21
 eO_2                -2.541031e-02 1 1  ON 22
 eO_3                 2.985490e-01 1 1  ON 23
 eO_4                 5.311671e-01 1 1  ON 24
 eO_5                 4.909101e-01 1 1  ON 25
 eO_6                 2.570876e-01 1 1  ON 26
 eO_7                -4.695561e-02 1 1  ON 27
 eO_8                -2.134767e-01 1 1  ON 28
 eO_9                -7.463227e-02 1 1  ON 29
eH1_0                -2.362681e-01 1 1  ON 30
eH1_1                -1.381985e-01 1 1  ON 31
eH1_2                -9.369128e-02 1 1  ON 32
eH1_3                -3.904729e-02 1 1  ON 33
eH1_4                 5.796643e-03 1 1  ON 34
eH1_5                 3.952548e-02 1 1  ON 35
eH1_6                 9.477669e-02 1 1  ON 36
eH1_7                 1.478864e-01 1 1  ON 37
eH1_8                 1.670873e-01 1 1  ON 38
eH1_9                 5.499840e-02 1 1  ON 39
eH2_0                -2.329827e-01 1 1  ON 40
eH2_1                -1.350129e-01 1 1  ON 41
eH2_2                -9.042198e-02 1 1  ON 42
eH2_3                -3.562287e-02 1 1  ON 43
eH2_4                 8.771441e-03 1 1  ON 44
eH2_5                 4.205428e-02 1 1  ON 45
eH2_6                 9.808982e-02 1 1  ON 46
eH2_7                 1.513825e-01 1 1  ON 47
eH2_8                 1.722217e-01 1 1  ON 48
eH2_9                 3.916020e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8721
    reference variance = 0.375222
====================================================
  Execution time = 4.3124e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3467e-01
  Total weights = 2.0000e+06
  Execution time = 4.0513e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334705158775
                                         uncertainty =       0.003353844053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334705158775
                                         uncertainty =       0.003353844053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409042651
  error estimate for blocks of size 2^( 2) =       0.000421656495
  error estimate for blocks of size 2^( 3) =       0.000434379281
  error estimate for blocks of size 2^( 4) =       0.000446486276
  error estimate for blocks of size 2^( 5) =       0.000457135549
  error estimate for blocks of size 2^( 6) =       0.000463717846
  error estimate for blocks of size 2^( 7) =       0.000470894107

      target function =                  N/A
              le_mean =     -16.923517974965
             les_mean =     286.740092261835
             stat err =       0.000459558445
             autocorr =       1.262246902969
              std dev =       0.578473664213
             le_variance =       0.334631780188

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334787916884
                                         uncertainty =       0.003352786431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334787916884
                                         uncertainty =       0.003352786431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409093260
  error estimate for blocks of size 2^( 2) =       0.000421704330
  error estimate for blocks of size 2^( 3) =       0.000434424085
  error estimate for blocks of size 2^( 4) =       0.000446527793
  error estimate for blocks of size 2^( 5) =       0.000457167186
  error estimate for blocks of size 2^( 6) =       0.000463741104
  error estimate for blocks of size 2^( 7) =       0.000470913921

      target function =                  N/A
              le_mean =     -16.923517804146
             les_mean =     286.740169290741
             stat err =       0.000459587501
             autocorr =       1.262094195932
              std dev =       0.578545236650
             le_variance =       0.334714590851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334783308888
                                         uncertainty =       0.003352777426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334783308888
                                         uncertainty =       0.003352777426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409090449
  error estimate for blocks of size 2^( 2) =       0.000421700333
  error estimate for blocks of size 2^( 3) =       0.000434420031
  error estimate for blocks of size 2^( 4) =       0.000446525200
  error estimate for blocks of size 2^( 5) =       0.000457167891
  error estimate for blocks of size 2^( 6) =       0.000463747801
  error estimate for blocks of size 2^( 7) =       0.000470923096

      target function =                  N/A
              le_mean =     -16.923518223650
             les_mean =     286.740178889827
             stat err =       0.000459590997
             autocorr =       1.262130741126
              std dev =       0.578541261245
             le_variance =       0.334709990963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334721224513
                                         uncertainty =       0.003353734067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334721224513
                                         uncertainty =       0.003353734067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409052476
  error estimate for blocks of size 2^( 2) =       0.000421665399
  error estimate for blocks of size 2^( 3) =       0.000434387522
  error estimate for blocks of size 2^( 4) =       0.000446494196
  error estimate for blocks of size 2^( 5) =       0.000457142487
  error estimate for blocks of size 2^( 6) =       0.000463724595
  error estimate for blocks of size 2^( 7) =       0.000470900744

      target function =                  N/A
              le_mean =     -16.923518007621
             les_mean =     286.740109443977
             stat err =       0.000459565506
             autocorr =       1.262225049242
              std dev =       0.578487559963
             le_variance =       0.334647857032


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923517974965        initial
     2.3842e-01     2.3842e+00             1.2612e-03       -16.923517804146
     9.5367e-01     9.5367e+00             3.1990e-04       -16.923518223650  <--
     3.8147e+00     3.8147e+01             7.9097e-05       -16.923518007621

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 6.3595e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.097733e-01 1 1  ON 0
 uu_1                 1.436213e-01 1 1  ON 1
 uu_2                 4.307334e-02 1 1  ON 2
 uu_3                -1.911925e-02 1 1  ON 3
 uu_4                -6.427656e-02 1 1  ON 4
 uu_5                -9.771580e-02 1 1  ON 5
 uu_6                -1.245457e-01 1 1  ON 6
 uu_7                -1.381630e-01 1 1  ON 7
 uu_8                -1.319355e-01 1 1  ON 8
 uu_9                -1.020165e-01 1 1  ON 9
 ud_0                 4.382623e-01 1 1  ON 10
 ud_1                 1.724146e-01 1 1  ON 11
 ud_2                 5.309148e-02 1 1  ON 12
 ud_3                -1.580812e-02 1 1  ON 13
 ud_4                -6.965617e-02 1 1  ON 14
 ud_5                -1.061990e-01 1 1  ON 15
 ud_6                -1.290052e-01 1 1  ON 16
 ud_7                -1.418474e-01 1 1  ON 17
 ud_8                -1.404037e-01 1 1  ON 18
 ud_9                -1.326168e-01 1 1  ON 19
 eO_0                -7.691395e-01 1 1  ON 20
 eO_1                -4.478733e-01 1 1  ON 21
 eO_2                -2.541031e-02 1 1  ON 22
 eO_3                 2.985490e-01 1 1  ON 23
 eO_4                 5.311671e-01 1 1  ON 24
 eO_5                 4.909101e-01 1 1  ON 25
 eO_6                 2.570876e-01 1 1  ON 26
 eO_7                -4.695561e-02 1 1  ON 27
 eO_8                -2.134767e-01 1 1  ON 28
 eO_9                -7.463227e-02 1 1  ON 29
eH1_0                -2.362681e-01 1 1  ON 30
eH1_1                -1.381985e-01 1 1  ON 31
eH1_2                -9.369128e-02 1 1  ON 32
eH1_3                -3.904729e-02 1 1  ON 33
eH1_4                 5.796643e-03 1 1  ON 34
eH1_5                 3.952548e-02 1 1  ON 35
eH1_6                 9.477669e-02 1 1  ON 36
eH1_7                 1.478864e-01 1 1  ON 37
eH1_8                 1.670873e-01 1 1  ON 38
eH1_9                 5.499840e-02 1 1  ON 39
eH2_0                -2.329827e-01 1 1  ON 40
eH2_1                -1.350129e-01 1 1  ON 41
eH2_2                -9.042198e-02 1 1  ON 42
eH2_3                -3.562287e-02 1 1  ON 43
eH2_4                 8.771441e-03 1 1  ON 44
eH2_5                 4.205428e-02 1 1  ON 45
eH2_6                 9.808982e-02 1 1  ON 46
eH2_7                 1.513825e-01 1 1  ON 47
eH2_8                 1.722217e-01 1 1  ON 48
eH2_9                 3.916020e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2338e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6930e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8817
    reference variance = 0.243602
====================================================
  Execution time = 4.4927e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.4036e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1998e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340442317457
                                         uncertainty =       0.004230109957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340442317457
                                         uncertainty =       0.004230109957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412528255
  error estimate for blocks of size 2^( 2) =       0.000424943512
  error estimate for blocks of size 2^( 3) =       0.000437878769
  error estimate for blocks of size 2^( 4) =       0.000449998634
  error estimate for blocks of size 2^( 5) =       0.000459746401
  error estimate for blocks of size 2^( 6) =       0.000467643085
  error estimate for blocks of size 2^( 7) =       0.000472307703

      target function =                  N/A
              le_mean =     -16.923387913177
             les_mean =     286.741417411872
             stat err =       0.000462423956
             autocorr =       1.256531122576
              std dev =       0.583403052956
             le_variance =       0.340359122198


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692338791318e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923387913177       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923390979378       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923389971228       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923391052195       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923392752350       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923392941700       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923394527616       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923394279315       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923394175248       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.923394004579       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.923394084142       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 1.357511e-03

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923387913177       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923388877000       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923388471239       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923388546322       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923389058716       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923389222131       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923389537418       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923389559398       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923389453812       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 3.434977e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923387913177       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923388170701       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923388059087       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923388056251       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923388158574       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923388207931       residual = 9.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923388293053       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923388292857       residual = 5.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 8.565850e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213241 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6937e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.098183e-01 1 1  ON 0
 uu_1                 1.437528e-01 1 1  ON 1
 uu_2                 4.310719e-02 1 1  ON 2
 uu_3                -1.911686e-02 1 1  ON 3
 uu_4                -6.425891e-02 1 1  ON 4
 uu_5                -9.772583e-02 1 1  ON 5
 uu_6                -1.244633e-01 1 1  ON 6
 uu_7                -1.381342e-01 1 1  ON 7
 uu_8                -1.320686e-01 1 1  ON 8
 uu_9                -1.022816e-01 1 1  ON 9
 ud_0                 4.382310e-01 1 1  ON 10
 ud_1                 1.723203e-01 1 1  ON 11
 ud_2                 5.305699e-02 1 1  ON 12
 ud_3                -1.589127e-02 1 1  ON 13
 ud_4                -6.962801e-02 1 1  ON 14
 ud_5                -1.061734e-01 1 1  ON 15
 ud_6                -1.289598e-01 1 1  ON 16
 ud_7                -1.416782e-01 1 1  ON 17
 ud_8                -1.404278e-01 1 1  ON 18
 ud_9                -1.326310e-01 1 1  ON 19
 eO_0                -7.693077e-01 1 1  ON 20
 eO_1                -4.480505e-01 1 1  ON 21
 eO_2                -2.550692e-02 1 1  ON 22
 eO_3                 2.985203e-01 1 1  ON 23
 eO_4                 5.312657e-01 1 1  ON 24
 eO_5                 4.912129e-01 1 1  ON 25
 eO_6                 2.574311e-01 1 1  ON 26
 eO_7                -4.683931e-02 1 1  ON 27
 eO_8                -2.136915e-01 1 1  ON 28
 eO_9                -7.479657e-02 1 1  ON 29
eH1_0                -2.363207e-01 1 1  ON 30
eH1_1                -1.382482e-01 1 1  ON 31
eH1_2                -9.374682e-02 1 1  ON 32
eH1_3                -3.902218e-02 1 1  ON 33
eH1_4                 5.706431e-03 1 1  ON 34
eH1_5                 3.949576e-02 1 1  ON 35
eH1_6                 9.474885e-02 1 1  ON 36
eH1_7                 1.478665e-01 1 1  ON 37
eH1_8                 1.672206e-01 1 1  ON 38
eH1_9                 5.516395e-02 1 1  ON 39
eH2_0                -2.329472e-01 1 1  ON 40
eH2_1                -1.349481e-01 1 1  ON 41
eH2_2                -9.045129e-02 1 1  ON 42
eH2_3                -3.561004e-02 1 1  ON 43
eH2_4                 8.715565e-03 1 1  ON 44
eH2_5                 4.196844e-02 1 1  ON 45
eH2_6                 9.789023e-02 1 1  ON 46
eH2_7                 1.512894e-01 1 1  ON 47
eH2_8                 1.723536e-01 1 1  ON 48
eH2_9                 3.936255e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9266
    reference variance = 0.414945
====================================================
  Execution time = 4.6162e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.4146e-01
  Total weights = 2.0000e+06
  Execution time = 4.0587e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341441706466
                                         uncertainty =       0.006777916671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341441706466
                                         uncertainty =       0.006777916671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413168258
  error estimate for blocks of size 2^( 2) =       0.000425950373
  error estimate for blocks of size 2^( 3) =       0.000438821553
  error estimate for blocks of size 2^( 4) =       0.000451150451
  error estimate for blocks of size 2^( 5) =       0.000461220960
  error estimate for blocks of size 2^( 6) =       0.000467703196
  error estimate for blocks of size 2^( 7) =       0.000472968102

      target function =                  N/A
              le_mean =     -16.922541083198
             les_mean =     286.713812561101
             stat err =       0.000463260677
             autocorr =       1.257178590379
              std dev =       0.584308154402
             le_variance =       0.341416019300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341559856525
                                         uncertainty =       0.006781732216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341559856525
                                         uncertainty =       0.006781732216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413239738
  error estimate for blocks of size 2^( 2) =       0.000426015282
  error estimate for blocks of size 2^( 3) =       0.000438878044
  error estimate for blocks of size 2^( 4) =       0.000451194801
  error estimate for blocks of size 2^( 5) =       0.000461257237
  error estimate for blocks of size 2^( 6) =       0.000467730826
  error estimate for blocks of size 2^( 7) =       0.000472980564

      target function =                  N/A
              le_mean =     -16.922540482957
             les_mean =     286.713910389133
             stat err =       0.000463290857
             autocorr =       1.256907458671
              std dev =       0.584409242370
             le_variance =       0.341534162568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341533978973
                                         uncertainty =       0.006779452039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341533978973
                                         uncertainty =       0.006779452039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413224075
  error estimate for blocks of size 2^( 2) =       0.000426001416
  error estimate for blocks of size 2^( 3) =       0.000438866903
  error estimate for blocks of size 2^( 4) =       0.000451187485
  error estimate for blocks of size 2^( 5) =       0.000461252785
  error estimate for blocks of size 2^( 6) =       0.000467730438
  error estimate for blocks of size 2^( 7) =       0.000472984667

      target function =                  N/A
              le_mean =     -16.922541016610
             les_mean =     286.713902560730
             stat err =       0.000463288844
             autocorr =       1.256991821223
              std dev =       0.584387091425
             le_variance =       0.341508272624

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341457006747
                                         uncertainty =       0.006778086835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341457006747
                                         uncertainty =       0.006778086835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413177514
  error estimate for blocks of size 2^( 2) =       0.000425958831
  error estimate for blocks of size 2^( 3) =       0.000438829142
  error estimate for blocks of size 2^( 4) =       0.000451156790
  error estimate for blocks of size 2^( 5) =       0.000461226495
  error estimate for blocks of size 2^( 6) =       0.000467708099
  error estimate for blocks of size 2^( 7) =       0.000472971437

      target function =                  N/A
              le_mean =     -16.922541103653
             les_mean =     286.713828550709
             stat err =       0.000463265705
             autocorr =       1.257149554792
              std dev =       0.584321244360
             le_variance =       0.341431316610


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.922541083198        initial
     2.3842e-01     2.3842e+00             1.3575e-03       -16.922540482957
     9.5367e-01     9.5367e+00             3.4350e-04       -16.922541016610
     3.8147e+00     3.8147e+01             8.5659e-05       -16.922541103653  <--

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 6.6686e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.097804e-01 1 1  ON 0
 uu_1                 1.436592e-01 1 1  ON 1
 uu_2                 4.308299e-02 1 1  ON 2
 uu_3                -1.912118e-02 1 1  ON 3
 uu_4                -6.426881e-02 1 1  ON 4
 uu_5                -9.771980e-02 1 1  ON 5
 uu_6                -1.245212e-01 1 1  ON 6
 uu_7                -1.381567e-01 1 1  ON 7
 uu_8                -1.319719e-01 1 1  ON 8
 uu_9                -1.020834e-01 1 1  ON 9
 ud_0                 4.382585e-01 1 1  ON 10
 ud_1                 1.723867e-01 1 1  ON 11
 ud_2                 5.308411e-02 1 1  ON 12
 ud_3                -1.583343e-02 1 1  ON 13
 ud_4                -6.964480e-02 1 1  ON 14
 ud_5                -1.061932e-01 1 1  ON 15
 ud_6                -1.289911e-01 1 1  ON 16
 ud_7                -1.418030e-01 1 1  ON 17
 ud_8                -1.404129e-01 1 1  ON 18
 ud_9                -1.326218e-01 1 1  ON 19
 eO_0                -7.691824e-01 1 1  ON 20
 eO_1                -4.479186e-01 1 1  ON 21
 eO_2                -2.543226e-02 1 1  ON 22
 eO_3                 2.985436e-01 1 1  ON 23
 eO_4                 5.311909e-01 1 1  ON 24
 eO_5                 4.909856e-01 1 1  ON 25
 eO_6                 2.571732e-01 1 1  ON 26
 eO_7                -4.692783e-02 1 1  ON 27
 eO_8                -2.135305e-01 1 1  ON 28
 eO_9                -7.467289e-02 1 1  ON 29
eH1_0                -2.362804e-01 1 1  ON 30
eH1_1                -1.382116e-01 1 1  ON 31
eH1_2                -9.370661e-02 1 1  ON 32
eH1_3                -3.903785e-02 1 1  ON 33
eH1_4                 5.771651e-03 1 1  ON 34
eH1_5                 3.951941e-02 1 1  ON 35
eH1_6                 9.477070e-02 1 1  ON 36
eH1_7                 1.478816e-01 1 1  ON 37
eH1_8                 1.671199e-01 1 1  ON 38
eH1_9                 5.503884e-02 1 1  ON 39
eH2_0                -2.329732e-01 1 1  ON 40
eH2_1                -1.349923e-01 1 1  ON 41
eH2_2                -9.043099e-02 1 1  ON 42
eH2_3                -3.561815e-02 1 1  ON 43
eH2_4                 8.756798e-03 1 1  ON 44
eH2_5                 4.203162e-02 1 1  ON 45
eH2_6                 9.803875e-02 1 1  ON 46
eH2_7                 1.513592e-01 1 1  ON 47
eH2_8                 1.722541e-01 1 1  ON 48
eH2_9                 3.920978e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2363e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6929e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8972
    reference variance = 0.171122
====================================================
  Execution time = 4.4814e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.4087e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1958e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340923095727
                                         uncertainty =       0.011240066581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340923095727
                                         uncertainty =       0.011240066581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412836162
  error estimate for blocks of size 2^( 2) =       0.000425285072
  error estimate for blocks of size 2^( 3) =       0.000438477641
  error estimate for blocks of size 2^( 4) =       0.000450156196
  error estimate for blocks of size 2^( 5) =       0.000462628771
  error estimate for blocks of size 2^( 6) =       0.000471452946
  error estimate for blocks of size 2^( 7) =       0.000476655929

      target function =                  N/A
              le_mean =     -16.922981863800
             les_mean =     286.728182384877
             stat err =       0.000465223460
             autocorr =       1.269894818841
              std dev =       0.583838498905
             le_variance =       0.340867392804


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692298186380e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922981863800       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922982357024       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922982927009       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922982798489       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922982826142       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922983155033       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922982892019       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922982851641       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.922982960368       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 3.791994e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922981863800       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922981998640       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922982151403       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922982099948       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922982112918       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922982172395       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922982118610       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922982114816       residual = 8.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 9.377887e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922981863800       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922981898317       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922981937252       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922981922555       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922981926081       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922981939359       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922981927028       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922981926572       residual = 6.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 2.351260e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.218135 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6782e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.097822e-01 1 1  ON 0
 uu_1                 1.437039e-01 1 1  ON 1
 uu_2                 4.310328e-02 1 1  ON 2
 uu_3                -1.911153e-02 1 1  ON 3
 uu_4                -6.427180e-02 1 1  ON 4
 uu_5                -9.772745e-02 1 1  ON 5
 uu_6                -1.245238e-01 1 1  ON 6
 uu_7                -1.381731e-01 1 1  ON 7
 uu_8                -1.320161e-01 1 1  ON 8
 uu_9                -1.021260e-01 1 1  ON 9
 ud_0                 4.382337e-01 1 1  ON 10
 ud_1                 1.723569e-01 1 1  ON 11
 ud_2                 5.305870e-02 1 1  ON 12
 ud_3                -1.586075e-02 1 1  ON 13
 ud_4                -6.965156e-02 1 1  ON 14
 ud_5                -1.062089e-01 1 1  ON 15
 ud_6                -1.289515e-01 1 1  ON 16
 ud_7                -1.417910e-01 1 1  ON 17
 ud_8                -1.403580e-01 1 1  ON 18
 ud_9                -1.325927e-01 1 1  ON 19
 eO_0                -7.692064e-01 1 1  ON 20
 eO_1                -4.479932e-01 1 1  ON 21
 eO_2                -2.548419e-02 1 1  ON 22
 eO_3                 2.985470e-01 1 1  ON 23
 eO_4                 5.312196e-01 1 1  ON 24
 eO_5                 4.910596e-01 1 1  ON 25
 eO_6                 2.572670e-01 1 1  ON 26
 eO_7                -4.690311e-02 1 1  ON 27
 eO_8                -2.135635e-01 1 1  ON 28
 eO_9                -7.470772e-02 1 1  ON 29
eH1_0                -2.362880e-01 1 1  ON 30
eH1_1                -1.382115e-01 1 1  ON 31
eH1_2                -9.369814e-02 1 1  ON 32
eH1_3                -3.902269e-02 1 1  ON 33
eH1_4                 5.719305e-03 1 1  ON 34
eH1_5                 3.948322e-02 1 1  ON 35
eH1_6                 9.475493e-02 1 1  ON 36
eH1_7                 1.479088e-01 1 1  ON 37
eH1_8                 1.671557e-01 1 1  ON 38
eH1_9                 5.506951e-02 1 1  ON 39
eH2_0                -2.329508e-01 1 1  ON 40
eH2_1                -1.350224e-01 1 1  ON 41
eH2_2                -9.044932e-02 1 1  ON 42
eH2_3                -3.560359e-02 1 1  ON 43
eH2_4                 8.720832e-03 1 1  ON 44
eH2_5                 4.204126e-02 1 1  ON 45
eH2_6                 9.802105e-02 1 1  ON 46
eH2_7                 1.513312e-01 1 1  ON 47
eH2_8                 1.722777e-01 1 1  ON 48
eH2_9                 3.926577e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.876
    reference variance = 0.390891
====================================================
  Execution time = 4.6671e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.5116e-01
  Total weights = 2.0000e+06
  Execution time = 4.0538e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351074299784
                                         uncertainty =       0.009713967531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351074299784
                                         uncertainty =       0.009713967531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419018695
  error estimate for blocks of size 2^( 2) =       0.000431590005
  error estimate for blocks of size 2^( 3) =       0.000443939602
  error estimate for blocks of size 2^( 4) =       0.000456662706
  error estimate for blocks of size 2^( 5) =       0.000467019161
  error estimate for blocks of size 2^( 6) =       0.000475212614
  error estimate for blocks of size 2^( 7) =       0.000479789887

      target function =                  N/A
              le_mean =     -16.924488490304
             les_mean =     286.789463815545
             stat err =       0.000469671092
             autocorr =       1.256379559748
              std dev =       0.592581920653
             le_variance =       0.351153332685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351082212374
                                         uncertainty =       0.009720975271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351082212374
                                         uncertainty =       0.009720975271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419023406
  error estimate for blocks of size 2^( 2) =       0.000431594427
  error estimate for blocks of size 2^( 3) =       0.000443943500
  error estimate for blocks of size 2^( 4) =       0.000456664578
  error estimate for blocks of size 2^( 5) =       0.000467018812
  error estimate for blocks of size 2^( 6) =       0.000475211513
  error estimate for blocks of size 2^( 7) =       0.000479787284

      target function =                  N/A
              le_mean =     -16.924489113331
             les_mean =     286.789492801261
             stat err =       0.000469670547
             autocorr =       1.256348388375
              std dev =       0.592588583731
             le_variance =       0.351161229568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351083526194
                                         uncertainty =       0.009718621540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351083526194
                                         uncertainty =       0.009718621540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419024196
  error estimate for blocks of size 2^( 2) =       0.000431595167
  error estimate for blocks of size 2^( 3) =       0.000443944337
  error estimate for blocks of size 2^( 4) =       0.000456666161
  error estimate for blocks of size 2^( 5) =       0.000467021442
  error estimate for blocks of size 2^( 6) =       0.000475214624
  error estimate for blocks of size 2^( 7) =       0.000479791231

      target function =                  N/A
              le_mean =     -16.924488792781
             les_mean =     286.789483274549
             stat err =       0.000469673365
             autocorr =       1.256358728435
              std dev =       0.592589700505
             le_variance =       0.351162553145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351075705159
                                         uncertainty =       0.009714585870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351075705159
                                         uncertainty =       0.009714585870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419019533
  error estimate for blocks of size 2^( 2) =       0.000431590794
  error estimate for blocks of size 2^( 3) =       0.000443940331
  error estimate for blocks of size 2^( 4) =       0.000456663264
  error estimate for blocks of size 2^( 5) =       0.000467019565
  error estimate for blocks of size 2^( 6) =       0.000475212989
  error estimate for blocks of size 2^( 7) =       0.000479790178

      target function =                  N/A
              le_mean =     -16.924488525962
             les_mean =     286.789466427109
             stat err =       0.000469671499
             autocorr =       1.256376710919
              std dev =       0.592583105792
             le_variance =       0.351154737270


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924488490304        initial
     9.5367e-01     9.5367e+00             3.7920e-04       -16.924489113331  <--
     3.8147e+00     3.8147e+01             9.3779e-05       -16.924488792781
     1.5259e+01     1.5259e+02             2.3513e-05       -16.924488525962

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 6.7160e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.098050e-01 1 1  ON 0
 uu_1                 1.438187e-01 1 1  ON 1
 uu_2                 4.315765e-02 1 1  ON 2
 uu_3                -1.908340e-02 1 1  ON 3
 uu_4                -6.427984e-02 1 1  ON 4
 uu_5                -9.774554e-02 1 1  ON 5
 uu_6                -1.245349e-01 1 1  ON 6
 uu_7                -1.382195e-01 1 1  ON 7
 uu_8                -1.321455e-01 1 1  ON 8
 uu_9                -1.022550e-01 1 1  ON 9
 ud_0                 4.381540e-01 1 1  ON 10
 ud_1                 1.722715e-01 1 1  ON 11
 ud_2                 5.299313e-02 1 1  ON 12
 ud_3                -1.593301e-02 1 1  ON 13
 ud_4                -6.968021e-02 1 1  ON 14
 ud_5                -1.062419e-01 1 1  ON 15
 ud_6                -1.288613e-01 1 1  ON 16
 ud_7                -1.417549e-01 1 1  ON 17
 ud_8                -1.401920e-01 1 1  ON 18
 ud_9                -1.325031e-01 1 1  ON 19
 eO_0                -7.693016e-01 1 1  ON 20
 eO_1                -4.481917e-01 1 1  ON 21
 eO_2                -2.563440e-02 1 1  ON 22
 eO_3                 2.985405e-01 1 1  ON 23
 eO_4                 5.313079e-01 1 1  ON 24
 eO_5                 4.912853e-01 1 1  ON 25
 eO_6                 2.575524e-01 1 1  ON 26
 eO_7                -4.682555e-02 1 1  ON 27
 eO_8                -2.136639e-01 1 1  ON 28
 eO_9                -7.481472e-02 1 1  ON 29
eH1_0                -2.363149e-01 1 1  ON 30
eH1_1                -1.382143e-01 1 1  ON 31
eH1_2                -9.367290e-02 1 1  ON 32
eH1_3                -3.898881e-02 1 1  ON 33
eH1_4                 5.579943e-03 1 1  ON 34
eH1_5                 3.937592e-02 1 1  ON 35
eH1_6                 9.470457e-02 1 1  ON 36
eH1_7                 1.479891e-01 1 1  ON 37
eH1_8                 1.672648e-01 1 1  ON 38
eH1_9                 5.516421e-02 1 1  ON 39
eH2_0                -2.329009e-01 1 1  ON 40
eH2_1                -1.350984e-01 1 1  ON 41
eH2_2                -9.049927e-02 1 1  ON 42
eH2_3                -3.557452e-02 1 1  ON 43
eH2_4                 8.629906e-03 1 1  ON 44
eH2_5                 4.206032e-02 1 1  ON 45
eH2_6                 9.796656e-02 1 1  ON 46
eH2_7                 1.512479e-01 1 1  ON 47
eH2_8                 1.723501e-01 1 1  ON 48
eH2_9                 3.943771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2395e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6926e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8276
    reference variance = 0.225207
====================================================
  Execution time = 4.4637e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3811e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1891e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338210634233
                                         uncertainty =       0.003574544724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338210634233
                                         uncertainty =       0.003574544724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411160522
  error estimate for blocks of size 2^( 2) =       0.000423868941
  error estimate for blocks of size 2^( 3) =       0.000437994423
  error estimate for blocks of size 2^( 4) =       0.000451803841
  error estimate for blocks of size 2^( 5) =       0.000462320195
  error estimate for blocks of size 2^( 6) =       0.000469991042
  error estimate for blocks of size 2^( 7) =       0.000475384872

      target function =                  N/A
              le_mean =     -16.922827296575
             les_mean =     286.720189490578
             stat err =       0.000464874987
             autocorr =       1.278349309325
              std dev =       0.581468786723
             le_variance =       0.338105949934


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692282729657e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922827296575       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922831983237       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922833896304       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922835292993       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922834838122       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922836942015       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922837544049       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922838347524       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.922837326029       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.922837786089       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.922837644816       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 1.260469e-03

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922827296575       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922828764156       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922828933006       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922829394575       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922829226612       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922829949219       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922830025669       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922830027185       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.922830006600       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 3.128209e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922827296575       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922827688197       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922827689259       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922827814200       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922827751958       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922827947262       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922827977377       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922827950143       residual = 7.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 7.720623e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224504 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6541e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.098195e-01 1 1  ON 0
 uu_1                 1.438686e-01 1 1  ON 1
 uu_2                 4.316616e-02 1 1  ON 2
 uu_3                -1.909681e-02 1 1  ON 3
 uu_4                -6.435907e-02 1 1  ON 4
 uu_5                -9.782158e-02 1 1  ON 5
 uu_6                -1.244965e-01 1 1  ON 6
 uu_7                -1.383159e-01 1 1  ON 7
 uu_8                -1.321137e-01 1 1  ON 8
 uu_9                -1.023553e-01 1 1  ON 9
 ud_0                 4.379941e-01 1 1  ON 10
 ud_1                 1.721639e-01 1 1  ON 11
 ud_2                 5.285979e-02 1 1  ON 12
 ud_3                -1.604144e-02 1 1  ON 13
 ud_4                -6.971921e-02 1 1  ON 14
 ud_5                -1.062886e-01 1 1  ON 15
 ud_6                -1.288801e-01 1 1  ON 16
 ud_7                -1.415384e-01 1 1  ON 17
 ud_8                -1.400534e-01 1 1  ON 18
 ud_9                -1.323510e-01 1 1  ON 19
 eO_0                -7.695662e-01 1 1  ON 20
 eO_1                -4.484215e-01 1 1  ON 21
 eO_2                -2.582634e-02 1 1  ON 22
 eO_3                 2.984518e-01 1 1  ON 23
 eO_4                 5.315706e-01 1 1  ON 24
 eO_5                 4.915977e-01 1 1  ON 25
 eO_6                 2.578652e-01 1 1  ON 26
 eO_7                -4.665971e-02 1 1  ON 27
 eO_8                -2.137887e-01 1 1  ON 28
 eO_9                -7.495677e-02 1 1  ON 29
eH1_0                -2.363131e-01 1 1  ON 30
eH1_1                -1.382781e-01 1 1  ON 31
eH1_2                -9.373380e-02 1 1  ON 32
eH1_3                -3.905877e-02 1 1  ON 33
eH1_4                 5.517351e-03 1 1  ON 34
eH1_5                 3.922009e-02 1 1  ON 35
eH1_6                 9.458688e-02 1 1  ON 36
eH1_7                 1.480931e-01 1 1  ON 37
eH1_8                 1.674905e-01 1 1  ON 38
eH1_9                 5.535166e-02 1 1  ON 39
eH2_0                -2.329199e-01 1 1  ON 40
eH2_1                -1.350002e-01 1 1  ON 41
eH2_2                -9.054538e-02 1 1  ON 42
eH2_3                -3.565892e-02 1 1  ON 43
eH2_4                 8.493076e-03 1 1  ON 44
eH2_5                 4.204331e-02 1 1  ON 45
eH2_6                 9.790469e-02 1 1  ON 46
eH2_7                 1.511914e-01 1 1  ON 47
eH2_8                 1.724499e-01 1 1  ON 48
eH2_9                 3.963740e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9922
    reference variance = 0.697247
====================================================
  Execution time = 4.3388e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3844e-01
  Total weights = 2.0000e+06
  Execution time = 4.0620e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337890859518
                                         uncertainty =       0.004318133717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337890859518
                                         uncertainty =       0.004318133717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411364101
  error estimate for blocks of size 2^( 2) =       0.000424318565
  error estimate for blocks of size 2^( 3) =       0.000437403348
  error estimate for blocks of size 2^( 4) =       0.000449805943
  error estimate for blocks of size 2^( 5) =       0.000460724423
  error estimate for blocks of size 2^( 6) =       0.000468018618
  error estimate for blocks of size 2^( 7) =       0.000473343310

      target function =                  N/A
              le_mean =     -16.923496866073
             les_mean =     286.743186853202
             stat err =       0.000462973074
             autocorr =       1.266656014880
              std dev =       0.581756690066
             le_variance =       0.338440846437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337939015558
                                         uncertainty =       0.004319596603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337939015558
                                         uncertainty =       0.004319596603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411393388
  error estimate for blocks of size 2^( 2) =       0.000424349586
  error estimate for blocks of size 2^( 3) =       0.000437435823
  error estimate for blocks of size 2^( 4) =       0.000449831854
  error estimate for blocks of size 2^( 5) =       0.000460738967
  error estimate for blocks of size 2^( 6) =       0.000468011243
  error estimate for blocks of size 2^( 7) =       0.000473329760

      target function =                  N/A
              le_mean =     -16.923496691292
             les_mean =     286.743229131034
             stat err =       0.000462977956
             autocorr =       1.266502380308
              std dev =       0.581798109402
             le_variance =       0.338489040104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337894320115
                                         uncertainty =       0.004319003179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337894320115
                                         uncertainty =       0.004319003179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411366198
  error estimate for blocks of size 2^( 2) =       0.000424321850
  error estimate for blocks of size 2^( 3) =       0.000437408072
  error estimate for blocks of size 2^( 4) =       0.000449807273
  error estimate for blocks of size 2^( 5) =       0.000460719560
  error estimate for blocks of size 2^( 6) =       0.000468000738
  error estimate for blocks of size 2^( 7) =       0.000473322177

      target function =                  N/A
              le_mean =     -16.923496598055
             les_mean =     286.743181233362
             stat err =       0.000462962437
             autocorr =       1.266584895985
              std dev =       0.581759656740
             le_variance =       0.338444298210

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337890023160
                                         uncertainty =       0.004318253796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337890023160
                                         uncertainty =       0.004318253796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411363589
  error estimate for blocks of size 2^( 2) =       0.000424318139
  error estimate for blocks of size 2^( 3) =       0.000437403053
  error estimate for blocks of size 2^( 4) =       0.000449805170
  error estimate for blocks of size 2^( 5) =       0.000460722738
  error estimate for blocks of size 2^( 6) =       0.000468015092
  error estimate for blocks of size 2^( 7) =       0.000473339309

      target function =                  N/A
              le_mean =     -16.923496770823
             les_mean =     286.743182786913
             stat err =       0.000462970577
             autocorr =       1.266645508491
              std dev =       0.581755966094
             le_variance =       0.338440004086


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923496866073        initial  <--
     2.3842e-01     2.3842e+00             1.2605e-03       -16.923496691292
     9.5367e-01     9.5367e+00             3.1282e-04       -16.923496598055
     3.8147e+00     3.8147e+01             7.7206e-05       -16.923496770823

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 67.9108
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.098050e-01 1 1  ON 0
 uu_1                 1.438187e-01 1 1  ON 1
 uu_2                 4.315765e-02 1 1  ON 2
 uu_3                -1.908340e-02 1 1  ON 3
 uu_4                -6.427984e-02 1 1  ON 4
 uu_5                -9.774554e-02 1 1  ON 5
 uu_6                -1.245349e-01 1 1  ON 6
 uu_7                -1.382195e-01 1 1  ON 7
 uu_8                -1.321455e-01 1 1  ON 8
 uu_9                -1.022550e-01 1 1  ON 9
 ud_0                 4.381540e-01 1 1  ON 10
 ud_1                 1.722715e-01 1 1  ON 11
 ud_2                 5.299313e-02 1 1  ON 12
 ud_3                -1.593301e-02 1 1  ON 13
 ud_4                -6.968021e-02 1 1  ON 14
 ud_5                -1.062419e-01 1 1  ON 15
 ud_6                -1.288613e-01 1 1  ON 16
 ud_7                -1.417549e-01 1 1  ON 17
 ud_8                -1.401920e-01 1 1  ON 18
 ud_9                -1.325031e-01 1 1  ON 19
 eO_0                -7.693016e-01 1 1  ON 20
 eO_1                -4.481917e-01 1 1  ON 21
 eO_2                -2.563440e-02 1 1  ON 22
 eO_3                 2.985405e-01 1 1  ON 23
 eO_4                 5.313079e-01 1 1  ON 24
 eO_5                 4.912853e-01 1 1  ON 25
 eO_6                 2.575524e-01 1 1  ON 26
 eO_7                -4.682555e-02 1 1  ON 27
 eO_8                -2.136639e-01 1 1  ON 28
 eO_9                -7.481472e-02 1 1  ON 29
eH1_0                -2.363149e-01 1 1  ON 30
eH1_1                -1.382143e-01 1 1  ON 31
eH1_2                -9.367290e-02 1 1  ON 32
eH1_3                -3.898881e-02 1 1  ON 33
eH1_4                 5.579943e-03 1 1  ON 34
eH1_5                 3.937592e-02 1 1  ON 35
eH1_6                 9.470457e-02 1 1  ON 36
eH1_7                 1.479891e-01 1 1  ON 37
eH1_8                 1.672648e-01 1 1  ON 38
eH1_9                 5.516421e-02 1 1  ON 39
eH2_0                -2.329009e-01 1 1  ON 40
eH2_1                -1.350984e-01 1 1  ON 41
eH2_2                -9.049927e-02 1 1  ON 42
eH2_3                -3.557452e-02 1 1  ON 43
eH2_4                 8.629906e-03 1 1  ON 44
eH2_5                 4.206032e-02 1 1  ON 45
eH2_6                 9.796656e-02 1 1  ON 46
eH2_7                 1.512479e-01 1 1  ON 47
eH2_8                 1.723501e-01 1 1  ON 48
eH2_9                 3.943771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2446e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6926e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8617
    reference variance = 0.38699
====================================================
  Execution time = 4.4659e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3233e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2065e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332348671871
                                         uncertainty =       0.003030777776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332348671871
                                         uncertainty =       0.003030777776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407633993
  error estimate for blocks of size 2^( 2) =       0.000420408905
  error estimate for blocks of size 2^( 3) =       0.000433948398
  error estimate for blocks of size 2^( 4) =       0.000446044224
  error estimate for blocks of size 2^( 5) =       0.000457204604
  error estimate for blocks of size 2^( 6) =       0.000464522690
  error estimate for blocks of size 2^( 7) =       0.000470212169

      target function =                  N/A
              le_mean =     -16.922573080897
             les_mean =     286.705810457096
             stat err =       0.000459495922
             autocorr =       1.270640037273
              std dev =       0.576481521781
             le_variance =       0.332330944955


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692257308090e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922573080897       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922573558946       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922573501138       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922573594373       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922573528191       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922573570982       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922573763466       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922573783771       residual = 8.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 1.346335e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922573080897       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922573204210       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922573184529       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922573205479       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922573188857       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922573197918       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922573244791       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922573249365       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 3.406788e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922573080897       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922573111972       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922573106724       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922573111861       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922573107583       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922573109700       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922573121307       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922573122433       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 8.541400e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.228822 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6734e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.098197e-01 1 1  ON 0
 uu_1                 1.438217e-01 1 1  ON 1
 uu_2                 4.315626e-02 1 1  ON 2
 uu_3                -1.909098e-02 1 1  ON 3
 uu_4                -6.427785e-02 1 1  ON 4
 uu_5                -9.775556e-02 1 1  ON 5
 uu_6                -1.245346e-01 1 1  ON 6
 uu_7                -1.382266e-01 1 1  ON 7
 uu_8                -1.321464e-01 1 1  ON 8
 uu_9                -1.022563e-01 1 1  ON 9
 ud_0                 4.381431e-01 1 1  ON 10
 ud_1                 1.722598e-01 1 1  ON 11
 ud_2                 5.298329e-02 1 1  ON 12
 ud_3                -1.594490e-02 1 1  ON 13
 ud_4                -6.968363e-02 1 1  ON 14
 ud_5                -1.062499e-01 1 1  ON 15
 ud_6                -1.288584e-01 1 1  ON 16
 ud_7                -1.417429e-01 1 1  ON 17
 ud_8                -1.401688e-01 1 1  ON 18
 ud_9                -1.324850e-01 1 1  ON 19
 eO_0                -7.693217e-01 1 1  ON 20
 eO_1                -4.482202e-01 1 1  ON 21
 eO_2                -2.565238e-02 1 1  ON 22
 eO_3                 2.985248e-01 1 1  ON 23
 eO_4                 5.313420e-01 1 1  ON 24
 eO_5                 4.913131e-01 1 1  ON 25
 eO_6                 2.575826e-01 1 1  ON 26
 eO_7                -4.681204e-02 1 1  ON 27
 eO_8                -2.136714e-01 1 1  ON 28
 eO_9                -7.482715e-02 1 1  ON 29
eH1_0                -2.363133e-01 1 1  ON 30
eH1_1                -1.382185e-01 1 1  ON 31
eH1_2                -9.368035e-02 1 1  ON 32
eH1_3                -3.897690e-02 1 1  ON 33
eH1_4                 5.565636e-03 1 1  ON 34
eH1_5                 3.936177e-02 1 1  ON 35
eH1_6                 9.470321e-02 1 1  ON 36
eH1_7                 1.479955e-01 1 1  ON 37
eH1_8                 1.672763e-01 1 1  ON 38
eH1_9                 5.517662e-02 1 1  ON 39
eH2_0                -2.329011e-01 1 1  ON 40
eH2_1                -1.350907e-01 1 1  ON 41
eH2_2                -9.050310e-02 1 1  ON 42
eH2_3                -3.558067e-02 1 1  ON 43
eH2_4                 8.608829e-03 1 1  ON 44
eH2_5                 4.205643e-02 1 1  ON 45
eH2_6                 9.795291e-02 1 1  ON 46
eH2_7                 1.512416e-01 1 1  ON 47
eH2_8                 1.723707e-01 1 1  ON 48
eH2_9                 3.946345e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.7797
    reference variance = 0.51562
====================================================
  Execution time = 4.3308e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.6048e-01
  Total weights = 2.0000e+06
  Execution time = 4.0684e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360625122054
                                         uncertainty =       0.019232465665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360625122054
                                         uncertainty =       0.019232465665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424544709
  error estimate for blocks of size 2^( 2) =       0.000437254173
  error estimate for blocks of size 2^( 3) =       0.000449883790
  error estimate for blocks of size 2^( 4) =       0.000461411594
  error estimate for blocks of size 2^( 5) =       0.000471420074
  error estimate for blocks of size 2^( 6) =       0.000480369838
  error estimate for blocks of size 2^( 7) =       0.000487263934

      target function =                  N/A
              le_mean =     -16.923529656668
             les_mean =     286.766332279425
             stat err =       0.000475116360
             autocorr =       1.252428969439
              std dev =       0.600396885014
             le_variance =       0.360476419535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360654346778
                                         uncertainty =       0.019234832737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360654346778
                                         uncertainty =       0.019234832737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424561904
  error estimate for blocks of size 2^( 2) =       0.000437270994
  error estimate for blocks of size 2^( 3) =       0.000449899906
  error estimate for blocks of size 2^( 4) =       0.000461426473
  error estimate for blocks of size 2^( 5) =       0.000471434486
  error estimate for blocks of size 2^( 6) =       0.000480382460
  error estimate for blocks of size 2^( 7) =       0.000487275644

      target function =                  N/A
              le_mean =     -16.923529984007
             les_mean =     286.766372560541
             stat err =       0.000475129766
             autocorr =       1.252398194381
              std dev =       0.600421203171
             le_variance =       0.360505621217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360641284777
                                         uncertainty =       0.019233845506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360641284777
                                         uncertainty =       0.019233845506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424554219
  error estimate for blocks of size 2^( 2) =       0.000437263458
  error estimate for blocks of size 2^( 3) =       0.000449892664
  error estimate for blocks of size 2^( 4) =       0.000461419816
  error estimate for blocks of size 2^( 5) =       0.000471428086
  error estimate for blocks of size 2^( 6) =       0.000480376951
  error estimate for blocks of size 2^( 7) =       0.000487270606

      target function =                  N/A
              le_mean =     -16.923529821251
             les_mean =     286.766353999687
             stat err =       0.000475123865
             autocorr =       1.252412428145
              std dev =       0.600410333988
             le_variance =       0.360492569159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360627193377
                                         uncertainty =       0.019232645133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360627193377
                                         uncertainty =       0.019232645133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424545928
  error estimate for blocks of size 2^( 2) =       0.000437255362
  error estimate for blocks of size 2^( 3) =       0.000449884926
  error estimate for blocks of size 2^( 4) =       0.000461412647
  error estimate for blocks of size 2^( 5) =       0.000471421101
  error estimate for blocks of size 2^( 6) =       0.000480370752
  error estimate for blocks of size 2^( 7) =       0.000487264794

      target function =                  N/A
              le_mean =     -16.923529676747
             les_mean =     286.766335028670
             stat err =       0.000475117324
             autocorr =       1.252426860353
              std dev =       0.600398608563
             le_variance =       0.360478489165


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923529656668        initial
     2.3842e+00     2.3842e+01             1.3463e-04       -16.923529984007  <--
     9.5367e+00     9.5367e+01             3.4068e-05       -16.923529821251
     3.8147e+01     3.8147e+02             8.5414e-06       -16.923529676747

*****************************************************************************
Applying the update for shift_i =   2.3842e+00     and shift_s =   2.3842e+01
*****************************************************************************

  Execution time = 6.5276e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.098611e-01 1 1  ON 0
 uu_1                 1.438296e-01 1 1  ON 1
 uu_2                 4.315324e-02 1 1  ON 2
 uu_3                -1.911051e-02 1 1  ON 3
 uu_4                -6.427501e-02 1 1  ON 4
 uu_5                -9.778283e-02 1 1  ON 5
 uu_6                -1.245348e-01 1 1  ON 6
 uu_7                -1.382478e-01 1 1  ON 7
 uu_8                -1.321485e-01 1 1  ON 8
 uu_9                -1.022597e-01 1 1  ON 9
 ud_0                 4.381091e-01 1 1  ON 10
 ud_1                 1.722257e-01 1 1  ON 11
 ud_2                 5.295282e-02 1 1  ON 12
 ud_3                -1.597773e-02 1 1  ON 13
 ud_4                -6.969699e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288504e-01 1 1  ON 16
 ud_7                -1.417079e-01 1 1  ON 17
 ud_8                -1.400993e-01 1 1  ON 18
 ud_9                -1.324304e-01 1 1  ON 19
 eO_0                -7.693822e-01 1 1  ON 20
 eO_1                -4.483039e-01 1 1  ON 21
 eO_2                -2.570682e-02 1 1  ON 22
 eO_3                 2.984779e-01 1 1  ON 23
 eO_4                 5.314425e-01 1 1  ON 24
 eO_5                 4.913964e-01 1 1  ON 25
 eO_6                 2.576719e-01 1 1  ON 26
 eO_7                -4.677186e-02 1 1  ON 27
 eO_8                -2.136933e-01 1 1  ON 28
 eO_9                -7.486393e-02 1 1  ON 29
eH1_0                -2.363096e-01 1 1  ON 30
eH1_1                -1.382291e-01 1 1  ON 31
eH1_2                -9.370057e-02 1 1  ON 32
eH1_3                -3.894518e-02 1 1  ON 33
eH1_4                 5.525143e-03 1 1  ON 34
eH1_5                 3.931870e-02 1 1  ON 35
eH1_6                 9.469881e-02 1 1  ON 36
eH1_7                 1.480148e-01 1 1  ON 37
eH1_8                 1.673106e-01 1 1  ON 38
eH1_9                 5.521354e-02 1 1  ON 39
eH2_0                -2.329015e-01 1 1  ON 40
eH2_1                -1.350690e-01 1 1  ON 41
eH2_2                -9.051451e-02 1 1  ON 42
eH2_3                -3.559854e-02 1 1  ON 43
eH2_4                 8.546989e-03 1 1  ON 44
eH2_5                 4.204375e-02 1 1  ON 45
eH2_6                 9.791262e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724318e-01 1 1  ON 48
eH2_9                 3.953994e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2203e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9382
    reference variance = 0.135237
====================================================
  Execution time = 4.5675e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3993e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1917e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339877788305
                                         uncertainty =       0.003840607099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339877788305
                                         uncertainty =       0.003840607099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412269344
  error estimate for blocks of size 2^( 2) =       0.000424966138
  error estimate for blocks of size 2^( 3) =       0.000438189040
  error estimate for blocks of size 2^( 4) =       0.000450917160
  error estimate for blocks of size 2^( 5) =       0.000460749423
  error estimate for blocks of size 2^( 6) =       0.000469365963
  error estimate for blocks of size 2^( 7) =       0.000475401933

      target function =                  N/A
              le_mean =     -16.923193762153
             les_mean =     286.734418965080
             stat err =       0.000464108620
             autocorr =       1.267293435950
              std dev =       0.583036897337
             le_variance =       0.339932023657


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692319376215e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923193762153       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923196078981       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923195287716       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923195691173       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923195539846       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923195696718       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923196243926       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923196358935       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923196343708       residual = 5.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 5.805505e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923193762153       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923194396578       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923194148251       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923194257103       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923194166223       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923194240361       residual = 9.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923194331881       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923194372321       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 1.450427e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923193762153       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923193924632       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923193858242       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923193885928       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923193857988       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923193877215       residual = 8.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923193898955       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923193908446       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 3.627549e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.233457 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7603e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.098986e-01 1 1  ON 0
 uu_1                 1.438370e-01 1 1  ON 1
 uu_2                 4.316808e-02 1 1  ON 2
 uu_3                -1.909617e-02 1 1  ON 3
 uu_4                -6.428088e-02 1 1  ON 4
 uu_5                -9.776737e-02 1 1  ON 5
 uu_6                -1.245627e-01 1 1  ON 6
 uu_7                -1.382550e-01 1 1  ON 7
 uu_8                -1.321845e-01 1 1  ON 8
 uu_9                -1.023095e-01 1 1  ON 9
 ud_0                 4.380282e-01 1 1  ON 10
 ud_1                 1.722051e-01 1 1  ON 11
 ud_2                 5.294398e-02 1 1  ON 12
 ud_3                -1.601130e-02 1 1  ON 13
 ud_4                -6.971245e-02 1 1  ON 14
 ud_5                -1.062392e-01 1 1  ON 15
 ud_6                -1.288402e-01 1 1  ON 16
 ud_7                -1.416259e-01 1 1  ON 17
 ud_8                -1.400359e-01 1 1  ON 18
 ud_9                -1.324346e-01 1 1  ON 19
 eO_0                -7.694815e-01 1 1  ON 20
 eO_1                -4.483650e-01 1 1  ON 21
 eO_2                -2.578545e-02 1 1  ON 22
 eO_3                 2.984197e-01 1 1  ON 23
 eO_4                 5.315321e-01 1 1  ON 24
 eO_5                 4.915415e-01 1 1  ON 25
 eO_6                 2.578061e-01 1 1  ON 26
 eO_7                -4.668735e-02 1 1  ON 27
 eO_8                -2.137677e-01 1 1  ON 28
 eO_9                -7.493492e-02 1 1  ON 29
eH1_0                -2.363163e-01 1 1  ON 30
eH1_1                -1.382219e-01 1 1  ON 31
eH1_2                -9.375580e-02 1 1  ON 32
eH1_3                -3.894129e-02 1 1  ON 33
eH1_4                 5.505571e-03 1 1  ON 34
eH1_5                 3.928263e-02 1 1  ON 35
eH1_6                 9.470252e-02 1 1  ON 36
eH1_7                 1.480398e-01 1 1  ON 37
eH1_8                 1.673536e-01 1 1  ON 38
eH1_9                 5.525432e-02 1 1  ON 39
eH2_0                -2.329011e-01 1 1  ON 40
eH2_1                -1.350336e-01 1 1  ON 41
eH2_2                -9.052897e-02 1 1  ON 42
eH2_3                -3.566572e-02 1 1  ON 43
eH2_4                 8.543986e-03 1 1  ON 44
eH2_5                 4.196660e-02 1 1  ON 45
eH2_6                 9.788033e-02 1 1  ON 46
eH2_7                 1.512330e-01 1 1  ON 47
eH2_8                 1.725105e-01 1 1  ON 48
eH2_9                 3.961904e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8881
    reference variance = 0.53065
====================================================
  Execution time = 4.3426e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6922e+01
  VMC Evar = 3.3995e-01
  Total weights = 2.0000e+06
  Execution time = 4.0595e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340014400898
                                         uncertainty =       0.004889202611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340014400898
                                         uncertainty =       0.004889202611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412304467
  error estimate for blocks of size 2^( 2) =       0.000425140945
  error estimate for blocks of size 2^( 3) =       0.000437790205
  error estimate for blocks of size 2^( 4) =       0.000449926543
  error estimate for blocks of size 2^( 5) =       0.000460540713
  error estimate for blocks of size 2^( 6) =       0.000468486494
  error estimate for blocks of size 2^( 7) =       0.000472460955

      target function =                  N/A
              le_mean =     -16.922485718618
             les_mean =     286.710512673512
             stat err =       0.000462853677
             autocorr =       1.260234474470
              std dev =       0.583086568753
             le_variance =       0.339989946661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339909682156
                                         uncertainty =       0.004885835253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339909682156
                                         uncertainty =       0.004885835253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412240968
  error estimate for blocks of size 2^( 2) =       0.000425081758
  error estimate for blocks of size 2^( 3) =       0.000437732802
  error estimate for blocks of size 2^( 4) =       0.000449870537
  error estimate for blocks of size 2^( 5) =       0.000460482471
  error estimate for blocks of size 2^( 6) =       0.000468420901
  error estimate for blocks of size 2^( 7) =       0.000472390016

      target function =                  N/A
              le_mean =     -16.922485352639
             les_mean =     286.710395571876
             stat err =       0.000462790981
             autocorr =       1.260281249771
              std dev =       0.582996768037
             le_variance =       0.339885231541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339927763698
                                         uncertainty =       0.004886546489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339927763698
                                         uncertainty =       0.004886546489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412251932
  error estimate for blocks of size 2^( 2) =       0.000425091674
  error estimate for blocks of size 2^( 3) =       0.000437742521
  error estimate for blocks of size 2^( 4) =       0.000449880467
  error estimate for blocks of size 2^( 5) =       0.000460493711
  error estimate for blocks of size 2^( 6) =       0.000468436155
  error estimate for blocks of size 2^( 7) =       0.000472407928

      target function =                  N/A
              le_mean =     -16.922485290259
             les_mean =     286.710411540502
             stat err =       0.000462804565
             autocorr =       1.260288197091
              std dev =       0.583012273823
             le_variance =       0.339903311428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340001635510
                                         uncertainty =       0.004888824943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340001635510
                                         uncertainty =       0.004888824943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412296726
  error estimate for blocks of size 2^( 2) =       0.000425133674
  error estimate for blocks of size 2^( 3) =       0.000437783179
  error estimate for blocks of size 2^( 4) =       0.000449919759
  error estimate for blocks of size 2^( 5) =       0.000460533832
  error estimate for blocks of size 2^( 6) =       0.000468479219
  error estimate for blocks of size 2^( 7) =       0.000472453360

      target function =                  N/A
              le_mean =     -16.922485649205
             les_mean =     286.710497558692
             stat err =       0.000462846542
             autocorr =       1.260242943416
              std dev =       0.583075622151
             le_variance =       0.339977181147


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.922485718618        initial  <--
     5.9605e-01     5.9605e+00             5.8055e-04       -16.922485352639
     2.3842e+00     2.3842e+01             1.4504e-04       -16.922485290259
     9.5367e+00     9.5367e+01             3.6275e-05       -16.922485649205

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.9437
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.098611e-01 1 1  ON 0
 uu_1                 1.438296e-01 1 1  ON 1
 uu_2                 4.315324e-02 1 1  ON 2
 uu_3                -1.911051e-02 1 1  ON 3
 uu_4                -6.427501e-02 1 1  ON 4
 uu_5                -9.778283e-02 1 1  ON 5
 uu_6                -1.245348e-01 1 1  ON 6
 uu_7                -1.382478e-01 1 1  ON 7
 uu_8                -1.321485e-01 1 1  ON 8
 uu_9                -1.022597e-01 1 1  ON 9
 ud_0                 4.381091e-01 1 1  ON 10
 ud_1                 1.722257e-01 1 1  ON 11
 ud_2                 5.295282e-02 1 1  ON 12
 ud_3                -1.597773e-02 1 1  ON 13
 ud_4                -6.969699e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288504e-01 1 1  ON 16
 ud_7                -1.417079e-01 1 1  ON 17
 ud_8                -1.400993e-01 1 1  ON 18
 ud_9                -1.324304e-01 1 1  ON 19
 eO_0                -7.693822e-01 1 1  ON 20
 eO_1                -4.483039e-01 1 1  ON 21
 eO_2                -2.570682e-02 1 1  ON 22
 eO_3                 2.984779e-01 1 1  ON 23
 eO_4                 5.314425e-01 1 1  ON 24
 eO_5                 4.913964e-01 1 1  ON 25
 eO_6                 2.576719e-01 1 1  ON 26
 eO_7                -4.677186e-02 1 1  ON 27
 eO_8                -2.136933e-01 1 1  ON 28
 eO_9                -7.486393e-02 1 1  ON 29
eH1_0                -2.363096e-01 1 1  ON 30
eH1_1                -1.382291e-01 1 1  ON 31
eH1_2                -9.370057e-02 1 1  ON 32
eH1_3                -3.894518e-02 1 1  ON 33
eH1_4                 5.525143e-03 1 1  ON 34
eH1_5                 3.931870e-02 1 1  ON 35
eH1_6                 9.469881e-02 1 1  ON 36
eH1_7                 1.480148e-01 1 1  ON 37
eH1_8                 1.673106e-01 1 1  ON 38
eH1_9                 5.521354e-02 1 1  ON 39
eH2_0                -2.329015e-01 1 1  ON 40
eH2_1                -1.350690e-01 1 1  ON 41
eH2_2                -9.051451e-02 1 1  ON 42
eH2_3                -3.559854e-02 1 1  ON 43
eH2_4                 8.546989e-03 1 1  ON 44
eH2_5                 4.204375e-02 1 1  ON 45
eH2_6                 9.791262e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724318e-01 1 1  ON 48
eH2_9                 3.953994e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2155e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9036
    reference variance = 0.204631
====================================================
  Execution time = 4.4284e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4790e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2624e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347930093862
                                         uncertainty =       0.006748011570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347930093862
                                         uncertainty =       0.006748011570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417074915
  error estimate for blocks of size 2^( 2) =       0.000429644661
  error estimate for blocks of size 2^( 3) =       0.000442603385
  error estimate for blocks of size 2^( 4) =       0.000454900021
  error estimate for blocks of size 2^( 5) =       0.000464611966
  error estimate for blocks of size 2^( 6) =       0.000473369923
  error estimate for blocks of size 2^( 7) =       0.000479249338

      target function =                  N/A
              le_mean =     -16.923545483235
             les_mean =     286.754294519149
             stat err =       0.000468032812
             autocorr =       1.259286250858
              std dev =       0.589833001761
             le_variance =       0.347902969966


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692354548324e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923545483235       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923545593568       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923545617877       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923545639944       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923545682327       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923545689533       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923545701959       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923545699458       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 6.340074e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923545483235       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923545511196       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923545517321       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923545522821       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923545532991       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923545534122       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923545537032       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923545536409       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 1.589772e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923545483235       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923545490249       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923545491784       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923545493158       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923545495668       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923545495907       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923545496621       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923545496464       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 3.977413e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.237806 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6918e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.098647e-01 1 1  ON 0
 uu_1                 1.438344e-01 1 1  ON 1
 uu_2                 4.315332e-02 1 1  ON 2
 uu_3                -1.911117e-02 1 1  ON 3
 uu_4                -6.427151e-02 1 1  ON 4
 uu_5                -9.778557e-02 1 1  ON 5
 uu_6                -1.245395e-01 1 1  ON 6
 uu_7                -1.382514e-01 1 1  ON 7
 uu_8                -1.321490e-01 1 1  ON 8
 uu_9                -1.022643e-01 1 1  ON 9
 ud_0                 4.381007e-01 1 1  ON 10
 ud_1                 1.722212e-01 1 1  ON 11
 ud_2                 5.294513e-02 1 1  ON 12
 ud_3                -1.597674e-02 1 1  ON 13
 ud_4                -6.969935e-02 1 1  ON 14
 ud_5                -1.062714e-01 1 1  ON 15
 ud_6                -1.288497e-01 1 1  ON 16
 ud_7                -1.417006e-01 1 1  ON 17
 ud_8                -1.400942e-01 1 1  ON 18
 ud_9                -1.324256e-01 1 1  ON 19
 eO_0                -7.693896e-01 1 1  ON 20
 eO_1                -4.483071e-01 1 1  ON 21
 eO_2                -2.571502e-02 1 1  ON 22
 eO_3                 2.984716e-01 1 1  ON 23
 eO_4                 5.314436e-01 1 1  ON 24
 eO_5                 4.914102e-01 1 1  ON 25
 eO_6                 2.576878e-01 1 1  ON 26
 eO_7                -4.676603e-02 1 1  ON 27
 eO_8                -2.136992e-01 1 1  ON 28
 eO_9                -7.486887e-02 1 1  ON 29
eH1_0                -2.363111e-01 1 1  ON 30
eH1_1                -1.382282e-01 1 1  ON 31
eH1_2                -9.370114e-02 1 1  ON 32
eH1_3                -3.894426e-02 1 1  ON 33
eH1_4                 5.520153e-03 1 1  ON 34
eH1_5                 3.931455e-02 1 1  ON 35
eH1_6                 9.469040e-02 1 1  ON 36
eH1_7                 1.480170e-01 1 1  ON 37
eH1_8                 1.673177e-01 1 1  ON 38
eH1_9                 5.522147e-02 1 1  ON 39
eH2_0                -2.329046e-01 1 1  ON 40
eH2_1                -1.350718e-01 1 1  ON 41
eH2_2                -9.051580e-02 1 1  ON 42
eH2_3                -3.559656e-02 1 1  ON 43
eH2_4                 8.544797e-03 1 1  ON 44
eH2_5                 4.204561e-02 1 1  ON 45
eH2_6                 9.790893e-02 1 1  ON 46
eH2_7                 1.512194e-01 1 1  ON 47
eH2_8                 1.724357e-01 1 1  ON 48
eH2_9                 3.954797e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8311
    reference variance = 0.210489
====================================================
  Execution time = 4.3285e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.4435e-01
  Total weights = 2.0000e+06
  Execution time = 4.0786e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344453029467
                                         uncertainty =       0.004187391265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344453029467
                                         uncertainty =       0.004187391265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414941805
  error estimate for blocks of size 2^( 2) =       0.000427499985
  error estimate for blocks of size 2^( 3) =       0.000440622601
  error estimate for blocks of size 2^( 4) =       0.000452065149
  error estimate for blocks of size 2^( 5) =       0.000462641996
  error estimate for blocks of size 2^( 6) =       0.000470547545
  error estimate for blocks of size 2^( 7) =       0.000475376623

      target function =                  N/A
              le_mean =     -16.922736435664
             les_mean =     286.723361701572
             stat err =       0.000465157828
             autocorr =       1.256684577281
              std dev =       0.586816328007
             le_variance =       0.344353402815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344453821950
                                         uncertainty =       0.004187332726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344453821950
                                         uncertainty =       0.004187332726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414942290
  error estimate for blocks of size 2^( 2) =       0.000427500352
  error estimate for blocks of size 2^( 3) =       0.000440622823
  error estimate for blocks of size 2^( 4) =       0.000452064964
  error estimate for blocks of size 2^( 5) =       0.000462641445
  error estimate for blocks of size 2^( 6) =       0.000470546588
  error estimate for blocks of size 2^( 7) =       0.000475374069

      target function =                  N/A
              le_mean =     -16.922736410119
             les_mean =     286.723361642994
             stat err =       0.000465156767
             autocorr =       1.256675898968
              std dev =       0.586817014766
             le_variance =       0.344354208819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344453637489
                                         uncertainty =       0.004187361319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344453637489
                                         uncertainty =       0.004187361319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414942175
  error estimate for blocks of size 2^( 2) =       0.000427500287
  error estimate for blocks of size 2^( 3) =       0.000440622818
  error estimate for blocks of size 2^( 4) =       0.000452065149
  error estimate for blocks of size 2^( 5) =       0.000462641811
  error estimate for blocks of size 2^( 6) =       0.000470547156
  error estimate for blocks of size 2^( 7) =       0.000475375407

      target function =                  N/A
              le_mean =     -16.922736422035
             les_mean =     286.723361855304
             stat err =       0.000465157381
             autocorr =       1.256679916216
              std dev =       0.586816852026
             le_variance =       0.344354017822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344453112219
                                         uncertainty =       0.004187387499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344453112219
                                         uncertainty =       0.004187387499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414941855
  error estimate for blocks of size 2^( 2) =       0.000427500027
  error estimate for blocks of size 2^( 3) =       0.000440622632
  error estimate for blocks of size 2^( 4) =       0.000452065152
  error estimate for blocks of size 2^( 5) =       0.000462641975
  error estimate for blocks of size 2^( 6) =       0.000470547499
  error estimate for blocks of size 2^( 7) =       0.000475376473

      target function =                  N/A
              le_mean =     -16.922736433846
             les_mean =     286.723361723682
             stat err =       0.000465157775
             autocorr =       1.256683983421
              std dev =       0.586816399266
             le_variance =       0.344353486448


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.922736435664        initial  <--
     5.9605e+00     5.9605e+01             6.3401e-05       -16.922736410119
     2.3842e+01     2.3842e+02             1.5898e-05       -16.922736422035
     9.5367e+01     9.5367e+02             3.9774e-06       -16.922736433846

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.9018
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.098611e-01 1 1  ON 0
 uu_1                 1.438296e-01 1 1  ON 1
 uu_2                 4.315324e-02 1 1  ON 2
 uu_3                -1.911051e-02 1 1  ON 3
 uu_4                -6.427501e-02 1 1  ON 4
 uu_5                -9.778283e-02 1 1  ON 5
 uu_6                -1.245348e-01 1 1  ON 6
 uu_7                -1.382478e-01 1 1  ON 7
 uu_8                -1.321485e-01 1 1  ON 8
 uu_9                -1.022597e-01 1 1  ON 9
 ud_0                 4.381091e-01 1 1  ON 10
 ud_1                 1.722257e-01 1 1  ON 11
 ud_2                 5.295282e-02 1 1  ON 12
 ud_3                -1.597773e-02 1 1  ON 13
 ud_4                -6.969699e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288504e-01 1 1  ON 16
 ud_7                -1.417079e-01 1 1  ON 17
 ud_8                -1.400993e-01 1 1  ON 18
 ud_9                -1.324304e-01 1 1  ON 19
 eO_0                -7.693822e-01 1 1  ON 20
 eO_1                -4.483039e-01 1 1  ON 21
 eO_2                -2.570682e-02 1 1  ON 22
 eO_3                 2.984779e-01 1 1  ON 23
 eO_4                 5.314425e-01 1 1  ON 24
 eO_5                 4.913964e-01 1 1  ON 25
 eO_6                 2.576719e-01 1 1  ON 26
 eO_7                -4.677186e-02 1 1  ON 27
 eO_8                -2.136933e-01 1 1  ON 28
 eO_9                -7.486393e-02 1 1  ON 29
eH1_0                -2.363096e-01 1 1  ON 30
eH1_1                -1.382291e-01 1 1  ON 31
eH1_2                -9.370057e-02 1 1  ON 32
eH1_3                -3.894518e-02 1 1  ON 33
eH1_4                 5.525143e-03 1 1  ON 34
eH1_5                 3.931870e-02 1 1  ON 35
eH1_6                 9.469881e-02 1 1  ON 36
eH1_7                 1.480148e-01 1 1  ON 37
eH1_8                 1.673106e-01 1 1  ON 38
eH1_9                 5.521354e-02 1 1  ON 39
eH2_0                -2.329015e-01 1 1  ON 40
eH2_1                -1.350690e-01 1 1  ON 41
eH2_2                -9.051451e-02 1 1  ON 42
eH2_3                -3.559854e-02 1 1  ON 43
eH2_4                 8.546989e-03 1 1  ON 44
eH2_5                 4.204375e-02 1 1  ON 45
eH2_6                 9.791262e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724318e-01 1 1  ON 48
eH2_9                 3.953994e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2083e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.0016
    reference variance = 0.811036
====================================================
  Execution time = 4.4648e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.4248e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2375e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342371753218
                                         uncertainty =       0.005573982481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342371753218
                                         uncertainty =       0.005573982481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413811619
  error estimate for blocks of size 2^( 2) =       0.000426145281
  error estimate for blocks of size 2^( 3) =       0.000438536988
  error estimate for blocks of size 2^( 4) =       0.000448998678
  error estimate for blocks of size 2^( 5) =       0.000458910297
  error estimate for blocks of size 2^( 6) =       0.000464553222
  error estimate for blocks of size 2^( 7) =       0.000466723888

      target function =                  N/A
              le_mean =     -16.923436562465
             les_mean =     286.745185024352
             stat err =       0.000459796521
             autocorr =       1.234599228069
              std dev =       0.585218003655
             le_variance =       0.342480111802


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692343656247e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923436562465       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923436548251       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923436542016       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923436538411       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923436537402       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923436548962       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923436549433       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923436549058       residual = 6.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 5.667173e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923436562465       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923436558908       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923436557343       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923436556432       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923436556172       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923436559068       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923436559181       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923436559090       residual = 6.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.417002e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923436562465       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923436561576       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923436561184       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923436560956       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923436560890       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923436561615       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923436561643       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923436561622       residual = 6.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 3.542636e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.241966 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9940e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.098613e-01 1 1  ON 0
 uu_1                 1.438300e-01 1 1  ON 1
 uu_2                 4.315352e-02 1 1  ON 2
 uu_3                -1.911042e-02 1 1  ON 3
 uu_4                -6.427470e-02 1 1  ON 4
 uu_5                -9.778314e-02 1 1  ON 5
 uu_6                -1.245342e-01 1 1  ON 6
 uu_7                -1.382479e-01 1 1  ON 7
 uu_8                -1.321492e-01 1 1  ON 8
 uu_9                -1.022605e-01 1 1  ON 9
 ud_0                 4.381086e-01 1 1  ON 10
 ud_1                 1.722256e-01 1 1  ON 11
 ud_2                 5.295294e-02 1 1  ON 12
 ud_3                -1.597810e-02 1 1  ON 13
 ud_4                -6.969719e-02 1 1  ON 14
 ud_5                -1.062711e-01 1 1  ON 15
 ud_6                -1.288497e-01 1 1  ON 16
 ud_7                -1.417073e-01 1 1  ON 17
 ud_8                -1.400995e-01 1 1  ON 18
 ud_9                -1.324304e-01 1 1  ON 19
 eO_0                -7.693832e-01 1 1  ON 20
 eO_1                -4.483049e-01 1 1  ON 21
 eO_2                -2.570725e-02 1 1  ON 22
 eO_3                 2.984781e-01 1 1  ON 23
 eO_4                 5.314437e-01 1 1  ON 24
 eO_5                 4.913978e-01 1 1  ON 25
 eO_6                 2.576731e-01 1 1  ON 26
 eO_7                -4.677169e-02 1 1  ON 27
 eO_8                -2.136941e-01 1 1  ON 28
 eO_9                -7.486456e-02 1 1  ON 29
eH1_0                -2.363096e-01 1 1  ON 30
eH1_1                -1.382291e-01 1 1  ON 31
eH1_2                -9.370032e-02 1 1  ON 32
eH1_3                -3.894552e-02 1 1  ON 33
eH1_4                 5.524893e-03 1 1  ON 34
eH1_5                 3.931859e-02 1 1  ON 35
eH1_6                 9.469860e-02 1 1  ON 36
eH1_7                 1.480144e-01 1 1  ON 37
eH1_8                 1.673110e-01 1 1  ON 38
eH1_9                 5.521416e-02 1 1  ON 39
eH2_0                -2.329012e-01 1 1  ON 40
eH2_1                -1.350692e-01 1 1  ON 41
eH2_2                -9.051414e-02 1 1  ON 42
eH2_3                -3.559853e-02 1 1  ON 43
eH2_4                 8.546718e-03 1 1  ON 44
eH2_5                 4.204363e-02 1 1  ON 45
eH2_6                 9.791152e-02 1 1  ON 46
eH2_7                 1.512227e-01 1 1  ON 47
eH2_8                 1.724323e-01 1 1  ON 48
eH2_9                 3.954077e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9495
    reference variance = 0.239055
====================================================
  Execution time = 4.3686e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.9427e-01
  Total weights = 2.0000e+06
  Execution time = 4.0637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.394407659989
                                         uncertainty =       0.038737556699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.394407659989
                                         uncertainty =       0.038737556699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000443998819
  error estimate for blocks of size 2^( 2) =       0.000455850817
  error estimate for blocks of size 2^( 3) =       0.000467688446
  error estimate for blocks of size 2^( 4) =       0.000478442506
  error estimate for blocks of size 2^( 5) =       0.000486793186
  error estimate for blocks of size 2^( 6) =       0.000493629665
  error estimate for blocks of size 2^( 7) =       0.000498977275

      target function =                  N/A
              le_mean =     -16.924126025769
             les_mean =     286.820311442128
             stat err =       0.000489460658
             autocorr =       1.215267681882
              std dev =       0.627909151992
             le_variance =       0.394269903156

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.394405094622
                                         uncertainty =       0.038737372204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.394405094622
                                         uncertainty =       0.038737372204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000443997375
  error estimate for blocks of size 2^( 2) =       0.000455849440
  error estimate for blocks of size 2^( 3) =       0.000467687092
  error estimate for blocks of size 2^( 4) =       0.000478441179
  error estimate for blocks of size 2^( 5) =       0.000486791893
  error estimate for blocks of size 2^( 6) =       0.000493628350
  error estimate for blocks of size 2^( 7) =       0.000498976001

      target function =                  N/A
              le_mean =     -16.924126020405
             les_mean =     286.820308695444
             stat err =       0.000489459356
             autocorr =       1.215269122282
              std dev =       0.627907109405
             le_variance =       0.394267338041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.394406369013
                                         uncertainty =       0.038737463697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.394406369013
                                         uncertainty =       0.038737463697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000443998093
  error estimate for blocks of size 2^( 2) =       0.000455850124
  error estimate for blocks of size 2^( 3) =       0.000467687764
  error estimate for blocks of size 2^( 4) =       0.000478441838
  error estimate for blocks of size 2^( 5) =       0.000486792536
  error estimate for blocks of size 2^( 6) =       0.000493629003
  error estimate for blocks of size 2^( 7) =       0.000498976634

      target function =                  N/A
              le_mean =     -16.924126023095
             les_mean =     286.820310060768
             stat err =       0.000489460003
             autocorr =       1.215268407968
              std dev =       0.627908124097
             le_variance =       0.394268612307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.394407498352
                                         uncertainty =       0.038737545050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.394407498352
                                         uncertainty =       0.038737545050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000443998728
  error estimate for blocks of size 2^( 2) =       0.000455850731
  error estimate for blocks of size 2^( 3) =       0.000467688361
  error estimate for blocks of size 2^( 4) =       0.000478442422
  error estimate for blocks of size 2^( 5) =       0.000486793105
  error estimate for blocks of size 2^( 6) =       0.000493629582
  error estimate for blocks of size 2^( 7) =       0.000498977194

      target function =                  N/A
              le_mean =     -16.924126025434
             les_mean =     286.820311269178
             stat err =       0.000489460576
             autocorr =       1.215267772835
              std dev =       0.627909023295
             le_variance =       0.394269741535


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924126025769        initial  <--
     5.9605e+01     5.9605e+02             5.6672e-06       -16.924126020405
     2.3842e+02     2.3842e+03             1.4170e-06       -16.924126023095
     9.5367e+02     9.5367e+03             3.5426e-07       -16.924126025434

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.1891
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.098611e-01 1 1  ON 0
 uu_1                 1.438296e-01 1 1  ON 1
 uu_2                 4.315324e-02 1 1  ON 2
 uu_3                -1.911051e-02 1 1  ON 3
 uu_4                -6.427501e-02 1 1  ON 4
 uu_5                -9.778283e-02 1 1  ON 5
 uu_6                -1.245348e-01 1 1  ON 6
 uu_7                -1.382478e-01 1 1  ON 7
 uu_8                -1.321485e-01 1 1  ON 8
 uu_9                -1.022597e-01 1 1  ON 9
 ud_0                 4.381091e-01 1 1  ON 10
 ud_1                 1.722257e-01 1 1  ON 11
 ud_2                 5.295282e-02 1 1  ON 12
 ud_3                -1.597773e-02 1 1  ON 13
 ud_4                -6.969699e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288504e-01 1 1  ON 16
 ud_7                -1.417079e-01 1 1  ON 17
 ud_8                -1.400993e-01 1 1  ON 18
 ud_9                -1.324304e-01 1 1  ON 19
 eO_0                -7.693822e-01 1 1  ON 20
 eO_1                -4.483039e-01 1 1  ON 21
 eO_2                -2.570682e-02 1 1  ON 22
 eO_3                 2.984779e-01 1 1  ON 23
 eO_4                 5.314425e-01 1 1  ON 24
 eO_5                 4.913964e-01 1 1  ON 25
 eO_6                 2.576719e-01 1 1  ON 26
 eO_7                -4.677186e-02 1 1  ON 27
 eO_8                -2.136933e-01 1 1  ON 28
 eO_9                -7.486393e-02 1 1  ON 29
eH1_0                -2.363096e-01 1 1  ON 30
eH1_1                -1.382291e-01 1 1  ON 31
eH1_2                -9.370057e-02 1 1  ON 32
eH1_3                -3.894518e-02 1 1  ON 33
eH1_4                 5.525143e-03 1 1  ON 34
eH1_5                 3.931870e-02 1 1  ON 35
eH1_6                 9.469881e-02 1 1  ON 36
eH1_7                 1.480148e-01 1 1  ON 37
eH1_8                 1.673106e-01 1 1  ON 38
eH1_9                 5.521354e-02 1 1  ON 39
eH2_0                -2.329015e-01 1 1  ON 40
eH2_1                -1.350690e-01 1 1  ON 41
eH2_2                -9.051451e-02 1 1  ON 42
eH2_3                -3.559854e-02 1 1  ON 43
eH2_4                 8.546989e-03 1 1  ON 44
eH2_5                 4.204375e-02 1 1  ON 45
eH2_6                 9.791262e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724318e-01 1 1  ON 48
eH2_9                 3.953994e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2416e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9808
    reference variance = 0.246398
====================================================
  Execution time = 4.4196e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3468e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2014e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334796163082
                                         uncertainty =       0.002779760446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334796163082
                                         uncertainty =       0.002779760446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409075215
  error estimate for blocks of size 2^( 2) =       0.000421649991
  error estimate for blocks of size 2^( 3) =       0.000434538008
  error estimate for blocks of size 2^( 4) =       0.000446232880
  error estimate for blocks of size 2^( 5) =       0.000456051258
  error estimate for blocks of size 2^( 6) =       0.000464070290
  error estimate for blocks of size 2^( 7) =       0.000469018185

      target function =                  N/A
              le_mean =     -16.922947152593
             les_mean =     286.720825224935
             stat err =       0.000458843153
             autocorr =       1.258120320055
              std dev =       0.578519716894
             le_variance =       0.334685062835


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692294715259e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922947152593       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922947153636       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922947154655       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922947153750       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922947153279       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922947153563       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922947154055       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922947153903       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 5.183552e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922947152593       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922947152854       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922947153108       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922947152881       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922947152763       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922947152835       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922947152958       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922947152920       residual = 5.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.295906e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922947152593       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922947152658       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922947152722       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922947152665       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922947152637       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922947152648       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922947152691       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922947152658       residual = 5.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 3.239777e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.246404 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6222e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.098612e-01 1 1  ON 0
 uu_1                 1.438297e-01 1 1  ON 1
 uu_2                 4.315325e-02 1 1  ON 2
 uu_3                -1.911047e-02 1 1  ON 3
 uu_4                -6.427500e-02 1 1  ON 4
 uu_5                -9.778284e-02 1 1  ON 5
 uu_6                -1.245348e-01 1 1  ON 6
 uu_7                -1.382478e-01 1 1  ON 7
 uu_8                -1.321485e-01 1 1  ON 8
 uu_9                -1.022598e-01 1 1  ON 9
 ud_0                 4.381091e-01 1 1  ON 10
 ud_1                 1.722257e-01 1 1  ON 11
 ud_2                 5.295275e-02 1 1  ON 12
 ud_3                -1.597774e-02 1 1  ON 13
 ud_4                -6.969699e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288504e-01 1 1  ON 16
 ud_7                -1.417079e-01 1 1  ON 17
 ud_8                -1.400993e-01 1 1  ON 18
 ud_9                -1.324304e-01 1 1  ON 19
 eO_0                -7.693823e-01 1 1  ON 20
 eO_1                -4.483039e-01 1 1  ON 21
 eO_2                -2.570692e-02 1 1  ON 22
 eO_3                 2.984779e-01 1 1  ON 23
 eO_4                 5.314426e-01 1 1  ON 24
 eO_5                 4.913965e-01 1 1  ON 25
 eO_6                 2.576720e-01 1 1  ON 26
 eO_7                -4.677180e-02 1 1  ON 27
 eO_8                -2.136934e-01 1 1  ON 28
 eO_9                -7.486398e-02 1 1  ON 29
eH1_0                -2.363096e-01 1 1  ON 30
eH1_1                -1.382291e-01 1 1  ON 31
eH1_2                -9.370059e-02 1 1  ON 32
eH1_3                -3.894512e-02 1 1  ON 33
eH1_4                 5.525097e-03 1 1  ON 34
eH1_5                 3.931867e-02 1 1  ON 35
eH1_6                 9.469878e-02 1 1  ON 36
eH1_7                 1.480148e-01 1 1  ON 37
eH1_8                 1.673106e-01 1 1  ON 38
eH1_9                 5.521360e-02 1 1  ON 39
eH2_0                -2.329015e-01 1 1  ON 40
eH2_1                -1.350691e-01 1 1  ON 41
eH2_2                -9.051447e-02 1 1  ON 42
eH2_3                -3.559851e-02 1 1  ON 43
eH2_4                 8.546966e-03 1 1  ON 44
eH2_5                 4.204373e-02 1 1  ON 45
eH2_6                 9.791253e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724319e-01 1 1  ON 48
eH2_9                 3.954002e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9202
    reference variance = 0.39331
====================================================
  Execution time = 4.3790e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3745e-01
  Total weights = 2.0000e+06
  Execution time = 4.4490e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337477940750
                                         uncertainty =       0.004318448625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337477940750
                                         uncertainty =       0.004318448625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410763073
  error estimate for blocks of size 2^( 2) =       0.000423279729
  error estimate for blocks of size 2^( 3) =       0.000436719359
  error estimate for blocks of size 2^( 4) =       0.000449108913
  error estimate for blocks of size 2^( 5) =       0.000459414121
  error estimate for blocks of size 2^( 6) =       0.000466965272
  error estimate for blocks of size 2^( 7) =       0.000472389445

      target function =                  N/A
              le_mean =     -16.923925110164
             les_mean =     286.756693569602
             stat err =       0.000461969438
             autocorr =       1.264863621744
              std dev =       0.580906708423
             le_variance =       0.337452603890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337477996070
                                         uncertainty =       0.004318446734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337477996070
                                         uncertainty =       0.004318446734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410763107
  error estimate for blocks of size 2^( 2) =       0.000423279758
  error estimate for blocks of size 2^( 3) =       0.000436719381
  error estimate for blocks of size 2^( 4) =       0.000449108933
  error estimate for blocks of size 2^( 5) =       0.000459414132
  error estimate for blocks of size 2^( 6) =       0.000466965279
  error estimate for blocks of size 2^( 7) =       0.000472389446

      target function =                  N/A
              le_mean =     -16.923925111385
             les_mean =     286.756693666400
             stat err =       0.000461969447
             autocorr =       1.264863466915
              std dev =       0.580906756154
             le_variance =       0.337452659345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337477968427
                                         uncertainty =       0.004318447678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337477968427
                                         uncertainty =       0.004318447678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410763090
  error estimate for blocks of size 2^( 2) =       0.000423279743
  error estimate for blocks of size 2^( 3) =       0.000436719370
  error estimate for blocks of size 2^( 4) =       0.000449108923
  error estimate for blocks of size 2^( 5) =       0.000459414126
  error estimate for blocks of size 2^( 6) =       0.000466965275
  error estimate for blocks of size 2^( 7) =       0.000472389446

      target function =                  N/A
              le_mean =     -16.923925110775
             les_mean =     286.756693618028
             stat err =       0.000461969443
             autocorr =       1.264863544291
              std dev =       0.580906732303
             le_variance =       0.337452631635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337477944210
                                         uncertainty =       0.004318448506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337477944210
                                         uncertainty =       0.004318448506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410763075
  error estimate for blocks of size 2^( 2) =       0.000423279731
  error estimate for blocks of size 2^( 3) =       0.000436719360
  error estimate for blocks of size 2^( 4) =       0.000449108914
  error estimate for blocks of size 2^( 5) =       0.000459414121
  error estimate for blocks of size 2^( 6) =       0.000466965272
  error estimate for blocks of size 2^( 7) =       0.000472389445

      target function =                  N/A
              le_mean =     -16.923925110240
             les_mean =     286.756693575656
             stat err =       0.000461969438
             autocorr =       1.264863612058
              std dev =       0.580906711408
             le_variance =       0.337452607359


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923925110164        initial
     5.9605e+02     5.9605e+03             5.1836e-07       -16.923925111385  <--
     2.3842e+03     2.3842e+04             1.2959e-07       -16.923925110775
     9.5367e+03     9.5367e+04             3.2398e-08       -16.923925110240

*****************************************************************************
Applying the update for shift_i =   5.9605e+02     and shift_s =   5.9605e+03
*****************************************************************************

  Execution time = 6.6563e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.098613e-01 1 1  ON 0
 uu_1                 1.438298e-01 1 1  ON 1
 uu_2                 4.315327e-02 1 1  ON 2
 uu_3                -1.911036e-02 1 1  ON 3
 uu_4                -6.427498e-02 1 1  ON 4
 uu_5                -9.778289e-02 1 1  ON 5
 uu_6                -1.245347e-01 1 1  ON 6
 uu_7                -1.382478e-01 1 1  ON 7
 uu_8                -1.321487e-01 1 1  ON 8
 uu_9                -1.022600e-01 1 1  ON 9
 ud_0                 4.381089e-01 1 1  ON 10
 ud_1                 1.722256e-01 1 1  ON 11
 ud_2                 5.295255e-02 1 1  ON 12
 ud_3                -1.597776e-02 1 1  ON 13
 ud_4                -6.969702e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288502e-01 1 1  ON 16
 ud_7                -1.417076e-01 1 1  ON 17
 ud_8                -1.400993e-01 1 1  ON 18
 ud_9                -1.324303e-01 1 1  ON 19
 eO_0                -7.693825e-01 1 1  ON 20
 eO_1                -4.483039e-01 1 1  ON 21
 eO_2                -2.570720e-02 1 1  ON 22
 eO_3                 2.984778e-01 1 1  ON 23
 eO_4                 5.314428e-01 1 1  ON 24
 eO_5                 4.913968e-01 1 1  ON 25
 eO_6                 2.576724e-01 1 1  ON 26
 eO_7                -4.677160e-02 1 1  ON 27
 eO_8                -2.136937e-01 1 1  ON 28
 eO_9                -7.486415e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382293e-01 1 1  ON 31
eH1_2                -9.370064e-02 1 1  ON 32
eH1_3                -3.894494e-02 1 1  ON 33
eH1_4                 5.524961e-03 1 1  ON 34
eH1_5                 3.931856e-02 1 1  ON 35
eH1_6                 9.469868e-02 1 1  ON 36
eH1_7                 1.480147e-01 1 1  ON 37
eH1_8                 1.673107e-01 1 1  ON 38
eH1_9                 5.521377e-02 1 1  ON 39
eH2_0                -2.329016e-01 1 1  ON 40
eH2_1                -1.350693e-01 1 1  ON 41
eH2_2                -9.051435e-02 1 1  ON 42
eH2_3                -3.559844e-02 1 1  ON 43
eH2_4                 8.546896e-03 1 1  ON 44
eH2_5                 4.204365e-02 1 1  ON 45
eH2_6                 9.791225e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724320e-01 1 1  ON 48
eH2_9                 3.954025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2279e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9447
    reference variance = 0.264774
====================================================
  Execution time = 4.4118e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4288e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1950e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342927453508
                                         uncertainty =       0.007138133737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342927453508
                                         uncertainty =       0.007138133737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414054673
  error estimate for blocks of size 2^( 2) =       0.000426706342
  error estimate for blocks of size 2^( 3) =       0.000439226859
  error estimate for blocks of size 2^( 4) =       0.000451255612
  error estimate for blocks of size 2^( 5) =       0.000461258731
  error estimate for blocks of size 2^( 6) =       0.000470360723
  error estimate for blocks of size 2^( 7) =       0.000475513544

      target function =                  N/A
              le_mean =     -16.923560376766
             les_mean =     286.749778199441
             stat err =       0.000464597152
             autocorr =       1.259034717319
              std dev =       0.585561734435
             le_variance =       0.342882544834


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692356037677e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923560376766       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923560384867       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923560387785       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923560389729       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923560390198       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923560390227       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923560391030       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923560390746       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 2.122793e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923560376766       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923560378792       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923560379522       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923560380009       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923560380127       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923560380135       residual = 5.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923560380334       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923560380262       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 5.307156e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923560376766       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923560377273       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923560377455       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923560377577       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923560377606       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923560377608       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923560377658       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923560377639       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.326800e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251134 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6080e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.098611e-01 1 1  ON 0
 uu_1                 1.438300e-01 1 1  ON 1
 uu_2                 4.315344e-02 1 1  ON 2
 uu_3                -1.911032e-02 1 1  ON 3
 uu_4                -6.427500e-02 1 1  ON 4
 uu_5                -9.778283e-02 1 1  ON 5
 uu_6                -1.245347e-01 1 1  ON 6
 uu_7                -1.382480e-01 1 1  ON 7
 uu_8                -1.321489e-01 1 1  ON 8
 uu_9                -1.022602e-01 1 1  ON 9
 ud_0                 4.381087e-01 1 1  ON 10
 ud_1                 1.722256e-01 1 1  ON 11
 ud_2                 5.295248e-02 1 1  ON 12
 ud_3                -1.597790e-02 1 1  ON 13
 ud_4                -6.969712e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288503e-01 1 1  ON 16
 ud_7                -1.417074e-01 1 1  ON 17
 ud_8                -1.400991e-01 1 1  ON 18
 ud_9                -1.324301e-01 1 1  ON 19
 eO_0                -7.693829e-01 1 1  ON 20
 eO_1                -4.483042e-01 1 1  ON 21
 eO_2                -2.570744e-02 1 1  ON 22
 eO_3                 2.984777e-01 1 1  ON 23
 eO_4                 5.314431e-01 1 1  ON 24
 eO_5                 4.913974e-01 1 1  ON 25
 eO_6                 2.576729e-01 1 1  ON 26
 eO_7                -4.677138e-02 1 1  ON 27
 eO_8                -2.136939e-01 1 1  ON 28
 eO_9                -7.486441e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382295e-01 1 1  ON 31
eH1_2                -9.370093e-02 1 1  ON 32
eH1_3                -3.894485e-02 1 1  ON 33
eH1_4                 5.524854e-03 1 1  ON 34
eH1_5                 3.931845e-02 1 1  ON 35
eH1_6                 9.469862e-02 1 1  ON 36
eH1_7                 1.480149e-01 1 1  ON 37
eH1_8                 1.673110e-01 1 1  ON 38
eH1_9                 5.521407e-02 1 1  ON 39
eH2_0                -2.329017e-01 1 1  ON 40
eH2_1                -1.350693e-01 1 1  ON 41
eH2_2                -9.051430e-02 1 1  ON 42
eH2_3                -3.559860e-02 1 1  ON 43
eH2_4                 8.547073e-03 1 1  ON 44
eH2_5                 4.204345e-02 1 1  ON 45
eH2_6                 9.791221e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724321e-01 1 1  ON 48
eH2_9                 3.954054e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.975
    reference variance = 0.276781
====================================================
  Execution time = 4.3223e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4549e-01
  Total weights = 2.0000e+06
  Execution time = 4.0576e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345450144337
                                         uncertainty =       0.006030360526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345450144337
                                         uncertainty =       0.006030360526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415625088
  error estimate for blocks of size 2^( 2) =       0.000428032306
  error estimate for blocks of size 2^( 3) =       0.000440914668
  error estimate for blocks of size 2^( 4) =       0.000452644537
  error estimate for blocks of size 2^( 5) =       0.000463196029
  error estimate for blocks of size 2^( 6) =       0.000470857928
  error estimate for blocks of size 2^( 7) =       0.000474577796

      target function =                  N/A
              le_mean =     -16.923776172965
             les_mean =     286.759688207514
             stat err =       0.000465319073
             autocorr =       1.253424554945
              std dev =       0.587782636392
             le_variance =       0.345488427644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345449505007
                                         uncertainty =       0.006030368480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345449505007
                                         uncertainty =       0.006030368480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415624703
  error estimate for blocks of size 2^( 2) =       0.000428031940
  error estimate for blocks of size 2^( 3) =       0.000440914307
  error estimate for blocks of size 2^( 4) =       0.000452644171
  error estimate for blocks of size 2^( 5) =       0.000463195656
  error estimate for blocks of size 2^( 6) =       0.000470857562
  error estimate for blocks of size 2^( 7) =       0.000474577431

      target function =                  N/A
              le_mean =     -16.923776172868
             les_mean =     286.759687564743
             stat err =       0.000465318705
             autocorr =       1.253424894710
              std dev =       0.587782092399
             le_variance =       0.345487788145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345449823805
                                         uncertainty =       0.006030364507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345449823805
                                         uncertainty =       0.006030364507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415624895
  error estimate for blocks of size 2^( 2) =       0.000428032123
  error estimate for blocks of size 2^( 3) =       0.000440914487
  error estimate for blocks of size 2^( 4) =       0.000452644353
  error estimate for blocks of size 2^( 5) =       0.000463195842
  error estimate for blocks of size 2^( 6) =       0.000470857745
  error estimate for blocks of size 2^( 7) =       0.000474577613

      target function =                  N/A
              le_mean =     -16.923776172917
             les_mean =     286.759687885260
             stat err =       0.000465318888
             autocorr =       1.253424725487
              std dev =       0.587782363658
             le_variance =       0.345488107027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345450104243
                                         uncertainty =       0.006030361024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345450104243
                                         uncertainty =       0.006030361024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415625064
  error estimate for blocks of size 2^( 2) =       0.000428032283
  error estimate for blocks of size 2^( 3) =       0.000440914646
  error estimate for blocks of size 2^( 4) =       0.000452644514
  error estimate for blocks of size 2^( 5) =       0.000463196006
  error estimate for blocks of size 2^( 6) =       0.000470857906
  error estimate for blocks of size 2^( 7) =       0.000474577773

      target function =                  N/A
              le_mean =     -16.923776172959
             les_mean =     286.759688167201
             stat err =       0.000465319050
             autocorr =       1.253424576284
              std dev =       0.587782602276
             le_variance =       0.345488387539


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923776172965        initial  <--
     1.4901e+02     1.4901e+03             2.1228e-06       -16.923776172868
     5.9605e+02     5.9605e+03             5.3072e-07       -16.923776172917
     2.3842e+03     2.3842e+04             1.3268e-07       -16.923776172959

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 67.4661
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.098613e-01 1 1  ON 0
 uu_1                 1.438298e-01 1 1  ON 1
 uu_2                 4.315327e-02 1 1  ON 2
 uu_3                -1.911036e-02 1 1  ON 3
 uu_4                -6.427498e-02 1 1  ON 4
 uu_5                -9.778289e-02 1 1  ON 5
 uu_6                -1.245347e-01 1 1  ON 6
 uu_7                -1.382478e-01 1 1  ON 7
 uu_8                -1.321487e-01 1 1  ON 8
 uu_9                -1.022600e-01 1 1  ON 9
 ud_0                 4.381089e-01 1 1  ON 10
 ud_1                 1.722256e-01 1 1  ON 11
 ud_2                 5.295255e-02 1 1  ON 12
 ud_3                -1.597776e-02 1 1  ON 13
 ud_4                -6.969702e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288502e-01 1 1  ON 16
 ud_7                -1.417076e-01 1 1  ON 17
 ud_8                -1.400993e-01 1 1  ON 18
 ud_9                -1.324303e-01 1 1  ON 19
 eO_0                -7.693825e-01 1 1  ON 20
 eO_1                -4.483039e-01 1 1  ON 21
 eO_2                -2.570720e-02 1 1  ON 22
 eO_3                 2.984778e-01 1 1  ON 23
 eO_4                 5.314428e-01 1 1  ON 24
 eO_5                 4.913968e-01 1 1  ON 25
 eO_6                 2.576724e-01 1 1  ON 26
 eO_7                -4.677160e-02 1 1  ON 27
 eO_8                -2.136937e-01 1 1  ON 28
 eO_9                -7.486415e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382293e-01 1 1  ON 31
eH1_2                -9.370064e-02 1 1  ON 32
eH1_3                -3.894494e-02 1 1  ON 33
eH1_4                 5.524961e-03 1 1  ON 34
eH1_5                 3.931856e-02 1 1  ON 35
eH1_6                 9.469868e-02 1 1  ON 36
eH1_7                 1.480147e-01 1 1  ON 37
eH1_8                 1.673107e-01 1 1  ON 38
eH1_9                 5.521377e-02 1 1  ON 39
eH2_0                -2.329016e-01 1 1  ON 40
eH2_1                -1.350693e-01 1 1  ON 41
eH2_2                -9.051435e-02 1 1  ON 42
eH2_3                -3.559844e-02 1 1  ON 43
eH2_4                 8.546896e-03 1 1  ON 44
eH2_5                 4.204365e-02 1 1  ON 45
eH2_6                 9.791225e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724320e-01 1 1  ON 48
eH2_9                 3.954025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2355e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9601
    reference variance = 0.202898
====================================================
  Execution time = 4.4374e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3885e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2010e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338974517481
                                         uncertainty =       0.004075133983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338974517481
                                         uncertainty =       0.004075133983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411610974
  error estimate for blocks of size 2^( 2) =       0.000424208056
  error estimate for blocks of size 2^( 3) =       0.000437087556
  error estimate for blocks of size 2^( 4) =       0.000448900144
  error estimate for blocks of size 2^( 5) =       0.000459386186
  error estimate for blocks of size 2^( 6) =       0.000468418579
  error estimate for blocks of size 2^( 7) =       0.000473634138

      target function =                  N/A
              le_mean =     -16.923622610931
             les_mean =     286.747849295854
             stat err =       0.000462584762
             autocorr =       1.263015716225
              std dev =       0.582105822054
             le_variance =       0.338847188069


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692362261093e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923622610931       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923622611131       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923622611403       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923622612523       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923622612152       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923622612198       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923622612250       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923622612232       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 2.272499e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923622610931       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923622610981       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923622611049       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923622611329       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923622611235       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923622611257       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923622611261       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923622611251       residual = 4.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 5.681276e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923622610931       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923622610943       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923622610960       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923622611029       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923622611002       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923622611003       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923622611039       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923622611024       residual = 4.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 1.420321e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.255619 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6409e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.098613e-01 1 1  ON 0
 uu_1                 1.438298e-01 1 1  ON 1
 uu_2                 4.315328e-02 1 1  ON 2
 uu_3                -1.911035e-02 1 1  ON 3
 uu_4                -6.427497e-02 1 1  ON 4
 uu_5                -9.778291e-02 1 1  ON 5
 uu_6                -1.245347e-01 1 1  ON 6
 uu_7                -1.382478e-01 1 1  ON 7
 uu_8                -1.321488e-01 1 1  ON 8
 uu_9                -1.022601e-01 1 1  ON 9
 ud_0                 4.381089e-01 1 1  ON 10
 ud_1                 1.722256e-01 1 1  ON 11
 ud_2                 5.295254e-02 1 1  ON 12
 ud_3                -1.597778e-02 1 1  ON 13
 ud_4                -6.969702e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288502e-01 1 1  ON 16
 ud_7                -1.417076e-01 1 1  ON 17
 ud_8                -1.400993e-01 1 1  ON 18
 ud_9                -1.324303e-01 1 1  ON 19
 eO_0                -7.693826e-01 1 1  ON 20
 eO_1                -4.483039e-01 1 1  ON 21
 eO_2                -2.570723e-02 1 1  ON 22
 eO_3                 2.984778e-01 1 1  ON 23
 eO_4                 5.314428e-01 1 1  ON 24
 eO_5                 4.913969e-01 1 1  ON 25
 eO_6                 2.576725e-01 1 1  ON 26
 eO_7                -4.677158e-02 1 1  ON 27
 eO_8                -2.136937e-01 1 1  ON 28
 eO_9                -7.486418e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382293e-01 1 1  ON 31
eH1_2                -9.370063e-02 1 1  ON 32
eH1_3                -3.894493e-02 1 1  ON 33
eH1_4                 5.524945e-03 1 1  ON 34
eH1_5                 3.931852e-02 1 1  ON 35
eH1_6                 9.469866e-02 1 1  ON 36
eH1_7                 1.480148e-01 1 1  ON 37
eH1_8                 1.673107e-01 1 1  ON 38
eH1_9                 5.521379e-02 1 1  ON 39
eH2_0                -2.329016e-01 1 1  ON 40
eH2_1                -1.350692e-01 1 1  ON 41
eH2_2                -9.051436e-02 1 1  ON 42
eH2_3                -3.559843e-02 1 1  ON 43
eH2_4                 8.546876e-03 1 1  ON 44
eH2_5                 4.204364e-02 1 1  ON 45
eH2_6                 9.791223e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724320e-01 1 1  ON 48
eH2_9                 3.954028e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.0135
    reference variance = 0.347901
====================================================
  Execution time = 4.3185e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.4164e-01
  Total weights = 2.0000e+06
  Execution time = 4.0633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341518485837
                                         uncertainty =       0.005420856033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341518485837
                                         uncertainty =       0.005420856033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413305758
  error estimate for blocks of size 2^( 2) =       0.000426139509
  error estimate for blocks of size 2^( 3) =       0.000438758936
  error estimate for blocks of size 2^( 4) =       0.000451599649
  error estimate for blocks of size 2^( 5) =       0.000461907483
  error estimate for blocks of size 2^( 6) =       0.000468115907
  error estimate for blocks of size 2^( 7) =       0.000472966800

      target function =                  N/A
              le_mean =     -16.923326736952
             les_mean =     286.740630973622
             stat err =       0.000463647460
             autocorr =       1.258440997000
              std dev =       0.584502608045
             le_variance =       0.341643298811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341518494057
                                         uncertainty =       0.005420855688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341518494057
                                         uncertainty =       0.005420855688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413305763
  error estimate for blocks of size 2^( 2) =       0.000426139513
  error estimate for blocks of size 2^( 3) =       0.000438758939
  error estimate for blocks of size 2^( 4) =       0.000451599650
  error estimate for blocks of size 2^( 5) =       0.000461907482
  error estimate for blocks of size 2^( 6) =       0.000468115904
  error estimate for blocks of size 2^( 7) =       0.000472966795

      target function =                  N/A
              le_mean =     -16.923326736266
             les_mean =     286.740630958627
             stat err =       0.000463647458
             autocorr =       1.258440956936
              std dev =       0.584502615067
             le_variance =       0.341643307021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341518489948
                                         uncertainty =       0.005420855860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341518489948
                                         uncertainty =       0.005420855860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413305760
  error estimate for blocks of size 2^( 2) =       0.000426139511
  error estimate for blocks of size 2^( 3) =       0.000438758938
  error estimate for blocks of size 2^( 4) =       0.000451599649
  error estimate for blocks of size 2^( 5) =       0.000461907482
  error estimate for blocks of size 2^( 6) =       0.000468115906
  error estimate for blocks of size 2^( 7) =       0.000472966797

      target function =                  N/A
              le_mean =     -16.923326736609
             les_mean =     286.740630966122
             stat err =       0.000463647459
             autocorr =       1.258440976963
              std dev =       0.584502611556
             le_variance =       0.341643302916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341518486351
                                         uncertainty =       0.005420856011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341518486351
                                         uncertainty =       0.005420856011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413305758
  error estimate for blocks of size 2^( 2) =       0.000426139509
  error estimate for blocks of size 2^( 3) =       0.000438758936
  error estimate for blocks of size 2^( 4) =       0.000451599649
  error estimate for blocks of size 2^( 5) =       0.000461907483
  error estimate for blocks of size 2^( 6) =       0.000468115907
  error estimate for blocks of size 2^( 7) =       0.000472966799

      target function =                  N/A
              le_mean =     -16.923326736909
             les_mean =     286.740630972684
             stat err =       0.000463647459
             autocorr =       1.258440994493
              std dev =       0.584502608484
             le_variance =       0.341643299324


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923326736952        initial  <--
     1.4901e+03     1.4901e+04             2.2725e-07       -16.923326736266
     5.9605e+03     5.9605e+04             5.6813e-08       -16.923326736609
     2.3842e+04     2.3842e+05             1.4203e-08       -16.923326736909

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.7517
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.098613e-01 1 1  ON 0
 uu_1                 1.438298e-01 1 1  ON 1
 uu_2                 4.315327e-02 1 1  ON 2
 uu_3                -1.911036e-02 1 1  ON 3
 uu_4                -6.427498e-02 1 1  ON 4
 uu_5                -9.778289e-02 1 1  ON 5
 uu_6                -1.245347e-01 1 1  ON 6
 uu_7                -1.382478e-01 1 1  ON 7
 uu_8                -1.321487e-01 1 1  ON 8
 uu_9                -1.022600e-01 1 1  ON 9
 ud_0                 4.381089e-01 1 1  ON 10
 ud_1                 1.722256e-01 1 1  ON 11
 ud_2                 5.295255e-02 1 1  ON 12
 ud_3                -1.597776e-02 1 1  ON 13
 ud_4                -6.969702e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288502e-01 1 1  ON 16
 ud_7                -1.417076e-01 1 1  ON 17
 ud_8                -1.400993e-01 1 1  ON 18
 ud_9                -1.324303e-01 1 1  ON 19
 eO_0                -7.693825e-01 1 1  ON 20
 eO_1                -4.483039e-01 1 1  ON 21
 eO_2                -2.570720e-02 1 1  ON 22
 eO_3                 2.984778e-01 1 1  ON 23
 eO_4                 5.314428e-01 1 1  ON 24
 eO_5                 4.913968e-01 1 1  ON 25
 eO_6                 2.576724e-01 1 1  ON 26
 eO_7                -4.677160e-02 1 1  ON 27
 eO_8                -2.136937e-01 1 1  ON 28
 eO_9                -7.486415e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382293e-01 1 1  ON 31
eH1_2                -9.370064e-02 1 1  ON 32
eH1_3                -3.894494e-02 1 1  ON 33
eH1_4                 5.524961e-03 1 1  ON 34
eH1_5                 3.931856e-02 1 1  ON 35
eH1_6                 9.469868e-02 1 1  ON 36
eH1_7                 1.480147e-01 1 1  ON 37
eH1_8                 1.673107e-01 1 1  ON 38
eH1_9                 5.521377e-02 1 1  ON 39
eH2_0                -2.329016e-01 1 1  ON 40
eH2_1                -1.350693e-01 1 1  ON 41
eH2_2                -9.051435e-02 1 1  ON 42
eH2_3                -3.559844e-02 1 1  ON 43
eH2_4                 8.546896e-03 1 1  ON 44
eH2_5                 4.204365e-02 1 1  ON 45
eH2_6                 9.791225e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724320e-01 1 1  ON 48
eH2_9                 3.954025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2019e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8291
    reference variance = 0.350512
====================================================
  Execution time = 4.7341e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3596e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1859e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335998870258
                                         uncertainty =       0.003183901602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335998870258
                                         uncertainty =       0.003183901602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409852760
  error estimate for blocks of size 2^( 2) =       0.000422112261
  error estimate for blocks of size 2^( 3) =       0.000434378089
  error estimate for blocks of size 2^( 4) =       0.000446432498
  error estimate for blocks of size 2^( 5) =       0.000457027635
  error estimate for blocks of size 2^( 6) =       0.000464696976
  error estimate for blocks of size 2^( 7) =       0.000470828421

      target function =                  N/A
              le_mean =     -16.923569368398
             les_mean =     286.743158568127
             stat err =       0.000459746383
             autocorr =       1.258290490231
              std dev =       0.579619331224
             le_variance =       0.335958569128


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692356936840e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923569368398       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923569368415       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923569368353       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923569368375       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923569368395       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923569368409       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923569368411       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923569368402       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 2.070181e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923569368398       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923569368402       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923569368387       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923569368358       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923569368396       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923569368393       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923569368415       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923569368382       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 5.175452e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923569368398       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923569368399       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923569368395       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923569368397       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923569368495       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923569368578       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923569368489       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923569368203       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 1.293863e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.259854 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9210e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.098613e-01 1 1  ON 0
 uu_1                 1.438298e-01 1 1  ON 1
 uu_2                 4.315327e-02 1 1  ON 2
 uu_3                -1.911036e-02 1 1  ON 3
 uu_4                -6.427498e-02 1 1  ON 4
 uu_5                -9.778289e-02 1 1  ON 5
 uu_6                -1.245347e-01 1 1  ON 6
 uu_7                -1.382478e-01 1 1  ON 7
 uu_8                -1.321487e-01 1 1  ON 8
 uu_9                -1.022600e-01 1 1  ON 9
 ud_0                 4.381089e-01 1 1  ON 10
 ud_1                 1.722256e-01 1 1  ON 11
 ud_2                 5.295255e-02 1 1  ON 12
 ud_3                -1.597776e-02 1 1  ON 13
 ud_4                -6.969702e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288502e-01 1 1  ON 16
 ud_7                -1.417076e-01 1 1  ON 17
 ud_8                -1.400993e-01 1 1  ON 18
 ud_9                -1.324303e-01 1 1  ON 19
 eO_0                -7.693825e-01 1 1  ON 20
 eO_1                -4.483039e-01 1 1  ON 21
 eO_2                -2.570720e-02 1 1  ON 22
 eO_3                 2.984778e-01 1 1  ON 23
 eO_4                 5.314428e-01 1 1  ON 24
 eO_5                 4.913968e-01 1 1  ON 25
 eO_6                 2.576724e-01 1 1  ON 26
 eO_7                -4.677160e-02 1 1  ON 27
 eO_8                -2.136937e-01 1 1  ON 28
 eO_9                -7.486416e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382293e-01 1 1  ON 31
eH1_2                -9.370064e-02 1 1  ON 32
eH1_3                -3.894494e-02 1 1  ON 33
eH1_4                 5.524961e-03 1 1  ON 34
eH1_5                 3.931855e-02 1 1  ON 35
eH1_6                 9.469868e-02 1 1  ON 36
eH1_7                 1.480147e-01 1 1  ON 37
eH1_8                 1.673107e-01 1 1  ON 38
eH1_9                 5.521377e-02 1 1  ON 39
eH2_0                -2.329016e-01 1 1  ON 40
eH2_1                -1.350693e-01 1 1  ON 41
eH2_2                -9.051435e-02 1 1  ON 42
eH2_3                -3.559844e-02 1 1  ON 43
eH2_4                 8.546897e-03 1 1  ON 44
eH2_5                 4.204365e-02 1 1  ON 45
eH2_6                 9.791225e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724320e-01 1 1  ON 48
eH2_9                 3.954025e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9864
    reference variance = 0.644636
====================================================
  Execution time = 4.3343e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3295e-01
  Total weights = 2.0000e+06
  Execution time = 4.0752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333008513441
                                         uncertainty =       0.002926299727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333008513441
                                         uncertainty =       0.002926299727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408011745
  error estimate for blocks of size 2^( 2) =       0.000421316466
  error estimate for blocks of size 2^( 3) =       0.000434745312
  error estimate for blocks of size 2^( 4) =       0.000447877367
  error estimate for blocks of size 2^( 5) =       0.000459643101
  error estimate for blocks of size 2^( 6) =       0.000468452341
  error estimate for blocks of size 2^( 7) =       0.000475085997

      target function =                  N/A
              le_mean =     -16.923018190582
             les_mean =     286.721491680440
             stat err =       0.000462764701
             autocorr =       1.286397297749
              std dev =       0.577015743423
             le_variance =       0.332947168158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333008504382
                                         uncertainty =       0.002926299661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333008504382
                                         uncertainty =       0.002926299661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408011739
  error estimate for blocks of size 2^( 2) =       0.000421316461
  error estimate for blocks of size 2^( 3) =       0.000434745307
  error estimate for blocks of size 2^( 4) =       0.000447877362
  error estimate for blocks of size 2^( 5) =       0.000459643096
  error estimate for blocks of size 2^( 6) =       0.000468452336
  error estimate for blocks of size 2^( 7) =       0.000475085992

      target function =                  N/A
              le_mean =     -16.923018190582
             les_mean =     286.721491671395
             stat err =       0.000462764696
             autocorr =       1.286397305082
              std dev =       0.577015735577
             le_variance =       0.332947159103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333008508911
                                         uncertainty =       0.002926299694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333008508911
                                         uncertainty =       0.002926299694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408011742
  error estimate for blocks of size 2^( 2) =       0.000421316463
  error estimate for blocks of size 2^( 3) =       0.000434745310
  error estimate for blocks of size 2^( 4) =       0.000447877364
  error estimate for blocks of size 2^( 5) =       0.000459643098
  error estimate for blocks of size 2^( 6) =       0.000468452338
  error estimate for blocks of size 2^( 7) =       0.000475085994

      target function =                  N/A
              le_mean =     -16.923018190582
             les_mean =     286.721491675917
             stat err =       0.000462764699
             autocorr =       1.286397301417
              std dev =       0.577015739500
             le_variance =       0.332947163630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333008512875
                                         uncertainty =       0.002926299723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333008512875
                                         uncertainty =       0.002926299723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408011745
  error estimate for blocks of size 2^( 2) =       0.000421316466
  error estimate for blocks of size 2^( 3) =       0.000434745312
  error estimate for blocks of size 2^( 4) =       0.000447877366
  error estimate for blocks of size 2^( 5) =       0.000459643100
  error estimate for blocks of size 2^( 6) =       0.000468452340
  error estimate for blocks of size 2^( 7) =       0.000475085997

      target function =                  N/A
              le_mean =     -16.923018190582
             les_mean =     286.721491679875
             stat err =       0.000462764701
             autocorr =       1.286397298207
              std dev =       0.577015742932
             le_variance =       0.332947167592


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923018190582        initial
     1.4901e+04     1.4901e+05             2.0702e-08       -16.923018190582  <--
     5.9605e+04     5.9605e+05             5.1755e-09       -16.923018190582
     2.3842e+05     2.3842e+06             1.2939e-09       -16.923018190582

*****************************************************************************
Applying the update for shift_i =   1.4901e+04     and shift_s =   1.4901e+05
*****************************************************************************

  Execution time = 6.3926e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.098613e-01 1 1  ON 0
 uu_1                 1.438298e-01 1 1  ON 1
 uu_2                 4.315327e-02 1 1  ON 2
 uu_3                -1.911036e-02 1 1  ON 3
 uu_4                -6.427498e-02 1 1  ON 4
 uu_5                -9.778290e-02 1 1  ON 5
 uu_6                -1.245347e-01 1 1  ON 6
 uu_7                -1.382478e-01 1 1  ON 7
 uu_8                -1.321487e-01 1 1  ON 8
 uu_9                -1.022600e-01 1 1  ON 9
 ud_0                 4.381089e-01 1 1  ON 10
 ud_1                 1.722256e-01 1 1  ON 11
 ud_2                 5.295255e-02 1 1  ON 12
 ud_3                -1.597777e-02 1 1  ON 13
 ud_4                -6.969702e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288502e-01 1 1  ON 16
 ud_7                -1.417076e-01 1 1  ON 17
 ud_8                -1.400993e-01 1 1  ON 18
 ud_9                -1.324303e-01 1 1  ON 19
 eO_0                -7.693825e-01 1 1  ON 20
 eO_1                -4.483039e-01 1 1  ON 21
 eO_2                -2.570721e-02 1 1  ON 22
 eO_3                 2.984778e-01 1 1  ON 23
 eO_4                 5.314428e-01 1 1  ON 24
 eO_5                 4.913969e-01 1 1  ON 25
 eO_6                 2.576724e-01 1 1  ON 26
 eO_7                -4.677159e-02 1 1  ON 27
 eO_8                -2.136937e-01 1 1  ON 28
 eO_9                -7.486416e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382293e-01 1 1  ON 31
eH1_2                -9.370065e-02 1 1  ON 32
eH1_3                -3.894493e-02 1 1  ON 33
eH1_4                 5.524962e-03 1 1  ON 34
eH1_5                 3.931855e-02 1 1  ON 35
eH1_6                 9.469868e-02 1 1  ON 36
eH1_7                 1.480148e-01 1 1  ON 37
eH1_8                 1.673107e-01 1 1  ON 38
eH1_9                 5.521377e-02 1 1  ON 39
eH2_0                -2.329016e-01 1 1  ON 40
eH2_1                -1.350693e-01 1 1  ON 41
eH2_2                -9.051435e-02 1 1  ON 42
eH2_3                -3.559844e-02 1 1  ON 43
eH2_4                 8.546901e-03 1 1  ON 44
eH2_5                 4.204365e-02 1 1  ON 45
eH2_6                 9.791224e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724320e-01 1 1  ON 48
eH2_9                 3.954026e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2314e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9702
    reference variance = 0.375779
====================================================
  Execution time = 4.7128e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3968e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1925e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339619530623
                                         uncertainty =       0.006375786265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339619530623
                                         uncertainty =       0.006375786265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412119613
  error estimate for blocks of size 2^( 2) =       0.000425332817
  error estimate for blocks of size 2^( 3) =       0.000438452955
  error estimate for blocks of size 2^( 4) =       0.000450653038
  error estimate for blocks of size 2^( 5) =       0.000460822879
  error estimate for blocks of size 2^( 6) =       0.000469078707
  error estimate for blocks of size 2^( 7) =       0.000478111234

      target function =                  N/A
              le_mean =     -16.922767079288
             les_mean =     286.719730600412
             stat err =       0.000464666465
             autocorr =       1.271265011309
              std dev =       0.582825145667
             le_variance =       0.339685150422


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692276707929e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922767079288       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922767079491       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922767079561       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922767079639       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922767079949       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922767080038       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922767080027       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922767080035       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 8.655620e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922767079288       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922767079339       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922767079356       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922767079377       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922767079456       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922767079468       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922767079468       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922767079474       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 2.163915e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922767079288       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922767079301       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922767079305       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922767079310       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922767079351       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922767079330       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922767079308       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922767079368       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 5.409792e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.264322 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9068e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.098613e-01 1 1  ON 0
 uu_1                 1.438298e-01 1 1  ON 1
 uu_2                 4.315328e-02 1 1  ON 2
 uu_3                -1.911036e-02 1 1  ON 3
 uu_4                -6.427498e-02 1 1  ON 4
 uu_5                -9.778290e-02 1 1  ON 5
 uu_6                -1.245348e-01 1 1  ON 6
 uu_7                -1.382478e-01 1 1  ON 7
 uu_8                -1.321487e-01 1 1  ON 8
 uu_9                -1.022601e-01 1 1  ON 9
 ud_0                 4.381089e-01 1 1  ON 10
 ud_1                 1.722256e-01 1 1  ON 11
 ud_2                 5.295254e-02 1 1  ON 12
 ud_3                -1.597777e-02 1 1  ON 13
 ud_4                -6.969702e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288502e-01 1 1  ON 16
 ud_7                -1.417076e-01 1 1  ON 17
 ud_8                -1.400993e-01 1 1  ON 18
 ud_9                -1.324303e-01 1 1  ON 19
 eO_0                -7.693825e-01 1 1  ON 20
 eO_1                -4.483039e-01 1 1  ON 21
 eO_2                -2.570722e-02 1 1  ON 22
 eO_3                 2.984778e-01 1 1  ON 23
 eO_4                 5.314428e-01 1 1  ON 24
 eO_5                 4.913969e-01 1 1  ON 25
 eO_6                 2.576725e-01 1 1  ON 26
 eO_7                -4.677158e-02 1 1  ON 27
 eO_8                -2.136937e-01 1 1  ON 28
 eO_9                -7.486417e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382293e-01 1 1  ON 31
eH1_2                -9.370066e-02 1 1  ON 32
eH1_3                -3.894492e-02 1 1  ON 33
eH1_4                 5.524950e-03 1 1  ON 34
eH1_5                 3.931853e-02 1 1  ON 35
eH1_6                 9.469868e-02 1 1  ON 36
eH1_7                 1.480148e-01 1 1  ON 37
eH1_8                 1.673107e-01 1 1  ON 38
eH1_9                 5.521378e-02 1 1  ON 39
eH2_0                -2.329016e-01 1 1  ON 40
eH2_1                -1.350692e-01 1 1  ON 41
eH2_2                -9.051434e-02 1 1  ON 42
eH2_3                -3.559845e-02 1 1  ON 43
eH2_4                 8.546905e-03 1 1  ON 44
eH2_5                 4.204364e-02 1 1  ON 45
eH2_6                 9.791223e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724320e-01 1 1  ON 48
eH2_9                 3.954027e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8505
    reference variance = 1.00702
====================================================
  Execution time = 4.3403e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3183e-01
  Total weights = 2.0000e+06
  Execution time = 4.0689e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331820386090
                                         uncertainty =       0.002810194940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331820386090
                                         uncertainty =       0.002810194940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407329036
  error estimate for blocks of size 2^( 2) =       0.000419968044
  error estimate for blocks of size 2^( 3) =       0.000432373886
  error estimate for blocks of size 2^( 4) =       0.000444227815
  error estimate for blocks of size 2^( 5) =       0.000453422781
  error estimate for blocks of size 2^( 6) =       0.000458762689
  error estimate for blocks of size 2^( 7) =       0.000461756994

      target function =                  N/A
              le_mean =     -16.923652047567
             les_mean =     286.741832348216
             stat err =       0.000454542570
             autocorr =       1.245255266755
              std dev =       0.576050246956
             le_variance =       0.331833887018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331820370613
                                         uncertainty =       0.002810194656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331820370613
                                         uncertainty =       0.002810194656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407329026
  error estimate for blocks of size 2^( 2) =       0.000419968035
  error estimate for blocks of size 2^( 3) =       0.000432373877
  error estimate for blocks of size 2^( 4) =       0.000444227807
  error estimate for blocks of size 2^( 5) =       0.000453422772
  error estimate for blocks of size 2^( 6) =       0.000458762680
  error estimate for blocks of size 2^( 7) =       0.000461756984

      target function =                  N/A
              le_mean =     -16.923652047632
             les_mean =     286.741832334948
             stat err =       0.000454542560
             autocorr =       1.245255273689
              std dev =       0.576050233514
             le_variance =       0.331833871531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331820378351
                                         uncertainty =       0.002810194798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331820378351
                                         uncertainty =       0.002810194798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407329031
  error estimate for blocks of size 2^( 2) =       0.000419968039
  error estimate for blocks of size 2^( 3) =       0.000432373882
  error estimate for blocks of size 2^( 4) =       0.000444227811
  error estimate for blocks of size 2^( 5) =       0.000453422776
  error estimate for blocks of size 2^( 6) =       0.000458762685
  error estimate for blocks of size 2^( 7) =       0.000461756989

      target function =                  N/A
              le_mean =     -16.923652047600
             les_mean =     286.741832341581
             stat err =       0.000454542565
             autocorr =       1.245255270215
              std dev =       0.576050240234
             le_variance =       0.331833879274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331820385123
                                         uncertainty =       0.002810194922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331820385123
                                         uncertainty =       0.002810194922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407329035
  error estimate for blocks of size 2^( 2) =       0.000419968043
  error estimate for blocks of size 2^( 3) =       0.000432373886
  error estimate for blocks of size 2^( 4) =       0.000444227815
  error estimate for blocks of size 2^( 5) =       0.000453422780
  error estimate for blocks of size 2^( 6) =       0.000458762689
  error estimate for blocks of size 2^( 7) =       0.000461756993

      target function =                  N/A
              le_mean =     -16.923652047571
             les_mean =     286.741832347386
             stat err =       0.000454542569
             autocorr =       1.245255267186
              std dev =       0.576050246116
             le_variance =       0.331833886050


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923652047567        initial
     3.7253e+03     3.7253e+04             8.6556e-08       -16.923652047632  <--
     1.4901e+04     1.4901e+05             2.1639e-08       -16.923652047600
     5.9605e+04     5.9605e+05             5.4098e-09       -16.923652047571

*****************************************************************************
Applying the update for shift_i =   3.7253e+03     and shift_s =   3.7253e+04
*****************************************************************************

  Execution time = 6.3898e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.098613e-01 1 1  ON 0
 uu_1                 1.438299e-01 1 1  ON 1
 uu_2                 4.315328e-02 1 1  ON 2
 uu_3                -1.911037e-02 1 1  ON 3
 uu_4                -6.427499e-02 1 1  ON 4
 uu_5                -9.778290e-02 1 1  ON 5
 uu_6                -1.245348e-01 1 1  ON 6
 uu_7                -1.382479e-01 1 1  ON 7
 uu_8                -1.321487e-01 1 1  ON 8
 uu_9                -1.022601e-01 1 1  ON 9
 ud_0                 4.381089e-01 1 1  ON 10
 ud_1                 1.722256e-01 1 1  ON 11
 ud_2                 5.295252e-02 1 1  ON 12
 ud_3                -1.597778e-02 1 1  ON 13
 ud_4                -6.969702e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288502e-01 1 1  ON 16
 ud_7                -1.417076e-01 1 1  ON 17
 ud_8                -1.400993e-01 1 1  ON 18
 ud_9                -1.324303e-01 1 1  ON 19
 eO_0                -7.693826e-01 1 1  ON 20
 eO_1                -4.483040e-01 1 1  ON 21
 eO_2                -2.570725e-02 1 1  ON 22
 eO_3                 2.984778e-01 1 1  ON 23
 eO_4                 5.314429e-01 1 1  ON 24
 eO_5                 4.913969e-01 1 1  ON 25
 eO_6                 2.576725e-01 1 1  ON 26
 eO_7                -4.677155e-02 1 1  ON 27
 eO_8                -2.136937e-01 1 1  ON 28
 eO_9                -7.486420e-02 1 1  ON 29
eH1_0                -2.363094e-01 1 1  ON 30
eH1_1                -1.382293e-01 1 1  ON 31
eH1_2                -9.370069e-02 1 1  ON 32
eH1_3                -3.894490e-02 1 1  ON 33
eH1_4                 5.524913e-03 1 1  ON 34
eH1_5                 3.931849e-02 1 1  ON 35
eH1_6                 9.469866e-02 1 1  ON 36
eH1_7                 1.480148e-01 1 1  ON 37
eH1_8                 1.673107e-01 1 1  ON 38
eH1_9                 5.521380e-02 1 1  ON 39
eH2_0                -2.329016e-01 1 1  ON 40
eH2_1                -1.350692e-01 1 1  ON 41
eH2_2                -9.051432e-02 1 1  ON 42
eH2_3                -3.559846e-02 1 1  ON 43
eH2_4                 8.546918e-03 1 1  ON 44
eH2_5                 4.204360e-02 1 1  ON 45
eH2_6                 9.791222e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724320e-01 1 1  ON 48
eH2_9                 3.954031e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2297e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6924e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9454
    reference variance = 0.382436
====================================================
  Execution time = 4.4384e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4096e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2255e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341059088997
                                         uncertainty =       0.008538565096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341059088997
                                         uncertainty =       0.008538565096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412894205
  error estimate for blocks of size 2^( 2) =       0.000425662070
  error estimate for blocks of size 2^( 3) =       0.000438597829
  error estimate for blocks of size 2^( 4) =       0.000450434577
  error estimate for blocks of size 2^( 5) =       0.000460159208
  error estimate for blocks of size 2^( 6) =       0.000467574492
  error estimate for blocks of size 2^( 7) =       0.000471926296

      target function =                  N/A
              le_mean =     -16.924030251084
             les_mean =     286.763763018546
             stat err =       0.000462523643
             autocorr =       1.254845622819
              std dev =       0.583920584862
             le_variance =       0.340963249426


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692403025108e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924030251084       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924030251800       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924030252255       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924030252192       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924030252004       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924030252296       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924030252555       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924030252620       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 3.618652e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924030251084       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924030251263       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924030251377       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924030251361       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924030251315       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924030251383       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924030251452       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924030251467       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 9.049229e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924030251084       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924030251129       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924030251157       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924030251153       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924030251142       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924030251157       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924030251172       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924030251178       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 2.262470e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.268761 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6650e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.098613e-01 1 1  ON 0
 uu_1                 1.438299e-01 1 1  ON 1
 uu_2                 4.315331e-02 1 1  ON 2
 uu_3                -1.911038e-02 1 1  ON 3
 uu_4                -6.427497e-02 1 1  ON 4
 uu_5                -9.778292e-02 1 1  ON 5
 uu_6                -1.245347e-01 1 1  ON 6
 uu_7                -1.382479e-01 1 1  ON 7
 uu_8                -1.321488e-01 1 1  ON 8
 uu_9                -1.022601e-01 1 1  ON 9
 ud_0                 4.381088e-01 1 1  ON 10
 ud_1                 1.722256e-01 1 1  ON 11
 ud_2                 5.295250e-02 1 1  ON 12
 ud_3                -1.597778e-02 1 1  ON 13
 ud_4                -6.969701e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288501e-01 1 1  ON 16
 ud_7                -1.417075e-01 1 1  ON 17
 ud_8                -1.400993e-01 1 1  ON 18
 ud_9                -1.324303e-01 1 1  ON 19
 eO_0                -7.693827e-01 1 1  ON 20
 eO_1                -4.483040e-01 1 1  ON 21
 eO_2                -2.570732e-02 1 1  ON 22
 eO_3                 2.984778e-01 1 1  ON 23
 eO_4                 5.314429e-01 1 1  ON 24
 eO_5                 4.913970e-01 1 1  ON 25
 eO_6                 2.576726e-01 1 1  ON 26
 eO_7                -4.677152e-02 1 1  ON 27
 eO_8                -2.136937e-01 1 1  ON 28
 eO_9                -7.486424e-02 1 1  ON 29
eH1_0                -2.363094e-01 1 1  ON 30
eH1_1                -1.382293e-01 1 1  ON 31
eH1_2                -9.370071e-02 1 1  ON 32
eH1_3                -3.894489e-02 1 1  ON 33
eH1_4                 5.524898e-03 1 1  ON 34
eH1_5                 3.931845e-02 1 1  ON 35
eH1_6                 9.469865e-02 1 1  ON 36
eH1_7                 1.480148e-01 1 1  ON 37
eH1_8                 1.673108e-01 1 1  ON 38
eH1_9                 5.521384e-02 1 1  ON 39
eH2_0                -2.329016e-01 1 1  ON 40
eH2_1                -1.350692e-01 1 1  ON 41
eH2_2                -9.051435e-02 1 1  ON 42
eH2_3                -3.559847e-02 1 1  ON 43
eH2_4                 8.546902e-03 1 1  ON 44
eH2_5                 4.204358e-02 1 1  ON 45
eH2_6                 9.791220e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724321e-01 1 1  ON 48
eH2_9                 3.954036e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9456
    reference variance = 0.189436
====================================================
  Execution time = 4.6194e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.5351e-01
  Total weights = 2.0000e+06
  Execution time = 4.0693e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353557924501
                                         uncertainty =       0.018011186713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353557924501
                                         uncertainty =       0.018011186713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420419940
  error estimate for blocks of size 2^( 2) =       0.000432801445
  error estimate for blocks of size 2^( 3) =       0.000444794958
  error estimate for blocks of size 2^( 4) =       0.000457263913
  error estimate for blocks of size 2^( 5) =       0.000467293996
  error estimate for blocks of size 2^( 6) =       0.000477168432
  error estimate for blocks of size 2^( 7) =       0.000481234726

      target function =                  N/A
              le_mean =     -16.923808322201
             les_mean =     286.768793802279
             stat err =       0.000470740267
             autocorr =       1.253707101595
              std dev =       0.594563581488
             le_variance =       0.353505852431

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353557705797
                                         uncertainty =       0.018011193328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353557705797
                                         uncertainty =       0.018011193328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420419810
  error estimate for blocks of size 2^( 2) =       0.000432801319
  error estimate for blocks of size 2^( 3) =       0.000444794838
  error estimate for blocks of size 2^( 4) =       0.000457263796
  error estimate for blocks of size 2^( 5) =       0.000467293878
  error estimate for blocks of size 2^( 6) =       0.000477168316
  error estimate for blocks of size 2^( 7) =       0.000481234613

      target function =                  N/A
              le_mean =     -16.923808322331
             les_mean =     286.768793587936
             stat err =       0.000470740151
             autocorr =       1.253707258431
              std dev =       0.594563397533
             le_variance =       0.353505633686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353557815101
                                         uncertainty =       0.018011190018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353557815101
                                         uncertainty =       0.018011190018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420419875
  error estimate for blocks of size 2^( 2) =       0.000432801382
  error estimate for blocks of size 2^( 3) =       0.000444794898
  error estimate for blocks of size 2^( 4) =       0.000457263855
  error estimate for blocks of size 2^( 5) =       0.000467293937
  error estimate for blocks of size 2^( 6) =       0.000477168374
  error estimate for blocks of size 2^( 7) =       0.000481234670

      target function =                  N/A
              le_mean =     -16.923808322266
             les_mean =     286.768793695057
             stat err =       0.000470740209
             autocorr =       1.253707180042
              std dev =       0.594563489470
             le_variance =       0.353505743011

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353557910824
                                         uncertainty =       0.018011187126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353557910824
                                         uncertainty =       0.018011187126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420419932
  error estimate for blocks of size 2^( 2) =       0.000432801437
  error estimate for blocks of size 2^( 3) =       0.000444794950
  error estimate for blocks of size 2^( 4) =       0.000457263906
  error estimate for blocks of size 2^( 5) =       0.000467293988
  error estimate for blocks of size 2^( 6) =       0.000477168425
  error estimate for blocks of size 2^( 7) =       0.000481234719

      target function =                  N/A
              le_mean =     -16.923808322209
             les_mean =     286.768793788875
             stat err =       0.000470740260
             autocorr =       1.253707111400
              std dev =       0.594563569984
             le_variance =       0.353505838752


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923808322201        initial
     9.3132e+02     9.3132e+03             3.6187e-07       -16.923808322331  <--
     3.7253e+03     3.7253e+04             9.0492e-08       -16.923808322266
     1.4901e+04     1.4901e+05             2.2625e-08       -16.923808322209

*****************************************************************************
Applying the update for shift_i =   9.3132e+02     and shift_s =   9.3132e+03
*****************************************************************************

  Execution time = 6.6740e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.098614e-01 1 1  ON 0
 uu_1                 1.438299e-01 1 1  ON 1
 uu_2                 4.315338e-02 1 1  ON 2
 uu_3                -1.911041e-02 1 1  ON 3
 uu_4                -6.427493e-02 1 1  ON 4
 uu_5                -9.778299e-02 1 1  ON 5
 uu_6                -1.245347e-01 1 1  ON 6
 uu_7                -1.382479e-01 1 1  ON 7
 uu_8                -1.321489e-01 1 1  ON 8
 uu_9                -1.022602e-01 1 1  ON 9
 ud_0                 4.381085e-01 1 1  ON 10
 ud_1                 1.722256e-01 1 1  ON 11
 ud_2                 5.295244e-02 1 1  ON 12
 ud_3                -1.597777e-02 1 1  ON 13
 ud_4                -6.969698e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288501e-01 1 1  ON 16
 ud_7                -1.417074e-01 1 1  ON 17
 ud_8                -1.400993e-01 1 1  ON 18
 ud_9                -1.324302e-01 1 1  ON 19
 eO_0                -7.693828e-01 1 1  ON 20
 eO_1                -4.483041e-01 1 1  ON 21
 eO_2                -2.570752e-02 1 1  ON 22
 eO_3                 2.984778e-01 1 1  ON 23
 eO_4                 5.314431e-01 1 1  ON 24
 eO_5                 4.913972e-01 1 1  ON 25
 eO_6                 2.576728e-01 1 1  ON 26
 eO_7                -4.677141e-02 1 1  ON 27
 eO_8                -2.136939e-01 1 1  ON 28
 eO_9                -7.486436e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382292e-01 1 1  ON 31
eH1_2                -9.370079e-02 1 1  ON 32
eH1_3                -3.894485e-02 1 1  ON 33
eH1_4                 5.524852e-03 1 1  ON 34
eH1_5                 3.931834e-02 1 1  ON 35
eH1_6                 9.469862e-02 1 1  ON 36
eH1_7                 1.480148e-01 1 1  ON 37
eH1_8                 1.673109e-01 1 1  ON 38
eH1_9                 5.521395e-02 1 1  ON 39
eH2_0                -2.329016e-01 1 1  ON 40
eH2_1                -1.350692e-01 1 1  ON 41
eH2_2                -9.051443e-02 1 1  ON 42
eH2_3                -3.559850e-02 1 1  ON 43
eH2_4                 8.546855e-03 1 1  ON 44
eH2_5                 4.204354e-02 1 1  ON 45
eH2_6                 9.791215e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724321e-01 1 1  ON 48
eH2_9                 3.954051e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2340e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8416
    reference variance = 0.187367
====================================================
  Execution time = 4.4126e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3111e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1941e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331167266421
                                         uncertainty =       0.002744616545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331167266421
                                         uncertainty =       0.002744616545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406883026
  error estimate for blocks of size 2^( 2) =       0.000419090080
  error estimate for blocks of size 2^( 3) =       0.000431938459
  error estimate for blocks of size 2^( 4) =       0.000443808586
  error estimate for blocks of size 2^( 5) =       0.000453911303
  error estimate for blocks of size 2^( 6) =       0.000461841512
  error estimate for blocks of size 2^( 7) =       0.000465945765

      target function =                  N/A
              le_mean =     -16.923816714305
             les_mean =     286.746679607263
             stat err =       0.000456376791
             autocorr =       1.258079125320
              std dev =       0.575419493451
             le_variance =       0.331107593443


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692381671430e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923816714305       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923816716576       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923816719083       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923816719209       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923816721780       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923816723543       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923816722729       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923816722855       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 1.307588e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923816714305       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923816714873       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923816715502       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923816715529       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923816716175       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923816716616       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923816716413       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923816716443       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 3.269078e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923816714305       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923816714447       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923816714604       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923816714610       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923816714772       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923816714883       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923816714831       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923816714840       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 8.172762e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.273270 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6078e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.098614e-01 1 1  ON 0
 uu_1                 1.438300e-01 1 1  ON 1
 uu_2                 4.315347e-02 1 1  ON 2
 uu_3                -1.911032e-02 1 1  ON 3
 uu_4                -6.427491e-02 1 1  ON 4
 uu_5                -9.778305e-02 1 1  ON 5
 uu_6                -1.245346e-01 1 1  ON 6
 uu_7                -1.382479e-01 1 1  ON 7
 uu_8                -1.321490e-01 1 1  ON 8
 uu_9                -1.022604e-01 1 1  ON 9
 ud_0                 4.381083e-01 1 1  ON 10
 ud_1                 1.722255e-01 1 1  ON 11
 ud_2                 5.295240e-02 1 1  ON 12
 ud_3                -1.597782e-02 1 1  ON 13
 ud_4                -6.969690e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288500e-01 1 1  ON 16
 ud_7                -1.417073e-01 1 1  ON 17
 ud_8                -1.400992e-01 1 1  ON 18
 ud_9                -1.324302e-01 1 1  ON 19
 eO_0                -7.693829e-01 1 1  ON 20
 eO_1                -4.483042e-01 1 1  ON 21
 eO_2                -2.570774e-02 1 1  ON 22
 eO_3                 2.984777e-01 1 1  ON 23
 eO_4                 5.314433e-01 1 1  ON 24
 eO_5                 4.913976e-01 1 1  ON 25
 eO_6                 2.576731e-01 1 1  ON 26
 eO_7                -4.677131e-02 1 1  ON 27
 eO_8                -2.136940e-01 1 1  ON 28
 eO_9                -7.486453e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382293e-01 1 1  ON 31
eH1_2                -9.370080e-02 1 1  ON 32
eH1_3                -3.894480e-02 1 1  ON 33
eH1_4                 5.524812e-03 1 1  ON 34
eH1_5                 3.931827e-02 1 1  ON 35
eH1_6                 9.469852e-02 1 1  ON 36
eH1_7                 1.480148e-01 1 1  ON 37
eH1_8                 1.673110e-01 1 1  ON 38
eH1_9                 5.521412e-02 1 1  ON 39
eH2_0                -2.329017e-01 1 1  ON 40
eH2_1                -1.350695e-01 1 1  ON 41
eH2_2                -9.051431e-02 1 1  ON 42
eH2_3                -3.559846e-02 1 1  ON 43
eH2_4                 8.546762e-03 1 1  ON 44
eH2_5                 4.204365e-02 1 1  ON 45
eH2_6                 9.791214e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724322e-01 1 1  ON 48
eH2_9                 3.954065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.955
    reference variance = 0.421534
====================================================
  Execution time = 4.6748e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3578e-01
  Total weights = 2.0000e+06
  Execution time = 4.0601e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335784336653
                                         uncertainty =       0.004087974509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335784336653
                                         uncertainty =       0.004087974509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409746177
  error estimate for blocks of size 2^( 2) =       0.000422929243
  error estimate for blocks of size 2^( 3) =       0.000436644113
  error estimate for blocks of size 2^( 4) =       0.000448707417
  error estimate for blocks of size 2^( 5) =       0.000460159680
  error estimate for blocks of size 2^( 6) =       0.000468907667
  error estimate for blocks of size 2^( 7) =       0.000473842086

      target function =                  N/A
              le_mean =     -16.922811457570
             les_mean =     286.717331319538
             stat err =       0.000462904212
             autocorr =       1.276299048139
              std dev =       0.579468600489
             le_variance =       0.335783858953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335783707095
                                         uncertainty =       0.004087962494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335783707095
                                         uncertainty =       0.004087962494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409745793
  error estimate for blocks of size 2^( 2) =       0.000422928877
  error estimate for blocks of size 2^( 3) =       0.000436643759
  error estimate for blocks of size 2^( 4) =       0.000448707076
  error estimate for blocks of size 2^( 5) =       0.000460159348
  error estimate for blocks of size 2^( 6) =       0.000468907334
  error estimate for blocks of size 2^( 7) =       0.000473841731

      target function =                  N/A
              le_mean =     -16.922811462642
             les_mean =     286.717330861544
             stat err =       0.000462903872
             autocorr =       1.276299565589
              std dev =       0.579468057185
             le_variance =       0.335783229298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335784021564
                                         uncertainty =       0.004087968494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335784021564
                                         uncertainty =       0.004087968494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409745985
  error estimate for blocks of size 2^( 2) =       0.000422929060
  error estimate for blocks of size 2^( 3) =       0.000436643936
  error estimate for blocks of size 2^( 4) =       0.000448707246
  error estimate for blocks of size 2^( 5) =       0.000460159514
  error estimate for blocks of size 2^( 6) =       0.000468907500
  error estimate for blocks of size 2^( 7) =       0.000473841909

      target function =                  N/A
              le_mean =     -16.922811460108
             les_mean =     286.717331090282
             stat err =       0.000462904042
             autocorr =       1.276299307168
              std dev =       0.579468328570
             le_variance =       0.335783543815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335784297257
                                         uncertainty =       0.004087973757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335784297257
                                         uncertainty =       0.004087973757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409746153
  error estimate for blocks of size 2^( 2) =       0.000422929220
  error estimate for blocks of size 2^( 3) =       0.000436644091
  error estimate for blocks of size 2^( 4) =       0.000448707395
  error estimate for blocks of size 2^( 5) =       0.000460159659
  error estimate for blocks of size 2^( 6) =       0.000468907646
  error estimate for blocks of size 2^( 7) =       0.000473842064

      target function =                  N/A
              le_mean =     -16.922811457888
             les_mean =     286.717331290870
             stat err =       0.000462904191
             autocorr =       1.276299080525
              std dev =       0.579468566491
             le_variance =       0.335783819551


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.922811457570        initial
     2.3283e+02     2.3283e+03             1.3076e-06       -16.922811462642  <--
     9.3132e+02     9.3132e+03             3.2691e-07       -16.922811460108
     3.7253e+03     3.7253e+04             8.1728e-08       -16.922811457888

*****************************************************************************
Applying the update for shift_i =   2.3283e+02     and shift_s =   2.3283e+03
*****************************************************************************

  Execution time = 6.7271e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.098615e-01 1 1  ON 0
 uu_1                 1.438304e-01 1 1  ON 1
 uu_2                 4.315376e-02 1 1  ON 2
 uu_3                -1.911006e-02 1 1  ON 3
 uu_4                -6.427487e-02 1 1  ON 4
 uu_5                -9.778324e-02 1 1  ON 5
 uu_6                -1.245345e-01 1 1  ON 6
 uu_7                -1.382479e-01 1 1  ON 7
 uu_8                -1.321494e-01 1 1  ON 8
 uu_9                -1.022610e-01 1 1  ON 9
 ud_0                 4.381078e-01 1 1  ON 10
 ud_1                 1.722253e-01 1 1  ON 11
 ud_2                 5.295228e-02 1 1  ON 12
 ud_3                -1.597799e-02 1 1  ON 13
 ud_4                -6.969666e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288496e-01 1 1  ON 16
 ud_7                -1.417069e-01 1 1  ON 17
 ud_8                -1.400989e-01 1 1  ON 18
 ud_9                -1.324301e-01 1 1  ON 19
 eO_0                -7.693832e-01 1 1  ON 20
 eO_1                -4.483044e-01 1 1  ON 21
 eO_2                -2.570842e-02 1 1  ON 22
 eO_3                 2.984774e-01 1 1  ON 23
 eO_4                 5.314438e-01 1 1  ON 24
 eO_5                 4.913985e-01 1 1  ON 25
 eO_6                 2.576740e-01 1 1  ON 26
 eO_7                -4.677101e-02 1 1  ON 27
 eO_8                -2.136946e-01 1 1  ON 28
 eO_9                -7.486503e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382296e-01 1 1  ON 31
eH1_2                -9.370082e-02 1 1  ON 32
eH1_3                -3.894466e-02 1 1  ON 33
eH1_4                 5.524690e-03 1 1  ON 34
eH1_5                 3.931805e-02 1 1  ON 35
eH1_6                 9.469824e-02 1 1  ON 36
eH1_7                 1.480147e-01 1 1  ON 37
eH1_8                 1.673113e-01 1 1  ON 38
eH1_9                 5.521463e-02 1 1  ON 39
eH2_0                -2.329019e-01 1 1  ON 40
eH2_1                -1.350703e-01 1 1  ON 41
eH2_2                -9.051396e-02 1 1  ON 42
eH2_3                -3.559834e-02 1 1  ON 43
eH2_4                 8.546484e-03 1 1  ON 44
eH2_5                 4.204399e-02 1 1  ON 45
eH2_6                 9.791210e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724325e-01 1 1  ON 48
eH2_9                 3.954105e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2336e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6924e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9056
    reference variance = 0.218504
====================================================
  Execution time = 4.3991e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3870e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1785e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338807561813
                                         uncertainty =       0.003230393684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338807561813
                                         uncertainty =       0.003230393684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411520795
  error estimate for blocks of size 2^( 2) =       0.000424297422
  error estimate for blocks of size 2^( 3) =       0.000437418985
  error estimate for blocks of size 2^( 4) =       0.000449033550
  error estimate for blocks of size 2^( 5) =       0.000459359518
  error estimate for blocks of size 2^( 6) =       0.000465627354
  error estimate for blocks of size 2^( 7) =       0.000469961890

      target function =                  N/A
              le_mean =     -16.923183865552
             les_mean =     286.732850707347
             stat err =       0.000460995578
             autocorr =       1.254902392442
              std dev =       0.581978289462
             le_variance =       0.338698729405


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692318386555e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923183865552       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923183865313       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923183879683       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923183888117       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923183890953       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923183895771       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923183894417       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923183895812       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 5.300697e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923183865552       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923183865492       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923183869088       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923183871210       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923183871915       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923183873117       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923183872779       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923183873128       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 1.327596e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923183865552       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923183865537       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923183866437       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923183866968       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923183867144       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923183867444       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923183867361       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923183867445       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 3.320512e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.278055 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.5787e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.098617e-01 1 1  ON 0
 uu_1                 1.438310e-01 1 1  ON 1
 uu_2                 4.315371e-02 1 1  ON 2
 uu_3                -1.911019e-02 1 1  ON 3
 uu_4                -6.427470e-02 1 1  ON 4
 uu_5                -9.778325e-02 1 1  ON 5
 uu_6                -1.245350e-01 1 1  ON 6
 uu_7                -1.382484e-01 1 1  ON 7
 uu_8                -1.321496e-01 1 1  ON 8
 uu_9                -1.022614e-01 1 1  ON 9
 ud_0                 4.381071e-01 1 1  ON 10
 ud_1                 1.722249e-01 1 1  ON 11
 ud_2                 5.295186e-02 1 1  ON 12
 ud_3                -1.597829e-02 1 1  ON 13
 ud_4                -6.969676e-02 1 1  ON 14
 ud_5                -1.062713e-01 1 1  ON 15
 ud_6                -1.288497e-01 1 1  ON 16
 ud_7                -1.417060e-01 1 1  ON 17
 ud_8                -1.400981e-01 1 1  ON 18
 ud_9                -1.324296e-01 1 1  ON 19
 eO_0                -7.693846e-01 1 1  ON 20
 eO_1                -4.483047e-01 1 1  ON 21
 eO_2                -2.570895e-02 1 1  ON 22
 eO_3                 2.984768e-01 1 1  ON 23
 eO_4                 5.314449e-01 1 1  ON 24
 eO_5                 4.913998e-01 1 1  ON 25
 eO_6                 2.576752e-01 1 1  ON 26
 eO_7                -4.677056e-02 1 1  ON 27
 eO_8                -2.136952e-01 1 1  ON 28
 eO_9                -7.486566e-02 1 1  ON 29
eH1_0                -2.363097e-01 1 1  ON 30
eH1_1                -1.382297e-01 1 1  ON 31
eH1_2                -9.370080e-02 1 1  ON 32
eH1_3                -3.894486e-02 1 1  ON 33
eH1_4                 5.524478e-03 1 1  ON 34
eH1_5                 3.931800e-02 1 1  ON 35
eH1_6                 9.469748e-02 1 1  ON 36
eH1_7                 1.480148e-01 1 1  ON 37
eH1_8                 1.673119e-01 1 1  ON 38
eH1_9                 5.521533e-02 1 1  ON 39
eH2_0                -2.329021e-01 1 1  ON 40
eH2_1                -1.350708e-01 1 1  ON 41
eH2_2                -9.051397e-02 1 1  ON 42
eH2_3                -3.559822e-02 1 1  ON 43
eH2_4                 8.546371e-03 1 1  ON 44
eH2_5                 4.204380e-02 1 1  ON 45
eH2_6                 9.791188e-02 1 1  ON 46
eH2_7                 1.512227e-01 1 1  ON 47
eH2_8                 1.724328e-01 1 1  ON 48
eH2_9                 3.954226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9375
    reference variance = 0.236758
====================================================
  Execution time = 4.3450e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3976e-01
  Total weights = 2.0000e+06
  Execution time = 4.0641e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339669829476
                                         uncertainty =       0.003388463945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339669829476
                                         uncertainty =       0.003388463945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412163711
  error estimate for blocks of size 2^( 2) =       0.000425087498
  error estimate for blocks of size 2^( 3) =       0.000438576122
  error estimate for blocks of size 2^( 4) =       0.000451151593
  error estimate for blocks of size 2^( 5) =       0.000462931199
  error estimate for blocks of size 2^( 6) =       0.000471386504
  error estimate for blocks of size 2^( 7) =       0.000478379794

      target function =                  N/A
              le_mean =     -16.923046785145
             les_mean =     286.729270170908
             stat err =       0.000465962272
             autocorr =       1.278091677683
              std dev =       0.582887509368
             le_variance =       0.339757848577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339669787543
                                         uncertainty =       0.003388472705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339669787543
                                         uncertainty =       0.003388472705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412163685
  error estimate for blocks of size 2^( 2) =       0.000425087476
  error estimate for blocks of size 2^( 3) =       0.000438576079
  error estimate for blocks of size 2^( 4) =       0.000451151519
  error estimate for blocks of size 2^( 5) =       0.000462931106
  error estimate for blocks of size 2^( 6) =       0.000471386360
  error estimate for blocks of size 2^( 7) =       0.000478379616

      target function =                  N/A
              le_mean =     -16.923046783041
             les_mean =     286.729270057507
             stat err =       0.000465962150
             autocorr =       1.278091165075
              std dev =       0.582887473195
             le_variance =       0.339757806408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339669808347
                                         uncertainty =       0.003388468350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339669808347
                                         uncertainty =       0.003388468350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412163698
  error estimate for blocks of size 2^( 2) =       0.000425087487
  error estimate for blocks of size 2^( 3) =       0.000438576101
  error estimate for blocks of size 2^( 4) =       0.000451151556
  error estimate for blocks of size 2^( 5) =       0.000462931152
  error estimate for blocks of size 2^( 6) =       0.000471386432
  error estimate for blocks of size 2^( 7) =       0.000478379705

      target function =                  N/A
              le_mean =     -16.923046784081
             les_mean =     286.729270113631
             stat err =       0.000465962211
             autocorr =       1.278091421589
              std dev =       0.582887491141
             le_variance =       0.339757827329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339669826826
                                         uncertainty =       0.003388464496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339669826826
                                         uncertainty =       0.003388464496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412163709
  error estimate for blocks of size 2^( 2) =       0.000425087497
  error estimate for blocks of size 2^( 3) =       0.000438576120
  error estimate for blocks of size 2^( 4) =       0.000451151588
  error estimate for blocks of size 2^( 5) =       0.000462931193
  error estimate for blocks of size 2^( 6) =       0.000471386495
  error estimate for blocks of size 2^( 7) =       0.000478379783

      target function =                  N/A
              le_mean =     -16.923046785011
             les_mean =     286.729270163699
             stat err =       0.000465962265
             autocorr =       1.278091645683
              std dev =       0.582887507082
             le_variance =       0.339757845912


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923046785145        initial  <--
     5.8208e+01     5.8208e+02             5.3007e-06       -16.923046783041
     2.3283e+02     2.3283e+03             1.3276e-06       -16.923046784081
     9.3132e+02     9.3132e+03             3.3205e-07       -16.923046785011

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.9439
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.098615e-01 1 1  ON 0
 uu_1                 1.438304e-01 1 1  ON 1
 uu_2                 4.315376e-02 1 1  ON 2
 uu_3                -1.911006e-02 1 1  ON 3
 uu_4                -6.427487e-02 1 1  ON 4
 uu_5                -9.778324e-02 1 1  ON 5
 uu_6                -1.245345e-01 1 1  ON 6
 uu_7                -1.382479e-01 1 1  ON 7
 uu_8                -1.321494e-01 1 1  ON 8
 uu_9                -1.022610e-01 1 1  ON 9
 ud_0                 4.381078e-01 1 1  ON 10
 ud_1                 1.722253e-01 1 1  ON 11
 ud_2                 5.295228e-02 1 1  ON 12
 ud_3                -1.597799e-02 1 1  ON 13
 ud_4                -6.969666e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288496e-01 1 1  ON 16
 ud_7                -1.417069e-01 1 1  ON 17
 ud_8                -1.400989e-01 1 1  ON 18
 ud_9                -1.324301e-01 1 1  ON 19
 eO_0                -7.693832e-01 1 1  ON 20
 eO_1                -4.483044e-01 1 1  ON 21
 eO_2                -2.570842e-02 1 1  ON 22
 eO_3                 2.984774e-01 1 1  ON 23
 eO_4                 5.314438e-01 1 1  ON 24
 eO_5                 4.913985e-01 1 1  ON 25
 eO_6                 2.576740e-01 1 1  ON 26
 eO_7                -4.677101e-02 1 1  ON 27
 eO_8                -2.136946e-01 1 1  ON 28
 eO_9                -7.486503e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382296e-01 1 1  ON 31
eH1_2                -9.370082e-02 1 1  ON 32
eH1_3                -3.894466e-02 1 1  ON 33
eH1_4                 5.524690e-03 1 1  ON 34
eH1_5                 3.931805e-02 1 1  ON 35
eH1_6                 9.469824e-02 1 1  ON 36
eH1_7                 1.480147e-01 1 1  ON 37
eH1_8                 1.673113e-01 1 1  ON 38
eH1_9                 5.521463e-02 1 1  ON 39
eH2_0                -2.329019e-01 1 1  ON 40
eH2_1                -1.350703e-01 1 1  ON 41
eH2_2                -9.051396e-02 1 1  ON 42
eH2_3                -3.559834e-02 1 1  ON 43
eH2_4                 8.546484e-03 1 1  ON 44
eH2_5                 4.204399e-02 1 1  ON 45
eH2_6                 9.791210e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724325e-01 1 1  ON 48
eH2_9                 3.954105e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1975e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6924e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.827
    reference variance = 0.486219
====================================================
  Execution time = 4.7333e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3651e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1792e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336382995334
                                         uncertainty =       0.002823908566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336382995334
                                         uncertainty =       0.002823908566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410189252
  error estimate for blocks of size 2^( 2) =       0.000422997171
  error estimate for blocks of size 2^( 3) =       0.000436307428
  error estimate for blocks of size 2^( 4) =       0.000448257894
  error estimate for blocks of size 2^( 5) =       0.000459444208
  error estimate for blocks of size 2^( 6) =       0.000468148285
  error estimate for blocks of size 2^( 7) =       0.000474142569

      target function =                  N/A
              le_mean =     -16.923487080556
             les_mean =     286.740925243112
             stat err =       0.000462498239
             autocorr =       1.271310438062
              std dev =       0.580095203923
             le_variance =       0.336510445614


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692348708056e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923487080556       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923487082242       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923487083603       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923487083290       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923487084228       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923487083899       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923487083667       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923487084022       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 5.464541e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923487080556       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923487080978       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923487081318       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923487081240       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923487081473       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923487081393       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923487081334       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923487081420       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 1.366157e-07

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923487080556       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923487080662       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923487080747       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923487080727       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923487080790       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923487080765       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923487080752       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923487080773       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 3.415405e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.282677 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9137e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.098615e-01 1 1  ON 0
 uu_1                 1.438304e-01 1 1  ON 1
 uu_2                 4.315377e-02 1 1  ON 2
 uu_3                -1.911008e-02 1 1  ON 3
 uu_4                -6.427489e-02 1 1  ON 4
 uu_5                -9.778322e-02 1 1  ON 5
 uu_6                -1.245345e-01 1 1  ON 6
 uu_7                -1.382479e-01 1 1  ON 7
 uu_8                -1.321494e-01 1 1  ON 8
 uu_9                -1.022610e-01 1 1  ON 9
 ud_0                 4.381077e-01 1 1  ON 10
 ud_1                 1.722253e-01 1 1  ON 11
 ud_2                 5.295224e-02 1 1  ON 12
 ud_3                -1.597800e-02 1 1  ON 13
 ud_4                -6.969667e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288496e-01 1 1  ON 16
 ud_7                -1.417069e-01 1 1  ON 17
 ud_8                -1.400989e-01 1 1  ON 18
 ud_9                -1.324301e-01 1 1  ON 19
 eO_0                -7.693833e-01 1 1  ON 20
 eO_1                -4.483045e-01 1 1  ON 21
 eO_2                -2.570845e-02 1 1  ON 22
 eO_3                 2.984773e-01 1 1  ON 23
 eO_4                 5.314439e-01 1 1  ON 24
 eO_5                 4.913987e-01 1 1  ON 25
 eO_6                 2.576741e-01 1 1  ON 26
 eO_7                -4.677095e-02 1 1  ON 27
 eO_8                -2.136946e-01 1 1  ON 28
 eO_9                -7.486510e-02 1 1  ON 29
eH1_0                -2.363096e-01 1 1  ON 30
eH1_1                -1.382297e-01 1 1  ON 31
eH1_2                -9.370081e-02 1 1  ON 32
eH1_3                -3.894464e-02 1 1  ON 33
eH1_4                 5.524670e-03 1 1  ON 34
eH1_5                 3.931800e-02 1 1  ON 35
eH1_6                 9.469821e-02 1 1  ON 36
eH1_7                 1.480147e-01 1 1  ON 37
eH1_8                 1.673114e-01 1 1  ON 38
eH1_9                 5.521470e-02 1 1  ON 39
eH2_0                -2.329019e-01 1 1  ON 40
eH2_1                -1.350703e-01 1 1  ON 41
eH2_2                -9.051394e-02 1 1  ON 42
eH2_3                -3.559834e-02 1 1  ON 43
eH2_4                 8.546474e-03 1 1  ON 44
eH2_5                 4.204397e-02 1 1  ON 45
eH2_6                 9.791208e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724325e-01 1 1  ON 48
eH2_9                 3.954113e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9212
    reference variance = 0.33826
====================================================
  Execution time = 4.3882e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3506e-01
  Total weights = 2.0000e+06
  Execution time = 4.0678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335021848120
                                         uncertainty =       0.003236768766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335021848120
                                         uncertainty =       0.003236768766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409301971
  error estimate for blocks of size 2^( 2) =       0.000422356298
  error estimate for blocks of size 2^( 3) =       0.000435401404
  error estimate for blocks of size 2^( 4) =       0.000448265494
  error estimate for blocks of size 2^( 5) =       0.000459824463
  error estimate for blocks of size 2^( 6) =       0.000468321435
  error estimate for blocks of size 2^( 7) =       0.000475921136

      target function =                  N/A
              le_mean =     -16.922638478787
             les_mean =     286.710749123493
             stat err =       0.000463083132
             autocorr =       1.280059778414
              std dev =       0.578840398816
             le_variance =       0.335056207302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335021781491
                                         uncertainty =       0.003236766857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335021781491
                                         uncertainty =       0.003236766857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409301931
  error estimate for blocks of size 2^( 2) =       0.000422356258
  error estimate for blocks of size 2^( 3) =       0.000435401365
  error estimate for blocks of size 2^( 4) =       0.000448265455
  error estimate for blocks of size 2^( 5) =       0.000459824421
  error estimate for blocks of size 2^( 6) =       0.000468321395
  error estimate for blocks of size 2^( 7) =       0.000475921096

      target function =                  N/A
              le_mean =     -16.922638477917
             les_mean =     286.710749027478
             stat err =       0.000463083092
             autocorr =       1.280059809321
              std dev =       0.578840341311
             le_variance =       0.335056140729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335021814779
                                         uncertainty =       0.003236767811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335021814779
                                         uncertainty =       0.003236767811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409301951
  error estimate for blocks of size 2^( 2) =       0.000422356278
  error estimate for blocks of size 2^( 3) =       0.000435401384
  error estimate for blocks of size 2^( 4) =       0.000448265475
  error estimate for blocks of size 2^( 5) =       0.000459824442
  error estimate for blocks of size 2^( 6) =       0.000468321415
  error estimate for blocks of size 2^( 7) =       0.000475921116

      target function =                  N/A
              le_mean =     -16.922638478352
             les_mean =     286.710749075454
             stat err =       0.000463083112
             autocorr =       1.280059793887
              std dev =       0.578840370041
             le_variance =       0.335056173989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335021843951
                                         uncertainty =       0.003236768647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335021843951
                                         uncertainty =       0.003236768647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409301969
  error estimate for blocks of size 2^( 2) =       0.000422356295
  error estimate for blocks of size 2^( 3) =       0.000435401401
  error estimate for blocks of size 2^( 4) =       0.000448265492
  error estimate for blocks of size 2^( 5) =       0.000459824460
  error estimate for blocks of size 2^( 6) =       0.000468321433
  error estimate for blocks of size 2^( 7) =       0.000475921133

      target function =                  N/A
              le_mean =     -16.922638478733
             les_mean =     286.710749117487
             stat err =       0.000463083130
             autocorr =       1.280059780351
              std dev =       0.578840395219
             le_variance =       0.335056203137


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.922638478787        initial  <--
     5.8208e+02     5.8208e+03             5.4645e-07       -16.922638477917
     2.3283e+03     2.3283e+04             1.3662e-07       -16.922638478352
     9.3132e+03     9.3132e+04             3.4154e-08       -16.922638478733

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.4557
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.098615e-01 1 1  ON 0
 uu_1                 1.438304e-01 1 1  ON 1
 uu_2                 4.315376e-02 1 1  ON 2
 uu_3                -1.911006e-02 1 1  ON 3
 uu_4                -6.427487e-02 1 1  ON 4
 uu_5                -9.778324e-02 1 1  ON 5
 uu_6                -1.245345e-01 1 1  ON 6
 uu_7                -1.382479e-01 1 1  ON 7
 uu_8                -1.321494e-01 1 1  ON 8
 uu_9                -1.022610e-01 1 1  ON 9
 ud_0                 4.381078e-01 1 1  ON 10
 ud_1                 1.722253e-01 1 1  ON 11
 ud_2                 5.295228e-02 1 1  ON 12
 ud_3                -1.597799e-02 1 1  ON 13
 ud_4                -6.969666e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288496e-01 1 1  ON 16
 ud_7                -1.417069e-01 1 1  ON 17
 ud_8                -1.400989e-01 1 1  ON 18
 ud_9                -1.324301e-01 1 1  ON 19
 eO_0                -7.693832e-01 1 1  ON 20
 eO_1                -4.483044e-01 1 1  ON 21
 eO_2                -2.570842e-02 1 1  ON 22
 eO_3                 2.984774e-01 1 1  ON 23
 eO_4                 5.314438e-01 1 1  ON 24
 eO_5                 4.913985e-01 1 1  ON 25
 eO_6                 2.576740e-01 1 1  ON 26
 eO_7                -4.677101e-02 1 1  ON 27
 eO_8                -2.136946e-01 1 1  ON 28
 eO_9                -7.486503e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382296e-01 1 1  ON 31
eH1_2                -9.370082e-02 1 1  ON 32
eH1_3                -3.894466e-02 1 1  ON 33
eH1_4                 5.524690e-03 1 1  ON 34
eH1_5                 3.931805e-02 1 1  ON 35
eH1_6                 9.469824e-02 1 1  ON 36
eH1_7                 1.480147e-01 1 1  ON 37
eH1_8                 1.673113e-01 1 1  ON 38
eH1_9                 5.521463e-02 1 1  ON 39
eH2_0                -2.329019e-01 1 1  ON 40
eH2_1                -1.350703e-01 1 1  ON 41
eH2_2                -9.051396e-02 1 1  ON 42
eH2_3                -3.559834e-02 1 1  ON 43
eH2_4                 8.546484e-03 1 1  ON 44
eH2_5                 4.204399e-02 1 1  ON 45
eH2_6                 9.791210e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724325e-01 1 1  ON 48
eH2_9                 3.954105e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2360e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9871
    reference variance = 0.552416
====================================================
  Execution time = 4.7617e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.5733e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1818e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357418015309
                                         uncertainty =       0.013906878516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357418015309
                                         uncertainty =       0.013906878516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422689332
  error estimate for blocks of size 2^( 2) =       0.000435287820
  error estimate for blocks of size 2^( 3) =       0.000448443987
  error estimate for blocks of size 2^( 4) =       0.000461007857
  error estimate for blocks of size 2^( 5) =       0.000472809794
  error estimate for blocks of size 2^( 6) =       0.000481198941
  error estimate for blocks of size 2^( 7) =       0.000486752435

      target function =                  N/A
              le_mean =     -16.922877911802
             les_mean =     286.741129182593
             stat err =       0.000475442257
             autocorr =       1.265181935824
              std dev =       0.597772986588
             le_variance =       0.357332543495


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692287791180e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922877911802       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922877912013       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922877911992       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922877912044       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922877912139       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922877912181       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922877912259       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922877912245       residual = 6.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 5.584611e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922877911802       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922877911855       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922877911850       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922877911848       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922877911891       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922877911889       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922877911910       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922877911913       residual = 6.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 1.396156e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922877911802       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922877911815       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922877911814       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922877911757       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922877911839       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922877911920       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922877911858       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922877911910       residual = 6.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 3.490394e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.287297 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9446e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.098615e-01 1 1  ON 0
 uu_1                 1.438304e-01 1 1  ON 1
 uu_2                 4.315376e-02 1 1  ON 2
 uu_3                -1.911006e-02 1 1  ON 3
 uu_4                -6.427487e-02 1 1  ON 4
 uu_5                -9.778324e-02 1 1  ON 5
 uu_6                -1.245345e-01 1 1  ON 6
 uu_7                -1.382479e-01 1 1  ON 7
 uu_8                -1.321494e-01 1 1  ON 8
 uu_9                -1.022610e-01 1 1  ON 9
 ud_0                 4.381078e-01 1 1  ON 10
 ud_1                 1.722253e-01 1 1  ON 11
 ud_2                 5.295227e-02 1 1  ON 12
 ud_3                -1.597799e-02 1 1  ON 13
 ud_4                -6.969666e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288496e-01 1 1  ON 16
 ud_7                -1.417069e-01 1 1  ON 17
 ud_8                -1.400989e-01 1 1  ON 18
 ud_9                -1.324301e-01 1 1  ON 19
 eO_0                -7.693833e-01 1 1  ON 20
 eO_1                -4.483045e-01 1 1  ON 21
 eO_2                -2.570842e-02 1 1  ON 22
 eO_3                 2.984774e-01 1 1  ON 23
 eO_4                 5.314438e-01 1 1  ON 24
 eO_5                 4.913985e-01 1 1  ON 25
 eO_6                 2.576740e-01 1 1  ON 26
 eO_7                -4.677100e-02 1 1  ON 27
 eO_8                -2.136946e-01 1 1  ON 28
 eO_9                -7.486504e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382296e-01 1 1  ON 31
eH1_2                -9.370083e-02 1 1  ON 32
eH1_3                -3.894466e-02 1 1  ON 33
eH1_4                 5.524685e-03 1 1  ON 34
eH1_5                 3.931805e-02 1 1  ON 35
eH1_6                 9.469824e-02 1 1  ON 36
eH1_7                 1.480147e-01 1 1  ON 37
eH1_8                 1.673113e-01 1 1  ON 38
eH1_9                 5.521464e-02 1 1  ON 39
eH2_0                -2.329019e-01 1 1  ON 40
eH2_1                -1.350703e-01 1 1  ON 41
eH2_2                -9.051396e-02 1 1  ON 42
eH2_3                -3.559834e-02 1 1  ON 43
eH2_4                 8.546486e-03 1 1  ON 44
eH2_5                 4.204399e-02 1 1  ON 45
eH2_6                 9.791209e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724325e-01 1 1  ON 48
eH2_9                 3.954106e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8784
    reference variance = 0.200931
====================================================
  Execution time = 4.3381e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4180e-01
  Total weights = 2.0000e+06
  Execution time = 4.0578e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341289546691
                                         uncertainty =       0.003794546766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341289546691
                                         uncertainty =       0.003794546766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413401599
  error estimate for blocks of size 2^( 2) =       0.000425951139
  error estimate for blocks of size 2^( 3) =       0.000439042174
  error estimate for blocks of size 2^( 4) =       0.000451190232
  error estimate for blocks of size 2^( 5) =       0.000462647935
  error estimate for blocks of size 2^( 6) =       0.000470589105
  error estimate for blocks of size 2^( 7) =       0.000475058799

      target function =                  N/A
              le_mean =     -16.923542182208
             les_mean =     286.748081586195
             stat err =       0.000464871518
             autocorr =       1.264507973072
              std dev =       0.584638148030
             le_variance =       0.341801764132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341289558590
                                         uncertainty =       0.003794546876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341289558590
                                         uncertainty =       0.003794546876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413401606
  error estimate for blocks of size 2^( 2) =       0.000425951146
  error estimate for blocks of size 2^( 3) =       0.000439042180
  error estimate for blocks of size 2^( 4) =       0.000451190238
  error estimate for blocks of size 2^( 5) =       0.000462647940
  error estimate for blocks of size 2^( 6) =       0.000470589109
  error estimate for blocks of size 2^( 7) =       0.000475058802

      target function =                  N/A
              le_mean =     -16.923542182092
             les_mean =     286.748081594183
             stat err =       0.000464871522
             autocorr =       1.264507953554
              std dev =       0.584638158211
             le_variance =       0.341801776036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341289552641
                                         uncertainty =       0.003794546821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341289552641
                                         uncertainty =       0.003794546821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413401603
  error estimate for blocks of size 2^( 2) =       0.000425951142
  error estimate for blocks of size 2^( 3) =       0.000439042177
  error estimate for blocks of size 2^( 4) =       0.000451190235
  error estimate for blocks of size 2^( 5) =       0.000462647937
  error estimate for blocks of size 2^( 6) =       0.000470589107
  error estimate for blocks of size 2^( 7) =       0.000475058801

      target function =                  N/A
              le_mean =     -16.923542182150
             les_mean =     286.748081590189
             stat err =       0.000464871520
             autocorr =       1.264507963313
              std dev =       0.584638153121
             le_variance =       0.341801770085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341289547435
                                         uncertainty =       0.003794546772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341289547435
                                         uncertainty =       0.003794546772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413401599
  error estimate for blocks of size 2^( 2) =       0.000425951139
  error estimate for blocks of size 2^( 3) =       0.000439042175
  error estimate for blocks of size 2^( 4) =       0.000451190233
  error estimate for blocks of size 2^( 5) =       0.000462647935
  error estimate for blocks of size 2^( 6) =       0.000470589105
  error estimate for blocks of size 2^( 7) =       0.000475058799

      target function =                  N/A
              le_mean =     -16.923542182200
             les_mean =     286.748081586694
             stat err =       0.000464871518
             autocorr =       1.264507971839
              std dev =       0.584638148667
             le_variance =       0.341801764876


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923542182208        initial  <--
     5.8208e+03     5.8208e+04             5.5846e-08       -16.923542182092
     2.3283e+04     2.3283e+05             1.3962e-08       -16.923542182150
     9.3132e+04     9.3132e+05             3.4904e-09       -16.923542182200

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.8461
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.098615e-01 1 1  ON 0
 uu_1                 1.438304e-01 1 1  ON 1
 uu_2                 4.315376e-02 1 1  ON 2
 uu_3                -1.911006e-02 1 1  ON 3
 uu_4                -6.427487e-02 1 1  ON 4
 uu_5                -9.778324e-02 1 1  ON 5
 uu_6                -1.245345e-01 1 1  ON 6
 uu_7                -1.382479e-01 1 1  ON 7
 uu_8                -1.321494e-01 1 1  ON 8
 uu_9                -1.022610e-01 1 1  ON 9
 ud_0                 4.381078e-01 1 1  ON 10
 ud_1                 1.722253e-01 1 1  ON 11
 ud_2                 5.295228e-02 1 1  ON 12
 ud_3                -1.597799e-02 1 1  ON 13
 ud_4                -6.969666e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288496e-01 1 1  ON 16
 ud_7                -1.417069e-01 1 1  ON 17
 ud_8                -1.400989e-01 1 1  ON 18
 ud_9                -1.324301e-01 1 1  ON 19
 eO_0                -7.693832e-01 1 1  ON 20
 eO_1                -4.483044e-01 1 1  ON 21
 eO_2                -2.570842e-02 1 1  ON 22
 eO_3                 2.984774e-01 1 1  ON 23
 eO_4                 5.314438e-01 1 1  ON 24
 eO_5                 4.913985e-01 1 1  ON 25
 eO_6                 2.576740e-01 1 1  ON 26
 eO_7                -4.677101e-02 1 1  ON 27
 eO_8                -2.136946e-01 1 1  ON 28
 eO_9                -7.486503e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382296e-01 1 1  ON 31
eH1_2                -9.370082e-02 1 1  ON 32
eH1_3                -3.894466e-02 1 1  ON 33
eH1_4                 5.524690e-03 1 1  ON 34
eH1_5                 3.931805e-02 1 1  ON 35
eH1_6                 9.469824e-02 1 1  ON 36
eH1_7                 1.480147e-01 1 1  ON 37
eH1_8                 1.673113e-01 1 1  ON 38
eH1_9                 5.521463e-02 1 1  ON 39
eH2_0                -2.329019e-01 1 1  ON 40
eH2_1                -1.350703e-01 1 1  ON 41
eH2_2                -9.051396e-02 1 1  ON 42
eH2_3                -3.559834e-02 1 1  ON 43
eH2_4                 8.546484e-03 1 1  ON 44
eH2_5                 4.204399e-02 1 1  ON 45
eH2_6                 9.791210e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724325e-01 1 1  ON 48
eH2_9                 3.954105e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2330e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9021
    reference variance = 0.321299
====================================================
  Execution time = 4.4373e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.8593e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2024e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386024661828
                                         uncertainty =       0.049324992063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386024661828
                                         uncertainty =       0.049324992063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439278507
  error estimate for blocks of size 2^( 2) =       0.000451243577
  error estimate for blocks of size 2^( 3) =       0.000462460998
  error estimate for blocks of size 2^( 4) =       0.000473452600
  error estimate for blocks of size 2^( 5) =       0.000483449237
  error estimate for blocks of size 2^( 6) =       0.000489804239
  error estimate for blocks of size 2^( 7) =       0.000494482538

      target function =                  N/A
              le_mean =     -16.923054332214
             les_mean =     286.775698950853
             stat err =       0.000485297154
             autocorr =       1.220493805240
              std dev =       0.621233621720
             le_variance =       0.385931212755


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692305433221e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923054332214       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923054332224       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923054332220       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923054332222       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923054332236       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923054332231       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923054332240       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923054332226       residual = 6.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 6.629059e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923054332214       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923054332216       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923054332216       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923054332216       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923054332164       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923054332474       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923054332215       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923054332236       residual = 6.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 1.657265e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923054332214       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923054332215       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923054332214       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923054332214       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923054332634       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923054332214       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923054332109       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923054331568       residual = 6.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 4.143163e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.291785 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6408e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.098615e-01 1 1  ON 0
 uu_1                 1.438304e-01 1 1  ON 1
 uu_2                 4.315376e-02 1 1  ON 2
 uu_3                -1.911006e-02 1 1  ON 3
 uu_4                -6.427487e-02 1 1  ON 4
 uu_5                -9.778324e-02 1 1  ON 5
 uu_6                -1.245345e-01 1 1  ON 6
 uu_7                -1.382479e-01 1 1  ON 7
 uu_8                -1.321494e-01 1 1  ON 8
 uu_9                -1.022610e-01 1 1  ON 9
 ud_0                 4.381078e-01 1 1  ON 10
 ud_1                 1.722253e-01 1 1  ON 11
 ud_2                 5.295228e-02 1 1  ON 12
 ud_3                -1.597799e-02 1 1  ON 13
 ud_4                -6.969666e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288496e-01 1 1  ON 16
 ud_7                -1.417069e-01 1 1  ON 17
 ud_8                -1.400989e-01 1 1  ON 18
 ud_9                -1.324301e-01 1 1  ON 19
 eO_0                -7.693832e-01 1 1  ON 20
 eO_1                -4.483044e-01 1 1  ON 21
 eO_2                -2.570842e-02 1 1  ON 22
 eO_3                 2.984774e-01 1 1  ON 23
 eO_4                 5.314438e-01 1 1  ON 24
 eO_5                 4.913985e-01 1 1  ON 25
 eO_6                 2.576740e-01 1 1  ON 26
 eO_7                -4.677101e-02 1 1  ON 27
 eO_8                -2.136946e-01 1 1  ON 28
 eO_9                -7.486503e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382296e-01 1 1  ON 31
eH1_2                -9.370082e-02 1 1  ON 32
eH1_3                -3.894466e-02 1 1  ON 33
eH1_4                 5.524689e-03 1 1  ON 34
eH1_5                 3.931805e-02 1 1  ON 35
eH1_6                 9.469824e-02 1 1  ON 36
eH1_7                 1.480147e-01 1 1  ON 37
eH1_8                 1.673113e-01 1 1  ON 38
eH1_9                 5.521463e-02 1 1  ON 39
eH2_0                -2.329019e-01 1 1  ON 40
eH2_1                -1.350703e-01 1 1  ON 41
eH2_2                -9.051396e-02 1 1  ON 42
eH2_3                -3.559834e-02 1 1  ON 43
eH2_4                 8.546484e-03 1 1  ON 44
eH2_5                 4.204399e-02 1 1  ON 45
eH2_6                 9.791210e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724325e-01 1 1  ON 48
eH2_9                 3.954105e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9009
    reference variance = 0.231445
====================================================
  Execution time = 4.6072e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4005e-01
  Total weights = 2.0000e+06
  Execution time = 4.0615e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340144265734
                                         uncertainty =       0.005832513580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340144265734
                                         uncertainty =       0.005832513580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412343298
  error estimate for blocks of size 2^( 2) =       0.000424851258
  error estimate for blocks of size 2^( 3) =       0.000437586668
  error estimate for blocks of size 2^( 4) =       0.000449020742
  error estimate for blocks of size 2^( 5) =       0.000458693144
  error estimate for blocks of size 2^( 6) =       0.000468137924
  error estimate for blocks of size 2^( 7) =       0.000472911553

      target function =                  N/A
              le_mean =     -16.923710641990
             les_mean =     286.752035714557
             stat err =       0.000462190841
             autocorr =       1.256390920820
              std dev =       0.583141484369
             le_variance =       0.340053990792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340144261364
                                         uncertainty =       0.005832513570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340144261364
                                         uncertainty =       0.005832513570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412343295
  error estimate for blocks of size 2^( 2) =       0.000424851256
  error estimate for blocks of size 2^( 3) =       0.000437586665
  error estimate for blocks of size 2^( 4) =       0.000449020740
  error estimate for blocks of size 2^( 5) =       0.000458693141
  error estimate for blocks of size 2^( 6) =       0.000468137922
  error estimate for blocks of size 2^( 7) =       0.000472911551

      target function =                  N/A
              le_mean =     -16.923710641962
             les_mean =     286.752035709271
             stat err =       0.000462190839
             autocorr =       1.256390924803
              std dev =       0.583141480623
             le_variance =       0.340053986423

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340144263549
                                         uncertainty =       0.005832513575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340144263549
                                         uncertainty =       0.005832513575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412343297
  error estimate for blocks of size 2^( 2) =       0.000424851257
  error estimate for blocks of size 2^( 3) =       0.000437586666
  error estimate for blocks of size 2^( 4) =       0.000449020741
  error estimate for blocks of size 2^( 5) =       0.000458693143
  error estimate for blocks of size 2^( 6) =       0.000468137923
  error estimate for blocks of size 2^( 7) =       0.000472911552

      target function =                  N/A
              le_mean =     -16.923710641976
             les_mean =     286.752035711914
             stat err =       0.000462190840
             autocorr =       1.256390922816
              std dev =       0.583141482496
             le_variance =       0.340053988608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340144265461
                                         uncertainty =       0.005832513579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340144265461
                                         uncertainty =       0.005832513579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412343298
  error estimate for blocks of size 2^( 2) =       0.000424851258
  error estimate for blocks of size 2^( 3) =       0.000437586667
  error estimate for blocks of size 2^( 4) =       0.000449020742
  error estimate for blocks of size 2^( 5) =       0.000458693144
  error estimate for blocks of size 2^( 6) =       0.000468137924
  error estimate for blocks of size 2^( 7) =       0.000472911553

      target function =                  N/A
              le_mean =     -16.923710641988
             les_mean =     286.752035714227
             stat err =       0.000462190841
             autocorr =       1.256390921068
              std dev =       0.583141484135
             le_variance =       0.340053990519


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923710641990        initial  <--
     5.8208e+04     5.8208e+05             6.6291e-09       -16.923710641962
     2.3283e+05     2.3283e+06             1.6573e-09       -16.923710641976
     9.3132e+05     9.3132e+06             4.1432e-10       -16.923710641988

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.5323
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.098615e-01 1 1  ON 0
 uu_1                 1.438304e-01 1 1  ON 1
 uu_2                 4.315376e-02 1 1  ON 2
 uu_3                -1.911006e-02 1 1  ON 3
 uu_4                -6.427487e-02 1 1  ON 4
 uu_5                -9.778324e-02 1 1  ON 5
 uu_6                -1.245345e-01 1 1  ON 6
 uu_7                -1.382479e-01 1 1  ON 7
 uu_8                -1.321494e-01 1 1  ON 8
 uu_9                -1.022610e-01 1 1  ON 9
 ud_0                 4.381078e-01 1 1  ON 10
 ud_1                 1.722253e-01 1 1  ON 11
 ud_2                 5.295228e-02 1 1  ON 12
 ud_3                -1.597799e-02 1 1  ON 13
 ud_4                -6.969666e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288496e-01 1 1  ON 16
 ud_7                -1.417069e-01 1 1  ON 17
 ud_8                -1.400989e-01 1 1  ON 18
 ud_9                -1.324301e-01 1 1  ON 19
 eO_0                -7.693832e-01 1 1  ON 20
 eO_1                -4.483044e-01 1 1  ON 21
 eO_2                -2.570842e-02 1 1  ON 22
 eO_3                 2.984774e-01 1 1  ON 23
 eO_4                 5.314438e-01 1 1  ON 24
 eO_5                 4.913985e-01 1 1  ON 25
 eO_6                 2.576740e-01 1 1  ON 26
 eO_7                -4.677101e-02 1 1  ON 27
 eO_8                -2.136946e-01 1 1  ON 28
 eO_9                -7.486503e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382296e-01 1 1  ON 31
eH1_2                -9.370082e-02 1 1  ON 32
eH1_3                -3.894466e-02 1 1  ON 33
eH1_4                 5.524690e-03 1 1  ON 34
eH1_5                 3.931805e-02 1 1  ON 35
eH1_6                 9.469824e-02 1 1  ON 36
eH1_7                 1.480147e-01 1 1  ON 37
eH1_8                 1.673113e-01 1 1  ON 38
eH1_9                 5.521463e-02 1 1  ON 39
eH2_0                -2.329019e-01 1 1  ON 40
eH2_1                -1.350703e-01 1 1  ON 41
eH2_2                -9.051396e-02 1 1  ON 42
eH2_3                -3.559834e-02 1 1  ON 43
eH2_4                 8.546484e-03 1 1  ON 44
eH2_5                 4.204399e-02 1 1  ON 45
eH2_6                 9.791210e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724325e-01 1 1  ON 48
eH2_9                 3.954105e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2299e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8658
    reference variance = 0.196
====================================================
  Execution time = 4.4005e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3791e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1974e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337956772283
                                         uncertainty =       0.002800400057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337956772283
                                         uncertainty =       0.002800400057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411040342
  error estimate for blocks of size 2^( 2) =       0.000423799542
  error estimate for blocks of size 2^( 3) =       0.000437459238
  error estimate for blocks of size 2^( 4) =       0.000450040971
  error estimate for blocks of size 2^( 5) =       0.000461905448
  error estimate for blocks of size 2^( 6) =       0.000470747951
  error estimate for blocks of size 2^( 7) =       0.000476339364

      target function =                  N/A
              le_mean =     -16.923063126612
             les_mean =     286.727973743742
             stat err =       0.000464758433
             autocorr =       1.278455635683
              std dev =       0.581298826244
             le_variance =       0.337908325392


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692306312661e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923063126612       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923063126615       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923063126614       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923063126577       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923063126610       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923063126373       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923063126483       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923063126936       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 6.175764e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923063126612       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923063126613       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923063126613       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923063126612       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923063126781       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923063127821       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923063126945       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923063126490       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 1.543943e-10

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923063126612       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923063126612       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923063126612       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923063127772       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923063126648       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923063125307       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923063124782       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923063129793       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 3.859847e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.296339 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.5990e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.098615e-01 1 1  ON 0
 uu_1                 1.438304e-01 1 1  ON 1
 uu_2                 4.315376e-02 1 1  ON 2
 uu_3                -1.911006e-02 1 1  ON 3
 uu_4                -6.427487e-02 1 1  ON 4
 uu_5                -9.778324e-02 1 1  ON 5
 uu_6                -1.245345e-01 1 1  ON 6
 uu_7                -1.382479e-01 1 1  ON 7
 uu_8                -1.321494e-01 1 1  ON 8
 uu_9                -1.022610e-01 1 1  ON 9
 ud_0                 4.381078e-01 1 1  ON 10
 ud_1                 1.722253e-01 1 1  ON 11
 ud_2                 5.295228e-02 1 1  ON 12
 ud_3                -1.597799e-02 1 1  ON 13
 ud_4                -6.969666e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288496e-01 1 1  ON 16
 ud_7                -1.417069e-01 1 1  ON 17
 ud_8                -1.400989e-01 1 1  ON 18
 ud_9                -1.324301e-01 1 1  ON 19
 eO_0                -7.693832e-01 1 1  ON 20
 eO_1                -4.483044e-01 1 1  ON 21
 eO_2                -2.570842e-02 1 1  ON 22
 eO_3                 2.984774e-01 1 1  ON 23
 eO_4                 5.314438e-01 1 1  ON 24
 eO_5                 4.913985e-01 1 1  ON 25
 eO_6                 2.576740e-01 1 1  ON 26
 eO_7                -4.677101e-02 1 1  ON 27
 eO_8                -2.136946e-01 1 1  ON 28
 eO_9                -7.486503e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382296e-01 1 1  ON 31
eH1_2                -9.370082e-02 1 1  ON 32
eH1_3                -3.894466e-02 1 1  ON 33
eH1_4                 5.524690e-03 1 1  ON 34
eH1_5                 3.931805e-02 1 1  ON 35
eH1_6                 9.469824e-02 1 1  ON 36
eH1_7                 1.480147e-01 1 1  ON 37
eH1_8                 1.673113e-01 1 1  ON 38
eH1_9                 5.521463e-02 1 1  ON 39
eH2_0                -2.329019e-01 1 1  ON 40
eH2_1                -1.350703e-01 1 1  ON 41
eH2_2                -9.051396e-02 1 1  ON 42
eH2_3                -3.559834e-02 1 1  ON 43
eH2_4                 8.546484e-03 1 1  ON 44
eH2_5                 4.204399e-02 1 1  ON 45
eH2_6                 9.791210e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724325e-01 1 1  ON 48
eH2_9                 3.954105e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9233
    reference variance = 0.169967
====================================================
  Execution time = 4.6400e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3710e-01
  Total weights = 2.0000e+06
  Execution time = 4.0574e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337096443293
                                         uncertainty =       0.003384130054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337096443293
                                         uncertainty =       0.003384130054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410545804
  error estimate for blocks of size 2^( 2) =       0.000423396526
  error estimate for blocks of size 2^( 3) =       0.000436733550
  error estimate for blocks of size 2^( 4) =       0.000448980806
  error estimate for blocks of size 2^( 5) =       0.000459705870
  error estimate for blocks of size 2^( 6) =       0.000467844599
  error estimate for blocks of size 2^( 7) =       0.000473238259

      target function =                  N/A
              le_mean =     -16.923344433688
             les_mean =     286.736682366661
             stat err =       0.000462442383
             autocorr =       1.268796660056
              std dev =       0.580599443667
             le_variance =       0.337095713987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337096442925
                                         uncertainty =       0.003384130050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337096442925
                                         uncertainty =       0.003384130050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410545804
  error estimate for blocks of size 2^( 2) =       0.000423396526
  error estimate for blocks of size 2^( 3) =       0.000436733550
  error estimate for blocks of size 2^( 4) =       0.000448980805
  error estimate for blocks of size 2^( 5) =       0.000459705870
  error estimate for blocks of size 2^( 6) =       0.000467844599
  error estimate for blocks of size 2^( 7) =       0.000473238258

      target function =                  N/A
              le_mean =     -16.923344433691
             les_mean =     286.736682366403
             stat err =       0.000462442383
             autocorr =       1.268796660315
              std dev =       0.580599443349
             le_variance =       0.337095713617

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337096443109
                                         uncertainty =       0.003384130052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337096443109
                                         uncertainty =       0.003384130052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410545804
  error estimate for blocks of size 2^( 2) =       0.000423396526
  error estimate for blocks of size 2^( 3) =       0.000436733550
  error estimate for blocks of size 2^( 4) =       0.000448980806
  error estimate for blocks of size 2^( 5) =       0.000459705870
  error estimate for blocks of size 2^( 6) =       0.000467844599
  error estimate for blocks of size 2^( 7) =       0.000473238258

      target function =                  N/A
              le_mean =     -16.923344433689
             les_mean =     286.736682366532
             stat err =       0.000462442383
             autocorr =       1.268796660185
              std dev =       0.580599443508
             le_variance =       0.337095713802

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337096443270
                                         uncertainty =       0.003384130054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337096443270
                                         uncertainty =       0.003384130054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410545804
  error estimate for blocks of size 2^( 2) =       0.000423396526
  error estimate for blocks of size 2^( 3) =       0.000436733550
  error estimate for blocks of size 2^( 4) =       0.000448980806
  error estimate for blocks of size 2^( 5) =       0.000459705870
  error estimate for blocks of size 2^( 6) =       0.000467844599
  error estimate for blocks of size 2^( 7) =       0.000473238259

      target function =                  N/A
              le_mean =     -16.923344433688
             les_mean =     286.736682366645
             stat err =       0.000462442383
             autocorr =       1.268796660075
              std dev =       0.580599443647
             le_variance =       0.337095713963


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923344433688        initial
     5.8208e+05     5.8208e+06             6.1758e-10       -16.923344433691  <--
     2.3283e+06     2.3283e+07             1.5439e-10       -16.923344433689
     9.3132e+06     9.3132e+07             3.8598e-11       -16.923344433688

*****************************************************************************
Applying the update for shift_i =   5.8208e+05     and shift_s =   5.8208e+06
*****************************************************************************

  Execution time = 6.6904e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.098615e-01 1 1  ON 0
 uu_1                 1.438304e-01 1 1  ON 1
 uu_2                 4.315376e-02 1 1  ON 2
 uu_3                -1.911006e-02 1 1  ON 3
 uu_4                -6.427487e-02 1 1  ON 4
 uu_5                -9.778324e-02 1 1  ON 5
 uu_6                -1.245345e-01 1 1  ON 6
 uu_7                -1.382479e-01 1 1  ON 7
 uu_8                -1.321494e-01 1 1  ON 8
 uu_9                -1.022610e-01 1 1  ON 9
 ud_0                 4.381078e-01 1 1  ON 10
 ud_1                 1.722253e-01 1 1  ON 11
 ud_2                 5.295228e-02 1 1  ON 12
 ud_3                -1.597799e-02 1 1  ON 13
 ud_4                -6.969666e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288496e-01 1 1  ON 16
 ud_7                -1.417069e-01 1 1  ON 17
 ud_8                -1.400989e-01 1 1  ON 18
 ud_9                -1.324301e-01 1 1  ON 19
 eO_0                -7.693832e-01 1 1  ON 20
 eO_1                -4.483044e-01 1 1  ON 21
 eO_2                -2.570842e-02 1 1  ON 22
 eO_3                 2.984774e-01 1 1  ON 23
 eO_4                 5.314438e-01 1 1  ON 24
 eO_5                 4.913985e-01 1 1  ON 25
 eO_6                 2.576740e-01 1 1  ON 26
 eO_7                -4.677101e-02 1 1  ON 27
 eO_8                -2.136946e-01 1 1  ON 28
 eO_9                -7.486503e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382296e-01 1 1  ON 31
eH1_2                -9.370082e-02 1 1  ON 32
eH1_3                -3.894466e-02 1 1  ON 33
eH1_4                 5.524690e-03 1 1  ON 34
eH1_5                 3.931805e-02 1 1  ON 35
eH1_6                 9.469824e-02 1 1  ON 36
eH1_7                 1.480147e-01 1 1  ON 37
eH1_8                 1.673113e-01 1 1  ON 38
eH1_9                 5.521463e-02 1 1  ON 39
eH2_0                -2.329019e-01 1 1  ON 40
eH2_1                -1.350703e-01 1 1  ON 41
eH2_2                -9.051396e-02 1 1  ON 42
eH2_3                -3.559834e-02 1 1  ON 43
eH2_4                 8.546484e-03 1 1  ON 44
eH2_5                 4.204399e-02 1 1  ON 45
eH2_6                 9.791210e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724325e-01 1 1  ON 48
eH2_9                 3.954105e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2290e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.0229
    reference variance = 0.464849
====================================================
  Execution time = 4.3755e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3790e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2287e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337927741622
                                         uncertainty =       0.002461680029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337927741622
                                         uncertainty =       0.002461680029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411037404
  error estimate for blocks of size 2^( 2) =       0.000424175049
  error estimate for blocks of size 2^( 3) =       0.000437765019
  error estimate for blocks of size 2^( 4) =       0.000450437093
  error estimate for blocks of size 2^( 5) =       0.000461316632
  error estimate for blocks of size 2^( 6) =       0.000470282935
  error estimate for blocks of size 2^( 7) =       0.000476783068

      target function =                  N/A
              le_mean =     -16.923112488669
             les_mean =     286.729639629521
             stat err =       0.000464704932
             autocorr =       1.278179584219
              std dev =       0.581294670818
             le_variance =       0.337903494321


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692311248867e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923112488669       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923112488680       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923112488682       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923112488682       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923112488677       residual = 6.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923112488628       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923112488653       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923112488687       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 2.617550e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923112488669       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923112488672       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923112488673       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923112488673       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923112489130       residual = 6.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923112489043       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923112488673       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923112488335       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 6.543879e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923112488669       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923112488670       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923112488670       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923112488670       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923112488670       residual = 6.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923112488805       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923112488575       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923112489659       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 1.635969e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.301154 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6053e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.098615e-01 1 1  ON 0
 uu_1                 1.438304e-01 1 1  ON 1
 uu_2                 4.315376e-02 1 1  ON 2
 uu_3                -1.911006e-02 1 1  ON 3
 uu_4                -6.427487e-02 1 1  ON 4
 uu_5                -9.778324e-02 1 1  ON 5
 uu_6                -1.245345e-01 1 1  ON 6
 uu_7                -1.382479e-01 1 1  ON 7
 uu_8                -1.321494e-01 1 1  ON 8
 uu_9                -1.022610e-01 1 1  ON 9
 ud_0                 4.381078e-01 1 1  ON 10
 ud_1                 1.722253e-01 1 1  ON 11
 ud_2                 5.295228e-02 1 1  ON 12
 ud_3                -1.597799e-02 1 1  ON 13
 ud_4                -6.969666e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288496e-01 1 1  ON 16
 ud_7                -1.417069e-01 1 1  ON 17
 ud_8                -1.400989e-01 1 1  ON 18
 ud_9                -1.324301e-01 1 1  ON 19
 eO_0                -7.693832e-01 1 1  ON 20
 eO_1                -4.483044e-01 1 1  ON 21
 eO_2                -2.570842e-02 1 1  ON 22
 eO_3                 2.984774e-01 1 1  ON 23
 eO_4                 5.314438e-01 1 1  ON 24
 eO_5                 4.913985e-01 1 1  ON 25
 eO_6                 2.576740e-01 1 1  ON 26
 eO_7                -4.677101e-02 1 1  ON 27
 eO_8                -2.136946e-01 1 1  ON 28
 eO_9                -7.486503e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382296e-01 1 1  ON 31
eH1_2                -9.370082e-02 1 1  ON 32
eH1_3                -3.894466e-02 1 1  ON 33
eH1_4                 5.524690e-03 1 1  ON 34
eH1_5                 3.931805e-02 1 1  ON 35
eH1_6                 9.469824e-02 1 1  ON 36
eH1_7                 1.480147e-01 1 1  ON 37
eH1_8                 1.673113e-01 1 1  ON 38
eH1_9                 5.521463e-02 1 1  ON 39
eH2_0                -2.329019e-01 1 1  ON 40
eH2_1                -1.350703e-01 1 1  ON 41
eH2_2                -9.051396e-02 1 1  ON 42
eH2_3                -3.559834e-02 1 1  ON 43
eH2_4                 8.546484e-03 1 1  ON 44
eH2_5                 4.204399e-02 1 1  ON 45
eH2_6                 9.791209e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724325e-01 1 1  ON 48
eH2_9                 3.954105e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8758
    reference variance = 0.217611
====================================================
  Execution time = 4.3496e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4829e-01
  Total weights = 2.0000e+06
  Execution time = 4.0730e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348425813360
                                         uncertainty =       0.010450701617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348425813360
                                         uncertainty =       0.010450701617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417309079
  error estimate for blocks of size 2^( 2) =       0.000429781796
  error estimate for blocks of size 2^( 3) =       0.000442918457
  error estimate for blocks of size 2^( 4) =       0.000454484955
  error estimate for blocks of size 2^( 5) =       0.000463374279
  error estimate for blocks of size 2^( 6) =       0.000470203100
  error estimate for blocks of size 2^( 7) =       0.000474035873

      target function =                  N/A
              le_mean =     -16.923992336614
             les_mean =     286.769810171183
             stat err =       0.000465524552
             autocorr =       1.244427253038
              std dev =       0.590164159840
             le_variance =       0.348293735559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348425813409
                                         uncertainty =       0.010450701559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348425813409
                                         uncertainty =       0.010450701559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417309079
  error estimate for blocks of size 2^( 2) =       0.000429781796
  error estimate for blocks of size 2^( 3) =       0.000442918457
  error estimate for blocks of size 2^( 4) =       0.000454484955
  error estimate for blocks of size 2^( 5) =       0.000463374279
  error estimate for blocks of size 2^( 6) =       0.000470203100
  error estimate for blocks of size 2^( 7) =       0.000474035873

      target function =                  N/A
              le_mean =     -16.923992336612
             les_mean =     286.769810171158
             stat err =       0.000465524552
             autocorr =       1.244427252868
              std dev =       0.590164159882
             le_variance =       0.348293735609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348425813385
                                         uncertainty =       0.010450701588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348425813385
                                         uncertainty =       0.010450701588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417309079
  error estimate for blocks of size 2^( 2) =       0.000429781796
  error estimate for blocks of size 2^( 3) =       0.000442918457
  error estimate for blocks of size 2^( 4) =       0.000454484955
  error estimate for blocks of size 2^( 5) =       0.000463374279
  error estimate for blocks of size 2^( 6) =       0.000470203100
  error estimate for blocks of size 2^( 7) =       0.000474035873

      target function =                  N/A
              le_mean =     -16.923992336613
             les_mean =     286.769810171170
             stat err =       0.000465524552
             autocorr =       1.244427252952
              std dev =       0.590164159861
             le_variance =       0.348293735584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348425813363
                                         uncertainty =       0.010450701613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348425813363
                                         uncertainty =       0.010450701613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417309079
  error estimate for blocks of size 2^( 2) =       0.000429781796
  error estimate for blocks of size 2^( 3) =       0.000442918457
  error estimate for blocks of size 2^( 4) =       0.000454484955
  error estimate for blocks of size 2^( 5) =       0.000463374279
  error estimate for blocks of size 2^( 6) =       0.000470203100
  error estimate for blocks of size 2^( 7) =       0.000474035873

      target function =                  N/A
              le_mean =     -16.923992336614
             les_mean =     286.769810171181
             stat err =       0.000465524552
             autocorr =       1.244427253025
              std dev =       0.590164159842
             le_variance =       0.348293735563


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923992336614        initial  <--
     1.4552e+05     1.4552e+06             2.6175e-09       -16.923992336612
     5.8208e+05     5.8208e+06             6.5439e-10       -16.923992336613
     2.3283e+06     2.3283e+07             1.6360e-10       -16.923992336614

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.0639
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.098615e-01 1 1  ON 0
 uu_1                 1.438304e-01 1 1  ON 1
 uu_2                 4.315376e-02 1 1  ON 2
 uu_3                -1.911006e-02 1 1  ON 3
 uu_4                -6.427487e-02 1 1  ON 4
 uu_5                -9.778324e-02 1 1  ON 5
 uu_6                -1.245345e-01 1 1  ON 6
 uu_7                -1.382479e-01 1 1  ON 7
 uu_8                -1.321494e-01 1 1  ON 8
 uu_9                -1.022610e-01 1 1  ON 9
 ud_0                 4.381078e-01 1 1  ON 10
 ud_1                 1.722253e-01 1 1  ON 11
 ud_2                 5.295228e-02 1 1  ON 12
 ud_3                -1.597799e-02 1 1  ON 13
 ud_4                -6.969666e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288496e-01 1 1  ON 16
 ud_7                -1.417069e-01 1 1  ON 17
 ud_8                -1.400989e-01 1 1  ON 18
 ud_9                -1.324301e-01 1 1  ON 19
 eO_0                -7.693832e-01 1 1  ON 20
 eO_1                -4.483044e-01 1 1  ON 21
 eO_2                -2.570842e-02 1 1  ON 22
 eO_3                 2.984774e-01 1 1  ON 23
 eO_4                 5.314438e-01 1 1  ON 24
 eO_5                 4.913985e-01 1 1  ON 25
 eO_6                 2.576740e-01 1 1  ON 26
 eO_7                -4.677101e-02 1 1  ON 27
 eO_8                -2.136946e-01 1 1  ON 28
 eO_9                -7.486503e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382296e-01 1 1  ON 31
eH1_2                -9.370082e-02 1 1  ON 32
eH1_3                -3.894466e-02 1 1  ON 33
eH1_4                 5.524690e-03 1 1  ON 34
eH1_5                 3.931805e-02 1 1  ON 35
eH1_6                 9.469824e-02 1 1  ON 36
eH1_7                 1.480147e-01 1 1  ON 37
eH1_8                 1.673113e-01 1 1  ON 38
eH1_9                 5.521463e-02 1 1  ON 39
eH2_0                -2.329019e-01 1 1  ON 40
eH2_1                -1.350703e-01 1 1  ON 41
eH2_2                -9.051396e-02 1 1  ON 42
eH2_3                -3.559834e-02 1 1  ON 43
eH2_4                 8.546484e-03 1 1  ON 44
eH2_5                 4.204399e-02 1 1  ON 45
eH2_6                 9.791210e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724325e-01 1 1  ON 48
eH2_9                 3.954105e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2020e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8297
    reference variance = 0.401911
====================================================
  Execution time = 4.8081e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.4217e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1812e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342037354329
                                         uncertainty =       0.003471406951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342037354329
                                         uncertainty =       0.003471406951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413626595
  error estimate for blocks of size 2^( 2) =       0.000426183327
  error estimate for blocks of size 2^( 3) =       0.000439469667
  error estimate for blocks of size 2^( 4) =       0.000451464961
  error estimate for blocks of size 2^( 5) =       0.000462577579
  error estimate for blocks of size 2^( 6) =       0.000469897317
  error estimate for blocks of size 2^( 7) =       0.000476684302

      target function =                  N/A
              le_mean =     -16.922698375408
             les_mean =     286.719894054148
             stat err =       0.000465156040
             autocorr =       1.264679324232
              std dev =       0.584956340424
             le_variance =       0.342173920202


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692269837541e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922698375408       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922698375409       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922698375409       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922698375385       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922698375342       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922698375521       residual = 9.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922698374953       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922698376069       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 2.020984e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922698375408       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922698375408       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922698375408       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922698375408       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922698375408       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922698375297       residual = 9.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922698374597       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922698374487       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 5.052463e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.922698375408       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.922698375408       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.922698375408       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.922698375408       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.922698375408       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.922698364173       residual = 9.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.922698386641       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922698348602       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 1.263116e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.305914 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9904e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.098615e-01 1 1  ON 0
 uu_1                 1.438304e-01 1 1  ON 1
 uu_2                 4.315376e-02 1 1  ON 2
 uu_3                -1.911006e-02 1 1  ON 3
 uu_4                -6.427487e-02 1 1  ON 4
 uu_5                -9.778324e-02 1 1  ON 5
 uu_6                -1.245345e-01 1 1  ON 6
 uu_7                -1.382479e-01 1 1  ON 7
 uu_8                -1.321494e-01 1 1  ON 8
 uu_9                -1.022610e-01 1 1  ON 9
 ud_0                 4.381078e-01 1 1  ON 10
 ud_1                 1.722253e-01 1 1  ON 11
 ud_2                 5.295228e-02 1 1  ON 12
 ud_3                -1.597799e-02 1 1  ON 13
 ud_4                -6.969666e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288496e-01 1 1  ON 16
 ud_7                -1.417069e-01 1 1  ON 17
 ud_8                -1.400989e-01 1 1  ON 18
 ud_9                -1.324301e-01 1 1  ON 19
 eO_0                -7.693832e-01 1 1  ON 20
 eO_1                -4.483044e-01 1 1  ON 21
 eO_2                -2.570842e-02 1 1  ON 22
 eO_3                 2.984774e-01 1 1  ON 23
 eO_4                 5.314438e-01 1 1  ON 24
 eO_5                 4.913985e-01 1 1  ON 25
 eO_6                 2.576740e-01 1 1  ON 26
 eO_7                -4.677101e-02 1 1  ON 27
 eO_8                -2.136946e-01 1 1  ON 28
 eO_9                -7.486503e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382296e-01 1 1  ON 31
eH1_2                -9.370082e-02 1 1  ON 32
eH1_3                -3.894466e-02 1 1  ON 33
eH1_4                 5.524690e-03 1 1  ON 34
eH1_5                 3.931805e-02 1 1  ON 35
eH1_6                 9.469824e-02 1 1  ON 36
eH1_7                 1.480147e-01 1 1  ON 37
eH1_8                 1.673113e-01 1 1  ON 38
eH1_9                 5.521463e-02 1 1  ON 39
eH2_0                -2.329019e-01 1 1  ON 40
eH2_1                -1.350703e-01 1 1  ON 41
eH2_2                -9.051396e-02 1 1  ON 42
eH2_3                -3.559834e-02 1 1  ON 43
eH2_4                 8.546484e-03 1 1  ON 44
eH2_5                 4.204399e-02 1 1  ON 45
eH2_6                 9.791210e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724325e-01 1 1  ON 48
eH2_9                 3.954105e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9293
    reference variance = 0.302434
====================================================
  Execution time = 4.3427e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3894e-01
  Total weights = 2.0000e+06
  Execution time = 4.0747e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339008719939
                                         uncertainty =       0.004322100843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339008719939
                                         uncertainty =       0.004322100843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411665354
  error estimate for blocks of size 2^( 2) =       0.000424625396
  error estimate for blocks of size 2^( 3) =       0.000437830830
  error estimate for blocks of size 2^( 4) =       0.000450259339
  error estimate for blocks of size 2^( 5) =       0.000461371812
  error estimate for blocks of size 2^( 6) =       0.000469851338
  error estimate for blocks of size 2^( 7) =       0.000476906484

      target function =                  N/A
              le_mean =     -16.923394724628
             les_mean =     286.740225564210
             stat err =       0.000464597243
             autocorr =       1.273692584248
              std dev =       0.582182727410
             le_variance =       0.338936728095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339008719830
                                         uncertainty =       0.004322100842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339008719830
                                         uncertainty =       0.004322100842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411665354
  error estimate for blocks of size 2^( 2) =       0.000424625396
  error estimate for blocks of size 2^( 3) =       0.000437830830
  error estimate for blocks of size 2^( 4) =       0.000450259339
  error estimate for blocks of size 2^( 5) =       0.000461371812
  error estimate for blocks of size 2^( 6) =       0.000469851338
  error estimate for blocks of size 2^( 7) =       0.000476906484

      target function =                  N/A
              le_mean =     -16.923394724628
             les_mean =     286.740225564089
             stat err =       0.000464597243
             autocorr =       1.273692584329
              std dev =       0.582182727317
             le_variance =       0.338936727986

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339008719884
                                         uncertainty =       0.004322100843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339008719884
                                         uncertainty =       0.004322100843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411665354
  error estimate for blocks of size 2^( 2) =       0.000424625396
  error estimate for blocks of size 2^( 3) =       0.000437830830
  error estimate for blocks of size 2^( 4) =       0.000450259339
  error estimate for blocks of size 2^( 5) =       0.000461371812
  error estimate for blocks of size 2^( 6) =       0.000469851338
  error estimate for blocks of size 2^( 7) =       0.000476906484

      target function =                  N/A
              le_mean =     -16.923394724628
             les_mean =     286.740225564149
             stat err =       0.000464597243
             autocorr =       1.273692584292
              std dev =       0.582182727364
             le_variance =       0.338936728040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339008719932
                                         uncertainty =       0.004322100843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339008719932
                                         uncertainty =       0.004322100843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411665354
  error estimate for blocks of size 2^( 2) =       0.000424625396
  error estimate for blocks of size 2^( 3) =       0.000437830830
  error estimate for blocks of size 2^( 4) =       0.000450259339
  error estimate for blocks of size 2^( 5) =       0.000461371812
  error estimate for blocks of size 2^( 6) =       0.000469851338
  error estimate for blocks of size 2^( 7) =       0.000476906484

      target function =                  N/A
              le_mean =     -16.923394724628
             les_mean =     286.740225564202
             stat err =       0.000464597243
             autocorr =       1.273692584251
              std dev =       0.582182727404
             le_variance =       0.338936728088


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923394724628        initial  <--
     1.4552e+06     1.4552e+07             2.0210e-10       -16.923394724628
     5.8208e+06     5.8208e+07             5.0525e-11       -16.923394724628
     2.3283e+07     2.3283e+08             1.2631e-11       -16.923394724628

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.9884
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.098615e-01 1 1  ON 0
 uu_1                 1.438304e-01 1 1  ON 1
 uu_2                 4.315376e-02 1 1  ON 2
 uu_3                -1.911006e-02 1 1  ON 3
 uu_4                -6.427487e-02 1 1  ON 4
 uu_5                -9.778324e-02 1 1  ON 5
 uu_6                -1.245345e-01 1 1  ON 6
 uu_7                -1.382479e-01 1 1  ON 7
 uu_8                -1.321494e-01 1 1  ON 8
 uu_9                -1.022610e-01 1 1  ON 9
 ud_0                 4.381078e-01 1 1  ON 10
 ud_1                 1.722253e-01 1 1  ON 11
 ud_2                 5.295228e-02 1 1  ON 12
 ud_3                -1.597799e-02 1 1  ON 13
 ud_4                -6.969666e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288496e-01 1 1  ON 16
 ud_7                -1.417069e-01 1 1  ON 17
 ud_8                -1.400989e-01 1 1  ON 18
 ud_9                -1.324301e-01 1 1  ON 19
 eO_0                -7.693832e-01 1 1  ON 20
 eO_1                -4.483044e-01 1 1  ON 21
 eO_2                -2.570842e-02 1 1  ON 22
 eO_3                 2.984774e-01 1 1  ON 23
 eO_4                 5.314438e-01 1 1  ON 24
 eO_5                 4.913985e-01 1 1  ON 25
 eO_6                 2.576740e-01 1 1  ON 26
 eO_7                -4.677101e-02 1 1  ON 27
 eO_8                -2.136946e-01 1 1  ON 28
 eO_9                -7.486503e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382296e-01 1 1  ON 31
eH1_2                -9.370082e-02 1 1  ON 32
eH1_3                -3.894466e-02 1 1  ON 33
eH1_4                 5.524690e-03 1 1  ON 34
eH1_5                 3.931805e-02 1 1  ON 35
eH1_6                 9.469824e-02 1 1  ON 36
eH1_7                 1.480147e-01 1 1  ON 37
eH1_8                 1.673113e-01 1 1  ON 38
eH1_9                 5.521463e-02 1 1  ON 39
eH2_0                -2.329019e-01 1 1  ON 40
eH2_1                -1.350703e-01 1 1  ON 41
eH2_2                -9.051396e-02 1 1  ON 42
eH2_3                -3.559834e-02 1 1  ON 43
eH2_4                 8.546484e-03 1 1  ON 44
eH2_5                 4.204399e-02 1 1  ON 45
eH2_6                 9.791210e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724325e-01 1 1  ON 48
eH2_9                 3.954105e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2390e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9199
    reference variance = 0.313557
====================================================
  Execution time = 4.7734e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4286e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1853e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342905435739
                                         uncertainty =       0.010285755441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342905435739
                                         uncertainty =       0.010285755441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414039990
  error estimate for blocks of size 2^( 2) =       0.000426641156
  error estimate for blocks of size 2^( 3) =       0.000440266561
  error estimate for blocks of size 2^( 4) =       0.000452405138
  error estimate for blocks of size 2^( 5) =       0.000463672319
  error estimate for blocks of size 2^( 6) =       0.000470157480
  error estimate for blocks of size 2^( 7) =       0.000473159484

      target function =                  N/A
              le_mean =     -16.923597703807
             les_mean =     286.751017295692
             stat err =       0.000464848605
             autocorr =       1.260487330729
              std dev =       0.585540969383
             le_variance =       0.342858226826


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692359770381e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923597703807       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923597703807       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923597703807       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923597703807       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923597703807       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923597699516       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923597708472       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923597711095       residual = 4.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 2.166084e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923597703807       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923597703807       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923597703807       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923597709916       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923597678201       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923597672519       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923597732812       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923597669903       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 5.415114e-12

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923597703807       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923597703807       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923597703807       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923597703807       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923597712225       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923597698057       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923597812747       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923597628246       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 1.353850e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.310361 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9597e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.098615e-01 1 1  ON 0
 uu_1                 1.438304e-01 1 1  ON 1
 uu_2                 4.315376e-02 1 1  ON 2
 uu_3                -1.911006e-02 1 1  ON 3
 uu_4                -6.427487e-02 1 1  ON 4
 uu_5                -9.778324e-02 1 1  ON 5
 uu_6                -1.245345e-01 1 1  ON 6
 uu_7                -1.382479e-01 1 1  ON 7
 uu_8                -1.321494e-01 1 1  ON 8
 uu_9                -1.022610e-01 1 1  ON 9
 ud_0                 4.381078e-01 1 1  ON 10
 ud_1                 1.722253e-01 1 1  ON 11
 ud_2                 5.295228e-02 1 1  ON 12
 ud_3                -1.597799e-02 1 1  ON 13
 ud_4                -6.969666e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288496e-01 1 1  ON 16
 ud_7                -1.417069e-01 1 1  ON 17
 ud_8                -1.400989e-01 1 1  ON 18
 ud_9                -1.324301e-01 1 1  ON 19
 eO_0                -7.693832e-01 1 1  ON 20
 eO_1                -4.483044e-01 1 1  ON 21
 eO_2                -2.570842e-02 1 1  ON 22
 eO_3                 2.984774e-01 1 1  ON 23
 eO_4                 5.314438e-01 1 1  ON 24
 eO_5                 4.913985e-01 1 1  ON 25
 eO_6                 2.576740e-01 1 1  ON 26
 eO_7                -4.677101e-02 1 1  ON 27
 eO_8                -2.136946e-01 1 1  ON 28
 eO_9                -7.486503e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382296e-01 1 1  ON 31
eH1_2                -9.370082e-02 1 1  ON 32
eH1_3                -3.894466e-02 1 1  ON 33
eH1_4                 5.524690e-03 1 1  ON 34
eH1_5                 3.931805e-02 1 1  ON 35
eH1_6                 9.469824e-02 1 1  ON 36
eH1_7                 1.480147e-01 1 1  ON 37
eH1_8                 1.673113e-01 1 1  ON 38
eH1_9                 5.521463e-02 1 1  ON 39
eH2_0                -2.329019e-01 1 1  ON 40
eH2_1                -1.350703e-01 1 1  ON 41
eH2_2                -9.051396e-02 1 1  ON 42
eH2_3                -3.559834e-02 1 1  ON 43
eH2_4                 8.546484e-03 1 1  ON 44
eH2_5                 4.204399e-02 1 1  ON 45
eH2_6                 9.791210e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724325e-01 1 1  ON 48
eH2_9                 3.954105e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8599
    reference variance = 0.248264
====================================================
  Execution time = 4.3585e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3713e-01
  Total weights = 2.0000e+06
  Execution time = 4.0708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337142906954
                                         uncertainty =       0.006385896851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337142906954
                                         uncertainty =       0.006385896851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410567066
  error estimate for blocks of size 2^( 2) =       0.000423255666
  error estimate for blocks of size 2^( 3) =       0.000435953550
  error estimate for blocks of size 2^( 4) =       0.000447801645
  error estimate for blocks of size 2^( 5) =       0.000458132360
  error estimate for blocks of size 2^( 6) =       0.000466398914
  error estimate for blocks of size 2^( 7) =       0.000471559456

      target function =                  N/A
              le_mean =     -16.923396860348
             les_mean =     286.738491755032
             stat err =       0.000460973094
             autocorr =       1.260616352085
              std dev =       0.580629512473
             le_variance =       0.337130630754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337142906945
                                         uncertainty =       0.006385896851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337142906945
                                         uncertainty =       0.006385896851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410567066
  error estimate for blocks of size 2^( 2) =       0.000423255666
  error estimate for blocks of size 2^( 3) =       0.000435953550
  error estimate for blocks of size 2^( 4) =       0.000447801645
  error estimate for blocks of size 2^( 5) =       0.000458132360
  error estimate for blocks of size 2^( 6) =       0.000466398914
  error estimate for blocks of size 2^( 7) =       0.000471559456

      target function =                  N/A
              le_mean =     -16.923396860348
             les_mean =     286.738491755024
             stat err =       0.000460973094
             autocorr =       1.260616352088
              std dev =       0.580629512465
             le_variance =       0.337130630746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337142906950
                                         uncertainty =       0.006385896851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337142906950
                                         uncertainty =       0.006385896851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410567066
  error estimate for blocks of size 2^( 2) =       0.000423255666
  error estimate for blocks of size 2^( 3) =       0.000435953550
  error estimate for blocks of size 2^( 4) =       0.000447801645
  error estimate for blocks of size 2^( 5) =       0.000458132360
  error estimate for blocks of size 2^( 6) =       0.000466398914
  error estimate for blocks of size 2^( 7) =       0.000471559456

      target function =                  N/A
              le_mean =     -16.923396860348
             les_mean =     286.738491755028
             stat err =       0.000460973094
             autocorr =       1.260616352080
              std dev =       0.580629512469
             le_variance =       0.337130630750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337142906953
                                         uncertainty =       0.006385896851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337142906953
                                         uncertainty =       0.006385896851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410567066
  error estimate for blocks of size 2^( 2) =       0.000423255666
  error estimate for blocks of size 2^( 3) =       0.000435953550
  error estimate for blocks of size 2^( 4) =       0.000447801645
  error estimate for blocks of size 2^( 5) =       0.000458132360
  error estimate for blocks of size 2^( 6) =       0.000466398914
  error estimate for blocks of size 2^( 7) =       0.000471559456

      target function =                  N/A
              le_mean =     -16.923396860348
             les_mean =     286.738491755032
             stat err =       0.000460973094
             autocorr =       1.260616352080
              std dev =       0.580629512472
             le_variance =       0.337130630754


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923396860348        initial  <--
     1.4552e+07     1.4552e+08             2.1661e-11       -16.923396860348
     5.8208e+07     5.8208e+08             5.4151e-12       -16.923396860348
     2.3283e+08     2.3283e+09             1.3538e-12       -16.923396860348

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.1550
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.098615e-01 1 1  ON 0
 uu_1                 1.438304e-01 1 1  ON 1
 uu_2                 4.315376e-02 1 1  ON 2
 uu_3                -1.911006e-02 1 1  ON 3
 uu_4                -6.427487e-02 1 1  ON 4
 uu_5                -9.778324e-02 1 1  ON 5
 uu_6                -1.245345e-01 1 1  ON 6
 uu_7                -1.382479e-01 1 1  ON 7
 uu_8                -1.321494e-01 1 1  ON 8
 uu_9                -1.022610e-01 1 1  ON 9
 ud_0                 4.381078e-01 1 1  ON 10
 ud_1                 1.722253e-01 1 1  ON 11
 ud_2                 5.295228e-02 1 1  ON 12
 ud_3                -1.597799e-02 1 1  ON 13
 ud_4                -6.969666e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288496e-01 1 1  ON 16
 ud_7                -1.417069e-01 1 1  ON 17
 ud_8                -1.400989e-01 1 1  ON 18
 ud_9                -1.324301e-01 1 1  ON 19
 eO_0                -7.693832e-01 1 1  ON 20
 eO_1                -4.483044e-01 1 1  ON 21
 eO_2                -2.570842e-02 1 1  ON 22
 eO_3                 2.984774e-01 1 1  ON 23
 eO_4                 5.314438e-01 1 1  ON 24
 eO_5                 4.913985e-01 1 1  ON 25
 eO_6                 2.576740e-01 1 1  ON 26
 eO_7                -4.677101e-02 1 1  ON 27
 eO_8                -2.136946e-01 1 1  ON 28
 eO_9                -7.486503e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382296e-01 1 1  ON 31
eH1_2                -9.370082e-02 1 1  ON 32
eH1_3                -3.894466e-02 1 1  ON 33
eH1_4                 5.524690e-03 1 1  ON 34
eH1_5                 3.931805e-02 1 1  ON 35
eH1_6                 9.469824e-02 1 1  ON 36
eH1_7                 1.480147e-01 1 1  ON 37
eH1_8                 1.673113e-01 1 1  ON 38
eH1_9                 5.521463e-02 1 1  ON 39
eH2_0                -2.329019e-01 1 1  ON 40
eH2_1                -1.350703e-01 1 1  ON 41
eH2_2                -9.051396e-02 1 1  ON 42
eH2_3                -3.559834e-02 1 1  ON 43
eH2_4                 8.546484e-03 1 1  ON 44
eH2_5                 4.204399e-02 1 1  ON 45
eH2_6                 9.791210e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724325e-01 1 1  ON 48
eH2_9                 3.954105e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2376e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9508
    reference variance = 0.226968
====================================================
  Execution time = 4.3881e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3202e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1947e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332049875757
                                         uncertainty =       0.002767492118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332049875757
                                         uncertainty =       0.002767492118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407443078
  error estimate for blocks of size 2^( 2) =       0.000420414458
  error estimate for blocks of size 2^( 3) =       0.000433529619
  error estimate for blocks of size 2^( 4) =       0.000446392390
  error estimate for blocks of size 2^( 5) =       0.000457741855
  error estimate for blocks of size 2^( 6) =       0.000467933326
  error estimate for blocks of size 2^( 7) =       0.000474182599

      target function =                  N/A
              le_mean =     -16.923044626374
             les_mean =     286.721458984261
             stat err =       0.000461562543
             autocorr =       1.283297137741
              std dev =       0.576211527148
             le_variance =       0.332019724018


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692304462637e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923044626374       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923044626374       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923044626374       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923044652258       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923044626361       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923044626384       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923044701395       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923044700072       residual = 5.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+08 is 1.966594e-12

solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923044626374       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923044626374       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923044626374       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923044071049       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923044303975       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923045485918       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923044341234       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923044605656       residual = 5.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+08 is 4.917190e-13

solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923044626374       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923044626374       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923044626374       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923044626374       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923045409565       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923045061321       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923045798544       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923044943806       residual = 5.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+09 is 1.234339e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.314541 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.5840e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.098615e-01 1 1  ON 0
 uu_1                 1.438304e-01 1 1  ON 1
 uu_2                 4.315376e-02 1 1  ON 2
 uu_3                -1.911006e-02 1 1  ON 3
 uu_4                -6.427487e-02 1 1  ON 4
 uu_5                -9.778324e-02 1 1  ON 5
 uu_6                -1.245345e-01 1 1  ON 6
 uu_7                -1.382479e-01 1 1  ON 7
 uu_8                -1.321494e-01 1 1  ON 8
 uu_9                -1.022610e-01 1 1  ON 9
 ud_0                 4.381078e-01 1 1  ON 10
 ud_1                 1.722253e-01 1 1  ON 11
 ud_2                 5.295228e-02 1 1  ON 12
 ud_3                -1.597799e-02 1 1  ON 13
 ud_4                -6.969666e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288496e-01 1 1  ON 16
 ud_7                -1.417069e-01 1 1  ON 17
 ud_8                -1.400989e-01 1 1  ON 18
 ud_9                -1.324301e-01 1 1  ON 19
 eO_0                -7.693832e-01 1 1  ON 20
 eO_1                -4.483044e-01 1 1  ON 21
 eO_2                -2.570842e-02 1 1  ON 22
 eO_3                 2.984774e-01 1 1  ON 23
 eO_4                 5.314438e-01 1 1  ON 24
 eO_5                 4.913985e-01 1 1  ON 25
 eO_6                 2.576740e-01 1 1  ON 26
 eO_7                -4.677101e-02 1 1  ON 27
 eO_8                -2.136946e-01 1 1  ON 28
 eO_9                -7.486503e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382296e-01 1 1  ON 31
eH1_2                -9.370082e-02 1 1  ON 32
eH1_3                -3.894466e-02 1 1  ON 33
eH1_4                 5.524690e-03 1 1  ON 34
eH1_5                 3.931805e-02 1 1  ON 35
eH1_6                 9.469824e-02 1 1  ON 36
eH1_7                 1.480147e-01 1 1  ON 37
eH1_8                 1.673113e-01 1 1  ON 38
eH1_9                 5.521463e-02 1 1  ON 39
eH2_0                -2.329019e-01 1 1  ON 40
eH2_1                -1.350703e-01 1 1  ON 41
eH2_2                -9.051396e-02 1 1  ON 42
eH2_3                -3.559834e-02 1 1  ON 43
eH2_4                 8.546484e-03 1 1  ON 44
eH2_5                 4.204399e-02 1 1  ON 45
eH2_6                 9.791210e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724325e-01 1 1  ON 48
eH2_9                 3.954105e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9462
    reference variance = 0.314848
====================================================
  Execution time = 4.6399e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6923e+01
  VMC Evar = 3.3780e-01
  Total weights = 2.0000e+06
  Execution time = 4.0741e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337927909673
                                         uncertainty =       0.002907489316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337927909673
                                         uncertainty =       0.002907489316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410975034
  error estimate for blocks of size 2^( 2) =       0.000423548338
  error estimate for blocks of size 2^( 3) =       0.000436230218
  error estimate for blocks of size 2^( 4) =       0.000447461848
  error estimate for blocks of size 2^( 5) =       0.000458671048
  error estimate for blocks of size 2^( 6) =       0.000465968143
  error estimate for blocks of size 2^( 7) =       0.000471697181

      target function =                  N/A
              le_mean =     -16.923465616975
             les_mean =     286.741489277134
             stat err =       0.000460949555
             autocorr =       1.257986326049
              std dev =       0.581206466841
             le_variance =       0.337800957098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337927909673
                                         uncertainty =       0.002907489316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337927909673
                                         uncertainty =       0.002907489316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410975034
  error estimate for blocks of size 2^( 2) =       0.000423548338
  error estimate for blocks of size 2^( 3) =       0.000436230218
  error estimate for blocks of size 2^( 4) =       0.000447461848
  error estimate for blocks of size 2^( 5) =       0.000458671048
  error estimate for blocks of size 2^( 6) =       0.000465968143
  error estimate for blocks of size 2^( 7) =       0.000471697181

      target function =                  N/A
              le_mean =     -16.923465616975
             les_mean =     286.741489277134
             stat err =       0.000460949555
             autocorr =       1.257986326045
              std dev =       0.581206466841
             le_variance =       0.337800957098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337927909673
                                         uncertainty =       0.002907489316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337927909673
                                         uncertainty =       0.002907489316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410975034
  error estimate for blocks of size 2^( 2) =       0.000423548338
  error estimate for blocks of size 2^( 3) =       0.000436230218
  error estimate for blocks of size 2^( 4) =       0.000447461848
  error estimate for blocks of size 2^( 5) =       0.000458671048
  error estimate for blocks of size 2^( 6) =       0.000465968143
  error estimate for blocks of size 2^( 7) =       0.000471697181

      target function =                  N/A
              le_mean =     -16.923465616975
             les_mean =     286.741489277134
             stat err =       0.000460949555
             autocorr =       1.257986326044
              std dev =       0.581206466841
             le_variance =       0.337800957098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337927909673
                                         uncertainty =       0.002907489316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337927909673
                                         uncertainty =       0.002907489316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410975034
  error estimate for blocks of size 2^( 2) =       0.000423548338
  error estimate for blocks of size 2^( 3) =       0.000436230218
  error estimate for blocks of size 2^( 4) =       0.000447461848
  error estimate for blocks of size 2^( 5) =       0.000458671048
  error estimate for blocks of size 2^( 6) =       0.000465968143
  error estimate for blocks of size 2^( 7) =       0.000471697181

      target function =                  N/A
              le_mean =     -16.923465616975
             les_mean =     286.741489277134
             stat err =       0.000460949555
             autocorr =       1.257986326044
              std dev =       0.581206466841
             le_variance =       0.337800957098


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923465616975        initial  <--
     1.4552e+08     1.4552e+09             1.9666e-12       -16.923465616975
     5.8208e+08     5.8208e+09             4.9172e-13       -16.923465616975
     2.3283e+09     2.3283e+10             1.2343e-13       -16.923465616975

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.9198
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.098615e-01 1 1  ON 0
 uu_1                 1.438304e-01 1 1  ON 1
 uu_2                 4.315376e-02 1 1  ON 2
 uu_3                -1.911006e-02 1 1  ON 3
 uu_4                -6.427487e-02 1 1  ON 4
 uu_5                -9.778324e-02 1 1  ON 5
 uu_6                -1.245345e-01 1 1  ON 6
 uu_7                -1.382479e-01 1 1  ON 7
 uu_8                -1.321494e-01 1 1  ON 8
 uu_9                -1.022610e-01 1 1  ON 9
 ud_0                 4.381078e-01 1 1  ON 10
 ud_1                 1.722253e-01 1 1  ON 11
 ud_2                 5.295228e-02 1 1  ON 12
 ud_3                -1.597799e-02 1 1  ON 13
 ud_4                -6.969666e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288496e-01 1 1  ON 16
 ud_7                -1.417069e-01 1 1  ON 17
 ud_8                -1.400989e-01 1 1  ON 18
 ud_9                -1.324301e-01 1 1  ON 19
 eO_0                -7.693832e-01 1 1  ON 20
 eO_1                -4.483044e-01 1 1  ON 21
 eO_2                -2.570842e-02 1 1  ON 22
 eO_3                 2.984774e-01 1 1  ON 23
 eO_4                 5.314438e-01 1 1  ON 24
 eO_5                 4.913985e-01 1 1  ON 25
 eO_6                 2.576740e-01 1 1  ON 26
 eO_7                -4.677101e-02 1 1  ON 27
 eO_8                -2.136946e-01 1 1  ON 28
 eO_9                -7.486503e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382296e-01 1 1  ON 31
eH1_2                -9.370082e-02 1 1  ON 32
eH1_3                -3.894466e-02 1 1  ON 33
eH1_4                 5.524690e-03 1 1  ON 34
eH1_5                 3.931805e-02 1 1  ON 35
eH1_6                 9.469824e-02 1 1  ON 36
eH1_7                 1.480147e-01 1 1  ON 37
eH1_8                 1.673113e-01 1 1  ON 38
eH1_9                 5.521463e-02 1 1  ON 39
eH2_0                -2.329019e-01 1 1  ON 40
eH2_1                -1.350703e-01 1 1  ON 41
eH2_2                -9.051396e-02 1 1  ON 42
eH2_3                -3.559834e-02 1 1  ON 43
eH2_4                 8.546484e-03 1 1  ON 44
eH2_5                 4.204399e-02 1 1  ON 45
eH2_6                 9.791210e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724325e-01 1 1  ON 48
eH2_9                 3.954105e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2277e+02 secs
  Total Execution time = 4.9105e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
