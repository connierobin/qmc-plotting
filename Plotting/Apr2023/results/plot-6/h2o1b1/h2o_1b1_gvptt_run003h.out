Rank =    0  Free Memory = 81227 MB
Rank =    1  Free Memory = 81227 MB
Rank =    2  Free Memory = 81226 MB
Rank =    3  Free Memory = 81225 MB
Rank =    4  Free Memory = 81224 MB
Rank =    5  Free Memory = 81224 MB
Rank =    6  Free Memory = 81224 MB
Rank =    7  Free Memory = 81223 MB
Rank =    8  Free Memory = 81223 MB
Rank =    9  Free Memory = 81223 MB
Rank =   10  Free Memory = 81223 MB
Rank =   11  Free Memory = 81223 MB
Rank =   12  Free Memory = 81223 MB
Rank =   13  Free Memory = 81223 MB
Rank =   14  Free Memory = 81222 MB
Rank =   15  Free Memory = 81210 MB
Rank =   16  Free Memory = 81210 MB
Rank =   17  Free Memory = 81210 MB
Rank =   18  Free Memory = 81210 MB
Rank =   19  Free Memory = 81210 MB
Rank =   20  Free Memory = 81210 MB
Rank =   21  Free Memory = 81210 MB
Rank =   22  Free Memory = 81210 MB
Rank =   23  Free Memory = 81210 MB
Rank =   24  Free Memory = 81210 MB
Rank =   25  Free Memory = 81210 MB
Rank =   26  Free Memory = 81210 MB
Rank =   27  Free Memory = 81209 MB
Rank =   28  Free Memory = 81209 MB
Rank =   29  Free Memory = 81209 MB
Rank =   30  Free Memory = 81209 MB
Rank =   31  Free Memory = 81209 MB
Rank =   32  Free Memory = 81874 MB
Rank =   33  Free Memory = 81874 MB
Rank =   34  Free Memory = 81874 MB
Rank =   35  Free Memory = 81874 MB
Rank =   36  Free Memory = 81874 MB
Rank =   37  Free Memory = 81874 MB
Rank =   38  Free Memory = 81874 MB
Rank =   39  Free Memory = 81874 MB
Rank =   40  Free Memory = 81874 MB
Rank =   41  Free Memory = 81874 MB
Rank =   42  Free Memory = 81874 MB
Rank =   43  Free Memory = 81874 MB
Rank =   44  Free Memory = 81874 MB
Rank =   45  Free Memory = 81874 MB
Rank =   46  Free Memory = 81874 MB
Rank =   47  Free Memory = 81874 MB
Rank =   48  Free Memory = 81874 MB
Rank =   49  Free Memory = 81874 MB
Rank =   50  Free Memory = 81874 MB
Rank =   51  Free Memory = 81874 MB
Rank =   52  Free Memory = 81874 MB
Rank =   53  Free Memory = 81874 MB
Rank =   54  Free Memory = 81874 MB
Rank =   55  Free Memory = 81874 MB
Rank =   56  Free Memory = 81874 MB
Rank =   57  Free Memory = 81874 MB
Rank =   58  Free Memory = 81874 MB
Rank =   59  Free Memory = 81874 MB
Rank =   60  Free Memory = 81874 MB
Rank =   61  Free Memory = 81874 MB
Rank =   62  Free Memory = 81874 MB
Rank =   63  Free Memory = 81874 MB
Rank =   64  Free Memory = 81864 MB
Rank =   65  Free Memory = 81864 MB
Rank =   66  Free Memory = 81864 MB
Rank =   67  Free Memory = 81864 MB
Rank =   68  Free Memory = 81864 MB
Rank =   69  Free Memory = 81864 MB
Rank =   70  Free Memory = 81864 MB
Rank =   71  Free Memory = 81864 MB
Rank =   72  Free Memory = 81864 MB
Rank =   73  Free Memory = 81863 MB
Rank =   74  Free Memory = 81863 MB
Rank =   75  Free Memory = 81863 MB
Rank =   76  Free Memory = 81863 MB
Rank =   77  Free Memory = 81863 MB
Rank =   78  Free Memory = 81863 MB
Rank =   79  Free Memory = 81863 MB
Rank =   80  Free Memory = 81863 MB
Rank =   81  Free Memory = 81863 MB
Rank =   82  Free Memory = 81863 MB
Rank =   83  Free Memory = 81863 MB
Rank =   84  Free Memory = 81863 MB
Rank =   85  Free Memory = 81863 MB
Rank =   86  Free Memory = 81863 MB
Rank =   87  Free Memory = 81863 MB
Rank =   88  Free Memory = 81863 MB
Rank =   89  Free Memory = 81863 MB
Rank =   90  Free Memory = 81863 MB
Rank =   91  Free Memory = 81863 MB
Rank =   92  Free Memory = 81863 MB
Rank =   93  Free Memory = 81863 MB
Rank =   94  Free Memory = 81863 MB
Rank =   95  Free Memory = 81863 MB
Rank =   96  Free Memory = 81592 MB
Rank =   97  Free Memory = 81592 MB
Rank =   98  Free Memory = 81592 MB
Rank =   99  Free Memory = 81592 MB
Rank =  100  Free Memory = 81592 MB
Rank =  101  Free Memory = 81592 MB
Rank =  102  Free Memory = 81592 MB
Rank =  103  Free Memory = 81592 MB
Rank =  104  Free Memory = 81592 MB
Rank =  105  Free Memory = 81592 MB
Rank =  106  Free Memory = 81592 MB
Rank =  107  Free Memory = 81592 MB
Rank =  108  Free Memory = 81592 MB
Rank =  109  Free Memory = 81592 MB
Rank =  110  Free Memory = 81592 MB
Rank =  111  Free Memory = 81592 MB
Rank =  112  Free Memory = 81592 MB
Rank =  113  Free Memory = 81592 MB
Rank =  114  Free Memory = 81592 MB
Rank =  115  Free Memory = 81592 MB
Rank =  116  Free Memory = 81592 MB
Rank =  117  Free Memory = 81592 MB
Rank =  118  Free Memory = 81592 MB
Rank =  119  Free Memory = 81592 MB
Rank =  120  Free Memory = 81592 MB
Rank =  121  Free Memory = 81592 MB
Rank =  122  Free Memory = 81592 MB
Rank =  123  Free Memory = 81592 MB
Rank =  124  Free Memory = 81592 MB
Rank =  125  Free Memory = 81592 MB
Rank =  126  Free Memory = 81592 MB
Rank =  127  Free Memory = 81592 MB
  Input file(s): opt_h2o_1b1_gvptt_run003h.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run003h.xml

  Project = H2O
  date    = 2023-04-10 11:13:47 PDT
  host    = n0045.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 475

  Range of prime numbers to use as seeds over processors and threads = 3389-4451


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.089679e-01    1         1  ON     0
     uu_1                 1.424420e-01    1         1  ON     1
     uu_2                 4.121123e-02    1         1  ON     2
     uu_3                -2.075372e-02    1         1  ON     3
     uu_4                -6.533852e-02    1         1  ON     4
     uu_5                -9.910983e-02    1         1  ON     5
     uu_6                -1.252855e-01    1         1  ON     6
     uu_7                -1.376785e-01    1         1  ON     7
     uu_8                -1.296083e-01    1         1  ON     8
     uu_9                -9.897760e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.458556e-01    1         1  ON     0
     ud_1                 1.801410e-01    1         1  ON     1
     ud_2                 6.023786e-02    1         1  ON     2
     ud_3                -1.055099e-02    1         1  ON     3
     ud_4                -6.706161e-02    1         1  ON     4
     ud_5                -1.078578e-01    1         1  ON     5
     ud_6                -1.344810e-01    1         1  ON     6
     ud_7                -1.496129e-01    1         1  ON     7
     ud_8                -1.486733e-01    1         1  ON     8
     ud_9                -1.373983e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.561965e-01    1         1  ON     0
     eO_1                -4.358408e-01    1         1  ON     1
     eO_2                -1.870196e-02    1         1  ON     2
     eO_3                 2.975847e-01    1         1  ON     3
     eO_4                 5.197876e-01    1         1  ON     4
     eO_5                 4.777834e-01    1         1  ON     5
     eO_6                 2.468220e-01    1         1  ON     6
     eO_7                -4.894684e-02    1         1  ON     7
     eO_8                -2.112025e-01    1         1  ON     8
     eO_9                -7.180992e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.410919e-01    1         1  ON     0
     eH1_1                -1.395224e-01    1         1  ON     1
     eH1_2                -9.271612e-02    1         1  ON     2
     eH1_3                -3.894797e-02    1         1  ON     3
     eH1_4                 8.595704e-03    1         1  ON     4
     eH1_5                 4.250139e-02    1         1  ON     5
     eH1_6                 9.978909e-02    1         1  ON     6
     eH1_7                 1.502497e-01    1         1  ON     7
     eH1_8                 1.649093e-01    1         1  ON     8
     eH1_9                 5.063253e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.394262e-01    1         1  ON     0
     eH2_1                -1.378768e-01    1         1  ON     1
     eH2_2                -9.113668e-02    1         1  ON     2
     eH2_3                -3.715623e-02    1         1  ON     3
     eH2_4                 1.173408e-02    1         1  ON     4
     eH2_5                 4.675465e-02    1         1  ON     5
     eH2_6                 1.032623e-01    1         1  ON     6
     eH2_7                 1.534699e-01    1         1  ON     7
     eH2_8                 1.710920e-01    1         1  ON     8
     eH2_9                 3.601778e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 5.123212e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 6.9705e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8849
    reference variance = 0.236703
====================================================
  Execution time = 2.1011e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3695e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5650e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337022405708
                                         uncertainty =       0.003836750176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337022405708
                                         uncertainty =       0.003836750176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410455707
  error estimate for blocks of size 2^( 2) =       0.000423857585
  error estimate for blocks of size 2^( 3) =       0.000438270081
  error estimate for blocks of size 2^( 4) =       0.000451468137
  error estimate for blocks of size 2^( 5) =       0.000464088736
  error estimate for blocks of size 2^( 6) =       0.000473838008
  error estimate for blocks of size 2^( 7) =       0.000479441500

      target function =                  N/A
              le_mean =     -16.905182449345
             les_mean =     286.122141252565
             stat err =       0.000467209095
             autocorr =       1.295656802388
              std dev =       0.580472028084
             le_variance =       0.336947775388


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690518244935e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905182449345       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905182766621       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905184700290       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905184952768       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905185288407       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905185742866       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905186831830       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905186482508       residual = 9.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905186467060       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905186453484       residual = 5.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.462572e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905182449345       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905182566730       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905183261534       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905183508352       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905183419807       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905183477035       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905183769990       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905183732919       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905183701849       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.379694e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905182449345       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905182482692       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905182671407       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905182763188       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905182752006       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905182740752       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905182807600       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905182801744       residual = 8.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 5.838923e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.005986 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6588e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.091368e-01                 1 1 ON  0
uu_1  1.425330e-01                 1 1 ON  1
uu_2  4.116414e-02                 1 1 ON  2
uu_3  -2.074268e-02                1 1 ON  3
uu_4  -6.551475e-02                1 1 ON  4
uu_5  -9.924891e-02                1 1 ON  5
uu_6  -1.254778e-01                1 1 ON  6
uu_7  -1.378728e-01                1 1 ON  7
uu_8  -1.295187e-01                1 1 ON  8
uu_9  -9.890999e-02                1 1 ON  9
ud_0  4.459353e-01                 1 1 ON  10
ud_1  1.801708e-01                 1 1 ON  11
ud_2  6.016854e-02                 1 1 ON  12
ud_3  -1.057776e-02                1 1 ON  13
ud_4  -6.713932e-02                1 1 ON  14
ud_5  -1.079049e-01                1 1 ON  15
ud_6  -1.345000e-01                1 1 ON  16
ud_7  -1.496971e-01                1 1 ON  17
ud_8  -1.486124e-01                1 1 ON  18
ud_9  -1.372620e-01                1 1 ON  19
eO_0  -7.562548e-01                1 1 ON  20
eO_1  -4.358514e-01                1 1 ON  21
eO_2  -1.879391e-02                1 1 ON  22
eO_3  2.975359e-01                 1 1 ON  23
eO_4  5.198573e-01                 1 1 ON  24
eO_5  4.778269e-01                 1 1 ON  25
eO_6  2.469980e-01                 1 1 ON  26
eO_7  -4.887201e-02                1 1 ON  27
eO_8  -2.112516e-01                1 1 ON  28
eO_9  -7.189866e-02                1 1 ON  29
eH1_0 -2.412520e-01                1 1 ON  30
eH1_1 -1.396692e-01                1 1 ON  31
eH1_2 -9.282772e-02                1 1 ON  32
eH1_3 -3.902144e-02                1 1 ON  33
eH1_4 8.528576e-03                 1 1 ON  34
eH1_5 4.244688e-02                 1 1 ON  35
eH1_6 9.979996e-02                 1 1 ON  36
eH1_7 1.503753e-01                 1 1 ON  37
eH1_8 1.651058e-01                 1 1 ON  38
eH1_9 5.087050e-02                 1 1 ON  39
eH2_0 -2.395755e-01                1 1 ON  40
eH2_1 -1.379857e-01                1 1 ON  41
eH2_2 -9.112228e-02                1 1 ON  42
eH2_3 -3.722705e-02                1 1 ON  43
eH2_4 1.167095e-02                 1 1 ON  44
eH2_5 4.666534e-02                 1 1 ON  45
eH2_6 1.032580e-01                 1 1 ON  46
eH2_7 1.535576e-01                 1 1 ON  47
eH2_8 1.712527e-01                 1 1 ON  48
eH2_9 3.623790e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8789
    reference variance = 0.179045
====================================================
  Execution time = 2.0628e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3385e-01
  Total weights = 2.0000e+06
  Execution time = 1.8920e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333685331208
                                         uncertainty =       0.003054498691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333685331208
                                         uncertainty =       0.003054498691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408460716
  error estimate for blocks of size 2^( 2) =       0.000421534986
  error estimate for blocks of size 2^( 3) =       0.000435005469
  error estimate for blocks of size 2^( 4) =       0.000447297830
  error estimate for blocks of size 2^( 5) =       0.000458180385
  error estimate for blocks of size 2^( 6) =       0.000466078571
  error estimate for blocks of size 2^( 7) =       0.000470144659

      target function =                  N/A
              le_mean =     -16.906374142940
             les_mean =     286.159166807105
             stat err =       0.000460425361
             autocorr =       1.270626435364
              std dev =       0.577650684118
             le_variance =       0.333680312862

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334115691440
                                         uncertainty =       0.003058409583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334115691440
                                         uncertainty =       0.003058409583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408723985
  error estimate for blocks of size 2^( 2) =       0.000421782575
  error estimate for blocks of size 2^( 3) =       0.000435236376
  error estimate for blocks of size 2^( 4) =       0.000447517495
  error estimate for blocks of size 2^( 5) =       0.000458388647
  error estimate for blocks of size 2^( 6) =       0.000466278655
  error estimate for blocks of size 2^( 7) =       0.000470343872

      target function =                  N/A
              le_mean =     -16.906373841464
             les_mean =     286.159586891711
             stat err =       0.000460632167
             autocorr =       1.270130302550
              std dev =       0.578023002494
             le_variance =       0.334110591413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334029861217
                                         uncertainty =       0.003057732787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334029861217
                                         uncertainty =       0.003057732787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408671472
  error estimate for blocks of size 2^( 2) =       0.000421732454
  error estimate for blocks of size 2^( 3) =       0.000435189135
  error estimate for blocks of size 2^( 4) =       0.000447472552
  error estimate for blocks of size 2^( 5) =       0.000458345139
  error estimate for blocks of size 2^( 6) =       0.000466238340
  error estimate for blocks of size 2^( 7) =       0.000470301454

      target function =                  N/A
              le_mean =     -16.906373411596
             les_mean =     286.159486509549
             stat err =       0.000460589371
             autocorr =       1.270220679365
              std dev =       0.577948738421
             le_variance =       0.334024744242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333739199193
                                         uncertainty =       0.003055020145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333739199193
                                         uncertainty =       0.003055020145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408493673
  error estimate for blocks of size 2^( 2) =       0.000421565780
  error estimate for blocks of size 2^( 3) =       0.000435034014
  error estimate for blocks of size 2^( 4) =       0.000447324977
  error estimate for blocks of size 2^( 5) =       0.000458205875
  error estimate for blocks of size 2^( 6) =       0.000466103436
  error estimate for blocks of size 2^( 7) =       0.000470168784

      target function =                  N/A
              le_mean =     -16.906373908563
             les_mean =     286.159212731355
             stat err =       0.000460450768
             autocorr =       1.270561625763
              std dev =       0.577697292767
             le_variance =       0.333734162070


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906374142940        initial  <--
     2.5000e-01     2.5000e+00             9.4626e-04       -16.906373841464
     1.0000e+00     1.0000e+01             2.3797e-04       -16.906373411596
     4.0000e+00     4.0000e+01             5.8389e-05       -16.906373908563

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0674
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.089679e-01 1 1  ON 0
 uu_1                 1.424420e-01 1 1  ON 1
 uu_2                 4.121123e-02 1 1  ON 2
 uu_3                -2.075372e-02 1 1  ON 3
 uu_4                -6.533852e-02 1 1  ON 4
 uu_5                -9.910983e-02 1 1  ON 5
 uu_6                -1.252855e-01 1 1  ON 6
 uu_7                -1.376785e-01 1 1  ON 7
 uu_8                -1.296083e-01 1 1  ON 8
 uu_9                -9.897760e-02 1 1  ON 9
 ud_0                 4.458556e-01 1 1  ON 10
 ud_1                 1.801410e-01 1 1  ON 11
 ud_2                 6.023786e-02 1 1  ON 12
 ud_3                -1.055099e-02 1 1  ON 13
 ud_4                -6.706161e-02 1 1  ON 14
 ud_5                -1.078578e-01 1 1  ON 15
 ud_6                -1.344810e-01 1 1  ON 16
 ud_7                -1.496129e-01 1 1  ON 17
 ud_8                -1.486733e-01 1 1  ON 18
 ud_9                -1.373983e-01 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.358408e-01 1 1  ON 21
 eO_2                -1.870196e-02 1 1  ON 22
 eO_3                 2.975847e-01 1 1  ON 23
 eO_4                 5.197876e-01 1 1  ON 24
 eO_5                 4.777834e-01 1 1  ON 25
 eO_6                 2.468220e-01 1 1  ON 26
 eO_7                -4.894684e-02 1 1  ON 27
 eO_8                -2.112025e-01 1 1  ON 28
 eO_9                -7.180992e-02 1 1  ON 29
eH1_0                -2.410919e-01 1 1  ON 30
eH1_1                -1.395224e-01 1 1  ON 31
eH1_2                -9.271612e-02 1 1  ON 32
eH1_3                -3.894797e-02 1 1  ON 33
eH1_4                 8.595704e-03 1 1  ON 34
eH1_5                 4.250139e-02 1 1  ON 35
eH1_6                 9.978909e-02 1 1  ON 36
eH1_7                 1.502497e-01 1 1  ON 37
eH1_8                 1.649093e-01 1 1  ON 38
eH1_9                 5.063253e-02 1 1  ON 39
eH2_0                -2.394262e-01 1 1  ON 40
eH2_1                -1.378768e-01 1 1  ON 41
eH2_2                -9.113668e-02 1 1  ON 42
eH2_3                -3.715623e-02 1 1  ON 43
eH2_4                 1.173408e-02 1 1  ON 44
eH2_5                 4.675465e-02 1 1  ON 45
eH2_6                 1.032623e-01 1 1  ON 46
eH2_7                 1.534699e-01 1 1  ON 47
eH2_8                 1.710920e-01 1 1  ON 48
eH2_9                 3.601778e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6985e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6882e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9257
    reference variance = 0.384757
====================================================
  Execution time = 2.3174e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4272e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5696e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342652443428
                                         uncertainty =       0.006051264576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342652443428
                                         uncertainty =       0.006051264576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413957855
  error estimate for blocks of size 2^( 2) =       0.000426936333
  error estimate for blocks of size 2^( 3) =       0.000439661489
  error estimate for blocks of size 2^( 4) =       0.000452207108
  error estimate for blocks of size 2^( 5) =       0.000462781501
  error estimate for blocks of size 2^( 6) =       0.000471064414
  error estimate for blocks of size 2^( 7) =       0.000476011001

      target function =                  N/A
              le_mean =     -16.906323188024
             les_mean =     286.166485777269
             stat err =       0.000465516006
             autocorr =       1.264611075619
              std dev =       0.585424812176
             le_variance =       0.342722210711


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690632318802e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906323188024       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906323533652       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906323570779       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906323435087       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906323414939       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906323448502       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906323402898       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906323490723       residual = 7.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 9.583886e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906323188024       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906323279275       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906323289838       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906323250375       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906323250364       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906323251661       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906323238967       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906323259092       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.399275e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906323188024       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906323211161       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906323213898       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906323203718       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906323204180       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906323202897       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906323200519       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906323205396       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 6.000307e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.008669 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8751e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.089704e-01 1 1  ON 0
 uu_1                 1.424485e-01 1 1  ON 1
 uu_2                 4.121983e-02 1 1  ON 2
 uu_3                -2.075632e-02 1 1  ON 3
 uu_4                -6.534324e-02 1 1  ON 4
 uu_5                -9.911459e-02 1 1  ON 5
 uu_6                -1.252912e-01 1 1  ON 6
 uu_7                -1.376777e-01 1 1  ON 7
 uu_8                -1.296182e-01 1 1  ON 8
 uu_9                -9.898688e-02 1 1  ON 9
 ud_0                 4.458591e-01 1 1  ON 10
 ud_1                 1.801630e-01 1 1  ON 11
 ud_2                 6.023591e-02 1 1  ON 12
 ud_3                -1.054821e-02 1 1  ON 13
 ud_4                -6.705784e-02 1 1  ON 14
 ud_5                -1.078631e-01 1 1  ON 15
 ud_6                -1.344791e-01 1 1  ON 16
 ud_7                -1.496180e-01 1 1  ON 17
 ud_8                -1.486853e-01 1 1  ON 18
 ud_9                -1.374064e-01 1 1  ON 19
 eO_0                -7.561946e-01 1 1  ON 20
 eO_1                -4.358443e-01 1 1  ON 21
 eO_2                -1.871045e-02 1 1  ON 22
 eO_3                 2.975837e-01 1 1  ON 23
 eO_4                 5.197916e-01 1 1  ON 24
 eO_5                 4.777973e-01 1 1  ON 25
 eO_6                 2.468455e-01 1 1  ON 26
 eO_7                -4.894094e-02 1 1  ON 27
 eO_8                -2.112198e-01 1 1  ON 28
 eO_9                -7.182572e-02 1 1  ON 29
eH1_0                -2.411141e-01 1 1  ON 30
eH1_1                -1.395388e-01 1 1  ON 31
eH1_2                -9.272359e-02 1 1  ON 32
eH1_3                -3.894965e-02 1 1  ON 33
eH1_4                 8.604926e-03 1 1  ON 34
eH1_5                 4.249465e-02 1 1  ON 35
eH1_6                 9.978142e-02 1 1  ON 36
eH1_7                 1.502629e-01 1 1  ON 37
eH1_8                 1.649333e-01 1 1  ON 38
eH1_9                 5.064967e-02 1 1  ON 39
eH2_0                -2.394425e-01 1 1  ON 40
eH2_1                -1.378924e-01 1 1  ON 41
eH2_2                -9.113267e-02 1 1  ON 42
eH2_3                -3.715610e-02 1 1  ON 43
eH2_4                 1.173181e-02 1 1  ON 44
eH2_5                 4.675137e-02 1 1  ON 45
eH2_6                 1.032548e-01 1 1  ON 46
eH2_7                 1.534729e-01 1 1  ON 47
eH2_8                 1.711087e-01 1 1  ON 48
eH2_9                 3.603896e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9675
    reference variance = 0.799316
====================================================
  Execution time = 2.1395e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3891e-01
  Total weights = 2.0000e+06
  Execution time = 1.8745e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338965306068
                                         uncertainty =       0.004220072697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338965306068
                                         uncertainty =       0.004220072697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411653666
  error estimate for blocks of size 2^( 2) =       0.000424663553
  error estimate for blocks of size 2^( 3) =       0.000437294782
  error estimate for blocks of size 2^( 4) =       0.000449639416
  error estimate for blocks of size 2^( 5) =       0.000460391375
  error estimate for blocks of size 2^( 6) =       0.000467442566
  error estimate for blocks of size 2^( 7) =       0.000475283298

      target function =                  N/A
              le_mean =     -16.905736579079
             les_mean =     286.142846592535
             stat err =       0.000463189164
             autocorr =       1.266055683476
              std dev =       0.582166196881
             le_variance =       0.338917480791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338952709551
                                         uncertainty =       0.004219770949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338952709551
                                         uncertainty =       0.004219770949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411646043
  error estimate for blocks of size 2^( 2) =       0.000424655129
  error estimate for blocks of size 2^( 3) =       0.000437285174
  error estimate for blocks of size 2^( 4) =       0.000449628718
  error estimate for blocks of size 2^( 5) =       0.000460380023
  error estimate for blocks of size 2^( 6) =       0.000467432677
  error estimate for blocks of size 2^( 7) =       0.000475274141

      target function =                  N/A
              le_mean =     -16.905737323766
             les_mean =     286.142859220717
             stat err =       0.000463178890
             autocorr =       1.266046403659
              std dev =       0.582155417378
             le_variance =       0.338904929983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338955932810
                                         uncertainty =       0.004219881811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338955932810
                                         uncertainty =       0.004219881811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411647989
  error estimate for blocks of size 2^( 2) =       0.000424657520
  error estimate for blocks of size 2^( 3) =       0.000437288201
  error estimate for blocks of size 2^( 4) =       0.000449632292
  error estimate for blocks of size 2^( 5) =       0.000460383869
  error estimate for blocks of size 2^( 6) =       0.000467435900
  error estimate for blocks of size 2^( 7) =       0.000475277014

      target function =                  N/A
              le_mean =     -16.905736992896
             les_mean =     286.142851237993
             stat err =       0.000463182269
             autocorr =       1.266052904555
              std dev =       0.582158169627
             le_variance =       0.338908134464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338964011594
                                         uncertainty =       0.004220047343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338964011594
                                         uncertainty =       0.004220047343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411652882
  error estimate for blocks of size 2^( 2) =       0.000424662726
  error estimate for blocks of size 2^( 3) =       0.000437293888
  error estimate for blocks of size 2^( 4) =       0.000449638453
  error estimate for blocks of size 2^( 5) =       0.000460390363
  error estimate for blocks of size 2^( 6) =       0.000467441662
  error estimate for blocks of size 2^( 7) =       0.000475282443

      target function =                  N/A
              le_mean =     -16.905736631251
             les_mean =     286.142847065605
             stat err =       0.000463188230
             autocorr =       1.266055402977
              std dev =       0.582165088133
             le_variance =       0.338916189841


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905736579079        initial
     2.5000e+00     2.5000e+01             9.5839e-05       -16.905737323766  <--
     1.0000e+01     1.0000e+02             2.3993e-05       -16.905736992896
     4.0000e+01     4.0000e+02             6.0003e-06       -16.905736631251

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 3.0825e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.089787e-01 1 1  ON 0
 uu_1                 1.424673e-01 1 1  ON 1
 uu_2                 4.124298e-02 1 1  ON 2
 uu_3                -2.076216e-02 1 1  ON 3
 uu_4                -6.535702e-02 1 1  ON 4
 uu_5                -9.912865e-02 1 1  ON 5
 uu_6                -1.253087e-01 1 1  ON 6
 uu_7                -1.376760e-01 1 1  ON 7
 uu_8                -1.296477e-01 1 1  ON 8
 uu_9                -9.901462e-02 1 1  ON 9
 ud_0                 4.458754e-01 1 1  ON 10
 ud_1                 1.802199e-01 1 1  ON 11
 ud_2                 6.023490e-02 1 1  ON 12
 ud_3                -1.054069e-02 1 1  ON 13
 ud_4                -6.704808e-02 1 1  ON 14
 ud_5                -1.078771e-01 1 1  ON 15
 ud_6                -1.344752e-01 1 1  ON 16
 ud_7                -1.496327e-01 1 1  ON 17
 ud_8                -1.487207e-01 1 1  ON 18
 ud_9                -1.374309e-01 1 1  ON 19
 eO_0                -7.561909e-01 1 1  ON 20
 eO_1                -4.358518e-01 1 1  ON 21
 eO_2                -1.873508e-02 1 1  ON 22
 eO_3                 2.975784e-01 1 1  ON 23
 eO_4                 5.198038e-01 1 1  ON 24
 eO_5                 4.778391e-01 1 1  ON 25
 eO_6                 2.469158e-01 1 1  ON 26
 eO_7                -4.892304e-02 1 1  ON 27
 eO_8                -2.112716e-01 1 1  ON 28
 eO_9                -7.187305e-02 1 1  ON 29
eH1_0                -2.411806e-01 1 1  ON 30
eH1_1                -1.395863e-01 1 1  ON 31
eH1_2                -9.274637e-02 1 1  ON 32
eH1_3                -3.895508e-02 1 1  ON 33
eH1_4                 8.631179e-03 1 1  ON 34
eH1_5                 4.247501e-02 1 1  ON 35
eH1_6                 9.975860e-02 1 1  ON 36
eH1_7                 1.503020e-01 1 1  ON 37
eH1_8                 1.650051e-01 1 1  ON 38
eH1_9                 5.070101e-02 1 1  ON 39
eH2_0                -2.394913e-01 1 1  ON 40
eH2_1                -1.379359e-01 1 1  ON 41
eH2_2                -9.112351e-02 1 1  ON 42
eH2_3                -3.715588e-02 1 1  ON 43
eH2_4                 1.172510e-02 1 1  ON 44
eH2_5                 4.674108e-02 1 1  ON 45
eH2_6                 1.032322e-01 1 1  ON 46
eH2_7                 1.534820e-01 1 1  ON 47
eH2_8                 1.711585e-01 1 1  ON 48
eH2_9                 3.610235e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0234e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8742
    reference variance = 0.19264
====================================================
  Execution time = 2.3779e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3921e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5688e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339267734545
                                         uncertainty =       0.003877823430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339267734545
                                         uncertainty =       0.003877823430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411834326
  error estimate for blocks of size 2^( 2) =       0.000424703578
  error estimate for blocks of size 2^( 3) =       0.000437594535
  error estimate for blocks of size 2^( 4) =       0.000449361085
  error estimate for blocks of size 2^( 5) =       0.000460287914
  error estimate for blocks of size 2^( 6) =       0.000467952458
  error estimate for blocks of size 2^( 7) =       0.000473276389

      target function =                  N/A
              le_mean =     -16.905760097735
             les_mean =     286.143939336939
             stat err =       0.000462719462
             autocorr =       1.262380995341
              std dev =       0.582421689489
             le_variance =       0.339215024387


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690576009773e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905760097735       residual = 7.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905765857145       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905766124280       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905766693633       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905766414608       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905766200505       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905766228273       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905766346651       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905766440108       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.661325e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905760097735       residual = 7.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905761828772       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905761968274       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905762145945       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905762054174       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905762003632       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905762012964       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905762017817       residual = 5.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 9.653282e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905760097735       residual = 7.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905760553539       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905760597084       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905760644562       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905760621155       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905760610757       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905760613327       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905760613191       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.481917e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.011531 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9357e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.090745e-01 1 1  ON 0
 uu_1                 1.424948e-01 1 1  ON 1
 uu_2                 4.125056e-02 1 1  ON 2
 uu_3                -2.075901e-02 1 1  ON 3
 uu_4                -6.537017e-02 1 1  ON 4
 uu_5                -9.918663e-02 1 1  ON 5
 uu_6                -1.253602e-01 1 1  ON 6
 uu_7                -1.377397e-01 1 1  ON 7
 uu_8                -1.296766e-01 1 1  ON 8
 uu_9                -9.902370e-02 1 1  ON 9
 ud_0                 4.459103e-01 1 1  ON 10
 ud_1                 1.802818e-01 1 1  ON 11
 ud_2                 6.023547e-02 1 1  ON 12
 ud_3                -1.052226e-02 1 1  ON 13
 ud_4                -6.706367e-02 1 1  ON 14
 ud_5                -1.078681e-01 1 1  ON 15
 ud_6                -1.344604e-01 1 1  ON 16
 ud_7                -1.496549e-01 1 1  ON 17
 ud_8                -1.487921e-01 1 1  ON 18
 ud_9                -1.374636e-01 1 1  ON 19
 eO_0                -7.561827e-01 1 1  ON 20
 eO_1                -4.358226e-01 1 1  ON 21
 eO_2                -1.877276e-02 1 1  ON 22
 eO_3                 2.975709e-01 1 1  ON 23
 eO_4                 5.198190e-01 1 1  ON 24
 eO_5                 4.778805e-01 1 1  ON 25
 eO_6                 2.469713e-01 1 1  ON 26
 eO_7                -4.892875e-02 1 1  ON 27
 eO_8                -2.113147e-01 1 1  ON 28
 eO_9                -7.192305e-02 1 1  ON 29
eH1_0                -2.412045e-01 1 1  ON 30
eH1_1                -1.396335e-01 1 1  ON 31
eH1_2                -9.273649e-02 1 1  ON 32
eH1_3                -3.896813e-02 1 1  ON 33
eH1_4                 8.603763e-03 1 1  ON 34
eH1_5                 4.251846e-02 1 1  ON 35
eH1_6                 9.969708e-02 1 1  ON 36
eH1_7                 1.502973e-01 1 1  ON 37
eH1_8                 1.650578e-01 1 1  ON 38
eH1_9                 5.076464e-02 1 1  ON 39
eH2_0                -2.395878e-01 1 1  ON 40
eH2_1                -1.379612e-01 1 1  ON 41
eH2_2                -9.111268e-02 1 1  ON 42
eH2_3                -3.714127e-02 1 1  ON 43
eH2_4                 1.169713e-02 1 1  ON 44
eH2_5                 4.668134e-02 1 1  ON 45
eH2_6                 1.032254e-01 1 1  ON 46
eH2_7                 1.535076e-01 1 1  ON 47
eH2_8                 1.712241e-01 1 1  ON 48
eH2_9                 3.619196e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9066
    reference variance = 0.179398
====================================================
  Execution time = 2.3292e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3637e-01
  Total weights = 2.0000e+06
  Execution time = 1.8777e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336348253381
                                         uncertainty =       0.003359925041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336348253381
                                         uncertainty =       0.003359925041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410085888
  error estimate for blocks of size 2^( 2) =       0.000422908592
  error estimate for blocks of size 2^( 3) =       0.000436796526
  error estimate for blocks of size 2^( 4) =       0.000449063276
  error estimate for blocks of size 2^( 5) =       0.000459710048
  error estimate for blocks of size 2^( 6) =       0.000468705672
  error estimate for blocks of size 2^( 7) =       0.000475802655

      target function =                  N/A
              le_mean =     -16.905238550399
             les_mean =     286.123431149545
             stat err =       0.000463320413
             autocorr =       1.276477662066
              std dev =       0.579949025197
             le_variance =       0.336340871827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336462884218
                                         uncertainty =       0.003361868488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336462884218
                                         uncertainty =       0.003361868488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410155724
  error estimate for blocks of size 2^( 2) =       0.000422969114
  error estimate for blocks of size 2^( 3) =       0.000436845999
  error estimate for blocks of size 2^( 4) =       0.000449108165
  error estimate for blocks of size 2^( 5) =       0.000459749164
  error estimate for blocks of size 2^( 6) =       0.000468744345
  error estimate for blocks of size 2^( 7) =       0.000475840234

      target function =                  N/A
              le_mean =     -16.905242093550
             les_mean =     286.123665508804
             stat err =       0.000463360477
             autocorr =       1.276263713772
              std dev =       0.580047787239
             le_variance =       0.336455435481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336411329684
                                         uncertainty =       0.003361053140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336411329684
                                         uncertainty =       0.003361053140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410124311
  error estimate for blocks of size 2^( 2) =       0.000422941415
  error estimate for blocks of size 2^( 3) =       0.000436822779
  error estimate for blocks of size 2^( 4) =       0.000449087058
  error estimate for blocks of size 2^( 5) =       0.000459730094
  error estimate for blocks of size 2^( 6) =       0.000468725258
  error estimate for blocks of size 2^( 7) =       0.000475821505

      target function =                  N/A
              le_mean =     -16.905240741229
             les_mean =     286.123568251926
             stat err =       0.000463340979
             autocorr =       1.276351800151
              std dev =       0.580003363123
             le_variance =       0.336403901234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336356155950
                                         uncertainty =       0.003360069645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336356155950
                                         uncertainty =       0.003360069645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410090702
  error estimate for blocks of size 2^( 2) =       0.000422912647
  error estimate for blocks of size 2^( 3) =       0.000436799690
  error estimate for blocks of size 2^( 4) =       0.000449066114
  error estimate for blocks of size 2^( 5) =       0.000459712369
  error estimate for blocks of size 2^( 6) =       0.000468707915
  error estimate for blocks of size 2^( 7) =       0.000475804794

      target function =                  N/A
              le_mean =     -16.905238818800
             les_mean =     286.123448120343
             stat err =       0.000463322798
             autocorr =       1.276460838902
              std dev =       0.579955832682
             le_variance =       0.336348767862


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905238550399        initial
     6.2500e-01     6.2500e+00             3.6613e-04       -16.905242093550  <--
     2.5000e+00     2.5000e+01             9.6533e-05       -16.905240741229
     1.0000e+01     1.0000e+02             2.4819e-05       -16.905238818800

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.2710e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.093021e-01 1 1  ON 0
 uu_1                 1.425572e-01 1 1  ON 1
 uu_2                 4.129224e-02 1 1  ON 2
 uu_3                -2.075050e-02 1 1  ON 3
 uu_4                -6.541023e-02 1 1  ON 4
 uu_5                -9.932290e-02 1 1  ON 5
 uu_6                -1.255051e-01 1 1  ON 6
 uu_7                -1.379218e-01 1 1  ON 7
 uu_8                -1.297626e-01 1 1  ON 8
 uu_9                -9.905189e-02 1 1  ON 9
 ud_0                 4.460211e-01 1 1  ON 10
 ud_1                 1.804142e-01 1 1  ON 11
 ud_2                 6.026317e-02 1 1  ON 12
 ud_3                -1.048012e-02 1 1  ON 13
 ud_4                -6.708310e-02 1 1  ON 14
 ud_5                -1.078437e-01 1 1  ON 15
 ud_6                -1.344419e-01 1 1  ON 16
 ud_7                -1.497069e-01 1 1  ON 17
 ud_8                -1.489864e-01 1 1  ON 18
 ud_9                -1.375598e-01 1 1  ON 19
 eO_0                -7.561818e-01 1 1  ON 20
 eO_1                -4.357480e-01 1 1  ON 21
 eO_2                -1.884296e-02 1 1  ON 22
 eO_3                 2.975376e-01 1 1  ON 23
 eO_4                 5.198632e-01 1 1  ON 24
 eO_5                 4.780082e-01 1 1  ON 25
 eO_6                 2.471390e-01 1 1  ON 26
 eO_7                -4.894032e-02 1 1  ON 27
 eO_8                -2.114442e-01 1 1  ON 28
 eO_9                -7.207653e-02 1 1  ON 29
eH1_0                -2.412919e-01 1 1  ON 30
eH1_1                -1.397496e-01 1 1  ON 31
eH1_2                -9.273998e-02 1 1  ON 32
eH1_3                -3.898561e-02 1 1  ON 33
eH1_4                 8.526681e-03 1 1  ON 34
eH1_5                 4.261849e-02 1 1  ON 35
eH1_6                 9.952384e-02 1 1  ON 36
eH1_7                 1.502885e-01 1 1  ON 37
eH1_8                 1.652204e-01 1 1  ON 38
eH1_9                 5.096063e-02 1 1  ON 39
eH2_0                -2.398574e-01 1 1  ON 40
eH2_1                -1.380382e-01 1 1  ON 41
eH2_2                -9.110387e-02 1 1  ON 42
eH2_3                -3.711917e-02 1 1  ON 43
eH2_4                 1.161985e-02 1 1  ON 44
eH2_5                 4.651558e-02 1 1  ON 45
eH2_6                 1.032027e-01 1 1  ON 46
eH2_7                 1.535802e-01 1 1  ON 47
eH2_8                 1.714249e-01 1 1  ON 48
eH2_9                 3.646834e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.2666e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9056
    reference variance = 0.158564
====================================================
  Execution time = 2.2067e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4411e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5476e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344250035713
                                         uncertainty =       0.004763311791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344250035713
                                         uncertainty =       0.004763311791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414794371
  error estimate for blocks of size 2^( 2) =       0.000427432161
  error estimate for blocks of size 2^( 3) =       0.000440993814
  error estimate for blocks of size 2^( 4) =       0.000454158574
  error estimate for blocks of size 2^( 5) =       0.000462849058
  error estimate for blocks of size 2^( 6) =       0.000470911043
  error estimate for blocks of size 2^( 7) =       0.000475939466

      target function =                  N/A
              le_mean =     -16.906651387922
             les_mean =     286.178969720783
             stat err =       0.000465964535
             autocorr =       1.261943814017
              std dev =       0.586607824786
             le_variance =       0.344108740100


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690665138792e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906651387922       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906652218950       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906654998456       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906654509445       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906654392350       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906656122674       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906655921119       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906655295013       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906656160050       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906656253099       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906656413992       residual = 8.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.278296e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906651387922       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906651740300       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906652637086       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906652518669       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906652686856       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906652924530       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906652901248       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906652773255       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906652921743       residual = 2.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.337897e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906651387922       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906651494578       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906651732791       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906651726267       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906651801422       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906651836785       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906651807484       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906651812348       residual = 9.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.432127e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.019877 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7630e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.093992e-01 1 1  ON 0
 uu_1                 1.426874e-01 1 1  ON 1
 uu_2                 4.137165e-02 1 1  ON 2
 uu_3                -2.066305e-02 1 1  ON 3
 uu_4                -6.532595e-02 1 1  ON 4
 uu_5                -9.942791e-02 1 1  ON 5
 uu_6                -1.255865e-01 1 1  ON 6
 uu_7                -1.381693e-01 1 1  ON 7
 uu_8                -1.299478e-01 1 1  ON 8
 uu_9                -9.928403e-02 1 1  ON 9
 ud_0                 4.460597e-01 1 1  ON 10
 ud_1                 1.805764e-01 1 1  ON 11
 ud_2                 6.036623e-02 1 1  ON 12
 ud_3                -1.040785e-02 1 1  ON 13
 ud_4                -6.700412e-02 1 1  ON 14
 ud_5                -1.077702e-01 1 1  ON 15
 ud_6                -1.343000e-01 1 1  ON 16
 ud_7                -1.497605e-01 1 1  ON 17
 ud_8                -1.492597e-01 1 1  ON 18
 ud_9                -1.377561e-01 1 1  ON 19
 eO_0                -7.562833e-01 1 1  ON 20
 eO_1                -4.356772e-01 1 1  ON 21
 eO_2                -1.892502e-02 1 1  ON 22
 eO_3                 2.975649e-01 1 1  ON 23
 eO_4                 5.198870e-01 1 1  ON 24
 eO_5                 4.782030e-01 1 1  ON 25
 eO_6                 2.474728e-01 1 1  ON 26
 eO_7                -4.885053e-02 1 1  ON 27
 eO_8                -2.117143e-01 1 1  ON 28
 eO_9                -7.232316e-02 1 1  ON 29
eH1_0                -2.415477e-01 1 1  ON 30
eH1_1                -1.399481e-01 1 1  ON 31
eH1_2                -9.286670e-02 1 1  ON 32
eH1_3                -3.914973e-02 1 1  ON 33
eH1_4                 8.495320e-03 1 1  ON 34
eH1_5                 4.270298e-02 1 1  ON 35
eH1_6                 9.944002e-02 1 1  ON 36
eH1_7                 1.504357e-01 1 1  ON 37
eH1_8                 1.655061e-01 1 1  ON 38
eH1_9                 5.126050e-02 1 1  ON 39
eH2_0                -2.400351e-01 1 1  ON 40
eH2_1                -1.382219e-01 1 1  ON 41
eH2_2                -9.107710e-02 1 1  ON 42
eH2_3                -3.725478e-02 1 1  ON 43
eH2_4                 1.148676e-02 1 1  ON 44
eH2_5                 4.645172e-02 1 1  ON 45
eH2_6                 1.032130e-01 1 1  ON 46
eH2_7                 1.536407e-01 1 1  ON 47
eH2_8                 1.716962e-01 1 1  ON 48
eH2_9                 3.679138e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9593
    reference variance = 0.421647
====================================================
  Execution time = 2.1217e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3971e-01
  Total weights = 2.0000e+06
  Execution time = 1.8795e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339760873275
                                         uncertainty =       0.003303832198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339760873275
                                         uncertainty =       0.003303832198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412177473
  error estimate for blocks of size 2^( 2) =       0.000425234956
  error estimate for blocks of size 2^( 3) =       0.000438448627
  error estimate for blocks of size 2^( 4) =       0.000451566067
  error estimate for blocks of size 2^( 5) =       0.000461774445
  error estimate for blocks of size 2^( 6) =       0.000468724693
  error estimate for blocks of size 2^( 7) =       0.000473975407

      target function =                  N/A
              le_mean =     -16.907494063405
             les_mean =     286.203135871969
             stat err =       0.000464010153
             autocorr =       1.267320507589
              std dev =       0.582906971809
             le_variance =       0.339780537784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339653982900
                                         uncertainty =       0.003303017680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339653982900
                                         uncertainty =       0.003303017680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412112660
  error estimate for blocks of size 2^( 2) =       0.000425167031
  error estimate for blocks of size 2^( 3) =       0.000438376859
  error estimate for blocks of size 2^( 4) =       0.000451489991
  error estimate for blocks of size 2^( 5) =       0.000461692648
  error estimate for blocks of size 2^( 6) =       0.000468642931
  error estimate for blocks of size 2^( 7) =       0.000473914750

      target function =                  N/A
              le_mean =     -16.907492990950
             les_mean =     286.202992758187
             stat err =       0.000463935080
             autocorr =       1.267308981084
              std dev =       0.582815312940
             le_variance =       0.339673688997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339611844046
                                         uncertainty =       0.003302746073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339611844046
                                         uncertainty =       0.003302746073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412087074
  error estimate for blocks of size 2^( 2) =       0.000425144301
  error estimate for blocks of size 2^( 3) =       0.000438357963
  error estimate for blocks of size 2^( 4) =       0.000451474627
  error estimate for blocks of size 2^( 5) =       0.000461679965
  error estimate for blocks of size 2^( 6) =       0.000468631210
  error estimate for blocks of size 2^( 7) =       0.000473903191

      target function =                  N/A
              le_mean =     -16.907493757815
             les_mean =     286.202976513534
             stat err =       0.000463922248
             autocorr =       1.267396248382
              std dev =       0.582779128642
             le_variance =       0.339631512781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339724435500
                                         uncertainty =       0.003303555916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339724435500
                                         uncertainty =       0.003303555916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412155372
  error estimate for blocks of size 2^( 2) =       0.000425213167
  error estimate for blocks of size 2^( 3) =       0.000438427212
  error estimate for blocks of size 2^( 4) =       0.000451544781
  error estimate for blocks of size 2^( 5) =       0.000461752871
  error estimate for blocks of size 2^( 6) =       0.000468703386
  error estimate for blocks of size 2^( 7) =       0.000473957651

      target function =                  N/A
              le_mean =     -16.907493966412
             les_mean =     286.203096155831
             stat err =       0.000463989672
             autocorr =       1.267344538694
              std dev =       0.582875716992
             le_variance =       0.339744101459


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907494063405        initial  <--
     1.5625e-01     1.5625e+00             1.2783e-03       -16.907492990950
     6.2500e-01     6.2500e+00             3.3379e-04       -16.907493757815
     2.5000e+00     2.5000e+01             8.4321e-05       -16.907493966412

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5937
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.093021e-01 1 1  ON 0
 uu_1                 1.425572e-01 1 1  ON 1
 uu_2                 4.129224e-02 1 1  ON 2
 uu_3                -2.075050e-02 1 1  ON 3
 uu_4                -6.541023e-02 1 1  ON 4
 uu_5                -9.932290e-02 1 1  ON 5
 uu_6                -1.255051e-01 1 1  ON 6
 uu_7                -1.379218e-01 1 1  ON 7
 uu_8                -1.297626e-01 1 1  ON 8
 uu_9                -9.905189e-02 1 1  ON 9
 ud_0                 4.460211e-01 1 1  ON 10
 ud_1                 1.804142e-01 1 1  ON 11
 ud_2                 6.026317e-02 1 1  ON 12
 ud_3                -1.048012e-02 1 1  ON 13
 ud_4                -6.708310e-02 1 1  ON 14
 ud_5                -1.078437e-01 1 1  ON 15
 ud_6                -1.344419e-01 1 1  ON 16
 ud_7                -1.497069e-01 1 1  ON 17
 ud_8                -1.489864e-01 1 1  ON 18
 ud_9                -1.375598e-01 1 1  ON 19
 eO_0                -7.561818e-01 1 1  ON 20
 eO_1                -4.357480e-01 1 1  ON 21
 eO_2                -1.884296e-02 1 1  ON 22
 eO_3                 2.975376e-01 1 1  ON 23
 eO_4                 5.198632e-01 1 1  ON 24
 eO_5                 4.780082e-01 1 1  ON 25
 eO_6                 2.471390e-01 1 1  ON 26
 eO_7                -4.894032e-02 1 1  ON 27
 eO_8                -2.114442e-01 1 1  ON 28
 eO_9                -7.207653e-02 1 1  ON 29
eH1_0                -2.412919e-01 1 1  ON 30
eH1_1                -1.397496e-01 1 1  ON 31
eH1_2                -9.273998e-02 1 1  ON 32
eH1_3                -3.898561e-02 1 1  ON 33
eH1_4                 8.526681e-03 1 1  ON 34
eH1_5                 4.261849e-02 1 1  ON 35
eH1_6                 9.952384e-02 1 1  ON 36
eH1_7                 1.502885e-01 1 1  ON 37
eH1_8                 1.652204e-01 1 1  ON 38
eH1_9                 5.096063e-02 1 1  ON 39
eH2_0                -2.398574e-01 1 1  ON 40
eH2_1                -1.380382e-01 1 1  ON 41
eH2_2                -9.110387e-02 1 1  ON 42
eH2_3                -3.711917e-02 1 1  ON 43
eH2_4                 1.161985e-02 1 1  ON 44
eH2_5                 4.651558e-02 1 1  ON 45
eH2_6                 1.032027e-01 1 1  ON 46
eH2_7                 1.535802e-01 1 1  ON 47
eH2_8                 1.714249e-01 1 1  ON 48
eH2_9                 3.646834e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8382e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9099
    reference variance = 0.244442
====================================================
  Execution time = 2.1779e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4397e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6419e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344043501571
                                         uncertainty =       0.007613736596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344043501571
                                         uncertainty =       0.007613736596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414708604
  error estimate for blocks of size 2^( 2) =       0.000427216984
  error estimate for blocks of size 2^( 3) =       0.000439672296
  error estimate for blocks of size 2^( 4) =       0.000451626668
  error estimate for blocks of size 2^( 5) =       0.000461825782
  error estimate for blocks of size 2^( 6) =       0.000471471067
  error estimate for blocks of size 2^( 7) =       0.000479109975

      target function =                  N/A
              le_mean =     -16.905597842919
             les_mean =     286.143204707782
             stat err =       0.000466008373
             autocorr =       1.262703391688
              std dev =       0.586486532888
             le_variance =       0.343966453259


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690559784292e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905597842919       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905598752728       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905599372368       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905599198741       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905598771953       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905598444247       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905598662057       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905598723338       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905598772260       residual = 2.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.917355e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905597842919       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905598090795       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905598272034       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905598219456       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905598097906       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905598009023       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905598056578       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905598058274       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905598073592       residual = 1.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 5.378857e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905597842919       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905597906311       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905597953565       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905597939846       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905597907940       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905597885708       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905597896965       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905597896788       residual = 8.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.412484e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.022868 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7427e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.093175e-01 1 1  ON 0
 uu_1                 1.425673e-01 1 1  ON 1
 uu_2                 4.128269e-02 1 1  ON 2
 uu_3                -2.075090e-02 1 1  ON 3
 uu_4                -6.539876e-02 1 1  ON 4
 uu_5                -9.931330e-02 1 1  ON 5
 uu_6                -1.255190e-01 1 1  ON 6
 uu_7                -1.379257e-01 1 1  ON 7
 uu_8                -1.297933e-01 1 1  ON 8
 uu_9                -9.906752e-02 1 1  ON 9
 ud_0                 4.460749e-01 1 1  ON 10
 ud_1                 1.804279e-01 1 1  ON 11
 ud_2                 6.027584e-02 1 1  ON 12
 ud_3                -1.048661e-02 1 1  ON 13
 ud_4                -6.708569e-02 1 1  ON 14
 ud_5                -1.078580e-01 1 1  ON 15
 ud_6                -1.344419e-01 1 1  ON 16
 ud_7                -1.497234e-01 1 1  ON 17
 ud_8                -1.490281e-01 1 1  ON 18
 ud_9                -1.375666e-01 1 1  ON 19
 eO_0                -7.561933e-01 1 1  ON 20
 eO_1                -4.357349e-01 1 1  ON 21
 eO_2                -1.884178e-02 1 1  ON 22
 eO_3                 2.975235e-01 1 1  ON 23
 eO_4                 5.198836e-01 1 1  ON 24
 eO_5                 4.780192e-01 1 1  ON 25
 eO_6                 2.471645e-01 1 1  ON 26
 eO_7                -4.893606e-02 1 1  ON 27
 eO_8                -2.114711e-01 1 1  ON 28
 eO_9                -7.209657e-02 1 1  ON 29
eH1_0                -2.413146e-01 1 1  ON 30
eH1_1                -1.397633e-01 1 1  ON 31
eH1_2                -9.276071e-02 1 1  ON 32
eH1_3                -3.898704e-02 1 1  ON 33
eH1_4                 8.543568e-03 1 1  ON 34
eH1_5                 4.261840e-02 1 1  ON 35
eH1_6                 9.951794e-02 1 1  ON 36
eH1_7                 1.502918e-01 1 1  ON 37
eH1_8                 1.652363e-01 1 1  ON 38
eH1_9                 5.098521e-02 1 1  ON 39
eH2_0                -2.398925e-01 1 1  ON 40
eH2_1                -1.380525e-01 1 1  ON 41
eH2_2                -9.110277e-02 1 1  ON 42
eH2_3                -3.711250e-02 1 1  ON 43
eH2_4                 1.161026e-02 1 1  ON 44
eH2_5                 4.651068e-02 1 1  ON 45
eH2_6                 1.031981e-01 1 1  ON 46
eH2_7                 1.535803e-01 1 1  ON 47
eH2_8                 1.714484e-01 1 1  ON 48
eH2_9                 3.650452e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9628
    reference variance = 0.494291
====================================================
  Execution time = 2.0722e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3551e-01
  Total weights = 2.0000e+06
  Execution time = 1.8770e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335458579872
                                         uncertainty =       0.004218973601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335458579872
                                         uncertainty =       0.004218973601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409548938
  error estimate for blocks of size 2^( 2) =       0.000422534789
  error estimate for blocks of size 2^( 3) =       0.000435739037
  error estimate for blocks of size 2^( 4) =       0.000447707576
  error estimate for blocks of size 2^( 5) =       0.000457809378
  error estimate for blocks of size 2^( 6) =       0.000465691735
  error estimate for blocks of size 2^( 7) =       0.000470031720

      target function =                  N/A
              le_mean =     -16.906165313275
             les_mean =     286.153886097247
             stat err =       0.000460310102
             autocorr =       1.263250284740
              std dev =       0.579189662534
             le_variance =       0.335460665186

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335612194699
                                         uncertainty =       0.004220861089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335612194699
                                         uncertainty =       0.004220861089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409642720
  error estimate for blocks of size 2^( 2) =       0.000422623058
  error estimate for blocks of size 2^( 3) =       0.000435821555
  error estimate for blocks of size 2^( 4) =       0.000447785019
  error estimate for blocks of size 2^( 5) =       0.000457886348
  error estimate for blocks of size 2^( 6) =       0.000465766307
  error estimate for blocks of size 2^( 7) =       0.000470103599

      target function =                  N/A
              le_mean =     -16.906164887548
             les_mean =     286.154025353221
             stat err =       0.000460385318
             autocorr =       1.263084625391
              std dev =       0.579322290322
             le_variance =       0.335614316063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335548015974
                                         uncertainty =       0.004220099817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335548015974
                                         uncertainty =       0.004220099817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409603542
  error estimate for blocks of size 2^( 2) =       0.000422586265
  error estimate for blocks of size 2^( 3) =       0.000435787292
  error estimate for blocks of size 2^( 4) =       0.000447752992
  error estimate for blocks of size 2^( 5) =       0.000457854647
  error estimate for blocks of size 2^( 6) =       0.000465735577
  error estimate for blocks of size 2^( 7) =       0.000470073959

      target function =                  N/A
              le_mean =     -16.906165037152
             les_mean =     286.153966219002
             stat err =       0.000460354293
             autocorr =       1.263155998246
              std dev =       0.579266884386
             le_variance =       0.335550123346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335470349054
                                         uncertainty =       0.004219126265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335470349054
                                         uncertainty =       0.004219126265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409556124
  error estimate for blocks of size 2^( 2) =       0.000422541572
  error estimate for blocks of size 2^( 3) =       0.000435745404
  error estimate for blocks of size 2^( 4) =       0.000447713580
  error estimate for blocks of size 2^( 5) =       0.000457815384
  error estimate for blocks of size 2^( 6) =       0.000465697548
  error estimate for blocks of size 2^( 7) =       0.000470037328

      target function =                  N/A
              le_mean =     -16.906165276609
             les_mean =     286.153896629656
             stat err =       0.000460315960
             autocorr =       1.263238106467
              std dev =       0.579199825067
             le_variance =       0.335472437357


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906165313275        initial  <--
     1.5625e+00     1.5625e+01             1.9174e-04       -16.906164887548
     6.2500e+00     6.2500e+01             5.3789e-05       -16.906165037152
     2.5000e+01     2.5000e+02             1.4125e-05       -16.906165276609

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1266
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.093021e-01 1 1  ON 0
 uu_1                 1.425572e-01 1 1  ON 1
 uu_2                 4.129224e-02 1 1  ON 2
 uu_3                -2.075050e-02 1 1  ON 3
 uu_4                -6.541023e-02 1 1  ON 4
 uu_5                -9.932290e-02 1 1  ON 5
 uu_6                -1.255051e-01 1 1  ON 6
 uu_7                -1.379218e-01 1 1  ON 7
 uu_8                -1.297626e-01 1 1  ON 8
 uu_9                -9.905189e-02 1 1  ON 9
 ud_0                 4.460211e-01 1 1  ON 10
 ud_1                 1.804142e-01 1 1  ON 11
 ud_2                 6.026317e-02 1 1  ON 12
 ud_3                -1.048012e-02 1 1  ON 13
 ud_4                -6.708310e-02 1 1  ON 14
 ud_5                -1.078437e-01 1 1  ON 15
 ud_6                -1.344419e-01 1 1  ON 16
 ud_7                -1.497069e-01 1 1  ON 17
 ud_8                -1.489864e-01 1 1  ON 18
 ud_9                -1.375598e-01 1 1  ON 19
 eO_0                -7.561818e-01 1 1  ON 20
 eO_1                -4.357480e-01 1 1  ON 21
 eO_2                -1.884296e-02 1 1  ON 22
 eO_3                 2.975376e-01 1 1  ON 23
 eO_4                 5.198632e-01 1 1  ON 24
 eO_5                 4.780082e-01 1 1  ON 25
 eO_6                 2.471390e-01 1 1  ON 26
 eO_7                -4.894032e-02 1 1  ON 27
 eO_8                -2.114442e-01 1 1  ON 28
 eO_9                -7.207653e-02 1 1  ON 29
eH1_0                -2.412919e-01 1 1  ON 30
eH1_1                -1.397496e-01 1 1  ON 31
eH1_2                -9.273998e-02 1 1  ON 32
eH1_3                -3.898561e-02 1 1  ON 33
eH1_4                 8.526681e-03 1 1  ON 34
eH1_5                 4.261849e-02 1 1  ON 35
eH1_6                 9.952384e-02 1 1  ON 36
eH1_7                 1.502885e-01 1 1  ON 37
eH1_8                 1.652204e-01 1 1  ON 38
eH1_9                 5.096063e-02 1 1  ON 39
eH2_0                -2.398574e-01 1 1  ON 40
eH2_1                -1.380382e-01 1 1  ON 41
eH2_2                -9.110387e-02 1 1  ON 42
eH2_3                -3.711917e-02 1 1  ON 43
eH2_4                 1.161985e-02 1 1  ON 44
eH2_5                 4.651558e-02 1 1  ON 45
eH2_6                 1.032027e-01 1 1  ON 46
eH2_7                 1.535802e-01 1 1  ON 47
eH2_8                 1.714249e-01 1 1  ON 48
eH2_9                 3.646834e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7564e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8736
    reference variance = 0.203784
====================================================
  Execution time = 2.0310e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4342e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5886e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343521695114
                                         uncertainty =       0.008277120903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343521695114
                                         uncertainty =       0.008277120903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414377712
  error estimate for blocks of size 2^( 2) =       0.000426421442
  error estimate for blocks of size 2^( 3) =       0.000439079090
  error estimate for blocks of size 2^( 4) =       0.000451605289
  error estimate for blocks of size 2^( 5) =       0.000462067902
  error estimate for blocks of size 2^( 6) =       0.000469807068
  error estimate for blocks of size 2^( 7) =       0.000474381875

      target function =                  N/A
              le_mean =     -16.907226246137
             les_mean =     286.197716942310
             stat err =       0.000464465533
             autocorr =       1.256360309442
              std dev =       0.586018579882
             le_variance =       0.343417775967


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690722624614e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907226246137       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907226282216       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907226264867       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907226258817       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907226285457       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907226274163       residual = 9.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907226272624       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907226275963       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.361076e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907226246137       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907226255234       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907226250720       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907226249300       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907226255911       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907226253049       residual = 9.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907226252615       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907226253391       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 3.407462e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907226246137       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907226248416       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907226247276       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907226246927       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907226248577       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907226247858       residual = 9.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907226247747       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907226247937       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 8.521696e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.025537 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5905e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.093003e-01 1 1  ON 0
 uu_1                 1.425575e-01 1 1  ON 1
 uu_2                 4.129225e-02 1 1  ON 2
 uu_3                -2.074969e-02 1 1  ON 3
 uu_4                -6.541184e-02 1 1  ON 4
 uu_5                -9.932131e-02 1 1  ON 5
 uu_6                -1.255053e-01 1 1  ON 6
 uu_7                -1.379229e-01 1 1  ON 7
 uu_8                -1.297638e-01 1 1  ON 8
 uu_9                -9.905271e-02 1 1  ON 9
 ud_0                 4.460212e-01 1 1  ON 10
 ud_1                 1.804165e-01 1 1  ON 11
 ud_2                 6.026374e-02 1 1  ON 12
 ud_3                -1.047978e-02 1 1  ON 13
 ud_4                -6.708225e-02 1 1  ON 14
 ud_5                -1.078446e-01 1 1  ON 15
 ud_6                -1.344419e-01 1 1  ON 16
 ud_7                -1.497073e-01 1 1  ON 17
 ud_8                -1.489888e-01 1 1  ON 18
 ud_9                -1.375602e-01 1 1  ON 19
 eO_0                -7.561836e-01 1 1  ON 20
 eO_1                -4.357459e-01 1 1  ON 21
 eO_2                -1.884349e-02 1 1  ON 22
 eO_3                 2.975364e-01 1 1  ON 23
 eO_4                 5.198643e-01 1 1  ON 24
 eO_5                 4.780087e-01 1 1  ON 25
 eO_6                 2.471421e-01 1 1  ON 26
 eO_7                -4.893973e-02 1 1  ON 27
 eO_8                -2.114460e-01 1 1  ON 28
 eO_9                -7.207842e-02 1 1  ON 29
eH1_0                -2.412953e-01 1 1  ON 30
eH1_1                -1.397514e-01 1 1  ON 31
eH1_2                -9.274020e-02 1 1  ON 32
eH1_3                -3.898803e-02 1 1  ON 33
eH1_4                 8.528227e-03 1 1  ON 34
eH1_5                 4.261985e-02 1 1  ON 35
eH1_6                 9.952336e-02 1 1  ON 36
eH1_7                 1.502888e-01 1 1  ON 37
eH1_8                 1.652227e-01 1 1  ON 38
eH1_9                 5.096333e-02 1 1  ON 39
eH2_0                -2.398594e-01 1 1  ON 40
eH2_1                -1.380390e-01 1 1  ON 41
eH2_2                -9.110428e-02 1 1  ON 42
eH2_3                -3.711908e-02 1 1  ON 43
eH2_4                 1.161756e-02 1 1  ON 44
eH2_5                 4.651384e-02 1 1  ON 45
eH2_6                 1.032018e-01 1 1  ON 46
eH2_7                 1.535818e-01 1 1  ON 47
eH2_8                 1.714277e-01 1 1  ON 48
eH2_9                 3.647169e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.898
    reference variance = 0.144335
====================================================
  Execution time = 2.0469e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3335e-01
  Total weights = 2.0000e+06
  Execution time = 1.8636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333356502374
                                         uncertainty =       0.002806279464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333356502374
                                         uncertainty =       0.002806279464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408260779
  error estimate for blocks of size 2^( 2) =       0.000421421156
  error estimate for blocks of size 2^( 3) =       0.000434914423
  error estimate for blocks of size 2^( 4) =       0.000447498132
  error estimate for blocks of size 2^( 5) =       0.000459092369
  error estimate for blocks of size 2^( 6) =       0.000466193133
  error estimate for blocks of size 2^( 7) =       0.000470752412

      target function =                  N/A
              le_mean =     -16.905457720754
             les_mean =     286.127854309067
             stat err =       0.000460884011
             autocorr =       1.274406460525
              std dev =       0.577367930815
             le_variance =       0.333353727533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333351363369
                                         uncertainty =       0.002806239127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333351363369
                                         uncertainty =       0.002806239127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408257631
  error estimate for blocks of size 2^( 2) =       0.000421418111
  error estimate for blocks of size 2^( 3) =       0.000434911330
  error estimate for blocks of size 2^( 4) =       0.000447495096
  error estimate for blocks of size 2^( 5) =       0.000459089353
  error estimate for blocks of size 2^( 6) =       0.000466190566
  error estimate for blocks of size 2^( 7) =       0.000470750211

      target function =                  N/A
              le_mean =     -16.905457739593
             les_mean =     286.127849805027
             stat err =       0.000460881307
             autocorr =       1.274411156022
              std dev =       0.577363478708
             le_variance =       0.333348586546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333353843971
                                         uncertainty =       0.002806258522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333353843971
                                         uncertainty =       0.002806258522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408259151
  error estimate for blocks of size 2^( 2) =       0.000421419582
  error estimate for blocks of size 2^( 3) =       0.000434912826
  error estimate for blocks of size 2^( 4) =       0.000447496566
  error estimate for blocks of size 2^( 5) =       0.000459090814
  error estimate for blocks of size 2^( 6) =       0.000466191805
  error estimate for blocks of size 2^( 7) =       0.000470751271

      target function =                  N/A
              le_mean =     -16.905457730202
             les_mean =     286.127851969103
             stat err =       0.000460882614
             autocorr =       1.274408898460
              std dev =       0.577365627764
             le_variance =       0.333351068123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333356167105
                                         uncertainty =       0.002806276821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333356167105
                                         uncertainty =       0.002806276821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408260574
  error estimate for blocks of size 2^( 2) =       0.000421420957
  error estimate for blocks of size 2^( 3) =       0.000434914221
  error estimate for blocks of size 2^( 4) =       0.000447497935
  error estimate for blocks of size 2^( 5) =       0.000459092173
  error estimate for blocks of size 2^( 6) =       0.000466192965
  error estimate for blocks of size 2^( 7) =       0.000470752268

      target function =                  N/A
              le_mean =     -16.905457721923
             les_mean =     286.127854013178
             stat err =       0.000460883835
             autocorr =       1.274406768158
              std dev =       0.577367640362
             le_variance =       0.333353392138


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905457720754        initial
     1.5625e+01     1.5625e+02             1.3611e-05       -16.905457739593  <--
     6.2500e+01     6.2500e+02             3.4075e-06       -16.905457730202
     2.5000e+02     2.5000e+03             8.5217e-07       -16.905457721923

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 2.9884e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.092950e-01 1 1  ON 0
 uu_1                 1.425583e-01 1 1  ON 1
 uu_2                 4.129228e-02 1 1  ON 2
 uu_3                -2.074734e-02 1 1  ON 3
 uu_4                -6.541654e-02 1 1  ON 4
 uu_5                -9.931668e-02 1 1  ON 5
 uu_6                -1.255059e-01 1 1  ON 6
 uu_7                -1.379262e-01 1 1  ON 7
 uu_8                -1.297673e-01 1 1  ON 8
 uu_9                -9.905520e-02 1 1  ON 9
 ud_0                 4.460215e-01 1 1  ON 10
 ud_1                 1.804232e-01 1 1  ON 11
 ud_2                 6.026551e-02 1 1  ON 12
 ud_3                -1.047874e-02 1 1  ON 13
 ud_4                -6.707978e-02 1 1  ON 14
 ud_5                -1.078471e-01 1 1  ON 15
 ud_6                -1.344417e-01 1 1  ON 16
 ud_7                -1.497083e-01 1 1  ON 17
 ud_8                -1.489957e-01 1 1  ON 18
 ud_9                -1.375616e-01 1 1  ON 19
 eO_0                -7.561890e-01 1 1  ON 20
 eO_1                -4.357395e-01 1 1  ON 21
 eO_2                -1.884503e-02 1 1  ON 22
 eO_3                 2.975330e-01 1 1  ON 23
 eO_4                 5.198677e-01 1 1  ON 24
 eO_5                 4.780103e-01 1 1  ON 25
 eO_6                 2.471511e-01 1 1  ON 26
 eO_7                -4.893795e-02 1 1  ON 27
 eO_8                -2.114513e-01 1 1  ON 28
 eO_9                -7.208412e-02 1 1  ON 29
eH1_0                -2.413055e-01 1 1  ON 30
eH1_1                -1.397567e-01 1 1  ON 31
eH1_2                -9.274088e-02 1 1  ON 32
eH1_3                -3.899523e-02 1 1  ON 33
eH1_4                 8.532803e-03 1 1  ON 34
eH1_5                 4.262393e-02 1 1  ON 35
eH1_6                 9.952194e-02 1 1  ON 36
eH1_7                 1.502898e-01 1 1  ON 37
eH1_8                 1.652297e-01 1 1  ON 38
eH1_9                 5.097144e-02 1 1  ON 39
eH2_0                -2.398651e-01 1 1  ON 40
eH2_1                -1.380414e-01 1 1  ON 41
eH2_2                -9.110549e-02 1 1  ON 42
eH2_3                -3.711886e-02 1 1  ON 43
eH2_4                 1.161077e-02 1 1  ON 44
eH2_5                 4.650861e-02 1 1  ON 45
eH2_6                 1.031991e-01 1 1  ON 46
eH2_7                 1.535866e-01 1 1  ON 47
eH2_8                 1.714361e-01 1 1  ON 48
eH2_9                 3.648172e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5799e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9638
    reference variance = 0.204557
====================================================
  Execution time = 2.1251e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3379e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5357e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333800489177
                                         uncertainty =       0.003555735032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333800489177
                                         uncertainty =       0.003555735032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408525285
  error estimate for blocks of size 2^( 2) =       0.000421230515
  error estimate for blocks of size 2^( 3) =       0.000434164532
  error estimate for blocks of size 2^( 4) =       0.000446479244
  error estimate for blocks of size 2^( 5) =       0.000457638334
  error estimate for blocks of size 2^( 6) =       0.000465735173
  error estimate for blocks of size 2^( 7) =       0.000473120528

      target function =                  N/A
              le_mean =     -16.906295047480
             les_mean =     286.156597882873
             stat err =       0.000460743320
             autocorr =       1.271979790667
              std dev =       0.577741998913
             le_variance =       0.333785817308


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690629504748e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906295047480       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906295228794       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906295435099       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906295470741       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906295612253       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906295639867       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906295610785       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906295635767       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906295633712       residual = 1.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 6.390143e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906295047480       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906295094280       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906295146096       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906295155536       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906295192801       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906295199922       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906295192240       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906295198390       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906295198121       residual = 1.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.616494e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906295047480       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906295059276       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906295072242       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906295074638       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906295084079       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906295085873       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906295083926       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906295085458       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906295085409       residual = 1.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 4.053519e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.028692 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6793e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.093016e-01 1 1  ON 0
 uu_1                 1.425673e-01 1 1  ON 1
 uu_2                 4.129472e-02 1 1  ON 2
 uu_3                -2.074387e-02 1 1  ON 3
 uu_4                -6.541488e-02 1 1  ON 4
 uu_5                -9.931857e-02 1 1  ON 5
 uu_6                -1.255115e-01 1 1  ON 6
 uu_7                -1.379338e-01 1 1  ON 7
 uu_8                -1.297794e-01 1 1  ON 8
 uu_9                -9.906505e-02 1 1  ON 9
 ud_0                 4.460285e-01 1 1  ON 10
 ud_1                 1.804327e-01 1 1  ON 11
 ud_2                 6.026922e-02 1 1  ON 12
 ud_3                -1.047767e-02 1 1  ON 13
 ud_4                -6.707411e-02 1 1  ON 14
 ud_5                -1.078492e-01 1 1  ON 15
 ud_6                -1.344318e-01 1 1  ON 16
 ud_7                -1.497102e-01 1 1  ON 17
 ud_8                -1.490119e-01 1 1  ON 18
 ud_9                -1.375714e-01 1 1  ON 19
 eO_0                -7.561886e-01 1 1  ON 20
 eO_1                -4.357349e-01 1 1  ON 21
 eO_2                -1.884614e-02 1 1  ON 22
 eO_3                 2.975332e-01 1 1  ON 23
 eO_4                 5.198656e-01 1 1  ON 24
 eO_5                 4.780187e-01 1 1  ON 25
 eO_6                 2.471644e-01 1 1  ON 26
 eO_7                -4.893715e-02 1 1  ON 27
 eO_8                -2.114643e-01 1 1  ON 28
 eO_9                -7.209444e-02 1 1  ON 29
eH1_0                -2.413161e-01 1 1  ON 30
eH1_1                -1.397694e-01 1 1  ON 31
eH1_2                -9.274687e-02 1 1  ON 32
eH1_3                -3.899572e-02 1 1  ON 33
eH1_4                 8.539295e-03 1 1  ON 34
eH1_5                 4.262567e-02 1 1  ON 35
eH1_6                 9.951946e-02 1 1  ON 36
eH1_7                 1.502902e-01 1 1  ON 37
eH1_8                 1.652404e-01 1 1  ON 38
eH1_9                 5.098274e-02 1 1  ON 39
eH2_0                -2.398741e-01 1 1  ON 40
eH2_1                -1.380484e-01 1 1  ON 41
eH2_2                -9.110788e-02 1 1  ON 42
eH2_3                -3.710975e-02 1 1  ON 43
eH2_4                 1.160587e-02 1 1  ON 44
eH2_5                 4.649712e-02 1 1  ON 45
eH2_6                 1.032000e-01 1 1  ON 46
eH2_7                 1.535886e-01 1 1  ON 47
eH2_8                 1.714456e-01 1 1  ON 48
eH2_9                 3.649531e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9078
    reference variance = 0.25669
====================================================
  Execution time = 2.0602e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3898e-01
  Total weights = 2.0000e+06
  Execution time = 1.8604e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338935133549
                                         uncertainty =       0.003861666528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338935133549
                                         uncertainty =       0.003861666528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411690729
  error estimate for blocks of size 2^( 2) =       0.000424196175
  error estimate for blocks of size 2^( 3) =       0.000437336116
  error estimate for blocks of size 2^( 4) =       0.000449141298
  error estimate for blocks of size 2^( 5) =       0.000460143295
  error estimate for blocks of size 2^( 6) =       0.000467696020
  error estimate for blocks of size 2^( 7) =       0.000473359097

      target function =                  N/A
              le_mean =     -16.907089339382
             les_mean =     286.188648273457
             stat err =       0.000462584927
             autocorr =       1.262527309784
              std dev =       0.582218612815
             le_variance =       0.338978513108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338947685118
                                         uncertainty =       0.003861873599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338947685118
                                         uncertainty =       0.003861873599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411698340
  error estimate for blocks of size 2^( 2) =       0.000424202546
  error estimate for blocks of size 2^( 3) =       0.000437341186
  error estimate for blocks of size 2^( 4) =       0.000449145397
  error estimate for blocks of size 2^( 5) =       0.000460147336
  error estimate for blocks of size 2^( 6) =       0.000467699984
  error estimate for blocks of size 2^( 7) =       0.000473364506

      target function =                  N/A
              le_mean =     -16.907089457643
             les_mean =     286.188664805229
             stat err =       0.000462589306
             autocorr =       1.262504530606
              std dev =       0.582229375740
             le_variance =       0.338991045974

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338941314835
                                         uncertainty =       0.003861772130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338941314835
                                         uncertainty =       0.003861772130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411694476
  error estimate for blocks of size 2^( 2) =       0.000424199290
  error estimate for blocks of size 2^( 3) =       0.000437338564
  error estimate for blocks of size 2^( 4) =       0.000449143255
  error estimate for blocks of size 2^( 5) =       0.000460145222
  error estimate for blocks of size 2^( 6) =       0.000467697915
  error estimate for blocks of size 2^( 7) =       0.000473361749

      target function =                  N/A
              le_mean =     -16.907089397064
             les_mean =     286.188656394713
             stat err =       0.000462587035
             autocorr =       1.262515832959
              std dev =       0.582223912155
             le_variance =       0.338984683885

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338935900328
                                         uncertainty =       0.003861679786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338935900328
                                         uncertainty =       0.003861679786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411691194
  error estimate for blocks of size 2^( 2) =       0.000424196560
  error estimate for blocks of size 2^( 3) =       0.000437336417
  error estimate for blocks of size 2^( 4) =       0.000449141538
  error estimate for blocks of size 2^( 5) =       0.000460143530
  error estimate for blocks of size 2^( 6) =       0.000467696252
  error estimate for blocks of size 2^( 7) =       0.000473359425

      target function =                  N/A
              le_mean =     -16.907089346285
             les_mean =     286.188649272314
             stat err =       0.000462585186
             autocorr =       1.262525872113
              std dev =       0.582219270148
             le_variance =       0.338979278531


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907089339382        initial
     3.9062e+00     3.9062e+01             6.3901e-05       -16.907089457643  <--
     1.5625e+01     1.5625e+02             1.6165e-05       -16.907089397064
     6.2500e+01     6.2500e+02             4.0535e-06       -16.907089346285

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 3.0162e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.093219e-01 1 1  ON 0
 uu_1                 1.425928e-01 1 1  ON 1
 uu_2                 4.130296e-02 1 1  ON 2
 uu_3                -2.073390e-02 1 1  ON 3
 uu_4                -6.540980e-02 1 1  ON 4
 uu_5                -9.932406e-02 1 1  ON 5
 uu_6                -1.255284e-01 1 1  ON 6
 uu_7                -1.379565e-01 1 1  ON 7
 uu_8                -1.298151e-01 1 1  ON 8
 uu_9                -9.909460e-02 1 1  ON 9
 ud_0                 4.460499e-01 1 1  ON 10
 ud_1                 1.804598e-01 1 1  ON 11
 ud_2                 6.028070e-02 1 1  ON 12
 ud_3                -1.047374e-02 1 1  ON 13
 ud_4                -6.705815e-02 1 1  ON 14
 ud_5                -1.078541e-01 1 1  ON 15
 ud_6                -1.344038e-01 1 1  ON 16
 ud_7                -1.497153e-01 1 1  ON 17
 ud_8                -1.490596e-01 1 1  ON 18
 ud_9                -1.376008e-01 1 1  ON 19
 eO_0                -7.561873e-01 1 1  ON 20
 eO_1                -4.357214e-01 1 1  ON 21
 eO_2                -1.884931e-02 1 1  ON 22
 eO_3                 2.975334e-01 1 1  ON 23
 eO_4                 5.198597e-01 1 1  ON 24
 eO_5                 4.780435e-01 1 1  ON 25
 eO_6                 2.472039e-01 1 1  ON 26
 eO_7                -4.893459e-02 1 1  ON 27
 eO_8                -2.115034e-01 1 1  ON 28
 eO_9                -7.212534e-02 1 1  ON 29
eH1_0                -2.413478e-01 1 1  ON 30
eH1_1                -1.398062e-01 1 1  ON 31
eH1_2                -9.276468e-02 1 1  ON 32
eH1_3                -3.899756e-02 1 1  ON 33
eH1_4                 8.557995e-03 1 1  ON 34
eH1_5                 4.263102e-02 1 1  ON 35
eH1_6                 9.951218e-02 1 1  ON 36
eH1_7                 1.502916e-01 1 1  ON 37
eH1_8                 1.652724e-01 1 1  ON 38
eH1_9                 5.101656e-02 1 1  ON 39
eH2_0                -2.399010e-01 1 1  ON 40
eH2_1                -1.380686e-01 1 1  ON 41
eH2_2                -9.111470e-02 1 1  ON 42
eH2_3                -3.708439e-02 1 1  ON 43
eH2_4                 1.159219e-02 1 1  ON 44
eH2_5                 4.646288e-02 1 1  ON 45
eH2_6                 1.032023e-01 1 1  ON 46
eH2_7                 1.535947e-01 1 1  ON 47
eH2_8                 1.714740e-01 1 1  ON 48
eH2_9                 3.653598e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7009e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9492
    reference variance = 0.364722
====================================================
  Execution time = 2.1647e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 4.1103e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6695e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.411045091010
                                         uncertainty =       0.071368765791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.411045091010
                                         uncertainty =       0.071368765791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000453335491
  error estimate for blocks of size 2^( 2) =       0.000464759974
  error estimate for blocks of size 2^( 3) =       0.000476452115
  error estimate for blocks of size 2^( 4) =       0.000486969027
  error estimate for blocks of size 2^( 5) =       0.000495491276
  error estimate for blocks of size 2^( 6) =       0.000501878414
  error estimate for blocks of size 2^( 7) =       0.000508549158

      target function =                  N/A
              le_mean =     -16.906762919872
             les_mean =     286.249658357315
             stat err =       0.000498221969
             autocorr =       1.207831375140
              std dev =       0.641113199095
             le_variance =       0.411026134054


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690676291987e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906762919872       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906763208016       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906763882358       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906764944920       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906765256325       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906765069035       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906765125470       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906765053615       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.107944e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906762919872       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906762999573       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906763217650       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906763544461       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906763638608       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906763601093       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906763604908       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906763594892       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 6.008059e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906762919872       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906762940342       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906762999135       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906763085711       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906763111055       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906763103010       residual = 9.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906763102875       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906763101167       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.563462e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.031466 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7323e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.093152e-01 1 1  ON 0
 uu_1                 1.426297e-01 1 1  ON 1
 uu_2                 4.128638e-02 1 1  ON 2
 uu_3                -2.072155e-02 1 1  ON 3
 uu_4                -6.540201e-02 1 1  ON 4
 uu_5                -9.933813e-02 1 1  ON 5
 uu_6                -1.255668e-01 1 1  ON 6
 uu_7                -1.379426e-01 1 1  ON 7
 uu_8                -1.298308e-01 1 1  ON 8
 uu_9                -9.912062e-02 1 1  ON 9
 ud_0                 4.460493e-01 1 1  ON 10
 ud_1                 1.805040e-01 1 1  ON 11
 ud_2                 6.029321e-02 1 1  ON 12
 ud_3                -1.045624e-02 1 1  ON 13
 ud_4                -6.705824e-02 1 1  ON 14
 ud_5                -1.078556e-01 1 1  ON 15
 ud_6                -1.343922e-01 1 1  ON 16
 ud_7                -1.497165e-01 1 1  ON 17
 ud_8                -1.490984e-01 1 1  ON 18
 ud_9                -1.376279e-01 1 1  ON 19
 eO_0                -7.562308e-01 1 1  ON 20
 eO_1                -4.357002e-01 1 1  ON 21
 eO_2                -1.885319e-02 1 1  ON 22
 eO_3                 2.975580e-01 1 1  ON 23
 eO_4                 5.198777e-01 1 1  ON 24
 eO_5                 4.780524e-01 1 1  ON 25
 eO_6                 2.472396e-01 1 1  ON 26
 eO_7                -4.891664e-02 1 1  ON 27
 eO_8                -2.115443e-01 1 1  ON 28
 eO_9                -7.215689e-02 1 1  ON 29
eH1_0                -2.413668e-01 1 1  ON 30
eH1_1                -1.398303e-01 1 1  ON 31
eH1_2                -9.282477e-02 1 1  ON 32
eH1_3                -3.898952e-02 1 1  ON 33
eH1_4                 8.539624e-03 1 1  ON 34
eH1_5                 4.261693e-02 1 1  ON 35
eH1_6                 9.953910e-02 1 1  ON 36
eH1_7                 1.503213e-01 1 1  ON 37
eH1_8                 1.653136e-01 1 1  ON 38
eH1_9                 5.104974e-02 1 1  ON 39
eH2_0                -2.399252e-01 1 1  ON 40
eH2_1                -1.380859e-01 1 1  ON 41
eH2_2                -9.109482e-02 1 1  ON 42
eH2_3                -3.709034e-02 1 1  ON 43
eH2_4                 1.156957e-02 1 1  ON 44
eH2_5                 4.645176e-02 1 1  ON 45
eH2_6                 1.031682e-01 1 1  ON 46
eH2_7                 1.536044e-01 1 1  ON 47
eH2_8                 1.715130e-01 1 1  ON 48
eH2_9                 3.657977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9843
    reference variance = 0.264198
====================================================
  Execution time = 2.3331e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3128e-01
  Total weights = 2.0000e+06
  Execution time = 1.8550e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331341887519
                                         uncertainty =       0.002813204575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331341887519
                                         uncertainty =       0.002813204575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406991028
  error estimate for blocks of size 2^( 2) =       0.000419482671
  error estimate for blocks of size 2^( 3) =       0.000433239776
  error estimate for blocks of size 2^( 4) =       0.000446676860
  error estimate for blocks of size 2^( 5) =       0.000458010731
  error estimate for blocks of size 2^( 6) =       0.000467278422
  error estimate for blocks of size 2^( 7) =       0.000473139634

      target function =                  N/A
              le_mean =     -16.905803134141
             les_mean =     286.137462837870
             stat err =       0.000461276412
             autocorr =       1.284555352206
              std dev =       0.575572231057
             le_variance =       0.331283393164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331346422712
                                         uncertainty =       0.002813033820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331346422712
                                         uncertainty =       0.002813033820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406993854
  error estimate for blocks of size 2^( 2) =       0.000419483178
  error estimate for blocks of size 2^( 3) =       0.000433237733
  error estimate for blocks of size 2^( 4) =       0.000446671785
  error estimate for blocks of size 2^( 5) =       0.000458005183
  error estimate for blocks of size 2^( 6) =       0.000467275680
  error estimate for blocks of size 2^( 7) =       0.000473137620

      target function =                  N/A
              le_mean =     -16.905803391982
             les_mean =     286.137476157479
             stat err =       0.000461272567
             autocorr =       1.284516097882
              std dev =       0.575576228455
             le_variance =       0.331287994762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331335196120
                                         uncertainty =       0.002812966476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331335196120
                                         uncertainty =       0.002812966476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406986944
  error estimate for blocks of size 2^( 2) =       0.000419477456
  error estimate for blocks of size 2^( 3) =       0.000433233345
  error estimate for blocks of size 2^( 4) =       0.000446668723
  error estimate for blocks of size 2^( 5) =       0.000458002290
  error estimate for blocks of size 2^( 6) =       0.000467272043
  error estimate for blocks of size 2^( 7) =       0.000473133781

      target function =                  N/A
              le_mean =     -16.905803233888
             les_mean =     286.137459562280
             stat err =       0.000461269209
             autocorr =       1.284541016570
              std dev =       0.575566455759
             le_variance =       0.331276744995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331340579208
                                         uncertainty =       0.002813167706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331340579208
                                         uncertainty =       0.002813167706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406990228
  error estimate for blocks of size 2^( 2) =       0.000419481730
  error estimate for blocks of size 2^( 3) =       0.000433238686
  error estimate for blocks of size 2^( 4) =       0.000446675546
  error estimate for blocks of size 2^( 5) =       0.000458009374
  error estimate for blocks of size 2^( 6) =       0.000467277354
  error estimate for blocks of size 2^( 7) =       0.000473138638

      target function =                  N/A
              le_mean =     -16.905803140046
             les_mean =     286.137461735104
             stat err =       0.000461275228
             autocorr =       1.284553810786
              std dev =       0.575571099658
             le_variance =       0.331282090761


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905803134141        initial
     9.7656e-01     9.7656e+00             2.1079e-04       -16.905803391982  <--
     3.9062e+00     3.9062e+01             6.0081e-05       -16.905803233888
     1.5625e+01     1.5625e+02             1.5635e-05       -16.905803140046

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 3.2717e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.093143e-01 1 1  ON 0
 uu_1                 1.427077e-01 1 1  ON 1
 uu_2                 4.126351e-02 1 1  ON 2
 uu_3                -2.069435e-02 1 1  ON 3
 uu_4                -6.538660e-02 1 1  ON 4
 uu_5                -9.937247e-02 1 1  ON 5
 uu_6                -1.256739e-01 1 1  ON 6
 uu_7                -1.379106e-01 1 1  ON 7
 uu_8                -1.298780e-01 1 1  ON 8
 uu_9                -9.919753e-02 1 1  ON 9
 ud_0                 4.460809e-01 1 1  ON 10
 ud_1                 1.806109e-01 1 1  ON 11
 ud_2                 6.033541e-02 1 1  ON 12
 ud_3                -1.041528e-02 1 1  ON 13
 ud_4                -6.705453e-02 1 1  ON 14
 ud_5                -1.078574e-01 1 1  ON 15
 ud_6                -1.343679e-01 1 1  ON 16
 ud_7                -1.497212e-01 1 1  ON 17
 ud_8                -1.492113e-01 1 1  ON 18
 ud_9                -1.377089e-01 1 1  ON 19
 eO_0                -7.563318e-01 1 1  ON 20
 eO_1                -4.356633e-01 1 1  ON 21
 eO_2                -1.885955e-02 1 1  ON 22
 eO_3                 2.976268e-01 1 1  ON 23
 eO_4                 5.199302e-01 1 1  ON 24
 eO_5                 4.780784e-01 1 1  ON 25
 eO_6                 2.473431e-01 1 1  ON 26
 eO_7                -4.886388e-02 1 1  ON 27
 eO_8                -2.116653e-01 1 1  ON 28
 eO_9                -7.225038e-02 1 1  ON 29
eH1_0                -2.414267e-01 1 1  ON 30
eH1_1                -1.399133e-01 1 1  ON 31
eH1_2                -9.297548e-02 1 1  ON 32
eH1_3                -3.898503e-02 1 1  ON 33
eH1_4                 8.493400e-03 1 1  ON 34
eH1_5                 4.257401e-02 1 1  ON 35
eH1_6                 9.961866e-02 1 1  ON 36
eH1_7                 1.504100e-01 1 1  ON 37
eH1_8                 1.654359e-01 1 1  ON 38
eH1_9                 5.114788e-02 1 1  ON 39
eH2_0                -2.399936e-01 1 1  ON 40
eH2_1                -1.381261e-01 1 1  ON 41
eH2_2                -9.105057e-02 1 1  ON 42
eH2_3                -3.710685e-02 1 1  ON 43
eH2_4                 1.150936e-02 1 1  ON 44
eH2_5                 4.641413e-02 1 1  ON 45
eH2_6                 1.030666e-01 1 1  ON 46
eH2_7                 1.536314e-01 1 1  ON 47
eH2_8                 1.716275e-01 1 1  ON 48
eH2_9                 3.670925e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0057e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9088
    reference variance = 0.226826
====================================================
  Execution time = 2.0718e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4758e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5524e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347606156888
                                         uncertainty =       0.005998775336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347606156888
                                         uncertainty =       0.005998775336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416882784
  error estimate for blocks of size 2^( 2) =       0.000429506909
  error estimate for blocks of size 2^( 3) =       0.000442921749
  error estimate for blocks of size 2^( 4) =       0.000456141380
  error estimate for blocks of size 2^( 5) =       0.000468023858
  error estimate for blocks of size 2^( 6) =       0.000476815905
  error estimate for blocks of size 2^( 7) =       0.000485887968

      target function =                  N/A
              le_mean =     -16.906533213960
             les_mean =     286.178447651636
             stat err =       0.000471717278
             autocorr =       1.280370463633
              std dev =       0.589561286626
             le_variance =       0.347582510688


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690653321396e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906533213960       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906534007075       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906534453688       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906534546604       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906534315943       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906533911290       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906535100132       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906535526123       residual = 9.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906535364891       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906535406007       residual = 6.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 8.048417e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906533213960       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906533494692       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906533708108       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906533810778       residual = 9.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906533723711       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906533579979       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906533880277       residual = 4.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906533966382       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906533919859       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.086115e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906533213960       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906533292286       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906533360258       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906533396585       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906533383207       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906533344329       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906533414280       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906533430201       residual = 7.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 5.171699e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.034594 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6277e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.093451e-01 1 1  ON 0
 uu_1                 1.426961e-01 1 1  ON 1
 uu_2                 4.129640e-02 1 1  ON 2
 uu_3                -2.074167e-02 1 1  ON 3
 uu_4                -6.541604e-02 1 1  ON 4
 uu_5                -9.931756e-02 1 1  ON 5
 uu_6                -1.256832e-01 1 1  ON 6
 uu_7                -1.379434e-01 1 1  ON 7
 uu_8                -1.299626e-01 1 1  ON 8
 uu_9                -9.927607e-02 1 1  ON 9
 ud_0                 4.461898e-01 1 1  ON 10
 ud_1                 1.806830e-01 1 1  ON 11
 ud_2                 6.044933e-02 1 1  ON 12
 ud_3                -1.033355e-02 1 1  ON 13
 ud_4                -6.703906e-02 1 1  ON 14
 ud_5                -1.078570e-01 1 1  ON 15
 ud_6                -1.343733e-01 1 1  ON 16
 ud_7                -1.498403e-01 1 1  ON 17
 ud_8                -1.493537e-01 1 1  ON 18
 ud_9                -1.377674e-01 1 1  ON 19
 eO_0                -7.563919e-01 1 1  ON 20
 eO_1                -4.356721e-01 1 1  ON 21
 eO_2                -1.896694e-02 1 1  ON 22
 eO_3                 2.977030e-01 1 1  ON 23
 eO_4                 5.199876e-01 1 1  ON 24
 eO_5                 4.782870e-01 1 1  ON 25
 eO_6                 2.475028e-01 1 1  ON 26
 eO_7                -4.889091e-02 1 1  ON 27
 eO_8                -2.118164e-01 1 1  ON 28
 eO_9                -7.237474e-02 1 1  ON 29
eH1_0                -2.415983e-01 1 1  ON 30
eH1_1                -1.400615e-01 1 1  ON 31
eH1_2                -9.295664e-02 1 1  ON 32
eH1_3                -3.889656e-02 1 1  ON 33
eH1_4                 8.562778e-03 1 1  ON 34
eH1_5                 4.242184e-02 1 1  ON 35
eH1_6                 9.953945e-02 1 1  ON 36
eH1_7                 1.504392e-01 1 1  ON 37
eH1_8                 1.656071e-01 1 1  ON 38
eH1_9                 5.131805e-02 1 1  ON 39
eH2_0                -2.401457e-01 1 1  ON 40
eH2_1                -1.382796e-01 1 1  ON 41
eH2_2                -9.114790e-02 1 1  ON 42
eH2_3                -3.713825e-02 1 1  ON 43
eH2_4                 1.142332e-02 1 1  ON 44
eH2_5                 4.643644e-02 1 1  ON 45
eH2_6                 1.030886e-01 1 1  ON 46
eH2_7                 1.537364e-01 1 1  ON 47
eH2_8                 1.717981e-01 1 1  ON 48
eH2_9                 3.690845e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9224
    reference variance = 0.238562
====================================================
  Execution time = 2.0805e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4040e-01
  Total weights = 2.0000e+06
  Execution time = 1.8561e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340256880232
                                         uncertainty =       0.004763333856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340256880232
                                         uncertainty =       0.004763333856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412552873
  error estimate for blocks of size 2^( 2) =       0.000425465612
  error estimate for blocks of size 2^( 3) =       0.000438547811
  error estimate for blocks of size 2^( 4) =       0.000451180072
  error estimate for blocks of size 2^( 5) =       0.000462641157
  error estimate for blocks of size 2^( 6) =       0.000470179465
  error estimate for blocks of size 2^( 7) =       0.000476342221

      target function =                  N/A
              le_mean =     -16.906133830926
             les_mean =     286.157760685416
             stat err =       0.000465085729
             autocorr =       1.270886582782
              std dev =       0.583437868526
             le_variance =       0.340399746430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340278525986
                                         uncertainty =       0.004767976851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340278525986
                                         uncertainty =       0.004767976851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412565891
  error estimate for blocks of size 2^( 2) =       0.000425476459
  error estimate for blocks of size 2^( 3) =       0.000438554474
  error estimate for blocks of size 2^( 4) =       0.000451183337
  error estimate for blocks of size 2^( 5) =       0.000462640248
  error estimate for blocks of size 2^( 6) =       0.000470173384
  error estimate for blocks of size 2^( 7) =       0.000476340854

      target function =                  N/A
              le_mean =     -16.906135005968
             les_mean =     286.157821898652
             stat err =       0.000465084456
             autocorr =       1.270799424420
              std dev =       0.583456278448
             le_variance =       0.340421228861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340254680463
                                         uncertainty =       0.004766751635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340254680463
                                         uncertainty =       0.004766751635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412551439
  error estimate for blocks of size 2^( 2) =       0.000425463274
  error estimate for blocks of size 2^( 3) =       0.000438543328
  error estimate for blocks of size 2^( 4) =       0.000451174464
  error estimate for blocks of size 2^( 5) =       0.000462633226
  error estimate for blocks of size 2^( 6) =       0.000470167866
  error estimate for blocks of size 2^( 7) =       0.000476335361

      target function =                  N/A
              le_mean =     -16.906134489364
             les_mean =     286.157780582164
             stat err =       0.000465077729
             autocorr =       1.270851697995
              std dev =       0.583435840434
             le_variance =       0.340397379902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340253696958
                                         uncertainty =       0.004763806829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340253696958
                                         uncertainty =       0.004763806829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412550928
  error estimate for blocks of size 2^( 2) =       0.000425463617
  error estimate for blocks of size 2^( 3) =       0.000438545562
  error estimate for blocks of size 2^( 4) =       0.000451177770
  error estimate for blocks of size 2^( 5) =       0.000462638568
  error estimate for blocks of size 2^( 6) =       0.000470176307
  error estimate for blocks of size 2^( 7) =       0.000476339981

      target function =                  N/A
              le_mean =     -16.906133854691
             les_mean =     286.157758278192
             stat err =       0.000465083157
             autocorr =       1.270884512163
              std dev =       0.583435116936
             le_variance =       0.340396535674


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906133830926        initial
     2.4414e-01     2.4414e+00             8.0484e-04       -16.906135005968  <--
     9.7656e-01     9.7656e+00             2.0861e-04       -16.906134489364
     3.9062e+00     3.9062e+01             5.1717e-05       -16.906133854691

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 3.0156e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.094119e-01 1 1  ON 0
 uu_1                 1.427060e-01 1 1  ON 1
 uu_2                 4.133835e-02 1 1  ON 2
 uu_3                -2.079365e-02 1 1  ON 3
 uu_4                -6.547849e-02 1 1  ON 4
 uu_5                -9.926536e-02 1 1  ON 5
 uu_6                -1.257219e-01 1 1  ON 6
 uu_7                -1.380033e-01 1 1  ON 7
 uu_8                -1.301895e-01 1 1  ON 8
 uu_9                -9.951272e-02 1 1  ON 9
 ud_0                 4.464764e-01 1 1  ON 10
 ud_1                 1.809292e-01 1 1  ON 11
 ud_2                 6.070514e-02 1 1  ON 12
 ud_3                -1.012519e-02 1 1  ON 13
 ud_4                -6.694915e-02 1 1  ON 14
 ud_5                -1.078281e-01 1 1  ON 15
 ud_6                -1.344456e-01 1 1  ON 16
 ud_7                -1.500964e-01 1 1  ON 17
 ud_8                -1.497430e-01 1 1  ON 18
 ud_9                -1.379584e-01 1 1  ON 19
 eO_0                -7.565787e-01 1 1  ON 20
 eO_1                -4.357607e-01 1 1  ON 21
 eO_2                -1.913439e-02 1 1  ON 22
 eO_3                 2.978165e-01 1 1  ON 23
 eO_4                 5.201979e-01 1 1  ON 24
 eO_5                 4.788832e-01 1 1  ON 25
 eO_6                 2.479742e-01 1 1  ON 26
 eO_7                -4.895485e-02 1 1  ON 27
 eO_8                -2.122638e-01 1 1  ON 28
 eO_9                -7.274333e-02 1 1  ON 29
eH1_0                -2.420314e-01 1 1  ON 30
eH1_1                -1.403234e-01 1 1  ON 31
eH1_2                -9.296529e-02 1 1  ON 32
eH1_3                -3.877755e-02 1 1  ON 33
eH1_4                 8.686495e-03 1 1  ON 34
eH1_5                 4.205646e-02 1 1  ON 35
eH1_6                 9.929968e-02 1 1  ON 36
eH1_7                 1.505009e-01 1 1  ON 37
eH1_8                 1.661027e-01 1 1  ON 38
eH1_9                 5.181629e-02 1 1  ON 39
eH2_0                -2.405953e-01 1 1  ON 40
eH2_1                -1.386919e-01 1 1  ON 41
eH2_2                -9.143076e-02 1 1  ON 42
eH2_3                -3.728712e-02 1 1  ON 43
eH2_4                 1.119053e-02 1 1  ON 44
eH2_5                 4.646332e-02 1 1  ON 45
eH2_6                 1.031699e-01 1 1  ON 46
eH2_7                 1.540583e-01 1 1  ON 47
eH2_8                 1.723081e-01 1 1  ON 48
eH2_9                 3.749275e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6550e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9132
    reference variance = 0.265348
====================================================
  Execution time = 2.0622e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4043e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5911e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340441938322
                                         uncertainty =       0.003838158090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340441938322
                                         uncertainty =       0.003838158090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412569518
  error estimate for blocks of size 2^( 2) =       0.000425732897
  error estimate for blocks of size 2^( 3) =       0.000438721160
  error estimate for blocks of size 2^( 4) =       0.000451445545
  error estimate for blocks of size 2^( 5) =       0.000461336433
  error estimate for blocks of size 2^( 6) =       0.000467907749
  error estimate for blocks of size 2^( 7) =       0.000472146728

      target function =                  N/A
              le_mean =     -16.905568340728
             les_mean =     286.138667966375
             stat err =       0.000463209114
             autocorr =       1.260549536261
              std dev =       0.583461407081
             le_variance =       0.340427213553


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690556834073e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905568340728       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905566125686       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905567536250       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905573841599       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905571763282       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905570867975       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905573279361       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905574391181       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905575158020       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905577329889       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905576036362       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905576397971       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905576901140       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 3.706881e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905568340728       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905567008465       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905567432910       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905571166534       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905570510799       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905568626063       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905570286269       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905570863444       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905570641738       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905570559506       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905570612834       residual = 2.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 9.496517e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905568340728       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905567827165       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905567842181       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905569086213       residual = 8.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905568850451       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905568791292       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905568836844       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905568984608       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.495033e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.039599 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6222e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.097991e-01 1 1  ON 0
 uu_1                 1.428651e-01 1 1  ON 1
 uu_2                 4.144469e-02 1 1  ON 2
 uu_3                -2.064545e-02 1 1  ON 3
 uu_4                -6.555957e-02 1 1  ON 4
 uu_5                -9.944244e-02 1 1  ON 5
 uu_6                -1.260216e-01 1 1  ON 6
 uu_7                -1.383209e-01 1 1  ON 7
 uu_8                -1.303802e-01 1 1  ON 8
 uu_9                -9.996136e-02 1 1  ON 9
 ud_0                 4.468336e-01 1 1  ON 10
 ud_1                 1.809905e-01 1 1  ON 11
 ud_2                 6.096267e-02 1 1  ON 12
 ud_3                -1.012001e-02 1 1  ON 13
 ud_4                -6.682758e-02 1 1  ON 14
 ud_5                -1.077123e-01 1 1  ON 15
 ud_6                -1.343627e-01 1 1  ON 16
 ud_7                -1.499596e-01 1 1  ON 17
 ud_8                -1.503529e-01 1 1  ON 18
 ud_9                -1.383536e-01 1 1  ON 19
 eO_0                -7.564285e-01 1 1  ON 20
 eO_1                -4.360211e-01 1 1  ON 21
 eO_2                -1.913369e-02 1 1  ON 22
 eO_3                 2.975131e-01 1 1  ON 23
 eO_4                 5.204143e-01 1 1  ON 24
 eO_5                 4.792910e-01 1 1  ON 25
 eO_6                 2.486816e-01 1 1  ON 26
 eO_7                -4.872901e-02 1 1  ON 27
 eO_8                -2.127002e-01 1 1  ON 28
 eO_9                -7.334049e-02 1 1  ON 29
eH1_0                -2.428962e-01 1 1  ON 30
eH1_1                -1.405708e-01 1 1  ON 31
eH1_2                -9.350649e-02 1 1  ON 32
eH1_3                -3.911422e-02 1 1  ON 33
eH1_4                 8.723951e-03 1 1  ON 34
eH1_5                 4.211923e-02 1 1  ON 35
eH1_6                 9.903556e-02 1 1  ON 36
eH1_7                 1.509715e-01 1 1  ON 37
eH1_8                 1.670524e-01 1 1  ON 38
eH1_9                 5.258085e-02 1 1  ON 39
eH2_0                -2.407471e-01 1 1  ON 40
eH2_1                -1.389997e-01 1 1  ON 41
eH2_2                -9.194511e-02 1 1  ON 42
eH2_3                -3.764406e-02 1 1  ON 43
eH2_4                 1.101852e-02 1 1  ON 44
eH2_5                 4.615238e-02 1 1  ON 45
eH2_6                 1.031958e-01 1 1  ON 46
eH2_7                 1.544424e-01 1 1  ON 47
eH2_8                 1.728184e-01 1 1  ON 48
eH2_9                 3.833825e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9946
    reference variance = 0.153273
====================================================
  Execution time = 2.0250e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4749e-01
  Total weights = 2.0000e+06
  Execution time = 1.8449e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347361126870
                                         uncertainty =       0.009105418889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347361126870
                                         uncertainty =       0.009105418889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416688797
  error estimate for blocks of size 2^( 2) =       0.000429151611
  error estimate for blocks of size 2^( 3) =       0.000442060259
  error estimate for blocks of size 2^( 4) =       0.000454028182
  error estimate for blocks of size 2^( 5) =       0.000465503483
  error estimate for blocks of size 2^( 6) =       0.000474131791
  error estimate for blocks of size 2^( 7) =       0.000482479019

      target function =                  N/A
              le_mean =     -16.906722976030
             les_mean =     286.184540722037
             stat err =       0.000469035619
             autocorr =       1.267033215544
              std dev =       0.589286948305
             le_variance =       0.347259107442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347713472843
                                         uncertainty =       0.009073610968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347713472843
                                         uncertainty =       0.009073610968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416900116
  error estimate for blocks of size 2^( 2) =       0.000429350762
  error estimate for blocks of size 2^( 3) =       0.000442238219
  error estimate for blocks of size 2^( 4) =       0.000454191762
  error estimate for blocks of size 2^( 5) =       0.000465648960
  error estimate for blocks of size 2^( 6) =       0.000474270106
  error estimate for blocks of size 2^( 7) =       0.000482615719

      target function =                  N/A
              le_mean =     -16.906726436371
             les_mean =     286.185010033748
             stat err =       0.000469181637
             autocorr =       1.266537288479
              std dev =       0.589585798041
             le_variance =       0.347611413252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347828829191
                                         uncertainty =       0.009097249115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347828829191
                                         uncertainty =       0.009097249115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416969196
  error estimate for blocks of size 2^( 2) =       0.000429420393
  error estimate for blocks of size 2^( 3) =       0.000442307882
  error estimate for blocks of size 2^( 4) =       0.000454262652
  error estimate for blocks of size 2^( 5) =       0.000465720282
  error estimate for blocks of size 2^( 6) =       0.000474337736
  error estimate for blocks of size 2^( 7) =       0.000482693731

      target function =                  N/A
              le_mean =     -16.906729478753
             les_mean =     286.185228115208
             stat err =       0.000469253600
             autocorr =       1.266506088298
              std dev =       0.589683492500
             le_variance =       0.347726621327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347469053711
                                         uncertainty =       0.009107688753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347469053711
                                         uncertainty =       0.009107688753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416753518
  error estimate for blocks of size 2^( 2) =       0.000429214361
  error estimate for blocks of size 2^( 3) =       0.000442118893
  error estimate for blocks of size 2^( 4) =       0.000454083958
  error estimate for blocks of size 2^( 5) =       0.000465555350
  error estimate for blocks of size 2^( 6) =       0.000474181148
  error estimate for blocks of size 2^( 7) =       0.000482531272

      target function =                  N/A
              le_mean =     -16.906724695348
             les_mean =     286.184706740513
             stat err =       0.000469087932
             autocorr =       1.266922270670
              std dev =       0.589378477627
             le_variance =       0.347366989890


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906722976030        initial
     6.1035e-02     6.1035e-01             3.7069e-03       -16.906726436371
     2.4414e-01     2.4414e+00             9.4965e-04       -16.906729478753  <--
     9.7656e-01     9.7656e+00             2.4950e-04       -16.906724695348

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 2.9573e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.097991e-01 1 1  ON 0
 uu_1                 1.428651e-01 1 1  ON 1
 uu_2                 4.144469e-02 1 1  ON 2
 uu_3                -2.064545e-02 1 1  ON 3
 uu_4                -6.555957e-02 1 1  ON 4
 uu_5                -9.944244e-02 1 1  ON 5
 uu_6                -1.260216e-01 1 1  ON 6
 uu_7                -1.383209e-01 1 1  ON 7
 uu_8                -1.303802e-01 1 1  ON 8
 uu_9                -9.996136e-02 1 1  ON 9
 ud_0                 4.468336e-01 1 1  ON 10
 ud_1                 1.809905e-01 1 1  ON 11
 ud_2                 6.096267e-02 1 1  ON 12
 ud_3                -1.012001e-02 1 1  ON 13
 ud_4                -6.682758e-02 1 1  ON 14
 ud_5                -1.077123e-01 1 1  ON 15
 ud_6                -1.343627e-01 1 1  ON 16
 ud_7                -1.499596e-01 1 1  ON 17
 ud_8                -1.503529e-01 1 1  ON 18
 ud_9                -1.383536e-01 1 1  ON 19
 eO_0                -7.564285e-01 1 1  ON 20
 eO_1                -4.360211e-01 1 1  ON 21
 eO_2                -1.913369e-02 1 1  ON 22
 eO_3                 2.975131e-01 1 1  ON 23
 eO_4                 5.204143e-01 1 1  ON 24
 eO_5                 4.792910e-01 1 1  ON 25
 eO_6                 2.486816e-01 1 1  ON 26
 eO_7                -4.872901e-02 1 1  ON 27
 eO_8                -2.127002e-01 1 1  ON 28
 eO_9                -7.334049e-02 1 1  ON 29
eH1_0                -2.428962e-01 1 1  ON 30
eH1_1                -1.405708e-01 1 1  ON 31
eH1_2                -9.350649e-02 1 1  ON 32
eH1_3                -3.911422e-02 1 1  ON 33
eH1_4                 8.723951e-03 1 1  ON 34
eH1_5                 4.211923e-02 1 1  ON 35
eH1_6                 9.903556e-02 1 1  ON 36
eH1_7                 1.509715e-01 1 1  ON 37
eH1_8                 1.670524e-01 1 1  ON 38
eH1_9                 5.258085e-02 1 1  ON 39
eH2_0                -2.407471e-01 1 1  ON 40
eH2_1                -1.389997e-01 1 1  ON 41
eH2_2                -9.194511e-02 1 1  ON 42
eH2_3                -3.764406e-02 1 1  ON 43
eH2_4                 1.101852e-02 1 1  ON 44
eH2_5                 4.615238e-02 1 1  ON 45
eH2_6                 1.031958e-01 1 1  ON 46
eH2_7                 1.544424e-01 1 1  ON 47
eH2_8                 1.728184e-01 1 1  ON 48
eH2_9                 3.833825e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9887e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9134
    reference variance = 0.258703
====================================================
  Execution time = 2.1127e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3524e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5404e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335309931520
                                         uncertainty =       0.003051862870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335309931520
                                         uncertainty =       0.003051862870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409411455
  error estimate for blocks of size 2^( 2) =       0.000422357646
  error estimate for blocks of size 2^( 3) =       0.000435576064
  error estimate for blocks of size 2^( 4) =       0.000447844064
  error estimate for blocks of size 2^( 5) =       0.000458954645
  error estimate for blocks of size 2^( 6) =       0.000467328565
  error estimate for blocks of size 2^( 7) =       0.000472210823

      target function =                  N/A
              le_mean =     -16.905158147483
             les_mean =     286.119607302573
             stat err =       0.000461584524
             autocorr =       1.271108141562
              std dev =       0.578995232086
             le_variance =       0.335235478779


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690515814748e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905158147483       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905156680732       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905158290760       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905159650405       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905159371886       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905159780738       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905159209678       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905161895899       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905164945259       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905165010195       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905164049000       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905164513393       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905164960089       residual = 5.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 3.861361e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905158147483       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905157336134       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905158475542       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905159397838       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905159448361       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905158900688       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905159109986       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905160014797       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905160046374       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905159903422       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 9.676223e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905158147483       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905157856401       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905158375256       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905158693960       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905158823688       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905158761298       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905158671280       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905158756695       residual = 5.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.398885e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.043686 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6675e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.095993e-01 1 1  ON 0
 uu_1                 1.429225e-01 1 1  ON 1
 uu_2                 4.139971e-02 1 1  ON 2
 uu_3                -2.070783e-02 1 1  ON 3
 uu_4                -6.546747e-02 1 1  ON 4
 uu_5                -9.960055e-02 1 1  ON 5
 uu_6                -1.261214e-01 1 1  ON 6
 uu_7                -1.385993e-01 1 1  ON 7
 uu_8                -1.307319e-01 1 1  ON 8
 uu_9                -1.001084e-01 1 1  ON 9
 ud_0                 4.470508e-01 1 1  ON 10
 ud_1                 1.812396e-01 1 1  ON 11
 ud_2                 6.096417e-02 1 1  ON 12
 ud_3                -1.010753e-02 1 1  ON 13
 ud_4                -6.702629e-02 1 1  ON 14
 ud_5                -1.081077e-01 1 1  ON 15
 ud_6                -1.348777e-01 1 1  ON 16
 ud_7                -1.500985e-01 1 1  ON 17
 ud_8                -1.500745e-01 1 1  ON 18
 ud_9                -1.382288e-01 1 1  ON 19
 eO_0                -7.566749e-01 1 1  ON 20
 eO_1                -4.362700e-01 1 1  ON 21
 eO_2                -1.916347e-02 1 1  ON 22
 eO_3                 2.974198e-01 1 1  ON 23
 eO_4                 5.206015e-01 1 1  ON 24
 eO_5                 4.798421e-01 1 1  ON 25
 eO_6                 2.492985e-01 1 1  ON 26
 eO_7                -4.855153e-02 1 1  ON 27
 eO_8                -2.131290e-01 1 1  ON 28
 eO_9                -7.376581e-02 1 1  ON 29
eH1_0                -2.435761e-01 1 1  ON 30
eH1_1                -1.408497e-01 1 1  ON 31
eH1_2                -9.383815e-02 1 1  ON 32
eH1_3                -3.932661e-02 1 1  ON 33
eH1_4                 8.736400e-03 1 1  ON 34
eH1_5                 4.201254e-02 1 1  ON 35
eH1_6                 9.931423e-02 1 1  ON 36
eH1_7                 1.511729e-01 1 1  ON 37
eH1_8                 1.673961e-01 1 1  ON 38
eH1_9                 5.317786e-02 1 1  ON 39
eH2_0                -2.411716e-01 1 1  ON 40
eH2_1                -1.394659e-01 1 1  ON 41
eH2_2                -9.207840e-02 1 1  ON 42
eH2_3                -3.793530e-02 1 1  ON 43
eH2_4                 1.081571e-02 1 1  ON 44
eH2_5                 4.579799e-02 1 1  ON 45
eH2_6                 1.029117e-01 1 1  ON 46
eH2_7                 1.547542e-01 1 1  ON 47
eH2_8                 1.736003e-01 1 1  ON 48
eH2_9                 3.930588e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9164
    reference variance = 0.343658
====================================================
  Execution time = 2.0206e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4992e-01
  Total weights = 2.0000e+06
  Execution time = 1.8420e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349835492832
                                         uncertainty =       0.008277422662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349835492832
                                         uncertainty =       0.008277422662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418204574
  error estimate for blocks of size 2^( 2) =       0.000430736660
  error estimate for blocks of size 2^( 3) =       0.000443782897
  error estimate for blocks of size 2^( 4) =       0.000455737071
  error estimate for blocks of size 2^( 5) =       0.000465974878
  error estimate for blocks of size 2^( 6) =       0.000476644217
  error estimate for blocks of size 2^( 7) =       0.000482761234

      target function =                  N/A
              le_mean =     -16.905897493634
             les_mean =     286.159160021023
             stat err =       0.000470279350
             autocorr =       1.264544921974
              std dev =       0.591430579756
             le_variance =       0.349790130670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350200331135
                                         uncertainty =       0.008312025173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350200331135
                                         uncertainty =       0.008312025173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418422340
  error estimate for blocks of size 2^( 2) =       0.000430946958
  error estimate for blocks of size 2^( 3) =       0.000443982028
  error estimate for blocks of size 2^( 4) =       0.000455921621
  error estimate for blocks of size 2^( 5) =       0.000466143180
  error estimate for blocks of size 2^( 6) =       0.000476809260
  error estimate for blocks of size 2^( 7) =       0.000482923588

      target function =                  N/A
              le_mean =     -16.905896323065
             les_mean =     286.159484819957
             stat err =       0.000470449412
             autocorr =       1.264142793699
              std dev =       0.591738547667
             le_variance =       0.350154508795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350098563892
                                         uncertainty =       0.008308648956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350098563892
                                         uncertainty =       0.008308648956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418361549
  error estimate for blocks of size 2^( 2) =       0.000430885519
  error estimate for blocks of size 2^( 3) =       0.000443923810
  error estimate for blocks of size 2^( 4) =       0.000455868696
  error estimate for blocks of size 2^( 5) =       0.000466099253
  error estimate for blocks of size 2^( 6) =       0.000476769138
  error estimate for blocks of size 2^( 7) =       0.000482883814

      target function =                  N/A
              le_mean =     -16.905896514415
             les_mean =     286.159389552173
             stat err =       0.000470405225
             autocorr =       1.264272670201
              std dev =       0.591652576349
             le_variance =       0.350052771100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349885233411
                                         uncertainty =       0.008283995201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349885233411
                                         uncertainty =       0.008283995201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418234253
  error estimate for blocks of size 2^( 2) =       0.000430764233
  error estimate for blocks of size 2^( 3) =       0.000443808680
  error estimate for blocks of size 2^( 4) =       0.000455761208
  error estimate for blocks of size 2^( 5) =       0.000465998212
  error estimate for blocks of size 2^( 6) =       0.000476667648
  error estimate for blocks of size 2^( 7) =       0.000482783386

      target function =                  N/A
              le_mean =     -16.905897023047
             les_mean =     286.159193759128
             stat err =       0.000470302613
             autocorr =       1.264490550912
              std dev =       0.591472552354
             le_variance =       0.349839780188


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905897493634        initial  <--
     6.1035e-02     6.1035e-01             3.8614e-03       -16.905896323065
     2.4414e-01     2.4414e+00             9.6762e-04       -16.905896514415
     9.7656e-01     9.7656e+00             2.3989e-04       -16.905897023047

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5269
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.097991e-01 1 1  ON 0
 uu_1                 1.428651e-01 1 1  ON 1
 uu_2                 4.144469e-02 1 1  ON 2
 uu_3                -2.064545e-02 1 1  ON 3
 uu_4                -6.555957e-02 1 1  ON 4
 uu_5                -9.944244e-02 1 1  ON 5
 uu_6                -1.260216e-01 1 1  ON 6
 uu_7                -1.383209e-01 1 1  ON 7
 uu_8                -1.303802e-01 1 1  ON 8
 uu_9                -9.996136e-02 1 1  ON 9
 ud_0                 4.468336e-01 1 1  ON 10
 ud_1                 1.809905e-01 1 1  ON 11
 ud_2                 6.096267e-02 1 1  ON 12
 ud_3                -1.012001e-02 1 1  ON 13
 ud_4                -6.682758e-02 1 1  ON 14
 ud_5                -1.077123e-01 1 1  ON 15
 ud_6                -1.343627e-01 1 1  ON 16
 ud_7                -1.499596e-01 1 1  ON 17
 ud_8                -1.503529e-01 1 1  ON 18
 ud_9                -1.383536e-01 1 1  ON 19
 eO_0                -7.564285e-01 1 1  ON 20
 eO_1                -4.360211e-01 1 1  ON 21
 eO_2                -1.913369e-02 1 1  ON 22
 eO_3                 2.975131e-01 1 1  ON 23
 eO_4                 5.204143e-01 1 1  ON 24
 eO_5                 4.792910e-01 1 1  ON 25
 eO_6                 2.486816e-01 1 1  ON 26
 eO_7                -4.872901e-02 1 1  ON 27
 eO_8                -2.127002e-01 1 1  ON 28
 eO_9                -7.334049e-02 1 1  ON 29
eH1_0                -2.428962e-01 1 1  ON 30
eH1_1                -1.405708e-01 1 1  ON 31
eH1_2                -9.350649e-02 1 1  ON 32
eH1_3                -3.911422e-02 1 1  ON 33
eH1_4                 8.723951e-03 1 1  ON 34
eH1_5                 4.211923e-02 1 1  ON 35
eH1_6                 9.903556e-02 1 1  ON 36
eH1_7                 1.509715e-01 1 1  ON 37
eH1_8                 1.670524e-01 1 1  ON 38
eH1_9                 5.258085e-02 1 1  ON 39
eH2_0                -2.407471e-01 1 1  ON 40
eH2_1                -1.389997e-01 1 1  ON 41
eH2_2                -9.194511e-02 1 1  ON 42
eH2_3                -3.764406e-02 1 1  ON 43
eH2_4                 1.101852e-02 1 1  ON 44
eH2_5                 4.615238e-02 1 1  ON 45
eH2_6                 1.031958e-01 1 1  ON 46
eH2_7                 1.544424e-01 1 1  ON 47
eH2_8                 1.728184e-01 1 1  ON 48
eH2_9                 3.833825e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6337e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6924e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8958
    reference variance = 0.19771
====================================================
  Execution time = 2.1651e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4706e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5459e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347049465436
                                         uncertainty =       0.007265969330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347049465436
                                         uncertainty =       0.007265969330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416567806
  error estimate for blocks of size 2^( 2) =       0.000429035544
  error estimate for blocks of size 2^( 3) =       0.000441509365
  error estimate for blocks of size 2^( 4) =       0.000453193068
  error estimate for blocks of size 2^( 5) =       0.000463490390
  error estimate for blocks of size 2^( 6) =       0.000472011793
  error estimate for blocks of size 2^( 7) =       0.000475446582

      target function =                  N/A
              le_mean =     -16.907028931192
             les_mean =     286.194684581176
             stat err =       0.000466035458
             autocorr =       1.251602770413
              std dev =       0.589115841362
             le_variance =       0.347057474544


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690702893119e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907028931192       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907029842376       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907030306588       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907030882987       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907031195820       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907030892508       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907031191711       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907031058433       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907031092083       residual = 2.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 3.187190e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907028931192       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907029210285       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907029317621       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907029415356       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907029545692       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907029463553       residual = 7.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907029534688       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907029509054       residual = 6.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 8.638368e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907028931192       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907029005128       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907029031226       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907029051306       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907029088025       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907029068848       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907029085407       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907029079255       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.209231e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.046492 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7203e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.098038e-01 1 1  ON 0
 uu_1                 1.429022e-01 1 1  ON 1
 uu_2                 4.145762e-02 1 1  ON 2
 uu_3                -2.064388e-02 1 1  ON 3
 uu_4                -6.552538e-02 1 1  ON 4
 uu_5                -9.943862e-02 1 1  ON 5
 uu_6                -1.260264e-01 1 1  ON 6
 uu_7                -1.383806e-01 1 1  ON 7
 uu_8                -1.304159e-01 1 1  ON 8
 uu_9                -1.000063e-01 1 1  ON 9
 ud_0                 4.468543e-01 1 1  ON 10
 ud_1                 1.810506e-01 1 1  ON 11
 ud_2                 6.096980e-02 1 1  ON 12
 ud_3                -1.009483e-02 1 1  ON 13
 ud_4                -6.678446e-02 1 1  ON 14
 ud_5                -1.077238e-01 1 1  ON 15
 ud_6                -1.343549e-01 1 1  ON 16
 ud_7                -1.499680e-01 1 1  ON 17
 ud_8                -1.503992e-01 1 1  ON 18
 ud_9                -1.383928e-01 1 1  ON 19
 eO_0                -7.564245e-01 1 1  ON 20
 eO_1                -4.359736e-01 1 1  ON 21
 eO_2                -1.914689e-02 1 1  ON 22
 eO_3                 2.975128e-01 1 1  ON 23
 eO_4                 5.204082e-01 1 1  ON 24
 eO_5                 4.793212e-01 1 1  ON 25
 eO_6                 2.487401e-01 1 1  ON 26
 eO_7                -4.872214e-02 1 1  ON 27
 eO_8                -2.127620e-01 1 1  ON 28
 eO_9                -7.339724e-02 1 1  ON 29
eH1_0                -2.429656e-01 1 1  ON 30
eH1_1                -1.406029e-01 1 1  ON 31
eH1_2                -9.353016e-02 1 1  ON 32
eH1_3                -3.913904e-02 1 1  ON 33
eH1_4                 8.744536e-03 1 1  ON 34
eH1_5                 4.213658e-02 1 1  ON 35
eH1_6                 9.904588e-02 1 1  ON 36
eH1_7                 1.509805e-01 1 1  ON 37
eH1_8                 1.670894e-01 1 1  ON 38
eH1_9                 5.263386e-02 1 1  ON 39
eH2_0                -2.408335e-01 1 1  ON 40
eH2_1                -1.390059e-01 1 1  ON 41
eH2_2                -9.192678e-02 1 1  ON 42
eH2_3                -3.764743e-02 1 1  ON 43
eH2_4                 1.102109e-02 1 1  ON 44
eH2_5                 4.612204e-02 1 1  ON 45
eH2_6                 1.031497e-01 1 1  ON 46
eH2_7                 1.544710e-01 1 1  ON 47
eH2_8                 1.728769e-01 1 1  ON 48
eH2_9                 3.841651e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8719
    reference variance = 0.212331
====================================================
  Execution time = 2.1078e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3864e-01
  Total weights = 2.0000e+06
  Execution time = 1.8469e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338715873456
                                         uncertainty =       0.003897798808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338715873456
                                         uncertainty =       0.003897798808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411485189
  error estimate for blocks of size 2^( 2) =       0.000424424407
  error estimate for blocks of size 2^( 3) =       0.000437338494
  error estimate for blocks of size 2^( 4) =       0.000449128169
  error estimate for blocks of size 2^( 5) =       0.000461285321
  error estimate for blocks of size 2^( 6) =       0.000470004246
  error estimate for blocks of size 2^( 7) =       0.000475273795

      target function =                  N/A
              le_mean =     -16.907172348669
             les_mean =     286.191116779859
             stat err =       0.000463922883
             autocorr =       1.271110110516
              std dev =       0.581927935032
             le_variance =       0.338640121571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338723781352
                                         uncertainty =       0.003897930972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338723781352
                                         uncertainty =       0.003897930972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411490003
  error estimate for blocks of size 2^( 2) =       0.000424426177
  error estimate for blocks of size 2^( 3) =       0.000437335372
  error estimate for blocks of size 2^( 4) =       0.000449122295
  error estimate for blocks of size 2^( 5) =       0.000461279110
  error estimate for blocks of size 2^( 6) =       0.000469997895
  error estimate for blocks of size 2^( 7) =       0.000475269434

      target function =                  N/A
              le_mean =     -16.907171173152
             les_mean =     286.191084954714
             stat err =       0.000463917184
             autocorr =       1.271049137437
              std dev =       0.581934743567
             le_variance =       0.338648045770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338707782820
                                         uncertainty =       0.003897650494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338707782820
                                         uncertainty =       0.003897650494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411480282
  error estimate for blocks of size 2^( 2) =       0.000424417979
  error estimate for blocks of size 2^( 3) =       0.000437329253
  error estimate for blocks of size 2^( 4) =       0.000449117475
  error estimate for blocks of size 2^( 5) =       0.000461274546
  error estimate for blocks of size 2^( 6) =       0.000469993136
  error estimate for blocks of size 2^( 7) =       0.000475263455

      target function =                  N/A
              le_mean =     -16.907171550805
             les_mean =     286.191081723464
             stat err =       0.000463912153
             autocorr =       1.271081630608
              std dev =       0.581920994999
             le_variance =       0.338632044420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338714118224
                                         uncertainty =       0.003897767690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338714118224
                                         uncertainty =       0.003897767690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411484124
  error estimate for blocks of size 2^( 2) =       0.000424423143
  error estimate for blocks of size 2^( 3) =       0.000437336841
  error estimate for blocks of size 2^( 4) =       0.000449126320
  error estimate for blocks of size 2^( 5) =       0.000461283450
  error estimate for blocks of size 2^( 6) =       0.000470002326
  error estimate for blocks of size 2^( 7) =       0.000475271965

      target function =                  N/A
              le_mean =     -16.907172229087
             les_mean =     286.191110983061
             stat err =       0.000463921015
             autocorr =       1.271106456969
              std dev =       0.581926428652
             le_variance =       0.338638368364


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907172348669        initial  <--
     6.1035e-01     6.1035e+00             3.1872e-04       -16.907171173152
     2.4414e+00     2.4414e+01             8.6384e-05       -16.907171550805
     9.7656e+00     9.7656e+01             2.2092e-05       -16.907172229087

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4239
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.097991e-01 1 1  ON 0
 uu_1                 1.428651e-01 1 1  ON 1
 uu_2                 4.144469e-02 1 1  ON 2
 uu_3                -2.064545e-02 1 1  ON 3
 uu_4                -6.555957e-02 1 1  ON 4
 uu_5                -9.944244e-02 1 1  ON 5
 uu_6                -1.260216e-01 1 1  ON 6
 uu_7                -1.383209e-01 1 1  ON 7
 uu_8                -1.303802e-01 1 1  ON 8
 uu_9                -9.996136e-02 1 1  ON 9
 ud_0                 4.468336e-01 1 1  ON 10
 ud_1                 1.809905e-01 1 1  ON 11
 ud_2                 6.096267e-02 1 1  ON 12
 ud_3                -1.012001e-02 1 1  ON 13
 ud_4                -6.682758e-02 1 1  ON 14
 ud_5                -1.077123e-01 1 1  ON 15
 ud_6                -1.343627e-01 1 1  ON 16
 ud_7                -1.499596e-01 1 1  ON 17
 ud_8                -1.503529e-01 1 1  ON 18
 ud_9                -1.383536e-01 1 1  ON 19
 eO_0                -7.564285e-01 1 1  ON 20
 eO_1                -4.360211e-01 1 1  ON 21
 eO_2                -1.913369e-02 1 1  ON 22
 eO_3                 2.975131e-01 1 1  ON 23
 eO_4                 5.204143e-01 1 1  ON 24
 eO_5                 4.792910e-01 1 1  ON 25
 eO_6                 2.486816e-01 1 1  ON 26
 eO_7                -4.872901e-02 1 1  ON 27
 eO_8                -2.127002e-01 1 1  ON 28
 eO_9                -7.334049e-02 1 1  ON 29
eH1_0                -2.428962e-01 1 1  ON 30
eH1_1                -1.405708e-01 1 1  ON 31
eH1_2                -9.350649e-02 1 1  ON 32
eH1_3                -3.911422e-02 1 1  ON 33
eH1_4                 8.723951e-03 1 1  ON 34
eH1_5                 4.211923e-02 1 1  ON 35
eH1_6                 9.903556e-02 1 1  ON 36
eH1_7                 1.509715e-01 1 1  ON 37
eH1_8                 1.670524e-01 1 1  ON 38
eH1_9                 5.258085e-02 1 1  ON 39
eH2_0                -2.407471e-01 1 1  ON 40
eH2_1                -1.389997e-01 1 1  ON 41
eH2_2                -9.194511e-02 1 1  ON 42
eH2_3                -3.764406e-02 1 1  ON 43
eH2_4                 1.101852e-02 1 1  ON 44
eH2_5                 4.615238e-02 1 1  ON 45
eH2_6                 1.031958e-01 1 1  ON 46
eH2_7                 1.544424e-01 1 1  ON 47
eH2_8                 1.728184e-01 1 1  ON 48
eH2_9                 3.833825e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8625e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9085
    reference variance = 0.470006
====================================================
  Execution time = 2.4111e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3376e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5421e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333745054983
                                         uncertainty =       0.003451782243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333745054983
                                         uncertainty =       0.003451782243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408506750
  error estimate for blocks of size 2^( 2) =       0.000421432517
  error estimate for blocks of size 2^( 3) =       0.000435258707
  error estimate for blocks of size 2^( 4) =       0.000447109820
  error estimate for blocks of size 2^( 5) =       0.000457894779
  error estimate for blocks of size 2^( 6) =       0.000466053284
  error estimate for blocks of size 2^( 7) =       0.000471483641

      target function =                  N/A
              le_mean =     -16.905798974638
             les_mean =     286.139794334113
             stat err =       0.000460635381
             autocorr =       1.271499256291
              std dev =       0.577715786616
             le_variance =       0.333755530106


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690579897464e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905798974638       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905799125246       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905799004955       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905798966419       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905798902002       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905799034736       residual = 8.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905799047598       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905799057729       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 3.133526e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905798974638       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905799013031       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905798981879       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905798971271       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905798952192       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905798983497       residual = 8.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905798988611       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905798991838       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 7.842306e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905798974638       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905798984284       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905798976425       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905798973709       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905798968737       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905798976428       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905798977822       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905798978679       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 1.961107e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.049153 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9660e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.097970e-01 1 1  ON 0
 uu_1                 1.428666e-01 1 1  ON 1
 uu_2                 4.144593e-02 1 1  ON 2
 uu_3                -2.064636e-02 1 1  ON 3
 uu_4                -6.555503e-02 1 1  ON 4
 uu_5                -9.944940e-02 1 1  ON 5
 uu_6                -1.260258e-01 1 1  ON 6
 uu_7                -1.383209e-01 1 1  ON 7
 uu_8                -1.303805e-01 1 1  ON 8
 uu_9                -9.996193e-02 1 1  ON 9
 ud_0                 4.468410e-01 1 1  ON 10
 ud_1                 1.809929e-01 1 1  ON 11
 ud_2                 6.096117e-02 1 1  ON 12
 ud_3                -1.011580e-02 1 1  ON 13
 ud_4                -6.683188e-02 1 1  ON 14
 ud_5                -1.077121e-01 1 1  ON 15
 ud_6                -1.343647e-01 1 1  ON 16
 ud_7                -1.499585e-01 1 1  ON 17
 ud_8                -1.503527e-01 1 1  ON 18
 ud_9                -1.383570e-01 1 1  ON 19
 eO_0                -7.564300e-01 1 1  ON 20
 eO_1                -4.360216e-01 1 1  ON 21
 eO_2                -1.913707e-02 1 1  ON 22
 eO_3                 2.975149e-01 1 1  ON 23
 eO_4                 5.204154e-01 1 1  ON 24
 eO_5                 4.792951e-01 1 1  ON 25
 eO_6                 2.486874e-01 1 1  ON 26
 eO_7                -4.872492e-02 1 1  ON 27
 eO_8                -2.127051e-01 1 1  ON 28
 eO_9                -7.334631e-02 1 1  ON 29
eH1_0                -2.429001e-01 1 1  ON 30
eH1_1                -1.405731e-01 1 1  ON 31
eH1_2                -9.350803e-02 1 1  ON 32
eH1_3                -3.911608e-02 1 1  ON 33
eH1_4                 8.717524e-03 1 1  ON 34
eH1_5                 4.211920e-02 1 1  ON 35
eH1_6                 9.903923e-02 1 1  ON 36
eH1_7                 1.509720e-01 1 1  ON 37
eH1_8                 1.670573e-01 1 1  ON 38
eH1_9                 5.258771e-02 1 1  ON 39
eH2_0                -2.407539e-01 1 1  ON 40
eH2_1                -1.390021e-01 1 1  ON 41
eH2_2                -9.194591e-02 1 1  ON 42
eH2_3                -3.764603e-02 1 1  ON 43
eH2_4                 1.101756e-02 1 1  ON 44
eH2_5                 4.614554e-02 1 1  ON 45
eH2_6                 1.031952e-01 1 1  ON 46
eH2_7                 1.544480e-01 1 1  ON 47
eH2_8                 1.728258e-01 1 1  ON 48
eH2_9                 3.834610e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8178
    reference variance = 0.280733
====================================================
  Execution time = 2.1333e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3743e-01
  Total weights = 2.0000e+06
  Execution time = 1.8477e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337496349203
                                         uncertainty =       0.003327634142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337496349203
                                         uncertainty =       0.003327634142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410744506
  error estimate for blocks of size 2^( 2) =       0.000423495174
  error estimate for blocks of size 2^( 3) =       0.000436595815
  error estimate for blocks of size 2^( 4) =       0.000448840065
  error estimate for blocks of size 2^( 5) =       0.000459356139
  error estimate for blocks of size 2^( 6) =       0.000467223488
  error estimate for blocks of size 2^( 7) =       0.000471357425

      target function =                  N/A
              le_mean =     -16.905372658346
             les_mean =     286.129046647418
             stat err =       0.000461694279
             autocorr =       1.263471528784
              std dev =       0.580880451182
             le_variance =       0.337422098565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337518580036
                                         uncertainty =       0.003327713755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337518580036
                                         uncertainty =       0.003327713755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410758036
  error estimate for blocks of size 2^( 2) =       0.000423508007
  error estimate for blocks of size 2^( 3) =       0.000436608103
  error estimate for blocks of size 2^( 4) =       0.000448852216
  error estimate for blocks of size 2^( 5) =       0.000459368365
  error estimate for blocks of size 2^( 6) =       0.000467234697
  error estimate for blocks of size 2^( 7) =       0.000471369198

      target function =                  N/A
              le_mean =     -16.905372478887
             les_mean =     286.129062809838
             stat err =       0.000461706119
             autocorr =       1.263453093455
              std dev =       0.580899585695
             le_variance =       0.337444328660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337508062112
                                         uncertainty =       0.003327675818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337508062112
                                         uncertainty =       0.003327675818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410751635
  error estimate for blocks of size 2^( 2) =       0.000423501933
  error estimate for blocks of size 2^( 3) =       0.000436602285
  error estimate for blocks of size 2^( 4) =       0.000448846463
  error estimate for blocks of size 2^( 5) =       0.000459362578
  error estimate for blocks of size 2^( 6) =       0.000467229387
  error estimate for blocks of size 2^( 7) =       0.000471363622

      target function =                  N/A
              le_mean =     -16.905372561287
             les_mean =     286.129055078263
             stat err =       0.000461700513
             autocorr =       1.263461789422
              std dev =       0.580890532766
             le_variance =       0.337433811058

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337497832486
                                         uncertainty =       0.003327639413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337497832486
                                         uncertainty =       0.003327639413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410745409
  error estimate for blocks of size 2^( 2) =       0.000423496030
  error estimate for blocks of size 2^( 3) =       0.000436596634
  error estimate for blocks of size 2^( 4) =       0.000448840875
  error estimate for blocks of size 2^( 5) =       0.000459356954
  error estimate for blocks of size 2^( 6) =       0.000467224235
  error estimate for blocks of size 2^( 7) =       0.000471358209

      target function =                  N/A
              le_mean =     -16.905372645860
             les_mean =     286.129047708488
             stat err =       0.000461695068
             autocorr =       1.263470293853
              std dev =       0.580881727888
             le_variance =       0.337423581794


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905372658346        initial  <--
     6.1035e+00     6.1035e+01             3.1335e-05       -16.905372478887
     2.4414e+01     2.4414e+02             7.8423e-06       -16.905372561287
     9.7656e+01     9.7656e+02             1.9611e-06       -16.905372645860

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6261
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.097991e-01 1 1  ON 0
 uu_1                 1.428651e-01 1 1  ON 1
 uu_2                 4.144469e-02 1 1  ON 2
 uu_3                -2.064545e-02 1 1  ON 3
 uu_4                -6.555957e-02 1 1  ON 4
 uu_5                -9.944244e-02 1 1  ON 5
 uu_6                -1.260216e-01 1 1  ON 6
 uu_7                -1.383209e-01 1 1  ON 7
 uu_8                -1.303802e-01 1 1  ON 8
 uu_9                -9.996136e-02 1 1  ON 9
 ud_0                 4.468336e-01 1 1  ON 10
 ud_1                 1.809905e-01 1 1  ON 11
 ud_2                 6.096267e-02 1 1  ON 12
 ud_3                -1.012001e-02 1 1  ON 13
 ud_4                -6.682758e-02 1 1  ON 14
 ud_5                -1.077123e-01 1 1  ON 15
 ud_6                -1.343627e-01 1 1  ON 16
 ud_7                -1.499596e-01 1 1  ON 17
 ud_8                -1.503529e-01 1 1  ON 18
 ud_9                -1.383536e-01 1 1  ON 19
 eO_0                -7.564285e-01 1 1  ON 20
 eO_1                -4.360211e-01 1 1  ON 21
 eO_2                -1.913369e-02 1 1  ON 22
 eO_3                 2.975131e-01 1 1  ON 23
 eO_4                 5.204143e-01 1 1  ON 24
 eO_5                 4.792910e-01 1 1  ON 25
 eO_6                 2.486816e-01 1 1  ON 26
 eO_7                -4.872901e-02 1 1  ON 27
 eO_8                -2.127002e-01 1 1  ON 28
 eO_9                -7.334049e-02 1 1  ON 29
eH1_0                -2.428962e-01 1 1  ON 30
eH1_1                -1.405708e-01 1 1  ON 31
eH1_2                -9.350649e-02 1 1  ON 32
eH1_3                -3.911422e-02 1 1  ON 33
eH1_4                 8.723951e-03 1 1  ON 34
eH1_5                 4.211923e-02 1 1  ON 35
eH1_6                 9.903556e-02 1 1  ON 36
eH1_7                 1.509715e-01 1 1  ON 37
eH1_8                 1.670524e-01 1 1  ON 38
eH1_9                 5.258085e-02 1 1  ON 39
eH2_0                -2.407471e-01 1 1  ON 40
eH2_1                -1.389997e-01 1 1  ON 41
eH2_2                -9.194511e-02 1 1  ON 42
eH2_3                -3.764406e-02 1 1  ON 43
eH2_4                 1.101852e-02 1 1  ON 44
eH2_5                 4.615238e-02 1 1  ON 45
eH2_6                 1.031958e-01 1 1  ON 46
eH2_7                 1.544424e-01 1 1  ON 47
eH2_8                 1.728184e-01 1 1  ON 48
eH2_9                 3.833825e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.1224e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.902
    reference variance = 0.265519
====================================================
  Execution time = 2.1590e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3934e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6096e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339410644021
                                         uncertainty =       0.004156985168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339410644021
                                         uncertainty =       0.004156985168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411909308
  error estimate for blocks of size 2^( 2) =       0.000424486297
  error estimate for blocks of size 2^( 3) =       0.000437355760
  error estimate for blocks of size 2^( 4) =       0.000449773777
  error estimate for blocks of size 2^( 5) =       0.000459822965
  error estimate for blocks of size 2^( 6) =       0.000468424117
  error estimate for blocks of size 2^( 7) =       0.000473410042

      target function =                  N/A
              le_mean =     -16.904986684447
             les_mean =     286.117913187268
             stat err =       0.000462857725
             autocorr =       1.262675698433
              std dev =       0.582527729485
             le_variance =       0.339338555619


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690498668445e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904986684447       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904986690625       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904986691128       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904986698366       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904986698380       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904986698321       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904986697043       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904986697996       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 3.744402e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904986684447       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904986685995       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904986686119       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904986687935       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904986687954       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904986687941       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904986687610       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904986687845       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 9.387569e-07

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904986684447       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904986684834       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904986684865       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904986685320       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904986685325       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904986685322       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904986685238       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904986685295       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 2.348556e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.051889 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7206e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.097996e-01 1 1  ON 0
 uu_1                 1.428654e-01 1 1  ON 1
 uu_2                 4.144457e-02 1 1  ON 2
 uu_3                -2.064534e-02 1 1  ON 3
 uu_4                -6.555953e-02 1 1  ON 4
 uu_5                -9.944248e-02 1 1  ON 5
 uu_6                -1.260222e-01 1 1  ON 6
 uu_7                -1.383217e-01 1 1  ON 7
 uu_8                -1.303806e-01 1 1  ON 8
 uu_9                -9.996160e-02 1 1  ON 9
 ud_0                 4.468345e-01 1 1  ON 10
 ud_1                 1.809908e-01 1 1  ON 11
 ud_2                 6.096235e-02 1 1  ON 12
 ud_3                -1.012010e-02 1 1  ON 13
 ud_4                -6.682776e-02 1 1  ON 14
 ud_5                -1.077122e-01 1 1  ON 15
 ud_6                -1.343625e-01 1 1  ON 16
 ud_7                -1.499597e-01 1 1  ON 17
 ud_8                -1.503530e-01 1 1  ON 18
 ud_9                -1.383537e-01 1 1  ON 19
 eO_0                -7.564287e-01 1 1  ON 20
 eO_1                -4.360214e-01 1 1  ON 21
 eO_2                -1.913350e-02 1 1  ON 22
 eO_3                 2.975131e-01 1 1  ON 23
 eO_4                 5.204144e-01 1 1  ON 24
 eO_5                 4.792915e-01 1 1  ON 25
 eO_6                 2.486821e-01 1 1  ON 26
 eO_7                -4.872872e-02 1 1  ON 27
 eO_8                -2.127008e-01 1 1  ON 28
 eO_9                -7.334107e-02 1 1  ON 29
eH1_0                -2.428967e-01 1 1  ON 30
eH1_1                -1.405712e-01 1 1  ON 31
eH1_2                -9.350643e-02 1 1  ON 32
eH1_3                -3.911462e-02 1 1  ON 33
eH1_4                 8.723362e-03 1 1  ON 34
eH1_5                 4.211899e-02 1 1  ON 35
eH1_6                 9.903592e-02 1 1  ON 36
eH1_7                 1.509719e-01 1 1  ON 37
eH1_8                 1.670531e-01 1 1  ON 38
eH1_9                 5.258141e-02 1 1  ON 39
eH2_0                -2.407480e-01 1 1  ON 40
eH2_1                -1.389998e-01 1 1  ON 41
eH2_2                -9.194502e-02 1 1  ON 42
eH2_3                -3.764387e-02 1 1  ON 43
eH2_4                 1.101800e-02 1 1  ON 44
eH2_5                 4.615223e-02 1 1  ON 45
eH2_6                 1.031959e-01 1 1  ON 46
eH2_7                 1.544423e-01 1 1  ON 47
eH2_8                 1.728189e-01 1 1  ON 48
eH2_9                 3.833908e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9104
    reference variance = 0.204086
====================================================
  Execution time = 1.9985e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4105e-01
  Total weights = 2.0000e+06
  Execution time = 1.8500e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341038573997
                                         uncertainty =       0.004823364393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341038573997
                                         uncertainty =       0.004823364393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412943529
  error estimate for blocks of size 2^( 2) =       0.000425601160
  error estimate for blocks of size 2^( 3) =       0.000438478211
  error estimate for blocks of size 2^( 4) =       0.000450669912
  error estimate for blocks of size 2^( 5) =       0.000460940963
  error estimate for blocks of size 2^( 6) =       0.000467824436
  error estimate for blocks of size 2^( 7) =       0.000472583726

      target function =                  N/A
              le_mean =     -16.905845857904
             les_mean =     286.148668716204
             stat err =       0.000463004759
             autocorr =       1.257157183782
              std dev =       0.583990338545
             le_variance =       0.341044715514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341042737216
                                         uncertainty =       0.004823427658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341042737216
                                         uncertainty =       0.004823427658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412946049
  error estimate for blocks of size 2^( 2) =       0.000425603530
  error estimate for blocks of size 2^( 3) =       0.000438480429
  error estimate for blocks of size 2^( 4) =       0.000450672006
  error estimate for blocks of size 2^( 5) =       0.000460943011
  error estimate for blocks of size 2^( 6) =       0.000467826493
  error estimate for blocks of size 2^( 7) =       0.000472585676

      target function =                  N/A
              le_mean =     -16.905845885337
             les_mean =     286.148673807472
             stat err =       0.000463006796
             autocorr =       1.257152897682
              std dev =       0.583993903408
             le_variance =       0.341048879218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341040664121
                                         uncertainty =       0.004823396125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341040664121
                                         uncertainty =       0.004823396125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412944794
  error estimate for blocks of size 2^( 2) =       0.000425602350
  error estimate for blocks of size 2^( 3) =       0.000438479324
  error estimate for blocks of size 2^( 4) =       0.000450670963
  error estimate for blocks of size 2^( 5) =       0.000460941991
  error estimate for blocks of size 2^( 6) =       0.000467825468
  error estimate for blocks of size 2^( 7) =       0.000472584705

      target function =                  N/A
              le_mean =     -16.905845871647
             les_mean =     286.148671271236
             stat err =       0.000463005782
             autocorr =       1.257155030950
              std dev =       0.583992128269
             le_variance =       0.341046805880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341038835522
                                         uncertainty =       0.004823368363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341038835522
                                         uncertainty =       0.004823368363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412943687
  error estimate for blocks of size 2^( 2) =       0.000425601309
  error estimate for blocks of size 2^( 3) =       0.000438478350
  error estimate for blocks of size 2^( 4) =       0.000450670043
  error estimate for blocks of size 2^( 5) =       0.000460941091
  error estimate for blocks of size 2^( 6) =       0.000467824565
  error estimate for blocks of size 2^( 7) =       0.000472583849

      target function =                  N/A
              le_mean =     -16.905845859621
             les_mean =     286.148669035820
             stat err =       0.000463004887
             autocorr =       1.257156914352
              std dev =       0.583990562483
             le_variance =       0.341044977069


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905845857904        initial
     6.1035e+01     6.1035e+02             3.7444e-06       -16.905845885337  <--
     2.4414e+02     2.4414e+03             9.3876e-07       -16.905845871647
     9.7656e+02     9.7656e+03             2.3486e-07       -16.905845859621

*****************************************************************************
Applying the update for shift_i =   6.1035e+01     and shift_s =   6.1035e+02
*****************************************************************************

  Execution time = 2.9283e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428663e-01 1 1  ON 1
 uu_2                 4.144422e-02 1 1  ON 2
 uu_3                -2.064504e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944259e-02 1 1  ON 5
 uu_6                -1.260238e-01 1 1  ON 6
 uu_7                -1.383240e-01 1 1  ON 7
 uu_8                -1.303815e-01 1 1  ON 8
 uu_9                -9.996234e-02 1 1  ON 9
 ud_0                 4.468373e-01 1 1  ON 10
 ud_1                 1.809919e-01 1 1  ON 11
 ud_2                 6.096142e-02 1 1  ON 12
 ud_3                -1.012038e-02 1 1  ON 13
 ud_4                -6.682831e-02 1 1  ON 14
 ud_5                -1.077118e-01 1 1  ON 15
 ud_6                -1.343621e-01 1 1  ON 16
 ud_7                -1.499600e-01 1 1  ON 17
 ud_8                -1.503534e-01 1 1  ON 18
 ud_9                -1.383542e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360221e-01 1 1  ON 21
 eO_2                -1.913290e-02 1 1  ON 22
 eO_3                 2.975131e-01 1 1  ON 23
 eO_4                 5.204149e-01 1 1  ON 24
 eO_5                 4.792930e-01 1 1  ON 25
 eO_6                 2.486837e-01 1 1  ON 26
 eO_7                -4.872785e-02 1 1  ON 27
 eO_8                -2.127027e-01 1 1  ON 28
 eO_9                -7.334280e-02 1 1  ON 29
eH1_0                -2.428979e-01 1 1  ON 30
eH1_1                -1.405723e-01 1 1  ON 31
eH1_2                -9.350628e-02 1 1  ON 32
eH1_3                -3.911580e-02 1 1  ON 33
eH1_4                 8.721598e-03 1 1  ON 34
eH1_5                 4.211829e-02 1 1  ON 35
eH1_6                 9.903701e-02 1 1  ON 36
eH1_7                 1.509734e-01 1 1  ON 37
eH1_8                 1.670550e-01 1 1  ON 38
eH1_9                 5.258306e-02 1 1  ON 39
eH2_0                -2.407507e-01 1 1  ON 40
eH2_1                -1.390001e-01 1 1  ON 41
eH2_2                -9.194475e-02 1 1  ON 42
eH2_3                -3.764329e-02 1 1  ON 43
eH2_4                 1.101644e-02 1 1  ON 44
eH2_5                 4.615177e-02 1 1  ON 45
eH2_6                 1.031961e-01 1 1  ON 46
eH2_7                 1.544421e-01 1 1  ON 47
eH2_8                 1.728203e-01 1 1  ON 48
eH2_9                 3.834157e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6765e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.7937
    reference variance = 0.645384
====================================================
  Execution time = 2.1691e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 4.0732e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5432e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.407143631842
                                         uncertainty =       0.056937138519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.407143631842
                                         uncertainty =       0.056937138519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000451289511
  error estimate for blocks of size 2^( 2) =       0.000462660274
  error estimate for blocks of size 2^( 3) =       0.000474923901
  error estimate for blocks of size 2^( 4) =       0.000486594736
  error estimate for blocks of size 2^( 5) =       0.000497521176
  error estimate for blocks of size 2^( 6) =       0.000505467159
  error estimate for blocks of size 2^( 7) =       0.000510701655

      target function =                  N/A
              le_mean =     -16.905655468246
             les_mean =     286.208511052551
             stat err =       0.000500071181
             autocorr =       1.227872225012
              std dev =       0.638219746787
             le_variance =       0.407324445189


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690565546825e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905655468246       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905655533603       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905655493675       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905655502936       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905655505349       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905655493233       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905655510296       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905655500191       residual = 3.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.442253e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905655468246       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905655484748       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905655474604       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905655476885       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905655477584       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905655474462       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905655478651       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905655476152       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 3.633291e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905655468246       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905655472382       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905655469835       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905655470403       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905655470584       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905655469797       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905655470838       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905655470217       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 9.100246e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.054553 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7241e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.098006e-01 1 1  ON 0
 uu_1                 1.428670e-01 1 1  ON 1
 uu_2                 4.144407e-02 1 1  ON 2
 uu_3                -2.064459e-02 1 1  ON 3
 uu_4                -6.556029e-02 1 1  ON 4
 uu_5                -9.944373e-02 1 1  ON 5
 uu_6                -1.260236e-01 1 1  ON 6
 uu_7                -1.383249e-01 1 1  ON 7
 uu_8                -1.303819e-01 1 1  ON 8
 uu_9                -9.996304e-02 1 1  ON 9
 ud_0                 4.468409e-01 1 1  ON 10
 ud_1                 1.809939e-01 1 1  ON 11
 ud_2                 6.095948e-02 1 1  ON 12
 ud_3                -1.012118e-02 1 1  ON 13
 ud_4                -6.682786e-02 1 1  ON 14
 ud_5                -1.077138e-01 1 1  ON 15
 ud_6                -1.343623e-01 1 1  ON 16
 ud_7                -1.499602e-01 1 1  ON 17
 ud_8                -1.503541e-01 1 1  ON 18
 ud_9                -1.383546e-01 1 1  ON 19
 eO_0                -7.564303e-01 1 1  ON 20
 eO_1                -4.360221e-01 1 1  ON 21
 eO_2                -1.913276e-02 1 1  ON 22
 eO_3                 2.975129e-01 1 1  ON 23
 eO_4                 5.204146e-01 1 1  ON 24
 eO_5                 4.792934e-01 1 1  ON 25
 eO_6                 2.486873e-01 1 1  ON 26
 eO_7                -4.872623e-02 1 1  ON 27
 eO_8                -2.127043e-01 1 1  ON 28
 eO_9                -7.334500e-02 1 1  ON 29
eH1_0                -2.428997e-01 1 1  ON 30
eH1_1                -1.405726e-01 1 1  ON 31
eH1_2                -9.350735e-02 1 1  ON 32
eH1_3                -3.911789e-02 1 1  ON 33
eH1_4                 8.720741e-03 1 1  ON 34
eH1_5                 4.211674e-02 1 1  ON 35
eH1_6                 9.903686e-02 1 1  ON 36
eH1_7                 1.509752e-01 1 1  ON 37
eH1_8                 1.670579e-01 1 1  ON 38
eH1_9                 5.258592e-02 1 1  ON 39
eH2_0                -2.407541e-01 1 1  ON 40
eH2_1                -1.390030e-01 1 1  ON 41
eH2_2                -9.194449e-02 1 1  ON 42
eH2_3                -3.764386e-02 1 1  ON 43
eH2_4                 1.101798e-02 1 1  ON 44
eH2_5                 4.615048e-02 1 1  ON 45
eH2_6                 1.031953e-01 1 1  ON 46
eH2_7                 1.544435e-01 1 1  ON 47
eH2_8                 1.728232e-01 1 1  ON 48
eH2_9                 3.834464e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8744
    reference variance = 0.192189
====================================================
  Execution time = 2.0133e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3468e-01
  Total weights = 2.0000e+06
  Execution time = 1.8486e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334675132037
                                         uncertainty =       0.003822213303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334675132037
                                         uncertainty =       0.003822213303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409070392
  error estimate for blocks of size 2^( 2) =       0.000421833229
  error estimate for blocks of size 2^( 3) =       0.000435113401
  error estimate for blocks of size 2^( 4) =       0.000447604917
  error estimate for blocks of size 2^( 5) =       0.000458642897
  error estimate for blocks of size 2^( 6) =       0.000467020015
  error estimate for blocks of size 2^( 7) =       0.000471808455

      target function =                  N/A
              le_mean =     -16.906397970285
             les_mean =     286.160969333299
             stat err =       0.000461269071
             autocorr =       1.271488909858
              std dev =       0.578512896129
             le_variance =       0.334677170988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334689186171
                                         uncertainty =       0.003822340543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334689186171
                                         uncertainty =       0.003822340543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409078981
  error estimate for blocks of size 2^( 2) =       0.000421841269
  error estimate for blocks of size 2^( 3) =       0.000435120769
  error estimate for blocks of size 2^( 4) =       0.000447611934
  error estimate for blocks of size 2^( 5) =       0.000458649806
  error estimate for blocks of size 2^( 6) =       0.000467026851
  error estimate for blocks of size 2^( 7) =       0.000471814591

      target function =                  N/A
              le_mean =     -16.906397904641
             les_mean =     286.160981167398
             stat err =       0.000461275795
             autocorr =       1.271472591805
              std dev =       0.578525042408
             le_variance =       0.334691224693

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334682251773
                                         uncertainty =       0.003822277843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334682251773
                                         uncertainty =       0.003822277843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409074743
  error estimate for blocks of size 2^( 2) =       0.000421837302
  error estimate for blocks of size 2^( 3) =       0.000435117131
  error estimate for blocks of size 2^( 4) =       0.000447608469
  error estimate for blocks of size 2^( 5) =       0.000458646394
  error estimate for blocks of size 2^( 6) =       0.000467023475
  error estimate for blocks of size 2^( 7) =       0.000471811557

      target function =                  N/A
              le_mean =     -16.906397936682
             les_mean =     286.160975316576
             stat err =       0.000461272474
             autocorr =       1.271480622646
              std dev =       0.578519049366
             le_variance =       0.334684290479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334676024789
                                         uncertainty =       0.003822221401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334676024789
                                         uncertainty =       0.003822221401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409070937
  error estimate for blocks of size 2^( 2) =       0.000421833740
  error estimate for blocks of size 2^( 3) =       0.000435113869
  error estimate for blocks of size 2^( 4) =       0.000447605362
  error estimate for blocks of size 2^( 5) =       0.000458643335
  error estimate for blocks of size 2^( 6) =       0.000467020449
  error estimate for blocks of size 2^( 7) =       0.000471808843

      target function =                  N/A
              le_mean =     -16.906397966033
             les_mean =     286.160970082244
             stat err =       0.000461269497
             autocorr =       1.271487869776
              std dev =       0.578513667694
             le_variance =       0.334678063709


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906397970285        initial  <--
     1.5259e+01     1.5259e+02             1.4423e-05       -16.906397904641
     6.1035e+01     6.1035e+02             3.6333e-06       -16.906397936682
     2.4414e+02     2.4414e+03             9.1002e-07       -16.906397966033

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4041
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428663e-01 1 1  ON 1
 uu_2                 4.144422e-02 1 1  ON 2
 uu_3                -2.064504e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944259e-02 1 1  ON 5
 uu_6                -1.260238e-01 1 1  ON 6
 uu_7                -1.383240e-01 1 1  ON 7
 uu_8                -1.303815e-01 1 1  ON 8
 uu_9                -9.996234e-02 1 1  ON 9
 ud_0                 4.468373e-01 1 1  ON 10
 ud_1                 1.809919e-01 1 1  ON 11
 ud_2                 6.096142e-02 1 1  ON 12
 ud_3                -1.012038e-02 1 1  ON 13
 ud_4                -6.682831e-02 1 1  ON 14
 ud_5                -1.077118e-01 1 1  ON 15
 ud_6                -1.343621e-01 1 1  ON 16
 ud_7                -1.499600e-01 1 1  ON 17
 ud_8                -1.503534e-01 1 1  ON 18
 ud_9                -1.383542e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360221e-01 1 1  ON 21
 eO_2                -1.913290e-02 1 1  ON 22
 eO_3                 2.975131e-01 1 1  ON 23
 eO_4                 5.204149e-01 1 1  ON 24
 eO_5                 4.792930e-01 1 1  ON 25
 eO_6                 2.486837e-01 1 1  ON 26
 eO_7                -4.872785e-02 1 1  ON 27
 eO_8                -2.127027e-01 1 1  ON 28
 eO_9                -7.334280e-02 1 1  ON 29
eH1_0                -2.428979e-01 1 1  ON 30
eH1_1                -1.405723e-01 1 1  ON 31
eH1_2                -9.350628e-02 1 1  ON 32
eH1_3                -3.911580e-02 1 1  ON 33
eH1_4                 8.721598e-03 1 1  ON 34
eH1_5                 4.211829e-02 1 1  ON 35
eH1_6                 9.903701e-02 1 1  ON 36
eH1_7                 1.509734e-01 1 1  ON 37
eH1_8                 1.670550e-01 1 1  ON 38
eH1_9                 5.258306e-02 1 1  ON 39
eH2_0                -2.407507e-01 1 1  ON 40
eH2_1                -1.390001e-01 1 1  ON 41
eH2_2                -9.194475e-02 1 1  ON 42
eH2_3                -3.764329e-02 1 1  ON 43
eH2_4                 1.101644e-02 1 1  ON 44
eH2_5                 4.615177e-02 1 1  ON 45
eH2_6                 1.031961e-01 1 1  ON 46
eH2_7                 1.544421e-01 1 1  ON 47
eH2_8                 1.728203e-01 1 1  ON 48
eH2_9                 3.834157e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6945e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8392
    reference variance = 0.18171
====================================================
  Execution time = 2.0769e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4125e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5801e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341354576287
                                         uncertainty =       0.004639720229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341354576287
                                         uncertainty =       0.004639720229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413066683
  error estimate for blocks of size 2^( 2) =       0.000426008795
  error estimate for blocks of size 2^( 3) =       0.000439306656
  error estimate for blocks of size 2^( 4) =       0.000451908855
  error estimate for blocks of size 2^( 5) =       0.000463262302
  error estimate for blocks of size 2^( 6) =       0.000473384689
  error estimate for blocks of size 2^( 7) =       0.000478418360

      target function =                  N/A
              le_mean =     -16.906034470884
             les_mean =     286.155249529892
             stat err =       0.000466743552
             autocorr =       1.276780726001
              std dev =       0.584164505754
             le_variance =       0.341248169783


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690603447088e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906034470884       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906034477696       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906034481764       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906034486169       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906034488331       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906034491854       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906034489750       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906034490071       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.459194e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906034470884       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906034472589       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906034473608       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906034474711       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906034475253       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906034476136       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906034475611       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906034475691       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 3.648149e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906034470884       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906034471311       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906034471566       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906034471841       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906034471975       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906034472198       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906034472067       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906034472086       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 9.120474e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.057154 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6356e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.098013e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144414e-02 1 1  ON 2
 uu_3                -2.064511e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944261e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383240e-01 1 1  ON 7
 uu_8                -1.303817e-01 1 1  ON 8
 uu_9                -9.996255e-02 1 1  ON 9
 ud_0                 4.468372e-01 1 1  ON 10
 ud_1                 1.809922e-01 1 1  ON 11
 ud_2                 6.096142e-02 1 1  ON 12
 ud_3                -1.012012e-02 1 1  ON 13
 ud_4                -6.682833e-02 1 1  ON 14
 ud_5                -1.077118e-01 1 1  ON 15
 ud_6                -1.343621e-01 1 1  ON 16
 ud_7                -1.499600e-01 1 1  ON 17
 ud_8                -1.503534e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360221e-01 1 1  ON 21
 eO_2                -1.913285e-02 1 1  ON 22
 eO_3                 2.975132e-01 1 1  ON 23
 eO_4                 5.204149e-01 1 1  ON 24
 eO_5                 4.792931e-01 1 1  ON 25
 eO_6                 2.486839e-01 1 1  ON 26
 eO_7                -4.872775e-02 1 1  ON 27
 eO_8                -2.127029e-01 1 1  ON 28
 eO_9                -7.334304e-02 1 1  ON 29
eH1_0                -2.428981e-01 1 1  ON 30
eH1_1                -1.405724e-01 1 1  ON 31
eH1_2                -9.350624e-02 1 1  ON 32
eH1_3                -3.911596e-02 1 1  ON 33
eH1_4                 8.721681e-03 1 1  ON 34
eH1_5                 4.211831e-02 1 1  ON 35
eH1_6                 9.903701e-02 1 1  ON 36
eH1_7                 1.509734e-01 1 1  ON 37
eH1_8                 1.670552e-01 1 1  ON 38
eH1_9                 5.258328e-02 1 1  ON 39
eH2_0                -2.407509e-01 1 1  ON 40
eH2_1                -1.390003e-01 1 1  ON 41
eH2_2                -9.194479e-02 1 1  ON 42
eH2_3                -3.764323e-02 1 1  ON 43
eH2_4                 1.101626e-02 1 1  ON 44
eH2_5                 4.615154e-02 1 1  ON 45
eH2_6                 1.031961e-01 1 1  ON 46
eH2_7                 1.544423e-01 1 1  ON 47
eH2_8                 1.728206e-01 1 1  ON 48
eH2_9                 3.834193e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9245
    reference variance = 0.240059
====================================================
  Execution time = 2.1011e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4079e-01
  Total weights = 2.0000e+06
  Execution time = 1.8434e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340777880080
                                         uncertainty =       0.006245875874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340777880080
                                         uncertainty =       0.006245875874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412789281
  error estimate for blocks of size 2^( 2) =       0.000425738972
  error estimate for blocks of size 2^( 3) =       0.000439005252
  error estimate for blocks of size 2^( 4) =       0.000451840298
  error estimate for blocks of size 2^( 5) =       0.000462978094
  error estimate for blocks of size 2^( 6) =       0.000471616910
  error estimate for blocks of size 2^( 7) =       0.000478810772

      target function =                  N/A
              le_mean =     -16.905935213952
             les_mean =     286.151435268380
             stat err =       0.000466311518
             autocorr =       1.276131603652
              std dev =       0.583772199089
             le_variance =       0.340789980429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340777723374
                                         uncertainty =       0.006245864842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340777723374
                                         uncertainty =       0.006245864842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412789186
  error estimate for blocks of size 2^( 2) =       0.000425738872
  error estimate for blocks of size 2^( 3) =       0.000439005143
  error estimate for blocks of size 2^( 4) =       0.000451840167
  error estimate for blocks of size 2^( 5) =       0.000462977973
  error estimate for blocks of size 2^( 6) =       0.000471616803
  error estimate for blocks of size 2^( 7) =       0.000478810656

      target function =                  N/A
              le_mean =     -16.905935207045
             les_mean =     286.151434878226
             stat err =       0.000466311400
             autocorr =       1.276131541733
              std dev =       0.583772064949
             le_variance =       0.340789823815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340777801377
                                         uncertainty =       0.006245870340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340777801377
                                         uncertainty =       0.006245870340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412789233
  error estimate for blocks of size 2^( 2) =       0.000425738922
  error estimate for blocks of size 2^( 3) =       0.000439005197
  error estimate for blocks of size 2^( 4) =       0.000451840232
  error estimate for blocks of size 2^( 5) =       0.000462978033
  error estimate for blocks of size 2^( 6) =       0.000471616856
  error estimate for blocks of size 2^( 7) =       0.000478810714

      target function =                  N/A
              le_mean =     -16.905935210479
             les_mean =     286.151435072306
             stat err =       0.000466311459
             autocorr =       1.276131572635
              std dev =       0.583772131720
             le_variance =       0.340789901773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340777870230
                                         uncertainty =       0.006245875182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340777870230
                                         uncertainty =       0.006245875182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412789275
  error estimate for blocks of size 2^( 2) =       0.000425738966
  error estimate for blocks of size 2^( 3) =       0.000439005245
  error estimate for blocks of size 2^( 4) =       0.000451840290
  error estimate for blocks of size 2^( 5) =       0.000462978087
  error estimate for blocks of size 2^( 6) =       0.000471616903
  error estimate for blocks of size 2^( 7) =       0.000478810764

      target function =                  N/A
              le_mean =     -16.905935213517
             les_mean =     286.151435243832
             stat err =       0.000466311511
             autocorr =       1.276131599770
              std dev =       0.583772190657
             le_variance =       0.340789970585


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905935213952        initial  <--
     1.5259e+02     1.5259e+03             1.4592e-06       -16.905935207045
     6.1035e+02     6.1035e+03             3.6481e-07       -16.905935210479
     2.4414e+03     2.4414e+04             9.1205e-08       -16.905935213517

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2959
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428663e-01 1 1  ON 1
 uu_2                 4.144422e-02 1 1  ON 2
 uu_3                -2.064504e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944259e-02 1 1  ON 5
 uu_6                -1.260238e-01 1 1  ON 6
 uu_7                -1.383240e-01 1 1  ON 7
 uu_8                -1.303815e-01 1 1  ON 8
 uu_9                -9.996234e-02 1 1  ON 9
 ud_0                 4.468373e-01 1 1  ON 10
 ud_1                 1.809919e-01 1 1  ON 11
 ud_2                 6.096142e-02 1 1  ON 12
 ud_3                -1.012038e-02 1 1  ON 13
 ud_4                -6.682831e-02 1 1  ON 14
 ud_5                -1.077118e-01 1 1  ON 15
 ud_6                -1.343621e-01 1 1  ON 16
 ud_7                -1.499600e-01 1 1  ON 17
 ud_8                -1.503534e-01 1 1  ON 18
 ud_9                -1.383542e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360221e-01 1 1  ON 21
 eO_2                -1.913290e-02 1 1  ON 22
 eO_3                 2.975131e-01 1 1  ON 23
 eO_4                 5.204149e-01 1 1  ON 24
 eO_5                 4.792930e-01 1 1  ON 25
 eO_6                 2.486837e-01 1 1  ON 26
 eO_7                -4.872785e-02 1 1  ON 27
 eO_8                -2.127027e-01 1 1  ON 28
 eO_9                -7.334280e-02 1 1  ON 29
eH1_0                -2.428979e-01 1 1  ON 30
eH1_1                -1.405723e-01 1 1  ON 31
eH1_2                -9.350628e-02 1 1  ON 32
eH1_3                -3.911580e-02 1 1  ON 33
eH1_4                 8.721598e-03 1 1  ON 34
eH1_5                 4.211829e-02 1 1  ON 35
eH1_6                 9.903701e-02 1 1  ON 36
eH1_7                 1.509734e-01 1 1  ON 37
eH1_8                 1.670550e-01 1 1  ON 38
eH1_9                 5.258306e-02 1 1  ON 39
eH2_0                -2.407507e-01 1 1  ON 40
eH2_1                -1.390001e-01 1 1  ON 41
eH2_2                -9.194475e-02 1 1  ON 42
eH2_3                -3.764329e-02 1 1  ON 43
eH2_4                 1.101644e-02 1 1  ON 44
eH2_5                 4.615177e-02 1 1  ON 45
eH2_6                 1.031961e-01 1 1  ON 46
eH2_7                 1.544421e-01 1 1  ON 47
eH2_8                 1.728203e-01 1 1  ON 48
eH2_9                 3.834157e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6981e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9083
    reference variance = 0.547881
====================================================
  Execution time = 2.0411e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3467e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5283e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334754424448
                                         uncertainty =       0.004087802085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334754424448
                                         uncertainty =       0.004087802085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409065105
  error estimate for blocks of size 2^( 2) =       0.000422261603
  error estimate for blocks of size 2^( 3) =       0.000435094927
  error estimate for blocks of size 2^( 4) =       0.000447567400
  error estimate for blocks of size 2^( 5) =       0.000457807367
  error estimate for blocks of size 2^( 6) =       0.000464060730
  error estimate for blocks of size 2^( 7) =       0.000469654971

      target function =                  N/A
              le_mean =     -16.904978505649
             les_mean =     286.112966629797
             stat err =       0.000459772617
             autocorr =       1.263284990719
              std dev =       0.578505419741
             le_variance =       0.334668520669


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690497850565e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904978505649       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904978506355       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904978506662       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904978506574       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904978506451       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904978506435       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904978506455       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904978506500       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.225822e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904978505649       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904978505826       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904978505903       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904978505882       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904978505856       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904978505845       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904978505852       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904978505857       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 3.064637e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904978505649       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904978505693       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904978505713       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904978505707       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904978505696       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904978505682       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904978505698       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904978505679       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 7.661642e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.059782 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5946e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428663e-01 1 1  ON 1
 uu_2                 4.144423e-02 1 1  ON 2
 uu_3                -2.064504e-02 1 1  ON 3
 uu_4                -6.555939e-02 1 1  ON 4
 uu_5                -9.944259e-02 1 1  ON 5
 uu_6                -1.260238e-01 1 1  ON 6
 uu_7                -1.383240e-01 1 1  ON 7
 uu_8                -1.303815e-01 1 1  ON 8
 uu_9                -9.996235e-02 1 1  ON 9
 ud_0                 4.468373e-01 1 1  ON 10
 ud_1                 1.809919e-01 1 1  ON 11
 ud_2                 6.096141e-02 1 1  ON 12
 ud_3                -1.012035e-02 1 1  ON 13
 ud_4                -6.682832e-02 1 1  ON 14
 ud_5                -1.077118e-01 1 1  ON 15
 ud_6                -1.343621e-01 1 1  ON 16
 ud_7                -1.499600e-01 1 1  ON 17
 ud_8                -1.503534e-01 1 1  ON 18
 ud_9                -1.383542e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360222e-01 1 1  ON 21
 eO_2                -1.913292e-02 1 1  ON 22
 eO_3                 2.975131e-01 1 1  ON 23
 eO_4                 5.204150e-01 1 1  ON 24
 eO_5                 4.792931e-01 1 1  ON 25
 eO_6                 2.486837e-01 1 1  ON 26
 eO_7                -4.872784e-02 1 1  ON 27
 eO_8                -2.127027e-01 1 1  ON 28
 eO_9                -7.334282e-02 1 1  ON 29
eH1_0                -2.428979e-01 1 1  ON 30
eH1_1                -1.405723e-01 1 1  ON 31
eH1_2                -9.350627e-02 1 1  ON 32
eH1_3                -3.911582e-02 1 1  ON 33
eH1_4                 8.721589e-03 1 1  ON 34
eH1_5                 4.211829e-02 1 1  ON 35
eH1_6                 9.903701e-02 1 1  ON 36
eH1_7                 1.509734e-01 1 1  ON 37
eH1_8                 1.670551e-01 1 1  ON 38
eH1_9                 5.258309e-02 1 1  ON 39
eH2_0                -2.407507e-01 1 1  ON 40
eH2_1                -1.390001e-01 1 1  ON 41
eH2_2                -9.194477e-02 1 1  ON 42
eH2_3                -3.764328e-02 1 1  ON 43
eH2_4                 1.101642e-02 1 1  ON 44
eH2_5                 4.615175e-02 1 1  ON 45
eH2_6                 1.031961e-01 1 1  ON 46
eH2_7                 1.544421e-01 1 1  ON 47
eH2_8                 1.728203e-01 1 1  ON 48
eH2_9                 3.834159e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8343
    reference variance = 0.169426
====================================================
  Execution time = 2.0588e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4276e-01
  Total weights = 2.0000e+06
  Execution time = 1.8442e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342727838699
                                         uncertainty =       0.005180591701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342727838699
                                         uncertainty =       0.005180591701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413983151
  error estimate for blocks of size 2^( 2) =       0.000426640804
  error estimate for blocks of size 2^( 3) =       0.000440037375
  error estimate for blocks of size 2^( 4) =       0.000452239598
  error estimate for blocks of size 2^( 5) =       0.000463153905
  error estimate for blocks of size 2^( 6) =       0.000471088090
  error estimate for blocks of size 2^( 7) =       0.000477284707

      target function =                  N/A
              le_mean =     -16.905912720204
             les_mean =     286.152648830442
             stat err =       0.000465941575
             autocorr =       1.266769489100
              std dev =       0.585460586787
             le_variance =       0.342764098681

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342727943442
                                         uncertainty =       0.005180592624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342727943442
                                         uncertainty =       0.005180592624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413983214
  error estimate for blocks of size 2^( 2) =       0.000426640863
  error estimate for blocks of size 2^( 3) =       0.000440037428
  error estimate for blocks of size 2^( 4) =       0.000452239647
  error estimate for blocks of size 2^( 5) =       0.000463153954
  error estimate for blocks of size 2^( 6) =       0.000471088141
  error estimate for blocks of size 2^( 7) =       0.000477284754

      target function =                  N/A
              le_mean =     -16.905912721156
             les_mean =     286.152648967539
             stat err =       0.000465941624
             autocorr =       1.266769369511
              std dev =       0.585460676357
             le_variance =       0.342764203560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342727891080
                                         uncertainty =       0.005180592163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342727891080
                                         uncertainty =       0.005180592163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413983183
  error estimate for blocks of size 2^( 2) =       0.000426640834
  error estimate for blocks of size 2^( 3) =       0.000440037401
  error estimate for blocks of size 2^( 4) =       0.000452239622
  error estimate for blocks of size 2^( 5) =       0.000463153929
  error estimate for blocks of size 2^( 6) =       0.000471088115
  error estimate for blocks of size 2^( 7) =       0.000477284731

      target function =                  N/A
              le_mean =     -16.905912720680
             les_mean =     286.152648899004
             stat err =       0.000465941599
             autocorr =       1.266769429289
              std dev =       0.585460631581
             le_variance =       0.342764151131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342727845247
                                         uncertainty =       0.005180591758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342727845247
                                         uncertainty =       0.005180591758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413983155
  error estimate for blocks of size 2^( 2) =       0.000426640808
  error estimate for blocks of size 2^( 3) =       0.000440037378
  error estimate for blocks of size 2^( 4) =       0.000452239601
  error estimate for blocks of size 2^( 5) =       0.000463153908
  error estimate for blocks of size 2^( 6) =       0.000471088093
  error estimate for blocks of size 2^( 7) =       0.000477284710

      target function =                  N/A
              le_mean =     -16.905912720263
             les_mean =     286.152648839012
             stat err =       0.000465941578
             autocorr =       1.266769481625
              std dev =       0.585460592387
             le_variance =       0.342764105238


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905912720204        initial
     1.5259e+03     1.5259e+04             1.2258e-07       -16.905912721156  <--
     6.1035e+03     6.1035e+04             3.0646e-08       -16.905912720680
     2.4414e+04     2.4414e+05             7.6616e-09       -16.905912720263

*****************************************************************************
Applying the update for shift_i =   1.5259e+03     and shift_s =   1.5259e+04
*****************************************************************************

  Execution time = 2.9858e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428663e-01 1 1  ON 1
 uu_2                 4.144425e-02 1 1  ON 2
 uu_3                -2.064507e-02 1 1  ON 3
 uu_4                -6.555935e-02 1 1  ON 4
 uu_5                -9.944258e-02 1 1  ON 5
 uu_6                -1.260238e-01 1 1  ON 6
 uu_7                -1.383241e-01 1 1  ON 7
 uu_8                -1.303816e-01 1 1  ON 8
 uu_9                -9.996238e-02 1 1  ON 9
 ud_0                 4.468374e-01 1 1  ON 10
 ud_1                 1.809920e-01 1 1  ON 11
 ud_2                 6.096140e-02 1 1  ON 12
 ud_3                -1.012028e-02 1 1  ON 13
 ud_4                -6.682834e-02 1 1  ON 14
 ud_5                -1.077119e-01 1 1  ON 15
 ud_6                -1.343621e-01 1 1  ON 16
 ud_7                -1.499600e-01 1 1  ON 17
 ud_8                -1.503534e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360222e-01 1 1  ON 21
 eO_2                -1.913296e-02 1 1  ON 22
 eO_3                 2.975131e-01 1 1  ON 23
 eO_4                 5.204150e-01 1 1  ON 24
 eO_5                 4.792931e-01 1 1  ON 25
 eO_6                 2.486838e-01 1 1  ON 26
 eO_7                -4.872783e-02 1 1  ON 27
 eO_8                -2.127028e-01 1 1  ON 28
 eO_9                -7.334288e-02 1 1  ON 29
eH1_0                -2.428980e-01 1 1  ON 30
eH1_1                -1.405724e-01 1 1  ON 31
eH1_2                -9.350623e-02 1 1  ON 32
eH1_3                -3.911590e-02 1 1  ON 33
eH1_4                 8.721563e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903699e-02 1 1  ON 36
eH1_7                 1.509734e-01 1 1  ON 37
eH1_8                 1.670551e-01 1 1  ON 38
eH1_9                 5.258317e-02 1 1  ON 39
eH2_0                -2.407507e-01 1 1  ON 40
eH2_1                -1.390002e-01 1 1  ON 41
eH2_2                -9.194481e-02 1 1  ON 42
eH2_3                -3.764327e-02 1 1  ON 43
eH2_4                 1.101636e-02 1 1  ON 44
eH2_5                 4.615170e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728204e-01 1 1  ON 48
eH2_9                 3.834168e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6371e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.943
    reference variance = 0.363377
====================================================
  Execution time = 2.3047e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3855e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5738e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338544853904
                                         uncertainty =       0.005253746237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338544853904
                                         uncertainty =       0.005253746237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411432800
  error estimate for blocks of size 2^( 2) =       0.000424024505
  error estimate for blocks of size 2^( 3) =       0.000437240309
  error estimate for blocks of size 2^( 4) =       0.000449337193
  error estimate for blocks of size 2^( 5) =       0.000459050336
  error estimate for blocks of size 2^( 6) =       0.000466459273
  error estimate for blocks of size 2^( 7) =       0.000471739069

      target function =                  N/A
              le_mean =     -16.905349796565
             les_mean =     286.129405471989
             stat err =       0.000461646468
             autocorr =       1.258986904027
              std dev =       0.581853845088
             le_variance =       0.338553897044


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690534979657e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905349796565       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905349797377       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905349797108       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905349797001       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905349799083       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905349799555       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905349799244       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905349799285       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 6.363395e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905349796565       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905349796768       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905349796701       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905349796674       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905349797194       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905349797313       residual = 9.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905349797234       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905349797246       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.591508e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905349796565       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905349796616       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905349796599       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905349796592       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905349796723       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905349796752       residual = 9.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905349796724       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905349796737       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 3.979181e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.062398 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8628e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428664e-01 1 1  ON 1
 uu_2                 4.144426e-02 1 1  ON 2
 uu_3                -2.064506e-02 1 1  ON 3
 uu_4                -6.555934e-02 1 1  ON 4
 uu_5                -9.944261e-02 1 1  ON 5
 uu_6                -1.260238e-01 1 1  ON 6
 uu_7                -1.383241e-01 1 1  ON 7
 uu_8                -1.303817e-01 1 1  ON 8
 uu_9                -9.996242e-02 1 1  ON 9
 ud_0                 4.468375e-01 1 1  ON 10
 ud_1                 1.809921e-01 1 1  ON 11
 ud_2                 6.096140e-02 1 1  ON 12
 ud_3                -1.012022e-02 1 1  ON 13
 ud_4                -6.682836e-02 1 1  ON 14
 ud_5                -1.077119e-01 1 1  ON 15
 ud_6                -1.343621e-01 1 1  ON 16
 ud_7                -1.499600e-01 1 1  ON 17
 ud_8                -1.503535e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360222e-01 1 1  ON 21
 eO_2                -1.913294e-02 1 1  ON 22
 eO_3                 2.975132e-01 1 1  ON 23
 eO_4                 5.204150e-01 1 1  ON 24
 eO_5                 4.792932e-01 1 1  ON 25
 eO_6                 2.486839e-01 1 1  ON 26
 eO_7                -4.872776e-02 1 1  ON 27
 eO_8                -2.127028e-01 1 1  ON 28
 eO_9                -7.334298e-02 1 1  ON 29
eH1_0                -2.428981e-01 1 1  ON 30
eH1_1                -1.405724e-01 1 1  ON 31
eH1_2                -9.350626e-02 1 1  ON 32
eH1_3                -3.911591e-02 1 1  ON 33
eH1_4                 8.721459e-03 1 1  ON 34
eH1_5                 4.211826e-02 1 1  ON 35
eH1_6                 9.903699e-02 1 1  ON 36
eH1_7                 1.509734e-01 1 1  ON 37
eH1_8                 1.670553e-01 1 1  ON 38
eH1_9                 5.258332e-02 1 1  ON 39
eH2_0                -2.407508e-01 1 1  ON 40
eH2_1                -1.390003e-01 1 1  ON 41
eH2_2                -9.194474e-02 1 1  ON 42
eH2_3                -3.764326e-02 1 1  ON 43
eH2_4                 1.101633e-02 1 1  ON 44
eH2_5                 4.615171e-02 1 1  ON 45
eH2_6                 1.031961e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728205e-01 1 1  ON 48
eH2_9                 3.834181e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8089
    reference variance = 0.248543
====================================================
  Execution time = 2.0252e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3095e-01
  Total weights = 2.0000e+06
  Execution time = 1.8452e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331059022869
                                         uncertainty =       0.002486163413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331059022869
                                         uncertainty =       0.002486163413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406784505
  error estimate for blocks of size 2^( 2) =       0.000419571674
  error estimate for blocks of size 2^( 3) =       0.000432690600
  error estimate for blocks of size 2^( 4) =       0.000445297987
  error estimate for blocks of size 2^( 5) =       0.000456507612
  error estimate for blocks of size 2^( 6) =       0.000466137457
  error estimate for blocks of size 2^( 7) =       0.000472733529

      target function =                  N/A
              le_mean =     -16.906358084714
             les_mean =     286.155890790115
             stat err =       0.000460169146
             autocorr =       1.279694164108
              std dev =       0.575280163941
             le_variance =       0.330947267024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331058955761
                                         uncertainty =       0.002486163224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331058955761
                                         uncertainty =       0.002486163224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406784464
  error estimate for blocks of size 2^( 2) =       0.000419571630
  error estimate for blocks of size 2^( 3) =       0.000432690550
  error estimate for blocks of size 2^( 4) =       0.000445297934
  error estimate for blocks of size 2^( 5) =       0.000456507563
  error estimate for blocks of size 2^( 6) =       0.000466137419
  error estimate for blocks of size 2^( 7) =       0.000472733484

      target function =                  N/A
              le_mean =     -16.906358084694
             les_mean =     286.155890722281
             stat err =       0.000460169100
             autocorr =       1.279694166911
              std dev =       0.575280105548
             le_variance =       0.330947199840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331058989247
                                         uncertainty =       0.002486163318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331058989247
                                         uncertainty =       0.002486163318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406784484
  error estimate for blocks of size 2^( 2) =       0.000419571652
  error estimate for blocks of size 2^( 3) =       0.000432690575
  error estimate for blocks of size 2^( 4) =       0.000445297960
  error estimate for blocks of size 2^( 5) =       0.000456507587
  error estimate for blocks of size 2^( 6) =       0.000466137438
  error estimate for blocks of size 2^( 7) =       0.000472733507

      target function =                  N/A
              le_mean =     -16.906358084703
             les_mean =     286.155890756101
             stat err =       0.000460169123
             autocorr =       1.279694165529
              std dev =       0.575280134685
             le_variance =       0.330947233364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331059018664
                                         uncertainty =       0.002486163401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331059018664
                                         uncertainty =       0.002486163401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406784502
  error estimate for blocks of size 2^( 2) =       0.000419571671
  error estimate for blocks of size 2^( 3) =       0.000432690596
  error estimate for blocks of size 2^( 4) =       0.000445297984
  error estimate for blocks of size 2^( 5) =       0.000456507609
  error estimate for blocks of size 2^( 6) =       0.000466137455
  error estimate for blocks of size 2^( 7) =       0.000472733527

      target function =                  N/A
              le_mean =     -16.906358084712
             les_mean =     286.155890785860
             stat err =       0.000460169143
             autocorr =       1.279694164280
              std dev =       0.575280160282
             le_variance =       0.330947262815


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906358084714        initial  <--
     3.8147e+02     3.8147e+03             6.3634e-07       -16.906358084694
     1.5259e+03     1.5259e+04             1.5915e-07       -16.906358084703
     6.1035e+03     6.1035e+04             3.9792e-08       -16.906358084712

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5443
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428663e-01 1 1  ON 1
 uu_2                 4.144425e-02 1 1  ON 2
 uu_3                -2.064507e-02 1 1  ON 3
 uu_4                -6.555935e-02 1 1  ON 4
 uu_5                -9.944258e-02 1 1  ON 5
 uu_6                -1.260238e-01 1 1  ON 6
 uu_7                -1.383241e-01 1 1  ON 7
 uu_8                -1.303816e-01 1 1  ON 8
 uu_9                -9.996238e-02 1 1  ON 9
 ud_0                 4.468374e-01 1 1  ON 10
 ud_1                 1.809920e-01 1 1  ON 11
 ud_2                 6.096140e-02 1 1  ON 12
 ud_3                -1.012028e-02 1 1  ON 13
 ud_4                -6.682834e-02 1 1  ON 14
 ud_5                -1.077119e-01 1 1  ON 15
 ud_6                -1.343621e-01 1 1  ON 16
 ud_7                -1.499600e-01 1 1  ON 17
 ud_8                -1.503534e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360222e-01 1 1  ON 21
 eO_2                -1.913296e-02 1 1  ON 22
 eO_3                 2.975131e-01 1 1  ON 23
 eO_4                 5.204150e-01 1 1  ON 24
 eO_5                 4.792931e-01 1 1  ON 25
 eO_6                 2.486838e-01 1 1  ON 26
 eO_7                -4.872783e-02 1 1  ON 27
 eO_8                -2.127028e-01 1 1  ON 28
 eO_9                -7.334288e-02 1 1  ON 29
eH1_0                -2.428980e-01 1 1  ON 30
eH1_1                -1.405724e-01 1 1  ON 31
eH1_2                -9.350623e-02 1 1  ON 32
eH1_3                -3.911590e-02 1 1  ON 33
eH1_4                 8.721563e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903699e-02 1 1  ON 36
eH1_7                 1.509734e-01 1 1  ON 37
eH1_8                 1.670551e-01 1 1  ON 38
eH1_9                 5.258317e-02 1 1  ON 39
eH2_0                -2.407507e-01 1 1  ON 40
eH2_1                -1.390002e-01 1 1  ON 41
eH2_2                -9.194481e-02 1 1  ON 42
eH2_3                -3.764327e-02 1 1  ON 43
eH2_4                 1.101636e-02 1 1  ON 44
eH2_5                 4.615170e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728204e-01 1 1  ON 48
eH2_9                 3.834168e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8332e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9312
    reference variance = 0.193139
====================================================
  Execution time = 2.0280e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4121e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5512e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341335314872
                                         uncertainty =       0.011233941447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341335314872
                                         uncertainty =       0.011233941447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413040688
  error estimate for blocks of size 2^( 2) =       0.000425382464
  error estimate for blocks of size 2^( 3) =       0.000438019619
  error estimate for blocks of size 2^( 4) =       0.000450112180
  error estimate for blocks of size 2^( 5) =       0.000460710375
  error estimate for blocks of size 2^( 6) =       0.000469034397
  error estimate for blocks of size 2^( 7) =       0.000471680091

      target function =                  N/A
              le_mean =     -16.905613915423
             les_mean =     286.140986906424
             stat err =       0.000462884261
             autocorr =       1.255911847508
              std dev =       0.584127742597
             le_variance =       0.341205219671


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690561391542e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905613915423       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905613915307       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905613915571       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905613915587       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905613915634       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905613915660       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905613915696       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905613915672       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 5.361218e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905613915423       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905613915394       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905613915460       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905613915464       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905613915476       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905613915479       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905613915495       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905613915504       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.340311e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905613915423       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905613915416       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905613915433       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905613915434       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905613915545       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905613915441       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905613915469       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905613915437       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 3.350781e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.065059 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5838e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428663e-01 1 1  ON 1
 uu_2                 4.144425e-02 1 1  ON 2
 uu_3                -2.064507e-02 1 1  ON 3
 uu_4                -6.555935e-02 1 1  ON 4
 uu_5                -9.944258e-02 1 1  ON 5
 uu_6                -1.260238e-01 1 1  ON 6
 uu_7                -1.383241e-01 1 1  ON 7
 uu_8                -1.303816e-01 1 1  ON 8
 uu_9                -9.996238e-02 1 1  ON 9
 ud_0                 4.468374e-01 1 1  ON 10
 ud_1                 1.809920e-01 1 1  ON 11
 ud_2                 6.096140e-02 1 1  ON 12
 ud_3                -1.012027e-02 1 1  ON 13
 ud_4                -6.682834e-02 1 1  ON 14
 ud_5                -1.077119e-01 1 1  ON 15
 ud_6                -1.343621e-01 1 1  ON 16
 ud_7                -1.499600e-01 1 1  ON 17
 ud_8                -1.503534e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360221e-01 1 1  ON 21
 eO_2                -1.913297e-02 1 1  ON 22
 eO_3                 2.975131e-01 1 1  ON 23
 eO_4                 5.204150e-01 1 1  ON 24
 eO_5                 4.792932e-01 1 1  ON 25
 eO_6                 2.486838e-01 1 1  ON 26
 eO_7                -4.872783e-02 1 1  ON 27
 eO_8                -2.127028e-01 1 1  ON 28
 eO_9                -7.334288e-02 1 1  ON 29
eH1_0                -2.428980e-01 1 1  ON 30
eH1_1                -1.405724e-01 1 1  ON 31
eH1_2                -9.350624e-02 1 1  ON 32
eH1_3                -3.911590e-02 1 1  ON 33
eH1_4                 8.721569e-03 1 1  ON 34
eH1_5                 4.211829e-02 1 1  ON 35
eH1_6                 9.903698e-02 1 1  ON 36
eH1_7                 1.509734e-01 1 1  ON 37
eH1_8                 1.670552e-01 1 1  ON 38
eH1_9                 5.258319e-02 1 1  ON 39
eH2_0                -2.407507e-01 1 1  ON 40
eH2_1                -1.390002e-01 1 1  ON 41
eH2_2                -9.194481e-02 1 1  ON 42
eH2_3                -3.764328e-02 1 1  ON 43
eH2_4                 1.101635e-02 1 1  ON 44
eH2_5                 4.615170e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728204e-01 1 1  ON 48
eH2_9                 3.834169e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8379
    reference variance = 0.285236
====================================================
  Execution time = 2.0459e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3875e-01
  Total weights = 2.0000e+06
  Execution time = 1.8482e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338782354388
                                         uncertainty =       0.003346429408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338782354388
                                         uncertainty =       0.003346429408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411553116
  error estimate for blocks of size 2^( 2) =       0.000423845745
  error estimate for blocks of size 2^( 3) =       0.000437163283
  error estimate for blocks of size 2^( 4) =       0.000449551077
  error estimate for blocks of size 2^( 5) =       0.000461100802
  error estimate for blocks of size 2^( 6) =       0.000469702787
  error estimate for blocks of size 2^( 7) =       0.000475005285

      target function =                  N/A
              le_mean =     -16.906817851857
             les_mean =     286.179241641472
             stat err =       0.000463839988
             autocorr =       1.270236487795
              std dev =       0.582023998628
             le_variance =       0.338751934979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338782360796
                                         uncertainty =       0.003346429415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338782360796
                                         uncertainty =       0.003346429415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411553120
  error estimate for blocks of size 2^( 2) =       0.000423845749
  error estimate for blocks of size 2^( 3) =       0.000437163286
  error estimate for blocks of size 2^( 4) =       0.000449551079
  error estimate for blocks of size 2^( 5) =       0.000461100804
  error estimate for blocks of size 2^( 6) =       0.000469702787
  error estimate for blocks of size 2^( 7) =       0.000475005286

      target function =                  N/A
              le_mean =     -16.906817852073
             les_mean =     286.179241655199
             stat err =       0.000463839989
             autocorr =       1.270236470543
              std dev =       0.582024004145
             le_variance =       0.338751941400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338782357591
                                         uncertainty =       0.003346429411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338782357591
                                         uncertainty =       0.003346429411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411553118
  error estimate for blocks of size 2^( 2) =       0.000423845747
  error estimate for blocks of size 2^( 3) =       0.000437163285
  error estimate for blocks of size 2^( 4) =       0.000449551078
  error estimate for blocks of size 2^( 5) =       0.000461100803
  error estimate for blocks of size 2^( 6) =       0.000469702787
  error estimate for blocks of size 2^( 7) =       0.000475005285

      target function =                  N/A
              le_mean =     -16.906817851965
             les_mean =     286.179241648335
             stat err =       0.000463839988
             autocorr =       1.270236479169
              std dev =       0.582024001386
             le_variance =       0.338751938189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338782354788
                                         uncertainty =       0.003346429408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338782354788
                                         uncertainty =       0.003346429408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411553116
  error estimate for blocks of size 2^( 2) =       0.000423845745
  error estimate for blocks of size 2^( 3) =       0.000437163283
  error estimate for blocks of size 2^( 4) =       0.000449551077
  error estimate for blocks of size 2^( 5) =       0.000461100802
  error estimate for blocks of size 2^( 6) =       0.000469702787
  error estimate for blocks of size 2^( 7) =       0.000475005285

      target function =                  N/A
              le_mean =     -16.906817851870
             les_mean =     286.179241642330
             stat err =       0.000463839988
             autocorr =       1.270236486719
              std dev =       0.582023998973
             le_variance =       0.338751935380


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906817851857        initial
     3.8147e+03     3.8147e+04             5.3612e-08       -16.906817852073  <--
     1.5259e+04     1.5259e+05             1.3403e-08       -16.906817851965
     6.1035e+04     6.1035e+05             3.3508e-09       -16.906817851870

*****************************************************************************
Applying the update for shift_i =   3.8147e+03     and shift_s =   3.8147e+04
*****************************************************************************

  Execution time = 2.9758e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428663e-01 1 1  ON 1
 uu_2                 4.144424e-02 1 1  ON 2
 uu_3                -2.064507e-02 1 1  ON 3
 uu_4                -6.555935e-02 1 1  ON 4
 uu_5                -9.944258e-02 1 1  ON 5
 uu_6                -1.260238e-01 1 1  ON 6
 uu_7                -1.383241e-01 1 1  ON 7
 uu_8                -1.303816e-01 1 1  ON 8
 uu_9                -9.996239e-02 1 1  ON 9
 ud_0                 4.468374e-01 1 1  ON 10
 ud_1                 1.809920e-01 1 1  ON 11
 ud_2                 6.096139e-02 1 1  ON 12
 ud_3                -1.012026e-02 1 1  ON 13
 ud_4                -6.682835e-02 1 1  ON 14
 ud_5                -1.077119e-01 1 1  ON 15
 ud_6                -1.343621e-01 1 1  ON 16
 ud_7                -1.499600e-01 1 1  ON 17
 ud_8                -1.503534e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360221e-01 1 1  ON 21
 eO_2                -1.913299e-02 1 1  ON 22
 eO_3                 2.975131e-01 1 1  ON 23
 eO_4                 5.204150e-01 1 1  ON 24
 eO_5                 4.792932e-01 1 1  ON 25
 eO_6                 2.486839e-01 1 1  ON 26
 eO_7                -4.872781e-02 1 1  ON 27
 eO_8                -2.127028e-01 1 1  ON 28
 eO_9                -7.334290e-02 1 1  ON 29
eH1_0                -2.428981e-01 1 1  ON 30
eH1_1                -1.405724e-01 1 1  ON 31
eH1_2                -9.350627e-02 1 1  ON 32
eH1_3                -3.911591e-02 1 1  ON 33
eH1_4                 8.721586e-03 1 1  ON 34
eH1_5                 4.211830e-02 1 1  ON 35
eH1_6                 9.903697e-02 1 1  ON 36
eH1_7                 1.509734e-01 1 1  ON 37
eH1_8                 1.670552e-01 1 1  ON 38
eH1_9                 5.258322e-02 1 1  ON 39
eH2_0                -2.407507e-01 1 1  ON 40
eH2_1                -1.390002e-01 1 1  ON 41
eH2_2                -9.194482e-02 1 1  ON 42
eH2_3                -3.764328e-02 1 1  ON 43
eH2_4                 1.101635e-02 1 1  ON 44
eH2_5                 4.615171e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728204e-01 1 1  ON 48
eH2_9                 3.834173e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5684e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9141
    reference variance = 0.491547
====================================================
  Execution time = 2.1555e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3461e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5562e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334628956039
                                         uncertainty =       0.002801535460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334628956039
                                         uncertainty =       0.002801535460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409028005
  error estimate for blocks of size 2^( 2) =       0.000421805033
  error estimate for blocks of size 2^( 3) =       0.000434348880
  error estimate for blocks of size 2^( 4) =       0.000446311115
  error estimate for blocks of size 2^( 5) =       0.000457836245
  error estimate for blocks of size 2^( 6) =       0.000465791982
  error estimate for blocks of size 2^( 7) =       0.000472932355

      target function =                  N/A
              le_mean =     -16.905737188335
             les_mean =     286.138557532073
             stat err =       0.000460717924
             autocorr =       1.268715160048
              std dev =       0.578452952554
             le_variance =       0.334607818318


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690573718834e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905737188335       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905737188218       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905737188643       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905737189012       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905737188865       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905737188766       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905737188925       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905737189040       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.403018e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905737188335       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905737188306       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905737188412       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905737188505       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905737188470       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905737188444       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905737188485       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905737188508       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 6.007587e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905737188335       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905737188328       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905737188354       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905737188378       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905737188359       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905737188362       residual = 5.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905737188383       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905737188379       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.501899e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.067694 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7118e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428663e-01 1 1  ON 1
 uu_2                 4.144424e-02 1 1  ON 2
 uu_3                -2.064507e-02 1 1  ON 3
 uu_4                -6.555936e-02 1 1  ON 4
 uu_5                -9.944258e-02 1 1  ON 5
 uu_6                -1.260238e-01 1 1  ON 6
 uu_7                -1.383241e-01 1 1  ON 7
 uu_8                -1.303816e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468375e-01 1 1  ON 10
 ud_1                 1.809921e-01 1 1  ON 11
 ud_2                 6.096137e-02 1 1  ON 12
 ud_3                -1.012025e-02 1 1  ON 13
 ud_4                -6.682833e-02 1 1  ON 14
 ud_5                -1.077119e-01 1 1  ON 15
 ud_6                -1.343621e-01 1 1  ON 16
 ud_7                -1.499600e-01 1 1  ON 17
 ud_8                -1.503534e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360221e-01 1 1  ON 21
 eO_2                -1.913300e-02 1 1  ON 22
 eO_3                 2.975131e-01 1 1  ON 23
 eO_4                 5.204150e-01 1 1  ON 24
 eO_5                 4.792932e-01 1 1  ON 25
 eO_6                 2.486839e-01 1 1  ON 26
 eO_7                -4.872779e-02 1 1  ON 27
 eO_8                -2.127028e-01 1 1  ON 28
 eO_9                -7.334294e-02 1 1  ON 29
eH1_0                -2.428981e-01 1 1  ON 30
eH1_1                -1.405724e-01 1 1  ON 31
eH1_2                -9.350629e-02 1 1  ON 32
eH1_3                -3.911597e-02 1 1  ON 33
eH1_4                 8.721570e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903699e-02 1 1  ON 36
eH1_7                 1.509734e-01 1 1  ON 37
eH1_8                 1.670552e-01 1 1  ON 38
eH1_9                 5.258328e-02 1 1  ON 39
eH2_0                -2.407508e-01 1 1  ON 40
eH2_1                -1.390002e-01 1 1  ON 41
eH2_2                -9.194482e-02 1 1  ON 42
eH2_3                -3.764329e-02 1 1  ON 43
eH2_4                 1.101633e-02 1 1  ON 44
eH2_5                 4.615171e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728205e-01 1 1  ON 48
eH2_9                 3.834179e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8927
    reference variance = 0.188277
====================================================
  Execution time = 2.0277e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4674e-01
  Total weights = 2.0000e+06
  Execution time = 1.8419e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346752789063
                                         uncertainty =       0.005398006457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346752789063
                                         uncertainty =       0.005398006457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416378632
  error estimate for blocks of size 2^( 2) =       0.000428958762
  error estimate for blocks of size 2^( 3) =       0.000441614709
  error estimate for blocks of size 2^( 4) =       0.000453210155
  error estimate for blocks of size 2^( 5) =       0.000464192173
  error estimate for blocks of size 2^( 6) =       0.000470827524
  error estimate for blocks of size 2^( 7) =       0.000473529558

      target function =                  N/A
              le_mean =     -16.906442699573
             les_mean =     286.174546911321
             stat err =       0.000465439853
             autocorr =       1.249540291277
              std dev =       0.588848308778
             le_variance =       0.346742330750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346752858371
                                         uncertainty =       0.005398007182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346752858371
                                         uncertainty =       0.005398007182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416378674
  error estimate for blocks of size 2^( 2) =       0.000428958799
  error estimate for blocks of size 2^( 3) =       0.000441614746
  error estimate for blocks of size 2^( 4) =       0.000453210191
  error estimate for blocks of size 2^( 5) =       0.000464192207
  error estimate for blocks of size 2^( 6) =       0.000470827556
  error estimate for blocks of size 2^( 7) =       0.000473529587

      target function =                  N/A
              le_mean =     -16.906442699148
             les_mean =     286.174546966099
             stat err =       0.000465439885
             autocorr =       1.249540216819
              std dev =       0.588848367503
             le_variance =       0.346742399911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346752823716
                                         uncertainty =       0.005398006819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346752823716
                                         uncertainty =       0.005398006819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416378653
  error estimate for blocks of size 2^( 2) =       0.000428958780
  error estimate for blocks of size 2^( 3) =       0.000441614727
  error estimate for blocks of size 2^( 4) =       0.000453210173
  error estimate for blocks of size 2^( 5) =       0.000464192190
  error estimate for blocks of size 2^( 6) =       0.000470827540
  error estimate for blocks of size 2^( 7) =       0.000473529572

      target function =                  N/A
              le_mean =     -16.906442699360
             les_mean =     286.174546938708
             stat err =       0.000465439869
             autocorr =       1.249540254051
              std dev =       0.588848338140
             le_variance =       0.346742365330

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346752793395
                                         uncertainty =       0.005398006502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346752793395
                                         uncertainty =       0.005398006502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416378635
  error estimate for blocks of size 2^( 2) =       0.000428958764
  error estimate for blocks of size 2^( 3) =       0.000441614712
  error estimate for blocks of size 2^( 4) =       0.000453210158
  error estimate for blocks of size 2^( 5) =       0.000464192175
  error estimate for blocks of size 2^( 6) =       0.000470827526
  error estimate for blocks of size 2^( 7) =       0.000473529559

      target function =                  N/A
              le_mean =     -16.906442699546
             les_mean =     286.174546914744
             stat err =       0.000465439855
             autocorr =       1.249540286625
              std dev =       0.588848312448
             le_variance =       0.346742335073


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906442699573        initial  <--
     9.5367e+02     9.5367e+03             2.4030e-07       -16.906442699148
     3.8147e+03     3.8147e+04             6.0076e-08       -16.906442699360
     1.5259e+04     1.5259e+05             1.5019e-08       -16.906442699546

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5395
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428663e-01 1 1  ON 1
 uu_2                 4.144424e-02 1 1  ON 2
 uu_3                -2.064507e-02 1 1  ON 3
 uu_4                -6.555935e-02 1 1  ON 4
 uu_5                -9.944258e-02 1 1  ON 5
 uu_6                -1.260238e-01 1 1  ON 6
 uu_7                -1.383241e-01 1 1  ON 7
 uu_8                -1.303816e-01 1 1  ON 8
 uu_9                -9.996239e-02 1 1  ON 9
 ud_0                 4.468374e-01 1 1  ON 10
 ud_1                 1.809920e-01 1 1  ON 11
 ud_2                 6.096139e-02 1 1  ON 12
 ud_3                -1.012026e-02 1 1  ON 13
 ud_4                -6.682835e-02 1 1  ON 14
 ud_5                -1.077119e-01 1 1  ON 15
 ud_6                -1.343621e-01 1 1  ON 16
 ud_7                -1.499600e-01 1 1  ON 17
 ud_8                -1.503534e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360221e-01 1 1  ON 21
 eO_2                -1.913299e-02 1 1  ON 22
 eO_3                 2.975131e-01 1 1  ON 23
 eO_4                 5.204150e-01 1 1  ON 24
 eO_5                 4.792932e-01 1 1  ON 25
 eO_6                 2.486839e-01 1 1  ON 26
 eO_7                -4.872781e-02 1 1  ON 27
 eO_8                -2.127028e-01 1 1  ON 28
 eO_9                -7.334290e-02 1 1  ON 29
eH1_0                -2.428981e-01 1 1  ON 30
eH1_1                -1.405724e-01 1 1  ON 31
eH1_2                -9.350627e-02 1 1  ON 32
eH1_3                -3.911591e-02 1 1  ON 33
eH1_4                 8.721586e-03 1 1  ON 34
eH1_5                 4.211830e-02 1 1  ON 35
eH1_6                 9.903697e-02 1 1  ON 36
eH1_7                 1.509734e-01 1 1  ON 37
eH1_8                 1.670552e-01 1 1  ON 38
eH1_9                 5.258322e-02 1 1  ON 39
eH2_0                -2.407507e-01 1 1  ON 40
eH2_1                -1.390002e-01 1 1  ON 41
eH2_2                -9.194482e-02 1 1  ON 42
eH2_3                -3.764328e-02 1 1  ON 43
eH2_4                 1.101635e-02 1 1  ON 44
eH2_5                 4.615171e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728204e-01 1 1  ON 48
eH2_9                 3.834173e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6826e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9103
    reference variance = 0.207928
====================================================
  Execution time = 2.1200e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3232e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5391e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332446897026
                                         uncertainty =       0.002703808439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332446897026
                                         uncertainty =       0.002703808439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407626908
  error estimate for blocks of size 2^( 2) =       0.000420108244
  error estimate for blocks of size 2^( 3) =       0.000432283814
  error estimate for blocks of size 2^( 4) =       0.000444301327
  error estimate for blocks of size 2^( 5) =       0.000455436758
  error estimate for blocks of size 2^( 6) =       0.000462380697
  error estimate for blocks of size 2^( 7) =       0.000469249898

      target function =                  N/A
              le_mean =     -16.906466835233
             les_mean =     286.160940076538
             stat err =       0.000457842170
             autocorr =       1.261554142344
              std dev =       0.576471501345
             le_variance =       0.332319391863


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690646683523e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906466835233       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906466835269       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906466835264       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906466835246       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906466835170       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906466835178       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906466835181       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906466835188       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.362571e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906466835233       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906466835242       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906466835241       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906466835238       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906466835221       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906466835231       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906466835209       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906466835254       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 5.906456e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906466835233       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906466835235       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906466835235       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906466835234       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906466835221       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906466835240       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906466835159       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906466835231       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.476616e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.070303 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6749e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428663e-01 1 1  ON 1
 uu_2                 4.144425e-02 1 1  ON 2
 uu_3                -2.064507e-02 1 1  ON 3
 uu_4                -6.555935e-02 1 1  ON 4
 uu_5                -9.944258e-02 1 1  ON 5
 uu_6                -1.260238e-01 1 1  ON 6
 uu_7                -1.383241e-01 1 1  ON 7
 uu_8                -1.303816e-01 1 1  ON 8
 uu_9                -9.996239e-02 1 1  ON 9
 ud_0                 4.468374e-01 1 1  ON 10
 ud_1                 1.809920e-01 1 1  ON 11
 ud_2                 6.096139e-02 1 1  ON 12
 ud_3                -1.012026e-02 1 1  ON 13
 ud_4                -6.682835e-02 1 1  ON 14
 ud_5                -1.077119e-01 1 1  ON 15
 ud_6                -1.343621e-01 1 1  ON 16
 ud_7                -1.499600e-01 1 1  ON 17
 ud_8                -1.503534e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360221e-01 1 1  ON 21
 eO_2                -1.913299e-02 1 1  ON 22
 eO_3                 2.975131e-01 1 1  ON 23
 eO_4                 5.204150e-01 1 1  ON 24
 eO_5                 4.792932e-01 1 1  ON 25
 eO_6                 2.486839e-01 1 1  ON 26
 eO_7                -4.872781e-02 1 1  ON 27
 eO_8                -2.127028e-01 1 1  ON 28
 eO_9                -7.334291e-02 1 1  ON 29
eH1_0                -2.428981e-01 1 1  ON 30
eH1_1                -1.405724e-01 1 1  ON 31
eH1_2                -9.350627e-02 1 1  ON 32
eH1_3                -3.911591e-02 1 1  ON 33
eH1_4                 8.721586e-03 1 1  ON 34
eH1_5                 4.211830e-02 1 1  ON 35
eH1_6                 9.903697e-02 1 1  ON 36
eH1_7                 1.509734e-01 1 1  ON 37
eH1_8                 1.670552e-01 1 1  ON 38
eH1_9                 5.258322e-02 1 1  ON 39
eH2_0                -2.407507e-01 1 1  ON 40
eH2_1                -1.390002e-01 1 1  ON 41
eH2_2                -9.194482e-02 1 1  ON 42
eH2_3                -3.764328e-02 1 1  ON 43
eH2_4                 1.101635e-02 1 1  ON 44
eH2_5                 4.615171e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728204e-01 1 1  ON 48
eH2_9                 3.834174e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8858
    reference variance = 0.197602
====================================================
  Execution time = 2.0641e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3419e-01
  Total weights = 2.0000e+06
  Execution time = 1.8452e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334278739007
                                         uncertainty =       0.003468091455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334278739007
                                         uncertainty =       0.003468091455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408770830
  error estimate for blocks of size 2^( 2) =       0.000421649375
  error estimate for blocks of size 2^( 3) =       0.000435207545
  error estimate for blocks of size 2^( 4) =       0.000446802919
  error estimate for blocks of size 2^( 5) =       0.000458004202
  error estimate for blocks of size 2^( 6) =       0.000464718254
  error estimate for blocks of size 2^( 7) =       0.000471047454

      target function =                  N/A
              le_mean =     -16.906308489510
             les_mean =     286.157453757496
             stat err =       0.000460143207
             autocorr =       1.267144777531
              std dev =       0.578089250985
             le_variance =       0.334187182105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334278731363
                                         uncertainty =       0.003468091367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334278731363
                                         uncertainty =       0.003468091367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408770825
  error estimate for blocks of size 2^( 2) =       0.000421649371
  error estimate for blocks of size 2^( 3) =       0.000435207541
  error estimate for blocks of size 2^( 4) =       0.000446802915
  error estimate for blocks of size 2^( 5) =       0.000458004198
  error estimate for blocks of size 2^( 6) =       0.000464718250
  error estimate for blocks of size 2^( 7) =       0.000471047450

      target function =                  N/A
              le_mean =     -16.906308489576
             les_mean =     286.157453752081
             stat err =       0.000460143203
             autocorr =       1.267144782884
              std dev =       0.578089244375
             le_variance =       0.334187174462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334278735185
                                         uncertainty =       0.003468091411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334278735185
                                         uncertainty =       0.003468091411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408770827
  error estimate for blocks of size 2^( 2) =       0.000421649373
  error estimate for blocks of size 2^( 3) =       0.000435207543
  error estimate for blocks of size 2^( 4) =       0.000446802917
  error estimate for blocks of size 2^( 5) =       0.000458004200
  error estimate for blocks of size 2^( 6) =       0.000464718252
  error estimate for blocks of size 2^( 7) =       0.000471047452

      target function =                  N/A
              le_mean =     -16.906308489543
             les_mean =     286.157453754788
             stat err =       0.000460143205
             autocorr =       1.267144780221
              std dev =       0.578089247680
             le_variance =       0.334187178283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334278738529
                                         uncertainty =       0.003468091450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334278738529
                                         uncertainty =       0.003468091450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408770829
  error estimate for blocks of size 2^( 2) =       0.000421649375
  error estimate for blocks of size 2^( 3) =       0.000435207545
  error estimate for blocks of size 2^( 4) =       0.000446802919
  error estimate for blocks of size 2^( 5) =       0.000458004202
  error estimate for blocks of size 2^( 6) =       0.000464718254
  error estimate for blocks of size 2^( 7) =       0.000471047453

      target function =                  N/A
              le_mean =     -16.906308489514
             les_mean =     286.157453757157
             stat err =       0.000460143207
             autocorr =       1.267144777864
              std dev =       0.578089250572
             le_variance =       0.334187181627


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906308489510        initial
     9.5367e+03     9.5367e+04             2.3626e-08       -16.906308489576  <--
     3.8147e+04     3.8147e+05             5.9065e-09       -16.906308489543
     1.5259e+05     1.5259e+06             1.4766e-09       -16.906308489514

*****************************************************************************
Applying the update for shift_i =   9.5367e+03     and shift_s =   9.5367e+04
*****************************************************************************

  Execution time = 2.9915e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428663e-01 1 1  ON 1
 uu_2                 4.144425e-02 1 1  ON 2
 uu_3                -2.064508e-02 1 1  ON 3
 uu_4                -6.555935e-02 1 1  ON 4
 uu_5                -9.944259e-02 1 1  ON 5
 uu_6                -1.260238e-01 1 1  ON 6
 uu_7                -1.383241e-01 1 1  ON 7
 uu_8                -1.303817e-01 1 1  ON 8
 uu_9                -9.996239e-02 1 1  ON 9
 ud_0                 4.468374e-01 1 1  ON 10
 ud_1                 1.809920e-01 1 1  ON 11
 ud_2                 6.096139e-02 1 1  ON 12
 ud_3                -1.012024e-02 1 1  ON 13
 ud_4                -6.682835e-02 1 1  ON 14
 ud_5                -1.077119e-01 1 1  ON 15
 ud_6                -1.343621e-01 1 1  ON 16
 ud_7                -1.499600e-01 1 1  ON 17
 ud_8                -1.503534e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360221e-01 1 1  ON 21
 eO_2                -1.913299e-02 1 1  ON 22
 eO_3                 2.975131e-01 1 1  ON 23
 eO_4                 5.204150e-01 1 1  ON 24
 eO_5                 4.792932e-01 1 1  ON 25
 eO_6                 2.486839e-01 1 1  ON 26
 eO_7                -4.872781e-02 1 1  ON 27
 eO_8                -2.127028e-01 1 1  ON 28
 eO_9                -7.334292e-02 1 1  ON 29
eH1_0                -2.428981e-01 1 1  ON 30
eH1_1                -1.405724e-01 1 1  ON 31
eH1_2                -9.350628e-02 1 1  ON 32
eH1_3                -3.911591e-02 1 1  ON 33
eH1_4                 8.721585e-03 1 1  ON 34
eH1_5                 4.211830e-02 1 1  ON 35
eH1_6                 9.903697e-02 1 1  ON 36
eH1_7                 1.509734e-01 1 1  ON 37
eH1_8                 1.670552e-01 1 1  ON 38
eH1_9                 5.258324e-02 1 1  ON 39
eH2_0                -2.407507e-01 1 1  ON 40
eH2_1                -1.390002e-01 1 1  ON 41
eH2_2                -9.194481e-02 1 1  ON 42
eH2_3                -3.764328e-02 1 1  ON 43
eH2_4                 1.101634e-02 1 1  ON 44
eH2_5                 4.615170e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728204e-01 1 1  ON 48
eH2_9                 3.834175e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7082e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.87
    reference variance = 0.186366
====================================================
  Execution time = 2.1151e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3267e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5290e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332684506769
                                         uncertainty =       0.002628298767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332684506769
                                         uncertainty =       0.002628298767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407840569
  error estimate for blocks of size 2^( 2) =       0.000420421746
  error estimate for blocks of size 2^( 3) =       0.000433517355
  error estimate for blocks of size 2^( 4) =       0.000445498259
  error estimate for blocks of size 2^( 5) =       0.000456649223
  error estimate for blocks of size 2^( 6) =       0.000465078307
  error estimate for blocks of size 2^( 7) =       0.000470564891

      target function =                  N/A
              le_mean =     -16.906496368011
             les_mean =     286.162287134952
             stat err =       0.000459447670
             autocorr =       1.269086599925
              std dev =       0.576773664210
             le_variance =       0.332667859726


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690649636801e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906496368011       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906496368126       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906496368237       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906496368329       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906496368502       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906496368559       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906496368468       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906496368478       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.080126e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906496368011       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906496368039       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906496368067       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906496368090       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906496368134       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906496368127       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906496368125       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906496368123       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.700329e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906496368011       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906496368018       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906496368025       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906496368031       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906496368041       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906496368042       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906496368041       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906496368048       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 6.750832e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.072930 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6687e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428663e-01 1 1  ON 1
 uu_2                 4.144427e-02 1 1  ON 2
 uu_3                -2.064508e-02 1 1  ON 3
 uu_4                -6.555935e-02 1 1  ON 4
 uu_5                -9.944260e-02 1 1  ON 5
 uu_6                -1.260238e-01 1 1  ON 6
 uu_7                -1.383241e-01 1 1  ON 7
 uu_8                -1.303817e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468375e-01 1 1  ON 10
 ud_1                 1.809921e-01 1 1  ON 11
 ud_2                 6.096138e-02 1 1  ON 12
 ud_3                -1.012024e-02 1 1  ON 13
 ud_4                -6.682835e-02 1 1  ON 14
 ud_5                -1.077119e-01 1 1  ON 15
 ud_6                -1.343621e-01 1 1  ON 16
 ud_7                -1.499600e-01 1 1  ON 17
 ud_8                -1.503535e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360221e-01 1 1  ON 21
 eO_2                -1.913299e-02 1 1  ON 22
 eO_3                 2.975131e-01 1 1  ON 23
 eO_4                 5.204150e-01 1 1  ON 24
 eO_5                 4.792932e-01 1 1  ON 25
 eO_6                 2.486839e-01 1 1  ON 26
 eO_7                -4.872781e-02 1 1  ON 27
 eO_8                -2.127028e-01 1 1  ON 28
 eO_9                -7.334293e-02 1 1  ON 29
eH1_0                -2.428981e-01 1 1  ON 30
eH1_1                -1.405724e-01 1 1  ON 31
eH1_2                -9.350628e-02 1 1  ON 32
eH1_3                -3.911592e-02 1 1  ON 33
eH1_4                 8.721588e-03 1 1  ON 34
eH1_5                 4.211829e-02 1 1  ON 35
eH1_6                 9.903696e-02 1 1  ON 36
eH1_7                 1.509734e-01 1 1  ON 37
eH1_8                 1.670552e-01 1 1  ON 38
eH1_9                 5.258326e-02 1 1  ON 39
eH2_0                -2.407507e-01 1 1  ON 40
eH2_1                -1.390002e-01 1 1  ON 41
eH2_2                -9.194481e-02 1 1  ON 42
eH2_3                -3.764329e-02 1 1  ON 43
eH2_4                 1.101634e-02 1 1  ON 44
eH2_5                 4.615170e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728204e-01 1 1  ON 48
eH2_9                 3.834178e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8737
    reference variance = 0.235474
====================================================
  Execution time = 2.0766e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3657e-01
  Total weights = 2.0000e+06
  Execution time = 1.8418e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336408493366
                                         uncertainty =       0.002895359876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336408493366
                                         uncertainty =       0.002895359876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410223928
  error estimate for blocks of size 2^( 2) =       0.000423509020
  error estimate for blocks of size 2^( 3) =       0.000436697406
  error estimate for blocks of size 2^( 4) =       0.000449430024
  error estimate for blocks of size 2^( 5) =       0.000460131638
  error estimate for blocks of size 2^( 6) =       0.000470250901
  error estimate for blocks of size 2^( 7) =       0.000473471283

      target function =                  N/A
              le_mean =     -16.905432958807
             les_mean =     286.130230698972
             stat err =       0.000463320962
             autocorr =       1.275621763556
              std dev =       0.580144242859
             le_variance =       0.336567342523

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336408521797
                                         uncertainty =       0.002895360113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336408521797
                                         uncertainty =       0.002895360113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410223946
  error estimate for blocks of size 2^( 2) =       0.000423509035
  error estimate for blocks of size 2^( 3) =       0.000436697418
  error estimate for blocks of size 2^( 4) =       0.000449430034
  error estimate for blocks of size 2^( 5) =       0.000460131648
  error estimate for blocks of size 2^( 6) =       0.000470250912
  error estimate for blocks of size 2^( 7) =       0.000473471292

      target function =                  N/A
              le_mean =     -16.905432958965
             les_mean =     286.130230732710
             stat err =       0.000463320971
             autocorr =       1.275621709155
              std dev =       0.580144267351
             le_variance =       0.336567370941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336408507581
                                         uncertainty =       0.002895359994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336408507581
                                         uncertainty =       0.002895359994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410223937
  error estimate for blocks of size 2^( 2) =       0.000423509028
  error estimate for blocks of size 2^( 3) =       0.000436697412
  error estimate for blocks of size 2^( 4) =       0.000449430029
  error estimate for blocks of size 2^( 5) =       0.000460131643
  error estimate for blocks of size 2^( 6) =       0.000470250906
  error estimate for blocks of size 2^( 7) =       0.000473471287

      target function =                  N/A
              le_mean =     -16.905432958886
             les_mean =     286.130230715842
             stat err =       0.000463320966
             autocorr =       1.275621736354
              std dev =       0.580144255105
             le_variance =       0.336567356731

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336408495143
                                         uncertainty =       0.002895359891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336408495143
                                         uncertainty =       0.002895359891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410223929
  error estimate for blocks of size 2^( 2) =       0.000423509021
  error estimate for blocks of size 2^( 3) =       0.000436697406
  error estimate for blocks of size 2^( 4) =       0.000449430024
  error estimate for blocks of size 2^( 5) =       0.000460131639
  error estimate for blocks of size 2^( 6) =       0.000470250902
  error estimate for blocks of size 2^( 7) =       0.000473471284

      target function =                  N/A
              le_mean =     -16.905432958817
             les_mean =     286.130230701081
             stat err =       0.000463320962
             autocorr =       1.275621760147
              std dev =       0.580144244390
             le_variance =       0.336567344299


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905432958807        initial
     2.3842e+03     2.3842e+04             1.0801e-07       -16.905432958965  <--
     9.5367e+03     9.5367e+04             2.7003e-08       -16.905432958886
     3.8147e+04     3.8147e+05             6.7508e-09       -16.905432958817

*****************************************************************************
Applying the update for shift_i =   2.3842e+03     and shift_s =   2.3842e+04
*****************************************************************************

  Execution time = 3.0083e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.098012e-01 1 1  ON 0
 uu_1                 1.428663e-01 1 1  ON 1
 uu_2                 4.144430e-02 1 1  ON 2
 uu_3                -2.064508e-02 1 1  ON 3
 uu_4                -6.555934e-02 1 1  ON 4
 uu_5                -9.944263e-02 1 1  ON 5
 uu_6                -1.260238e-01 1 1  ON 6
 uu_7                -1.383241e-01 1 1  ON 7
 uu_8                -1.303817e-01 1 1  ON 8
 uu_9                -9.996242e-02 1 1  ON 9
 ud_0                 4.468375e-01 1 1  ON 10
 ud_1                 1.809921e-01 1 1  ON 11
 ud_2                 6.096136e-02 1 1  ON 12
 ud_3                -1.012023e-02 1 1  ON 13
 ud_4                -6.682835e-02 1 1  ON 14
 ud_5                -1.077118e-01 1 1  ON 15
 ud_6                -1.343621e-01 1 1  ON 16
 ud_7                -1.499600e-01 1 1  ON 17
 ud_8                -1.503535e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360221e-01 1 1  ON 21
 eO_2                -1.913299e-02 1 1  ON 22
 eO_3                 2.975131e-01 1 1  ON 23
 eO_4                 5.204150e-01 1 1  ON 24
 eO_5                 4.792932e-01 1 1  ON 25
 eO_6                 2.486840e-01 1 1  ON 26
 eO_7                -4.872779e-02 1 1  ON 27
 eO_8                -2.127029e-01 1 1  ON 28
 eO_9                -7.334297e-02 1 1  ON 29
eH1_0                -2.428982e-01 1 1  ON 30
eH1_1                -1.405724e-01 1 1  ON 31
eH1_2                -9.350630e-02 1 1  ON 32
eH1_3                -3.911594e-02 1 1  ON 33
eH1_4                 8.721599e-03 1 1  ON 34
eH1_5                 4.211829e-02 1 1  ON 35
eH1_6                 9.903694e-02 1 1  ON 36
eH1_7                 1.509734e-01 1 1  ON 37
eH1_8                 1.670553e-01 1 1  ON 38
eH1_9                 5.258331e-02 1 1  ON 39
eH2_0                -2.407508e-01 1 1  ON 40
eH2_1                -1.390002e-01 1 1  ON 41
eH2_2                -9.194483e-02 1 1  ON 42
eH2_3                -3.764331e-02 1 1  ON 43
eH2_4                 1.101633e-02 1 1  ON 44
eH2_5                 4.615169e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728205e-01 1 1  ON 48
eH2_9                 3.834186e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6935e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8865
    reference variance = 0.263735
====================================================
  Execution time = 2.1176e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4000e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5123e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339878288309
                                         uncertainty =       0.003718939133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339878288309
                                         uncertainty =       0.003718939133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412310166
  error estimate for blocks of size 2^( 2) =       0.000425000932
  error estimate for blocks of size 2^( 3) =       0.000438675818
  error estimate for blocks of size 2^( 4) =       0.000451015044
  error estimate for blocks of size 2^( 5) =       0.000460854854
  error estimate for blocks of size 2^( 6) =       0.000470267174
  error estimate for blocks of size 2^( 7) =       0.000475443287

      target function =                  N/A
              le_mean =     -16.906125626086
             les_mean =     286.157082860432
             stat err =       0.000464395090
             autocorr =       1.268607144777
              std dev =       0.583094628182
             le_variance =       0.339999345415


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690612562609e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906125626086       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906125627639       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906125627508       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906125628033       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906125628146       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906125627779       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906125628075       residual = 8.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 4.000376e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906125626086       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906125626475       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906125626442       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906125626573       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906125626602       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906125626509       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906125626580       residual = 8.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.000139e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906125626086       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906125626183       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906125626175       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906125626208       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906125626215       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906125626187       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906125626219       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.500377e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.075178 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6694e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.098012e-01 1 1  ON 0
 uu_1                 1.428664e-01 1 1  ON 1
 uu_2                 4.144432e-02 1 1  ON 2
 uu_3                -2.064504e-02 1 1  ON 3
 uu_4                -6.555936e-02 1 1  ON 4
 uu_5                -9.944263e-02 1 1  ON 5
 uu_6                -1.260238e-01 1 1  ON 6
 uu_7                -1.383242e-01 1 1  ON 7
 uu_8                -1.303818e-01 1 1  ON 8
 uu_9                -9.996241e-02 1 1  ON 9
 ud_0                 4.468374e-01 1 1  ON 10
 ud_1                 1.809922e-01 1 1  ON 11
 ud_2                 6.096132e-02 1 1  ON 12
 ud_3                -1.012019e-02 1 1  ON 13
 ud_4                -6.682831e-02 1 1  ON 14
 ud_5                -1.077119e-01 1 1  ON 15
 ud_6                -1.343621e-01 1 1  ON 16
 ud_7                -1.499600e-01 1 1  ON 17
 ud_8                -1.503535e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360221e-01 1 1  ON 21
 eO_2                -1.913303e-02 1 1  ON 22
 eO_3                 2.975131e-01 1 1  ON 23
 eO_4                 5.204150e-01 1 1  ON 24
 eO_5                 4.792933e-01 1 1  ON 25
 eO_6                 2.486840e-01 1 1  ON 26
 eO_7                -4.872776e-02 1 1  ON 27
 eO_8                -2.127029e-01 1 1  ON 28
 eO_9                -7.334302e-02 1 1  ON 29
eH1_0                -2.428982e-01 1 1  ON 30
eH1_1                -1.405725e-01 1 1  ON 31
eH1_2                -9.350633e-02 1 1  ON 32
eH1_3                -3.911596e-02 1 1  ON 33
eH1_4                 8.721574e-03 1 1  ON 34
eH1_5                 4.211829e-02 1 1  ON 35
eH1_6                 9.903696e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670554e-01 1 1  ON 38
eH1_9                 5.258338e-02 1 1  ON 39
eH2_0                -2.407509e-01 1 1  ON 40
eH2_1                -1.390003e-01 1 1  ON 41
eH2_2                -9.194485e-02 1 1  ON 42
eH2_3                -3.764331e-02 1 1  ON 43
eH2_4                 1.101630e-02 1 1  ON 44
eH2_5                 4.615166e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728206e-01 1 1  ON 48
eH2_9                 3.834196e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8324
    reference variance = 0.188
====================================================
  Execution time = 2.2745e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4055e-01
  Total weights = 2.0000e+06
  Execution time = 1.8486e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340613175506
                                         uncertainty =       0.006892643453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340613175506
                                         uncertainty =       0.006892643453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412644936
  error estimate for blocks of size 2^( 2) =       0.000425305521
  error estimate for blocks of size 2^( 3) =       0.000438022079
  error estimate for blocks of size 2^( 4) =       0.000450115511
  error estimate for blocks of size 2^( 5) =       0.000460623239
  error estimate for blocks of size 2^( 6) =       0.000469752960
  error estimate for blocks of size 2^( 7) =       0.000474876621

      target function =                  N/A
              le_mean =     -16.905515287646
             les_mean =     286.136998657320
             stat err =       0.000463842083
             autocorr =       1.263534941790
              std dev =       0.583568065243
             le_variance =       0.340551686771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340612892229
                                         uncertainty =       0.006892633892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340612892229
                                         uncertainty =       0.006892633892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412644765
  error estimate for blocks of size 2^( 2) =       0.000425305354
  error estimate for blocks of size 2^( 3) =       0.000438021918
  error estimate for blocks of size 2^( 4) =       0.000450115354
  error estimate for blocks of size 2^( 5) =       0.000460623080
  error estimate for blocks of size 2^( 6) =       0.000469752797
  error estimate for blocks of size 2^( 7) =       0.000474876464

      target function =                  N/A
              le_mean =     -16.905515289513
             les_mean =     286.136998437198
             stat err =       0.000463841924
             autocorr =       1.263535125991
              std dev =       0.583567822545
             le_variance =       0.340551403509

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340613033805
                                         uncertainty =       0.006892638669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340613033805
                                         uncertainty =       0.006892638669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412644850
  error estimate for blocks of size 2^( 2) =       0.000425305437
  error estimate for blocks of size 2^( 3) =       0.000438021998
  error estimate for blocks of size 2^( 4) =       0.000450115432
  error estimate for blocks of size 2^( 5) =       0.000460623160
  error estimate for blocks of size 2^( 6) =       0.000469752879
  error estimate for blocks of size 2^( 7) =       0.000474876542

      target function =                  N/A
              le_mean =     -16.905515288580
             les_mean =     286.136998547215
             stat err =       0.000463842003
             autocorr =       1.263535033916
              std dev =       0.583567943840
             le_variance =       0.340551545078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340613157792
                                         uncertainty =       0.006892642855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340613157792
                                         uncertainty =       0.006892642855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412644925
  error estimate for blocks of size 2^( 2) =       0.000425305510
  error estimate for blocks of size 2^( 3) =       0.000438022069
  error estimate for blocks of size 2^( 4) =       0.000450115501
  error estimate for blocks of size 2^( 5) =       0.000460623229
  error estimate for blocks of size 2^( 6) =       0.000469752950
  error estimate for blocks of size 2^( 7) =       0.000474876611

      target function =                  N/A
              le_mean =     -16.905515287763
             les_mean =     286.136998643555
             stat err =       0.000463842073
             autocorr =       1.263534953300
              std dev =       0.583568050066
             le_variance =       0.340551669058


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905515287646        initial
     5.9605e+02     5.9605e+03             4.0004e-07       -16.905515289513  <--
     2.3842e+03     2.3842e+04             1.0001e-07       -16.905515288580
     9.5367e+03     9.5367e+04             2.5004e-08       -16.905515287763

*****************************************************************************
Applying the update for shift_i =   5.9605e+02     and shift_s =   5.9605e+03
*****************************************************************************

  Execution time = 3.2041e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334316e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9574e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.906
    reference variance = 0.359138
====================================================
  Execution time = 2.1511e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4711e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5415e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347269107267
                                         uncertainty =       0.008692598217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347269107267
                                         uncertainty =       0.008692598217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416598575
  error estimate for blocks of size 2^( 2) =       0.000428712325
  error estimate for blocks of size 2^( 3) =       0.000441812775
  error estimate for blocks of size 2^( 4) =       0.000453843789
  error estimate for blocks of size 2^( 5) =       0.000463311375
  error estimate for blocks of size 2^( 6) =       0.000470179190
  error estimate for blocks of size 2^( 7) =       0.000476320275

      target function =                  N/A
              le_mean =     -16.905524073951
             les_mean =     286.143852786596
             stat err =       0.000465913657
             autocorr =       1.250763853800
              std dev =       0.589159354693
             le_variance =       0.347108745222


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690552407395e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905524073951       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905524078331       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905524083131       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905524084375       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905524086148       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905524084356       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905524083938       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905524084412       residual = 2.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.423565e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905524073951       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905524075047       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905524076248       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905524076559       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905524077004       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905524076557       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905524076453       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905524076569       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 3.560350e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905524073951       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905524074225       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905524074525       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905524074602       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905524074714       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905524074602       residual = 6.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905524074577       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905524074608       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 8.901773e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.077812 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7059e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.098012e-01 1 1  ON 0
 uu_1                 1.428666e-01 1 1  ON 1
 uu_2                 4.144435e-02 1 1  ON 2
 uu_3                -2.064488e-02 1 1  ON 3
 uu_4                -6.555942e-02 1 1  ON 4
 uu_5                -9.944259e-02 1 1  ON 5
 uu_6                -1.260241e-01 1 1  ON 6
 uu_7                -1.383248e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996237e-02 1 1  ON 9
 ud_0                 4.468372e-01 1 1  ON 10
 ud_1                 1.809926e-01 1 1  ON 11
 ud_2                 6.096125e-02 1 1  ON 12
 ud_3                -1.012003e-02 1 1  ON 13
 ud_4                -6.682824e-02 1 1  ON 14
 ud_5                -1.077121e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499600e-01 1 1  ON 17
 ud_8                -1.503535e-01 1 1  ON 18
 ud_9                -1.383544e-01 1 1  ON 19
 eO_0                -7.564293e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975131e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792936e-01 1 1  ON 25
 eO_6                 2.486844e-01 1 1  ON 26
 eO_7                -4.872752e-02 1 1  ON 27
 eO_8                -2.127033e-01 1 1  ON 28
 eO_9                -7.334339e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405730e-01 1 1  ON 31
eH1_2                -9.350658e-02 1 1  ON 32
eH1_3                -3.911624e-02 1 1  ON 33
eH1_4                 8.721500e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903689e-02 1 1  ON 36
eH1_7                 1.509737e-01 1 1  ON 37
eH1_8                 1.670559e-01 1 1  ON 38
eH1_9                 5.258394e-02 1 1  ON 39
eH2_0                -2.407513e-01 1 1  ON 40
eH2_1                -1.390005e-01 1 1  ON 41
eH2_2                -9.194493e-02 1 1  ON 42
eH2_3                -3.764341e-02 1 1  ON 43
eH2_4                 1.101605e-02 1 1  ON 44
eH2_5                 4.615149e-02 1 1  ON 45
eH2_6                 1.031961e-01 1 1  ON 46
eH2_7                 1.544423e-01 1 1  ON 47
eH2_8                 1.728210e-01 1 1  ON 48
eH2_9                 3.834257e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8842
    reference variance = 0.200413
====================================================
  Execution time = 2.2271e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3588e-01
  Total weights = 2.0000e+06
  Execution time = 1.8482e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335901320888
                                         uncertainty =       0.004093005420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335901320888
                                         uncertainty =       0.004093005420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409806653
  error estimate for blocks of size 2^( 2) =       0.000422748469
  error estimate for blocks of size 2^( 3) =       0.000436754411
  error estimate for blocks of size 2^( 4) =       0.000449862270
  error estimate for blocks of size 2^( 5) =       0.000460810098
  error estimate for blocks of size 2^( 6) =       0.000469603450
  error estimate for blocks of size 2^( 7) =       0.000474241470

      target function =                  N/A
              le_mean =     -16.905881301648
             les_mean =     286.144705402603
             stat err =       0.000463629322
             autocorr =       1.279922817690
              std dev =       0.579554126141
             le_variance =       0.335882985127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335901368783
                                         uncertainty =       0.004093005767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335901368783
                                         uncertainty =       0.004093005767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409806682
  error estimate for blocks of size 2^( 2) =       0.000422748487
  error estimate for blocks of size 2^( 3) =       0.000436754411
  error estimate for blocks of size 2^( 4) =       0.000449862255
  error estimate for blocks of size 2^( 5) =       0.000460810086
  error estimate for blocks of size 2^( 6) =       0.000469603440
  error estimate for blocks of size 2^( 7) =       0.000474241484

      target function =                  N/A
              le_mean =     -16.905881299202
             les_mean =     286.144705367774
             stat err =       0.000463629316
             autocorr =       1.279922603264
              std dev =       0.579554167456
             le_variance =       0.335883033015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335901344381
                                         uncertainty =       0.004093005584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335901344381
                                         uncertainty =       0.004093005584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409806667
  error estimate for blocks of size 2^( 2) =       0.000422748478
  error estimate for blocks of size 2^( 3) =       0.000436754410
  error estimate for blocks of size 2^( 4) =       0.000449862262
  error estimate for blocks of size 2^( 5) =       0.000460810092
  error estimate for blocks of size 2^( 6) =       0.000469603445
  error estimate for blocks of size 2^( 7) =       0.000474241477

      target function =                  N/A
              le_mean =     -16.905881300423
             les_mean =     286.144705384662
             stat err =       0.000463629319
             autocorr =       1.279922710863
              std dev =       0.579554146406
             le_variance =       0.335883008617

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335901323810
                                         uncertainty =       0.004093005440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335901323810
                                         uncertainty =       0.004093005440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409806654
  error estimate for blocks of size 2^( 2) =       0.000422748470
  error estimate for blocks of size 2^( 3) =       0.000436754411
  error estimate for blocks of size 2^( 4) =       0.000449862269
  error estimate for blocks of size 2^( 5) =       0.000460810097
  error estimate for blocks of size 2^( 6) =       0.000469603449
  error estimate for blocks of size 2^( 7) =       0.000474241471

      target function =                  N/A
              le_mean =     -16.905881301495
             les_mean =     286.144705400340
             stat err =       0.000463629322
             autocorr =       1.279922804348
              std dev =       0.579554128661
             le_variance =       0.335882988048


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905881301648        initial  <--
     1.4901e+02     1.4901e+03             1.4236e-06       -16.905881299202
     5.9605e+02     5.9605e+03             3.5603e-07       -16.905881300423
     2.3842e+03     2.3842e+04             8.9018e-08       -16.905881301495

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.5708
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334316e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9781e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9324
    reference variance = 0.325455
====================================================
  Execution time = 2.1649e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3658e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5744e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336474270018
                                         uncertainty =       0.003632703025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336474270018
                                         uncertainty =       0.003632703025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410233361
  error estimate for blocks of size 2^( 2) =       0.000422880433
  error estimate for blocks of size 2^( 3) =       0.000435716101
  error estimate for blocks of size 2^( 4) =       0.000448237279
  error estimate for blocks of size 2^( 5) =       0.000459556678
  error estimate for blocks of size 2^( 6) =       0.000468436265
  error estimate for blocks of size 2^( 7) =       0.000474072752

      target function =                  N/A
              le_mean =     -16.906116642153
             les_mean =     286.153362570460
             stat err =       0.000462575744
             autocorr =       1.271463101218
              std dev =       0.580157582605
             le_variance =       0.336582820654


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690611664215e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906116642153       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906116642339       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906116642450       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906116642323       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906116642503       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906116642162       residual = 8.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906116642235       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906116642298       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.601080e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906116642153       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906116642200       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906116642228       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906116642195       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906116642241       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906116642155       residual = 8.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906116642173       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906116642194       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 4.002773e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906116642153       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906116642165       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906116642172       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906116642164       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906116642184       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906116642163       residual = 8.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906116642166       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906116642160       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 1.000698e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.080423 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7230e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144440e-02 1 1  ON 2
 uu_3                -2.064494e-02 1 1  ON 3
 uu_4                -6.555939e-02 1 1  ON 4
 uu_5                -9.944262e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996242e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012006e-02 1 1  ON 13
 ud_4                -6.682820e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503534e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564293e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913316e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486842e-01 1 1  ON 26
 eO_7                -4.872768e-02 1 1  ON 27
 eO_8                -2.127031e-01 1 1  ON 28
 eO_9                -7.334319e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350646e-02 1 1  ON 32
eH1_3                -3.911606e-02 1 1  ON 33
eH1_4                 8.721494e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903703e-02 1 1  ON 36
eH1_7                 1.509736e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258362e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194494e-02 1 1  ON 42
eH2_3                -3.764331e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834229e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8481
    reference variance = 0.202998
====================================================
  Execution time = 2.0658e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3590e-01
  Total weights = 2.0000e+06
  Execution time = 1.8449e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335989340760
                                         uncertainty =       0.003079330659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335989340760
                                         uncertainty =       0.003079330659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409819320
  error estimate for blocks of size 2^( 2) =       0.000422890018
  error estimate for blocks of size 2^( 3) =       0.000436636714
  error estimate for blocks of size 2^( 4) =       0.000450200516
  error estimate for blocks of size 2^( 5) =       0.000461367013
  error estimate for blocks of size 2^( 6) =       0.000469576182
  error estimate for blocks of size 2^( 7) =       0.000475336996

      target function =                  N/A
              le_mean =     -16.906269996240
             les_mean =     286.157868768015
             stat err =       0.000464120177
             autocorr =       1.282555126749
              std dev =       0.579572040548
             le_variance =       0.335903750186

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335989275401
                                         uncertainty =       0.003079329902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335989275401
                                         uncertainty =       0.003079329902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409819280
  error estimate for blocks of size 2^( 2) =       0.000422889977
  error estimate for blocks of size 2^( 3) =       0.000436636671
  error estimate for blocks of size 2^( 4) =       0.000450200471
  error estimate for blocks of size 2^( 5) =       0.000461366968
  error estimate for blocks of size 2^( 6) =       0.000469576138
  error estimate for blocks of size 2^( 7) =       0.000475336949

      target function =                  N/A
              le_mean =     -16.906269995307
             les_mean =     286.157868671090
             stat err =       0.000464120132
             autocorr =       1.282555127065
              std dev =       0.579571984159
             le_variance =       0.335903684821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335989308065
                                         uncertainty =       0.003079330280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335989308065
                                         uncertainty =       0.003079330280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409819300
  error estimate for blocks of size 2^( 2) =       0.000422889998
  error estimate for blocks of size 2^( 3) =       0.000436636693
  error estimate for blocks of size 2^( 4) =       0.000450200494
  error estimate for blocks of size 2^( 5) =       0.000461366990
  error estimate for blocks of size 2^( 6) =       0.000469576160
  error estimate for blocks of size 2^( 7) =       0.000475336972

      target function =                  N/A
              le_mean =     -16.906269995774
             les_mean =     286.157868719535
             stat err =       0.000464120154
             autocorr =       1.282555126916
              std dev =       0.579572012340
             le_variance =       0.335903717488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335989336673
                                         uncertainty =       0.003079330612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335989336673
                                         uncertainty =       0.003079330612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409819318
  error estimate for blocks of size 2^( 2) =       0.000422890015
  error estimate for blocks of size 2^( 3) =       0.000436636711
  error estimate for blocks of size 2^( 4) =       0.000450200514
  error estimate for blocks of size 2^( 5) =       0.000461367010
  error estimate for blocks of size 2^( 6) =       0.000469576180
  error estimate for blocks of size 2^( 7) =       0.000475336993

      target function =                  N/A
              le_mean =     -16.906269996182
             les_mean =     286.157868761954
             stat err =       0.000464120174
             autocorr =       1.282555126780
              std dev =       0.579572037022
             le_variance =       0.335903746098


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906269996240        initial  <--
     1.4901e+03     1.4901e+04             1.6011e-07       -16.906269995307
     5.9605e+03     5.9605e+04             4.0028e-08       -16.906269995774
     2.3842e+04     2.3842e+05             1.0007e-08       -16.906269996182

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2261
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334316e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7867e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.907
    reference variance = 0.341753
====================================================
  Execution time = 2.0852e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3424e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5310e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334067664836
                                         uncertainty =       0.002867198769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334067664836
                                         uncertainty =       0.002867198769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408801838
  error estimate for blocks of size 2^( 2) =       0.000421675782
  error estimate for blocks of size 2^( 3) =       0.000435318025
  error estimate for blocks of size 2^( 4) =       0.000447553164
  error estimate for blocks of size 2^( 5) =       0.000457499737
  error estimate for blocks of size 2^( 6) =       0.000465117258
  error estimate for blocks of size 2^( 7) =       0.000469207230

      target function =                  N/A
              le_mean =     -16.906737625744
             les_mean =     286.172014864908
             stat err =       0.000459844347
             autocorr =       1.265307328721
              std dev =       0.578133104301
             le_variance =       0.334237886289


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690673762574e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906737625744       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906737625773       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906737625795       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906737625808       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906737625808       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906737625817       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906737625808       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906737625817       residual = 5.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.552155e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906737625744       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906737625751       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906737625757       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906737625760       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906737625783       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906737625802       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906737625755       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906737625729       residual = 5.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 3.880392e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906737625744       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906737625746       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906737625747       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906737625748       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906737625720       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906737625739       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906737625662       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906737625836       residual = 5.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 9.700982e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.083090 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6390e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334317e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721497e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903703e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194493e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9395
    reference variance = 0.273727
====================================================
  Execution time = 2.0996e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4334e-01
  Total weights = 2.0000e+06
  Execution time = 1.8522e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343414996731
                                         uncertainty =       0.005133362583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343414996731
                                         uncertainty =       0.005133362583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414330153
  error estimate for blocks of size 2^( 2) =       0.000426858355
  error estimate for blocks of size 2^( 3) =       0.000440060227
  error estimate for blocks of size 2^( 4) =       0.000452563241
  error estimate for blocks of size 2^( 5) =       0.000464452252
  error estimate for blocks of size 2^( 6) =       0.000471900573
  error estimate for blocks of size 2^( 7) =       0.000477404286

      target function =                  N/A
              le_mean =     -16.906659169262
             les_mean =     286.178463045774
             stat err =       0.000466580088
             autocorr =       1.268116987066
              std dev =       0.585951322078
             le_variance =       0.343338951845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343414992074
                                         uncertainty =       0.005133362612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343414992074
                                         uncertainty =       0.005133362612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414330150
  error estimate for blocks of size 2^( 2) =       0.000426858352
  error estimate for blocks of size 2^( 3) =       0.000440060224
  error estimate for blocks of size 2^( 4) =       0.000452563238
  error estimate for blocks of size 2^( 5) =       0.000464452249
  error estimate for blocks of size 2^( 6) =       0.000471900571
  error estimate for blocks of size 2^( 7) =       0.000477404284

      target function =                  N/A
              le_mean =     -16.906659169193
             les_mean =     286.178463038783
             stat err =       0.000466580086
             autocorr =       1.268116990446
              std dev =       0.585951318106
             le_variance =       0.343338947190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343414994403
                                         uncertainty =       0.005133362598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343414994403
                                         uncertainty =       0.005133362598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414330152
  error estimate for blocks of size 2^( 2) =       0.000426858354
  error estimate for blocks of size 2^( 3) =       0.000440060225
  error estimate for blocks of size 2^( 4) =       0.000452563240
  error estimate for blocks of size 2^( 5) =       0.000464452251
  error estimate for blocks of size 2^( 6) =       0.000471900572
  error estimate for blocks of size 2^( 7) =       0.000477404285

      target function =                  N/A
              le_mean =     -16.906659169228
             les_mean =     286.178463042278
             stat err =       0.000466580087
             autocorr =       1.268116988753
              std dev =       0.585951320092
             le_variance =       0.343338949518

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343414996440
                                         uncertainty =       0.005133362585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343414996440
                                         uncertainty =       0.005133362585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414330153
  error estimate for blocks of size 2^( 2) =       0.000426858355
  error estimate for blocks of size 2^( 3) =       0.000440060226
  error estimate for blocks of size 2^( 4) =       0.000452563241
  error estimate for blocks of size 2^( 5) =       0.000464452252
  error estimate for blocks of size 2^( 6) =       0.000471900573
  error estimate for blocks of size 2^( 7) =       0.000477404286

      target function =                  N/A
              le_mean =     -16.906659169258
             les_mean =     286.178463045337
             stat err =       0.000466580088
             autocorr =       1.268116987286
              std dev =       0.585951321830
             le_variance =       0.343338951554


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906659169262        initial  <--
     1.4901e+04     1.4901e+05             1.5522e-08       -16.906659169193
     5.9605e+04     5.9605e+05             3.8804e-09       -16.906659169228
     2.3842e+05     2.3842e+06             9.7010e-10       -16.906659169258

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3420
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334316e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7051e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.7993
    reference variance = 0.182571
====================================================
  Execution time = 2.1273e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3952e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5092e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339641047570
                                         uncertainty =       0.005467655889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339641047570
                                         uncertainty =       0.005467655889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412021561
  error estimate for blocks of size 2^( 2) =       0.000424762610
  error estimate for blocks of size 2^( 3) =       0.000437596053
  error estimate for blocks of size 2^( 4) =       0.000449827860
  error estimate for blocks of size 2^( 5) =       0.000460187303
  error estimate for blocks of size 2^( 6) =       0.000467899354
  error estimate for blocks of size 2^( 7) =       0.000474007325

      target function =                  N/A
              le_mean =     -16.906345065429
             les_mean =     286.164026834573
             stat err =       0.000462980460
             autocorr =       1.262657141049
              std dev =       0.582686479159
             le_variance =       0.339523532995


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690634506543e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906345065429       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906345065432       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906345065433       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906345065433       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906345065399       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906345065455       residual = 9.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906345065375       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906345065517       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 1.920879e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906345065429       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906345065430       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906345065430       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906345065518       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906345065491       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906345065548       residual = 9.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906345065489       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906345065408       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 4.802199e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906345065429       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906345065429       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906345065429       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906345065131       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906345063110       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906345064828       residual = 9.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906345064963       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906345066340       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 1.200550e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.085696 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6789e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334317e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8304
    reference variance = 0.437878
====================================================
  Execution time = 2.0752e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4553e-01
  Total weights = 2.0000e+06
  Execution time = 1.8535e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345635759716
                                         uncertainty =       0.010242650625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345635759716
                                         uncertainty =       0.010242650625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415652770
  error estimate for blocks of size 2^( 2) =       0.000428259846
  error estimate for blocks of size 2^( 3) =       0.000441039323
  error estimate for blocks of size 2^( 4) =       0.000453662531
  error estimate for blocks of size 2^( 5) =       0.000464091535
  error estimate for blocks of size 2^( 6) =       0.000472002324
  error estimate for blocks of size 2^( 7) =       0.000479535824

      target function =                  N/A
              le_mean =     -16.905554938736
             les_mean =     286.143322063966
             stat err =       0.000467323053
             autocorr =       1.264075614391
              std dev =       0.587821784324
             le_variance =       0.345534450126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345635760320
                                         uncertainty =       0.010242650576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345635760320
                                         uncertainty =       0.010242650576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415652770
  error estimate for blocks of size 2^( 2) =       0.000428259847
  error estimate for blocks of size 2^( 3) =       0.000441039324
  error estimate for blocks of size 2^( 4) =       0.000453662531
  error estimate for blocks of size 2^( 5) =       0.000464091535
  error estimate for blocks of size 2^( 6) =       0.000472002324
  error estimate for blocks of size 2^( 7) =       0.000479535824

      target function =                  N/A
              le_mean =     -16.905554938734
             les_mean =     286.143322064530
             stat err =       0.000467323054
             autocorr =       1.264075613745
              std dev =       0.587821784837
             le_variance =       0.345534450729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345635760018
                                         uncertainty =       0.010242650600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345635760018
                                         uncertainty =       0.010242650600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415652770
  error estimate for blocks of size 2^( 2) =       0.000428259846
  error estimate for blocks of size 2^( 3) =       0.000441039323
  error estimate for blocks of size 2^( 4) =       0.000453662531
  error estimate for blocks of size 2^( 5) =       0.000464091535
  error estimate for blocks of size 2^( 6) =       0.000472002324
  error estimate for blocks of size 2^( 7) =       0.000479535824

      target function =                  N/A
              le_mean =     -16.905554938735
             les_mean =     286.143322064248
             stat err =       0.000467323053
             autocorr =       1.264075614065
              std dev =       0.587821784580
             le_variance =       0.345534450427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345635759753
                                         uncertainty =       0.010242650622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345635759753
                                         uncertainty =       0.010242650622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415652770
  error estimate for blocks of size 2^( 2) =       0.000428259846
  error estimate for blocks of size 2^( 3) =       0.000441039323
  error estimate for blocks of size 2^( 4) =       0.000453662531
  error estimate for blocks of size 2^( 5) =       0.000464091535
  error estimate for blocks of size 2^( 6) =       0.000472002324
  error estimate for blocks of size 2^( 7) =       0.000479535824

      target function =                  N/A
              le_mean =     -16.905554938736
             les_mean =     286.143322064001
             stat err =       0.000467323053
             autocorr =       1.264075614355
              std dev =       0.587821784356
             le_variance =       0.345534450163


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905554938736        initial  <--
     1.4901e+05     1.4901e+06             1.9209e-09       -16.905554938734
     5.9605e+05     5.9605e+06             4.8022e-10       -16.905554938735
     2.3842e+06     2.3842e+07             1.2006e-10       -16.905554938736

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0750
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334316e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7043e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9539
    reference variance = 0.583527
====================================================
  Execution time = 2.0799e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5576e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5328e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355669816498
                                         uncertainty =       0.015075193380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355669816498
                                         uncertainty =       0.015075193380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421756254
  error estimate for blocks of size 2^( 2) =       0.000434212423
  error estimate for blocks of size 2^( 3) =       0.000446622314
  error estimate for blocks of size 2^( 4) =       0.000458634809
  error estimate for blocks of size 2^( 5) =       0.000468549624
  error estimate for blocks of size 2^( 6) =       0.000476702161
  error estimate for blocks of size 2^( 7) =       0.000483081295

      target function =                  N/A
              le_mean =     -16.906093884203
             les_mean =     286.171766918522
             stat err =       0.000471741972
             autocorr =       1.251082574044
              std dev =       0.596453413879
             le_variance =       0.355756674928


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690609388420e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906093884203       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906093884203       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906093884204       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906093884167       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906093884124       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906093884361       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906093884698       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906093884547       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.477848e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906093884203       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906093884203       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906093884203       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906093884018       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906093885297       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906093876904       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906093885609       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906093880263       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 3.694582e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906093884203       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906093884203       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906093884203       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906093884203       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906093885048       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906093892959       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906093885818       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906093885547       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 9.236586e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.088319 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6339e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334316e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8344
    reference variance = 0.223595
====================================================
  Execution time = 2.2329e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3490e-01
  Total weights = 2.0000e+06
  Execution time = 1.8517e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334789173835
                                         uncertainty =       0.003495683278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334789173835
                                         uncertainty =       0.003495683278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409206746
  error estimate for blocks of size 2^( 2) =       0.000422348417
  error estimate for blocks of size 2^( 3) =       0.000435700940
  error estimate for blocks of size 2^( 4) =       0.000447624251
  error estimate for blocks of size 2^( 5) =       0.000458363584
  error estimate for blocks of size 2^( 6) =       0.000464673336
  error estimate for blocks of size 2^( 7) =       0.000470574137

      target function =                  N/A
              le_mean =     -16.906072965984
             les_mean =     286.150203286302
             stat err =       0.000460308827
             autocorr =       1.265356895200
              std dev =       0.578705730569
             le_variance =       0.334900322593

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334789173837
                                         uncertainty =       0.003495683279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334789173837
                                         uncertainty =       0.003495683279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409206746
  error estimate for blocks of size 2^( 2) =       0.000422348417
  error estimate for blocks of size 2^( 3) =       0.000435700940
  error estimate for blocks of size 2^( 4) =       0.000447624251
  error estimate for blocks of size 2^( 5) =       0.000458363584
  error estimate for blocks of size 2^( 6) =       0.000464673336
  error estimate for blocks of size 2^( 7) =       0.000470574137

      target function =                  N/A
              le_mean =     -16.906072965984
             les_mean =     286.150203286311
             stat err =       0.000460308827
             autocorr =       1.265356895193
              std dev =       0.578705730571
             le_variance =       0.334900322595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334789173836
                                         uncertainty =       0.003495683279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334789173836
                                         uncertainty =       0.003495683279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409206746
  error estimate for blocks of size 2^( 2) =       0.000422348417
  error estimate for blocks of size 2^( 3) =       0.000435700940
  error estimate for blocks of size 2^( 4) =       0.000447624251
  error estimate for blocks of size 2^( 5) =       0.000458363584
  error estimate for blocks of size 2^( 6) =       0.000464673336
  error estimate for blocks of size 2^( 7) =       0.000470574137

      target function =                  N/A
              le_mean =     -16.906072965984
             les_mean =     286.150203286306
             stat err =       0.000460308827
             autocorr =       1.265356895201
              std dev =       0.578705730570
             le_variance =       0.334900322594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334789173835
                                         uncertainty =       0.003495683278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334789173835
                                         uncertainty =       0.003495683278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409206746
  error estimate for blocks of size 2^( 2) =       0.000422348417
  error estimate for blocks of size 2^( 3) =       0.000435700940
  error estimate for blocks of size 2^( 4) =       0.000447624251
  error estimate for blocks of size 2^( 5) =       0.000458363584
  error estimate for blocks of size 2^( 6) =       0.000464673336
  error estimate for blocks of size 2^( 7) =       0.000470574137

      target function =                  N/A
              le_mean =     -16.906072965984
             les_mean =     286.150203286302
             stat err =       0.000460308827
             autocorr =       1.265356895198
              std dev =       0.578705730569
             le_variance =       0.334900322594


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906072965984        initial
     1.4901e+06     1.4901e+07             1.4778e-10       -16.906072965984  <--
     5.9605e+06     5.9605e+07             3.6946e-11       -16.906072965984
     2.3842e+07     2.3842e+08             9.2366e-12       -16.906072965984

*****************************************************************************
Applying the update for shift_i =   1.4901e+06     and shift_s =   1.4901e+07
*****************************************************************************

  Execution time = 3.1641e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334316e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8173e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8588
    reference variance = 0.248119
====================================================
  Execution time = 2.1197e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4127e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5511e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341330676564
                                         uncertainty =       0.004499343518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341330676564
                                         uncertainty =       0.004499343518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413082980
  error estimate for blocks of size 2^( 2) =       0.000425797749
  error estimate for blocks of size 2^( 3) =       0.000439569359
  error estimate for blocks of size 2^( 4) =       0.000451120032
  error estimate for blocks of size 2^( 5) =       0.000461167712
  error estimate for blocks of size 2^( 6) =       0.000470050989
  error estimate for blocks of size 2^( 7) =       0.000473561027

      target function =                  N/A
              le_mean =     -16.906039931843
             les_mean =     286.155461102827
             stat err =       0.000463974940
             autocorr =       1.261578985228
              std dev =       0.584187552410
             le_variance =       0.341275096391


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690603993184e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906039931843       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906039931844       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906039931849       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906039931848       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906039931934       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906039932029       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906039932033       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906039931841       residual = 5.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 6.399290e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906039931843       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906039931843       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906039931844       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906039931606       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906039931584       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906039931943       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906039932154       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906039931246       residual = 5.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.599823e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906039931843       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906039931843       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906039931843       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906039931551       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906039931826       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906039928117       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906039937383       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906039932246       residual = 5.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 3.999547e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.090954 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6755e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334316e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8832
    reference variance = 0.174141
====================================================
  Execution time = 2.0400e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4346e-01
  Total weights = 2.0000e+06
  Execution time = 1.8417e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343576762433
                                         uncertainty =       0.008129521728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343576762433
                                         uncertainty =       0.008129521728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414401735
  error estimate for blocks of size 2^( 2) =       0.000427676694
  error estimate for blocks of size 2^( 3) =       0.000440640387
  error estimate for blocks of size 2^( 4) =       0.000454157005
  error estimate for blocks of size 2^( 5) =       0.000464284800
  error estimate for blocks of size 2^( 6) =       0.000473577793
  error estimate for blocks of size 2^( 7) =       0.000479375874

      target function =                  N/A
              le_mean =     -16.905448413779
             les_mean =     286.137643495045
             stat err =       0.000467848868
             autocorr =       1.274582748647
              std dev =       0.586052553802
             le_variance =       0.343457595818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343576762184
                                         uncertainty =       0.008129521718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343576762184
                                         uncertainty =       0.008129521718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414401735
  error estimate for blocks of size 2^( 2) =       0.000427676694
  error estimate for blocks of size 2^( 3) =       0.000440640387
  error estimate for blocks of size 2^( 4) =       0.000454157005
  error estimate for blocks of size 2^( 5) =       0.000464284800
  error estimate for blocks of size 2^( 6) =       0.000473577793
  error estimate for blocks of size 2^( 7) =       0.000479375874

      target function =                  N/A
              le_mean =     -16.905448413780
             les_mean =     286.137643494823
             stat err =       0.000467848868
             autocorr =       1.274582748748
              std dev =       0.586052553590
             le_variance =       0.343457595569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343576762309
                                         uncertainty =       0.008129521723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343576762309
                                         uncertainty =       0.008129521723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414401735
  error estimate for blocks of size 2^( 2) =       0.000427676694
  error estimate for blocks of size 2^( 3) =       0.000440640387
  error estimate for blocks of size 2^( 4) =       0.000454157005
  error estimate for blocks of size 2^( 5) =       0.000464284800
  error estimate for blocks of size 2^( 6) =       0.000473577793
  error estimate for blocks of size 2^( 7) =       0.000479375874

      target function =                  N/A
              le_mean =     -16.905448413780
             les_mean =     286.137643494934
             stat err =       0.000467848868
             autocorr =       1.274582748700
              std dev =       0.586052553696
             le_variance =       0.343457595693

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343576762418
                                         uncertainty =       0.008129521728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343576762418
                                         uncertainty =       0.008129521728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414401735
  error estimate for blocks of size 2^( 2) =       0.000427676694
  error estimate for blocks of size 2^( 3) =       0.000440640387
  error estimate for blocks of size 2^( 4) =       0.000454157005
  error estimate for blocks of size 2^( 5) =       0.000464284800
  error estimate for blocks of size 2^( 6) =       0.000473577793
  error estimate for blocks of size 2^( 7) =       0.000479375874

      target function =                  N/A
              le_mean =     -16.905448413779
             les_mean =     286.137643495031
             stat err =       0.000467848868
             autocorr =       1.274582748655
              std dev =       0.586052553788
             le_variance =       0.343457595802


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905448413779        initial
     3.7253e+05     3.7253e+06             6.3993e-10       -16.905448413780  <--
     1.4901e+06     1.4901e+07             1.5998e-10       -16.905448413780
     5.9605e+06     5.9605e+07             3.9995e-11       -16.905448413779

*****************************************************************************
Applying the update for shift_i =   3.7253e+05     and shift_s =   3.7253e+06
*****************************************************************************

  Execution time = 2.9676e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334317e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6462e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9799
    reference variance = 0.538707
====================================================
  Execution time = 2.0446e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3804e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5769e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337108801593
                                         uncertainty =       0.003214348287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337108801593
                                         uncertainty =       0.003214348287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411120568
  error estimate for blocks of size 2^( 2) =       0.000423157967
  error estimate for blocks of size 2^( 3) =       0.000435915982
  error estimate for blocks of size 2^( 4) =       0.000447511166
  error estimate for blocks of size 2^( 5) =       0.000457074496
  error estimate for blocks of size 2^( 6) =       0.000464617227
  error estimate for blocks of size 2^( 7) =       0.000467630688

      target function =                  N/A
              le_mean =     -16.906797511689
             les_mean =     286.177842174711
             stat err =       0.000459208394
             autocorr =       1.247616837931
              std dev =       0.581412282717
             le_variance =       0.338040242494


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690679751169e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906797511689       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906797511690       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906797511702       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906797511704       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906797511701       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906797511722       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906797511744       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906797511641       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 3.220227e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906797511689       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906797511689       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906797511692       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906797511692       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906797511601       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906797511690       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906797511648       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906797511727       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 8.050571e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906797511689       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906797511689       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906797511689       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906797511690       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906797510595       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906797510329       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906797511953       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906797511820       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 2.012650e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.093512 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6032e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334317e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9156
    reference variance = 0.939332
====================================================
  Execution time = 2.0042e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3034e-01
  Total weights = 2.0000e+06
  Execution time = 1.8462e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330285320570
                                         uncertainty =       0.002714051959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330285320570
                                         uncertainty =       0.002714051959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406411772
  error estimate for blocks of size 2^( 2) =       0.000419072175
  error estimate for blocks of size 2^( 3) =       0.000432096508
  error estimate for blocks of size 2^( 4) =       0.000445098525
  error estimate for blocks of size 2^( 5) =       0.000455681652
  error estimate for blocks of size 2^( 6) =       0.000463389221
  error estimate for blocks of size 2^( 7) =       0.000468546612

      target function =                  N/A
              le_mean =     -16.906309679847
             les_mean =     286.153647882897
             stat err =       0.000458179002
             autocorr =       1.270977334804
              std dev =       0.574753040158
             le_variance =       0.330341057171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330285319088
                                         uncertainty =       0.002714051945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330285319088
                                         uncertainty =       0.002714051945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406411771
  error estimate for blocks of size 2^( 2) =       0.000419072174
  error estimate for blocks of size 2^( 3) =       0.000432096507
  error estimate for blocks of size 2^( 4) =       0.000445098524
  error estimate for blocks of size 2^( 5) =       0.000455681651
  error estimate for blocks of size 2^( 6) =       0.000463389220
  error estimate for blocks of size 2^( 7) =       0.000468546611

      target function =                  N/A
              le_mean =     -16.906309679840
             les_mean =     286.153647881169
             stat err =       0.000458179002
             autocorr =       1.270977335936
              std dev =       0.574753038867
             le_variance =       0.330341055687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330285319829
                                         uncertainty =       0.002714051952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330285319829
                                         uncertainty =       0.002714051952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406411772
  error estimate for blocks of size 2^( 2) =       0.000419072174
  error estimate for blocks of size 2^( 3) =       0.000432096508
  error estimate for blocks of size 2^( 4) =       0.000445098524
  error estimate for blocks of size 2^( 5) =       0.000455681652
  error estimate for blocks of size 2^( 6) =       0.000463389221
  error estimate for blocks of size 2^( 7) =       0.000468546611

      target function =                  N/A
              le_mean =     -16.906309679844
             les_mean =     286.153647882033
             stat err =       0.000458179002
             autocorr =       1.270977335364
              std dev =       0.574753039513
             le_variance =       0.330341056429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330285320477
                                         uncertainty =       0.002714051958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330285320477
                                         uncertainty =       0.002714051958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406411772
  error estimate for blocks of size 2^( 2) =       0.000419072175
  error estimate for blocks of size 2^( 3) =       0.000432096508
  error estimate for blocks of size 2^( 4) =       0.000445098525
  error estimate for blocks of size 2^( 5) =       0.000455681652
  error estimate for blocks of size 2^( 6) =       0.000463389221
  error estimate for blocks of size 2^( 7) =       0.000468546612

      target function =                  N/A
              le_mean =     -16.906309679847
             les_mean =     286.153647882789
             stat err =       0.000458179002
             autocorr =       1.270977334869
              std dev =       0.574753040077
             le_variance =       0.330341057078


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906309679847        initial  <--
     9.3132e+04     9.3132e+05             3.2202e-09       -16.906309679840
     3.7253e+05     3.7253e+06             8.0506e-10       -16.906309679844
     1.4901e+06     1.4901e+07             2.0126e-10       -16.906309679847

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3826
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334317e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5566e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8372
    reference variance = 0.215177
====================================================
  Execution time = 2.0776e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3553e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6504e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335606900177
                                         uncertainty =       0.003005137744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335606900177
                                         uncertainty =       0.003005137744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409592750
  error estimate for blocks of size 2^( 2) =       0.000422808541
  error estimate for blocks of size 2^( 3) =       0.000435959209
  error estimate for blocks of size 2^( 4) =       0.000448930321
  error estimate for blocks of size 2^( 5) =       0.000460563010
  error estimate for blocks of size 2^( 6) =       0.000471010074
  error estimate for blocks of size 2^( 7) =       0.000477821632

      target function =                  N/A
              le_mean =     -16.905777419658
             les_mean =     286.140842437073
             stat err =       0.000464581259
             autocorr =       1.286526841737
              std dev =       0.579251622198
             le_variance =       0.335532441819


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690577741966e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905777419658       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905777419659       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905777419660       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905777419661       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905777419477       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905777419898       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905777420057       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905777419053       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 3.092290e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905777419658       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905777419658       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905777419659       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905777419100       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905777419618       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905777417776       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905777419606       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905777419451       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 7.730709e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905777419658       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905777419658       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905777419658       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905777419754       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905777415631       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905777413771       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905777422957       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905777418237       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 1.932679e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.096139 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6433e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334317e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9012
    reference variance = 0.524733
====================================================
  Execution time = 2.1742e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4296e-01
  Total weights = 2.0000e+06
  Execution time = 1.8455e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342957333817
                                         uncertainty =       0.004405349992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342957333817
                                         uncertainty =       0.004405349992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414103181
  error estimate for blocks of size 2^( 2) =       0.000426722426
  error estimate for blocks of size 2^( 3) =       0.000439165653
  error estimate for blocks of size 2^( 4) =       0.000450736608
  error estimate for blocks of size 2^( 5) =       0.000461241114
  error estimate for blocks of size 2^( 6) =       0.000467869507
  error estimate for blocks of size 2^( 7) =       0.000471404721

      target function =                  N/A
              le_mean =     -16.905869566603
             les_mean =     286.151388520994
             stat err =       0.000462812988
             autocorr =       1.249090605584
              std dev =       0.585630335172
             le_variance =       0.342962889474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342957333789
                                         uncertainty =       0.004405349992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342957333789
                                         uncertainty =       0.004405349992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414103181
  error estimate for blocks of size 2^( 2) =       0.000426722426
  error estimate for blocks of size 2^( 3) =       0.000439165653
  error estimate for blocks of size 2^( 4) =       0.000450736608
  error estimate for blocks of size 2^( 5) =       0.000461241114
  error estimate for blocks of size 2^( 6) =       0.000467869507
  error estimate for blocks of size 2^( 7) =       0.000471404721

      target function =                  N/A
              le_mean =     -16.905869566603
             les_mean =     286.151388520953
             stat err =       0.000462812988
             autocorr =       1.249090605600
              std dev =       0.585630335148
             le_variance =       0.342962889446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342957333803
                                         uncertainty =       0.004405349992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342957333803
                                         uncertainty =       0.004405349992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414103181
  error estimate for blocks of size 2^( 2) =       0.000426722426
  error estimate for blocks of size 2^( 3) =       0.000439165653
  error estimate for blocks of size 2^( 4) =       0.000450736608
  error estimate for blocks of size 2^( 5) =       0.000461241114
  error estimate for blocks of size 2^( 6) =       0.000467869507
  error estimate for blocks of size 2^( 7) =       0.000471404721

      target function =                  N/A
              le_mean =     -16.905869566603
             les_mean =     286.151388520973
             stat err =       0.000462812988
             autocorr =       1.249090605591
              std dev =       0.585630335160
             le_variance =       0.342962889460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342957333815
                                         uncertainty =       0.004405349992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342957333815
                                         uncertainty =       0.004405349992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414103181
  error estimate for blocks of size 2^( 2) =       0.000426722426
  error estimate for blocks of size 2^( 3) =       0.000439165653
  error estimate for blocks of size 2^( 4) =       0.000450736608
  error estimate for blocks of size 2^( 5) =       0.000461241114
  error estimate for blocks of size 2^( 6) =       0.000467869507
  error estimate for blocks of size 2^( 7) =       0.000471404721

      target function =                  N/A
              le_mean =     -16.905869566603
             les_mean =     286.151388520991
             stat err =       0.000462812988
             autocorr =       1.249090605587
              std dev =       0.585630335171
             le_variance =       0.342962889472


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905869566603        initial  <--
     9.3132e+05     9.3132e+06             3.0923e-10       -16.905869566603
     3.7253e+06     3.7253e+07             7.7307e-11       -16.905869566603
     1.4901e+07     1.4901e+08             1.9327e-11       -16.905869566603

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0687
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334317e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7710e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.0126
    reference variance = 0.373194
====================================================
  Execution time = 2.0694e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3514e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5555e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335129423642
                                         uncertainty =       0.003258601209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335129423642
                                         uncertainty =       0.003258601209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409351273
  error estimate for blocks of size 2^( 2) =       0.000422212317
  error estimate for blocks of size 2^( 3) =       0.000435248271
  error estimate for blocks of size 2^( 4) =       0.000447515869
  error estimate for blocks of size 2^( 5) =       0.000457629671
  error estimate for blocks of size 2^( 6) =       0.000466458450
  error estimate for blocks of size 2^( 7) =       0.000470695449

      target function =                  N/A
              le_mean =     -16.906349074686
             les_mean =     286.159775797679
             stat err =       0.000460574860
             autocorr =       1.265925550992
              std dev =       0.578910122652
             le_variance =       0.335136930109


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690634907469e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906349074686       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906349074686       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906349074686       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906349076919       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906349074153       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906349070200       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906349070615       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906349075441       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 2.490209e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906349074686       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906349074686       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906349074686       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906349074686       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906349074686       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906349068774       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906349074687       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906349074685       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 6.225508e-12

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906349074686       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906349074686       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906349074686       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906349105017       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906349097238       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906348990316       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906349053973       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906349092744       residual = 5.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+08 is 1.556582e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.098757 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6256e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334317e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8283
    reference variance = 0.360458
====================================================
  Execution time = 2.8079e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.9606e-01
  Total weights = 2.0000e+06
  Execution time = 1.8393e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396089722335
                                         uncertainty =       0.060015115259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396089722335
                                         uncertainty =       0.060015115259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000445003298
  error estimate for blocks of size 2^( 2) =       0.000456955832
  error estimate for blocks of size 2^( 3) =       0.000468976538
  error estimate for blocks of size 2^( 4) =       0.000480518728
  error estimate for blocks of size 2^( 5) =       0.000490017637
  error estimate for blocks of size 2^( 6) =       0.000497357088
  error estimate for blocks of size 2^( 7) =       0.000502414619

      target function =                  N/A
              le_mean =     -16.906192765000
             les_mean =     286.215409479618
             stat err =       0.000492577018
             autocorr =       1.225241874536
              std dev =       0.629329699211
             le_variance =       0.396055870309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396089722330
                                         uncertainty =       0.060015115260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396089722330
                                         uncertainty =       0.060015115260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000445003298
  error estimate for blocks of size 2^( 2) =       0.000456955832
  error estimate for blocks of size 2^( 3) =       0.000468976538
  error estimate for blocks of size 2^( 4) =       0.000480518728
  error estimate for blocks of size 2^( 5) =       0.000490017637
  error estimate for blocks of size 2^( 6) =       0.000497357088
  error estimate for blocks of size 2^( 7) =       0.000502414619

      target function =                  N/A
              le_mean =     -16.906192765000
             les_mean =     286.215409479613
             stat err =       0.000492577018
             autocorr =       1.225241874541
              std dev =       0.629329699207
             le_variance =       0.396055870303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396089722332
                                         uncertainty =       0.060015115259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396089722332
                                         uncertainty =       0.060015115259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000445003298
  error estimate for blocks of size 2^( 2) =       0.000456955832
  error estimate for blocks of size 2^( 3) =       0.000468976538
  error estimate for blocks of size 2^( 4) =       0.000480518728
  error estimate for blocks of size 2^( 5) =       0.000490017637
  error estimate for blocks of size 2^( 6) =       0.000497357088
  error estimate for blocks of size 2^( 7) =       0.000502414619

      target function =                  N/A
              le_mean =     -16.906192765000
             les_mean =     286.215409479616
             stat err =       0.000492577018
             autocorr =       1.225241874545
              std dev =       0.629329699209
             le_variance =       0.396055870306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396089722335
                                         uncertainty =       0.060015115259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396089722335
                                         uncertainty =       0.060015115259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000445003298
  error estimate for blocks of size 2^( 2) =       0.000456955832
  error estimate for blocks of size 2^( 3) =       0.000468976538
  error estimate for blocks of size 2^( 4) =       0.000480518728
  error estimate for blocks of size 2^( 5) =       0.000490017637
  error estimate for blocks of size 2^( 6) =       0.000497357088
  error estimate for blocks of size 2^( 7) =       0.000502414619

      target function =                  N/A
              le_mean =     -16.906192765000
             les_mean =     286.215409479618
             stat err =       0.000492577018
             autocorr =       1.225241874541
              std dev =       0.629329699211
             le_variance =       0.396055870308


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906192765000        initial
     9.3132e+06     9.3132e+07             2.4902e-11       -16.906192765000  <--
     3.7253e+07     3.7253e+08             6.2255e-12       -16.906192765000
     1.4901e+08     1.4901e+09             1.5566e-12       -16.906192765000

*****************************************************************************
Applying the update for shift_i =   9.3132e+06     and shift_s =   9.3132e+07
*****************************************************************************

  Execution time = 3.7357e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334317e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4119e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.932
    reference variance = 1.03172
====================================================
  Execution time = 2.1291e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3802e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5867e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337817447310
                                         uncertainty =       0.003418735246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337817447310
                                         uncertainty =       0.003418735246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411110453
  error estimate for blocks of size 2^( 2) =       0.000423962850
  error estimate for blocks of size 2^( 3) =       0.000436573400
  error estimate for blocks of size 2^( 4) =       0.000448291483
  error estimate for blocks of size 2^( 5) =       0.000458210880
  error estimate for blocks of size 2^( 6) =       0.000463963877
  error estimate for blocks of size 2^( 7) =       0.000469159697

      target function =                  N/A
              le_mean =     -16.906229509518
             les_mean =     286.158619668382
             stat err =       0.000459906484
             autocorr =       1.251474563219
              std dev =       0.581397978051
             le_variance =       0.338023608881


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690622950952e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906229509518       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906229509519       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906229509519       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906229509519       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906229510168       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906229513176       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906229511117       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906229509758       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 1.047592e-10

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906229509518       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906229509518       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906229509519       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906229510546       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906229509519       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906229508680       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906229509627       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906229526625       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 2.618922e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906229509518       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906229509518       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906229509518       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906229509518       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906229496300       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906229505087       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906229528395       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906229473542       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 6.547410e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.101400 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6885e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334317e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9066
    reference variance = 0.229734
====================================================
  Execution time = 2.1176e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4430e-01
  Total weights = 2.0000e+06
  Execution time = 2.3524e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344361032499
                                         uncertainty =       0.006937715926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344361032499
                                         uncertainty =       0.006937715926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414910473
  error estimate for blocks of size 2^( 2) =       0.000427378919
  error estimate for blocks of size 2^( 3) =       0.000439816021
  error estimate for blocks of size 2^( 4) =       0.000452727509
  error estimate for blocks of size 2^( 5) =       0.000463761021
  error estimate for blocks of size 2^( 6) =       0.000472055829
  error estimate for blocks of size 2^( 7) =       0.000477302549

      target function =                  N/A
              le_mean =     -16.906054765397
             les_mean =     286.158988958953
             stat err =       0.000466461727
             autocorr =       1.263930630080
              std dev =       0.586772017484
             le_variance =       0.344301400503

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344361032447
                                         uncertainty =       0.006937715924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344361032447
                                         uncertainty =       0.006937715924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414910473
  error estimate for blocks of size 2^( 2) =       0.000427378919
  error estimate for blocks of size 2^( 3) =       0.000439816021
  error estimate for blocks of size 2^( 4) =       0.000452727509
  error estimate for blocks of size 2^( 5) =       0.000463761021
  error estimate for blocks of size 2^( 6) =       0.000472055829
  error estimate for blocks of size 2^( 7) =       0.000477302549

      target function =                  N/A
              le_mean =     -16.906054765397
             les_mean =     286.158988958895
             stat err =       0.000466461727
             autocorr =       1.263930630104
              std dev =       0.586772017440
             le_variance =       0.344301400451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344361032473
                                         uncertainty =       0.006937715925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344361032473
                                         uncertainty =       0.006937715925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414910473
  error estimate for blocks of size 2^( 2) =       0.000427378919
  error estimate for blocks of size 2^( 3) =       0.000439816021
  error estimate for blocks of size 2^( 4) =       0.000452727509
  error estimate for blocks of size 2^( 5) =       0.000463761021
  error estimate for blocks of size 2^( 6) =       0.000472055829
  error estimate for blocks of size 2^( 7) =       0.000477302549

      target function =                  N/A
              le_mean =     -16.906054765397
             les_mean =     286.158988958924
             stat err =       0.000466461727
             autocorr =       1.263930630091
              std dev =       0.586772017462
             le_variance =       0.344301400477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344361032495
                                         uncertainty =       0.006937715926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344361032495
                                         uncertainty =       0.006937715926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414910473
  error estimate for blocks of size 2^( 2) =       0.000427378919
  error estimate for blocks of size 2^( 3) =       0.000439816021
  error estimate for blocks of size 2^( 4) =       0.000452727509
  error estimate for blocks of size 2^( 5) =       0.000463761021
  error estimate for blocks of size 2^( 6) =       0.000472055829
  error estimate for blocks of size 2^( 7) =       0.000477302549

      target function =                  N/A
              le_mean =     -16.906054765397
             les_mean =     286.158988958950
             stat err =       0.000466461727
             autocorr =       1.263930630080
              std dev =       0.586772017482
             le_variance =       0.344301400499


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906054765397        initial  <--
     2.3283e+06     2.3283e+07             1.0476e-10       -16.906054765397
     9.3132e+06     9.3132e+07             2.6189e-11       -16.906054765397
     3.7253e+07     3.7253e+08             6.5474e-12       -16.906054765397

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0528
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334317e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8056e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8423
    reference variance = 0.204664
====================================================
  Execution time = 2.0515e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6582e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6028e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365852558778
                                         uncertainty =       0.014160226972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365852558778
                                         uncertainty =       0.014160226972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427682037
  error estimate for blocks of size 2^( 2) =       0.000439861311
  error estimate for blocks of size 2^( 3) =       0.000452286005
  error estimate for blocks of size 2^( 4) =       0.000464974378
  error estimate for blocks of size 2^( 5) =       0.000476343968
  error estimate for blocks of size 2^( 6) =       0.000485954342
  error estimate for blocks of size 2^( 7) =       0.000491474455

      target function =                  N/A
              le_mean =     -16.906132278853
             les_mean =     286.183132296433
             stat err =       0.000479686786
             autocorr =       1.257979286561
              std dev =       0.604833736887
             le_variance =       0.365823849277


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690613227885e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906132278853       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906132278853       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906132278853       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906132278853       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906132292000       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906132282964       residual = 9.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906132263969       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906132296145       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 1.026921e-11

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906132278853       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906132278853       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906132278853       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906132244450       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906132245570       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906132265247       residual = 9.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906132308070       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906132225525       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 2.567231e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906132278853       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906132278853       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906132278853       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906132278853       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906132425200       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906132237763       residual = 9.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906132654455       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906132218870       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+08 is 6.420314e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.103973 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6124e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334317e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9587
    reference variance = 0.386194
====================================================
  Execution time = 2.0389e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3424e-01
  Total weights = 2.0000e+06
  Execution time = 1.8459e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334207967609
                                         uncertainty =       0.003051067528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334207967609
                                         uncertainty =       0.003051067528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408803809
  error estimate for blocks of size 2^( 2) =       0.000421045822
  error estimate for blocks of size 2^( 3) =       0.000433762085
  error estimate for blocks of size 2^( 4) =       0.000446044489
  error estimate for blocks of size 2^( 5) =       0.000457010530
  error estimate for blocks of size 2^( 6) =       0.000464837017
  error estimate for blocks of size 2^( 7) =       0.000469026742

      target function =                  N/A
              le_mean =     -16.905353694265
             les_mean =     286.125224469011
             stat err =       0.000459229694
             autocorr =       1.261914870897
              std dev =       0.578135890539
             le_variance =       0.334241107929

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334207967614
                                         uncertainty =       0.003051067528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334207967614
                                         uncertainty =       0.003051067528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408803809
  error estimate for blocks of size 2^( 2) =       0.000421045822
  error estimate for blocks of size 2^( 3) =       0.000433762085
  error estimate for blocks of size 2^( 4) =       0.000446044489
  error estimate for blocks of size 2^( 5) =       0.000457010530
  error estimate for blocks of size 2^( 6) =       0.000464837017
  error estimate for blocks of size 2^( 7) =       0.000469026742

      target function =                  N/A
              le_mean =     -16.905353694265
             les_mean =     286.125224469014
             stat err =       0.000459229694
             autocorr =       1.261914870896
              std dev =       0.578135890542
             le_variance =       0.334241107933

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334207967612
                                         uncertainty =       0.003051067528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334207967612
                                         uncertainty =       0.003051067528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408803809
  error estimate for blocks of size 2^( 2) =       0.000421045822
  error estimate for blocks of size 2^( 3) =       0.000433762085
  error estimate for blocks of size 2^( 4) =       0.000446044489
  error estimate for blocks of size 2^( 5) =       0.000457010530
  error estimate for blocks of size 2^( 6) =       0.000464837017
  error estimate for blocks of size 2^( 7) =       0.000469026742

      target function =                  N/A
              le_mean =     -16.905353694265
             les_mean =     286.125224469012
             stat err =       0.000459229694
             autocorr =       1.261914870884
              std dev =       0.578135890540
             le_variance =       0.334241107931

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334207967610
                                         uncertainty =       0.003051067528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334207967610
                                         uncertainty =       0.003051067528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408803809
  error estimate for blocks of size 2^( 2) =       0.000421045822
  error estimate for blocks of size 2^( 3) =       0.000433762085
  error estimate for blocks of size 2^( 4) =       0.000446044489
  error estimate for blocks of size 2^( 5) =       0.000457010530
  error estimate for blocks of size 2^( 6) =       0.000464837017
  error estimate for blocks of size 2^( 7) =       0.000469026742

      target function =                  N/A
              le_mean =     -16.905353694265
             les_mean =     286.125224469011
             stat err =       0.000459229694
             autocorr =       1.261914870904
              std dev =       0.578135890539
             le_variance =       0.334241107929


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905353694265        initial  <--
     2.3283e+07     2.3283e+08             1.0269e-11       -16.905353694265
     9.3132e+07     9.3132e+08             2.5672e-12       -16.905353694265
     3.7253e+08     3.7253e+09             6.4203e-13       -16.905353694265

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7203
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334317e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6592e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9077
    reference variance = 0.391357
====================================================
  Execution time = 2.2247e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4075e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4974e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340844791144
                                         uncertainty =       0.005697488408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340844791144
                                         uncertainty =       0.005697488408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412767239
  error estimate for blocks of size 2^( 2) =       0.000425382969
  error estimate for blocks of size 2^( 3) =       0.000438132696
  error estimate for blocks of size 2^( 4) =       0.000450201009
  error estimate for blocks of size 2^( 5) =       0.000460561094
  error estimate for blocks of size 2^( 6) =       0.000467452641
  error estimate for blocks of size 2^( 7) =       0.000472768254

      target function =                  N/A
              le_mean =     -16.906572649342
             les_mean =     286.172952164092
             stat err =       0.000462745750
             autocorr =       1.256823915451
              std dev =       0.583741027322
             le_variance =       0.340753586979


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690657264934e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906572649342       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906572649342       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906572649342       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906572627403       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906572653283       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906572733807       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906572555981       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906572547008       residual = 6.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 1.002623e-12

solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906572649342       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906572649342       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906572649342       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906572082017       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906572003079       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906572610719       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906572647798       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906573277773       residual = 6.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+08 is 2.505255e-13

solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906572649342       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906572649342       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906572649342       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906573685253       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906572630710       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906573539714       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906574530602       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906570999426       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+09 is 6.293539e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.106551 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7751e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334317e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9144
    reference variance = 0.178322
====================================================
  Execution time = 2.0813e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4917e-01
  Total weights = 2.0000e+06
  Execution time = 1.8627e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349076446760
                                         uncertainty =       0.006057951207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349076446760
                                         uncertainty =       0.006057951207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417832914
  error estimate for blocks of size 2^( 2) =       0.000430193098
  error estimate for blocks of size 2^( 3) =       0.000442805945
  error estimate for blocks of size 2^( 4) =       0.000455353637
  error estimate for blocks of size 2^( 5) =       0.000466250656
  error estimate for blocks of size 2^( 6) =       0.000473332773
  error estimate for blocks of size 2^( 7) =       0.000478527367

      target function =                  N/A
              le_mean =     -16.904928056091
             les_mean =     286.125761095831
             stat err =       0.000468366108
             autocorr =       1.256509066344
              std dev =       0.590904974437
             le_variance =       0.349168688815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349076446760
                                         uncertainty =       0.006057951207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349076446760
                                         uncertainty =       0.006057951207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417832914
  error estimate for blocks of size 2^( 2) =       0.000430193098
  error estimate for blocks of size 2^( 3) =       0.000442805945
  error estimate for blocks of size 2^( 4) =       0.000455353637
  error estimate for blocks of size 2^( 5) =       0.000466250656
  error estimate for blocks of size 2^( 6) =       0.000473332773
  error estimate for blocks of size 2^( 7) =       0.000478527367

      target function =                  N/A
              le_mean =     -16.904928056091
             les_mean =     286.125761095831
             stat err =       0.000468366108
             autocorr =       1.256509066348
              std dev =       0.590904974437
             le_variance =       0.349168688815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349076446760
                                         uncertainty =       0.006057951207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349076446760
                                         uncertainty =       0.006057951207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417832914
  error estimate for blocks of size 2^( 2) =       0.000430193098
  error estimate for blocks of size 2^( 3) =       0.000442805945
  error estimate for blocks of size 2^( 4) =       0.000455353637
  error estimate for blocks of size 2^( 5) =       0.000466250656
  error estimate for blocks of size 2^( 6) =       0.000473332773
  error estimate for blocks of size 2^( 7) =       0.000478527367

      target function =                  N/A
              le_mean =     -16.904928056091
             les_mean =     286.125761095831
             stat err =       0.000468366108
             autocorr =       1.256509066338
              std dev =       0.590904974437
             le_variance =       0.349168688815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349076446760
                                         uncertainty =       0.006057951207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349076446760
                                         uncertainty =       0.006057951207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417832914
  error estimate for blocks of size 2^( 2) =       0.000430193098
  error estimate for blocks of size 2^( 3) =       0.000442805945
  error estimate for blocks of size 2^( 4) =       0.000455353637
  error estimate for blocks of size 2^( 5) =       0.000466250656
  error estimate for blocks of size 2^( 6) =       0.000473332773
  error estimate for blocks of size 2^( 7) =       0.000478527367

      target function =                  N/A
              le_mean =     -16.904928056091
             les_mean =     286.125761095831
             stat err =       0.000468366108
             autocorr =       1.256509066339
              std dev =       0.590904974437
             le_variance =       0.349168688815


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904928056091        initial  <--
     2.3283e+08     2.3283e+09             1.0026e-12       -16.904928056091
     9.3132e+08     9.3132e+09             2.5053e-13       -16.904928056091
     3.7253e+09     3.7253e+10             6.2935e-14       -16.904928056091

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1456
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334317e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8136e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9547
    reference variance = 0.249982
====================================================
  Execution time = 2.1053e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3771e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5271e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337705152848
                                         uncertainty =       0.002919626988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337705152848
                                         uncertainty =       0.002919626988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410920016
  error estimate for blocks of size 2^( 2) =       0.000423974069
  error estimate for blocks of size 2^( 3) =       0.000437057970
  error estimate for blocks of size 2^( 4) =       0.000449158449
  error estimate for blocks of size 2^( 5) =       0.000459707888
  error estimate for blocks of size 2^( 6) =       0.000466541416
  error estimate for blocks of size 2^( 7) =       0.000470883561

      target function =                  N/A
              le_mean =     -16.906602711239
             les_mean =     286.170925586181
             stat err =       0.000461572829
             autocorr =       1.261728396335
              std dev =       0.581128659904
             le_variance =       0.337710519361


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690660271124e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906602711239       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906602711239       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906602711239       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906602655830       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906603095187       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906604956553       residual = 6.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906605269527       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906602304626       residual = 3.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+09 is 9.117239e-14

solving harmonic davidson linear method for identity shift 9.3132e+09, overlap shift 9.3132e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906602711239       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906602711239       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906602711239       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906602492627       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906597849295       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906582701797       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906601673557       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906606618471       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906602353243       residual = 2.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+09 is 2.261259e-14

solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906602711239       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906602711239       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906602711239       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906598237542       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906605508900       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906613623474       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906706889853       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906603445171       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906611073236       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906577472343       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905935065946       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906668880476       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906038863883       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906069811467       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905978161481       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905212520488       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906714494321       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905189455922       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905037693165       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.908224425683       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.907630102452       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.902963725093       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905001287133       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.907775641958       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.900034541876       residual = 5.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.907681379106       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.904473814565       residual = 6.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.902642526947       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.908757233519       residual = 6.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.905991902388       residual = 7.20e-05           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -16.898285955550       residual = 9.31e-03           smallest_sin_value = 9.94e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.74e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+10 is 6.164998e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.122669 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6600e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334317e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9303
    reference variance = 0.165544
====================================================
  Execution time = 2.0646e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4078e-01
  Total weights = 2.0000e+06
  Execution time = 1.8482e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340884471334
                                         uncertainty =       0.004470074124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340884471334
                                         uncertainty =       0.004470074124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412784304
  error estimate for blocks of size 2^( 2) =       0.000425658682
  error estimate for blocks of size 2^( 3) =       0.000439239970
  error estimate for blocks of size 2^( 4) =       0.000452592996
  error estimate for blocks of size 2^( 5) =       0.000463939813
  error estimate for blocks of size 2^( 6) =       0.000471675120
  error estimate for blocks of size 2^( 7) =       0.000478171048

      target function =                  N/A
              le_mean =     -16.906451426966
             les_mean =     286.168881445806
             stat err =       0.000466594744
             autocorr =       1.277713062025
              std dev =       0.583765161557
             le_variance =       0.340781763847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340884471334
                                         uncertainty =       0.004470074124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340884471334
                                         uncertainty =       0.004470074124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412784304
  error estimate for blocks of size 2^( 2) =       0.000425658682
  error estimate for blocks of size 2^( 3) =       0.000439239970
  error estimate for blocks of size 2^( 4) =       0.000452592996
  error estimate for blocks of size 2^( 5) =       0.000463939813
  error estimate for blocks of size 2^( 6) =       0.000471675120
  error estimate for blocks of size 2^( 7) =       0.000478171048

      target function =                  N/A
              le_mean =     -16.906451426966
             les_mean =     286.168881445806
             stat err =       0.000466594744
             autocorr =       1.277713062025
              std dev =       0.583765161557
             le_variance =       0.340781763847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340884471334
                                         uncertainty =       0.004470074124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340884471334
                                         uncertainty =       0.004470074124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412784304
  error estimate for blocks of size 2^( 2) =       0.000425658682
  error estimate for blocks of size 2^( 3) =       0.000439239970
  error estimate for blocks of size 2^( 4) =       0.000452592996
  error estimate for blocks of size 2^( 5) =       0.000463939813
  error estimate for blocks of size 2^( 6) =       0.000471675120
  error estimate for blocks of size 2^( 7) =       0.000478171048

      target function =                  N/A
              le_mean =     -16.906451426966
             les_mean =     286.168881445806
             stat err =       0.000466594744
             autocorr =       1.277713062025
              std dev =       0.583765161557
             le_variance =       0.340781763847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340884471334
                                         uncertainty =       0.004470074124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340884471334
                                         uncertainty =       0.004470074124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412784304
  error estimate for blocks of size 2^( 2) =       0.000425658682
  error estimate for blocks of size 2^( 3) =       0.000439239970
  error estimate for blocks of size 2^( 4) =       0.000452592996
  error estimate for blocks of size 2^( 5) =       0.000463939813
  error estimate for blocks of size 2^( 6) =       0.000471675120
  error estimate for blocks of size 2^( 7) =       0.000478171048

      target function =                  N/A
              le_mean =     -16.906451426966
             les_mean =     286.168881445806
             stat err =       0.000466594744
             autocorr =       1.277713062025
              std dev =       0.583765161557
             le_variance =       0.340781763847


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906451426966        initial  <--
     2.3283e+09     2.3283e+10             9.1172e-14       -16.906451426966
     9.3132e+09     9.3132e+10             2.2613e-14       -16.906451426966
     3.7253e+10     3.7253e+11             6.1650e-15       -16.906451426966

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9945
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334317e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7043e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8873
    reference variance = 0.239003
====================================================
  Execution time = 2.0695e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3574e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5371e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335824234610
                                         uncertainty =       0.004004446051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335824234610
                                         uncertainty =       0.004004446051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409718968
  error estimate for blocks of size 2^( 2) =       0.000422746606
  error estimate for blocks of size 2^( 3) =       0.000435854517
  error estimate for blocks of size 2^( 4) =       0.000448825074
  error estimate for blocks of size 2^( 5) =       0.000460089422
  error estimate for blocks of size 2^( 6) =       0.000469099362
  error estimate for blocks of size 2^( 7) =       0.000478025885

      target function =                  N/A
              le_mean =     -16.905690153004
             les_mean =     286.138098646867
             stat err =       0.000464009936
             autocorr =       1.282573965602
              std dev =       0.579430121211
             le_variance =       0.335739265367


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690569015300e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905690153004       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905690153004       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905690153004       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905696880243       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905690153004       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905690153004       residual = 9.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905690506076       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905693588694       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+10 is 9.348052e-15

solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905690153004       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905690153004       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905690153004       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905688957921       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905690153004       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905679984751       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905638772932       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905919087110       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905384400595       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907042830515       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906384590881       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905393130738       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906942239550       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904467621494       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.908840892699       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.907842365177       residual = 6.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906043366895       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906624543288       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.904043339636       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.911098288216       residual = 3.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.917422956513       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.920064197102       residual = 2.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.909227608823       residual = 3.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.894615831671       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.914842112494       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.904764240608       residual = 9.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.895280797118       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.901343602491       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.932440397602       residual = 9.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.906746291678       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.907628737332       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.912497858080       residual = 5.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.909403997914       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.902349769546       residual = 2.68e-03           smallest_sin_value = 9.98e-01
davidson iteration   34:   krylov dim =  35   energy =     -16.916234062091       residual = 1.65e-02           smallest_sin_value = 9.93e-01
davidson iteration   35 stopping due to small subspace S singular value of 9.17e-01
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+10 is 1.987709e-15

solving harmonic davidson linear method for identity shift 3.7253e+11, overlap shift 3.7253e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905690153004       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905690153004       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905690153004       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905698350801       residual = 9.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905659944481       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905690153004       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905686190992       residual = 8.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905629915770       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905501014523       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906393326691       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.902414856679       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.916450839059       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.915742560760       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.903686965211       residual = 4.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.900855367370       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.908014469327       residual = 7.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.902827826513       residual = 8.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910075035002       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.855887811586       residual = 3.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.966106617371       residual = 4.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.896831515945       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.945327402159       residual = 2.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.902511188911       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.974868122829       residual = 6.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.927989840468       residual = 6.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.911993736812       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.920021638693       residual = 2.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.914204045710       residual = 9.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.884196359607       residual = 5.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.877026059357       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.864093792665       residual = 2.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.961942792183       residual = 4.35e-01           smallest_sin_value = 9.99e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.923233590564       residual = 3.20e-02           smallest_sin_value = 9.97e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.74e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+11 is 5.299164e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.157946 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6271e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334317e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9673
    reference variance = 0.665284
====================================================
  Execution time = 2.0610e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3739e-01
  Total weights = 2.0000e+06
  Execution time = 1.8529e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337362743765
                                         uncertainty =       0.005291918667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337362743765
                                         uncertainty =       0.005291918667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410723439
  error estimate for blocks of size 2^( 2) =       0.000424149893
  error estimate for blocks of size 2^( 3) =       0.000437781520
  error estimate for blocks of size 2^( 4) =       0.000450041408
  error estimate for blocks of size 2^( 5) =       0.000461048570
  error estimate for blocks of size 2^( 6) =       0.000468962065
  error estimate for blocks of size 2^( 7) =       0.000477102786

      target function =                  N/A
              le_mean =     -16.905308865147
             les_mean =     286.126855144641
             stat err =       0.000464288708
             autocorr =       1.277842315401
              std dev =       0.580850658367
             le_variance =       0.337387487326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337362743765
                                         uncertainty =       0.005291918667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337362743765
                                         uncertainty =       0.005291918667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410723439
  error estimate for blocks of size 2^( 2) =       0.000424149893
  error estimate for blocks of size 2^( 3) =       0.000437781520
  error estimate for blocks of size 2^( 4) =       0.000450041408
  error estimate for blocks of size 2^( 5) =       0.000461048570
  error estimate for blocks of size 2^( 6) =       0.000468962065
  error estimate for blocks of size 2^( 7) =       0.000477102786

      target function =                  N/A
              le_mean =     -16.905308865147
             les_mean =     286.126855144641
             stat err =       0.000464288708
             autocorr =       1.277842315401
              std dev =       0.580850658367
             le_variance =       0.337387487326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337362743765
                                         uncertainty =       0.005291918667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337362743765
                                         uncertainty =       0.005291918667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410723439
  error estimate for blocks of size 2^( 2) =       0.000424149893
  error estimate for blocks of size 2^( 3) =       0.000437781520
  error estimate for blocks of size 2^( 4) =       0.000450041408
  error estimate for blocks of size 2^( 5) =       0.000461048570
  error estimate for blocks of size 2^( 6) =       0.000468962065
  error estimate for blocks of size 2^( 7) =       0.000477102786

      target function =                  N/A
              le_mean =     -16.905308865147
             les_mean =     286.126855144641
             stat err =       0.000464288708
             autocorr =       1.277842315402
              std dev =       0.580850658367
             le_variance =       0.337387487326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337362743765
                                         uncertainty =       0.005291918667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337362743765
                                         uncertainty =       0.005291918667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410723439
  error estimate for blocks of size 2^( 2) =       0.000424149893
  error estimate for blocks of size 2^( 3) =       0.000437781520
  error estimate for blocks of size 2^( 4) =       0.000450041408
  error estimate for blocks of size 2^( 5) =       0.000461048570
  error estimate for blocks of size 2^( 6) =       0.000468962065
  error estimate for blocks of size 2^( 7) =       0.000477102786

      target function =                  N/A
              le_mean =     -16.905308865147
             les_mean =     286.126855144641
             stat err =       0.000464288708
             autocorr =       1.277842315401
              std dev =       0.580850658367
             le_variance =       0.337387487326


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905308865147        initial
     2.3283e+10     2.3283e+11             9.3481e-15       -16.905308865147
     9.3132e+10     9.3132e+11             1.9877e-15       -16.905308865147  <--
     3.7253e+11     3.7253e+12             5.2992e-16       -16.905308865147

*****************************************************************************
Applying the update for shift_i =   9.3132e+10     and shift_s =   9.3132e+11
*****************************************************************************

  Execution time = 2.9912e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334317e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6498e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9082
    reference variance = 0.203257
====================================================
  Execution time = 2.1201e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4727e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5375e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347329434911
                                         uncertainty =       0.010369679315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347329434911
                                         uncertainty =       0.010369679315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416695856
  error estimate for blocks of size 2^( 2) =       0.000429675856
  error estimate for blocks of size 2^( 3) =       0.000443104576
  error estimate for blocks of size 2^( 4) =       0.000456311864
  error estimate for blocks of size 2^( 5) =       0.000467543826
  error estimate for blocks of size 2^( 6) =       0.000476131580
  error estimate for blocks of size 2^( 7) =       0.000483195064

      target function =                  N/A
              le_mean =     -16.906217797988
             les_mean =     286.167470932509
             stat err =       0.000470795583
             autocorr =       1.276516393668
              std dev =       0.589296931202
             le_variance =       0.347270873124


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690621779799e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906217797988       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906217797988       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906217797988       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906217797988       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906222193418       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906220469997       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906211458053       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906220246394       residual = 6.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+10 is 1.015532e-14

solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906217797988       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906217797988       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906217797988       residual = 9.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906217797988       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906216634127       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906210179026       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906216786678       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906012552679       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906398686570       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906228256979       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905931302528       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906378785492       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906389695951       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.908447189744       residual = 5.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.907114877134       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.908771361950       residual = 7.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.901718831881       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.904321252847       residual = 4.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.904029909995       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.904009523524       residual = 6.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906102965425       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.903654499276       residual = 9.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.909075625449       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.901914934948       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.910191383444       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.903667858464       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.918409927380       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.904372066594       residual = 5.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.901876219468       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.903768088387       residual = 7.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.924852025222       residual = 4.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.899794752038       residual = 5.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.894761601270       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.904770130990       residual = 9.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.903230897496       residual = 1.81e-03           smallest_sin_value = 9.94e-01
davidson iteration   35 stopping due to small subspace S singular value of 9.03e-01
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+10 is 2.455834e-15

solving harmonic davidson linear method for identity shift 3.7253e+11, overlap shift 3.7253e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906217797988       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906217797988       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906217797988       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906217797988       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906225168499       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906325789938       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906327909989       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905583309239       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905878592516       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904937600124       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908800747435       residual = 9.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.901104645958       residual = 3.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.908289996420       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.902147597571       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.894515929964       residual = 1.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.899824287795       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.918514225122       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.894769405335       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.853741150084       residual = 3.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.891743658910       residual = 2.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.925627459221       residual = 4.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.873384704331       residual = 1.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.892669307938       residual = 2.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.920591584989       residual = 2.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.895858436331       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.912092419683       residual = 5.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.922568342838       residual = 3.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.879036290774       residual = 9.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.874035547277       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.867629066937       residual = 1.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.911835505879       residual = 4.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.956786819437       residual = 3.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.893779687104       residual = 1.91e-02           smallest_sin_value = 9.99e-01
davidson iteration   33:   krylov dim =  34   energy =     -16.865853440310       residual = 2.09e-01           smallest_sin_value = 9.96e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.49e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+11 is 3.866100e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194118 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6779e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334317e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9253
    reference variance = 0.230324
====================================================
  Execution time = 1.9909e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3763e-01
  Total weights = 2.0000e+06
  Execution time = 1.8454e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337694732861
                                         uncertainty =       0.002826888266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337694732861
                                         uncertainty =       0.002826888266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410868333
  error estimate for blocks of size 2^( 2) =       0.000423190514
  error estimate for blocks of size 2^( 3) =       0.000436380758
  error estimate for blocks of size 2^( 4) =       0.000448338555
  error estimate for blocks of size 2^( 5) =       0.000458853780
  error estimate for blocks of size 2^( 6) =       0.000465872939
  error estimate for blocks of size 2^( 7) =       0.000467292929

      target function =                  N/A
              le_mean =     -16.906108239576
             les_mean =     286.154121213338
             stat err =       0.000460089551
             autocorr =       1.253947634534
              std dev =       0.581055568688
             le_variance =       0.337625573903

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337694732861
                                         uncertainty =       0.002826888266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337694732861
                                         uncertainty =       0.002826888266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410868333
  error estimate for blocks of size 2^( 2) =       0.000423190514
  error estimate for blocks of size 2^( 3) =       0.000436380758
  error estimate for blocks of size 2^( 4) =       0.000448338555
  error estimate for blocks of size 2^( 5) =       0.000458853780
  error estimate for blocks of size 2^( 6) =       0.000465872939
  error estimate for blocks of size 2^( 7) =       0.000467292929

      target function =                  N/A
              le_mean =     -16.906108239576
             les_mean =     286.154121213338
             stat err =       0.000460089551
             autocorr =       1.253947634534
              std dev =       0.581055568688
             le_variance =       0.337625573903

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337694732861
                                         uncertainty =       0.002826888266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337694732861
                                         uncertainty =       0.002826888266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410868333
  error estimate for blocks of size 2^( 2) =       0.000423190514
  error estimate for blocks of size 2^( 3) =       0.000436380758
  error estimate for blocks of size 2^( 4) =       0.000448338555
  error estimate for blocks of size 2^( 5) =       0.000458853780
  error estimate for blocks of size 2^( 6) =       0.000465872939
  error estimate for blocks of size 2^( 7) =       0.000467292929

      target function =                  N/A
              le_mean =     -16.906108239576
             les_mean =     286.154121213338
             stat err =       0.000460089551
             autocorr =       1.253947634534
              std dev =       0.581055568688
             le_variance =       0.337625573903

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337694732861
                                         uncertainty =       0.002826888266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337694732861
                                         uncertainty =       0.002826888266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410868333
  error estimate for blocks of size 2^( 2) =       0.000423190514
  error estimate for blocks of size 2^( 3) =       0.000436380758
  error estimate for blocks of size 2^( 4) =       0.000448338555
  error estimate for blocks of size 2^( 5) =       0.000458853780
  error estimate for blocks of size 2^( 6) =       0.000465872939
  error estimate for blocks of size 2^( 7) =       0.000467292929

      target function =                  N/A
              le_mean =     -16.906108239576
             les_mean =     286.154121213338
             stat err =       0.000460089551
             autocorr =       1.253947634534
              std dev =       0.581055568688
             le_variance =       0.337625573903


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906108239576        initial  <--
     2.3283e+10     2.3283e+11             1.0155e-14       -16.906108239576
     9.3132e+10     9.3132e+11             2.4558e-15       -16.906108239576
     3.7253e+11     3.7253e+12             3.8661e-16       -16.906108239576

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2194
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334317e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6091e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8527
    reference variance = 0.14821
====================================================
  Execution time = 2.3058e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4535e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5293e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345325746075
                                         uncertainty =       0.005406132009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345325746075
                                         uncertainty =       0.005406132009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415544465
  error estimate for blocks of size 2^( 2) =       0.000428496707
  error estimate for blocks of size 2^( 3) =       0.000441128180
  error estimate for blocks of size 2^( 4) =       0.000452990153
  error estimate for blocks of size 2^( 5) =       0.000463871624
  error estimate for blocks of size 2^( 6) =       0.000471911887
  error estimate for blocks of size 2^( 7) =       0.000477415099

      target function =                  N/A
              le_mean =     -16.905487690915
             les_mean =     286.140868300032
             stat err =       0.000466547191
             autocorr =       1.260538611473
              std dev =       0.587668618369
             le_variance =       0.345354405016


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690548769092e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+11, overlap shift 2.3283e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905487690915       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905487690915       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905487690915       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905487690915       residual = 9.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905349933875       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905606565280       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904423983620       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905507147773       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908563150000       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904784946386       residual = 5.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904414361094       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.900919452610       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905755823887       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910847455228       residual = 3.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.913982271886       residual = 8.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905097696780       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910345573906       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.891278038985       residual = 2.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.909600123500       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.907337035301       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905805000420       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.892569842625       residual = 2.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.919503296053       residual = 3.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.913267410894       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.905061942152       residual = 4.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.890500321431       residual = 3.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.918095929935       residual = 2.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.917355201757       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.928713688129       residual = 8.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.888520531129       residual = 3.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.900239972445       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.913115400761       residual = 7.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.921542396831       residual = 3.53e-02           smallest_sin_value = 9.99e-01
davidson iteration   33:   krylov dim =  34   energy =     -16.876148385673       residual = 1.07e-01           smallest_sin_value = 9.92e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+11 is 6.367568e-16

solving harmonic davidson linear method for identity shift 9.3132e+11, overlap shift 9.3132e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905487690915       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905487690915       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905487690915       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905487690915       residual = 7.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905465345602       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905314158579       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904565206786       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905875092986       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904415134207       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.898425199546       residual = 7.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.901002940261       residual = 2.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906444550139       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.920460714895       residual = 3.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.923987748058       residual = 5.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.884545905571       residual = 5.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.914394773773       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.862845471622       residual = 2.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.909788439270       residual = 7.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.874351390487       residual = 1.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.862013722106       residual = 2.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.894531937170       residual = 3.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.838343970436       residual = 5.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.916806025378       residual = 2.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.887075043073       residual = 7.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.934349815814       residual = 9.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.020031817043       residual = 1.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.846389968716       residual = 4.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.038636338144       residual = 2.33e+00           smallest_sin_value = 9.99e-01
davidson iteration   28:   krylov dim =  29   energy =     -16.985004654611       residual = 8.68e-01           smallest_sin_value = 9.97e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+11 is 8.674642e-17

solving harmonic davidson linear method for identity shift 3.7253e+12, overlap shift 3.7253e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905487690915       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905487690915       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905487690915       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905487690915       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906171587588       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904535485340       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.893869299195       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.901857532830       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.892224263846       residual = 2.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.842035813545       residual = 5.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.993913982502       residual = 1.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.808560846878       residual = 1.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.929062773864       residual = 8.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.045903485040       residual = 2.65e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.878210923119       residual = 1.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.892216143729       residual = 5.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.008244583179       residual = 1.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.722758630095       residual = 4.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.156087248984       residual = 8.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.968783828959       residual = 5.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.273762877531       residual = 1.89e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.873306770058       residual = 1.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.946512147981       residual = 3.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.972412188505       residual = 1.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.192113048317       residual = 1.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.484469662192       residual = 4.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.827637639894       residual = 1.21e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.563318100875       residual = 1.66e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.163627006685       residual = 8.92e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.849246677858       residual = 8.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.051547132092       residual = 3.80e+00           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.906457687417       residual = 3.45e-01           smallest_sin_value = 9.98e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.700417344556       residual = 5.19e+00           smallest_sin_value = 9.90e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.12e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+12 is 1.680322e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.237417 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8634e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334317e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9403
    reference variance = 0.301486
====================================================
  Execution time = 2.1132e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3498e-01
  Total weights = 2.0000e+06
  Execution time = 1.8488e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335063947656
                                         uncertainty =       0.003099779922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335063947656
                                         uncertainty =       0.003099779922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409255886
  error estimate for blocks of size 2^( 2) =       0.000422363159
  error estimate for blocks of size 2^( 3) =       0.000435292392
  error estimate for blocks of size 2^( 4) =       0.000447089750
  error estimate for blocks of size 2^( 5) =       0.000457841754
  error estimate for blocks of size 2^( 6) =       0.000465283959
  error estimate for blocks of size 2^( 7) =       0.000472270753

      target function =                  N/A
              le_mean =     -16.905982429735
             les_mean =     286.147222506864
             stat err =       0.000460621554
             autocorr =       1.266772551491
              std dev =       0.578775223931
             le_variance =       0.334980759836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335063947656
                                         uncertainty =       0.003099779922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335063947656
                                         uncertainty =       0.003099779922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409255886
  error estimate for blocks of size 2^( 2) =       0.000422363159
  error estimate for blocks of size 2^( 3) =       0.000435292392
  error estimate for blocks of size 2^( 4) =       0.000447089750
  error estimate for blocks of size 2^( 5) =       0.000457841754
  error estimate for blocks of size 2^( 6) =       0.000465283959
  error estimate for blocks of size 2^( 7) =       0.000472270753

      target function =                  N/A
              le_mean =     -16.905982429735
             les_mean =     286.147222506864
             stat err =       0.000460621554
             autocorr =       1.266772551491
              std dev =       0.578775223931
             le_variance =       0.334980759836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335063947656
                                         uncertainty =       0.003099779922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335063947656
                                         uncertainty =       0.003099779922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409255886
  error estimate for blocks of size 2^( 2) =       0.000422363159
  error estimate for blocks of size 2^( 3) =       0.000435292392
  error estimate for blocks of size 2^( 4) =       0.000447089750
  error estimate for blocks of size 2^( 5) =       0.000457841754
  error estimate for blocks of size 2^( 6) =       0.000465283959
  error estimate for blocks of size 2^( 7) =       0.000472270753

      target function =                  N/A
              le_mean =     -16.905982429735
             les_mean =     286.147222506864
             stat err =       0.000460621554
             autocorr =       1.266772551491
              std dev =       0.578775223931
             le_variance =       0.334980759836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335063947656
                                         uncertainty =       0.003099779922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335063947656
                                         uncertainty =       0.003099779922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409255886
  error estimate for blocks of size 2^( 2) =       0.000422363159
  error estimate for blocks of size 2^( 3) =       0.000435292392
  error estimate for blocks of size 2^( 4) =       0.000447089750
  error estimate for blocks of size 2^( 5) =       0.000457841754
  error estimate for blocks of size 2^( 6) =       0.000465283959
  error estimate for blocks of size 2^( 7) =       0.000472270753

      target function =                  N/A
              le_mean =     -16.905982429735
             les_mean =     286.147222506864
             stat err =       0.000460621554
             autocorr =       1.266772551491
              std dev =       0.578775223931
             le_variance =       0.334980759836


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905982429735        initial  <--
     2.3283e+11     2.3283e+12             6.3676e-16       -16.905982429735
     9.3132e+11     9.3132e+12             8.6746e-17       -16.905982429735
     3.7253e+12     3.7253e+13             1.6803e-17       -16.905982429735

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4654
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334317e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9141e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.859
    reference variance = 0.250636
====================================================
  Execution time = 2.1071e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4056e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5627e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340674462764
                                         uncertainty =       0.005836433969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340674462764
                                         uncertainty =       0.005836433969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412647244
  error estimate for blocks of size 2^( 2) =       0.000425184398
  error estimate for blocks of size 2^( 3) =       0.000437910468
  error estimate for blocks of size 2^( 4) =       0.000450440775
  error estimate for blocks of size 2^( 5) =       0.000461206172
  error estimate for blocks of size 2^( 6) =       0.000467951583
  error estimate for blocks of size 2^( 7) =       0.000473126476

      target function =                  N/A
              le_mean =     -16.906122188991
             les_mean =     286.157522795020
             stat err =       0.000463181251
             autocorr =       1.259923120100
              std dev =       0.583571329154
             le_variance =       0.340555496210


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690612218899e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+12, overlap shift 2.3283e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906122188991       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906122188991       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906122188991       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906122188991       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906122188991       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906194663315       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.890462124477       residual = 3.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.913199934649       residual = 6.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.931699439398       residual = 8.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.935796285915       residual = 1.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.891145415610       residual = 2.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.915324978295       residual = 9.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.843875748163       residual = 5.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.956037023700       residual = 3.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.884850096252       residual = 7.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.837355635824       residual = 6.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.873183831824       residual = 3.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.933817530146       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.990252409291       residual = 1.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.298986767447       residual = 2.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.948646057974       residual = 2.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.071010457433       residual = 3.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.068868411682       residual = 4.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.753968046687       residual = 3.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.949150719036       residual = 2.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.823925158924       residual = 8.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.857544365303       residual = 3.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.749407219674       residual = 3.47e+00           smallest_sin_value = 9.99e-01
davidson iteration   28:   krylov dim =  29   energy =     -16.609156158967       residual = 1.10e+01           smallest_sin_value = 9.99e-01
davidson iteration   29:   krylov dim =  30   energy =     -16.485121297259       residual = 2.31e+01           smallest_sin_value = 9.93e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.42e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+12 is 2.043843e-17

solving harmonic davidson linear method for identity shift 9.3132e+12, overlap shift 9.3132e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906122188991       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906122188991       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906122188991       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906122188991       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.901725465454       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906062849888       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.950340349410       residual = 2.57e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.842102454469       residual = 5.37e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.941433968151       residual = 1.67e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.941771131762       residual = 1.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.677778689528       residual = 7.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.969104055077       residual = 7.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.040038406057       residual = 2.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.685126265300       residual = 6.87e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215313989210       residual = 1.28e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.939188939651       residual = 2.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.779539657993       residual = 2.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.776367997730       residual = 2.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.888686855018       residual = 1.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.947931763104       residual = 3.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.913305465018       residual = 5.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.563526649037       residual = 1.96e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.544710996815       residual = 5.44e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.770715252069       residual = 2.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.262005543627       residual = 1.78e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.821888728111       residual = 1.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -15.942356821140       residual = 1.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.105299255440       residual = 8.44e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.759626506376       residual = 5.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.423688180126       residual = 3.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.722541655386       residual = 6.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.926564032697       residual = 5.40e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.706880976909       residual = 8.70e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.504032339982       residual = 3.06e+01           smallest_sin_value = 9.99e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+12 is 1.870655e-17

solving harmonic davidson linear method for identity shift 3.7253e+13, overlap shift 3.7253e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906122188991       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906122188991       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906122188991       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906122188991       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906122188991       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.934541504028       residual = 9.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.657087832558       residual = 7.90e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.947573863894       residual = 4.67e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.715600030418       residual = 5.03e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.768430634190       residual = 2.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.760553513201       residual = 3.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.391651489679       residual = 3.49e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.588897454367       residual = 1.74e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.611901293611       residual = 6.21e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -18.546118742700       residual = 3.51e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.193129044019       residual = 1.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.817774034665       residual = 3.92e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.596561513423       residual = 5.84e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.153078442769       residual = 3.88e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.914000959553       residual = 4.98e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.921899727906       residual = 8.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.910361678623       residual = 1.26e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -15.950993479992       residual = 1.23e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -12.503977793466       residual = 2.48e+03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -18.069919924611       residual = 1.70e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -15.677969797354       residual = 3.45e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -18.630908944926       residual = 3.96e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -15.587724200048       residual = 2.75e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -19.456150883416       residual = 1.11e+03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -15.775131172444       residual = 3.34e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -10.720794962824       residual = 4.79e+03           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.617079573568       residual = 1.45e+01           smallest_sin_value = 9.98e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+13 is 4.676637e-18

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.282697 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6683e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334317e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9464
    reference variance = 0.294272
====================================================
  Execution time = 2.1971e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4260e-01
  Total weights = 2.0000e+06
  Execution time = 1.8738e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342677112618
                                         uncertainty =       0.004421035056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342677112618
                                         uncertainty =       0.004421035056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413883025
  error estimate for blocks of size 2^( 2) =       0.000426107268
  error estimate for blocks of size 2^( 3) =       0.000439201942
  error estimate for blocks of size 2^( 4) =       0.000450975804
  error estimate for blocks of size 2^( 5) =       0.000461217832
  error estimate for blocks of size 2^( 6) =       0.000470239469
  error estimate for blocks of size 2^( 7) =       0.000474722051

      target function =                  N/A
              le_mean =     -16.906578722542
             les_mean =     286.175002247687
             stat err =       0.000464288789
             autocorr =       1.258407111342
              std dev =       0.585318987800
             le_variance =       0.342598317480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342677112618
                                         uncertainty =       0.004421035056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342677112618
                                         uncertainty =       0.004421035056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413883025
  error estimate for blocks of size 2^( 2) =       0.000426107268
  error estimate for blocks of size 2^( 3) =       0.000439201942
  error estimate for blocks of size 2^( 4) =       0.000450975804
  error estimate for blocks of size 2^( 5) =       0.000461217832
  error estimate for blocks of size 2^( 6) =       0.000470239469
  error estimate for blocks of size 2^( 7) =       0.000474722051

      target function =                  N/A
              le_mean =     -16.906578722542
             les_mean =     286.175002247687
             stat err =       0.000464288789
             autocorr =       1.258407111344
              std dev =       0.585318987800
             le_variance =       0.342598317480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342677112618
                                         uncertainty =       0.004421035056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342677112618
                                         uncertainty =       0.004421035056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413883025
  error estimate for blocks of size 2^( 2) =       0.000426107268
  error estimate for blocks of size 2^( 3) =       0.000439201942
  error estimate for blocks of size 2^( 4) =       0.000450975804
  error estimate for blocks of size 2^( 5) =       0.000461217832
  error estimate for blocks of size 2^( 6) =       0.000470239469
  error estimate for blocks of size 2^( 7) =       0.000474722051

      target function =                  N/A
              le_mean =     -16.906578722542
             les_mean =     286.175002247687
             stat err =       0.000464288789
             autocorr =       1.258407111344
              std dev =       0.585318987800
             le_variance =       0.342598317480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342677112618
                                         uncertainty =       0.004421035056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342677112618
                                         uncertainty =       0.004421035056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413883025
  error estimate for blocks of size 2^( 2) =       0.000426107268
  error estimate for blocks of size 2^( 3) =       0.000439201942
  error estimate for blocks of size 2^( 4) =       0.000450975804
  error estimate for blocks of size 2^( 5) =       0.000461217832
  error estimate for blocks of size 2^( 6) =       0.000470239469
  error estimate for blocks of size 2^( 7) =       0.000474722051

      target function =                  N/A
              le_mean =     -16.906578722542
             les_mean =     286.175002247687
             stat err =       0.000464288789
             autocorr =       1.258407111344
              std dev =       0.585318987800
             le_variance =       0.342598317480


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906578722542        initial  <--
     2.3283e+12     2.3283e+13             2.0438e-17       -16.906578722542
     9.3132e+12     9.3132e+13             1.8707e-17       -16.906578722542
     3.7253e+13     3.7253e+14             4.6766e-18       -16.906578722542

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.4476
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.098011e-01 1 1  ON 0
 uu_1                 1.428665e-01 1 1  ON 1
 uu_2                 4.144438e-02 1 1  ON 2
 uu_3                -2.064493e-02 1 1  ON 3
 uu_4                -6.555940e-02 1 1  ON 4
 uu_5                -9.944264e-02 1 1  ON 5
 uu_6                -1.260239e-01 1 1  ON 6
 uu_7                -1.383245e-01 1 1  ON 7
 uu_8                -1.303820e-01 1 1  ON 8
 uu_9                -9.996240e-02 1 1  ON 9
 ud_0                 4.468371e-01 1 1  ON 10
 ud_1                 1.809923e-01 1 1  ON 11
 ud_2                 6.096122e-02 1 1  ON 12
 ud_3                -1.012007e-02 1 1  ON 13
 ud_4                -6.682822e-02 1 1  ON 14
 ud_5                -1.077120e-01 1 1  ON 15
 ud_6                -1.343622e-01 1 1  ON 16
 ud_7                -1.499599e-01 1 1  ON 17
 ud_8                -1.503533e-01 1 1  ON 18
 ud_9                -1.383543e-01 1 1  ON 19
 eO_0                -7.564292e-01 1 1  ON 20
 eO_1                -4.360220e-01 1 1  ON 21
 eO_2                -1.913318e-02 1 1  ON 22
 eO_3                 2.975130e-01 1 1  ON 23
 eO_4                 5.204151e-01 1 1  ON 24
 eO_5                 4.792935e-01 1 1  ON 25
 eO_6                 2.486841e-01 1 1  ON 26
 eO_7                -4.872769e-02 1 1  ON 27
 eO_8                -2.127030e-01 1 1  ON 28
 eO_9                -7.334317e-02 1 1  ON 29
eH1_0                -2.428983e-01 1 1  ON 30
eH1_1                -1.405727e-01 1 1  ON 31
eH1_2                -9.350645e-02 1 1  ON 32
eH1_3                -3.911603e-02 1 1  ON 33
eH1_4                 8.721498e-03 1 1  ON 34
eH1_5                 4.211828e-02 1 1  ON 35
eH1_6                 9.903702e-02 1 1  ON 36
eH1_7                 1.509735e-01 1 1  ON 37
eH1_8                 1.670556e-01 1 1  ON 38
eH1_9                 5.258359e-02 1 1  ON 39
eH2_0                -2.407511e-01 1 1  ON 40
eH2_1                -1.390004e-01 1 1  ON 41
eH2_2                -9.194492e-02 1 1  ON 42
eH2_3                -3.764332e-02 1 1  ON 43
eH2_4                 1.101621e-02 1 1  ON 44
eH2_5                 4.615159e-02 1 1  ON 45
eH2_6                 1.031960e-01 1 1  ON 46
eH2_7                 1.544422e-01 1 1  ON 47
eH2_8                 1.728208e-01 1 1  ON 48
eH2_9                 3.834226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8201e+01 secs
  Total Execution time = 2.3646e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
