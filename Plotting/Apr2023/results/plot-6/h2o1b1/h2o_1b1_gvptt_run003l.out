Rank =    0  Free Memory = 83682 MB
Rank =    1  Free Memory = 83678 MB
Rank =    2  Free Memory = 83678 MB
Rank =    3  Free Memory = 83678 MB
Rank =    4  Free Memory = 83678 MB
Rank =    5  Free Memory = 83678 MB
Rank =    6  Free Memory = 83677 MB
Rank =    7  Free Memory = 83677 MB
Rank =    8  Free Memory = 83677 MB
Rank =    9  Free Memory = 83677 MB
Rank =   10  Free Memory = 83675 MB
Rank =   11  Free Memory = 83675 MB
Rank =   12  Free Memory = 83675 MB
Rank =   13  Free Memory = 83675 MB
Rank =   14  Free Memory = 83674 MB
Rank =   15  Free Memory = 83662 MB
Rank =   16  Free Memory = 83659 MB
Rank =   17  Free Memory = 83658 MB
Rank =   18  Free Memory = 83657 MB
Rank =   19  Free Memory = 83657 MB
Rank =   20  Free Memory = 83657 MB
Rank =   21  Free Memory = 83657 MB
Rank =   22  Free Memory = 83657 MB
Rank =   23  Free Memory = 83657 MB
Rank =   24  Free Memory = 83657 MB
Rank =   25  Free Memory = 83657 MB
Rank =   26  Free Memory = 83657 MB
Rank =   27  Free Memory = 83657 MB
Rank =   28  Free Memory = 83657 MB
Rank =   29  Free Memory = 83657 MB
Rank =   30  Free Memory = 83657 MB
Rank =   31  Free Memory = 83657 MB
Rank =   32  Free Memory = 83657 MB
Rank =   33  Free Memory = 83657 MB
Rank =   34  Free Memory = 83657 MB
Rank =   35  Free Memory = 83657 MB
Rank =   36  Free Memory = 83657 MB
Rank =   37  Free Memory = 83657 MB
Rank =   38  Free Memory = 83657 MB
Rank =   39  Free Memory = 83657 MB
Rank =   40  Free Memory = 82673 MB
Rank =   41  Free Memory = 82673 MB
Rank =   42  Free Memory = 82673 MB
Rank =   43  Free Memory = 82673 MB
Rank =   44  Free Memory = 82673 MB
Rank =   45  Free Memory = 82673 MB
Rank =   46  Free Memory = 82673 MB
Rank =   47  Free Memory = 82673 MB
Rank =   48  Free Memory = 82673 MB
Rank =   49  Free Memory = 82673 MB
Rank =   50  Free Memory = 82673 MB
Rank =   51  Free Memory = 82673 MB
Rank =   52  Free Memory = 82673 MB
Rank =   53  Free Memory = 82673 MB
Rank =   54  Free Memory = 82673 MB
Rank =   55  Free Memory = 82673 MB
Rank =   56  Free Memory = 82673 MB
Rank =   57  Free Memory = 82673 MB
Rank =   58  Free Memory = 82673 MB
Rank =   59  Free Memory = 82673 MB
Rank =   60  Free Memory = 82673 MB
Rank =   61  Free Memory = 82673 MB
Rank =   62  Free Memory = 82673 MB
Rank =   63  Free Memory = 82673 MB
Rank =   64  Free Memory = 82673 MB
Rank =   65  Free Memory = 82672 MB
Rank =   66  Free Memory = 82672 MB
Rank =   67  Free Memory = 82672 MB
Rank =   68  Free Memory = 82672 MB
Rank =   69  Free Memory = 82672 MB
Rank =   70  Free Memory = 82672 MB
Rank =   71  Free Memory = 82672 MB
Rank =   72  Free Memory = 82672 MB
Rank =   73  Free Memory = 82672 MB
Rank =   74  Free Memory = 82672 MB
Rank =   75  Free Memory = 82672 MB
Rank =   76  Free Memory = 82672 MB
Rank =   77  Free Memory = 82672 MB
Rank =   78  Free Memory = 82672 MB
Rank =   79  Free Memory = 82672 MB
Rank =   80  Free Memory = 82723 MB
Rank =   81  Free Memory = 82723 MB
Rank =   82  Free Memory = 82723 MB
Rank =   83  Free Memory = 82723 MB
Rank =   84  Free Memory = 82723 MB
Rank =   85  Free Memory = 82723 MB
Rank =   86  Free Memory = 82723 MB
Rank =   87  Free Memory = 82723 MB
Rank =   88  Free Memory = 82723 MB
Rank =   89  Free Memory = 82723 MB
Rank =   90  Free Memory = 82723 MB
Rank =   91  Free Memory = 82723 MB
Rank =   92  Free Memory = 82723 MB
Rank =   93  Free Memory = 82723 MB
Rank =   94  Free Memory = 82723 MB
Rank =   95  Free Memory = 82723 MB
Rank =   96  Free Memory = 82723 MB
Rank =   97  Free Memory = 82723 MB
Rank =   98  Free Memory = 82723 MB
Rank =   99  Free Memory = 82723 MB
Rank =  100  Free Memory = 82723 MB
Rank =  101  Free Memory = 82723 MB
Rank =  102  Free Memory = 82723 MB
Rank =  103  Free Memory = 82723 MB
Rank =  104  Free Memory = 82723 MB
Rank =  105  Free Memory = 82723 MB
Rank =  106  Free Memory = 82723 MB
Rank =  107  Free Memory = 82723 MB
Rank =  108  Free Memory = 82723 MB
Rank =  109  Free Memory = 82723 MB
Rank =  110  Free Memory = 82723 MB
Rank =  111  Free Memory = 82723 MB
Rank =  112  Free Memory = 82723 MB
Rank =  113  Free Memory = 82723 MB
Rank =  114  Free Memory = 82723 MB
Rank =  115  Free Memory = 82723 MB
Rank =  116  Free Memory = 82723 MB
Rank =  117  Free Memory = 82723 MB
Rank =  118  Free Memory = 82723 MB
Rank =  119  Free Memory = 82723 MB
Rank =  120  Free Memory = 83791 MB
Rank =  121  Free Memory = 83791 MB
  Input file(s): opt_h2o_1b1_gvptt_run003l.xml 
Rank =  122  Free Memory = 83791 MB
Rank =  127  Free Memory = 83791 MB
Rank =  123  Free Memory = 83791 MB
Rank =  124  Free Memory = 83791 MB
Rank =  125  Free Memory = 83791 MB
Rank =  126  Free Memory = 83791 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 40
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run003l.xml

  Project = H2O
  date    = 2023-04-11 12:41:48 PDT
  host    = n0170.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 1020

  Range of prime numbers to use as seeds over processors and threads = 8123-9283


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.106420e-01    1         1  ON     0
     uu_1                 1.436004e-01    1         1  ON     1
     uu_2                 4.212944e-02    1         1  ON     2
     uu_3                -2.019564e-02    1         1  ON     3
     uu_4                -6.550931e-02    1         1  ON     4
     uu_5                -1.000053e-01    1         1  ON     5
     uu_6                -1.270522e-01    1         1  ON     6
     uu_7                -1.403675e-01    1         1  ON     7
     uu_8                -1.325670e-01    1         1  ON     8
     uu_9                -1.013152e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.478563e-01    1         1  ON     0
     ud_1                 1.820011e-01    1         1  ON     1
     ud_2                 6.129358e-02    1         1  ON     2
     ud_3                -9.868132e-03    1         1  ON     3
     ud_4                -6.667997e-02    1         1  ON     4
     ud_5                -1.077871e-01    1         1  ON     5
     ud_6                -1.348458e-01    1         1  ON     6
     ud_7                -1.505165e-01    1         1  ON     7
     ud_8                -1.510944e-01    1         1  ON     8
     ud_9                -1.391027e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.568722e-01    1         1  ON     0
     eO_1                -4.359627e-01    1         1  ON     1
     eO_2                -1.918653e-02    1         1  ON     2
     eO_3                 2.975714e-01    1         1  ON     3
     eO_4                 5.214256e-01    1         1  ON     4
     eO_5                 4.813435e-01    1         1  ON     5
     eO_6                 2.507122e-01    1         1  ON     6
     eO_7                -4.785432e-02    1         1  ON     7
     eO_8                -2.154432e-01    1         1  ON     8
     eO_9                -7.588014e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.453825e-01    1         1  ON     0
     eH1_1                -1.425501e-01    1         1  ON     1
     eH1_2                -9.509249e-02    1         1  ON     2
     eH1_3                -4.052610e-02    1         1  ON     3
     eH1_4                 7.827239e-03    1         1  ON     4
     eH1_5                 4.192502e-02    1         1  ON     5
     eH1_6                 9.952463e-02    1         1  ON     6
     eH1_7                 1.520110e-01    1         1  ON     7
     eH1_8                 1.700595e-01    1         1  ON     8
     eH1_9                 5.624123e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.436723e-01    1         1  ON     0
     eH2_1                -1.401750e-01    1         1  ON     1
     eH2_2                -9.248742e-02    1         1  ON     2
     eH2_3                -3.836711e-02    1         1  ON     3
     eH2_4                 1.030538e-02    1         1  ON     4
     eH2_5                 4.517008e-02    1         1  ON     5
     eH2_6                 1.022498e-01    1         1  ON     6
     eH2_7                 1.551650e-01    1         1  ON     7
     eH2_8                 1.755841e-01    1         1  ON     8
     eH2_9                 4.232839e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 8.111147e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.9702e+00 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8301
    reference variance = 0.172402
====================================================
  Execution time = 2.0696e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3858e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5436e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338716809772
                                         uncertainty =       0.003609490719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338716809772
                                         uncertainty =       0.003609490719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411446365
  error estimate for blocks of size 2^( 2) =       0.000424023476
  error estimate for blocks of size 2^( 3) =       0.000437303906
  error estimate for blocks of size 2^( 4) =       0.000449947375
  error estimate for blocks of size 2^( 5) =       0.000461727795
  error estimate for blocks of size 2^( 6) =       0.000469639210
  error estimate for blocks of size 2^( 7) =       0.000475162445

      target function =                  N/A
              le_mean =     -16.905616983499
             les_mean =     286.138461645311
             stat err =       0.000464119206
             autocorr =       1.272426258512
              std dev =       0.581873028971
             le_variance =       0.338576221844


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690561698350e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905616983499       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905618835740       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905620566099       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905621495391       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905621413697       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905622450250       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905622155820       residual = 8.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905621808875       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905621908242       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905622006204       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 8.659747e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905616983499       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905617671049       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905618645037       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905618794077       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905618992817       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905618949602       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905618950427       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905618829470       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.493953e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905616983499       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905617179092       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905617480578       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905617484713       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905617560609       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905617587695       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905617569399       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905617545490       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 6.412126e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127425 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6373e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.106768e-01                 1 1 ON  0
uu_1  1.435967e-01                 1 1 ON  1
uu_2  4.219090e-02                 1 1 ON  2
uu_3  -2.023962e-02                1 1 ON  3
uu_4  -6.551353e-02                1 1 ON  4
uu_5  -1.000146e-01                1 1 ON  5
uu_6  -1.270772e-01                1 1 ON  6
uu_7  -1.403909e-01                1 1 ON  7
uu_8  -1.326282e-01                1 1 ON  8
uu_9  -1.013960e-01                1 1 ON  9
ud_0  4.479627e-01                 1 1 ON  10
ud_1  1.820218e-01                 1 1 ON  11
ud_2  6.138416e-02                 1 1 ON  12
ud_3  -9.868537e-03                1 1 ON  13
ud_4  -6.665611e-02                1 1 ON  14
ud_5  -1.077462e-01                1 1 ON  15
ud_6  -1.348309e-01                1 1 ON  16
ud_7  -1.505317e-01                1 1 ON  17
ud_8  -1.512002e-01                1 1 ON  18
ud_9  -1.392048e-01                1 1 ON  19
eO_0  -7.568554e-01                1 1 ON  20
eO_1  -4.359032e-01                1 1 ON  21
eO_2  -1.925441e-02                1 1 ON  22
eO_3  2.975991e-01                 1 1 ON  23
eO_4  5.214633e-01                 1 1 ON  24
eO_5  4.814046e-01                 1 1 ON  25
eO_6  2.507988e-01                 1 1 ON  26
eO_7  -4.776975e-02                1 1 ON  27
eO_8  -2.155887e-01                1 1 ON  28
eO_9  -7.601893e-02                1 1 ON  29
eH1_0 -2.456319e-01                1 1 ON  30
eH1_1 -1.425655e-01                1 1 ON  31
eH1_2 -9.512552e-02                1 1 ON  32
eH1_3 -4.062639e-02                1 1 ON  33
eH1_4 7.749666e-03                 1 1 ON  34
eH1_5 4.193141e-02                 1 1 ON  35
eH1_6 9.952087e-02                 1 1 ON  36
eH1_7 1.521268e-01                 1 1 ON  37
eH1_8 1.702656e-01                 1 1 ON  38
eH1_9 5.640436e-02                 1 1 ON  39
eH2_0 -2.437486e-01                1 1 ON  40
eH2_1 -1.402775e-01                1 1 ON  41
eH2_2 -9.252169e-02                1 1 ON  42
eH2_3 -3.832209e-02                1 1 ON  43
eH2_4 1.021017e-02                 1 1 ON  44
eH2_5 4.512124e-02                 1 1 ON  45
eH2_6 1.022734e-01                 1 1 ON  46
eH2_7 1.552166e-01                 1 1 ON  47
eH2_8 1.756717e-01                 1 1 ON  48
eH2_9 4.247068e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9394
    reference variance = 0.245915
====================================================
  Execution time = 2.1358e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4406e-01
  Total weights = 2.0000e+06
  Execution time = 1.9028e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344042319061
                                         uncertainty =       0.005883121923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344042319061
                                         uncertainty =       0.005883121923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414754813
  error estimate for blocks of size 2^( 2) =       0.000427631079
  error estimate for blocks of size 2^( 3) =       0.000440387911
  error estimate for blocks of size 2^( 4) =       0.000451768298
  error estimate for blocks of size 2^( 5) =       0.000462107727
  error estimate for blocks of size 2^( 6) =       0.000468145496
  error estimate for blocks of size 2^( 7) =       0.000474448424

      target function =                  N/A
              le_mean =     -16.905553004646
             les_mean =     286.141765330842
             stat err =       0.000464117486
             autocorr =       1.252197964861
              std dev =       0.586551881741
             le_variance =       0.344043109974

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344077912651
                                         uncertainty =       0.005880645226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344077912651
                                         uncertainty =       0.005880645226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414776317
  error estimate for blocks of size 2^( 2) =       0.000427649730
  error estimate for blocks of size 2^( 3) =       0.000440401933
  error estimate for blocks of size 2^( 4) =       0.000451782983
  error estimate for blocks of size 2^( 5) =       0.000462116973
  error estimate for blocks of size 2^( 6) =       0.000468152695
  error estimate for blocks of size 2^( 7) =       0.000474455420

      target function =                  N/A
              le_mean =     -16.905554382068
             les_mean =     286.141847578732
             stat err =       0.000464127018
             autocorr =       1.252119559390
              std dev =       0.586582292359
             le_variance =       0.344078785709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344076065048
                                         uncertainty =       0.005881065315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344076065048
                                         uncertainty =       0.005881065315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414775181
  error estimate for blocks of size 2^( 2) =       0.000427649641
  error estimate for blocks of size 2^( 3) =       0.000440403250
  error estimate for blocks of size 2^( 4) =       0.000451785128
  error estimate for blocks of size 2^( 5) =       0.000462119580
  error estimate for blocks of size 2^( 6) =       0.000468156008
  error estimate for blocks of size 2^( 7) =       0.000474460171

      target function =                  N/A
              le_mean =     -16.905553735663
             les_mean =     286.141823838859
             stat err =       0.000464130222
             autocorr =       1.252143702785
              std dev =       0.586580686262
             le_variance =       0.344076901495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344046623896
                                         uncertainty =       0.005882760615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344046623896
                                         uncertainty =       0.005882760615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414757412
  error estimate for blocks of size 2^( 2) =       0.000427633460
  error estimate for blocks of size 2^( 3) =       0.000440389856
  error estimate for blocks of size 2^( 4) =       0.000451770540
  error estimate for blocks of size 2^( 5) =       0.000462109204
  error estimate for blocks of size 2^( 6) =       0.000468146823
  error estimate for blocks of size 2^( 7) =       0.000474450027

      target function =                  N/A
              le_mean =     -16.905553055701
             les_mean =     286.141771368862
             stat err =       0.000464119148
             autocorr =       1.252191239712
              std dev =       0.586555557277
             le_variance =       0.344047421773


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905553004646        initial
     2.5000e-01     2.5000e+00             8.6597e-04       -16.905554382068  <--
     1.0000e+00     1.0000e+01             2.4940e-04       -16.905553735663
     4.0000e+00     4.0000e+01             6.4121e-05       -16.905553055701

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0987e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.107535e-01 1 1  ON 0
 uu_1                 1.436266e-01 1 1  ON 1
 uu_2                 4.226342e-02 1 1  ON 2
 uu_3                -2.027560e-02 1 1  ON 3
 uu_4                -6.555426e-02 1 1  ON 4
 uu_5                -1.000457e-01 1 1  ON 5
 uu_6                -1.271629e-01 1 1  ON 6
 uu_7                -1.404691e-01 1 1  ON 7
 uu_8                -1.327821e-01 1 1  ON 8
 uu_9                -1.016244e-01 1 1  ON 9
 ud_0                 4.481629e-01 1 1  ON 10
 ud_1                 1.821515e-01 1 1  ON 11
 ud_2                 6.155434e-02 1 1  ON 12
 ud_3                -9.778756e-03 1 1  ON 13
 ud_4                -6.658745e-02 1 1  ON 14
 ud_5                -1.076276e-01 1 1  ON 15
 ud_6                -1.348104e-01 1 1  ON 16
 ud_7                -1.505630e-01 1 1  ON 17
 ud_8                -1.514517e-01 1 1  ON 18
 ud_9                -1.394925e-01 1 1  ON 19
 eO_0                -7.568172e-01 1 1  ON 20
 eO_1                -4.358165e-01 1 1  ON 21
 eO_2                -1.928433e-02 1 1  ON 22
 eO_3                 2.975993e-01 1 1  ON 23
 eO_4                 5.215674e-01 1 1  ON 24
 eO_5                 4.816042e-01 1 1  ON 25
 eO_6                 2.510537e-01 1 1  ON 26
 eO_7                -4.750656e-02 1 1  ON 27
 eO_8                -2.160173e-01 1 1  ON 28
 eO_9                -7.644044e-02 1 1  ON 29
eH1_0                -2.462484e-01 1 1  ON 30
eH1_1                -1.427249e-01 1 1  ON 31
eH1_2                -9.529362e-02 1 1  ON 32
eH1_3                -4.086007e-02 1 1  ON 33
eH1_4                 7.493376e-03 1 1  ON 34
eH1_5                 4.191489e-02 1 1  ON 35
eH1_6                 9.952585e-02 1 1  ON 36
eH1_7                 1.524774e-01 1 1  ON 37
eH1_8                 1.708923e-01 1 1  ON 38
eH1_9                 5.690699e-02 1 1  ON 39
eH2_0                -2.440091e-01 1 1  ON 40
eH2_1                -1.405112e-01 1 1  ON 41
eH2_2                -9.261993e-02 1 1  ON 42
eH2_3                -3.831540e-02 1 1  ON 43
eH2_4                 1.001304e-02 1 1  ON 44
eH2_5                 4.496486e-02 1 1  ON 45
eH2_6                 1.023271e-01 1 1  ON 46
eH2_7                 1.553697e-01 1 1  ON 47
eH2_8                 1.759426e-01 1 1  ON 48
eH2_9                 4.290941e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7651e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6885e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.908
    reference variance = 0.22976
====================================================
  Execution time = 2.1374e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4479e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6395e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344870855379
                                         uncertainty =       0.007052758005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344870855379
                                         uncertainty =       0.007052758005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415203805
  error estimate for blocks of size 2^( 2) =       0.000427361007
  error estimate for blocks of size 2^( 3) =       0.000440262505
  error estimate for blocks of size 2^( 4) =       0.000452011573
  error estimate for blocks of size 2^( 5) =       0.000463577241
  error estimate for blocks of size 2^( 6) =       0.000470317678
  error estimate for blocks of size 2^( 7) =       0.000475921759

      target function =                  N/A
              le_mean =     -16.906214335558
             les_mean =     286.164871386332
             stat err =       0.000465457063
             autocorr =       1.256714426649
              std dev =       0.587186851784
             le_variance =       0.344788398908


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690621433556e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906214335558       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906217092647       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906219149740       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906222395463       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906223234188       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906223471403       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906225168439       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906225970438       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906225250022       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906224593514       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906224534536       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906224502515       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906224880834       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.395498e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906214335558       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906216050590       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906217062175       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906218791128       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906219516311       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906219198641       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906219383042       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906219503489       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906219474310       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906219365555       residual = 9.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 8.441938e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906214335558       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906215018342       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906215401221       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906215966910       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906216343274       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906216317099       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906216244686       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906216232801       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906216252730       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.129745e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.132578 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7023e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.107335e-01 1 1  ON 0
 uu_1                 1.436080e-01 1 1  ON 1
 uu_2                 4.198288e-02 1 1  ON 2
 uu_3                -2.041948e-02 1 1  ON 3
 uu_4                -6.575569e-02 1 1  ON 4
 uu_5                -1.000041e-01 1 1  ON 5
 uu_6                -1.272289e-01 1 1  ON 6
 uu_7                -1.404354e-01 1 1  ON 7
 uu_8                -1.325306e-01 1 1  ON 8
 uu_9                -1.019135e-01 1 1  ON 9
 ud_0                 4.484043e-01 1 1  ON 10
 ud_1                 1.824279e-01 1 1  ON 11
 ud_2                 6.161858e-02 1 1  ON 12
 ud_3                -9.474386e-03 1 1  ON 13
 ud_4                -6.646748e-02 1 1  ON 14
 ud_5                -1.077500e-01 1 1  ON 15
 ud_6                -1.347617e-01 1 1  ON 16
 ud_7                -1.507380e-01 1 1  ON 17
 ud_8                -1.518175e-01 1 1  ON 18
 ud_9                -1.396542e-01 1 1  ON 19
 eO_0                -7.568690e-01 1 1  ON 20
 eO_1                -4.355350e-01 1 1  ON 21
 eO_2                -1.924865e-02 1 1  ON 22
 eO_3                 2.976109e-01 1 1  ON 23
 eO_4                 5.214536e-01 1 1  ON 24
 eO_5                 4.818963e-01 1 1  ON 25
 eO_6                 2.516104e-01 1 1  ON 26
 eO_7                -4.745963e-02 1 1  ON 27
 eO_8                -2.166045e-01 1 1  ON 28
 eO_9                -7.688694e-02 1 1  ON 29
eH1_0                -2.467736e-01 1 1  ON 30
eH1_1                -1.430879e-01 1 1  ON 31
eH1_2                -9.530644e-02 1 1  ON 32
eH1_3                -4.081577e-02 1 1  ON 33
eH1_4                 7.577349e-03 1 1  ON 34
eH1_5                 4.153844e-02 1 1  ON 35
eH1_6                 9.927708e-02 1 1  ON 36
eH1_7                 1.524797e-01 1 1  ON 37
eH1_8                 1.713112e-01 1 1  ON 38
eH1_9                 5.766262e-02 1 1  ON 39
eH2_0                -2.446640e-01 1 1  ON 40
eH2_1                -1.410706e-01 1 1  ON 41
eH2_2                -9.278809e-02 1 1  ON 42
eH2_3                -3.844814e-02 1 1  ON 43
eH2_4                 9.788556e-03 1 1  ON 44
eH2_5                 4.500871e-02 1 1  ON 45
eH2_6                 1.023627e-01 1 1  ON 46
eH2_7                 1.555523e-01 1 1  ON 47
eH2_8                 1.765853e-01 1 1  ON 48
eH2_9                 4.375360e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.961
    reference variance = 0.411195
====================================================
  Execution time = 2.0279e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3696e-01
  Total weights = 2.0000e+06
  Execution time = 1.8989e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336870037383
                                         uncertainty =       0.003243213972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336870037383
                                         uncertainty =       0.003243213972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410383935
  error estimate for blocks of size 2^( 2) =       0.000422828356
  error estimate for blocks of size 2^( 3) =       0.000435825452
  error estimate for blocks of size 2^( 4) =       0.000447779624
  error estimate for blocks of size 2^( 5) =       0.000457654747
  error estimate for blocks of size 2^( 6) =       0.000466470724
  error estimate for blocks of size 2^( 7) =       0.000472368684

      target function =                  N/A
              le_mean =     -16.906756266790
             les_mean =     286.175237244698
             stat err =       0.000461068445
             autocorr =       1.262263712978
              std dev =       0.580370526871
             le_variance =       0.336829948461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337055912177
                                         uncertainty =       0.003245027719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337055912177
                                         uncertainty =       0.003245027719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410496964
  error estimate for blocks of size 2^( 2) =       0.000422928858
  error estimate for blocks of size 2^( 3) =       0.000435913803
  error estimate for blocks of size 2^( 4) =       0.000447861821
  error estimate for blocks of size 2^( 5) =       0.000457736935
  error estimate for blocks of size 2^( 6) =       0.000466556125
  error estimate for blocks of size 2^( 7) =       0.000472434035

      target function =                  N/A
              le_mean =     -16.906755693206
             les_mean =     286.175403416519
             stat err =       0.000461147229
             autocorr =       1.261999862696
              std dev =       0.580530374132
             le_variance =       0.337015515290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337147855447
                                         uncertainty =       0.003245244750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337147855447
                                         uncertainty =       0.003245244750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410552876
  error estimate for blocks of size 2^( 2) =       0.000422981296
  error estimate for blocks of size 2^( 3) =       0.000435963905
  error estimate for blocks of size 2^( 4) =       0.000447913830
  error estimate for blocks of size 2^( 5) =       0.000457787373
  error estimate for blocks of size 2^( 6) =       0.000466609384
  error estimate for blocks of size 2^( 7) =       0.000472493325

      target function =                  N/A
              le_mean =     -16.906756572053
             les_mean =     286.175524945558
             stat err =       0.000461200978
             autocorr =       1.261950274215
              std dev =       0.580609444850
             le_variance =       0.337107327449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336929459029
                                         uncertainty =       0.003243670677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336929459029
                                         uncertainty =       0.003243670677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410420068
  error estimate for blocks of size 2^( 2) =       0.000422860765
  error estimate for blocks of size 2^( 3) =       0.000435854372
  error estimate for blocks of size 2^( 4) =       0.000447807554
  error estimate for blocks of size 2^( 5) =       0.000457681735
  error estimate for blocks of size 2^( 6) =       0.000466498714
  error estimate for blocks of size 2^( 7) =       0.000472394379

      target function =                  N/A
              le_mean =     -16.906755927058
             les_mean =     286.175285073780
             stat err =       0.000461095595
             autocorr =       1.262190102611
              std dev =       0.580421627024
             le_variance =       0.336889265117


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906756266790        initial
     6.2500e-02     6.2500e-01             3.3955e-03       -16.906755693206
     2.5000e-01     2.5000e+00             8.4419e-04       -16.906756572053  <--
     1.0000e+00     1.0000e+01             2.1297e-04       -16.906755927058

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9832e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.107335e-01 1 1  ON 0
 uu_1                 1.436080e-01 1 1  ON 1
 uu_2                 4.198288e-02 1 1  ON 2
 uu_3                -2.041948e-02 1 1  ON 3
 uu_4                -6.575569e-02 1 1  ON 4
 uu_5                -1.000041e-01 1 1  ON 5
 uu_6                -1.272289e-01 1 1  ON 6
 uu_7                -1.404354e-01 1 1  ON 7
 uu_8                -1.325306e-01 1 1  ON 8
 uu_9                -1.019135e-01 1 1  ON 9
 ud_0                 4.484043e-01 1 1  ON 10
 ud_1                 1.824279e-01 1 1  ON 11
 ud_2                 6.161858e-02 1 1  ON 12
 ud_3                -9.474386e-03 1 1  ON 13
 ud_4                -6.646748e-02 1 1  ON 14
 ud_5                -1.077500e-01 1 1  ON 15
 ud_6                -1.347617e-01 1 1  ON 16
 ud_7                -1.507380e-01 1 1  ON 17
 ud_8                -1.518175e-01 1 1  ON 18
 ud_9                -1.396542e-01 1 1  ON 19
 eO_0                -7.568690e-01 1 1  ON 20
 eO_1                -4.355350e-01 1 1  ON 21
 eO_2                -1.924865e-02 1 1  ON 22
 eO_3                 2.976109e-01 1 1  ON 23
 eO_4                 5.214536e-01 1 1  ON 24
 eO_5                 4.818963e-01 1 1  ON 25
 eO_6                 2.516104e-01 1 1  ON 26
 eO_7                -4.745963e-02 1 1  ON 27
 eO_8                -2.166045e-01 1 1  ON 28
 eO_9                -7.688694e-02 1 1  ON 29
eH1_0                -2.467736e-01 1 1  ON 30
eH1_1                -1.430879e-01 1 1  ON 31
eH1_2                -9.530644e-02 1 1  ON 32
eH1_3                -4.081577e-02 1 1  ON 33
eH1_4                 7.577349e-03 1 1  ON 34
eH1_5                 4.153844e-02 1 1  ON 35
eH1_6                 9.927708e-02 1 1  ON 36
eH1_7                 1.524797e-01 1 1  ON 37
eH1_8                 1.713112e-01 1 1  ON 38
eH1_9                 5.766262e-02 1 1  ON 39
eH2_0                -2.446640e-01 1 1  ON 40
eH2_1                -1.410706e-01 1 1  ON 41
eH2_2                -9.278809e-02 1 1  ON 42
eH2_3                -3.844814e-02 1 1  ON 43
eH2_4                 9.788556e-03 1 1  ON 44
eH2_5                 4.500871e-02 1 1  ON 45
eH2_6                 1.023627e-01 1 1  ON 46
eH2_7                 1.555523e-01 1 1  ON 47
eH2_8                 1.765853e-01 1 1  ON 48
eH2_9                 4.375360e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6961e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8657
    reference variance = 0.328031
====================================================
  Execution time = 2.1110e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3926e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6718e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339338846080
                                         uncertainty =       0.003215804769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339338846080
                                         uncertainty =       0.003215804769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411858994
  error estimate for blocks of size 2^( 2) =       0.000424574727
  error estimate for blocks of size 2^( 3) =       0.000437807149
  error estimate for blocks of size 2^( 4) =       0.000449969543
  error estimate for blocks of size 2^( 5) =       0.000460144543
  error estimate for blocks of size 2^( 6) =       0.000468012776
  error estimate for blocks of size 2^( 7) =       0.000473185883

      target function =                  N/A
              le_mean =     -16.905714007639
             les_mean =     286.142421601051
             stat err =       0.000462828186
             autocorr =       1.262823017774
              std dev =       0.582456575705
             le_variance =       0.339255662581


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690571400764e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905714007639       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905712011864       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905714619214       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905716567882       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905717921020       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905717667400       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905719366126       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905717502253       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905717874376       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905719161739       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905719250761       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905719506228       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.363137e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905714007639       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905712778579       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905714252997       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905715298211       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905715873454       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905716359842       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905716063094       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905716160549       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905715750061       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905715877754       residual = 5.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 8.520696e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905714007639       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905713523123       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905714045765       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905714427724       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905714612299       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905714869667       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905714841565       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905714801331       residual = 9.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.073504e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136513 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6790e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.108146e-01 1 1  ON 0
 uu_1                 1.434837e-01 1 1  ON 1
 uu_2                 4.204452e-02 1 1  ON 2
 uu_3                -2.040998e-02 1 1  ON 3
 uu_4                -6.570325e-02 1 1  ON 4
 uu_5                -1.002108e-01 1 1  ON 5
 uu_6                -1.272784e-01 1 1  ON 6
 uu_7                -1.403564e-01 1 1  ON 7
 uu_8                -1.326090e-01 1 1  ON 8
 uu_9                -1.023195e-01 1 1  ON 9
 ud_0                 4.485442e-01 1 1  ON 10
 ud_1                 1.823704e-01 1 1  ON 11
 ud_2                 6.183137e-02 1 1  ON 12
 ud_3                -9.450767e-03 1 1  ON 13
 ud_4                -6.636539e-02 1 1  ON 14
 ud_5                -1.077081e-01 1 1  ON 15
 ud_6                -1.350161e-01 1 1  ON 16
 ud_7                -1.507975e-01 1 1  ON 17
 ud_8                -1.516984e-01 1 1  ON 18
 ud_9                -1.395864e-01 1 1  ON 19
 eO_0                -7.566306e-01 1 1  ON 20
 eO_1                -4.355658e-01 1 1  ON 21
 eO_2                -1.932217e-02 1 1  ON 22
 eO_3                 2.973416e-01 1 1  ON 23
 eO_4                 5.218770e-01 1 1  ON 24
 eO_5                 4.820174e-01 1 1  ON 25
 eO_6                 2.520487e-01 1 1  ON 26
 eO_7                -4.724294e-02 1 1  ON 27
 eO_8                -2.170209e-01 1 1  ON 28
 eO_9                -7.741009e-02 1 1  ON 29
eH1_0                -2.469622e-01 1 1  ON 30
eH1_1                -1.435908e-01 1 1  ON 31
eH1_2                -9.571131e-02 1 1  ON 32
eH1_3                -4.111062e-02 1 1  ON 33
eH1_4                 7.385396e-03 1 1  ON 34
eH1_5                 4.177266e-02 1 1  ON 35
eH1_6                 9.904122e-02 1 1  ON 36
eH1_7                 1.523374e-01 1 1  ON 37
eH1_8                 1.720492e-01 1 1  ON 38
eH1_9                 5.851469e-02 1 1  ON 39
eH2_0                -2.450737e-01 1 1  ON 40
eH2_1                -1.411703e-01 1 1  ON 41
eH2_2                -9.306194e-02 1 1  ON 42
eH2_3                -3.877016e-02 1 1  ON 43
eH2_4                 9.679347e-03 1 1  ON 44
eH2_5                 4.467658e-02 1 1  ON 45
eH2_6                 1.026088e-01 1 1  ON 46
eH2_7                 1.557694e-01 1 1  ON 47
eH2_8                 1.771523e-01 1 1  ON 48
eH2_9                 4.437523e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8614
    reference variance = 0.22028
====================================================
  Execution time = 2.0404e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3713e-01
  Total weights = 2.0000e+06
  Execution time = 1.9006e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337111974612
                                         uncertainty =       0.005615020259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337111974612
                                         uncertainty =       0.005615020259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410571228
  error estimate for blocks of size 2^( 2) =       0.000423117140
  error estimate for blocks of size 2^( 3) =       0.000436407039
  error estimate for blocks of size 2^( 4) =       0.000449092538
  error estimate for blocks of size 2^( 5) =       0.000460427815
  error estimate for blocks of size 2^( 6) =       0.000469172395
  error estimate for blocks of size 2^( 7) =       0.000475885079

      target function =                  N/A
              le_mean =     -16.906050147534
             les_mean =     286.151668888087
             stat err =       0.000463644457
             autocorr =       1.275243508182
              std dev =       0.580635398270
             le_variance =       0.337137465724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337118676515
                                         uncertainty =       0.005600038107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337118676515
                                         uncertainty =       0.005600038107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410575423
  error estimate for blocks of size 2^( 2) =       0.000423127069
  error estimate for blocks of size 2^( 3) =       0.000436421095
  error estimate for blocks of size 2^( 4) =       0.000449102516
  error estimate for blocks of size 2^( 5) =       0.000460438303
  error estimate for blocks of size 2^( 6) =       0.000469180201
  error estimate for blocks of size 2^( 7) =       0.000475884322

      target function =                  N/A
              le_mean =     -16.906051589341
             les_mean =     286.151724528993
             stat err =       0.000463651335
             autocorr =       1.275255283072
              std dev =       0.580641331736
             le_variance =       0.337144356120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337105358393
                                         uncertainty =       0.005599128004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337105358393
                                         uncertainty =       0.005599128004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410567413
  error estimate for blocks of size 2^( 2) =       0.000423121369
  error estimate for blocks of size 2^( 3) =       0.000436419514
  error estimate for blocks of size 2^( 4) =       0.000449101649
  error estimate for blocks of size 2^( 5) =       0.000460439542
  error estimate for blocks of size 2^( 6) =       0.000469186233
  error estimate for blocks of size 2^( 7) =       0.000475889647

      target function =                  N/A
              le_mean =     -16.906052729837
             les_mean =     286.151749937399
             stat err =       0.000463654267
             autocorr =       1.275321171399
              std dev =       0.580630004323
             le_variance =       0.337131201920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337123782546
                                         uncertainty =       0.005612255004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337123782546
                                         uncertainty =       0.005612255004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410578472
  error estimate for blocks of size 2^( 2) =       0.000423125591
  error estimate for blocks of size 2^( 3) =       0.000436417045
  error estimate for blocks of size 2^( 4) =       0.000449101479
  error estimate for blocks of size 2^( 5) =       0.000460437269
  error estimate for blocks of size 2^( 6) =       0.000469182473
  error estimate for blocks of size 2^( 7) =       0.000475893214

      target function =                  N/A
              le_mean =     -16.906050527020
             les_mean =     286.151693617526
             stat err =       0.000463653609
             autocorr =       1.275248847852
              std dev =       0.580645644038
             le_variance =       0.337149363940


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906050147534        initial
     6.2500e-02     6.2500e-01             3.3631e-03       -16.906051589341
     2.5000e-01     2.5000e+00             8.5207e-04       -16.906052729837  <--
     1.0000e+00     1.0000e+01             2.0735e-04       -16.906050527020

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9986e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.108146e-01 1 1  ON 0
 uu_1                 1.434837e-01 1 1  ON 1
 uu_2                 4.204452e-02 1 1  ON 2
 uu_3                -2.040998e-02 1 1  ON 3
 uu_4                -6.570325e-02 1 1  ON 4
 uu_5                -1.002108e-01 1 1  ON 5
 uu_6                -1.272784e-01 1 1  ON 6
 uu_7                -1.403564e-01 1 1  ON 7
 uu_8                -1.326090e-01 1 1  ON 8
 uu_9                -1.023195e-01 1 1  ON 9
 ud_0                 4.485442e-01 1 1  ON 10
 ud_1                 1.823704e-01 1 1  ON 11
 ud_2                 6.183137e-02 1 1  ON 12
 ud_3                -9.450767e-03 1 1  ON 13
 ud_4                -6.636539e-02 1 1  ON 14
 ud_5                -1.077081e-01 1 1  ON 15
 ud_6                -1.350161e-01 1 1  ON 16
 ud_7                -1.507975e-01 1 1  ON 17
 ud_8                -1.516984e-01 1 1  ON 18
 ud_9                -1.395864e-01 1 1  ON 19
 eO_0                -7.566306e-01 1 1  ON 20
 eO_1                -4.355658e-01 1 1  ON 21
 eO_2                -1.932217e-02 1 1  ON 22
 eO_3                 2.973416e-01 1 1  ON 23
 eO_4                 5.218770e-01 1 1  ON 24
 eO_5                 4.820174e-01 1 1  ON 25
 eO_6                 2.520487e-01 1 1  ON 26
 eO_7                -4.724294e-02 1 1  ON 27
 eO_8                -2.170209e-01 1 1  ON 28
 eO_9                -7.741009e-02 1 1  ON 29
eH1_0                -2.469622e-01 1 1  ON 30
eH1_1                -1.435908e-01 1 1  ON 31
eH1_2                -9.571131e-02 1 1  ON 32
eH1_3                -4.111062e-02 1 1  ON 33
eH1_4                 7.385396e-03 1 1  ON 34
eH1_5                 4.177266e-02 1 1  ON 35
eH1_6                 9.904122e-02 1 1  ON 36
eH1_7                 1.523374e-01 1 1  ON 37
eH1_8                 1.720492e-01 1 1  ON 38
eH1_9                 5.851469e-02 1 1  ON 39
eH2_0                -2.450737e-01 1 1  ON 40
eH2_1                -1.411703e-01 1 1  ON 41
eH2_2                -9.306194e-02 1 1  ON 42
eH2_3                -3.877016e-02 1 1  ON 43
eH2_4                 9.679347e-03 1 1  ON 44
eH2_5                 4.467658e-02 1 1  ON 45
eH2_6                 1.026088e-01 1 1  ON 46
eH2_7                 1.557694e-01 1 1  ON 47
eH2_8                 1.771523e-01 1 1  ON 48
eH2_9                 4.437523e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6856e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8623
    reference variance = 0.256631
====================================================
  Execution time = 2.1276e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4002e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6601e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339983884977
                                         uncertainty =       0.004805641572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339983884977
                                         uncertainty =       0.004805641572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412324109
  error estimate for blocks of size 2^( 2) =       0.000425022875
  error estimate for blocks of size 2^( 3) =       0.000438141472
  error estimate for blocks of size 2^( 4) =       0.000449902963
  error estimate for blocks of size 2^( 5) =       0.000461428242
  error estimate for blocks of size 2^( 6) =       0.000469986042
  error estimate for blocks of size 2^( 7) =       0.000475091814

      target function =                  N/A
              le_mean =     -16.905698382388
             les_mean =     286.142659968067
             stat err =       0.000464102265
             autocorr =       1.266922117021
              std dev =       0.583114347102
             le_variance =       0.340022341796


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690569838239e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905698382388       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905699822589       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905701333761       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905701037747       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905704058980       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905707466072       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905706591476       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905706651777       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905707416790       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905706889749       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905706981777       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905706887296       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905707151373       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 4.402716e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905698382388       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905699299548       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905700347572       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905700134778       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905700887832       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905702170379       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905701507729       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905701456094       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905701565527       residual = 9.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.087056e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905698382388       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905698756329       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905699224906       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905699197076       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905699313784       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905699588076       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905699490270       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905699448473       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.735011e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140605 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6946e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.106355e-01 1 1  ON 0
 uu_1                 1.437103e-01 1 1  ON 1
 uu_2                 4.211866e-02 1 1  ON 2
 uu_3                -2.037874e-02 1 1  ON 3
 uu_4                -6.565496e-02 1 1  ON 4
 uu_5                -1.004482e-01 1 1  ON 5
 uu_6                -1.274755e-01 1 1  ON 6
 uu_7                -1.403897e-01 1 1  ON 7
 uu_8                -1.330078e-01 1 1  ON 8
 uu_9                -1.026152e-01 1 1  ON 9
 ud_0                 4.486230e-01 1 1  ON 10
 ud_1                 1.825544e-01 1 1  ON 11
 ud_2                 6.187775e-02 1 1  ON 12
 ud_3                -9.274911e-03 1 1  ON 13
 ud_4                -6.625540e-02 1 1  ON 14
 ud_5                -1.076573e-01 1 1  ON 15
 ud_6                -1.349520e-01 1 1  ON 16
 ud_7                -1.510888e-01 1 1  ON 17
 ud_8                -1.518105e-01 1 1  ON 18
 ud_9                -1.398173e-01 1 1  ON 19
 eO_0                -7.567582e-01 1 1  ON 20
 eO_1                -4.357299e-01 1 1  ON 21
 eO_2                -1.933974e-02 1 1  ON 22
 eO_3                 2.972995e-01 1 1  ON 23
 eO_4                 5.220188e-01 1 1  ON 24
 eO_5                 4.824301e-01 1 1  ON 25
 eO_6                 2.527575e-01 1 1  ON 26
 eO_7                -4.695319e-02 1 1  ON 27
 eO_8                -2.175873e-01 1 1  ON 28
 eO_9                -7.795657e-02 1 1  ON 29
eH1_0                -2.474415e-01 1 1  ON 30
eH1_1                -1.440841e-01 1 1  ON 31
eH1_2                -9.592093e-02 1 1  ON 32
eH1_3                -4.130563e-02 1 1  ON 33
eH1_4                 6.953205e-03 1 1  ON 34
eH1_5                 4.189228e-02 1 1  ON 35
eH1_6                 9.936517e-02 1 1  ON 36
eH1_7                 1.526837e-01 1 1  ON 37
eH1_8                 1.725758e-01 1 1  ON 38
eH1_9                 5.909591e-02 1 1  ON 39
eH2_0                -2.454390e-01 1 1  ON 40
eH2_1                -1.415610e-01 1 1  ON 41
eH2_2                -9.352369e-02 1 1  ON 42
eH2_3                -3.910217e-02 1 1  ON 43
eH2_4                 9.250950e-03 1 1  ON 44
eH2_5                 4.459416e-02 1 1  ON 45
eH2_6                 1.023942e-01 1 1  ON 46
eH2_7                 1.558579e-01 1 1  ON 47
eH2_8                 1.780070e-01 1 1  ON 48
eH2_9                 4.546229e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8862
    reference variance = 0.246751
====================================================
  Execution time = 2.0181e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3534e-01
  Total weights = 2.0000e+06
  Execution time = 1.9004e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335497453135
                                         uncertainty =       0.002955963001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335497453135
                                         uncertainty =       0.002955963001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409499527
  error estimate for blocks of size 2^( 2) =       0.000422306557
  error estimate for blocks of size 2^( 3) =       0.000435780193
  error estimate for blocks of size 2^( 4) =       0.000448392971
  error estimate for blocks of size 2^( 5) =       0.000460988201
  error estimate for blocks of size 2^( 6) =       0.000471212952
  error estimate for blocks of size 2^( 7) =       0.000476860428

      target function =                  N/A
              le_mean =     -16.905327563463
             les_mean =     286.125479585086
             stat err =       0.000464363638
             autocorr =       1.285907122287
              std dev =       0.579119784498
             le_variance =       0.335379724796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335505217361
                                         uncertainty =       0.002956963287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335505217361
                                         uncertainty =       0.002956963287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409504293
  error estimate for blocks of size 2^( 2) =       0.000422306399
  error estimate for blocks of size 2^( 3) =       0.000435773955
  error estimate for blocks of size 2^( 4) =       0.000448378951
  error estimate for blocks of size 2^( 5) =       0.000460962312
  error estimate for blocks of size 2^( 6) =       0.000471185177
  error estimate for blocks of size 2^( 7) =       0.000476839113

      target function =                  N/A
              le_mean =     -16.905326940641
             les_mean =     286.125466333493
             stat err =       0.000464341388
             autocorr =       1.285753970769
              std dev =       0.579126524363
             le_variance =       0.335387531221

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335431572226
                                         uncertainty =       0.002956231561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335431572226
                                         uncertainty =       0.002956231561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409459385
  error estimate for blocks of size 2^( 2) =       0.000422261456
  error estimate for blocks of size 2^( 3) =       0.000435732089
  error estimate for blocks of size 2^( 4) =       0.000448341969
  error estimate for blocks of size 2^( 5) =       0.000460929720
  error estimate for blocks of size 2^( 6) =       0.000471157429
  error estimate for blocks of size 2^( 7) =       0.000476817364

      target function =                  N/A
              le_mean =     -16.905325351056
             les_mean =     286.125339032773
             stat err =       0.000464311620
             autocorr =       1.285871133897
              std dev =       0.579063015039
             le_variance =       0.335313975387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335468785203
                                         uncertainty =       0.002955911786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335468785203
                                         uncertainty =       0.002955911786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409482050
  error estimate for blocks of size 2^( 2) =       0.000422288265
  error estimate for blocks of size 2^( 3) =       0.000435761848
  error estimate for blocks of size 2^( 4) =       0.000448374626
  error estimate for blocks of size 2^( 5) =       0.000460968741
  error estimate for blocks of size 2^( 6) =       0.000471194537
  error estimate for blocks of size 2^( 7) =       0.000476844714

      target function =                  N/A
              le_mean =     -16.905326658216
             les_mean =     286.125420352482
             stat err =       0.000464345655
             autocorr =       1.285917281876
              std dev =       0.579095069197
             le_variance =       0.335351099169


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905327563463        initial  <--
     6.2500e-02     6.2500e-01             4.4027e-03       -16.905326940641
     2.5000e-01     2.5000e+00             1.0871e-03       -16.905325351056
     1.0000e+00     1.0000e+01             2.7350e-04       -16.905326658216

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7488
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.108146e-01 1 1  ON 0
 uu_1                 1.434837e-01 1 1  ON 1
 uu_2                 4.204452e-02 1 1  ON 2
 uu_3                -2.040998e-02 1 1  ON 3
 uu_4                -6.570325e-02 1 1  ON 4
 uu_5                -1.002108e-01 1 1  ON 5
 uu_6                -1.272784e-01 1 1  ON 6
 uu_7                -1.403564e-01 1 1  ON 7
 uu_8                -1.326090e-01 1 1  ON 8
 uu_9                -1.023195e-01 1 1  ON 9
 ud_0                 4.485442e-01 1 1  ON 10
 ud_1                 1.823704e-01 1 1  ON 11
 ud_2                 6.183137e-02 1 1  ON 12
 ud_3                -9.450767e-03 1 1  ON 13
 ud_4                -6.636539e-02 1 1  ON 14
 ud_5                -1.077081e-01 1 1  ON 15
 ud_6                -1.350161e-01 1 1  ON 16
 ud_7                -1.507975e-01 1 1  ON 17
 ud_8                -1.516984e-01 1 1  ON 18
 ud_9                -1.395864e-01 1 1  ON 19
 eO_0                -7.566306e-01 1 1  ON 20
 eO_1                -4.355658e-01 1 1  ON 21
 eO_2                -1.932217e-02 1 1  ON 22
 eO_3                 2.973416e-01 1 1  ON 23
 eO_4                 5.218770e-01 1 1  ON 24
 eO_5                 4.820174e-01 1 1  ON 25
 eO_6                 2.520487e-01 1 1  ON 26
 eO_7                -4.724294e-02 1 1  ON 27
 eO_8                -2.170209e-01 1 1  ON 28
 eO_9                -7.741009e-02 1 1  ON 29
eH1_0                -2.469622e-01 1 1  ON 30
eH1_1                -1.435908e-01 1 1  ON 31
eH1_2                -9.571131e-02 1 1  ON 32
eH1_3                -4.111062e-02 1 1  ON 33
eH1_4                 7.385396e-03 1 1  ON 34
eH1_5                 4.177266e-02 1 1  ON 35
eH1_6                 9.904122e-02 1 1  ON 36
eH1_7                 1.523374e-01 1 1  ON 37
eH1_8                 1.720492e-01 1 1  ON 38
eH1_9                 5.851469e-02 1 1  ON 39
eH2_0                -2.450737e-01 1 1  ON 40
eH2_1                -1.411703e-01 1 1  ON 41
eH2_2                -9.306194e-02 1 1  ON 42
eH2_3                -3.877016e-02 1 1  ON 43
eH2_4                 9.679347e-03 1 1  ON 44
eH2_5                 4.467658e-02 1 1  ON 45
eH2_6                 1.026088e-01 1 1  ON 46
eH2_7                 1.557694e-01 1 1  ON 47
eH2_8                 1.771523e-01 1 1  ON 48
eH2_9                 4.437523e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6762e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6889e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9402
    reference variance = 0.232846
====================================================
  Execution time = 2.0555e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.8507e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5283e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385160172414
                                         uncertainty =       0.037901971101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385160172414
                                         uncertainty =       0.037901971101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000438789689
  error estimate for blocks of size 2^( 2) =       0.000450459599
  error estimate for blocks of size 2^( 3) =       0.000462687084
  error estimate for blocks of size 2^( 4) =       0.000474713474
  error estimate for blocks of size 2^( 5) =       0.000484973779
  error estimate for blocks of size 2^( 6) =       0.000493700944
  error estimate for blocks of size 2^( 7) =       0.000499355469

      target function =                  N/A
              le_mean =     -16.905403427143
             les_mean =     286.177737623610
             stat err =       0.000488185916
             autocorr =       1.237820486382
              std dev =       0.620542328680
             le_variance =       0.385072781683


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690540342714e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905403427143       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905403723711       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905403777339       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905404029969       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905404181060       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905404424807       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905404483537       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905404402137       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905404468984       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.135665e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905403427143       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905403522476       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905403557771       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905403651122       residual = 9.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905403746586       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905403786194       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905403800456       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905403785622       residual = 6.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.023126e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905403427143       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905403452810       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905403464037       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905403489877       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905403521542       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905403530963       residual = 8.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905403534239       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905403531033       residual = 4.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.572438e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.143463 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6090e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.108212e-01 1 1  ON 0
 uu_1                 1.435253e-01 1 1  ON 1
 uu_2                 4.205627e-02 1 1  ON 2
 uu_3                -2.039584e-02 1 1  ON 3
 uu_4                -6.568238e-02 1 1  ON 4
 uu_5                -1.002203e-01 1 1  ON 5
 uu_6                -1.273371e-01 1 1  ON 6
 uu_7                -1.403916e-01 1 1  ON 7
 uu_8                -1.326539e-01 1 1  ON 8
 uu_9                -1.023426e-01 1 1  ON 9
 ud_0                 4.485530e-01 1 1  ON 10
 ud_1                 1.823960e-01 1 1  ON 11
 ud_2                 6.179659e-02 1 1  ON 12
 ud_3                -9.470242e-03 1 1  ON 13
 ud_4                -6.633856e-02 1 1  ON 14
 ud_5                -1.076844e-01 1 1  ON 15
 ud_6                -1.349762e-01 1 1  ON 16
 ud_7                -1.508155e-01 1 1  ON 17
 ud_8                -1.517058e-01 1 1  ON 18
 ud_9                -1.396114e-01 1 1  ON 19
 eO_0                -7.566322e-01 1 1  ON 20
 eO_1                -4.355922e-01 1 1  ON 21
 eO_2                -1.930671e-02 1 1  ON 22
 eO_3                 2.973327e-01 1 1  ON 23
 eO_4                 5.218997e-01 1 1  ON 24
 eO_5                 4.820470e-01 1 1  ON 25
 eO_6                 2.521090e-01 1 1  ON 26
 eO_7                -4.724495e-02 1 1  ON 27
 eO_8                -2.170660e-01 1 1  ON 28
 eO_9                -7.744993e-02 1 1  ON 29
eH1_0                -2.470406e-01 1 1  ON 30
eH1_1                -1.436337e-01 1 1  ON 31
eH1_2                -9.571528e-02 1 1  ON 32
eH1_3                -4.112823e-02 1 1  ON 33
eH1_4                 7.374812e-03 1 1  ON 34
eH1_5                 4.175671e-02 1 1  ON 35
eH1_6                 9.905847e-02 1 1  ON 36
eH1_7                 1.524006e-01 1 1  ON 37
eH1_8                 1.720927e-01 1 1  ON 38
eH1_9                 5.856253e-02 1 1  ON 39
eH2_0                -2.451221e-01 1 1  ON 40
eH2_1                -1.412136e-01 1 1  ON 41
eH2_2                -9.307193e-02 1 1  ON 42
eH2_3                -3.875524e-02 1 1  ON 43
eH2_4                 9.673143e-03 1 1  ON 44
eH2_5                 4.463308e-02 1 1  ON 45
eH2_6                 1.025509e-01 1 1  ON 46
eH2_7                 1.557784e-01 1 1  ON 47
eH2_8                 1.772209e-01 1 1  ON 48
eH2_9                 4.447755e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9896
    reference variance = 0.342768
====================================================
  Execution time = 2.3059e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3366e-01
  Total weights = 2.0000e+06
  Execution time = 1.9232e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333716157382
                                         uncertainty =       0.003505782740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333716157382
                                         uncertainty =       0.003505782740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408439213
  error estimate for blocks of size 2^( 2) =       0.000421289251
  error estimate for blocks of size 2^( 3) =       0.000434426748
  error estimate for blocks of size 2^( 4) =       0.000446683433
  error estimate for blocks of size 2^( 5) =       0.000455861209
  error estimate for blocks of size 2^( 6) =       0.000462809156
  error estimate for blocks of size 2^( 7) =       0.000465403524

      target function =                  N/A
              le_mean =     -16.906366648339
             les_mean =     286.158878261980
             stat err =       0.000457689330
             autocorr =       1.255702376739
              std dev =       0.577620273828
             le_variance =       0.333645180737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333772881934
                                         uncertainty =       0.003505573976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333772881934
                                         uncertainty =       0.003505573976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408473986
  error estimate for blocks of size 2^( 2) =       0.000421321020
  error estimate for blocks of size 2^( 3) =       0.000434455561
  error estimate for blocks of size 2^( 4) =       0.000446711933
  error estimate for blocks of size 2^( 5) =       0.000455888355
  error estimate for blocks of size 2^( 6) =       0.000462837178
  error estimate for blocks of size 2^( 7) =       0.000465432583

      target function =                  N/A
              le_mean =     -16.906368326131
             les_mean =     286.158991805631
             stat err =       0.000457717512
             autocorr =       1.255643207534
              std dev =       0.577669450192
             le_variance =       0.333701993686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333748018489
                                         uncertainty =       0.003505541959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333748018489
                                         uncertainty =       0.003505541959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408458751
  error estimate for blocks of size 2^( 2) =       0.000421306929
  error estimate for blocks of size 2^( 3) =       0.000434442636
  error estimate for blocks of size 2^( 4) =       0.000446699361
  error estimate for blocks of size 2^( 5) =       0.000455876505
  error estimate for blocks of size 2^( 6) =       0.000462825238
  error estimate for blocks of size 2^( 7) =       0.000465420459

      target function =                  N/A
              le_mean =     -16.906367551583
             les_mean =     286.158940725610
             stat err =       0.000457705391
             autocorr =       1.255670362411
              std dev =       0.577647905939
             le_variance =       0.333677103236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333720429494
                                         uncertainty =       0.003505734438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333720429494
                                         uncertainty =       0.003505734438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408441833
  error estimate for blocks of size 2^( 2) =       0.000421291606
  error estimate for blocks of size 2^( 3) =       0.000434428847
  error estimate for blocks of size 2^( 4) =       0.000446685537
  error estimate for blocks of size 2^( 5) =       0.000455863219
  error estimate for blocks of size 2^( 6) =       0.000462811268
  error estimate for blocks of size 2^( 7) =       0.000465405765

      target function =                  N/A
              le_mean =     -16.906366750382
             les_mean =     286.158885992980
             stat err =       0.000457691447
             autocorr =       1.255697880930
              std dev =       0.577623979237
             le_variance =       0.333649461390


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906366648339        initial
     6.2500e-01     6.2500e+00             4.1357e-04       -16.906368326131  <--
     2.5000e+00     2.5000e+01             1.0231e-04       -16.906367551583
     1.0000e+01     1.0000e+02             2.5724e-05       -16.906366750382

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.2719e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.108560e-01 1 1  ON 0
 uu_1                 1.436142e-01 1 1  ON 1
 uu_2                 4.209697e-02 1 1  ON 2
 uu_3                -2.035211e-02 1 1  ON 3
 uu_4                -6.564170e-02 1 1  ON 4
 uu_5                -1.002406e-01 1 1  ON 5
 uu_6                -1.274843e-01 1 1  ON 6
 uu_7                -1.404987e-01 1 1  ON 7
 uu_8                -1.327894e-01 1 1  ON 8
 uu_9                -1.024133e-01 1 1  ON 9
 ud_0                 4.485838e-01 1 1  ON 10
 ud_1                 1.824364e-01 1 1  ON 11
 ud_2                 6.173412e-02 1 1  ON 12
 ud_3                -9.502461e-03 1 1  ON 13
 ud_4                -6.628786e-02 1 1  ON 14
 ud_5                -1.076155e-01 1 1  ON 15
 ud_6                -1.348810e-01 1 1  ON 16
 ud_7                -1.508526e-01 1 1  ON 17
 ud_8                -1.517224e-01 1 1  ON 18
 ud_9                -1.396871e-01 1 1  ON 19
 eO_0                -7.566456e-01 1 1  ON 20
 eO_1                -4.356364e-01 1 1  ON 21
 eO_2                -1.930061e-02 1 1  ON 22
 eO_3                 2.973031e-01 1 1  ON 23
 eO_4                 5.219799e-01 1 1  ON 24
 eO_5                 4.821437e-01 1 1  ON 25
 eO_6                 2.522890e-01 1 1  ON 26
 eO_7                -4.724943e-02 1 1  ON 27
 eO_8                -2.172031e-01 1 1  ON 28
 eO_9                -7.757147e-02 1 1  ON 29
eH1_0                -2.472655e-01 1 1  ON 30
eH1_1                -1.437461e-01 1 1  ON 31
eH1_2                -9.575468e-02 1 1  ON 32
eH1_3                -4.117513e-02 1 1  ON 33
eH1_4                 7.331835e-03 1 1  ON 34
eH1_5                 4.171042e-02 1 1  ON 35
eH1_6                 9.910857e-02 1 1  ON 36
eH1_7                 1.525905e-01 1 1  ON 37
eH1_8                 1.722262e-01 1 1  ON 38
eH1_9                 5.870895e-02 1 1  ON 39
eH2_0                -2.452651e-01 1 1  ON 40
eH2_1                -1.413247e-01 1 1  ON 41
eH2_2                -9.311429e-02 1 1  ON 42
eH2_3                -3.873083e-02 1 1  ON 43
eH2_4                 9.645650e-03 1 1  ON 44
eH2_5                 4.451263e-02 1 1  ON 45
eH2_6                 1.023833e-01 1 1  ON 46
eH2_7                 1.558037e-01 1 1  ON 47
eH2_8                 1.774279e-01 1 1  ON 48
eH2_9                 4.478880e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9203e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9163
    reference variance = 0.213961
====================================================
  Execution time = 2.0935e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4273e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5892e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342817667272
                                         uncertainty =       0.008715444578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342817667272
                                         uncertainty =       0.008715444578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413962515
  error estimate for blocks of size 2^( 2) =       0.000426639173
  error estimate for blocks of size 2^( 3) =       0.000439311723
  error estimate for blocks of size 2^( 4) =       0.000451824178
  error estimate for blocks of size 2^( 5) =       0.000462597332
  error estimate for blocks of size 2^( 6) =       0.000469458720
  error estimate for blocks of size 2^( 7) =       0.000476209096

      target function =                  N/A
              le_mean =     -16.906777853666
             les_mean =     286.181867149530
             stat err =       0.000465022331
             autocorr =       1.261901872079
              std dev =       0.585431403043
             le_variance =       0.342729927669


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690677785367e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906777853666       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906778026617       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906779000783       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906780936869       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906782588317       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906783050553       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906783897321       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906782964998       residual = 9.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906783110907       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906782878438       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.531404e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906777853666       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906777926480       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906778149623       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906778742588       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906779755086       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906779871967       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906780136729       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906779842557       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906779770792       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.898894e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906777853666       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906777875625       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906777923231       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906778057925       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906778380546       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906778476968       residual = 9.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906778554957       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906778487808       residual = 7.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 9.626005e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.146690 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6532e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.107790e-01 1 1  ON 0
 uu_1                 1.437395e-01 1 1  ON 1
 uu_2                 4.216303e-02 1 1  ON 2
 uu_3                -2.021091e-02 1 1  ON 3
 uu_4                -6.561774e-02 1 1  ON 4
 uu_5                -1.002975e-01 1 1  ON 5
 uu_6                -1.276579e-01 1 1  ON 6
 uu_7                -1.405913e-01 1 1  ON 7
 uu_8                -1.329215e-01 1 1  ON 8
 uu_9                -1.025118e-01 1 1  ON 9
 ud_0                 4.485277e-01 1 1  ON 10
 ud_1                 1.825250e-01 1 1  ON 11
 ud_2                 6.180202e-02 1 1  ON 12
 ud_3                -9.473076e-03 1 1  ON 13
 ud_4                -6.628882e-02 1 1  ON 14
 ud_5                -1.075532e-01 1 1  ON 15
 ud_6                -1.347046e-01 1 1  ON 16
 ud_7                -1.508570e-01 1 1  ON 17
 ud_8                -1.517598e-01 1 1  ON 18
 ud_9                -1.398528e-01 1 1  ON 19
 eO_0                -7.567147e-01 1 1  ON 20
 eO_1                -4.355084e-01 1 1  ON 21
 eO_2                -1.923588e-02 1 1  ON 22
 eO_3                 2.973086e-01 1 1  ON 23
 eO_4                 5.219567e-01 1 1  ON 24
 eO_5                 4.823217e-01 1 1  ON 25
 eO_6                 2.524773e-01 1 1  ON 26
 eO_7                -4.720660e-02 1 1  ON 27
 eO_8                -2.174584e-01 1 1  ON 28
 eO_9                -7.778987e-02 1 1  ON 29
eH1_0                -2.474981e-01 1 1  ON 30
eH1_1                -1.438289e-01 1 1  ON 31
eH1_2                -9.587546e-02 1 1  ON 32
eH1_3                -4.135267e-02 1 1  ON 33
eH1_4                 7.441867e-03 1 1  ON 34
eH1_5                 4.171172e-02 1 1  ON 35
eH1_6                 9.913467e-02 1 1  ON 36
eH1_7                 1.526131e-01 1 1  ON 37
eH1_8                 1.724124e-01 1 1  ON 38
eH1_9                 5.897495e-02 1 1  ON 39
eH2_0                -2.456039e-01 1 1  ON 40
eH2_1                -1.413909e-01 1 1  ON 41
eH2_2                -9.323833e-02 1 1  ON 42
eH2_3                -3.890381e-02 1 1  ON 43
eH2_4                 9.566059e-03 1 1  ON 44
eH2_5                 4.441056e-02 1 1  ON 45
eH2_6                 1.025636e-01 1 1  ON 46
eH2_7                 1.559028e-01 1 1  ON 47
eH2_8                 1.776457e-01 1 1  ON 48
eH2_9                 4.517869e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9163
    reference variance = 0.168548
====================================================
  Execution time = 2.0420e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4482e-01
  Total weights = 2.0000e+06
  Execution time = 1.9020e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344510352823
                                         uncertainty =       0.003889459044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344510352823
                                         uncertainty =       0.003889459044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415311634
  error estimate for blocks of size 2^( 2) =       0.000427544490
  error estimate for blocks of size 2^( 3) =       0.000439961695
  error estimate for blocks of size 2^( 4) =       0.000451330869
  error estimate for blocks of size 2^( 5) =       0.000461642533
  error estimate for blocks of size 2^( 6) =       0.000467884874
  error estimate for blocks of size 2^( 7) =       0.000472433304

      target function =                  N/A
              le_mean =     -16.906797386603
             les_mean =     286.184765206348
             stat err =       0.000463322895
             autocorr =       1.244570000913
              std dev =       0.587339345844
             le_variance =       0.344967507177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344276103735
                                         uncertainty =       0.003887922501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344276103735
                                         uncertainty =       0.003887922501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415169798
  error estimate for blocks of size 2^( 2) =       0.000427406481
  error estimate for blocks of size 2^( 3) =       0.000439825329
  error estimate for blocks of size 2^( 4) =       0.000451196139
  error estimate for blocks of size 2^( 5) =       0.000461510784
  error estimate for blocks of size 2^( 6) =       0.000467761797
  error estimate for blocks of size 2^( 7) =       0.000472302996

      target function =                  N/A
              le_mean =     -16.906798708229
             les_mean =     286.184574310393
             stat err =       0.000463192929
             autocorr =       1.244721917816
              std dev =       0.587138758878
             le_variance =       0.344731922176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344218454920
                                         uncertainty =       0.003886606137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344218454920
                                         uncertainty =       0.003886606137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415135159
  error estimate for blocks of size 2^( 2) =       0.000427374245
  error estimate for blocks of size 2^( 3) =       0.000439796560
  error estimate for blocks of size 2^( 4) =       0.000451169795
  error estimate for blocks of size 2^( 5) =       0.000461486465
  error estimate for blocks of size 2^( 6) =       0.000467738082
  error estimate for blocks of size 2^( 7) =       0.000472277557

      target function =                  N/A
              le_mean =     -16.906798917160
             les_mean =     286.184523852638
             stat err =       0.000463167975
             autocorr =       1.244795511981
              std dev =       0.587089771397
             le_variance =       0.344674399679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344452206422
                                         uncertainty =       0.003888850378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344452206422
                                         uncertainty =       0.003888850378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415276517
  error estimate for blocks of size 2^( 2) =       0.000427510705
  error estimate for blocks of size 2^( 3) =       0.000439929084
  error estimate for blocks of size 2^( 4) =       0.000451299195
  error estimate for blocks of size 2^( 5) =       0.000461611949
  error estimate for blocks of size 2^( 6) =       0.000467855927
  error estimate for blocks of size 2^( 7) =       0.000472402737

      target function =                  N/A
              le_mean =     -16.906797606396
             les_mean =     286.184714302347
             stat err =       0.000463292452
             autocorr =       1.244616924406
              std dev =       0.587289682501
             le_variance =       0.344909171172


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906797386603        initial
     1.5625e-01     1.5625e+00             1.5314e-03       -16.906798708229
     6.2500e-01     6.2500e+00             3.8989e-04       -16.906798917160  <--
     2.5000e+00     2.5000e+01             9.6260e-05       -16.906797606396

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.0025e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.107790e-01 1 1  ON 0
 uu_1                 1.437395e-01 1 1  ON 1
 uu_2                 4.216303e-02 1 1  ON 2
 uu_3                -2.021091e-02 1 1  ON 3
 uu_4                -6.561774e-02 1 1  ON 4
 uu_5                -1.002975e-01 1 1  ON 5
 uu_6                -1.276579e-01 1 1  ON 6
 uu_7                -1.405913e-01 1 1  ON 7
 uu_8                -1.329215e-01 1 1  ON 8
 uu_9                -1.025118e-01 1 1  ON 9
 ud_0                 4.485277e-01 1 1  ON 10
 ud_1                 1.825250e-01 1 1  ON 11
 ud_2                 6.180202e-02 1 1  ON 12
 ud_3                -9.473076e-03 1 1  ON 13
 ud_4                -6.628882e-02 1 1  ON 14
 ud_5                -1.075532e-01 1 1  ON 15
 ud_6                -1.347046e-01 1 1  ON 16
 ud_7                -1.508570e-01 1 1  ON 17
 ud_8                -1.517598e-01 1 1  ON 18
 ud_9                -1.398528e-01 1 1  ON 19
 eO_0                -7.567147e-01 1 1  ON 20
 eO_1                -4.355084e-01 1 1  ON 21
 eO_2                -1.923588e-02 1 1  ON 22
 eO_3                 2.973086e-01 1 1  ON 23
 eO_4                 5.219567e-01 1 1  ON 24
 eO_5                 4.823217e-01 1 1  ON 25
 eO_6                 2.524773e-01 1 1  ON 26
 eO_7                -4.720660e-02 1 1  ON 27
 eO_8                -2.174584e-01 1 1  ON 28
 eO_9                -7.778987e-02 1 1  ON 29
eH1_0                -2.474981e-01 1 1  ON 30
eH1_1                -1.438289e-01 1 1  ON 31
eH1_2                -9.587546e-02 1 1  ON 32
eH1_3                -4.135267e-02 1 1  ON 33
eH1_4                 7.441867e-03 1 1  ON 34
eH1_5                 4.171172e-02 1 1  ON 35
eH1_6                 9.913467e-02 1 1  ON 36
eH1_7                 1.526131e-01 1 1  ON 37
eH1_8                 1.724124e-01 1 1  ON 38
eH1_9                 5.897495e-02 1 1  ON 39
eH2_0                -2.456039e-01 1 1  ON 40
eH2_1                -1.413909e-01 1 1  ON 41
eH2_2                -9.323833e-02 1 1  ON 42
eH2_3                -3.890381e-02 1 1  ON 43
eH2_4                 9.566059e-03 1 1  ON 44
eH2_5                 4.441056e-02 1 1  ON 45
eH2_6                 1.025636e-01 1 1  ON 46
eH2_7                 1.559028e-01 1 1  ON 47
eH2_8                 1.776457e-01 1 1  ON 48
eH2_9                 4.517869e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6661e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8649
    reference variance = 0.21414
====================================================
  Execution time = 2.0744e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3921e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5694e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339224068247
                                         uncertainty =       0.004136120337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339224068247
                                         uncertainty =       0.004136120337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411831266
  error estimate for blocks of size 2^( 2) =       0.000424466402
  error estimate for blocks of size 2^( 3) =       0.000437367193
  error estimate for blocks of size 2^( 4) =       0.000450292676
  error estimate for blocks of size 2^( 5) =       0.000461299541
  error estimate for blocks of size 2^( 6) =       0.000471894584
  error estimate for blocks of size 2^( 7) =       0.000480538028

      target function =                  N/A
              le_mean =     -16.905878123541
             les_mean =     286.147924940946
             stat err =       0.000466006207
             autocorr =       1.280397372199
              std dev =       0.582417361123
             le_variance =       0.339209982538


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690587812354e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905878123541       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905882401572       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905882851665       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905883473675       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905884441099       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905885088446       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905884616092       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905883942008       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905884223606       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905884597220       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905884504346       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.598084e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905878123541       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905880124762       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905880359078       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905880548245       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905880878534       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905880914846       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905880858775       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905880559051       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905880596240       residual = 1.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.991428e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905878123541       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905878763146       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905878851490       residual = 9.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905878907082       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905879016861       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905878999506       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905878993702       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905878924715       residual = 4.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 9.930040e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150184 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6321e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.107733e-01 1 1  ON 0
 uu_1                 1.437667e-01 1 1  ON 1
 uu_2                 4.216085e-02 1 1  ON 2
 uu_3                -2.026486e-02 1 1  ON 3
 uu_4                -6.559521e-02 1 1  ON 4
 uu_5                -1.003033e-01 1 1  ON 5
 uu_6                -1.276972e-01 1 1  ON 6
 uu_7                -1.407175e-01 1 1  ON 7
 uu_8                -1.330558e-01 1 1  ON 8
 uu_9                -1.026168e-01 1 1  ON 9
 ud_0                 4.486027e-01 1 1  ON 10
 ud_1                 1.825026e-01 1 1  ON 11
 ud_2                 6.184409e-02 1 1  ON 12
 ud_3                -9.438657e-03 1 1  ON 13
 ud_4                -6.637367e-02 1 1  ON 14
 ud_5                -1.075512e-01 1 1  ON 15
 ud_6                -1.348544e-01 1 1  ON 16
 ud_7                -1.508950e-01 1 1  ON 17
 ud_8                -1.516534e-01 1 1  ON 18
 ud_9                -1.398055e-01 1 1  ON 19
 eO_0                -7.566636e-01 1 1  ON 20
 eO_1                -4.355535e-01 1 1  ON 21
 eO_2                -1.933825e-02 1 1  ON 22
 eO_3                 2.973416e-01 1 1  ON 23
 eO_4                 5.220139e-01 1 1  ON 24
 eO_5                 4.825054e-01 1 1  ON 25
 eO_6                 2.525271e-01 1 1  ON 26
 eO_7                -4.712229e-02 1 1  ON 27
 eO_8                -2.176184e-01 1 1  ON 28
 eO_9                -7.793424e-02 1 1  ON 29
eH1_0                -2.476458e-01 1 1  ON 30
eH1_1                -1.439943e-01 1 1  ON 31
eH1_2                -9.597155e-02 1 1  ON 32
eH1_3                -4.146849e-02 1 1  ON 33
eH1_4                 7.372201e-03 1 1  ON 34
eH1_5                 4.147945e-02 1 1  ON 35
eH1_6                 9.922627e-02 1 1  ON 36
eH1_7                 1.526796e-01 1 1  ON 37
eH1_8                 1.726763e-01 1 1  ON 38
eH1_9                 5.932856e-02 1 1  ON 39
eH2_0                -2.456270e-01 1 1  ON 40
eH2_1                -1.416295e-01 1 1  ON 41
eH2_2                -9.354753e-02 1 1  ON 42
eH2_3                -3.900320e-02 1 1  ON 43
eH2_4                 9.509054e-03 1 1  ON 44
eH2_5                 4.425856e-02 1 1  ON 45
eH2_6                 1.026111e-01 1 1  ON 46
eH2_7                 1.560072e-01 1 1  ON 47
eH2_8                 1.779097e-01 1 1  ON 48
eH2_9                 4.557783e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9869
    reference variance = 0.414085
====================================================
  Execution time = 2.0129e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3971e-01
  Total weights = 2.0000e+06
  Execution time = 1.8982e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339566894377
                                         uncertainty =       0.003700888930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339566894377
                                         uncertainty =       0.003700888930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412087775
  error estimate for blocks of size 2^( 2) =       0.000424462627
  error estimate for blocks of size 2^( 3) =       0.000437863692
  error estimate for blocks of size 2^( 4) =       0.000449633697
  error estimate for blocks of size 2^( 5) =       0.000459041045
  error estimate for blocks of size 2^( 6) =       0.000467108917
  error estimate for blocks of size 2^( 7) =       0.000472464493

      target function =                  N/A
              le_mean =     -16.906623103478
             les_mean =     286.173537261684
             stat err =       0.000462062038
             autocorr =       1.257248474924
              std dev =       0.582780120159
             le_variance =       0.339632668453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339754539043
                                         uncertainty =       0.003704027825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339754539043
                                         uncertainty =       0.003704027825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412201669
  error estimate for blocks of size 2^( 2) =       0.000424574537
  error estimate for blocks of size 2^( 3) =       0.000437968075
  error estimate for blocks of size 2^( 4) =       0.000449727387
  error estimate for blocks of size 2^( 5) =       0.000459126184
  error estimate for blocks of size 2^( 6) =       0.000467188334
  error estimate for blocks of size 2^( 7) =       0.000472541506

      target function =                  N/A
              le_mean =     -16.906623272713
             les_mean =     286.173730747769
             stat err =       0.000462145853
             autocorr =       1.257009697936
              std dev =       0.582941191077
             le_variance =       0.339820432255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339724644924
                                         uncertainty =       0.003703777224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339724644924
                                         uncertainty =       0.003703777224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412183529
  error estimate for blocks of size 2^( 2) =       0.000424556268
  error estimate for blocks of size 2^( 3) =       0.000437951244
  error estimate for blocks of size 2^( 4) =       0.000449712538
  error estimate for blocks of size 2^( 5) =       0.000459113929
  error estimate for blocks of size 2^( 6) =       0.000467178721
  error estimate for blocks of size 2^( 7) =       0.000472532338

      target function =                  N/A
              le_mean =     -16.906623261726
             les_mean =     286.173700467946
             stat err =       0.000462134381
             autocorr =       1.257057931087
              std dev =       0.582915537553
             le_variance =       0.339790523920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339597761384
                                         uncertainty =       0.003701446188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339597761384
                                         uncertainty =       0.003701446188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412106511
  error estimate for blocks of size 2^( 2) =       0.000424480848
  error estimate for blocks of size 2^( 3) =       0.000437880819
  error estimate for blocks of size 2^( 4) =       0.000449649308
  error estimate for blocks of size 2^( 5) =       0.000459055731
  error estimate for blocks of size 2^( 6) =       0.000467123239
  error estimate for blocks of size 2^( 7) =       0.000472478358

      target function =                  N/A
              le_mean =     -16.906623076521
             les_mean =     286.173567234804
             stat err =       0.000462076659
             autocorr =       1.257213715968
              std dev =       0.582806617233
             le_variance =       0.339663553091


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906623103478        initial
     1.5625e-01     1.5625e+00             1.5981e-03       -16.906623272713  <--
     6.2500e-01     6.2500e+00             3.9914e-04       -16.906623261726
     2.5000e+00     2.5000e+01             9.9300e-05       -16.906623076521

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.9707e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.107887e-01 1 1  ON 0
 uu_1                 1.437992e-01 1 1  ON 1
 uu_2                 4.216382e-02 1 1  ON 2
 uu_3                -2.031084e-02 1 1  ON 3
 uu_4                -6.560951e-02 1 1  ON 4
 uu_5                -1.003619e-01 1 1  ON 5
 uu_6                -1.278462e-01 1 1  ON 6
 uu_7                -1.410328e-01 1 1  ON 7
 uu_8                -1.334598e-01 1 1  ON 8
 uu_9                -1.029493e-01 1 1  ON 9
 ud_0                 4.487155e-01 1 1  ON 10
 ud_1                 1.825195e-01 1 1  ON 11
 ud_2                 6.190833e-02 1 1  ON 12
 ud_3                -9.397173e-03 1 1  ON 13
 ud_4                -6.645804e-02 1 1  ON 14
 ud_5                -1.076271e-01 1 1  ON 15
 ud_6                -1.350641e-01 1 1  ON 16
 ud_7                -1.510385e-01 1 1  ON 17
 ud_8                -1.514686e-01 1 1  ON 18
 ud_9                -1.396803e-01 1 1  ON 19
 eO_0                -7.566513e-01 1 1  ON 20
 eO_1                -4.356396e-01 1 1  ON 21
 eO_2                -1.948565e-02 1 1  ON 22
 eO_3                 2.974081e-01 1 1  ON 23
 eO_4                 5.222056e-01 1 1  ON 24
 eO_5                 4.829904e-01 1 1  ON 25
 eO_6                 2.527194e-01 1 1  ON 26
 eO_7                -4.688422e-02 1 1  ON 27
 eO_8                -2.181137e-01 1 1  ON 28
 eO_9                -7.836986e-02 1 1  ON 29
eH1_0                -2.480486e-01 1 1  ON 30
eH1_1                -1.444386e-01 1 1  ON 31
eH1_2                -9.632916e-02 1 1  ON 32
eH1_3                -4.182907e-02 1 1  ON 33
eH1_4                 7.101692e-03 1 1  ON 34
eH1_5                 4.092005e-02 1 1  ON 35
eH1_6                 9.941376e-02 1 1  ON 36
eH1_7                 1.528727e-01 1 1  ON 37
eH1_8                 1.734706e-01 1 1  ON 38
eH1_9                 6.039193e-02 1 1  ON 39
eH2_0                -2.458952e-01 1 1  ON 40
eH2_1                -1.422556e-01 1 1  ON 41
eH2_2                -9.419298e-02 1 1  ON 42
eH2_3                -3.941582e-02 1 1  ON 43
eH2_4                 9.262027e-03 1 1  ON 44
eH2_5                 4.386921e-02 1 1  ON 45
eH2_6                 1.027037e-01 1 1  ON 46
eH2_7                 1.563158e-01 1 1  ON 47
eH2_8                 1.787030e-01 1 1  ON 48
eH2_9                 4.677677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6127e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.915
    reference variance = 0.488367
====================================================
  Execution time = 2.0956e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4242e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7568e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342374938078
                                         uncertainty =       0.004903324286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342374938078
                                         uncertainty =       0.004903324286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413774544
  error estimate for blocks of size 2^( 2) =       0.000426401695
  error estimate for blocks of size 2^( 3) =       0.000439620831
  error estimate for blocks of size 2^( 4) =       0.000451119346
  error estimate for blocks of size 2^( 5) =       0.000460385886
  error estimate for blocks of size 2^( 6) =       0.000468792839
  error estimate for blocks of size 2^( 7) =       0.000474498545

      target function =                  N/A
              le_mean =     -16.906009504508
             les_mean =     286.155575942003
             stat err =       0.000463699154
             autocorr =       1.255871109039
              std dev =       0.585165572041
             le_variance =       0.342418746702


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690600950451e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906009504508       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906010444800       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906012104418       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906014927973       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906016191223       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906019377741       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906021541828       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906020828093       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906023391471       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906024473777       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906023891440       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906023133401       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906024212979       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906023738236       residual = 6.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 4.502357e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906009504508       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906010106462       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906010999696       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906012851828       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906012856714       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906013660345       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906013675214       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906013780398       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906014631386       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906014564921       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906014285504       residual = 8.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.139241e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906009504508       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906009751282       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906010136197       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906010808260       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906010645611       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906010738281       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906010527134       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906010647523       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906010824650       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.897942e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155118 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6722e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.111701e-01 1 1  ON 0
 uu_1                 1.439945e-01 1 1  ON 1
 uu_2                 4.242497e-02 1 1  ON 2
 uu_3                -1.993148e-02 1 1  ON 3
 uu_4                -6.558294e-02 1 1  ON 4
 uu_5                -1.004168e-01 1 1  ON 5
 uu_6                -1.279248e-01 1 1  ON 6
 uu_7                -1.416308e-01 1 1  ON 7
 uu_8                -1.337848e-01 1 1  ON 8
 uu_9                -1.036581e-01 1 1  ON 9
 ud_0                 4.485345e-01 1 1  ON 10
 ud_1                 1.827289e-01 1 1  ON 11
 ud_2                 6.212691e-02 1 1  ON 12
 ud_3                -9.005868e-03 1 1  ON 13
 ud_4                -6.605149e-02 1 1  ON 14
 ud_5                -1.075402e-01 1 1  ON 15
 ud_6                -1.348915e-01 1 1  ON 16
 ud_7                -1.506443e-01 1 1  ON 17
 ud_8                -1.517307e-01 1 1  ON 18
 ud_9                -1.404275e-01 1 1  ON 19
 eO_0                -7.567703e-01 1 1  ON 20
 eO_1                -4.355922e-01 1 1  ON 21
 eO_2                -1.939126e-02 1 1  ON 22
 eO_3                 2.974740e-01 1 1  ON 23
 eO_4                 5.225148e-01 1 1  ON 24
 eO_5                 4.835182e-01 1 1  ON 25
 eO_6                 2.533580e-01 1 1  ON 26
 eO_7                -4.653300e-02 1 1  ON 27
 eO_8                -2.188867e-01 1 1  ON 28
 eO_9                -7.937311e-02 1 1  ON 29
eH1_0                -2.490152e-01 1 1  ON 30
eH1_1                -1.447717e-01 1 1  ON 31
eH1_2                -9.658164e-02 1 1  ON 32
eH1_3                -4.193066e-02 1 1  ON 33
eH1_4                 6.541622e-03 1 1  ON 34
eH1_5                 4.075662e-02 1 1  ON 35
eH1_6                 9.958232e-02 1 1  ON 36
eH1_7                 1.535096e-01 1 1  ON 37
eH1_8                 1.743053e-01 1 1  ON 38
eH1_9                 6.112249e-02 1 1  ON 39
eH2_0                -2.462910e-01 1 1  ON 40
eH2_1                -1.423181e-01 1 1  ON 41
eH2_2                -9.418212e-02 1 1  ON 42
eH2_3                -3.956541e-02 1 1  ON 43
eH2_4                 8.530224e-03 1 1  ON 44
eH2_5                 4.287860e-02 1 1  ON 45
eH2_6                 1.026562e-01 1 1  ON 46
eH2_7                 1.567771e-01 1 1  ON 47
eH2_8                 1.794018e-01 1 1  ON 48
eH2_9                 4.791601e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9383
    reference variance = 0.274679
====================================================
  Execution time = 2.0123e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3763e-01
  Total weights = 2.0000e+06
  Execution time = 1.9077e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338106882803
                                         uncertainty =       0.003539767691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338106882803
                                         uncertainty =       0.003539767691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411109032
  error estimate for blocks of size 2^( 2) =       0.000424218927
  error estimate for blocks of size 2^( 3) =       0.000437793031
  error estimate for blocks of size 2^( 4) =       0.000449994899
  error estimate for blocks of size 2^( 5) =       0.000460405329
  error estimate for blocks of size 2^( 6) =       0.000469261654
  error estimate for blocks of size 2^( 7) =       0.000477026334

      target function =                  N/A
              le_mean =     -16.906212801159
             les_mean =     286.158052381012
             stat err =       0.000464172054
             autocorr =       1.274805542956
              std dev =       0.581395968282
             le_variance =       0.338021271935

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337729885286
                                         uncertainty =       0.003538414923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337729885286
                                         uncertainty =       0.003538414923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410879687
  error estimate for blocks of size 2^( 2) =       0.000423996599
  error estimate for blocks of size 2^( 3) =       0.000437576268
  error estimate for blocks of size 2^( 4) =       0.000449782123
  error estimate for blocks of size 2^( 5) =       0.000460191422
  error estimate for blocks of size 2^( 6) =       0.000469049455
  error estimate for blocks of size 2^( 7) =       0.000476813341

      target function =                  N/A
              le_mean =     -16.906213032517
             les_mean =     286.157683166748
             stat err =       0.000463959085
             autocorr =       1.275058246708
              std dev =       0.581071626168
             le_variance =       0.337644234738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337328762167
                                         uncertainty =       0.003535412786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337328762167
                                         uncertainty =       0.003535412786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410635559
  error estimate for blocks of size 2^( 2) =       0.000423766938
  error estimate for blocks of size 2^( 3) =       0.000437366997
  error estimate for blocks of size 2^( 4) =       0.000449588989
  error estimate for blocks of size 2^( 5) =       0.000460009710
  error estimate for blocks of size 2^( 6) =       0.000468874824
  error estimate for blocks of size 2^( 7) =       0.000476643369

      target function =                  N/A
              le_mean =     -16.906212068477
             les_mean =     286.157249459545
             stat err =       0.000463779223
             autocorr =       1.275585193415
              std dev =       0.580726376060
             le_variance =       0.337243123851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337909349809
                                         uncertainty =       0.003538675144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337909349809
                                         uncertainty =       0.003538675144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410988882
  error estimate for blocks of size 2^( 2) =       0.000424104058
  error estimate for blocks of size 2^( 3) =       0.000437684873
  error estimate for blocks of size 2^( 4) =       0.000449891832
  error estimate for blocks of size 2^( 5) =       0.000460305156
  error estimate for blocks of size 2^( 6) =       0.000469164503
  error estimate for blocks of size 2^( 7) =       0.000476930485

      target function =                  N/A
              le_mean =     -16.906211855259
             les_mean =     286.157822848807
             stat err =       0.000464072994
             autocorr =       1.275006633131
              std dev =       0.581226051382
             le_variance =       0.337823722805


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906212801159        initial
     3.9062e-02     3.9062e-01             4.5024e-03       -16.906213032517  <--
     1.5625e-01     1.5625e+00             1.1392e-03       -16.906212068477
     6.2500e-01     6.2500e+00             2.8979e-04       -16.906211855259

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 2.9745e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.118439e-01 1 1  ON 0
 uu_1                 1.445356e-01 1 1  ON 1
 uu_2                 4.294513e-02 1 1  ON 2
 uu_3                -1.946545e-02 1 1  ON 3
 uu_4                -6.532185e-02 1 1  ON 4
 uu_5                -1.004630e-01 1 1  ON 5
 uu_6                -1.282150e-01 1 1  ON 6
 uu_7                -1.425699e-01 1 1  ON 7
 uu_8                -1.345728e-01 1 1  ON 8
 uu_9                -1.055322e-01 1 1  ON 9
 ud_0                 4.491359e-01 1 1  ON 10
 ud_1                 1.833691e-01 1 1  ON 11
 ud_2                 6.275679e-02 1 1  ON 12
 ud_3                -8.344759e-03 1 1  ON 13
 ud_4                -6.544249e-02 1 1  ON 14
 ud_5                -1.071223e-01 1 1  ON 15
 ud_6                -1.346059e-01 1 1  ON 16
 ud_7                -1.506045e-01 1 1  ON 17
 ud_8                -1.518408e-01 1 1  ON 18
 ud_9                -1.421263e-01 1 1  ON 19
 eO_0                -7.569811e-01 1 1  ON 20
 eO_1                -4.356894e-01 1 1  ON 21
 eO_2                -1.910323e-02 1 1  ON 22
 eO_3                 2.980716e-01 1 1  ON 23
 eO_4                 5.236058e-01 1 1  ON 24
 eO_5                 4.847903e-01 1 1  ON 25
 eO_6                 2.548564e-01 1 1  ON 26
 eO_7                -4.554268e-02 1 1  ON 27
 eO_8                -2.209894e-01 1 1  ON 28
 eO_9                -8.228457e-02 1 1  ON 29
eH1_0                -2.506379e-01 1 1  ON 30
eH1_1                -1.459789e-01 1 1  ON 31
eH1_2                -9.768846e-02 1 1  ON 32
eH1_3                -4.292687e-02 1 1  ON 33
eH1_4                 5.452777e-03 1 1  ON 34
eH1_5                 4.008138e-02 1 1  ON 35
eH1_6                 9.985150e-02 1 1  ON 36
eH1_7                 1.552576e-01 1 1  ON 37
eH1_8                 1.767732e-01 1 1  ON 38
eH1_9                 6.330110e-02 1 1  ON 39
eH2_0                -2.472364e-01 1 1  ON 40
eH2_1                -1.430921e-01 1 1  ON 41
eH2_2                -9.500012e-02 1 1  ON 42
eH2_3                -4.044414e-02 1 1  ON 43
eH2_4                 7.227410e-03 1 1  ON 44
eH2_5                 4.128659e-02 1 1  ON 45
eH2_6                 1.022671e-01 1 1  ON 46
eH2_7                 1.578628e-01 1 1  ON 47
eH2_8                 1.814351e-01 1 1  ON 48
eH2_9                 5.127913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6540e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.0449
    reference variance = 0.500318
====================================================
  Execution time = 2.0655e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3605e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6135e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336092071157
                                         uncertainty =       0.003657963488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336092071157
                                         uncertainty =       0.003657963488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409911244
  error estimate for blocks of size 2^( 2) =       0.000422918168
  error estimate for blocks of size 2^( 3) =       0.000437069403
  error estimate for blocks of size 2^( 4) =       0.000450200034
  error estimate for blocks of size 2^( 5) =       0.000462045787
  error estimate for blocks of size 2^( 6) =       0.000469709426
  error estimate for blocks of size 2^( 7) =       0.000475056682

      target function =                  N/A
              le_mean =     -16.905583899868
             les_mean =     286.134821283881
             stat err =       0.000464252982
             autocorr =       1.282713722830
              std dev =       0.579702041092
             le_variance =       0.336054456446


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690558389987e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905583899868       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905590076771       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905593867124       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905593226987       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905594717271       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905595367784       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905590311066       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905592247451       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905596705627       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905602076517       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905606613747       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905611377828       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905610275772       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905609109407       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905610706961       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905611871578       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905612039911       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905612947654       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905613493476       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905613017595       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905612286980       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905612554481       residual = 9.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 2.504596e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905583899868       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905588753769       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905591640353       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905591085989       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905592134621       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905592422670       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905588796582       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905591028562       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905594216962       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905595540764       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905595928442       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905596238697       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905595987397       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905595587967       residual = 9.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 6.359533e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905583899868       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905586514069       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905588194639       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905587940285       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905588507093       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905588179781       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905587324771       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905588623275       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905588784217       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905588885730       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905588882124       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905588818423       residual = 2.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.623314e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165685 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6283e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.109967e-01 1 1  ON 0
 uu_1                 1.443179e-01 1 1  ON 1
 uu_2                 4.252535e-02 1 1  ON 2
 uu_3                -2.003721e-02 1 1  ON 3
 uu_4                -6.552048e-02 1 1  ON 4
 uu_5                -1.005481e-01 1 1  ON 5
 uu_6                -1.284987e-01 1 1  ON 6
 uu_7                -1.423957e-01 1 1  ON 7
 uu_8                -1.358332e-01 1 1  ON 8
 uu_9                -1.058654e-01 1 1  ON 9
 ud_0                 4.497832e-01 1 1  ON 10
 ud_1                 1.840034e-01 1 1  ON 11
 ud_2                 6.313711e-02 1 1  ON 12
 ud_3                -8.387141e-03 1 1  ON 13
 ud_4                -6.553612e-02 1 1  ON 14
 ud_5                -1.072951e-01 1 1  ON 15
 ud_6                -1.345362e-01 1 1  ON 16
 ud_7                -1.509381e-01 1 1  ON 17
 ud_8                -1.517352e-01 1 1  ON 18
 ud_9                -1.411024e-01 1 1  ON 19
 eO_0                -7.574661e-01 1 1  ON 20
 eO_1                -4.364491e-01 1 1  ON 21
 eO_2                -1.932415e-02 1 1  ON 22
 eO_3                 2.985533e-01 1 1  ON 23
 eO_4                 5.243372e-01 1 1  ON 24
 eO_5                 4.853980e-01 1 1  ON 25
 eO_6                 2.580698e-01 1 1  ON 26
 eO_7                -4.338402e-02 1 1  ON 27
 eO_8                -2.229977e-01 1 1  ON 28
 eO_9                -8.549930e-02 1 1  ON 29
eH1_0                -2.522353e-01 1 1  ON 30
eH1_1                -1.479347e-01 1 1  ON 31
eH1_2                -1.001189e-01 1 1  ON 32
eH1_3                -4.492294e-02 1 1  ON 33
eH1_4                 4.287061e-03 1 1  ON 34
eH1_5                 3.955745e-02 1 1  ON 35
eH1_6                 9.985953e-02 1 1  ON 36
eH1_7                 1.568591e-01 1 1  ON 37
eH1_8                 1.802195e-01 1 1  ON 38
eH1_9                 6.783750e-02 1 1  ON 39
eH2_0                -2.487823e-01 1 1  ON 40
eH2_1                -1.448419e-01 1 1  ON 41
eH2_2                -9.699970e-02 1 1  ON 42
eH2_3                -4.188456e-02 1 1  ON 43
eH2_4                 6.540354e-03 1 1  ON 44
eH2_5                 4.112104e-02 1 1  ON 45
eH2_6                 9.971090e-02 1 1  ON 46
eH2_7                 1.573855e-01 1 1  ON 47
eH2_8                 1.857918e-01 1 1  ON 48
eH2_9                 5.763866e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8663
    reference variance = 0.490597
====================================================
  Execution time = 2.1412e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4248e-01
  Total weights = 2.0000e+06
  Execution time = 1.8881e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342314493200
                                         uncertainty =       0.005790811995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342314493200
                                         uncertainty =       0.005790811995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413650293
  error estimate for blocks of size 2^( 2) =       0.000426276983
  error estimate for blocks of size 2^( 3) =       0.000439443498
  error estimate for blocks of size 2^( 4) =       0.000452135526
  error estimate for blocks of size 2^( 5) =       0.000463488089
  error estimate for blocks of size 2^( 6) =       0.000470157753
  error estimate for blocks of size 2^( 7) =       0.000477538016

      target function =                  N/A
              le_mean =     -16.905079354601
             les_mean =     286.123920944294
             stat err =       0.000465829846
             autocorr =       1.268200582289
              std dev =       0.584989854654
             le_variance =       0.342213130048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342887877276
                                         uncertainty =       0.005790693142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342887877276
                                         uncertainty =       0.005790693142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413996420
  error estimate for blocks of size 2^( 2) =       0.000426619991
  error estimate for blocks of size 2^( 3) =       0.000439767006
  error estimate for blocks of size 2^( 4) =       0.000452432875
  error estimate for blocks of size 2^( 5) =       0.000463759966
  error estimate for blocks of size 2^( 6) =       0.000470398045
  error estimate for blocks of size 2^( 7) =       0.000477753264

      target function =                  N/A
              le_mean =     -16.905078606471
             les_mean =     286.124468590818
             stat err =       0.000466086038
             autocorr =       1.267473872040
              std dev =       0.585479351690
             le_variance =       0.342786071255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342880525017
                                         uncertainty =       0.005788034978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342880525017
                                         uncertainty =       0.005788034978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413991873
  error estimate for blocks of size 2^( 2) =       0.000426614035
  error estimate for blocks of size 2^( 3) =       0.000439763286
  error estimate for blocks of size 2^( 4) =       0.000452429623
  error estimate for blocks of size 2^( 5) =       0.000463769372
  error estimate for blocks of size 2^( 6) =       0.000470408867
  error estimate for blocks of size 2^( 7) =       0.000477774717

      target function =                  N/A
              le_mean =     -16.905080172220
             les_mean =     286.124513999294
             stat err =       0.000466095645
             autocorr =       1.267553965937
              std dev =       0.585472921240
             le_variance =       0.342778541505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342481524482
                                         uncertainty =       0.005789915213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342481524482
                                         uncertainty =       0.005789915213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413751113
  error estimate for blocks of size 2^( 2) =       0.000426373596
  error estimate for blocks of size 2^( 3) =       0.000439532800
  error estimate for blocks of size 2^( 4) =       0.000452215172
  error estimate for blocks of size 2^( 5) =       0.000463564533
  error estimate for blocks of size 2^( 6) =       0.000470225816
  error estimate for blocks of size 2^( 7) =       0.000477602130

      target function =                  N/A
              le_mean =     -16.905076088272
             les_mean =     286.123977346195
             stat err =       0.000465901913
             autocorr =       1.267974841150
              std dev =       0.585132435531
             le_variance =       0.342379967111


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905079354601        initial
     9.7656e-03     9.7656e-02             2.5046e-02       -16.905078606471
     3.9062e-02     3.9062e-01             6.3595e-03       -16.905080172220  <--
     1.5625e-01     1.5625e+00             1.6233e-03       -16.905076088272

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 3.0937e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.109967e-01 1 1  ON 0
 uu_1                 1.443179e-01 1 1  ON 1
 uu_2                 4.252535e-02 1 1  ON 2
 uu_3                -2.003721e-02 1 1  ON 3
 uu_4                -6.552048e-02 1 1  ON 4
 uu_5                -1.005481e-01 1 1  ON 5
 uu_6                -1.284987e-01 1 1  ON 6
 uu_7                -1.423957e-01 1 1  ON 7
 uu_8                -1.358332e-01 1 1  ON 8
 uu_9                -1.058654e-01 1 1  ON 9
 ud_0                 4.497832e-01 1 1  ON 10
 ud_1                 1.840034e-01 1 1  ON 11
 ud_2                 6.313711e-02 1 1  ON 12
 ud_3                -8.387141e-03 1 1  ON 13
 ud_4                -6.553612e-02 1 1  ON 14
 ud_5                -1.072951e-01 1 1  ON 15
 ud_6                -1.345362e-01 1 1  ON 16
 ud_7                -1.509381e-01 1 1  ON 17
 ud_8                -1.517352e-01 1 1  ON 18
 ud_9                -1.411024e-01 1 1  ON 19
 eO_0                -7.574661e-01 1 1  ON 20
 eO_1                -4.364491e-01 1 1  ON 21
 eO_2                -1.932415e-02 1 1  ON 22
 eO_3                 2.985533e-01 1 1  ON 23
 eO_4                 5.243372e-01 1 1  ON 24
 eO_5                 4.853980e-01 1 1  ON 25
 eO_6                 2.580698e-01 1 1  ON 26
 eO_7                -4.338402e-02 1 1  ON 27
 eO_8                -2.229977e-01 1 1  ON 28
 eO_9                -8.549930e-02 1 1  ON 29
eH1_0                -2.522353e-01 1 1  ON 30
eH1_1                -1.479347e-01 1 1  ON 31
eH1_2                -1.001189e-01 1 1  ON 32
eH1_3                -4.492294e-02 1 1  ON 33
eH1_4                 4.287061e-03 1 1  ON 34
eH1_5                 3.955745e-02 1 1  ON 35
eH1_6                 9.985953e-02 1 1  ON 36
eH1_7                 1.568591e-01 1 1  ON 37
eH1_8                 1.802195e-01 1 1  ON 38
eH1_9                 6.783750e-02 1 1  ON 39
eH2_0                -2.487823e-01 1 1  ON 40
eH2_1                -1.448419e-01 1 1  ON 41
eH2_2                -9.699970e-02 1 1  ON 42
eH2_3                -4.188456e-02 1 1  ON 43
eH2_4                 6.540354e-03 1 1  ON 44
eH2_5                 4.112104e-02 1 1  ON 45
eH2_6                 9.971090e-02 1 1  ON 46
eH2_7                 1.573855e-01 1 1  ON 47
eH2_8                 1.857918e-01 1 1  ON 48
eH2_9                 5.763866e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7473e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.965
    reference variance = 0.875911
====================================================
  Execution time = 2.0956e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4209e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5217e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342172820307
                                         uncertainty =       0.009188780047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342172820307
                                         uncertainty =       0.009188780047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413577359
  error estimate for blocks of size 2^( 2) =       0.000426237341
  error estimate for blocks of size 2^( 3) =       0.000438091673
  error estimate for blocks of size 2^( 4) =       0.000450412006
  error estimate for blocks of size 2^( 5) =       0.000460173314
  error estimate for blocks of size 2^( 6) =       0.000466126626
  error estimate for blocks of size 2^( 7) =       0.000470855293

      target function =                  N/A
              le_mean =     -16.906534607448
             les_mean =     286.173004725342
             stat err =       0.000461891810
             autocorr =       1.247288770794
              std dev =       0.584886710001
             le_variance =       0.342092463536


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690653460745e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906534607448       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906539560505       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906541268088       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906541814938       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906545716625       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906552991148       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906550354083       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906555193344       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906553033757       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906552457046       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906554097686       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906553857889       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906562737960       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906563600562       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906565539421       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906567066976       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906566892508       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906566914410       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906567137922       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906567969049       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906567989333       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906567422146       residual = 5.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 2.339508e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906534607448       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906538670423       residual = 6.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906539457710       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906539521875       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906542433778       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906547502416       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906545159651       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906548009762       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906545790626       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906545740217       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906546359024       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906546058160       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906547646159       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906547692483       residual = 7.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 5.844091e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906534607448       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906536971271       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906536944192       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906536483817       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906538237547       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906540467127       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906539004709       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906539759276       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906539104319       residual = 8.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906539143178       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906539241624       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906539148975       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.485836e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175613 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6491e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.117369e-01 1 1  ON 0
 uu_1                 1.448929e-01 1 1  ON 1
 uu_2                 4.309149e-02 1 1  ON 2
 uu_3                -1.928959e-02 1 1  ON 3
 uu_4                -6.515999e-02 1 1  ON 4
 uu_5                -1.003237e-01 1 1  ON 5
 uu_6                -1.287943e-01 1 1  ON 6
 uu_7                -1.436531e-01 1 1  ON 7
 uu_8                -1.372029e-01 1 1  ON 8
 uu_9                -1.085468e-01 1 1  ON 9
 ud_0                 4.509473e-01 1 1  ON 10
 ud_1                 1.850963e-01 1 1  ON 11
 ud_2                 6.431335e-02 1 1  ON 12
 ud_3                -7.279551e-03 1 1  ON 13
 ud_4                -6.466893e-02 1 1  ON 14
 ud_5                -1.065626e-01 1 1  ON 15
 ud_6                -1.343512e-01 1 1  ON 16
 ud_7                -1.515089e-01 1 1  ON 17
 ud_8                -1.540870e-01 1 1  ON 18
 ud_9                -1.435898e-01 1 1  ON 19
 eO_0                -7.567802e-01 1 1  ON 20
 eO_1                -4.355696e-01 1 1  ON 21
 eO_2                -1.815479e-02 1 1  ON 22
 eO_3                 2.986929e-01 1 1  ON 23
 eO_4                 5.247807e-01 1 1  ON 24
 eO_5                 4.878721e-01 1 1  ON 25
 eO_6                 2.599251e-01 1 1  ON 26
 eO_7                -4.263081e-02 1 1  ON 27
 eO_8                -2.266522e-01 1 1  ON 28
 eO_9                -8.953779e-02 1 1  ON 29
eH1_0                -2.539433e-01 1 1  ON 30
eH1_1                -1.495803e-01 1 1  ON 31
eH1_2                -1.012349e-01 1 1  ON 32
eH1_3                -4.597736e-02 1 1  ON 33
eH1_4                 2.961149e-03 1 1  ON 34
eH1_5                 3.806110e-02 1 1  ON 35
eH1_6                 9.835653e-02 1 1  ON 36
eH1_7                 1.569509e-01 1 1  ON 37
eH1_8                 1.833385e-01 1 1  ON 38
eH1_9                 7.368159e-02 1 1  ON 39
eH2_0                -2.498510e-01 1 1  ON 40
eH2_1                -1.457544e-01 1 1  ON 41
eH2_2                -9.768388e-02 1 1  ON 42
eH2_3                -4.302490e-02 1 1  ON 43
eH2_4                 5.764083e-03 1 1  ON 44
eH2_5                 4.120193e-02 1 1  ON 45
eH2_6                 9.891552e-02 1 1  ON 46
eH2_7                 1.561150e-01 1 1  ON 47
eH2_8                 1.882645e-01 1 1  ON 48
eH2_9                 6.205719e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.844
    reference variance = 0.26068
====================================================
  Execution time = 2.0249e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4337e-01
  Total weights = 2.0000e+06
  Execution time = 1.9028e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343487556973
                                         uncertainty =       0.006480892735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343487556973
                                         uncertainty =       0.006480892735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414352379
  error estimate for blocks of size 2^( 2) =       0.000427272848
  error estimate for blocks of size 2^( 3) =       0.000440603348
  error estimate for blocks of size 2^( 4) =       0.000453205512
  error estimate for blocks of size 2^( 5) =       0.000464991660
  error estimate for blocks of size 2^( 6) =       0.000474106857
  error estimate for blocks of size 2^( 7) =       0.000478036657

      target function =                  N/A
              le_mean =     -16.906008478636
             les_mean =     286.156498296211
             stat err =       0.000467585172
             autocorr =       1.273449673461
              std dev =       0.585982754158
             le_variance =       0.343375788171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343731566457
                                         uncertainty =       0.006525355850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343731566457
                                         uncertainty =       0.006525355850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414499306
  error estimate for blocks of size 2^( 2) =       0.000427393378
  error estimate for blocks of size 2^( 3) =       0.000440681759
  error estimate for blocks of size 2^( 4) =       0.000453242881
  error estimate for blocks of size 2^( 5) =       0.000465009174
  error estimate for blocks of size 2^( 6) =       0.000474132404
  error estimate for blocks of size 2^( 7) =       0.000478043660

      target function =                  N/A
              le_mean =     -16.906009600592
             les_mean =     286.156779792564
             stat err =       0.000467607030
             autocorr =       1.272666016687
              std dev =       0.586190539910
             le_variance =       0.343619349080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343505267010
                                         uncertainty =       0.006564115909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343505267010
                                         uncertainty =       0.006564115909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414362825
  error estimate for blocks of size 2^( 2) =       0.000427261428
  error estimate for blocks of size 2^( 3) =       0.000440562110
  error estimate for blocks of size 2^( 4) =       0.000453142373
  error estimate for blocks of size 2^( 5) =       0.000464930910
  error estimate for blocks of size 2^( 6) =       0.000474078098
  error estimate for blocks of size 2^( 7) =       0.000477988873

      target function =                  N/A
              le_mean =     -16.906013968621
             les_mean =     286.156701236197
             stat err =       0.000467535063
             autocorr =       1.273112564403
              std dev =       0.585997526188
             le_variance =       0.343393100698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343485363995
                                         uncertainty =       0.006515398304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343485363995
                                         uncertainty =       0.006515398304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414350999
  error estimate for blocks of size 2^( 2) =       0.000427266806
  error estimate for blocks of size 2^( 3) =       0.000440591734
  error estimate for blocks of size 2^( 4) =       0.000453190086
  error estimate for blocks of size 2^( 5) =       0.000464977918
  error estimate for blocks of size 2^( 6) =       0.000474100194
  error estimate for blocks of size 2^( 7) =       0.000478022843

      target function =                  N/A
              le_mean =     -16.906006579734
             les_mean =     286.156431803820
             stat err =       0.000467572760
             autocorr =       1.273390552268
              std dev =       0.585980803021
             le_variance =       0.343373501510


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906008478636        initial
     9.7656e-03     9.7656e-02             2.3395e-02       -16.906009600592
     3.9062e-02     3.9062e-01             5.8441e-03       -16.906013968621  <--
     1.5625e-01     1.5625e+00             1.4858e-03       -16.906006579734

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 3.3390e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.117369e-01 1 1  ON 0
 uu_1                 1.448929e-01 1 1  ON 1
 uu_2                 4.309149e-02 1 1  ON 2
 uu_3                -1.928959e-02 1 1  ON 3
 uu_4                -6.515999e-02 1 1  ON 4
 uu_5                -1.003237e-01 1 1  ON 5
 uu_6                -1.287943e-01 1 1  ON 6
 uu_7                -1.436531e-01 1 1  ON 7
 uu_8                -1.372029e-01 1 1  ON 8
 uu_9                -1.085468e-01 1 1  ON 9
 ud_0                 4.509473e-01 1 1  ON 10
 ud_1                 1.850963e-01 1 1  ON 11
 ud_2                 6.431335e-02 1 1  ON 12
 ud_3                -7.279551e-03 1 1  ON 13
 ud_4                -6.466893e-02 1 1  ON 14
 ud_5                -1.065626e-01 1 1  ON 15
 ud_6                -1.343512e-01 1 1  ON 16
 ud_7                -1.515089e-01 1 1  ON 17
 ud_8                -1.540870e-01 1 1  ON 18
 ud_9                -1.435898e-01 1 1  ON 19
 eO_0                -7.567802e-01 1 1  ON 20
 eO_1                -4.355696e-01 1 1  ON 21
 eO_2                -1.815479e-02 1 1  ON 22
 eO_3                 2.986929e-01 1 1  ON 23
 eO_4                 5.247807e-01 1 1  ON 24
 eO_5                 4.878721e-01 1 1  ON 25
 eO_6                 2.599251e-01 1 1  ON 26
 eO_7                -4.263081e-02 1 1  ON 27
 eO_8                -2.266522e-01 1 1  ON 28
 eO_9                -8.953779e-02 1 1  ON 29
eH1_0                -2.539433e-01 1 1  ON 30
eH1_1                -1.495803e-01 1 1  ON 31
eH1_2                -1.012349e-01 1 1  ON 32
eH1_3                -4.597736e-02 1 1  ON 33
eH1_4                 2.961149e-03 1 1  ON 34
eH1_5                 3.806110e-02 1 1  ON 35
eH1_6                 9.835653e-02 1 1  ON 36
eH1_7                 1.569509e-01 1 1  ON 37
eH1_8                 1.833385e-01 1 1  ON 38
eH1_9                 7.368159e-02 1 1  ON 39
eH2_0                -2.498510e-01 1 1  ON 40
eH2_1                -1.457544e-01 1 1  ON 41
eH2_2                -9.768388e-02 1 1  ON 42
eH2_3                -4.302490e-02 1 1  ON 43
eH2_4                 5.764083e-03 1 1  ON 44
eH2_5                 4.120193e-02 1 1  ON 45
eH2_6                 9.891552e-02 1 1  ON 46
eH2_7                 1.561150e-01 1 1  ON 47
eH2_8                 1.882645e-01 1 1  ON 48
eH2_9                 6.205719e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9959e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8853
    reference variance = 0.333558
====================================================
  Execution time = 2.0733e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3395e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5963e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334064567224
                                         uncertainty =       0.002833152354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334064567224
                                         uncertainty =       0.002833152354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408626386
  error estimate for blocks of size 2^( 2) =       0.000421225286
  error estimate for blocks of size 2^( 3) =       0.000434481279
  error estimate for blocks of size 2^( 4) =       0.000447216495
  error estimate for blocks of size 2^( 5) =       0.000457272468
  error estimate for blocks of size 2^( 6) =       0.000467139841
  error estimate for blocks of size 2^( 7) =       0.000472240454

      target function =                  N/A
              le_mean =     -16.905925122322
             les_mean =     286.144255121969
             stat err =       0.000460967315
             autocorr =       1.272586907015
              std dev =       0.577884977641
             le_variance =       0.333951047383


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690592512232e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905925122322       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905924526552       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905926713764       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905931606277       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905932539275       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905936155868       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905936129394       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905943494587       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905941432486       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905934947029       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905938509205       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905945643035       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905950321312       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905953353207       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905953584352       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905952407831       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905954249724       residual = 9.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905953416631       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905952445483       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905952719682       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 2.270032e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905925122322       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905924574389       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905926463935       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905930659734       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905930907030       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905932957125       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905932960391       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905936700752       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905935652515       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905933697773       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905932348441       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905935062095       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905936350908       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905936684139       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905936205676       residual = 5.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 5.833512e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905925122322       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905924707593       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905925935514       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905928545301       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905928299929       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905928595015       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905928506635       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905929858636       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905929730187       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905929056880       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905928816709       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905929118648       residual = 2.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.484623e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185041 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6343e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293958e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600979e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493256e-03 1 1  ON 13
 ud_4                -6.482394e-02 1 1  ON 14
 ud_5                -1.070183e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819230e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230738e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249854e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758127e-03 1 1  ON 34
eH1_5                 3.783841e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867346e-01 1 1  ON 38
eH1_9                 7.951511e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503149e-02 1 1  ON 43
eH2_4                 4.511658e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8421
    reference variance = 0.214298
====================================================
  Execution time = 2.0927e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4228e-01
  Total weights = 2.0000e+06
  Execution time = 1.8999e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341751600040
                                         uncertainty =       0.003480503481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341751600040
                                         uncertainty =       0.003480503481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413344499
  error estimate for blocks of size 2^( 2) =       0.000426145059
  error estimate for blocks of size 2^( 3) =       0.000439814538
  error estimate for blocks of size 2^( 4) =       0.000452473443
  error estimate for blocks of size 2^( 5) =       0.000463458551
  error estimate for blocks of size 2^( 6) =       0.000471835792
  error estimate for blocks of size 2^( 7) =       0.000476676207

      target function =                  N/A
              le_mean =     -16.905839795874
             les_mean =     286.149126382478
             stat err =       0.000466110998
             autocorr =       1.271611293796
              std dev =       0.584557396312
             le_variance =       0.341707349583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342619816110
                                         uncertainty =       0.003488711122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342619816110
                                         uncertainty =       0.003488711122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413868986
  error estimate for blocks of size 2^( 2) =       0.000426666215
  error estimate for blocks of size 2^( 3) =       0.000440314459
  error estimate for blocks of size 2^( 4) =       0.000452932087
  error estimate for blocks of size 2^( 5) =       0.000463866296
  error estimate for blocks of size 2^( 6) =       0.000472189431
  error estimate for blocks of size 2^( 7) =       0.000476954992

      target function =                  N/A
              le_mean =     -16.905850964907
             les_mean =     286.150371751666
             stat err =       0.000466485702
             autocorr =       1.270430486667
              std dev =       0.585299133199
             le_variance =       0.342575075324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342909835878
                                         uncertainty =       0.003489778305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342909835878
                                         uncertainty =       0.003489778305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414044000
  error estimate for blocks of size 2^( 2) =       0.000426836386
  error estimate for blocks of size 2^( 3) =       0.000440479728
  error estimate for blocks of size 2^( 4) =       0.000453096296
  error estimate for blocks of size 2^( 5) =       0.000464025836
  error estimate for blocks of size 2^( 6) =       0.000472340119
  error estimate for blocks of size 2^( 7) =       0.000477104624

      target function =                  N/A
              le_mean =     -16.905855307026
             les_mean =     286.150808358408
             stat err =       0.000466641718
             autocorr =       1.270205925956
              std dev =       0.585546640116
             le_variance =       0.342864867751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342061405997
                                         uncertainty =       0.003482809706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342061405997
                                         uncertainty =       0.003482809706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413531703
  error estimate for blocks of size 2^( 2) =       0.000426326692
  error estimate for blocks of size 2^( 3) =       0.000439986865
  error estimate for blocks of size 2^( 4) =       0.000452634207
  error estimate for blocks of size 2^( 5) =       0.000463606937
  error estimate for blocks of size 2^( 6) =       0.000471967058
  error estimate for blocks of size 2^( 7) =       0.000476791637

      target function =                  N/A
              le_mean =     -16.905842726491
             les_mean =     286.149535059974
             stat err =       0.000466249960
             autocorr =       1.271217887471
              std dev =       0.584822142298
             le_variance =       0.342016938121


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905839795874        initial
     9.7656e-03     9.7656e-02             2.2700e-02       -16.905850964907
     3.9062e-02     3.9062e-01             5.8335e-03       -16.905855307026  <--
     1.5625e-01     1.5625e+00             1.4846e-03       -16.905842726491

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 3.0518e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293958e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600979e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493256e-03 1 1  ON 13
 ud_4                -6.482394e-02 1 1  ON 14
 ud_5                -1.070183e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819230e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230738e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249854e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758127e-03 1 1  ON 34
eH1_5                 3.783841e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867346e-01 1 1  ON 38
eH1_9                 7.951511e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503149e-02 1 1  ON 43
eH2_4                 4.511658e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7194e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9085
    reference variance = 0.272652
====================================================
  Execution time = 2.0577e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3228e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7699e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332265611496
                                         uncertainty =       0.003692941388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332265611496
                                         uncertainty =       0.003692941388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407604244
  error estimate for blocks of size 2^( 2) =       0.000420254219
  error estimate for blocks of size 2^( 3) =       0.000433095838
  error estimate for blocks of size 2^( 4) =       0.000444889015
  error estimate for blocks of size 2^( 5) =       0.000455936475
  error estimate for blocks of size 2^( 6) =       0.000462974148
  error estimate for blocks of size 2^( 7) =       0.000468304659

      target function =                  N/A
              le_mean =     -16.906411703831
             les_mean =     286.159038973129
             stat err =       0.000458026074
             autocorr =       1.262708224482
              std dev =       0.576439450280
             le_variance =       0.332282439839


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690641170383e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906411703831       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906411981906       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906413537228       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906416545327       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906416596774       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906418432840       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906419169076       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906421178809       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906427108347       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906425438909       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906427148033       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906422723369       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906428304322       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906429690080       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906428686912       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906429304687       residual = 8.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906428970754       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906429763082       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906429799532       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906429297724       residual = 7.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 1.802409e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906411703831       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906411947877       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906413466463       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906416695264       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906415802935       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906415326702       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906417090555       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906417360078       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906419989168       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906418774229       residual = 9.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906417742836       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906417347728       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906418289448       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906418478292       residual = 9.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 4.566749e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906411703831       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906411867674       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906413131343       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906414064198       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906414973138       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906413736541       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906414231735       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906414230105       residual = 7.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906414398013       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906414671474       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906414343420       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.157935e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.193695 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6360e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.121018e-01 1 1  ON 0
 uu_1                 1.448802e-01 1 1  ON 1
 uu_2                 4.319720e-02 1 1  ON 2
 uu_3                -1.952930e-02 1 1  ON 3
 uu_4                -6.574980e-02 1 1  ON 4
 uu_5                -1.009636e-01 1 1  ON 5
 uu_6                -1.295403e-01 1 1  ON 6
 uu_7                -1.440830e-01 1 1  ON 7
 uu_8                -1.386135e-01 1 1  ON 8
 uu_9                -1.117120e-01 1 1  ON 9
 ud_0                 4.518559e-01 1 1  ON 10
 ud_1                 1.859023e-01 1 1  ON 11
 ud_2                 6.469202e-02 1 1  ON 12
 ud_3                -7.004464e-03 1 1  ON 13
 ud_4                -6.451461e-02 1 1  ON 14
 ud_5                -1.064695e-01 1 1  ON 15
 ud_6                -1.344589e-01 1 1  ON 16
 ud_7                -1.527858e-01 1 1  ON 17
 ud_8                -1.538513e-01 1 1  ON 18
 ud_9                -1.427188e-01 1 1  ON 19
 eO_0                -7.561450e-01 1 1  ON 20
 eO_1                -4.342463e-01 1 1  ON 21
 eO_2                -1.725861e-02 1 1  ON 22
 eO_3                 3.009081e-01 1 1  ON 23
 eO_4                 5.277198e-01 1 1  ON 24
 eO_5                 4.893485e-01 1 1  ON 25
 eO_6                 2.615443e-01 1 1  ON 26
 eO_7                -4.251897e-02 1 1  ON 27
 eO_8                -2.306536e-01 1 1  ON 28
 eO_9                -9.573535e-02 1 1  ON 29
eH1_0                -2.568257e-01 1 1  ON 30
eH1_1                -1.527065e-01 1 1  ON 31
eH1_2                -1.045551e-01 1 1  ON 32
eH1_3                -4.942659e-02 1 1  ON 33
eH1_4                 5.150737e-04 1 1  ON 34
eH1_5                 3.625689e-02 1 1  ON 35
eH1_6                 9.713267e-02 1 1  ON 36
eH1_7                 1.567148e-01 1 1  ON 37
eH1_8                 1.894915e-01 1 1  ON 38
eH1_9                 8.408185e-02 1 1  ON 39
eH2_0                -2.530095e-01 1 1  ON 40
eH2_1                -1.493399e-01 1 1  ON 41
eH2_2                -1.008975e-01 1 1  ON 42
eH2_3                -4.573283e-02 1 1  ON 43
eH2_4                 3.766592e-03 1 1  ON 44
eH2_5                 3.933861e-02 1 1  ON 45
eH2_6                 9.964523e-02 1 1  ON 46
eH2_7                 1.594264e-01 1 1  ON 47
eH2_8                 1.917301e-01 1 1  ON 48
eH2_9                 7.027621e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8778
    reference variance = 0.198015
====================================================
  Execution time = 2.0769e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.5373e-01
  Total weights = 2.0000e+06
  Execution time = 1.9024e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353526144735
                                         uncertainty =       0.008673876641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353526144735
                                         uncertainty =       0.008673876641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420536245
  error estimate for blocks of size 2^( 2) =       0.000432825304
  error estimate for blocks of size 2^( 3) =       0.000445204138
  error estimate for blocks of size 2^( 4) =       0.000457097374
  error estimate for blocks of size 2^( 5) =       0.000465625781
  error estimate for blocks of size 2^( 6) =       0.000473780211
  error estimate for blocks of size 2^( 7) =       0.000477491156

      target function =                  N/A
              le_mean =     -16.907814607518
             les_mean =     286.227896092741
             stat err =       0.000468498630
             autocorr =       1.241108600785
              std dev =       0.594728061710
             le_variance =       0.353701467386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353629685088
                                         uncertainty =       0.008662185876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353629685088
                                         uncertainty =       0.008662185876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420598764
  error estimate for blocks of size 2^( 2) =       0.000432869300
  error estimate for blocks of size 2^( 3) =       0.000445232556
  error estimate for blocks of size 2^( 4) =       0.000457113505
  error estimate for blocks of size 2^( 5) =       0.000465628953
  error estimate for blocks of size 2^( 6) =       0.000473771390
  error estimate for blocks of size 2^( 7) =       0.000477500724

      target function =                  N/A
              le_mean =     -16.907810255172
             les_mean =     286.227854088317
             stat err =       0.000468503643
             autocorr =       1.240766218034
              std dev =       0.594816476160
             le_variance =       0.353806640311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353602319592
                                         uncertainty =       0.008651489466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353602319592
                                         uncertainty =       0.008651489466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420582814
  error estimate for blocks of size 2^( 2) =       0.000432849653
  error estimate for blocks of size 2^( 3) =       0.000445217019
  error estimate for blocks of size 2^( 4) =       0.000457105656
  error estimate for blocks of size 2^( 5) =       0.000465623193
  error estimate for blocks of size 2^( 6) =       0.000473770091
  error estimate for blocks of size 2^( 7) =       0.000477512272

      target function =                  N/A
              le_mean =     -16.907812264883
             les_mean =     286.227895215311
             stat err =       0.000468502803
             autocorr =       1.240855874140
              std dev =       0.594793920334
             le_variance =       0.353779807667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353545337041
                                         uncertainty =       0.008666417532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353545337041
                                         uncertainty =       0.008666417532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420547973
  error estimate for blocks of size 2^( 2) =       0.000432830459
  error estimate for blocks of size 2^( 3) =       0.000445206036
  error estimate for blocks of size 2^( 4) =       0.000457097966
  error estimate for blocks of size 2^( 5) =       0.000465621148
  error estimate for blocks of size 2^( 6) =       0.000473771932
  error estimate for blocks of size 2^( 7) =       0.000477491679

      target function =                  N/A
              le_mean =     -16.907812383276
             les_mean =     286.227840607177
             stat err =       0.000468495681
             autocorr =       1.241023755106
              std dev =       0.594744647698
             le_variance =       0.353721195966


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907814607518        initial  <--
     9.7656e-03     9.7656e-02             1.8024e-02       -16.907810255172
     3.9062e-02     3.9062e-01             4.5667e-03       -16.907812264883
     1.5625e-01     1.5625e+00             1.1579e-03       -16.907812383276

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3768
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293958e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600979e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493256e-03 1 1  ON 13
 ud_4                -6.482394e-02 1 1  ON 14
 ud_5                -1.070183e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819230e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230738e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249854e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758127e-03 1 1  ON 34
eH1_5                 3.783841e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867346e-01 1 1  ON 38
eH1_9                 7.951511e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503149e-02 1 1  ON 43
eH2_4                 4.511658e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6933e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9123
    reference variance = 0.185054
====================================================
  Execution time = 2.0849e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3192e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5742e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332014961315
                                         uncertainty =       0.002786263726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332014961315
                                         uncertainty =       0.002786263726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407382996
  error estimate for blocks of size 2^( 2) =       0.000420199394
  error estimate for blocks of size 2^( 3) =       0.000433220075
  error estimate for blocks of size 2^( 4) =       0.000444999540
  error estimate for blocks of size 2^( 5) =       0.000455812523
  error estimate for blocks of size 2^( 6) =       0.000465832698
  error estimate for blocks of size 2^( 7) =       0.000472089476

      target function =                  N/A
              le_mean =     -16.905778156646
             les_mean =     286.137256726264
             stat err =       0.000459683559
             autocorr =       1.273245493243
              std dev =       0.576126557699
             le_variance =       0.331921810486


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690577815665e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905778156646       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905778827534       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905779840990       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905779562144       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905778208701       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905780289594       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905779772856       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905780668330       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905780859847       residual = 9.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905781279165       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905780801734       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905780805547       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 2.212566e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905778156646       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905778538661       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905779087519       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905779102545       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905778735084       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905778514865       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905778963014       residual = 8.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905778793385       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905779062914       residual = 8.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 5.439967e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905778156646       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905778296973       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905778499966       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905778528585       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905778543302       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905778366449       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905778407109       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905778402294       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.354594e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.197307 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6431e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.116788e-01 1 1  ON 0
 uu_1                 1.446437e-01 1 1  ON 1
 uu_2                 4.281584e-02 1 1  ON 2
 uu_3                -1.983278e-02 1 1  ON 3
 uu_4                -6.580953e-02 1 1  ON 4
 uu_5                -1.015396e-01 1 1  ON 5
 uu_6                -1.294649e-01 1 1  ON 6
 uu_7                -1.443555e-01 1 1  ON 7
 uu_8                -1.379692e-01 1 1  ON 8
 uu_9                -1.087437e-01 1 1  ON 9
 ud_0                 4.512692e-01 1 1  ON 10
 ud_1                 1.852265e-01 1 1  ON 11
 ud_2                 6.416685e-02 1 1  ON 12
 ud_3                -7.417955e-03 1 1  ON 13
 ud_4                -6.485586e-02 1 1  ON 14
 ud_5                -1.070482e-01 1 1  ON 15
 ud_6                -1.350998e-01 1 1  ON 16
 ud_7                -1.520384e-01 1 1  ON 17
 ud_8                -1.536960e-01 1 1  ON 18
 ud_9                -1.417657e-01 1 1  ON 19
 eO_0                -7.570839e-01 1 1  ON 20
 eO_1                -4.351513e-01 1 1  ON 21
 eO_2                -1.815479e-02 1 1  ON 22
 eO_3                 2.998881e-01 1 1  ON 23
 eO_4                 5.271298e-01 1 1  ON 24
 eO_5                 4.892376e-01 1 1  ON 25
 eO_6                 2.600689e-01 1 1  ON 26
 eO_7                -4.223751e-02 1 1  ON 27
 eO_8                -2.285422e-01 1 1  ON 28
 eO_9                -9.277468e-02 1 1  ON 29
eH1_0                -2.551998e-01 1 1  ON 30
eH1_1                -1.520008e-01 1 1  ON 31
eH1_2                -1.033260e-01 1 1  ON 32
eH1_3                -4.848123e-02 1 1  ON 33
eH1_4                 1.426325e-03 1 1  ON 34
eH1_5                 3.752881e-02 1 1  ON 35
eH1_6                 9.734681e-02 1 1  ON 36
eH1_7                 1.565871e-01 1 1  ON 37
eH1_8                 1.871108e-01 1 1  ON 38
eH1_9                 8.004385e-02 1 1  ON 39
eH2_0                -2.517706e-01 1 1  ON 40
eH2_1                -1.478633e-01 1 1  ON 41
eH2_2                -9.976492e-02 1 1  ON 42
eH2_3                -4.506779e-02 1 1  ON 43
eH2_4                 4.368775e-03 1 1  ON 44
eH2_5                 3.984935e-02 1 1  ON 45
eH2_6                 9.835212e-02 1 1  ON 46
eH2_7                 1.587621e-01 1 1  ON 47
eH2_8                 1.914127e-01 1 1  ON 48
eH2_9                 6.745654e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9502
    reference variance = 0.292465
====================================================
  Execution time = 2.0510e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4718e-01
  Total weights = 2.0000e+06
  Execution time = 1.8908e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347114424593
                                         uncertainty =       0.006060082742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347114424593
                                         uncertainty =       0.006060082742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416611095
  error estimate for blocks of size 2^( 2) =       0.000429005365
  error estimate for blocks of size 2^( 3) =       0.000441996921
  error estimate for blocks of size 2^( 4) =       0.000453104962
  error estimate for blocks of size 2^( 5) =       0.000462998898
  error estimate for blocks of size 2^( 6) =       0.000471098370
  error estimate for blocks of size 2^( 7) =       0.000473551749

      target function =                  N/A
              le_mean =     -16.906239749659
             les_mean =     286.168071909011
             stat err =       0.000465188495
             autocorr =       1.246798485940
              std dev =       0.589177061344
             le_variance =       0.347129609614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347161343641
                                         uncertainty =       0.006061096138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347161343641
                                         uncertainty =       0.006061096138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416639155
  error estimate for blocks of size 2^( 2) =       0.000429034972
  error estimate for blocks of size 2^( 3) =       0.000442028380
  error estimate for blocks of size 2^( 4) =       0.000453142212
  error estimate for blocks of size 2^( 5) =       0.000463030660
  error estimate for blocks of size 2^( 6) =       0.000471114127
  error estimate for blocks of size 2^( 7) =       0.000473571174

      target function =                  N/A
              le_mean =     -16.906239545671
             les_mean =     286.168111773007
             stat err =       0.000465214543
             autocorr =       1.246770169613
              std dev =       0.589216743654
             le_variance =       0.347176371002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347229513287
                                         uncertainty =       0.006061847902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347229513287
                                         uncertainty =       0.006061847902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416680065
  error estimate for blocks of size 2^( 2) =       0.000429073600
  error estimate for blocks of size 2^( 3) =       0.000442064897
  error estimate for blocks of size 2^( 4) =       0.000453177799
  error estimate for blocks of size 2^( 5) =       0.000463066545
  error estimate for blocks of size 2^( 6) =       0.000471148368
  error estimate for blocks of size 2^( 7) =       0.000473606539

      target function =                  N/A
              le_mean =     -16.906239742476
             les_mean =     286.168186609208
             stat err =       0.000465249813
             autocorr =       1.246714378607
              std dev =       0.589274598757
             le_variance =       0.347244552740

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347138979894
                                         uncertainty =       0.006060201392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347138979894
                                         uncertainty =       0.006060201392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416625818
  error estimate for blocks of size 2^( 2) =       0.000429019700
  error estimate for blocks of size 2^( 3) =       0.000442010913
  error estimate for blocks of size 2^( 4) =       0.000453119649
  error estimate for blocks of size 2^( 5) =       0.000463012609
  error estimate for blocks of size 2^( 6) =       0.000471108826
  error estimate for blocks of size 2^( 7) =       0.000473563366

      target function =                  N/A
              le_mean =     -16.906239526401
             les_mean =     286.168088895749
             stat err =       0.000465201113
             autocorr =       1.246777998657
              std dev =       0.589197882946
             le_variance =       0.347154145268


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906239749659        initial  <--
     9.7656e-02     9.7656e-01             2.2126e-03       -16.906239545671
     3.9062e-01     3.9062e+00             5.4400e-04       -16.906239742476
     1.5625e+00     1.5625e+01             1.3546e-04       -16.906239526401

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0513
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293958e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600979e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493256e-03 1 1  ON 13
 ud_4                -6.482394e-02 1 1  ON 14
 ud_5                -1.070183e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819230e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230738e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249854e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758127e-03 1 1  ON 34
eH1_5                 3.783841e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867346e-01 1 1  ON 38
eH1_9                 7.951511e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503149e-02 1 1  ON 43
eH2_4                 4.511658e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6704e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8396
    reference variance = 0.323788
====================================================
  Execution time = 2.1080e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3607e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5443e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336138050649
                                         uncertainty =       0.003241859776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336138050649
                                         uncertainty =       0.003241859776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409923179
  error estimate for blocks of size 2^( 2) =       0.000422821603
  error estimate for blocks of size 2^( 3) =       0.000436359844
  error estimate for blocks of size 2^( 4) =       0.000448532246
  error estimate for blocks of size 2^( 5) =       0.000460018530
  error estimate for blocks of size 2^( 6) =       0.000468528954
  error estimate for blocks of size 2^( 7) =       0.000475286187

      target function =                  N/A
              le_mean =     -16.905398373609
             les_mean =     286.128568027409
             stat err =       0.000463091479
             autocorr =       1.276229057960
              std dev =       0.579718918972
             le_variance =       0.336074025014


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690539837361e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905398373609       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905398803771       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905398999502       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905398675192       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905398793143       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905398719963       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905398982331       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905398843724       residual = 9.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.460611e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905398373609       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905398490109       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905398551504       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905398467126       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905398509796       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905398482219       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905398524745       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905398497398       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 6.934423e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905398373609       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905398403354       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905398419736       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905398398578       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905398410484       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905398402998       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905398411625       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905398405189       residual = 4.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.793264e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199959 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6631e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.116019e-01 1 1  ON 0
 uu_1                 1.445871e-01 1 1  ON 1
 uu_2                 4.294947e-02 1 1  ON 2
 uu_3                -1.980893e-02 1 1  ON 3
 uu_4                -6.600469e-02 1 1  ON 4
 uu_5                -1.015484e-01 1 1  ON 5
 uu_6                -1.293969e-01 1 1  ON 6
 uu_7                -1.441191e-01 1 1  ON 7
 uu_8                -1.378836e-01 1 1  ON 8
 uu_9                -1.087674e-01 1 1  ON 9
 ud_0                 4.513435e-01 1 1  ON 10
 ud_1                 1.852486e-01 1 1  ON 11
 ud_2                 6.421929e-02 1 1  ON 12
 ud_3                -7.508536e-03 1 1  ON 13
 ud_4                -6.481903e-02 1 1  ON 14
 ud_5                -1.070230e-01 1 1  ON 15
 ud_6                -1.352768e-01 1 1  ON 16
 ud_7                -1.520848e-01 1 1  ON 17
 ud_8                -1.537377e-01 1 1  ON 18
 ud_9                -1.418021e-01 1 1  ON 19
 eO_0                -7.569820e-01 1 1  ON 20
 eO_1                -4.354450e-01 1 1  ON 21
 eO_2                -1.819157e-02 1 1  ON 22
 eO_3                 2.998534e-01 1 1  ON 23
 eO_4                 5.270125e-01 1 1  ON 24
 eO_5                 4.892396e-01 1 1  ON 25
 eO_6                 2.599768e-01 1 1  ON 26
 eO_7                -4.230633e-02 1 1  ON 27
 eO_8                -2.283122e-01 1 1  ON 28
 eO_9                -9.252403e-02 1 1  ON 29
eH1_0                -2.550077e-01 1 1  ON 30
eH1_1                -1.518924e-01 1 1  ON 31
eH1_2                -1.033048e-01 1 1  ON 32
eH1_3                -4.825982e-02 1 1  ON 33
eH1_4                 1.743020e-03 1 1  ON 34
eH1_5                 3.781884e-02 1 1  ON 35
eH1_6                 9.720898e-02 1 1  ON 36
eH1_7                 1.565157e-01 1 1  ON 37
eH1_8                 1.867521e-01 1 1  ON 38
eH1_9                 7.954713e-02 1 1  ON 39
eH2_0                -2.516377e-01 1 1  ON 40
eH2_1                -1.477876e-01 1 1  ON 41
eH2_2                -9.982240e-02 1 1  ON 42
eH2_3                -4.500535e-02 1 1  ON 43
eH2_4                 4.510216e-03 1 1  ON 44
eH2_5                 4.012217e-02 1 1  ON 45
eH2_6                 9.842380e-02 1 1  ON 46
eH2_7                 1.587440e-01 1 1  ON 47
eH2_8                 1.912478e-01 1 1  ON 48
eH2_9                 6.697369e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9134
    reference variance = 0.31798
====================================================
  Execution time = 2.1389e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3665e-01
  Total weights = 2.0000e+06
  Execution time = 1.9066e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336714246241
                                         uncertainty =       0.004061786582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336714246241
                                         uncertainty =       0.004061786582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410263953
  error estimate for blocks of size 2^( 2) =       0.000422705502
  error estimate for blocks of size 2^( 3) =       0.000435994969
  error estimate for blocks of size 2^( 4) =       0.000448649586
  error estimate for blocks of size 2^( 5) =       0.000458901057
  error estimate for blocks of size 2^( 6) =       0.000465032889
  error estimate for blocks of size 2^( 7) =       0.000470453343

      target function =                  N/A
              le_mean =     -16.906275035661
             les_mean =     286.158768434745
             stat err =       0.000460759219
             autocorr =       1.261308569970
              std dev =       0.580200845961
             le_variance =       0.336633021654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336762613693
                                         uncertainty =       0.004061910987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336762613693
                                         uncertainty =       0.004061910987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410293424
  error estimate for blocks of size 2^( 2) =       0.000422733832
  error estimate for blocks of size 2^( 3) =       0.000436022752
  error estimate for blocks of size 2^( 4) =       0.000448676973
  error estimate for blocks of size 2^( 5) =       0.000458927672
  error estimate for blocks of size 2^( 6) =       0.000465058020
  error estimate for blocks of size 2^( 7) =       0.000470476163

      target function =                  N/A
              le_mean =     -16.906274990695
             les_mean =     286.158815279642
             stat err =       0.000460784707
             autocorr =       1.261266907688
              std dev =       0.580242524290
             le_variance =       0.336681386994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336749016281
                                         uncertainty =       0.004061889465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336749016281
                                         uncertainty =       0.004061889465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410285138
  error estimate for blocks of size 2^( 2) =       0.000422725798
  error estimate for blocks of size 2^( 3) =       0.000436014755
  error estimate for blocks of size 2^( 4) =       0.000448669067
  error estimate for blocks of size 2^( 5) =       0.000458919997
  error estimate for blocks of size 2^( 6) =       0.000465051166
  error estimate for blocks of size 2^( 7) =       0.000470470652

      target function =                  N/A
              le_mean =     -16.906274954432
             les_mean =     286.158800455593
             stat err =       0.000460777721
             autocorr =       1.261279604027
              std dev =       0.580230806715
             le_variance =       0.336667789062

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336719018760
                                         uncertainty =       0.004061801083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336719018760
                                         uncertainty =       0.004061801083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410266861
  error estimate for blocks of size 2^( 2) =       0.000422708284
  error estimate for blocks of size 2^( 3) =       0.000435997678
  error estimate for blocks of size 2^( 4) =       0.000448652252
  error estimate for blocks of size 2^( 5) =       0.000458903648
  error estimate for blocks of size 2^( 6) =       0.000465035401
  error estimate for blocks of size 2^( 7) =       0.000470455744

      target function =                  N/A
              le_mean =     -16.906275019232
             les_mean =     286.158772651367
             stat err =       0.000460761761
             autocorr =       1.261304609678
              std dev =       0.580204958428
             le_variance =       0.336637793785


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906275035661        initial  <--
     9.7656e-01     9.7656e+00             2.4606e-04       -16.906274990695
     3.9062e+00     3.9062e+01             6.9344e-05       -16.906274954432
     1.5625e+01     1.5625e+02             1.7933e-05       -16.906275019232

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0252
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293958e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600979e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493256e-03 1 1  ON 13
 ud_4                -6.482394e-02 1 1  ON 14
 ud_5                -1.070183e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819230e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230738e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249854e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758127e-03 1 1  ON 34
eH1_5                 3.783841e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867346e-01 1 1  ON 38
eH1_9                 7.951511e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503149e-02 1 1  ON 43
eH2_4                 4.511658e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7664e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8788
    reference variance = 0.27346
====================================================
  Execution time = 2.0817e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3604e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6640e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336060399869
                                         uncertainty =       0.002892821698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336060399869
                                         uncertainty =       0.002892821698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409900768
  error estimate for blocks of size 2^( 2) =       0.000422356500
  error estimate for blocks of size 2^( 3) =       0.000435056747
  error estimate for blocks of size 2^( 4) =       0.000446254400
  error estimate for blocks of size 2^( 5) =       0.000457203767
  error estimate for blocks of size 2^( 6) =       0.000463446598
  error estimate for blocks of size 2^( 7) =       0.000468812396

      target function =                  N/A
              le_mean =     -16.905916211342
             les_mean =     286.146040056202
             stat err =       0.000458929290
             autocorr =       1.253528142489
              std dev =       0.579687225406
             le_variance =       0.336037279299


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690591621134e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905916211342       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905916217440       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905916212639       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905916194912       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905916213713       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905916231318       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905916228142       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905916229458       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.041835e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905916211342       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905916212889       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905916211642       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905916207308       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905916212193       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905916216504       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905916215717       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905916215833       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 5.107102e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905916211342       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905916211730       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905916211416       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905916210339       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905916211572       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905916212644       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905916212448       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905916212464       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.276926e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.202589 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6490e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.115738e-01 1 1  ON 0
 uu_1                 1.445854e-01 1 1  ON 1
 uu_2                 4.293938e-02 1 1  ON 2
 uu_3                -1.978153e-02 1 1  ON 3
 uu_4                -6.600831e-02 1 1  ON 4
 uu_5                -1.015331e-01 1 1  ON 5
 uu_6                -1.293705e-01 1 1  ON 6
 uu_7                -1.441030e-01 1 1  ON 7
 uu_8                -1.378697e-01 1 1  ON 8
 uu_9                -1.087628e-01 1 1  ON 9
 ud_0                 4.513461e-01 1 1  ON 10
 ud_1                 1.852767e-01 1 1  ON 11
 ud_2                 6.423751e-02 1 1  ON 12
 ud_3                -7.491764e-03 1 1  ON 13
 ud_4                -6.482353e-02 1 1  ON 14
 ud_5                -1.070192e-01 1 1  ON 15
 ud_6                -1.352759e-01 1 1  ON 16
 ud_7                -1.521025e-01 1 1  ON 17
 ud_8                -1.537735e-01 1 1  ON 18
 ud_9                -1.418167e-01 1 1  ON 19
 eO_0                -7.569951e-01 1 1  ON 20
 eO_1                -4.354238e-01 1 1  ON 21
 eO_2                -1.819381e-02 1 1  ON 22
 eO_3                 2.998449e-01 1 1  ON 23
 eO_4                 5.270155e-01 1 1  ON 24
 eO_5                 4.892165e-01 1 1  ON 25
 eO_6                 2.599658e-01 1 1  ON 26
 eO_7                -4.230663e-02 1 1  ON 27
 eO_8                -2.283039e-01 1 1  ON 28
 eO_9                -9.250270e-02 1 1  ON 29
eH1_0                -2.549684e-01 1 1  ON 30
eH1_1                -1.518829e-01 1 1  ON 31
eH1_2                -1.032904e-01 1 1  ON 32
eH1_3                -4.827880e-02 1 1  ON 33
eH1_4                 1.757327e-03 1 1  ON 34
eH1_5                 3.783479e-02 1 1  ON 35
eH1_6                 9.718617e-02 1 1  ON 36
eH1_7                 1.565111e-01 1 1  ON 37
eH1_8                 1.867370e-01 1 1  ON 38
eH1_9                 7.951954e-02 1 1  ON 39
eH2_0                -2.516194e-01 1 1  ON 40
eH2_1                -1.477215e-01 1 1  ON 41
eH2_2                -9.980734e-02 1 1  ON 42
eH2_3                -4.502853e-02 1 1  ON 43
eH2_4                 4.509201e-03 1 1  ON 44
eH2_5                 4.016055e-02 1 1  ON 45
eH2_6                 9.843361e-02 1 1  ON 46
eH2_7                 1.587311e-01 1 1  ON 47
eH2_8                 1.912091e-01 1 1  ON 48
eH2_9                 6.691765e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8961
    reference variance = 0.249249
====================================================
  Execution time = 2.0090e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5231e-01
  Total weights = 2.0000e+06
  Execution time = 1.9010e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352408253387
                                         uncertainty =       0.009972474245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352408253387
                                         uncertainty =       0.009972474245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419705610
  error estimate for blocks of size 2^( 2) =       0.000432268106
  error estimate for blocks of size 2^( 3) =       0.000445412784
  error estimate for blocks of size 2^( 4) =       0.000457235979
  error estimate for blocks of size 2^( 5) =       0.000469479148
  error estimate for blocks of size 2^( 6) =       0.000479294138
  error estimate for blocks of size 2^( 7) =       0.000485842692

      target function =                  N/A
              le_mean =     -16.906023303032
             les_mean =     286.165929344765
             stat err =       0.000472962989
             autocorr =       1.269886090264
              std dev =       0.593553365965
             le_variance =       0.352305598248

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352407696631
                                         uncertainty =       0.009972829269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352407696631
                                         uncertainty =       0.009972829269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419705282
  error estimate for blocks of size 2^( 2) =       0.000432267632
  error estimate for blocks of size 2^( 3) =       0.000445412274
  error estimate for blocks of size 2^( 4) =       0.000457235382
  error estimate for blocks of size 2^( 5) =       0.000469478699
  error estimate for blocks of size 2^( 6) =       0.000479294151
  error estimate for blocks of size 2^( 7) =       0.000485842360

      target function =                  N/A
              le_mean =     -16.906023276053
             les_mean =     286.165927881419
             stat err =       0.000472962648
             autocorr =       1.269886243313
              std dev =       0.593552901713
             le_variance =       0.352305047131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352407985428
                                         uncertainty =       0.009972647038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352407985428
                                         uncertainty =       0.009972647038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419705452
  error estimate for blocks of size 2^( 2) =       0.000432267874
  error estimate for blocks of size 2^( 3) =       0.000445412533
  error estimate for blocks of size 2^( 4) =       0.000457235684
  error estimate for blocks of size 2^( 5) =       0.000469478928
  error estimate for blocks of size 2^( 6) =       0.000479294153
  error estimate for blocks of size 2^( 7) =       0.000485842531

      target function =                  N/A
              le_mean =     -16.906023289508
             les_mean =     286.165928622398
             stat err =       0.000472962824
             autocorr =       1.269886156959
              std dev =       0.593553142673
             le_variance =       0.352305333177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352408220138
                                         uncertainty =       0.009972495662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352408220138
                                         uncertainty =       0.009972495662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419705590
  error estimate for blocks of size 2^( 2) =       0.000432268077
  error estimate for blocks of size 2^( 3) =       0.000445412753
  error estimate for blocks of size 2^( 4) =       0.000457235942
  error estimate for blocks of size 2^( 5) =       0.000469479121
  error estimate for blocks of size 2^( 6) =       0.000479294140
  error estimate for blocks of size 2^( 7) =       0.000485842672

      target function =                  N/A
              le_mean =     -16.906023301322
             les_mean =     286.165929254043
             stat err =       0.000472962969
             autocorr =       1.269886098226
              std dev =       0.593553338263
             le_variance =       0.352305565363


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906023303032        initial  <--
     9.7656e+00     9.7656e+01             2.0418e-05       -16.906023276053
     3.9062e+01     3.9062e+02             5.1071e-06       -16.906023289508
     1.5625e+02     1.5625e+03             1.2769e-06       -16.906023301322

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6773
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293958e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600979e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493256e-03 1 1  ON 13
 ud_4                -6.482394e-02 1 1  ON 14
 ud_5                -1.070183e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819230e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230738e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249854e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758127e-03 1 1  ON 34
eH1_5                 3.783841e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867346e-01 1 1  ON 38
eH1_9                 7.951511e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503149e-02 1 1  ON 43
eH2_4                 4.511658e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6196e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9424
    reference variance = 0.172689
====================================================
  Execution time = 2.3456e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3844e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6062e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338492248085
                                         uncertainty =       0.003404931146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338492248085
                                         uncertainty =       0.003404931146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411364966
  error estimate for blocks of size 2^( 2) =       0.000423806195
  error estimate for blocks of size 2^( 3) =       0.000436968012
  error estimate for blocks of size 2^( 4) =       0.000448529006
  error estimate for blocks of size 2^( 5) =       0.000459271975
  error estimate for blocks of size 2^( 6) =       0.000464486997
  error estimate for blocks of size 2^( 7) =       0.000469419069

      target function =                  N/A
              le_mean =     -16.906679945481
             les_mean =     286.174268880563
             stat err =       0.000460426762
             autocorr =       1.252756060690
              std dev =       0.581757914291
             le_variance =       0.338442270840


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690667994548e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906679945481       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906679951316       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906679952374       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906679954347       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906679961690       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906679961070       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906679961080       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906679960593       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.497308e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906679945481       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906679946941       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906679947206       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906679947701       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906679949537       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906679949383       residual = 8.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906679949384       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906679949263       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 6.246199e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906679945481       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906679945846       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906679945913       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906679946036       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906679946496       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906679946458       residual = 8.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906679946458       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906679946427       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.561733e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.205216 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9069e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293962e-02 1 1  ON 2
 uu_3                -1.978119e-02 1 1  ON 3
 uu_4                -6.600962e-02 1 1  ON 4
 uu_5                -1.015323e-01 1 1  ON 5
 uu_6                -1.293718e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378686e-01 1 1  ON 8
 uu_9                -1.087595e-01 1 1  ON 9
 ud_0                 4.513448e-01 1 1  ON 10
 ud_1                 1.852764e-01 1 1  ON 11
 ud_2                 6.423637e-02 1 1  ON 12
 ud_3                -7.492958e-03 1 1  ON 13
 ud_4                -6.482380e-02 1 1  ON 14
 ud_5                -1.070184e-01 1 1  ON 15
 ud_6                -1.352784e-01 1 1  ON 16
 ud_7                -1.521020e-01 1 1  ON 17
 ud_8                -1.537717e-01 1 1  ON 18
 ud_9                -1.418144e-01 1 1  ON 19
 eO_0                -7.569956e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819237e-02 1 1  ON 22
 eO_3                 2.998421e-01 1 1  ON 23
 eO_4                 5.270159e-01 1 1  ON 24
 eO_5                 4.892157e-01 1 1  ON 25
 eO_6                 2.599632e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283007e-01 1 1  ON 28
 eO_9                -9.249888e-02 1 1  ON 29
eH1_0                -2.549663e-01 1 1  ON 30
eH1_1                -1.518819e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827968e-02 1 1  ON 33
eH1_4                 1.757958e-03 1 1  ON 34
eH1_5                 3.783815e-02 1 1  ON 35
eH1_6                 9.718763e-02 1 1  ON 36
eH1_7                 1.565091e-01 1 1  ON 37
eH1_8                 1.867350e-01 1 1  ON 38
eH1_9                 7.951545e-02 1 1  ON 39
eH2_0                -2.516179e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980454e-02 1 1  ON 42
eH2_3                -4.503154e-02 1 1  ON 43
eH2_4                 4.511358e-03 1 1  ON 44
eH2_5                 4.015938e-02 1 1  ON 45
eH2_6                 9.843158e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912080e-01 1 1  ON 48
eH2_9                 6.691292e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9694
    reference variance = 0.224351
====================================================
  Execution time = 2.0310e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4156e-01
  Total weights = 2.0000e+06
  Execution time = 1.8972e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341521697961
                                         uncertainty =       0.005534210648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341521697961
                                         uncertainty =       0.005534210648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413253000
  error estimate for blocks of size 2^( 2) =       0.000426347936
  error estimate for blocks of size 2^( 3) =       0.000439943804
  error estimate for blocks of size 2^( 4) =       0.000452599318
  error estimate for blocks of size 2^( 5) =       0.000464204644
  error estimate for blocks of size 2^( 6) =       0.000473847591
  error estimate for blocks of size 2^( 7) =       0.000478169627

      target function =                  N/A
              le_mean =     -16.905997426278
             les_mean =     286.154304890460
             stat err =       0.000467205295
             autocorr =       1.278154879797
              std dev =       0.584427997204
             le_variance =       0.341556083915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341519713271
                                         uncertainty =       0.005534177145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341519713271
                                         uncertainty =       0.005534177145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413251799
  error estimate for blocks of size 2^( 2) =       0.000426346801
  error estimate for blocks of size 2^( 3) =       0.000439942729
  error estimate for blocks of size 2^( 4) =       0.000452598284
  error estimate for blocks of size 2^( 5) =       0.000464203656
  error estimate for blocks of size 2^( 6) =       0.000473846635
  error estimate for blocks of size 2^( 7) =       0.000478168699

      target function =                  N/A
              le_mean =     -16.905997425264
             les_mean =     286.154302871543
             stat err =       0.000467204319
             autocorr =       1.278156964104
              std dev =       0.584426299273
             le_variance =       0.341554099282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341520703219
                                         uncertainty =       0.005534193856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341520703219
                                         uncertainty =       0.005534193856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413252398
  error estimate for blocks of size 2^( 2) =       0.000426347367
  error estimate for blocks of size 2^( 3) =       0.000439943266
  error estimate for blocks of size 2^( 4) =       0.000452598799
  error estimate for blocks of size 2^( 5) =       0.000464204149
  error estimate for blocks of size 2^( 6) =       0.000473847112
  error estimate for blocks of size 2^( 7) =       0.000478169162

      target function =                  N/A
              le_mean =     -16.905997425764
             les_mean =     286.154303878379
             stat err =       0.000467204806
             autocorr =       1.278155924488
              std dev =       0.584427146187
             le_variance =       0.341555089200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341521573542
                                         uncertainty =       0.005534208548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341521573542
                                         uncertainty =       0.005534208548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413252925
  error estimate for blocks of size 2^( 2) =       0.000426347865
  error estimate for blocks of size 2^( 3) =       0.000439943737
  error estimate for blocks of size 2^( 4) =       0.000452599253
  error estimate for blocks of size 2^( 5) =       0.000464204582
  error estimate for blocks of size 2^( 6) =       0.000473847531
  error estimate for blocks of size 2^( 7) =       0.000478169569

      target function =                  N/A
              le_mean =     -16.905997426213
             les_mean =     286.154304763858
             stat err =       0.000467205234
             autocorr =       1.278155010450
              std dev =       0.584427890761
             le_variance =       0.341555959499


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905997426278        initial  <--
     9.7656e+01     9.7656e+02             2.4973e-06       -16.905997425264
     3.9062e+02     3.9062e+03             6.2462e-07       -16.905997425764
     1.5625e+03     1.5625e+04             1.5617e-07       -16.905997426213

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8662
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293958e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600979e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493256e-03 1 1  ON 13
 ud_4                -6.482394e-02 1 1  ON 14
 ud_5                -1.070183e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819230e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230738e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249854e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758127e-03 1 1  ON 34
eH1_5                 3.783841e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867346e-01 1 1  ON 38
eH1_9                 7.951511e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503149e-02 1 1  ON 43
eH2_4                 4.511658e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9020e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8988
    reference variance = 0.561695
====================================================
  Execution time = 2.1710e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4424e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5557e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344313910632
                                         uncertainty =       0.007398123635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344313910632
                                         uncertainty =       0.007398123635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414870744
  error estimate for blocks of size 2^( 2) =       0.000427633057
  error estimate for blocks of size 2^( 3) =       0.000441028887
  error estimate for blocks of size 2^( 4) =       0.000453480266
  error estimate for blocks of size 2^( 5) =       0.000464794563
  error estimate for blocks of size 2^( 6) =       0.000472124909
  error estimate for blocks of size 2^( 7) =       0.000477338820

      target function =                  N/A
              le_mean =     -16.906369484120
             les_mean =     286.169564430036
             stat err =       0.000466934640
             autocorr =       1.266737321506
              std dev =       0.586715832891
             le_variance =       0.344235468565


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690636948412e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906369484120       residual = 9.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906369484701       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906369484928       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906369485554       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906369485473       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906369485404       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906369485430       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906369485430       residual = 3.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 2.353127e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906369484120       residual = 9.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906369484265       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906369484322       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906369484480       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906369484458       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906369484441       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906369484448       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906369484448       residual = 3.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 5.882902e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906369484120       residual = 9.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906369484156       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906369484171       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906369484214       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906369484193       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906369484201       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906369484198       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906369484205       residual = 3.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 1.470731e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.207848 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7273e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978129e-02 1 1  ON 3
 uu_4                -6.600978e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493247e-03 1 1  ON 13
 ud_4                -6.482391e-02 1 1  ON 14
 ud_5                -1.070183e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819228e-02 1 1  ON 22
 eO_3                 2.998420e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230736e-02 1 1  ON 27
 eO_8                -2.283004e-01 1 1  ON 28
 eO_9                -9.249857e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827983e-02 1 1  ON 33
eH1_4                 1.758083e-03 1 1  ON 34
eH1_5                 3.783838e-02 1 1  ON 35
eH1_6                 9.718745e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951516e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477183e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503151e-02 1 1  ON 43
eH2_4                 4.511640e-03 1 1  ON 44
eH2_5                 4.015960e-02 1 1  ON 45
eH2_6                 9.843146e-02 1 1  ON 46
eH2_7                 1.587338e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691258e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9544
    reference variance = 0.266745
====================================================
  Execution time = 2.0554e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3743e-01
  Total weights = 2.0000e+06
  Execution time = 1.9101e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337118153726
                                         uncertainty =       0.003836652143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337118153726
                                         uncertainty =       0.003836652143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410750934
  error estimate for blocks of size 2^( 2) =       0.000423581232
  error estimate for blocks of size 2^( 3) =       0.000437122016
  error estimate for blocks of size 2^( 4) =       0.000449903664
  error estimate for blocks of size 2^( 5) =       0.000459765328
  error estimate for blocks of size 2^( 6) =       0.000467126939
  error estimate for blocks of size 2^( 7) =       0.000471616755

      target function =                  N/A
              le_mean =     -16.906624071807
             les_mean =     286.171369996648
             stat err =       0.000462103172
             autocorr =       1.265670852550
              std dev =       0.580889541963
             le_variance =       0.337432659962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337118083360
                                         uncertainty =       0.003836651025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337118083360
                                         uncertainty =       0.003836651025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410750891
  error estimate for blocks of size 2^( 2) =       0.000423581191
  error estimate for blocks of size 2^( 3) =       0.000437121978
  error estimate for blocks of size 2^( 4) =       0.000449903628
  error estimate for blocks of size 2^( 5) =       0.000459765292
  error estimate for blocks of size 2^( 6) =       0.000467126904
  error estimate for blocks of size 2^( 7) =       0.000471616719

      target function =                  N/A
              le_mean =     -16.906624071292
             les_mean =     286.171369908861
             stat err =       0.000462103136
             autocorr =       1.265670920197
              std dev =       0.580889481400
             le_variance =       0.337432589601

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337118118531
                                         uncertainty =       0.003836651583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337118118531
                                         uncertainty =       0.003836651583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410750913
  error estimate for blocks of size 2^( 2) =       0.000423581211
  error estimate for blocks of size 2^( 3) =       0.000437121997
  error estimate for blocks of size 2^( 4) =       0.000449903646
  error estimate for blocks of size 2^( 5) =       0.000459765310
  error estimate for blocks of size 2^( 6) =       0.000467126921
  error estimate for blocks of size 2^( 7) =       0.000471616737

      target function =                  N/A
              le_mean =     -16.906624071549
             les_mean =     286.171369952737
             stat err =       0.000462103154
             autocorr =       1.265670886380
              std dev =       0.580889511671
             le_variance =       0.337432624769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337118149326
                                         uncertainty =       0.003836652073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337118149326
                                         uncertainty =       0.003836652073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410750932
  error estimate for blocks of size 2^( 2) =       0.000423581229
  error estimate for blocks of size 2^( 3) =       0.000437122014
  error estimate for blocks of size 2^( 4) =       0.000449903662
  error estimate for blocks of size 2^( 5) =       0.000459765326
  error estimate for blocks of size 2^( 6) =       0.000467126936
  error estimate for blocks of size 2^( 7) =       0.000471616753

      target function =                  N/A
              le_mean =     -16.906624071775
             les_mean =     286.171369991158
             stat err =       0.000462103169
             autocorr =       1.265670856782
              std dev =       0.580889538177
             le_variance =       0.337432655563


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906624071807        initial  <--
     9.7656e+02     9.7656e+03             2.3531e-07       -16.906624071292
     3.9062e+03     3.9062e+04             5.8829e-08       -16.906624071549
     1.5625e+04     1.5625e+05             1.4707e-08       -16.906624071775

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1972
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293958e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600979e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493256e-03 1 1  ON 13
 ud_4                -6.482394e-02 1 1  ON 14
 ud_5                -1.070183e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819230e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230738e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249854e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758127e-03 1 1  ON 34
eH1_5                 3.783841e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867346e-01 1 1  ON 38
eH1_9                 7.951511e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503149e-02 1 1  ON 43
eH2_4                 4.511658e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7772e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8427
    reference variance = 0.231763
====================================================
  Execution time = 2.0769e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3820e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6835e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337730537081
                                         uncertainty =       0.003163403522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337730537081
                                         uncertainty =       0.003163403522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411215984
  error estimate for blocks of size 2^( 2) =       0.000424393742
  error estimate for blocks of size 2^( 3) =       0.000437157494
  error estimate for blocks of size 2^( 4) =       0.000449001877
  error estimate for blocks of size 2^( 5) =       0.000459413273
  error estimate for blocks of size 2^( 6) =       0.000467927735
  error estimate for blocks of size 2^( 7) =       0.000471550888

      target function =                  N/A
              le_mean =     -16.905856305695
             les_mean =     286.146174431101
             stat err =       0.000461973443
             autocorr =       1.262100812097
              std dev =       0.581547221985
             le_variance =       0.338197171399


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690585630569e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905856305695       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905856305725       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905856305738       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905856305724       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905856305694       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905856305684       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905856305712       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905856305715       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 2.096790e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905856305695       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905856305702       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905856305706       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905856305693       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905856305708       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905856305691       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905856305700       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905856305678       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 5.241991e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905856305695       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905856305697       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905856305698       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905856305697       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905856305694       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905856305725       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905856305664       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905856305682       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 1.310499e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.210456 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6459e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293958e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600979e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493255e-03 1 1  ON 13
 ud_4                -6.482394e-02 1 1  ON 14
 ud_5                -1.070183e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819230e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249854e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758126e-03 1 1  ON 34
eH1_5                 3.783841e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867346e-01 1 1  ON 38
eH1_9                 7.951511e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511657e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691255e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8749
    reference variance = 0.176262
====================================================
  Execution time = 2.0170e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4416e-01
  Total weights = 2.0000e+06
  Execution time = 1.9102e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344218453832
                                         uncertainty =       0.005636810003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344218453832
                                         uncertainty =       0.005636810003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414828203
  error estimate for blocks of size 2^( 2) =       0.000427350709
  error estimate for blocks of size 2^( 3) =       0.000439834659
  error estimate for blocks of size 2^( 4) =       0.000451546326
  error estimate for blocks of size 2^( 5) =       0.000462551739
  error estimate for blocks of size 2^( 6) =       0.000470849877
  error estimate for blocks of size 2^( 7) =       0.000474732787

      target function =                  N/A
              le_mean =     -16.906444462572
             les_mean =     286.172029069611
             stat err =       0.000464920182
             autocorr =       1.256088526609
              std dev =       0.586655670448
             le_variance =       0.344164875668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344218457256
                                         uncertainty =       0.005636810646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344218457256
                                         uncertainty =       0.005636810646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414828205
  error estimate for blocks of size 2^( 2) =       0.000427350711
  error estimate for blocks of size 2^( 3) =       0.000439834661
  error estimate for blocks of size 2^( 4) =       0.000451546328
  error estimate for blocks of size 2^( 5) =       0.000462551741
  error estimate for blocks of size 2^( 6) =       0.000470849878
  error estimate for blocks of size 2^( 7) =       0.000474732788

      target function =                  N/A
              le_mean =     -16.906444462698
             les_mean =     286.172029077304
             stat err =       0.000464920184
             autocorr =       1.256088522558
              std dev =       0.586655673366
             le_variance =       0.344164879092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344218455544
                                         uncertainty =       0.005636810324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344218455544
                                         uncertainty =       0.005636810324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414828204
  error estimate for blocks of size 2^( 2) =       0.000427350710
  error estimate for blocks of size 2^( 3) =       0.000439834660
  error estimate for blocks of size 2^( 4) =       0.000451546327
  error estimate for blocks of size 2^( 5) =       0.000462551740
  error estimate for blocks of size 2^( 6) =       0.000470849877
  error estimate for blocks of size 2^( 7) =       0.000474732787

      target function =                  N/A
              le_mean =     -16.906444462635
             les_mean =     286.172029073458
             stat err =       0.000464920183
             autocorr =       1.256088524584
              std dev =       0.586655671907
             le_variance =       0.344164877380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344218454046
                                         uncertainty =       0.005636810043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344218454046
                                         uncertainty =       0.005636810043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414828203
  error estimate for blocks of size 2^( 2) =       0.000427350709
  error estimate for blocks of size 2^( 3) =       0.000439834659
  error estimate for blocks of size 2^( 4) =       0.000451546326
  error estimate for blocks of size 2^( 5) =       0.000462551739
  error estimate for blocks of size 2^( 6) =       0.000470849877
  error estimate for blocks of size 2^( 7) =       0.000474732787

      target function =                  N/A
              le_mean =     -16.906444462580
             les_mean =     286.172029070092
             stat err =       0.000464920182
             autocorr =       1.256088526354
              std dev =       0.586655670630
             le_variance =       0.344164875882


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906444462572        initial
     9.7656e+03     9.7656e+04             2.0968e-08       -16.906444462698  <--
     3.9062e+04     3.9062e+05             5.2420e-09       -16.906444462635
     1.5625e+05     1.5625e+06             1.3105e-09       -16.906444462580

*****************************************************************************
Applying the update for shift_i =   9.7656e+03     and shift_s =   9.7656e+04
*****************************************************************************

  Execution time = 2.9799e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600978e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493251e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249855e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758122e-03 1 1  ON 34
eH1_5                 3.783840e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951512e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511655e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6357e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8972
    reference variance = 0.313816
====================================================
  Execution time = 2.0690e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3655e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5435e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336463218424
                                         uncertainty =       0.002870075538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336463218424
                                         uncertainty =       0.002870075538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410215138
  error estimate for blocks of size 2^( 2) =       0.000423023733
  error estimate for blocks of size 2^( 3) =       0.000436470490
  error estimate for blocks of size 2^( 4) =       0.000449273549
  error estimate for blocks of size 2^( 5) =       0.000460425393
  error estimate for blocks of size 2^( 6) =       0.000470201094
  error estimate for blocks of size 2^( 7) =       0.000477920099

      target function =                  N/A
              le_mean =     -16.905868946963
             les_mean =     286.144957601839
             stat err =       0.000464455034
             autocorr =       1.281929031745
              std dev =       0.580131811092
             le_variance =       0.336552918240


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690586894696e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905868946963       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905868946884       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905868946915       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905868946867       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905868946843       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905868946782       residual = 9.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905868946608       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905868946627       residual = 2.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 9.711585e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905868946963       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905868946943       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905868946951       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905868946939       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905868946932       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905868946911       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905868946873       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905868946878       residual = 2.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 2.427954e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905868946963       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905868946958       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905868946960       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905868946958       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905868946966       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905868946982       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905868946946       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905868946935       residual = 2.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 6.069922e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213043 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6241e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978128e-02 1 1  ON 3
 uu_4                -6.600977e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423620e-02 1 1  ON 12
 ud_3                -7.493247e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537717e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249857e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827982e-02 1 1  ON 33
eH1_4                 1.758111e-03 1 1  ON 34
eH1_5                 3.783839e-02 1 1  ON 35
eH1_6                 9.718744e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951514e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477183e-01 1 1  ON 41
eH2_2                -9.980484e-02 1 1  ON 42
eH2_3                -4.503147e-02 1 1  ON 43
eH2_4                 4.511638e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691259e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8923
    reference variance = 0.188433
====================================================
  Execution time = 2.0510e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3891e-01
  Total weights = 2.0000e+06
  Execution time = 1.9083e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338948531929
                                         uncertainty =       0.005493857772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338948531929
                                         uncertainty =       0.005493857772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411650827
  error estimate for blocks of size 2^( 2) =       0.000424566866
  error estimate for blocks of size 2^( 3) =       0.000437277589
  error estimate for blocks of size 2^( 4) =       0.000449890358
  error estimate for blocks of size 2^( 5) =       0.000462237112
  error estimate for blocks of size 2^( 6) =       0.000469968960
  error estimate for blocks of size 2^( 7) =       0.000477561064

      target function =                  N/A
              le_mean =     -16.906121417575
             les_mean =     286.155854023047
             stat err =       0.000464914374
             autocorr =       1.275522025666
              std dev =       0.582162182491
             le_variance =       0.338912806723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338948546920
                                         uncertainty =       0.005493858196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338948546920
                                         uncertainty =       0.005493858196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411650836
  error estimate for blocks of size 2^( 2) =       0.000424566875
  error estimate for blocks of size 2^( 3) =       0.000437277598
  error estimate for blocks of size 2^( 4) =       0.000449890368
  error estimate for blocks of size 2^( 5) =       0.000462237121
  error estimate for blocks of size 2^( 6) =       0.000469968967
  error estimate for blocks of size 2^( 7) =       0.000477561070

      target function =                  N/A
              le_mean =     -16.906121416940
             les_mean =     286.155854016559
             stat err =       0.000464914381
             autocorr =       1.275522011603
              std dev =       0.582162195359
             le_variance =       0.338912821706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338948539427
                                         uncertainty =       0.005493857984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338948539427
                                         uncertainty =       0.005493857984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411650832
  error estimate for blocks of size 2^( 2) =       0.000424566871
  error estimate for blocks of size 2^( 3) =       0.000437277593
  error estimate for blocks of size 2^( 4) =       0.000449890363
  error estimate for blocks of size 2^( 5) =       0.000462237116
  error estimate for blocks of size 2^( 6) =       0.000469968964
  error estimate for blocks of size 2^( 7) =       0.000477561067

      target function =                  N/A
              le_mean =     -16.906121417257
             les_mean =     286.155854019804
             stat err =       0.000464914378
             autocorr =       1.275522018623
              std dev =       0.582162188928
             le_variance =       0.338912814217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338948532867
                                         uncertainty =       0.005493857798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338948532867
                                         uncertainty =       0.005493857798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411650828
  error estimate for blocks of size 2^( 2) =       0.000424566867
  error estimate for blocks of size 2^( 3) =       0.000437277589
  error estimate for blocks of size 2^( 4) =       0.000449890359
  error estimate for blocks of size 2^( 5) =       0.000462237113
  error estimate for blocks of size 2^( 6) =       0.000469968961
  error estimate for blocks of size 2^( 7) =       0.000477561065

      target function =                  N/A
              le_mean =     -16.906121417535
             les_mean =     286.155854022641
             stat err =       0.000464914374
             autocorr =       1.275522024783
              std dev =       0.582162183296
             le_variance =       0.338912807660


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906121417575        initial  <--
     2.4414e+03     2.4414e+04             9.7116e-08       -16.906121416940
     9.7656e+03     9.7656e+04             2.4280e-08       -16.906121417257
     3.9062e+04     3.9062e+05             6.0699e-09       -16.906121417535

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1376
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600978e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493251e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249855e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758122e-03 1 1  ON 34
eH1_5                 3.783840e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951512e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511655e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6468e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9223
    reference variance = 0.178519
====================================================
  Execution time = 2.0516e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4167e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5293e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341784872492
                                         uncertainty =       0.007840120930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341784872492
                                         uncertainty =       0.007840120930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413321807
  error estimate for blocks of size 2^( 2) =       0.000426325784
  error estimate for blocks of size 2^( 3) =       0.000440182894
  error estimate for blocks of size 2^( 4) =       0.000452503307
  error estimate for blocks of size 2^( 5) =       0.000463551973
  error estimate for blocks of size 2^( 6) =       0.000472021924
  error estimate for blocks of size 2^( 7) =       0.000478008517

      target function =                  N/A
              le_mean =     -16.905807036336
             les_mean =     286.147981211323
             stat err =       0.000466521430
             autocorr =       1.273991581083
              std dev =       0.584525305110
             le_variance =       0.341669832314


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690580703634e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905807036336       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905807036387       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905807036435       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905807036468       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905807036481       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905807036447       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905807036462       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905807036457       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 8.862187e-09

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905807036336       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905807036349       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905807036361       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905807036362       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905807036456       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905807036368       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905807036300       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905807036442       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 2.215549e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905807036336       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905807036340       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905807036343       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905807036317       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905807036349       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905807036280       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905807036495       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905807036410       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 5.538873e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.215662 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6053e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600977e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423620e-02 1 1  ON 12
 ud_3                -7.493251e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249855e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758121e-03 1 1  ON 34
eH1_5                 3.783840e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951512e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511654e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.896
    reference variance = 0.322368
====================================================
  Execution time = 2.0038e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3562e-01
  Total weights = 2.0000e+06
  Execution time = 1.8937e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335656150708
                                         uncertainty =       0.003562488293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335656150708
                                         uncertainty =       0.003562488293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409647793
  error estimate for blocks of size 2^( 2) =       0.000422629314
  error estimate for blocks of size 2^( 3) =       0.000435656865
  error estimate for blocks of size 2^( 4) =       0.000448185773
  error estimate for blocks of size 2^( 5) =       0.000457947601
  error estimate for blocks of size 2^( 6) =       0.000465726050
  error estimate for blocks of size 2^( 7) =       0.000470490970

      target function =                  N/A
              le_mean =     -16.906071335218
             les_mean =     286.150870451712
             stat err =       0.000460587599
             autocorr =       1.264163488204
              std dev =       0.579329464164
             le_variance =       0.335622628049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335656151347
                                         uncertainty =       0.003562488199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335656151347
                                         uncertainty =       0.003562488199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409647793
  error estimate for blocks of size 2^( 2) =       0.000422629314
  error estimate for blocks of size 2^( 3) =       0.000435656866
  error estimate for blocks of size 2^( 4) =       0.000448185774
  error estimate for blocks of size 2^( 5) =       0.000457947602
  error estimate for blocks of size 2^( 6) =       0.000465726051
  error estimate for blocks of size 2^( 7) =       0.000470490970

      target function =                  N/A
              le_mean =     -16.906071335143
             les_mean =     286.150870449802
             stat err =       0.000460587599
             autocorr =       1.264163487917
              std dev =       0.579329464713
             le_variance =       0.335622628684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335656151027
                                         uncertainty =       0.003562488246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335656151027
                                         uncertainty =       0.003562488246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409647793
  error estimate for blocks of size 2^( 2) =       0.000422629314
  error estimate for blocks of size 2^( 3) =       0.000435656865
  error estimate for blocks of size 2^( 4) =       0.000448185773
  error estimate for blocks of size 2^( 5) =       0.000457947602
  error estimate for blocks of size 2^( 6) =       0.000465726050
  error estimate for blocks of size 2^( 7) =       0.000470490970

      target function =                  N/A
              le_mean =     -16.906071335180
             les_mean =     286.150870450757
             stat err =       0.000460587599
             autocorr =       1.264163488068
              std dev =       0.579329464438
             le_variance =       0.335622628366

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335656150748
                                         uncertainty =       0.003562488287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335656150748
                                         uncertainty =       0.003562488287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409647793
  error estimate for blocks of size 2^( 2) =       0.000422629314
  error estimate for blocks of size 2^( 3) =       0.000435656865
  error estimate for blocks of size 2^( 4) =       0.000448185773
  error estimate for blocks of size 2^( 5) =       0.000457947601
  error estimate for blocks of size 2^( 6) =       0.000465726050
  error estimate for blocks of size 2^( 7) =       0.000470490970

      target function =                  N/A
              le_mean =     -16.906071335213
             les_mean =     286.150870451593
             stat err =       0.000460587599
             autocorr =       1.264163488193
              std dev =       0.579329464199
             le_variance =       0.335622628089


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906071335218        initial  <--
     2.4414e+04     2.4414e+05             8.8622e-09       -16.906071335143
     9.7656e+04     9.7656e+05             2.2155e-09       -16.906071335180
     3.9062e+05     3.9062e+06             5.5389e-10       -16.906071335213

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6067
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600978e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493251e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249855e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758122e-03 1 1  ON 34
eH1_5                 3.783840e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951512e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511655e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5672e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9081
    reference variance = 0.190632
====================================================
  Execution time = 2.1820e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3243e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0318e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332462496893
                                         uncertainty =       0.002737932004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332462496893
                                         uncertainty =       0.002737932004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407694241
  error estimate for blocks of size 2^( 2) =       0.000420577602
  error estimate for blocks of size 2^( 3) =       0.000433841929
  error estimate for blocks of size 2^( 4) =       0.000446374569
  error estimate for blocks of size 2^( 5) =       0.000456042113
  error estimate for blocks of size 2^( 6) =       0.000465076630
  error estimate for blocks of size 2^( 7) =       0.000470521228

      target function =                  N/A
              le_mean =     -16.905758132548
             les_mean =     286.137087059023
             stat err =       0.000459503635
             autocorr =       1.270307166041
              std dev =       0.576566725572
             le_variance =       0.332429189037


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690575813255e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905758132548       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905758132549       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905758132545       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905758132553       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905758132530       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905758132538       residual = 9.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905758132436       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905758132513       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 1.130289e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905758132548       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905758132548       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905758132547       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905758132278       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905758132568       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905758132519       residual = 9.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905758132588       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905758132254       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 2.825723e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905758132548       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905758132548       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905758132547       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905758130337       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905758132862       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905758133549       residual = 9.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905758135159       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905758134744       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 7.064300e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.218286 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8928e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600978e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493251e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249855e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758122e-03 1 1  ON 34
eH1_5                 3.783840e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951512e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511655e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8852
    reference variance = 0.208974
====================================================
  Execution time = 2.0206e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4084e-01
  Total weights = 2.0000e+06
  Execution time = 1.8921e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340812224872
                                         uncertainty =       0.006673087021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340812224872
                                         uncertainty =       0.006673087021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412820103
  error estimate for blocks of size 2^( 2) =       0.000425432384
  error estimate for blocks of size 2^( 3) =       0.000437975423
  error estimate for blocks of size 2^( 4) =       0.000450299442
  error estimate for blocks of size 2^( 5) =       0.000461064107
  error estimate for blocks of size 2^( 6) =       0.000468659674
  error estimate for blocks of size 2^( 7) =       0.000472278580

      target function =                  N/A
              le_mean =     -16.907329724711
             les_mean =     286.198639124528
             stat err =       0.000463075451
             autocorr =       1.258293173506
              std dev =       0.583815788467
             le_variance =       0.340840874863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340812225313
                                         uncertainty =       0.006673087033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340812225313
                                         uncertainty =       0.006673087033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412820103
  error estimate for blocks of size 2^( 2) =       0.000425432384
  error estimate for blocks of size 2^( 3) =       0.000437975423
  error estimate for blocks of size 2^( 4) =       0.000450299442
  error estimate for blocks of size 2^( 5) =       0.000461064107
  error estimate for blocks of size 2^( 6) =       0.000468659674
  error estimate for blocks of size 2^( 7) =       0.000472278580

      target function =                  N/A
              le_mean =     -16.907329724702
             les_mean =     286.198639124678
             stat err =       0.000463075451
             autocorr =       1.258293173132
              std dev =       0.583815788845
             le_variance =       0.340840875304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340812225092
                                         uncertainty =       0.006673087027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340812225092
                                         uncertainty =       0.006673087027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412820103
  error estimate for blocks of size 2^( 2) =       0.000425432384
  error estimate for blocks of size 2^( 3) =       0.000437975423
  error estimate for blocks of size 2^( 4) =       0.000450299442
  error estimate for blocks of size 2^( 5) =       0.000461064107
  error estimate for blocks of size 2^( 6) =       0.000468659674
  error estimate for blocks of size 2^( 7) =       0.000472278580

      target function =                  N/A
              le_mean =     -16.907329724706
             les_mean =     286.198639124603
             stat err =       0.000463075451
             autocorr =       1.258293173323
              std dev =       0.583815788656
             le_variance =       0.340840875084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340812224899
                                         uncertainty =       0.006673087021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340812224899
                                         uncertainty =       0.006673087021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412820103
  error estimate for blocks of size 2^( 2) =       0.000425432384
  error estimate for blocks of size 2^( 3) =       0.000437975423
  error estimate for blocks of size 2^( 4) =       0.000450299442
  error estimate for blocks of size 2^( 5) =       0.000461064107
  error estimate for blocks of size 2^( 6) =       0.000468659674
  error estimate for blocks of size 2^( 7) =       0.000472278580

      target function =                  N/A
              le_mean =     -16.907329724710
             les_mean =     286.198639124538
             stat err =       0.000463075451
             autocorr =       1.258293173481
              std dev =       0.583815788490
             le_variance =       0.340840874891


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907329724711        initial  <--
     2.4414e+05     2.4414e+06             1.1303e-09       -16.907329724702
     9.7656e+05     9.7656e+06             2.8257e-10       -16.907329724706
     3.9062e+06     3.9062e+07             7.0643e-11       -16.907329724710

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7632
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600978e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493251e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249855e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758122e-03 1 1  ON 34
eH1_5                 3.783840e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951512e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511655e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8778e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8635
    reference variance = 0.302837
====================================================
  Execution time = 2.0440e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5189e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5965e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351896184182
                                         uncertainty =       0.011461078959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351896184182
                                         uncertainty =       0.011461078959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419459035
  error estimate for blocks of size 2^( 2) =       0.000432328828
  error estimate for blocks of size 2^( 3) =       0.000445789339
  error estimate for blocks of size 2^( 4) =       0.000458790722
  error estimate for blocks of size 2^( 5) =       0.000470176485
  error estimate for blocks of size 2^( 6) =       0.000479386970
  error estimate for blocks of size 2^( 7) =       0.000486624943

      target function =                  N/A
              le_mean =     -16.905800148829
             les_mean =     286.157970260268
             stat err =       0.000473744780
             autocorr =       1.275586072769
              std dev =       0.593204656144
             le_variance =       0.351891764071


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690580014883e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905800148829       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905800148829       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905800148829       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905800148829       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905800148829       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905800146564       residual = 8.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905800149377       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905800149070       residual = 6.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 1.361105e-10

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905800148829       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905800148829       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905800148829       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905800148829       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905800147389       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905800150130       residual = 8.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905800148447       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905800139019       residual = 6.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 3.402758e-11

solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905800148829       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905800148829       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905800148829       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905800148829       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905800161724       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905800159580       residual = 8.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905800169715       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905800152170       residual = 6.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+07 is 8.506721e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.220924 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6043e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600978e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493251e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249855e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758122e-03 1 1  ON 34
eH1_5                 3.783840e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951512e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511655e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8858
    reference variance = 0.259752
====================================================
  Execution time = 2.0212e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3993e-01
  Total weights = 2.0000e+06
  Execution time = 1.9007e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339850018656
                                         uncertainty =       0.005459725271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339850018656
                                         uncertainty =       0.005459725271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412266682
  error estimate for blocks of size 2^( 2) =       0.000425362279
  error estimate for blocks of size 2^( 3) =       0.000438601468
  error estimate for blocks of size 2^( 4) =       0.000450254228
  error estimate for blocks of size 2^( 5) =       0.000461319820
  error estimate for blocks of size 2^( 6) =       0.000469465495
  error estimate for blocks of size 2^( 7) =       0.000473906927

      target function =                  N/A
              le_mean =     -16.905753264551
             les_mean =     286.144420906642
             stat err =       0.000463736618
             autocorr =       1.265279009086
              std dev =       0.583033133481
             le_variance =       0.339927634737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339850018730
                                         uncertainty =       0.005459725270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339850018730
                                         uncertainty =       0.005459725270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412266682
  error estimate for blocks of size 2^( 2) =       0.000425362279
  error estimate for blocks of size 2^( 3) =       0.000438601468
  error estimate for blocks of size 2^( 4) =       0.000450254228
  error estimate for blocks of size 2^( 5) =       0.000461319820
  error estimate for blocks of size 2^( 6) =       0.000469465495
  error estimate for blocks of size 2^( 7) =       0.000473906927

      target function =                  N/A
              le_mean =     -16.905753264552
             les_mean =     286.144420906744
             stat err =       0.000463736618
             autocorr =       1.265279009010
              std dev =       0.583033133545
             le_variance =       0.339927634812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339850018693
                                         uncertainty =       0.005459725271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339850018693
                                         uncertainty =       0.005459725271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412266682
  error estimate for blocks of size 2^( 2) =       0.000425362279
  error estimate for blocks of size 2^( 3) =       0.000438601468
  error estimate for blocks of size 2^( 4) =       0.000450254228
  error estimate for blocks of size 2^( 5) =       0.000461319820
  error estimate for blocks of size 2^( 6) =       0.000469465495
  error estimate for blocks of size 2^( 7) =       0.000473906927

      target function =                  N/A
              le_mean =     -16.905753264551
             les_mean =     286.144420906693
             stat err =       0.000463736618
             autocorr =       1.265279009046
              std dev =       0.583033133513
             le_variance =       0.339927634774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339850018660
                                         uncertainty =       0.005459725271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339850018660
                                         uncertainty =       0.005459725271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412266682
  error estimate for blocks of size 2^( 2) =       0.000425362279
  error estimate for blocks of size 2^( 3) =       0.000438601468
  error estimate for blocks of size 2^( 4) =       0.000450254228
  error estimate for blocks of size 2^( 5) =       0.000461319820
  error estimate for blocks of size 2^( 6) =       0.000469465495
  error estimate for blocks of size 2^( 7) =       0.000473906927

      target function =                  N/A
              le_mean =     -16.905753264551
             les_mean =     286.144420906648
             stat err =       0.000463736618
             autocorr =       1.265279009073
              std dev =       0.583033133485
             le_variance =       0.339927634741


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905753264551        initial
     2.4414e+06     2.4414e+07             1.3611e-10       -16.905753264552  <--
     9.7656e+06     9.7656e+07             3.4028e-11       -16.905753264551
     3.9062e+07     3.9062e+08             8.5067e-12       -16.905753264551

*****************************************************************************
Applying the update for shift_i =   2.4414e+06     and shift_s =   2.4414e+07
*****************************************************************************

  Execution time = 2.9805e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600978e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493251e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249855e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758122e-03 1 1  ON 34
eH1_5                 3.783840e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951512e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511655e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6115e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8731
    reference variance = 0.25148
====================================================
  Execution time = 2.0527e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3783e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5584e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337823278341
                                         uncertainty =       0.003937635056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337823278341
                                         uncertainty =       0.003937635056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410991831
  error estimate for blocks of size 2^( 2) =       0.000423404192
  error estimate for blocks of size 2^( 3) =       0.000436467879
  error estimate for blocks of size 2^( 4) =       0.000448065812
  error estimate for blocks of size 2^( 5) =       0.000458584685
  error estimate for blocks of size 2^( 6) =       0.000465753981
  error estimate for blocks of size 2^( 7) =       0.000468450236

      target function =                  N/A
              le_mean =     -16.906386500405
             les_mean =     286.163732901896
             stat err =       0.000460213678
             autocorr =       1.253870446756
              std dev =       0.581230220942
             le_variance =       0.337828569736


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690638650040e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906386500405       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906386500406       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906386500405       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906386500359       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906386500392       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906386500085       residual = 9.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906386500152       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906386500162       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 3.179945e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906386500405       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906386500405       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906386500405       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906386500405       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906386500652       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906386501607       residual = 9.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906386500818       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906386500827       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 7.949863e-11

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906386500405       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906386500405       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906386500405       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906386498857       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906386503578       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906386502639       residual = 9.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906386500858       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906386494832       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 1.987469e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.223547 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6093e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600978e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493251e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249855e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758122e-03 1 1  ON 34
eH1_5                 3.783840e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951512e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511655e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9328
    reference variance = 0.283293
====================================================
  Execution time = 2.0122e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3809e-01
  Total weights = 2.0000e+06
  Execution time = 1.9032e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338102008386
                                         uncertainty =       0.003374690571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338102008386
                                         uncertainty =       0.003374690571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411147987
  error estimate for blocks of size 2^( 2) =       0.000424044532
  error estimate for blocks of size 2^( 3) =       0.000437365099
  error estimate for blocks of size 2^( 4) =       0.000449232525
  error estimate for blocks of size 2^( 5) =       0.000459257996
  error estimate for blocks of size 2^( 6) =       0.000467805532
  error estimate for blocks of size 2^( 7) =       0.000474561305

      target function =                  N/A
              le_mean =     -16.905907994443
             les_mean =     286.147810282228
             stat err =       0.000462714339
             autocorr =       1.266571116078
              std dev =       0.581451059584
             le_variance =       0.338085334692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338102008410
                                         uncertainty =       0.003374690573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338102008410
                                         uncertainty =       0.003374690573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411147987
  error estimate for blocks of size 2^( 2) =       0.000424044532
  error estimate for blocks of size 2^( 3) =       0.000437365099
  error estimate for blocks of size 2^( 4) =       0.000449232525
  error estimate for blocks of size 2^( 5) =       0.000459257996
  error estimate for blocks of size 2^( 6) =       0.000467805532
  error estimate for blocks of size 2^( 7) =       0.000474561305

      target function =                  N/A
              le_mean =     -16.905907994445
             les_mean =     286.147810282307
             stat err =       0.000462714339
             autocorr =       1.266571116049
              std dev =       0.581451059604
             le_variance =       0.338085334715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338102008398
                                         uncertainty =       0.003374690572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338102008398
                                         uncertainty =       0.003374690572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411147987
  error estimate for blocks of size 2^( 2) =       0.000424044532
  error estimate for blocks of size 2^( 3) =       0.000437365099
  error estimate for blocks of size 2^( 4) =       0.000449232525
  error estimate for blocks of size 2^( 5) =       0.000459257996
  error estimate for blocks of size 2^( 6) =       0.000467805532
  error estimate for blocks of size 2^( 7) =       0.000474561305

      target function =                  N/A
              le_mean =     -16.905907994444
             les_mean =     286.147810282268
             stat err =       0.000462714339
             autocorr =       1.266571116051
              std dev =       0.581451059594
             le_variance =       0.338085334703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338102008388
                                         uncertainty =       0.003374690571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338102008388
                                         uncertainty =       0.003374690571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411147987
  error estimate for blocks of size 2^( 2) =       0.000424044532
  error estimate for blocks of size 2^( 3) =       0.000437365099
  error estimate for blocks of size 2^( 4) =       0.000449232525
  error estimate for blocks of size 2^( 5) =       0.000459257996
  error estimate for blocks of size 2^( 6) =       0.000467805532
  error estimate for blocks of size 2^( 7) =       0.000474561305

      target function =                  N/A
              le_mean =     -16.905907994443
             les_mean =     286.147810282233
             stat err =       0.000462714339
             autocorr =       1.266571116074
              std dev =       0.581451059585
             le_variance =       0.338085334693


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905907994443        initial
     6.1035e+05     6.1035e+06             3.1799e-10       -16.905907994445  <--
     2.4414e+06     2.4414e+07             7.9499e-11       -16.905907994444
     9.7656e+06     9.7656e+07             1.9875e-11       -16.905907994443

*****************************************************************************
Applying the update for shift_i =   6.1035e+05     and shift_s =   6.1035e+06
*****************************************************************************

  Execution time = 2.9723e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600978e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493250e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249855e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758122e-03 1 1  ON 34
eH1_5                 3.783840e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951512e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511655e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5923e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8948
    reference variance = 0.227634
====================================================
  Execution time = 2.0575e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3776e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5541e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337710574705
                                         uncertainty =       0.003921866751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337710574705
                                         uncertainty =       0.003921866751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410951432
  error estimate for blocks of size 2^( 2) =       0.000423930765
  error estimate for blocks of size 2^( 3) =       0.000437117210
  error estimate for blocks of size 2^( 4) =       0.000450266012
  error estimate for blocks of size 2^( 5) =       0.000463614361
  error estimate for blocks of size 2^( 6) =       0.000471635203
  error estimate for blocks of size 2^( 7) =       0.000476051893

      target function =                  N/A
              le_mean =     -16.905745697666
             les_mean =     286.141999584116
             stat err =       0.000465391867
             autocorr =       1.282497666110
              std dev =       0.581173088530
             le_variance =       0.337762158831


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574569767e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905745697666       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905745697671       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905745697671       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905745697670       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905745697649       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905745697678       residual = 9.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905745697692       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905745697800       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.658973e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905745697666       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905745697668       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905745697667       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905745697667       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905745697667       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905745697256       residual = 9.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905745697328       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905745697654       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 4.147431e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905745697666       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905745697667       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905745697667       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905745697667       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905745697667       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905745697914       residual = 9.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905745698797       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905745699652       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 1.036860e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.226131 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6137e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600978e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493250e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249855e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758122e-03 1 1  ON 34
eH1_5                 3.783840e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951512e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511655e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8441
    reference variance = 0.281969
====================================================
  Execution time = 2.0304e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3968e-01
  Total weights = 2.0000e+06
  Execution time = 1.9125e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339691312111
                                         uncertainty =       0.003802693413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339691312111
                                         uncertainty =       0.003802693413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412116942
  error estimate for blocks of size 2^( 2) =       0.000424695687
  error estimate for blocks of size 2^( 3) =       0.000438247204
  error estimate for blocks of size 2^( 4) =       0.000451308675
  error estimate for blocks of size 2^( 5) =       0.000462742917
  error estimate for blocks of size 2^( 6) =       0.000470379203
  error estimate for blocks of size 2^( 7) =       0.000477126902

      target function =                  N/A
              le_mean =     -16.907211671044
             les_mean =     286.193487067950
             stat err =       0.000465389424
             autocorr =       1.275240455529
              std dev =       0.582821369106
             le_variance =       0.339680748287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339691311504
                                         uncertainty =       0.003802693403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339691311504
                                         uncertainty =       0.003802693403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412116942
  error estimate for blocks of size 2^( 2) =       0.000424695686
  error estimate for blocks of size 2^( 3) =       0.000438247203
  error estimate for blocks of size 2^( 4) =       0.000451308675
  error estimate for blocks of size 2^( 5) =       0.000462742916
  error estimate for blocks of size 2^( 6) =       0.000470379203
  error estimate for blocks of size 2^( 7) =       0.000477126901

      target function =                  N/A
              le_mean =     -16.907211671043
             les_mean =     286.193487067298
             stat err =       0.000465389424
             autocorr =       1.275240456223
              std dev =       0.582821368586
             le_variance =       0.339680747680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339691311807
                                         uncertainty =       0.003802693408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339691311807
                                         uncertainty =       0.003802693408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412116942
  error estimate for blocks of size 2^( 2) =       0.000424695686
  error estimate for blocks of size 2^( 3) =       0.000438247204
  error estimate for blocks of size 2^( 4) =       0.000451308675
  error estimate for blocks of size 2^( 5) =       0.000462742916
  error estimate for blocks of size 2^( 6) =       0.000470379203
  error estimate for blocks of size 2^( 7) =       0.000477126901

      target function =                  N/A
              le_mean =     -16.907211671044
             les_mean =     286.193487067624
             stat err =       0.000465389424
             autocorr =       1.275240455875
              std dev =       0.582821368846
             le_variance =       0.339680747983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339691312073
                                         uncertainty =       0.003802693413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339691312073
                                         uncertainty =       0.003802693413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412116942
  error estimate for blocks of size 2^( 2) =       0.000424695687
  error estimate for blocks of size 2^( 3) =       0.000438247204
  error estimate for blocks of size 2^( 4) =       0.000451308675
  error estimate for blocks of size 2^( 5) =       0.000462742917
  error estimate for blocks of size 2^( 6) =       0.000470379203
  error estimate for blocks of size 2^( 7) =       0.000477126902

      target function =                  N/A
              le_mean =     -16.907211671044
             les_mean =     286.193487067909
             stat err =       0.000465389424
             autocorr =       1.275240455581
              std dev =       0.582821369074
             le_variance =       0.339680748249


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907211671044        initial  <--
     1.5259e+05     1.5259e+06             1.6590e-09       -16.907211671043
     6.1035e+05     6.1035e+06             4.1474e-10       -16.907211671044
     2.4414e+06     2.4414e+07             1.0369e-10       -16.907211671044

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9530
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600978e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493250e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249855e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758122e-03 1 1  ON 34
eH1_5                 3.783840e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951512e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511655e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6344e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9081
    reference variance = 0.192875
====================================================
  Execution time = 2.0904e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4334e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5571e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343393420519
                                         uncertainty =       0.005287409099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343393420519
                                         uncertainty =       0.005287409099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414328330
  error estimate for blocks of size 2^( 2) =       0.000427195276
  error estimate for blocks of size 2^( 3) =       0.000439863169
  error estimate for blocks of size 2^( 4) =       0.000451724163
  error estimate for blocks of size 2^( 5) =       0.000462219163
  error estimate for blocks of size 2^( 6) =       0.000472436351
  error estimate for blocks of size 2^( 7) =       0.000477519156

      target function =                  N/A
              le_mean =     -16.905886256007
             les_mean =     286.152325859649
             stat err =       0.000465974708
             autocorr =       1.264839532968
              std dev =       0.585948743730
             le_variance =       0.343335930278


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690588625601e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905886256007       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905886256007       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905886256008       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905886256041       residual = 8.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905886255662       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905886256008       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905886256852       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905886254702       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.208754e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905886256007       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905886256007       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905886256007       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905886256587       residual = 8.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905886256015       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905886252572       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905886256226       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905886260773       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 3.021878e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905886256007       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905886256007       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905886256007       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905886262387       residual = 8.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905886250840       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905886256007       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905886267025       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905886261789       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 7.554736e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.228721 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6468e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600978e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493250e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249855e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758122e-03 1 1  ON 34
eH1_5                 3.783840e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951512e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511655e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9857
    reference variance = 0.341185
====================================================
  Execution time = 2.0151e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4283e-01
  Total weights = 2.0000e+06
  Execution time = 1.9102e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342472914264
                                         uncertainty =       0.007206060284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342472914264
                                         uncertainty =       0.007206060284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414024132
  error estimate for blocks of size 2^( 2) =       0.000426713345
  error estimate for blocks of size 2^( 3) =       0.000440093811
  error estimate for blocks of size 2^( 4) =       0.000451779159
  error estimate for blocks of size 2^( 5) =       0.000461444307
  error estimate for blocks of size 2^( 6) =       0.000469751585
  error estimate for blocks of size 2^( 7) =       0.000473684289

      target function =                  N/A
              le_mean =     -16.906010104055
             les_mean =     286.156009429956
             stat err =       0.000464164835
             autocorr =       1.256878106122
              std dev =       0.585518541949
             le_variance =       0.342831962966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342472914346
                                         uncertainty =       0.007206060283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342472914346
                                         uncertainty =       0.007206060283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414024132
  error estimate for blocks of size 2^( 2) =       0.000426713345
  error estimate for blocks of size 2^( 3) =       0.000440093811
  error estimate for blocks of size 2^( 4) =       0.000451779159
  error estimate for blocks of size 2^( 5) =       0.000461444307
  error estimate for blocks of size 2^( 6) =       0.000469751586
  error estimate for blocks of size 2^( 7) =       0.000473684289

      target function =                  N/A
              le_mean =     -16.906010104056
             les_mean =     286.156009430065
             stat err =       0.000464164835
             autocorr =       1.256878106055
              std dev =       0.585518542019
             le_variance =       0.342831963049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342472914305
                                         uncertainty =       0.007206060284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342472914305
                                         uncertainty =       0.007206060284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414024132
  error estimate for blocks of size 2^( 2) =       0.000426713345
  error estimate for blocks of size 2^( 3) =       0.000440093811
  error estimate for blocks of size 2^( 4) =       0.000451779159
  error estimate for blocks of size 2^( 5) =       0.000461444307
  error estimate for blocks of size 2^( 6) =       0.000469751585
  error estimate for blocks of size 2^( 7) =       0.000473684289

      target function =                  N/A
              le_mean =     -16.906010104055
             les_mean =     286.156009430011
             stat err =       0.000464164835
             autocorr =       1.256878106088
              std dev =       0.585518541984
             le_variance =       0.342831963007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342472914269
                                         uncertainty =       0.007206060284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342472914269
                                         uncertainty =       0.007206060284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414024132
  error estimate for blocks of size 2^( 2) =       0.000426713345
  error estimate for blocks of size 2^( 3) =       0.000440093811
  error estimate for blocks of size 2^( 4) =       0.000451779159
  error estimate for blocks of size 2^( 5) =       0.000461444307
  error estimate for blocks of size 2^( 6) =       0.000469751585
  error estimate for blocks of size 2^( 7) =       0.000473684289

      target function =                  N/A
              le_mean =     -16.906010104055
             les_mean =     286.156009429963
             stat err =       0.000464164835
             autocorr =       1.256878106116
              std dev =       0.585518541953
             le_variance =       0.342831962971


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906010104055        initial
     1.5259e+06     1.5259e+07             1.2088e-10       -16.906010104056  <--
     6.1035e+06     6.1035e+07             3.0219e-11       -16.906010104055
     2.4414e+07     2.4414e+08             7.5547e-12       -16.906010104055

*****************************************************************************
Applying the update for shift_i =   1.5259e+06     and shift_s =   1.5259e+07
*****************************************************************************

  Execution time = 2.9778e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600978e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493250e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249855e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758122e-03 1 1  ON 34
eH1_5                 3.783840e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951512e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511655e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6425e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8685
    reference variance = 0.243706
====================================================
  Execution time = 2.0488e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5234e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5683e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352280517868
                                         uncertainty =       0.011679234566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352280517868
                                         uncertainty =       0.011679234566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419724743
  error estimate for blocks of size 2^( 2) =       0.000432324363
  error estimate for blocks of size 2^( 3) =       0.000445259189
  error estimate for blocks of size 2^( 4) =       0.000457490975
  error estimate for blocks of size 2^( 5) =       0.000467741325
  error estimate for blocks of size 2^( 6) =       0.000474476514
  error estimate for blocks of size 2^( 7) =       0.000479691490

      target function =                  N/A
              le_mean =     -16.906580772890
             les_mean =     286.184810973340
             stat err =       0.000469850076
             autocorr =       1.253110761993
              std dev =       0.593580423586
             le_variance =       0.352337719264


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690658077289e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906580772890       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906580772891       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906580772892       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906580772892       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906580772919       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906580772307       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906580772672       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906580772766       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 6.675091e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906580772890       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906580772890       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906580772890       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906580772891       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906580773057       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906580772875       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906580772895       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906580772527       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.668774e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906580772890       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906580772890       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906580772890       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906580772461       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906580772615       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906580774584       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906580771593       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906580781901       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 4.171962e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.231317 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6063e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600978e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493250e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249855e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758122e-03 1 1  ON 34
eH1_5                 3.783840e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951512e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511655e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.89
    reference variance = 0.22538
====================================================
  Execution time = 2.2236e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4550e-01
  Total weights = 2.0000e+06
  Execution time = 1.9068e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345347654925
                                         uncertainty =       0.008856557406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345347654925
                                         uncertainty =       0.008856557406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415632778
  error estimate for blocks of size 2^( 2) =       0.000428242351
  error estimate for blocks of size 2^( 3) =       0.000440880503
  error estimate for blocks of size 2^( 4) =       0.000452341384
  error estimate for blocks of size 2^( 5) =       0.000462214200
  error estimate for blocks of size 2^( 6) =       0.000469195626
  error estimate for blocks of size 2^( 7) =       0.000474829931

      target function =                  N/A
              le_mean =     -16.906446792763
             les_mean =     286.173444195431
             stat err =       0.000464645285
             autocorr =       1.249750992019
              std dev =       0.587793511061
             le_variance =       0.345501211646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345347655258
                                         uncertainty =       0.008856557408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345347655258
                                         uncertainty =       0.008856557408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415632778
  error estimate for blocks of size 2^( 2) =       0.000428242351
  error estimate for blocks of size 2^( 3) =       0.000440880504
  error estimate for blocks of size 2^( 4) =       0.000452341384
  error estimate for blocks of size 2^( 5) =       0.000462214200
  error estimate for blocks of size 2^( 6) =       0.000469195626
  error estimate for blocks of size 2^( 7) =       0.000474829931

      target function =                  N/A
              le_mean =     -16.906446792763
             les_mean =     286.173444195767
             stat err =       0.000464645285
             autocorr =       1.249750991835
              std dev =       0.587793511345
             le_variance =       0.345501211980

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345347655092
                                         uncertainty =       0.008856557407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345347655092
                                         uncertainty =       0.008856557407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415632778
  error estimate for blocks of size 2^( 2) =       0.000428242351
  error estimate for blocks of size 2^( 3) =       0.000440880504
  error estimate for blocks of size 2^( 4) =       0.000452341384
  error estimate for blocks of size 2^( 5) =       0.000462214200
  error estimate for blocks of size 2^( 6) =       0.000469195626
  error estimate for blocks of size 2^( 7) =       0.000474829931

      target function =                  N/A
              le_mean =     -16.906446792763
             les_mean =     286.173444195599
             stat err =       0.000464645285
             autocorr =       1.249750991931
              std dev =       0.587793511203
             le_variance =       0.345501211813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345347654945
                                         uncertainty =       0.008856557406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345347654945
                                         uncertainty =       0.008856557406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415632778
  error estimate for blocks of size 2^( 2) =       0.000428242351
  error estimate for blocks of size 2^( 3) =       0.000440880503
  error estimate for blocks of size 2^( 4) =       0.000452341384
  error estimate for blocks of size 2^( 5) =       0.000462214200
  error estimate for blocks of size 2^( 6) =       0.000469195626
  error estimate for blocks of size 2^( 7) =       0.000474829931

      target function =                  N/A
              le_mean =     -16.906446792763
             les_mean =     286.173444195452
             stat err =       0.000464645285
             autocorr =       1.249750992014
              std dev =       0.587793511079
             le_variance =       0.345501211667


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906446792763        initial
     3.8147e+05     3.8147e+06             6.6751e-10       -16.906446792763  <--
     1.5259e+06     1.5259e+07             1.6688e-10       -16.906446792763
     6.1035e+06     6.1035e+07             4.1720e-11       -16.906446792763

*****************************************************************************
Applying the update for shift_i =   3.8147e+05     and shift_s =   3.8147e+06
*****************************************************************************

  Execution time = 3.1856e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600977e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493250e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249855e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758122e-03 1 1  ON 34
eH1_5                 3.783840e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951512e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511655e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8018e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9244
    reference variance = 0.373429
====================================================
  Execution time = 2.0574e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3492e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5352e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334974098978
                                         uncertainty =       0.002681699609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334974098978
                                         uncertainty =       0.002681699609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409218535
  error estimate for blocks of size 2^( 2) =       0.000421887921
  error estimate for blocks of size 2^( 3) =       0.000435129253
  error estimate for blocks of size 2^( 4) =       0.000447113356
  error estimate for blocks of size 2^( 5) =       0.000456920630
  error estimate for blocks of size 2^( 6) =       0.000464683239
  error estimate for blocks of size 2^( 7) =       0.000468632080

      target function =                  N/A
              le_mean =     -16.906828179660
             les_mean =     286.175758548286
             stat err =       0.000459337326
             autocorr =       1.259948759603
              std dev =       0.578722402543
             le_variance =       0.334919619205


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690682817966e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906828179660       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906828179663       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906828179670       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906828179692       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906828179683       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906828179709       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906828179624       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906828179742       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.106468e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906828179660       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906828179661       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906828179662       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906828179773       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906828179910       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906828179715       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906828179497       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906828179883       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 5.266171e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906828179660       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906828179660       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906828179660       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906828179516       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906828179661       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906828179661       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906828180466       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906828179561       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.316542e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.233941 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6116e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600978e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423620e-02 1 1  ON 12
 ud_3                -7.493250e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249855e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758121e-03 1 1  ON 34
eH1_5                 3.783840e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951512e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511654e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9298
    reference variance = 0.160525
====================================================
  Execution time = 2.0644e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4383e-01
  Total weights = 2.0000e+06
  Execution time = 1.8999e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343923475028
                                         uncertainty =       0.011701490058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343923475028
                                         uncertainty =       0.011701490058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414627280
  error estimate for blocks of size 2^( 2) =       0.000427172339
  error estimate for blocks of size 2^( 3) =       0.000440408306
  error estimate for blocks of size 2^( 4) =       0.000452771650
  error estimate for blocks of size 2^( 5) =       0.000462992318
  error estimate for blocks of size 2^( 6) =       0.000470905083
  error estimate for blocks of size 2^( 7) =       0.000475074740

      target function =                  N/A
              le_mean =     -16.907046245025
             les_mean =     286.192044122402
             stat err =       0.000465435948
             autocorr =       1.260097354698
              std dev =       0.586371522934
             le_variance =       0.343831562908

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343923475896
                                         uncertainty =       0.011701490176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343923475896
                                         uncertainty =       0.011701490176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414627281
  error estimate for blocks of size 2^( 2) =       0.000427172339
  error estimate for blocks of size 2^( 3) =       0.000440408307
  error estimate for blocks of size 2^( 4) =       0.000452771650
  error estimate for blocks of size 2^( 5) =       0.000462992318
  error estimate for blocks of size 2^( 6) =       0.000470905084
  error estimate for blocks of size 2^( 7) =       0.000475074740

      target function =                  N/A
              le_mean =     -16.907046245028
             les_mean =     286.192044123374
             stat err =       0.000465435948
             autocorr =       1.260097354139
              std dev =       0.586371523673
             le_variance =       0.343831563775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343923475462
                                         uncertainty =       0.011701490117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343923475462
                                         uncertainty =       0.011701490117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414627280
  error estimate for blocks of size 2^( 2) =       0.000427172339
  error estimate for blocks of size 2^( 3) =       0.000440408306
  error estimate for blocks of size 2^( 4) =       0.000452771650
  error estimate for blocks of size 2^( 5) =       0.000462992318
  error estimate for blocks of size 2^( 6) =       0.000470905084
  error estimate for blocks of size 2^( 7) =       0.000475074740

      target function =                  N/A
              le_mean =     -16.907046245026
             les_mean =     286.192044122888
             stat err =       0.000465435948
             autocorr =       1.260097354411
              std dev =       0.586371523304
             le_variance =       0.343831563341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343923475083
                                         uncertainty =       0.011701490065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343923475083
                                         uncertainty =       0.011701490065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414627280
  error estimate for blocks of size 2^( 2) =       0.000427172339
  error estimate for blocks of size 2^( 3) =       0.000440408306
  error estimate for blocks of size 2^( 4) =       0.000452771650
  error estimate for blocks of size 2^( 5) =       0.000462992318
  error estimate for blocks of size 2^( 6) =       0.000470905083
  error estimate for blocks of size 2^( 7) =       0.000475074740

      target function =                  N/A
              le_mean =     -16.907046245025
             les_mean =     286.192044122463
             stat err =       0.000465435948
             autocorr =       1.260097354659
              std dev =       0.586371522980
             le_variance =       0.343831562962


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907046245025        initial
     9.5367e+04     9.5367e+05             2.1065e-09       -16.907046245028  <--
     3.8147e+05     3.8147e+06             5.2662e-10       -16.907046245026
     1.5259e+06     1.5259e+07             1.3165e-10       -16.907046245025

*****************************************************************************
Applying the update for shift_i =   9.5367e+04     and shift_s =   9.5367e+05
*****************************************************************************

  Execution time = 3.0228e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600978e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423620e-02 1 1  ON 12
 ud_3                -7.493249e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249856e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758120e-03 1 1  ON 34
eH1_5                 3.783840e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951512e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511653e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6401e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.92
    reference variance = 0.194703
====================================================
  Execution time = 2.0566e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4260e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5461e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342724340581
                                         uncertainty =       0.003999467107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342724340581
                                         uncertainty =       0.003999467107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413884437
  error estimate for blocks of size 2^( 2) =       0.000426713313
  error estimate for blocks of size 2^( 3) =       0.000439834768
  error estimate for blocks of size 2^( 4) =       0.000451827854
  error estimate for blocks of size 2^( 5) =       0.000463333654
  error estimate for blocks of size 2^( 6) =       0.000471953478
  error estimate for blocks of size 2^( 7) =       0.000476975156

      target function =                  N/A
              le_mean =     -16.906217721113
             les_mean =     286.162798116021
             stat err =       0.000466022536
             autocorr =       1.267814298243
              std dev =       0.585320983439
             le_variance =       0.342600653654


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690621772111e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906217721113       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906217721133       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906217721144       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906217721157       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906217721198       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906217721189       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906217721177       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906217721186       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 8.772855e-09

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906217721113       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906217721118       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906217721121       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906217721088       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906217721133       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906217721130       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906217721088       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906217721175       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.193216e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906217721113       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906217721114       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906217721115       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906217721116       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906217721114       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906217721300       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906217721336       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906217721276       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 5.483041e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.236592 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6119e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600978e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423620e-02 1 1  ON 12
 ud_3                -7.493248e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249856e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758120e-03 1 1  ON 34
eH1_5                 3.783840e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951512e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511652e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691257e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8043
    reference variance = 0.503274
====================================================
  Execution time = 2.0050e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3472e-01
  Total weights = 2.0000e+06
  Execution time = 1.9046e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334800956520
                                         uncertainty =       0.002800346415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334800956520
                                         uncertainty =       0.002800346415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409098846
  error estimate for blocks of size 2^( 2) =       0.000421981864
  error estimate for blocks of size 2^( 3) =       0.000435331889
  error estimate for blocks of size 2^( 4) =       0.000448419572
  error estimate for blocks of size 2^( 5) =       0.000458699743
  error estimate for blocks of size 2^( 6) =       0.000468059879
  error estimate for blocks of size 2^( 7) =       0.000474062720

      target function =                  N/A
              le_mean =     -16.905624793267
             les_mean =     286.134873215616
             stat err =       0.000462310478
             autocorr =       1.277059006096
              std dev =       0.578553136920
             le_variance =       0.334723732239

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334800957382
                                         uncertainty =       0.002800346439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334800957382
                                         uncertainty =       0.002800346439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409098847
  error estimate for blocks of size 2^( 2) =       0.000421981864
  error estimate for blocks of size 2^( 3) =       0.000435331889
  error estimate for blocks of size 2^( 4) =       0.000448419572
  error estimate for blocks of size 2^( 5) =       0.000458699743
  error estimate for blocks of size 2^( 6) =       0.000468059879
  error estimate for blocks of size 2^( 7) =       0.000474062720

      target function =                  N/A
              le_mean =     -16.905624793234
             les_mean =     286.134873215335
             stat err =       0.000462310479
             autocorr =       1.277059004063
              std dev =       0.578553137667
             le_variance =       0.334723733104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334800956951
                                         uncertainty =       0.002800346427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334800956951
                                         uncertainty =       0.002800346427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409098847
  error estimate for blocks of size 2^( 2) =       0.000421981864
  error estimate for blocks of size 2^( 3) =       0.000435331889
  error estimate for blocks of size 2^( 4) =       0.000448419572
  error estimate for blocks of size 2^( 5) =       0.000458699743
  error estimate for blocks of size 2^( 6) =       0.000468059879
  error estimate for blocks of size 2^( 7) =       0.000474062720

      target function =                  N/A
              le_mean =     -16.905624793250
             les_mean =     286.134873215476
             stat err =       0.000462310478
             autocorr =       1.277059005080
              std dev =       0.578553137293
             le_variance =       0.334723732672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334800956574
                                         uncertainty =       0.002800346417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334800956574
                                         uncertainty =       0.002800346417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409098846
  error estimate for blocks of size 2^( 2) =       0.000421981864
  error estimate for blocks of size 2^( 3) =       0.000435331889
  error estimate for blocks of size 2^( 4) =       0.000448419572
  error estimate for blocks of size 2^( 5) =       0.000458699743
  error estimate for blocks of size 2^( 6) =       0.000468059879
  error estimate for blocks of size 2^( 7) =       0.000474062720

      target function =                  N/A
              le_mean =     -16.905624793265
             les_mean =     286.134873215598
             stat err =       0.000462310478
             autocorr =       1.277059005962
              std dev =       0.578553136966
             le_variance =       0.334723732294


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905624793267        initial  <--
     2.3842e+04     2.3842e+05             8.7729e-09       -16.905624793234
     9.5367e+04     9.5367e+05             2.1932e-09       -16.905624793250
     3.8147e+05     3.8147e+06             5.4830e-10       -16.905624793265

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6518
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600978e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423620e-02 1 1  ON 12
 ud_3                -7.493249e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249856e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758120e-03 1 1  ON 34
eH1_5                 3.783840e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951512e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511653e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5783e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9248
    reference variance = 0.193535
====================================================
  Execution time = 2.0691e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3181e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6091e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331861209491
                                         uncertainty =       0.002926102149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331861209491
                                         uncertainty =       0.002926102149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407316973
  error estimate for blocks of size 2^( 2) =       0.000420543793
  error estimate for blocks of size 2^( 3) =       0.000434313008
  error estimate for blocks of size 2^( 4) =       0.000446860601
  error estimate for blocks of size 2^( 5) =       0.000457223285
  error estimate for blocks of size 2^( 6) =       0.000467336489
  error estimate for blocks of size 2^( 7) =       0.000473949588

      target function =                  N/A
              le_mean =     -16.906088404846
             les_mean =     286.147639220159
             stat err =       0.000461342491
             autocorr =       1.282867774854
              std dev =       0.576033187929
             le_variance =       0.331814233596


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690608840485e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906088404846       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906088404850       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906088404853       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906088404790       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906088404986       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906088404917       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906088404812       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906088404935       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 7.668120e-10

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906088404846       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906088404847       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906088404848       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906088404850       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906088405084       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906088404853       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906088405209       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906088404859       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 1.917031e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906088404846       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906088404846       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906088404846       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906088404649       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906088405533       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906088405525       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906088399697       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906088403730       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 4.792549e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.239229 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6307e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600978e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423620e-02 1 1  ON 12
 ud_3                -7.493249e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249856e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758120e-03 1 1  ON 34
eH1_5                 3.783840e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951512e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511653e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8967
    reference variance = 0.226726
====================================================
  Execution time = 2.0431e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3505e-01
  Total weights = 2.0000e+06
  Execution time = 1.9093e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334992407189
                                         uncertainty =       0.004504159915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334992407189
                                         uncertainty =       0.004504159915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409298227
  error estimate for blocks of size 2^( 2) =       0.000421423035
  error estimate for blocks of size 2^( 3) =       0.000434374294
  error estimate for blocks of size 2^( 4) =       0.000446853512
  error estimate for blocks of size 2^( 5) =       0.000457229305
  error estimate for blocks of size 2^( 6) =       0.000468234347
  error estimate for blocks of size 2^( 7) =       0.000473278910

      target function =                  N/A
              le_mean =     -16.906272798983
             les_mean =     286.157109863553
             stat err =       0.000461399018
             autocorr =       1.270789464526
              std dev =       0.578835103856
             le_variance =       0.335050077456

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334992407065
                                         uncertainty =       0.004504159910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334992407065
                                         uncertainty =       0.004504159910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409298227
  error estimate for blocks of size 2^( 2) =       0.000421423035
  error estimate for blocks of size 2^( 3) =       0.000434374294
  error estimate for blocks of size 2^( 4) =       0.000446853512
  error estimate for blocks of size 2^( 5) =       0.000457229305
  error estimate for blocks of size 2^( 6) =       0.000468234347
  error estimate for blocks of size 2^( 7) =       0.000473278910

      target function =                  N/A
              le_mean =     -16.906272798989
             les_mean =     286.157109863655
             stat err =       0.000461399018
             autocorr =       1.270789464701
              std dev =       0.578835103749
             le_variance =       0.335050077332

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334992407127
                                         uncertainty =       0.004504159912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334992407127
                                         uncertainty =       0.004504159912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409298227
  error estimate for blocks of size 2^( 2) =       0.000421423035
  error estimate for blocks of size 2^( 3) =       0.000434374294
  error estimate for blocks of size 2^( 4) =       0.000446853512
  error estimate for blocks of size 2^( 5) =       0.000457229305
  error estimate for blocks of size 2^( 6) =       0.000468234347
  error estimate for blocks of size 2^( 7) =       0.000473278910

      target function =                  N/A
              le_mean =     -16.906272798986
             les_mean =     286.157109863604
             stat err =       0.000461399018
             autocorr =       1.270789464612
              std dev =       0.578835103802
             le_variance =       0.335050077394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334992407181
                                         uncertainty =       0.004504159914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334992407181
                                         uncertainty =       0.004504159914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409298227
  error estimate for blocks of size 2^( 2) =       0.000421423035
  error estimate for blocks of size 2^( 3) =       0.000434374294
  error estimate for blocks of size 2^( 4) =       0.000446853512
  error estimate for blocks of size 2^( 5) =       0.000457229305
  error estimate for blocks of size 2^( 6) =       0.000468234347
  error estimate for blocks of size 2^( 7) =       0.000473278910

      target function =                  N/A
              le_mean =     -16.906272798983
             les_mean =     286.157109863559
             stat err =       0.000461399018
             autocorr =       1.270789464538
              std dev =       0.578835103849
             le_variance =       0.335050077448


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906272798983        initial
     2.3842e+05     2.3842e+06             7.6681e-10       -16.906272798989  <--
     9.5367e+05     9.5367e+06             1.9170e-10       -16.906272798986
     3.8147e+06     3.8147e+07             4.7925e-11       -16.906272798983

*****************************************************************************
Applying the update for shift_i =   2.3842e+05     and shift_s =   2.3842e+06
*****************************************************************************

  Execution time = 3.0059e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600978e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423620e-02 1 1  ON 12
 ud_3                -7.493249e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249856e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758120e-03 1 1  ON 34
eH1_5                 3.783840e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951512e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511652e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691257e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6534e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9262
    reference variance = 0.488576
====================================================
  Execution time = 2.0982e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3641e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5634e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336413403116
                                         uncertainty =       0.002926877555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336413403116
                                         uncertainty =       0.002926877555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410125436
  error estimate for blocks of size 2^( 2) =       0.000422901772
  error estimate for blocks of size 2^( 3) =       0.000435690314
  error estimate for blocks of size 2^( 4) =       0.000447945233
  error estimate for blocks of size 2^( 5) =       0.000459070192
  error estimate for blocks of size 2^( 6) =       0.000466196210
  error estimate for blocks of size 2^( 7) =       0.000471897649

      target function =                  N/A
              le_mean =     -16.906220329113
             les_mean =     286.156691394757
             stat err =       0.000461277321
             autocorr =       1.265000786621
              std dev =       0.580004953803
             le_variance =       0.336405746436


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690622032911e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906220329113       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906220329108       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906220329105       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906220329104       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906220329119       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906220329148       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906220329121       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906220329116       residual = 1.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 3.257625e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906220329113       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906220329112       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906220329111       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906220329112       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906220329042       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906220329111       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906220329167       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906220329198       residual = 1.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 8.144066e-10

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906220329113       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906220329113       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906220329113       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906220329113       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906220329518       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906220328676       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906220331011       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906220328702       residual = 1.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 2.036016e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.241862 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6552e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600978e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423620e-02 1 1  ON 12
 ud_3                -7.493248e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249856e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758120e-03 1 1  ON 34
eH1_5                 3.783840e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951512e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511652e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691257e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8653
    reference variance = 0.290149
====================================================
  Execution time = 2.0330e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4038e-01
  Total weights = 2.0000e+06
  Execution time = 1.9051e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340403056641
                                         uncertainty =       0.003642141074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340403056641
                                         uncertainty =       0.003642141074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412538099
  error estimate for blocks of size 2^( 2) =       0.000425575068
  error estimate for blocks of size 2^( 3) =       0.000438126023
  error estimate for blocks of size 2^( 4) =       0.000450060702
  error estimate for blocks of size 2^( 5) =       0.000460716036
  error estimate for blocks of size 2^( 6) =       0.000469156142
  error estimate for blocks of size 2^( 7) =       0.000477255986

      target function =                  N/A
              le_mean =     -16.905651939110
             les_mean =     286.141442683080
             stat err =       0.000464297217
             autocorr =       1.266671600734
              std dev =       0.583416975195
             le_variance =       0.340375366945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340403055164
                                         uncertainty =       0.003642141060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340403055164
                                         uncertainty =       0.003642141060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412538099
  error estimate for blocks of size 2^( 2) =       0.000425575067
  error estimate for blocks of size 2^( 3) =       0.000438126022
  error estimate for blocks of size 2^( 4) =       0.000450060701
  error estimate for blocks of size 2^( 5) =       0.000460716036
  error estimate for blocks of size 2^( 6) =       0.000469156141
  error estimate for blocks of size 2^( 7) =       0.000477255986

      target function =                  N/A
              le_mean =     -16.905651939110
             les_mean =     286.141442681628
             stat err =       0.000464297216
             autocorr =       1.266671602263
              std dev =       0.583416973929
             le_variance =       0.340375365469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340403055903
                                         uncertainty =       0.003642141067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340403055903
                                         uncertainty =       0.003642141067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412538099
  error estimate for blocks of size 2^( 2) =       0.000425575068
  error estimate for blocks of size 2^( 3) =       0.000438126023
  error estimate for blocks of size 2^( 4) =       0.000450060702
  error estimate for blocks of size 2^( 5) =       0.000460716036
  error estimate for blocks of size 2^( 6) =       0.000469156142
  error estimate for blocks of size 2^( 7) =       0.000477255986

      target function =                  N/A
              le_mean =     -16.905651939110
             les_mean =     286.141442682353
             stat err =       0.000464297216
             autocorr =       1.266671601497
              std dev =       0.583416974562
             le_variance =       0.340375366207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340403056549
                                         uncertainty =       0.003642141073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340403056549
                                         uncertainty =       0.003642141073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412538099
  error estimate for blocks of size 2^( 2) =       0.000425575068
  error estimate for blocks of size 2^( 3) =       0.000438126023
  error estimate for blocks of size 2^( 4) =       0.000450060702
  error estimate for blocks of size 2^( 5) =       0.000460716036
  error estimate for blocks of size 2^( 6) =       0.000469156142
  error estimate for blocks of size 2^( 7) =       0.000477255986

      target function =                  N/A
              le_mean =     -16.905651939110
             les_mean =     286.141442682989
             stat err =       0.000464297217
             autocorr =       1.266671600830
              std dev =       0.583416975116
             le_variance =       0.340375366853


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905651939110        initial
     5.9605e+04     5.9605e+05             3.2576e-09       -16.905651939110  <--
     2.3842e+05     2.3842e+06             8.1441e-10       -16.905651939110
     9.5367e+05     9.5367e+06             2.0360e-10       -16.905651939110

*****************************************************************************
Applying the update for shift_i =   5.9605e+04     and shift_s =   5.9605e+05
*****************************************************************************

  Execution time = 2.9934e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600977e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423620e-02 1 1  ON 12
 ud_3                -7.493247e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249856e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758118e-03 1 1  ON 34
eH1_5                 3.783840e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951512e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511651e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691257e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6619e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9466
    reference variance = 0.126341
====================================================
  Execution time = 2.0650e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4440e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6337e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344166856009
                                         uncertainty =       0.005970053643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344166856009
                                         uncertainty =       0.005970053643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414967000
  error estimate for blocks of size 2^( 2) =       0.000427902233
  error estimate for blocks of size 2^( 3) =       0.000440939502
  error estimate for blocks of size 2^( 4) =       0.000453613281
  error estimate for blocks of size 2^( 5) =       0.000464477805
  error estimate for blocks of size 2^( 6) =       0.000472962197
  error estimate for blocks of size 2^( 7) =       0.000480436467

      target function =                  N/A
              le_mean =     -16.906551525533
             les_mean =     286.175879534936
             stat err =       0.000467872437
             autocorr =       1.271240736130
              std dev =       0.586851958875
             le_variance =       0.344395221635


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690655152553e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906551525533       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906551525553       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906551525649       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906551525641       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906551525659       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906551525673       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906551525656       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906551525667       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.258125e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906551525533       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906551525538       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906551525562       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906551525571       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906551525587       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906551525515       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906551525597       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906551525555       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 3.145315e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906551525533       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906551525534       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906551525540       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906551525535       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906551525541       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906551525571       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906551525417       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906551525551       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 7.863287e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.244547 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6293e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978128e-02 1 1  ON 3
 uu_4                -6.600977e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423620e-02 1 1  ON 12
 ud_3                -7.493246e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283003e-01 1 1  ON 28
 eO_9                -9.249856e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758116e-03 1 1  ON 34
eH1_5                 3.783839e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951513e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511651e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691257e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.971
    reference variance = 0.227039
====================================================
  Execution time = 2.0089e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5911e-01
  Total weights = 2.0000e+06
  Execution time = 1.9024e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359218179097
                                         uncertainty =       0.016717250727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359218179097
                                         uncertainty =       0.016717250727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423742237
  error estimate for blocks of size 2^( 2) =       0.000435955335
  error estimate for blocks of size 2^( 3) =       0.000449588407
  error estimate for blocks of size 2^( 4) =       0.000461640740
  error estimate for blocks of size 2^( 5) =       0.000470812907
  error estimate for blocks of size 2^( 6) =       0.000479003248
  error estimate for blocks of size 2^( 7) =       0.000483005198

      target function =                  N/A
              le_mean =     -16.906449772250
             les_mean =     286.187158689337
             stat err =       0.000473615523
             autocorr =       1.249247090216
              std dev =       0.599262018898
             le_variance =       0.359114967294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359218187709
                                         uncertainty =       0.016717252080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359218187709
                                         uncertainty =       0.016717252080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423742242
  error estimate for blocks of size 2^( 2) =       0.000435955339
  error estimate for blocks of size 2^( 3) =       0.000449588411
  error estimate for blocks of size 2^( 4) =       0.000461640745
  error estimate for blocks of size 2^( 5) =       0.000470812911
  error estimate for blocks of size 2^( 6) =       0.000479003252
  error estimate for blocks of size 2^( 7) =       0.000483005202

      target function =                  N/A
              le_mean =     -16.906449772313
             les_mean =     286.187158700069
             stat err =       0.000473615528
             autocorr =       1.249247082137
              std dev =       0.599262026079
             le_variance =       0.359114975900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359218183403
                                         uncertainty =       0.016717251403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359218183403
                                         uncertainty =       0.016717251403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423742240
  error estimate for blocks of size 2^( 2) =       0.000435955337
  error estimate for blocks of size 2^( 3) =       0.000449588409
  error estimate for blocks of size 2^( 4) =       0.000461640742
  error estimate for blocks of size 2^( 5) =       0.000470812909
  error estimate for blocks of size 2^( 6) =       0.000479003250
  error estimate for blocks of size 2^( 7) =       0.000483005200

      target function =                  N/A
              le_mean =     -16.906449772281
             les_mean =     286.187158694703
             stat err =       0.000473615525
             autocorr =       1.249247086178
              std dev =       0.599262022489
             le_variance =       0.359114971597

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359218179636
                                         uncertainty =       0.016717250811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359218179636
                                         uncertainty =       0.016717250811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423742238
  error estimate for blocks of size 2^( 2) =       0.000435955335
  error estimate for blocks of size 2^( 3) =       0.000449588407
  error estimate for blocks of size 2^( 4) =       0.000461640741
  error estimate for blocks of size 2^( 5) =       0.000470812907
  error estimate for blocks of size 2^( 6) =       0.000479003249
  error estimate for blocks of size 2^( 7) =       0.000483005198

      target function =                  N/A
              le_mean =     -16.906449772254
             les_mean =     286.187158690008
             stat err =       0.000473615524
             autocorr =       1.249247089710
              std dev =       0.599262019347
             le_variance =       0.359114967832


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906449772250        initial
     1.4901e+04     1.4901e+05             1.2581e-08       -16.906449772313  <--
     5.9605e+04     5.9605e+05             3.1453e-09       -16.906449772281
     2.3842e+05     2.3842e+06             7.8633e-10       -16.906449772254

*****************************************************************************
Applying the update for shift_i =   1.4901e+04     and shift_s =   1.4901e+05
*****************************************************************************

  Execution time = 3.3300e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978128e-02 1 1  ON 3
 uu_4                -6.600977e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493242e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283004e-01 1 1  ON 28
 eO_9                -9.249857e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758108e-03 1 1  ON 34
eH1_5                 3.783839e-02 1 1  ON 35
eH1_6                 9.718744e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951513e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511653e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691258e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9808e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.884
    reference variance = 0.21204
====================================================
  Execution time = 2.0536e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3744e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5402e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337281439516
                                         uncertainty =       0.003223517790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337281439516
                                         uncertainty =       0.003223517790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410757035
  error estimate for blocks of size 2^( 2) =       0.000423192685
  error estimate for blocks of size 2^( 3) =       0.000435962261
  error estimate for blocks of size 2^( 4) =       0.000446819931
  error estimate for blocks of size 2^( 5) =       0.000455871072
  error estimate for blocks of size 2^( 6) =       0.000464087272
  error estimate for blocks of size 2^( 7) =       0.000468247694

      target function =                  N/A
              le_mean =     -16.906826928533
             les_mean =     286.178239306519
             stat err =       0.000458756492
             autocorr =       1.247367502942
              std dev =       0.580898169975
             le_variance =       0.337442683880


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690682692853e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906826928533       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906826928299       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906826928229       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906826928323       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906826928475       residual = 7.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906826928452       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906826928433       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906826928449       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 5.563139e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906826928533       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906826928474       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906826928457       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906826928480       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906826928518       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906826928512       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906826928517       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906826928521       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.390822e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906826928533       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906826928518       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906826928514       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906826928520       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906826928560       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906826928523       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906826928526       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906826928573       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 3.477078e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.247154 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6083e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293956e-02 1 1  ON 2
 uu_3                -1.978128e-02 1 1  ON 3
 uu_4                -6.600976e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423620e-02 1 1  ON 12
 ud_3                -7.493239e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283004e-01 1 1  ON 28
 eO_9                -9.249858e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758094e-03 1 1  ON 34
eH1_5                 3.783838e-02 1 1  ON 35
eH1_6                 9.718744e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951514e-02 1 1  ON 39
eH2_0                -2.516176e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980486e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511651e-03 1 1  ON 44
eH2_5                 4.015960e-02 1 1  ON 45
eH2_6                 9.843145e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691259e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8842
    reference variance = 0.268608
====================================================
  Execution time = 2.0166e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4182e-01
  Total weights = 2.0000e+06
  Execution time = 1.9092e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341796605981
                                         uncertainty =       0.006578197021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341796605981
                                         uncertainty =       0.006578197021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413415625
  error estimate for blocks of size 2^( 2) =       0.000426370400
  error estimate for blocks of size 2^( 3) =       0.000440375077
  error estimate for blocks of size 2^( 4) =       0.000452849213
  error estimate for blocks of size 2^( 5) =       0.000463032221
  error estimate for blocks of size 2^( 6) =       0.000468673280
  error estimate for blocks of size 2^( 7) =       0.000475006029

      target function =                  N/A
              le_mean =     -16.906608646676
             les_mean =     286.175240718136
             stat err =       0.000464890186
             autocorr =       1.264523730341
              std dev =       0.584657983101
             le_variance =       0.341824957204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341796621949
                                         uncertainty =       0.006578197588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341796621949
                                         uncertainty =       0.006578197588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413415634
  error estimate for blocks of size 2^( 2) =       0.000426370409
  error estimate for blocks of size 2^( 3) =       0.000440375085
  error estimate for blocks of size 2^( 4) =       0.000452849221
  error estimate for blocks of size 2^( 5) =       0.000463032228
  error estimate for blocks of size 2^( 6) =       0.000468673288
  error estimate for blocks of size 2^( 7) =       0.000475006037

      target function =                  N/A
              le_mean =     -16.906608646660
             les_mean =     286.175240733561
             stat err =       0.000464890194
             autocorr =       1.264523713914
              std dev =       0.584657996735
             le_variance =       0.341824973146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341796613966
                                         uncertainty =       0.006578197304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341796613966
                                         uncertainty =       0.006578197304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413415629
  error estimate for blocks of size 2^( 2) =       0.000426370404
  error estimate for blocks of size 2^( 3) =       0.000440375081
  error estimate for blocks of size 2^( 4) =       0.000452849217
  error estimate for blocks of size 2^( 5) =       0.000463032225
  error estimate for blocks of size 2^( 6) =       0.000468673284
  error estimate for blocks of size 2^( 7) =       0.000475006033

      target function =                  N/A
              le_mean =     -16.906608646668
             les_mean =     286.175240725849
             stat err =       0.000464890190
             autocorr =       1.264523722126
              std dev =       0.584657989919
             le_variance =       0.341824965176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341796606979
                                         uncertainty =       0.006578197056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341796606979
                                         uncertainty =       0.006578197056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413415625
  error estimate for blocks of size 2^( 2) =       0.000426370400
  error estimate for blocks of size 2^( 3) =       0.000440375077
  error estimate for blocks of size 2^( 4) =       0.000452849214
  error estimate for blocks of size 2^( 5) =       0.000463032222
  error estimate for blocks of size 2^( 6) =       0.000468673281
  error estimate for blocks of size 2^( 7) =       0.000475006029

      target function =                  N/A
              le_mean =     -16.906608646675
             les_mean =     286.175240719100
             stat err =       0.000464890186
             autocorr =       1.264523729308
              std dev =       0.584657983953
             le_variance =       0.341824958200


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906608646676        initial  <--
     3.7253e+03     3.7253e+04             5.5631e-08       -16.906608646660
     1.4901e+04     1.4901e+05             1.3908e-08       -16.906608646668
     5.9605e+04     5.9605e+05             3.4771e-09       -16.906608646675

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8286
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978128e-02 1 1  ON 3
 uu_4                -6.600977e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493242e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283004e-01 1 1  ON 28
 eO_9                -9.249857e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758108e-03 1 1  ON 34
eH1_5                 3.783839e-02 1 1  ON 35
eH1_6                 9.718744e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951513e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477182e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511653e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691258e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5929e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.7991
    reference variance = 0.364034
====================================================
  Execution time = 2.0087e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3651e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5997e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336380045018
                                         uncertainty =       0.003338882403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336380045018
                                         uncertainty =       0.003338882403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410188956
  error estimate for blocks of size 2^( 2) =       0.000423212597
  error estimate for blocks of size 2^( 3) =       0.000436395449
  error estimate for blocks of size 2^( 4) =       0.000448874902
  error estimate for blocks of size 2^( 5) =       0.000458718198
  error estimate for blocks of size 2^( 6) =       0.000466343267
  error estimate for blocks of size 2^( 7) =       0.000469886558

      target function =                  N/A
              le_mean =     -16.906050240930
             les_mean =     286.151044539523
             stat err =       0.000460955731
             autocorr =       1.262846345459
              std dev =       0.580094784442
             le_variance =       0.336509958937


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690605024093e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906050240930       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906050240936       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906050240955       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906050240942       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906050240965       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906050240963       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906050240959       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906050240986       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 5.590010e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906050240930       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906050240931       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906050240936       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906050240849       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906050240916       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906050241374       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906050240996       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906050240842       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 1.397506e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906050240930       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906050240930       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906050240931       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906050240885       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906050240850       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906050240827       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906050240904       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906050240858       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 3.493770e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.249735 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5694e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978128e-02 1 1  ON 3
 uu_4                -6.600977e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493242e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283004e-01 1 1  ON 28
 eO_9                -9.249857e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758108e-03 1 1  ON 34
eH1_5                 3.783839e-02 1 1  ON 35
eH1_6                 9.718744e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951513e-02 1 1  ON 39
eH2_0                -2.516175e-01 1 1  ON 40
eH2_1                -1.477183e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511653e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691258e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9162
    reference variance = 0.437287
====================================================
  Execution time = 1.9914e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3533e-01
  Total weights = 2.0000e+06
  Execution time = 1.9149e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335223226947
                                         uncertainty =       0.003092656232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335223226947
                                         uncertainty =       0.003092656232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409471143
  error estimate for blocks of size 2^( 2) =       0.000422285909
  error estimate for blocks of size 2^( 3) =       0.000435201562
  error estimate for blocks of size 2^( 4) =       0.000447886821
  error estimate for blocks of size 2^( 5) =       0.000458859616
  error estimate for blocks of size 2^( 6) =       0.000467147715
  error estimate for blocks of size 2^( 7) =       0.000471737457

      target function =                  N/A
              le_mean =     -16.905987400454
             les_mean =     286.147743050301
             stat err =       0.000461407902
             autocorr =       1.269765301023
              std dev =       0.579079643610
             le_variance =       0.335333233643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335223230305
                                         uncertainty =       0.003092656261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335223230305
                                         uncertainty =       0.003092656261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409471145
  error estimate for blocks of size 2^( 2) =       0.000422285911
  error estimate for blocks of size 2^( 3) =       0.000435201564
  error estimate for blocks of size 2^( 4) =       0.000447886822
  error estimate for blocks of size 2^( 5) =       0.000458859618
  error estimate for blocks of size 2^( 6) =       0.000467147716
  error estimate for blocks of size 2^( 7) =       0.000471737459

      target function =                  N/A
              le_mean =     -16.905987400483
             les_mean =     286.147743054612
             stat err =       0.000461407904
             autocorr =       1.269765297222
              std dev =       0.579079646508
             le_variance =       0.335333236999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335223228626
                                         uncertainty =       0.003092656246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335223228626
                                         uncertainty =       0.003092656246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409471144
  error estimate for blocks of size 2^( 2) =       0.000422285910
  error estimate for blocks of size 2^( 3) =       0.000435201563
  error estimate for blocks of size 2^( 4) =       0.000447886821
  error estimate for blocks of size 2^( 5) =       0.000458859617
  error estimate for blocks of size 2^( 6) =       0.000467147716
  error estimate for blocks of size 2^( 7) =       0.000471737458

      target function =                  N/A
              le_mean =     -16.905987400469
             les_mean =     286.147743052457
             stat err =       0.000461407903
             autocorr =       1.269765299128
              std dev =       0.579079645059
             le_variance =       0.335333235321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335223227157
                                         uncertainty =       0.003092656233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335223227157
                                         uncertainty =       0.003092656233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409471143
  error estimate for blocks of size 2^( 2) =       0.000422285909
  error estimate for blocks of size 2^( 3) =       0.000435201563
  error estimate for blocks of size 2^( 4) =       0.000447886821
  error estimate for blocks of size 2^( 5) =       0.000458859616
  error estimate for blocks of size 2^( 6) =       0.000467147715
  error estimate for blocks of size 2^( 7) =       0.000471737457

      target function =                  N/A
              le_mean =     -16.905987400456
             les_mean =     286.147743050570
             stat err =       0.000461407902
             autocorr =       1.269765300794
              std dev =       0.579079643791
             le_variance =       0.335333233853


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905987400454        initial
     3.7253e+04     3.7253e+05             5.5900e-09       -16.905987400483  <--
     1.4901e+05     1.4901e+06             1.3975e-09       -16.905987400469
     5.9605e+05     5.9605e+06             3.4938e-10       -16.905987400456

*****************************************************************************
Applying the update for shift_i =   3.7253e+04     and shift_s =   3.7253e+05
*****************************************************************************

  Execution time = 2.9591e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978128e-02 1 1  ON 3
 uu_4                -6.600977e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493242e-03 1 1  ON 13
 ud_4                -6.482395e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819228e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283004e-01 1 1  ON 28
 eO_9                -9.249857e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758109e-03 1 1  ON 34
eH1_5                 3.783839e-02 1 1  ON 35
eH1_6                 9.718744e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951514e-02 1 1  ON 39
eH2_0                -2.516176e-01 1 1  ON 40
eH2_1                -1.477183e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511654e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691259e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5335e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9398
    reference variance = 0.272281
====================================================
  Execution time = 2.0389e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3956e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5518e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339674571849
                                         uncertainty =       0.003798836014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339674571849
                                         uncertainty =       0.003798836014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412043213
  error estimate for blocks of size 2^( 2) =       0.000424643337
  error estimate for blocks of size 2^( 3) =       0.000438237514
  error estimate for blocks of size 2^( 4) =       0.000450311791
  error estimate for blocks of size 2^( 5) =       0.000462060904
  error estimate for blocks of size 2^( 6) =       0.000470285768
  error estimate for blocks of size 2^( 7) =       0.000476376624

      target function =                  N/A
              le_mean =     -16.906057748451
             les_mean =     286.154347642200
             stat err =       0.000464758772
             autocorr =       1.272241803362
              std dev =       0.582717099485
             le_variance =       0.339559218032


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690605774845e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906057748451       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906057748489       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906057748413       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906057748428       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906057748443       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906057748471       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906057748460       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906057748472       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 2.819053e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906057748451       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906057748460       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906057748441       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906057748444       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906057748449       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906057748455       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906057748416       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906057748458       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 7.047650e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906057748451       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906057748453       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906057748448       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906057748421       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906057748440       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906057748431       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906057748451       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906057748506       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 1.761913e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.252335 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5948e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978128e-02 1 1  ON 3
 uu_4                -6.600977e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493241e-03 1 1  ON 13
 ud_4                -6.482396e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819228e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230737e-02 1 1  ON 27
 eO_8                -2.283004e-01 1 1  ON 28
 eO_9                -9.249857e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758107e-03 1 1  ON 34
eH1_5                 3.783838e-02 1 1  ON 35
eH1_6                 9.718744e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951514e-02 1 1  ON 39
eH2_0                -2.516176e-01 1 1  ON 40
eH2_1                -1.477183e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511652e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843144e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691259e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9053
    reference variance = 0.261955
====================================================
  Execution time = 2.0719e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3559e-01
  Total weights = 2.0000e+06
  Execution time = 1.8921e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335449821052
                                         uncertainty =       0.003063853336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335449821052
                                         uncertainty =       0.003063853336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409626849
  error estimate for blocks of size 2^( 2) =       0.000422177584
  error estimate for blocks of size 2^( 3) =       0.000435019127
  error estimate for blocks of size 2^( 4) =       0.000446444154
  error estimate for blocks of size 2^( 5) =       0.000456686773
  error estimate for blocks of size 2^( 6) =       0.000463846029
  error estimate for blocks of size 2^( 7) =       0.000468713896

      target function =                  N/A
              le_mean =     -16.906568823851
             les_mean =     286.167657538387
             stat err =       0.000458922713
             autocorr =       1.255169206802
              std dev =       0.579299845140
             le_variance =       0.335588310579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335449814778
                                         uncertainty =       0.003063853251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335449814778
                                         uncertainty =       0.003063853251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409626845
  error estimate for blocks of size 2^( 2) =       0.000422177580
  error estimate for blocks of size 2^( 3) =       0.000435019124
  error estimate for blocks of size 2^( 4) =       0.000446444151
  error estimate for blocks of size 2^( 5) =       0.000456686771
  error estimate for blocks of size 2^( 6) =       0.000463846027
  error estimate for blocks of size 2^( 7) =       0.000468713894

      target function =                  N/A
              le_mean =     -16.906568824045
             les_mean =     286.167657538696
             stat err =       0.000458922711
             autocorr =       1.255169215640
              std dev =       0.579299839725
             le_variance =       0.335588304305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335449817915
                                         uncertainty =       0.003063853294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335449817915
                                         uncertainty =       0.003063853294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409626847
  error estimate for blocks of size 2^( 2) =       0.000422177582
  error estimate for blocks of size 2^( 3) =       0.000435019125
  error estimate for blocks of size 2^( 4) =       0.000446444153
  error estimate for blocks of size 2^( 5) =       0.000456686772
  error estimate for blocks of size 2^( 6) =       0.000463846028
  error estimate for blocks of size 2^( 7) =       0.000468713895

      target function =                  N/A
              le_mean =     -16.906568823948
             les_mean =     286.167657538542
             stat err =       0.000458922712
             autocorr =       1.255169211223
              std dev =       0.579299842432
             le_variance =       0.335588307442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335449820659
                                         uncertainty =       0.003063853331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335449820659
                                         uncertainty =       0.003063853331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409626849
  error estimate for blocks of size 2^( 2) =       0.000422177584
  error estimate for blocks of size 2^( 3) =       0.000435019126
  error estimate for blocks of size 2^( 4) =       0.000446444154
  error estimate for blocks of size 2^( 5) =       0.000456686773
  error estimate for blocks of size 2^( 6) =       0.000463846029
  error estimate for blocks of size 2^( 7) =       0.000468713896

      target function =                  N/A
              le_mean =     -16.906568823863
             les_mean =     286.167657538407
             stat err =       0.000458922713
             autocorr =       1.255169207346
              std dev =       0.579299844801
             le_variance =       0.335588310187


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906568823851        initial
     9.3132e+03     9.3132e+04             2.8191e-08       -16.906568824045  <--
     3.7253e+04     3.7253e+05             7.0476e-09       -16.906568823948
     1.4901e+05     1.4901e+06             1.7619e-09       -16.906568823863

*****************************************************************************
Applying the update for shift_i =   9.3132e+03     and shift_s =   9.3132e+04
*****************************************************************************

  Execution time = 3.0264e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600976e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423620e-02 1 1  ON 12
 ud_3                -7.493239e-03 1 1  ON 13
 ud_4                -6.482396e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230736e-02 1 1  ON 27
 eO_8                -2.283004e-01 1 1  ON 28
 eO_9                -9.249858e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827982e-02 1 1  ON 33
eH1_4                 1.758104e-03 1 1  ON 34
eH1_5                 3.783837e-02 1 1  ON 35
eH1_6                 9.718744e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951516e-02 1 1  ON 39
eH2_0                -2.516176e-01 1 1  ON 40
eH2_1                -1.477183e-01 1 1  ON 41
eH2_2                -9.980486e-02 1 1  ON 42
eH2_3                -4.503147e-02 1 1  ON 43
eH2_4                 4.511648e-03 1 1  ON 44
eH2_5                 4.015960e-02 1 1  ON 45
eH2_6                 9.843145e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691261e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6801e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8714
    reference variance = 0.270623
====================================================
  Execution time = 2.0257e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3238e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5386e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332451574367
                                         uncertainty =       0.002706907215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332451574367
                                         uncertainty =       0.002706907215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407664292
  error estimate for blocks of size 2^( 2) =       0.000420116746
  error estimate for blocks of size 2^( 3) =       0.000433361740
  error estimate for blocks of size 2^( 4) =       0.000445766900
  error estimate for blocks of size 2^( 5) =       0.000455436249
  error estimate for blocks of size 2^( 6) =       0.000462005220
  error estimate for blocks of size 2^( 7) =       0.000467121295

      target function =                  N/A
              le_mean =     -16.905858382698
             les_mean =     286.140427840012
             stat err =       0.000457582416
             autocorr =       1.259891969176
              std dev =       0.576524371006
             le_variance =       0.332380350363


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690585838270e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905858382698       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905858382827       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905858382662       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905858382584       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905858382715       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905858382815       residual = 8.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905858382917       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905858382871       residual = 6.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 9.536514e-08

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905858382698       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905858382730       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905858382689       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905858382671       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905858382701       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905858382726       residual = 8.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905858382752       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905858382722       residual = 6.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 2.384175e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905858382698       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905858382706       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905858382696       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905858382691       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905858382703       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905858382707       residual = 8.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905858382724       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905858382712       residual = 6.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 5.960467e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.254912 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5802e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293956e-02 1 1  ON 2
 uu_3                -1.978128e-02 1 1  ON 3
 uu_4                -6.600975e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493234e-03 1 1  ON 13
 ud_4                -6.482396e-02 1 1  ON 14
 ud_5                -1.070183e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819227e-02 1 1  ON 22
 eO_3                 2.998420e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230736e-02 1 1  ON 27
 eO_8                -2.283004e-01 1 1  ON 28
 eO_9                -9.249860e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827980e-02 1 1  ON 33
eH1_4                 1.758095e-03 1 1  ON 34
eH1_5                 3.783835e-02 1 1  ON 35
eH1_6                 9.718744e-02 1 1  ON 36
eH1_7                 1.565090e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951517e-02 1 1  ON 39
eH2_0                -2.516176e-01 1 1  ON 40
eH2_1                -1.477183e-01 1 1  ON 41
eH2_2                -9.980486e-02 1 1  ON 42
eH2_3                -4.503146e-02 1 1  ON 43
eH2_4                 4.511655e-03 1 1  ON 44
eH2_5                 4.015959e-02 1 1  ON 45
eH2_6                 9.843145e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691263e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9362
    reference variance = 0.273968
====================================================
  Execution time = 2.0197e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4051e-01
  Total weights = 2.0000e+06
  Execution time = 1.9000e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340514420051
                                         uncertainty =       0.003738580350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340514420051
                                         uncertainty =       0.003738580350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412616795
  error estimate for blocks of size 2^( 2) =       0.000425442783
  error estimate for blocks of size 2^( 3) =       0.000438162344
  error estimate for blocks of size 2^( 4) =       0.000449921672
  error estimate for blocks of size 2^( 5) =       0.000459980144
  error estimate for blocks of size 2^( 6) =       0.000466506855
  error estimate for blocks of size 2^( 7) =       0.000471753822

      target function =                  N/A
              le_mean =     -16.906547067929
             les_mean =     286.171838828886
             stat err =       0.000462040623
             autocorr =       1.253910441783
              std dev =       0.583528267560
             le_variance =       0.340505239041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340514452325
                                         uncertainty =       0.003738580420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340514452325
                                         uncertainty =       0.003738580420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412616815
  error estimate for blocks of size 2^( 2) =       0.000425442801
  error estimate for blocks of size 2^( 3) =       0.000438162361
  error estimate for blocks of size 2^( 4) =       0.000449921689
  error estimate for blocks of size 2^( 5) =       0.000459980160
  error estimate for blocks of size 2^( 6) =       0.000466506869
  error estimate for blocks of size 2^( 7) =       0.000471753838

      target function =                  N/A
              le_mean =     -16.906547067043
             les_mean =     286.171838831197
             stat err =       0.000462040639
             autocorr =       1.253910409436
              std dev =       0.583528295194
             le_variance =       0.340505271292

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340514436190
                                         uncertainty =       0.003738580385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340514436190
                                         uncertainty =       0.003738580385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412616805
  error estimate for blocks of size 2^( 2) =       0.000425442792
  error estimate for blocks of size 2^( 3) =       0.000438162352
  error estimate for blocks of size 2^( 4) =       0.000449921680
  error estimate for blocks of size 2^( 5) =       0.000459980152
  error estimate for blocks of size 2^( 6) =       0.000466506862
  error estimate for blocks of size 2^( 7) =       0.000471753830

      target function =                  N/A
              le_mean =     -16.906547067486
             les_mean =     286.171838830042
             stat err =       0.000462040631
             autocorr =       1.253910425611
              std dev =       0.583528281379
             le_variance =       0.340505255169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340514422068
                                         uncertainty =       0.003738580354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340514422068
                                         uncertainty =       0.003738580354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412616796
  error estimate for blocks of size 2^( 2) =       0.000425442785
  error estimate for blocks of size 2^( 3) =       0.000438162345
  error estimate for blocks of size 2^( 4) =       0.000449921673
  error estimate for blocks of size 2^( 5) =       0.000459980145
  error estimate for blocks of size 2^( 6) =       0.000466506856
  error estimate for blocks of size 2^( 7) =       0.000471753823

      target function =                  N/A
              le_mean =     -16.906547067874
             les_mean =     286.171838829030
             stat err =       0.000462040624
             autocorr =       1.253910439758
              std dev =       0.583528269287
             le_variance =       0.340505241057


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906547067929        initial  <--
     2.3283e+03     2.3283e+04             9.5365e-08       -16.906547067043
     9.3132e+03     9.3132e+04             2.3842e-08       -16.906547067486
     3.7253e+04     3.7253e+05             5.9605e-09       -16.906547067874

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7964
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978127e-02 1 1  ON 3
 uu_4                -6.600976e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423620e-02 1 1  ON 12
 ud_3                -7.493239e-03 1 1  ON 13
 ud_4                -6.482396e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230736e-02 1 1  ON 27
 eO_8                -2.283004e-01 1 1  ON 28
 eO_9                -9.249858e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827982e-02 1 1  ON 33
eH1_4                 1.758104e-03 1 1  ON 34
eH1_5                 3.783837e-02 1 1  ON 35
eH1_6                 9.718744e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951516e-02 1 1  ON 39
eH2_0                -2.516176e-01 1 1  ON 40
eH2_1                -1.477183e-01 1 1  ON 41
eH2_2                -9.980486e-02 1 1  ON 42
eH2_3                -4.503147e-02 1 1  ON 43
eH2_4                 4.511648e-03 1 1  ON 44
eH2_5                 4.015960e-02 1 1  ON 45
eH2_6                 9.843145e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691261e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5890e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9099
    reference variance = 0.248344
====================================================
  Execution time = 2.1226e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4879e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7328e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348871505832
                                         uncertainty =       0.004900038445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348871505832
                                         uncertainty =       0.004900038445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417605566
  error estimate for blocks of size 2^( 2) =       0.000430198685
  error estimate for blocks of size 2^( 3) =       0.000443273580
  error estimate for blocks of size 2^( 4) =       0.000456383624
  error estimate for blocks of size 2^( 5) =       0.000466174828
  error estimate for blocks of size 2^( 6) =       0.000473578518
  error estimate for blocks of size 2^( 7) =       0.000481600960

      target function =                  N/A
              le_mean =     -16.905296472533
             les_mean =     286.137837467166
             stat err =       0.000469434482
             autocorr =       1.263622698729
              std dev =       0.590583455008
             le_variance =       0.348788817329


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690529647253e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905296472533       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905296472556       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905296472530       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905296472570       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905296472556       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905296472558       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905296472562       residual = 9.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 9.924306e-09

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905296472533       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905296472539       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905296472532       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905296472542       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905296472544       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905296472607       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905296472544       residual = 9.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.481079e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905296472533       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905296472534       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905296472533       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905296472564       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905296472489       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905296472537       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905296472522       residual = 9.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 6.202697e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.257114 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6965e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978128e-02 1 1  ON 3
 uu_4                -6.600976e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852761e-01 1 1  ON 11
 ud_2                 6.423620e-02 1 1  ON 12
 ud_3                -7.493238e-03 1 1  ON 13
 ud_4                -6.482396e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230736e-02 1 1  ON 27
 eO_8                -2.283004e-01 1 1  ON 28
 eO_9                -9.249858e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827982e-02 1 1  ON 33
eH1_4                 1.758103e-03 1 1  ON 34
eH1_5                 3.783837e-02 1 1  ON 35
eH1_6                 9.718744e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951516e-02 1 1  ON 39
eH2_0                -2.516176e-01 1 1  ON 40
eH2_1                -1.477183e-01 1 1  ON 41
eH2_2                -9.980486e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511647e-03 1 1  ON 44
eH2_5                 4.015960e-02 1 1  ON 45
eH2_6                 9.843145e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691262e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8249
    reference variance = 0.323874
====================================================
  Execution time = 2.0937e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4246e-01
  Total weights = 2.0000e+06
  Execution time = 1.8966e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342542141717
                                         uncertainty =       0.003945831579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342542141717
                                         uncertainty =       0.003945831579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413797741
  error estimate for blocks of size 2^( 2) =       0.000426592246
  error estimate for blocks of size 2^( 3) =       0.000439361978
  error estimate for blocks of size 2^( 4) =       0.000450989856
  error estimate for blocks of size 2^( 5) =       0.000460891847
  error estimate for blocks of size 2^( 6) =       0.000468344082
  error estimate for blocks of size 2^( 7) =       0.000472314125

      target function =                  N/A
              le_mean =     -16.905689896726
             les_mean =     286.144807854467
             stat err =       0.000463134977
             autocorr =       1.252676503629
              std dev =       0.585198377857
             le_variance =       0.342457141447

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342542147584
                                         uncertainty =       0.003945831717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342542147584
                                         uncertainty =       0.003945831717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413797745
  error estimate for blocks of size 2^( 2) =       0.000426592249
  error estimate for blocks of size 2^( 3) =       0.000439361981
  error estimate for blocks of size 2^( 4) =       0.000450989860
  error estimate for blocks of size 2^( 5) =       0.000460891850
  error estimate for blocks of size 2^( 6) =       0.000468344085
  error estimate for blocks of size 2^( 7) =       0.000472314128

      target function =                  N/A
              le_mean =     -16.905689896730
             les_mean =     286.144807860497
             stat err =       0.000463134981
             autocorr =       1.252676499351
              std dev =       0.585198382867
             le_variance =       0.342457147310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342542144651
                                         uncertainty =       0.003945831648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342542144651
                                         uncertainty =       0.003945831648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413797743
  error estimate for blocks of size 2^( 2) =       0.000426592247
  error estimate for blocks of size 2^( 3) =       0.000439361980
  error estimate for blocks of size 2^( 4) =       0.000450989858
  error estimate for blocks of size 2^( 5) =       0.000460891848
  error estimate for blocks of size 2^( 6) =       0.000468344083
  error estimate for blocks of size 2^( 7) =       0.000472314127

      target function =                  N/A
              le_mean =     -16.905689896728
             les_mean =     286.144807857482
             stat err =       0.000463134979
             autocorr =       1.252676501486
              std dev =       0.585198380362
             le_variance =       0.342457144378

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342542142084
                                         uncertainty =       0.003945831587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342542142084
                                         uncertainty =       0.003945831587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413797742
  error estimate for blocks of size 2^( 2) =       0.000426592246
  error estimate for blocks of size 2^( 3) =       0.000439361978
  error estimate for blocks of size 2^( 4) =       0.000450989857
  error estimate for blocks of size 2^( 5) =       0.000460891847
  error estimate for blocks of size 2^( 6) =       0.000468344082
  error estimate for blocks of size 2^( 7) =       0.000472314125

      target function =                  N/A
              le_mean =     -16.905689896726
             les_mean =     286.144807854844
             stat err =       0.000463134978
             autocorr =       1.252676503358
              std dev =       0.585198378170
             le_variance =       0.342457141813


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905689896726        initial
     2.3283e+04     2.3283e+05             9.9243e-09       -16.905689896730  <--
     9.3132e+04     9.3132e+05             2.4811e-09       -16.905689896728
     3.7253e+05     3.7253e+06             6.2027e-10       -16.905689896726

*****************************************************************************
Applying the update for shift_i =   2.3283e+04     and shift_s =   2.3283e+05
*****************************************************************************

  Execution time = 3.0552e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293957e-02 1 1  ON 2
 uu_3                -1.978128e-02 1 1  ON 3
 uu_4                -6.600976e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852761e-01 1 1  ON 11
 ud_2                 6.423620e-02 1 1  ON 12
 ud_3                -7.493236e-03 1 1  ON 13
 ud_4                -6.482396e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819229e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230736e-02 1 1  ON 27
 eO_8                -2.283004e-01 1 1  ON 28
 eO_9                -9.249859e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032894e-01 1 1  ON 32
eH1_3                -4.827981e-02 1 1  ON 33
eH1_4                 1.758099e-03 1 1  ON 34
eH1_5                 3.783837e-02 1 1  ON 35
eH1_6                 9.718744e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951517e-02 1 1  ON 39
eH2_0                -2.516176e-01 1 1  ON 40
eH2_1                -1.477183e-01 1 1  ON 41
eH2_2                -9.980486e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511644e-03 1 1  ON 44
eH2_5                 4.015960e-02 1 1  ON 45
eH2_6                 9.843146e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691262e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7712e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.929
    reference variance = 0.197935
====================================================
  Execution time = 2.2487e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 4.1518e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5696e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.415404909440
                                         uncertainty =       0.074989989552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.415404909440
                                         uncertainty =       0.074989989552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000455619045
  error estimate for blocks of size 2^( 2) =       0.000467241223
  error estimate for blocks of size 2^( 3) =       0.000478873166
  error estimate for blocks of size 2^( 4) =       0.000490987499
  error estimate for blocks of size 2^( 5) =       0.000501633769
  error estimate for blocks of size 2^( 6) =       0.000511528479
  error estimate for blocks of size 2^( 7) =       0.000516795140

      target function =                  N/A
              le_mean =     -16.905603818831
             les_mean =     286.214617699187
             stat err =       0.000505236222
             autocorr =       1.229660490704
              std dev =       0.644342632082
             le_variance =       0.415177427519


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690560381883e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905603818831       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905603819079       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905603819130       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905603819158       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905603819313       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905603819310       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905603819293       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905603819277       residual = 6.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 4.526928e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905603818831       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905603818893       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905603818905       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905603818923       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905603818939       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905603818945       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905603818944       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905603818939       residual = 6.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 1.131754e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905603818831       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905603818846       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905603818849       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905603818851       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905603818851       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905603818797       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905603818911       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905603818874       residual = 6.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.829400e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.259691 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8064e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293956e-02 1 1  ON 2
 uu_3                -1.978128e-02 1 1  ON 3
 uu_4                -6.600976e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293716e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852761e-01 1 1  ON 11
 ud_2                 6.423619e-02 1 1  ON 12
 ud_3                -7.493233e-03 1 1  ON 13
 ud_4                -6.482397e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819228e-02 1 1  ON 22
 eO_3                 2.998419e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230736e-02 1 1  ON 27
 eO_8                -2.283004e-01 1 1  ON 28
 eO_9                -9.249859e-02 1 1  ON 29
eH1_0                -2.549657e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032895e-01 1 1  ON 32
eH1_3                -4.827982e-02 1 1  ON 33
eH1_4                 1.758096e-03 1 1  ON 34
eH1_5                 3.783836e-02 1 1  ON 35
eH1_6                 9.718744e-02 1 1  ON 36
eH1_7                 1.565090e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951517e-02 1 1  ON 39
eH2_0                -2.516176e-01 1 1  ON 40
eH2_1                -1.477183e-01 1 1  ON 41
eH2_2                -9.980486e-02 1 1  ON 42
eH2_3                -4.503148e-02 1 1  ON 43
eH2_4                 4.511642e-03 1 1  ON 44
eH2_5                 4.015960e-02 1 1  ON 45
eH2_6                 9.843146e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691263e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8953
    reference variance = 0.180138
====================================================
  Execution time = 2.0048e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3765e-01
  Total weights = 2.0000e+06
  Execution time = 1.9058e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337698375988
                                         uncertainty =       0.005351090862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337698375988
                                         uncertainty =       0.005351090862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410883920
  error estimate for blocks of size 2^( 2) =       0.000423591777
  error estimate for blocks of size 2^( 3) =       0.000436564423
  error estimate for blocks of size 2^( 4) =       0.000448987043
  error estimate for blocks of size 2^( 5) =       0.000459863722
  error estimate for blocks of size 2^( 6) =       0.000468122323
  error estimate for blocks of size 2^( 7) =       0.000472348433

      target function =                  N/A
              le_mean =     -16.906413615365
             les_mean =     286.164472357093
             stat err =       0.000462330380
             autocorr =       1.266095812964
              std dev =       0.581077612833
             le_variance =       0.337651192136

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337698400027
                                         uncertainty =       0.005351091541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337698400027
                                         uncertainty =       0.005351091541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410883935
  error estimate for blocks of size 2^( 2) =       0.000423591790
  error estimate for blocks of size 2^( 3) =       0.000436564436
  error estimate for blocks of size 2^( 4) =       0.000448987056
  error estimate for blocks of size 2^( 5) =       0.000459863734
  error estimate for blocks of size 2^( 6) =       0.000468122335
  error estimate for blocks of size 2^( 7) =       0.000472348446

      target function =                  N/A
              le_mean =     -16.906413615515
             les_mean =     286.164472386213
             stat err =       0.000462330393
             autocorr =       1.266095792040
              std dev =       0.581077633506
             le_variance =       0.337651216161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337698388008
                                         uncertainty =       0.005351091201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337698388008
                                         uncertainty =       0.005351091201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410883928
  error estimate for blocks of size 2^( 2) =       0.000423591783
  error estimate for blocks of size 2^( 3) =       0.000436564430
  error estimate for blocks of size 2^( 4) =       0.000448987049
  error estimate for blocks of size 2^( 5) =       0.000459863728
  error estimate for blocks of size 2^( 6) =       0.000468122329
  error estimate for blocks of size 2^( 7) =       0.000472348439

      target function =                  N/A
              le_mean =     -16.906413615440
             les_mean =     286.164472371654
             stat err =       0.000462330386
             autocorr =       1.266095802508
              std dev =       0.581077623170
             le_variance =       0.337651204149

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337698377490
                                         uncertainty =       0.005351090904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337698377490
                                         uncertainty =       0.005351090904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410883921
  error estimate for blocks of size 2^( 2) =       0.000423591777
  error estimate for blocks of size 2^( 3) =       0.000436564424
  error estimate for blocks of size 2^( 4) =       0.000448987044
  error estimate for blocks of size 2^( 5) =       0.000459863722
  error estimate for blocks of size 2^( 6) =       0.000468122323
  error estimate for blocks of size 2^( 7) =       0.000472348434

      target function =                  N/A
              le_mean =     -16.906413615374
             les_mean =     286.164472358913
             stat err =       0.000462330381
             autocorr =       1.266095811659
              std dev =       0.581077614125
             le_variance =       0.337651193637


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906413615365        initial
     5.8208e+03     5.8208e+04             4.5269e-08       -16.906413615515  <--
     2.3283e+04     2.3283e+05             1.1318e-08       -16.906413615440
     9.3132e+04     9.3132e+05             2.8294e-09       -16.906413615374

*****************************************************************************
Applying the update for shift_i =   5.8208e+03     and shift_s =   5.8208e+04
*****************************************************************************

  Execution time = 2.9659e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293954e-02 1 1  ON 2
 uu_3                -1.978130e-02 1 1  ON 3
 uu_4                -6.600977e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293717e-01 1 1  ON 6
 uu_7                -1.441038e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852761e-01 1 1  ON 11
 ud_2                 6.423618e-02 1 1  ON 12
 ud_3                -7.493223e-03 1 1  ON 13
 ud_4                -6.482398e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352787e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819228e-02 1 1  ON 22
 eO_3                 2.998420e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230736e-02 1 1  ON 27
 eO_8                -2.283004e-01 1 1  ON 28
 eO_9                -9.249860e-02 1 1  ON 29
eH1_0                -2.549658e-01 1 1  ON 30
eH1_1                -1.518816e-01 1 1  ON 31
eH1_2                -1.032895e-01 1 1  ON 32
eH1_3                -4.827982e-02 1 1  ON 33
eH1_4                 1.758088e-03 1 1  ON 34
eH1_5                 3.783834e-02 1 1  ON 35
eH1_6                 9.718743e-02 1 1  ON 36
eH1_7                 1.565090e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951520e-02 1 1  ON 39
eH2_0                -2.516176e-01 1 1  ON 40
eH2_1                -1.477183e-01 1 1  ON 41
eH2_2                -9.980487e-02 1 1  ON 42
eH2_3                -4.503147e-02 1 1  ON 43
eH2_4                 4.511638e-03 1 1  ON 44
eH2_5                 4.015961e-02 1 1  ON 45
eH2_6                 9.843147e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691266e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7948e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9604
    reference variance = 0.20139
====================================================
  Execution time = 2.0529e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4121e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5325e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341274159659
                                         uncertainty =       0.003594370560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341274159659
                                         uncertainty =       0.003594370560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413044686
  error estimate for blocks of size 2^( 2) =       0.000425693339
  error estimate for blocks of size 2^( 3) =       0.000438465793
  error estimate for blocks of size 2^( 4) =       0.000449911789
  error estimate for blocks of size 2^( 5) =       0.000459492723
  error estimate for blocks of size 2^( 6) =       0.000465649875
  error estimate for blocks of size 2^( 7) =       0.000470343997

      target function =                  N/A
              le_mean =     -16.906671168557
             les_mean =     286.176741656430
             stat err =       0.000461349596
             autocorr =       1.247573699306
              std dev =       0.584133396860
             le_variance =       0.341211825327


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690667116856e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906671168557       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906671168921       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906671168469       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906671168364       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906671168262       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906671168406       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906671168339       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906671168444       residual = 6.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 1.496683e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906671168557       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906671168648       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906671168535       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906671168509       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906671168485       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906671168518       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906671168505       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906671168538       residual = 6.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 3.741747e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906671168557       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906671168580       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906671168551       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906671168545       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906671168547       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906671168545       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906671168535       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906671168555       residual = 6.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 9.354393e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.262293 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6068e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.115759e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293952e-02 1 1  ON 2
 uu_3                -1.978131e-02 1 1  ON 3
 uu_4                -6.600975e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293717e-01 1 1  ON 6
 uu_7                -1.441039e-01 1 1  ON 7
 uu_8                -1.378682e-01 1 1  ON 8
 uu_9                -1.087591e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423616e-02 1 1  ON 12
 ud_3                -7.493197e-03 1 1  ON 13
 ud_4                -6.482399e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352786e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418142e-01 1 1  ON 19
 eO_0                -7.569958e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819227e-02 1 1  ON 22
 eO_3                 2.998420e-01 1 1  ON 23
 eO_4                 5.270156e-01 1 1  ON 24
 eO_5                 4.892156e-01 1 1  ON 25
 eO_6                 2.599631e-01 1 1  ON 26
 eO_7                -4.230736e-02 1 1  ON 27
 eO_8                -2.283004e-01 1 1  ON 28
 eO_9                -9.249863e-02 1 1  ON 29
eH1_0                -2.549658e-01 1 1  ON 30
eH1_1                -1.518816e-01 1 1  ON 31
eH1_2                -1.032895e-01 1 1  ON 32
eH1_3                -4.827980e-02 1 1  ON 33
eH1_4                 1.758062e-03 1 1  ON 34
eH1_5                 3.783831e-02 1 1  ON 35
eH1_6                 9.718742e-02 1 1  ON 36
eH1_7                 1.565090e-01 1 1  ON 37
eH1_8                 1.867347e-01 1 1  ON 38
eH1_9                 7.951523e-02 1 1  ON 39
eH2_0                -2.516176e-01 1 1  ON 40
eH2_1                -1.477184e-01 1 1  ON 41
eH2_2                -9.980485e-02 1 1  ON 42
eH2_3                -4.503146e-02 1 1  ON 43
eH2_4                 4.511641e-03 1 1  ON 44
eH2_5                 4.015960e-02 1 1  ON 45
eH2_6                 9.843147e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912079e-01 1 1  ON 48
eH2_9                 6.691270e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9766
    reference variance = 0.304191
====================================================
  Execution time = 2.0018e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3163e-01
  Total weights = 2.0000e+06
  Execution time = 1.9028e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331629374235
                                         uncertainty =       0.002742692735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331629374235
                                         uncertainty =       0.002742692735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407206038
  error estimate for blocks of size 2^( 2) =       0.000419713383
  error estimate for blocks of size 2^( 3) =       0.000432940520
  error estimate for blocks of size 2^( 4) =       0.000445790298
  error estimate for blocks of size 2^( 5) =       0.000456332849
  error estimate for blocks of size 2^( 6) =       0.000464401765
  error estimate for blocks of size 2^( 7) =       0.000470467651

      target function =                  N/A
              le_mean =     -16.905734909794
             les_mean =     286.135506188434
             stat err =       0.000459248141
             autocorr =       1.271939330576
              std dev =       0.575876300984
             le_variance =       0.331633514035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331629447962
                                         uncertainty =       0.002742693490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331629447962
                                         uncertainty =       0.002742693490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407206083
  error estimate for blocks of size 2^( 2) =       0.000419713423
  error estimate for blocks of size 2^( 3) =       0.000432940557
  error estimate for blocks of size 2^( 4) =       0.000445790334
  error estimate for blocks of size 2^( 5) =       0.000456332883
  error estimate for blocks of size 2^( 6) =       0.000464401797
  error estimate for blocks of size 2^( 7) =       0.000470467689

      target function =                  N/A
              le_mean =     -16.905734910262
             les_mean =     286.135506278071
             stat err =       0.000459248176
             autocorr =       1.271939240590
              std dev =       0.575876365051
             le_variance =       0.331633587825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331629411106
                                         uncertainty =       0.002742693113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331629411106
                                         uncertainty =       0.002742693113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407206060
  error estimate for blocks of size 2^( 2) =       0.000419713403
  error estimate for blocks of size 2^( 3) =       0.000432940538
  error estimate for blocks of size 2^( 4) =       0.000445790316
  error estimate for blocks of size 2^( 5) =       0.000456332866
  error estimate for blocks of size 2^( 6) =       0.000464401781
  error estimate for blocks of size 2^( 7) =       0.000470467670

      target function =                  N/A
              le_mean =     -16.905734910028
             les_mean =     286.135506233263
             stat err =       0.000459248158
             autocorr =       1.271939285577
              std dev =       0.575876333024
             le_variance =       0.331633550938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331629378844
                                         uncertainty =       0.002742692782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331629378844
                                         uncertainty =       0.002742692782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407206040
  error estimate for blocks of size 2^( 2) =       0.000419713385
  error estimate for blocks of size 2^( 3) =       0.000432940522
  error estimate for blocks of size 2^( 4) =       0.000445790301
  error estimate for blocks of size 2^( 5) =       0.000456332851
  error estimate for blocks of size 2^( 6) =       0.000464401767
  error estimate for blocks of size 2^( 7) =       0.000470467653

      target function =                  N/A
              le_mean =     -16.905734909823
             les_mean =     286.135506194038
             stat err =       0.000459248143
             autocorr =       1.271939324947
              std dev =       0.575876304989
             le_variance =       0.331633518648


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905734909794        initial
     1.4552e+03     1.4552e+04             1.4967e-07       -16.905734910262  <--
     5.8208e+03     5.8208e+04             3.7417e-08       -16.905734910028
     2.3283e+04     2.3283e+05             9.3544e-09       -16.905734909823

*****************************************************************************
Applying the update for shift_i =   1.4552e+03     and shift_s =   1.4552e+04
*****************************************************************************

  Execution time = 2.9615e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.115760e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293946e-02 1 1  ON 2
 uu_3                -1.978133e-02 1 1  ON 3
 uu_4                -6.600969e-02 1 1  ON 4
 uu_5                -1.015326e-01 1 1  ON 5
 uu_6                -1.293717e-01 1 1  ON 6
 uu_7                -1.441039e-01 1 1  ON 7
 uu_8                -1.378683e-01 1 1  ON 8
 uu_9                -1.087592e-01 1 1  ON 9
 ud_0                 4.513450e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423609e-02 1 1  ON 12
 ud_3                -7.493116e-03 1 1  ON 13
 ud_4                -6.482400e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352786e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537717e-01 1 1  ON 18
 ud_9                -1.418143e-01 1 1  ON 19
 eO_0                -7.569958e-01 1 1  ON 20
 eO_1                -4.354257e-01 1 1  ON 21
 eO_2                -1.819224e-02 1 1  ON 22
 eO_3                 2.998420e-01 1 1  ON 23
 eO_4                 5.270155e-01 1 1  ON 24
 eO_5                 4.892157e-01 1 1  ON 25
 eO_6                 2.599632e-01 1 1  ON 26
 eO_7                -4.230735e-02 1 1  ON 27
 eO_8                -2.283005e-01 1 1  ON 28
 eO_9                -9.249870e-02 1 1  ON 29
eH1_0                -2.549659e-01 1 1  ON 30
eH1_1                -1.518816e-01 1 1  ON 31
eH1_2                -1.032895e-01 1 1  ON 32
eH1_3                -4.827973e-02 1 1  ON 33
eH1_4                 1.757985e-03 1 1  ON 34
eH1_5                 3.783823e-02 1 1  ON 35
eH1_6                 9.718740e-02 1 1  ON 36
eH1_7                 1.565090e-01 1 1  ON 37
eH1_8                 1.867348e-01 1 1  ON 38
eH1_9                 7.951531e-02 1 1  ON 39
eH2_0                -2.516177e-01 1 1  ON 40
eH2_1                -1.477184e-01 1 1  ON 41
eH2_2                -9.980480e-02 1 1  ON 42
eH2_3                -4.503142e-02 1 1  ON 43
eH2_4                 4.511650e-03 1 1  ON 44
eH2_5                 4.015955e-02 1 1  ON 45
eH2_6                 9.843147e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912080e-01 1 1  ON 48
eH2_9                 6.691281e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5718e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9075
    reference variance = 0.325291
====================================================
  Execution time = 2.0137e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4133e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5248e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341321306752
                                         uncertainty =       0.004314086561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341321306752
                                         uncertainty =       0.004314086561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413116452
  error estimate for blocks of size 2^( 2) =       0.000425810346
  error estimate for blocks of size 2^( 3) =       0.000439048986
  error estimate for blocks of size 2^( 4) =       0.000451478672
  error estimate for blocks of size 2^( 5) =       0.000462829820
  error estimate for blocks of size 2^( 6) =       0.000468443150
  error estimate for blocks of size 2^( 7) =       0.000470508280

      target function =                  N/A
              le_mean =     -16.906580139288
             les_mean =     286.173782241572
             stat err =       0.000463314980
             autocorr =       1.257788742399
              std dev =       0.584234889474
             le_variance =       0.341330406079


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690658013929e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906580139288       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906580139907       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906580139477       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906580138821       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906580139749       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906580139977       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906580139668       residual = 8.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 5.259532e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906580139288       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906580139443       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906580139335       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906580139171       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906580139403       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906580139460       residual = 6.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906580139383       residual = 8.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 1.314981e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906580139288       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906580139326       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906580139300       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906580139262       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906580139315       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906580139332       residual = 6.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906580139311       residual = 8.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 3.287513e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.264514 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5668e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.115760e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293943e-02 1 1  ON 2
 uu_3                -1.978139e-02 1 1  ON 3
 uu_4                -6.600966e-02 1 1  ON 4
 uu_5                -1.015325e-01 1 1  ON 5
 uu_6                -1.293717e-01 1 1  ON 6
 uu_7                -1.441039e-01 1 1  ON 7
 uu_8                -1.378683e-01 1 1  ON 8
 uu_9                -1.087592e-01 1 1  ON 9
 ud_0                 4.513451e-01 1 1  ON 10
 ud_1                 1.852762e-01 1 1  ON 11
 ud_2                 6.423610e-02 1 1  ON 12
 ud_3                -7.493121e-03 1 1  ON 13
 ud_4                -6.482398e-02 1 1  ON 14
 ud_5                -1.070182e-01 1 1  ON 15
 ud_6                -1.352785e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537716e-01 1 1  ON 18
 ud_9                -1.418143e-01 1 1  ON 19
 eO_0                -7.569958e-01 1 1  ON 20
 eO_1                -4.354257e-01 1 1  ON 21
 eO_2                -1.819217e-02 1 1  ON 22
 eO_3                 2.998420e-01 1 1  ON 23
 eO_4                 5.270155e-01 1 1  ON 24
 eO_5                 4.892157e-01 1 1  ON 25
 eO_6                 2.599632e-01 1 1  ON 26
 eO_7                -4.230733e-02 1 1  ON 27
 eO_8                -2.283005e-01 1 1  ON 28
 eO_9                -9.249879e-02 1 1  ON 29
eH1_0                -2.549659e-01 1 1  ON 30
eH1_1                -1.518817e-01 1 1  ON 31
eH1_2                -1.032896e-01 1 1  ON 32
eH1_3                -4.827968e-02 1 1  ON 33
eH1_4                 1.757924e-03 1 1  ON 34
eH1_5                 3.783823e-02 1 1  ON 35
eH1_6                 9.718741e-02 1 1  ON 36
eH1_7                 1.565090e-01 1 1  ON 37
eH1_8                 1.867349e-01 1 1  ON 38
eH1_9                 7.951543e-02 1 1  ON 39
eH2_0                -2.516178e-01 1 1  ON 40
eH2_1                -1.477185e-01 1 1  ON 41
eH2_2                -9.980483e-02 1 1  ON 42
eH2_3                -4.503139e-02 1 1  ON 43
eH2_4                 4.511657e-03 1 1  ON 44
eH2_5                 4.015948e-02 1 1  ON 45
eH2_6                 9.843150e-02 1 1  ON 46
eH2_7                 1.587337e-01 1 1  ON 47
eH2_8                 1.912080e-01 1 1  ON 48
eH2_9                 6.691294e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8806
    reference variance = 0.263888
====================================================
  Execution time = 2.0054e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3452e-01
  Total weights = 2.0000e+06
  Execution time = 1.8911e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334469761247
                                         uncertainty =       0.002285822718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334469761247
                                         uncertainty =       0.002285822718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408973200
  error estimate for blocks of size 2^( 2) =       0.000421427595
  error estimate for blocks of size 2^( 3) =       0.000434503005
  error estimate for blocks of size 2^( 4) =       0.000446420676
  error estimate for blocks of size 2^( 5) =       0.000456966902
  error estimate for blocks of size 2^( 6) =       0.000463962055
  error estimate for blocks of size 2^( 7) =       0.000467986346

      target function =                  N/A
              le_mean =     -16.906428239226
             les_mean =     286.161833797504
             stat err =       0.000458833995
             autocorr =       1.258697804733
              std dev =       0.578375446123
             le_variance =       0.334518156678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334470029244
                                         uncertainty =       0.002285824517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334470029244
                                         uncertainty =       0.002285824517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408973364
  error estimate for blocks of size 2^( 2) =       0.000421427750
  error estimate for blocks of size 2^( 3) =       0.000434503152
  error estimate for blocks of size 2^( 4) =       0.000446420814
  error estimate for blocks of size 2^( 5) =       0.000456967035
  error estimate for blocks of size 2^( 6) =       0.000463962189
  error estimate for blocks of size 2^( 7) =       0.000467986473

      target function =                  N/A
              le_mean =     -16.906428240495
             les_mean =     286.161834108510
             stat err =       0.000458834128
             autocorr =       1.258697526205
              std dev =       0.578375677877
             le_variance =       0.334518424759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334469895357
                                         uncertainty =       0.002285823618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334469895357
                                         uncertainty =       0.002285823618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408973282
  error estimate for blocks of size 2^( 2) =       0.000421427673
  error estimate for blocks of size 2^( 3) =       0.000434503078
  error estimate for blocks of size 2^( 4) =       0.000446420745
  error estimate for blocks of size 2^( 5) =       0.000456966968
  error estimate for blocks of size 2^( 6) =       0.000463962122
  error estimate for blocks of size 2^( 7) =       0.000467986410

      target function =                  N/A
              le_mean =     -16.906428239860
             les_mean =     286.161833953110
             stat err =       0.000458834061
             autocorr =       1.258697665355
              std dev =       0.578375562097
             le_variance =       0.334518290831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334469778014
                                         uncertainty =       0.002285822830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334469778014
                                         uncertainty =       0.002285822830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408973210
  error estimate for blocks of size 2^( 2) =       0.000421427605
  error estimate for blocks of size 2^( 3) =       0.000434503014
  error estimate for blocks of size 2^( 4) =       0.000446420685
  error estimate for blocks of size 2^( 5) =       0.000456966910
  error estimate for blocks of size 2^( 6) =       0.000463962063
  error estimate for blocks of size 2^( 7) =       0.000467986354

      target function =                  N/A
              le_mean =     -16.906428239305
             les_mean =     286.161833816958
             stat err =       0.000458834003
             autocorr =       1.258697787296
              std dev =       0.578375460623
             le_variance =       0.334518173451


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906428239226        initial
     3.6380e+02     3.6380e+03             5.2595e-07       -16.906428240495  <--
     1.4552e+03     1.4552e+04             1.3150e-07       -16.906428239860
     5.8208e+03     5.8208e+04             3.2875e-08       -16.906428239305

*****************************************************************************
Applying the update for shift_i =   3.6380e+02     and shift_s =   3.6380e+03
*****************************************************************************

  Execution time = 2.9601e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.115762e-01 1 1  ON 0
 uu_1                 1.445836e-01 1 1  ON 1
 uu_2                 4.293935e-02 1 1  ON 2
 uu_3                -1.978158e-02 1 1  ON 3
 uu_4                -6.600959e-02 1 1  ON 4
 uu_5                -1.015324e-01 1 1  ON 5
 uu_6                -1.293718e-01 1 1  ON 6
 uu_7                -1.441040e-01 1 1  ON 7
 uu_8                -1.378684e-01 1 1  ON 8
 uu_9                -1.087594e-01 1 1  ON 9
 ud_0                 4.513452e-01 1 1  ON 10
 ud_1                 1.852761e-01 1 1  ON 11
 ud_2                 6.423613e-02 1 1  ON 12
 ud_3                -7.493137e-03 1 1  ON 13
 ud_4                -6.482390e-02 1 1  ON 14
 ud_5                -1.070183e-01 1 1  ON 15
 ud_6                -1.352785e-01 1 1  ON 16
 ud_7                -1.521019e-01 1 1  ON 17
 ud_8                -1.537715e-01 1 1  ON 18
 ud_9                -1.418144e-01 1 1  ON 19
 eO_0                -7.569957e-01 1 1  ON 20
 eO_1                -4.354258e-01 1 1  ON 21
 eO_2                -1.819193e-02 1 1  ON 22
 eO_3                 2.998421e-01 1 1  ON 23
 eO_4                 5.270154e-01 1 1  ON 24
 eO_5                 4.892158e-01 1 1  ON 25
 eO_6                 2.599634e-01 1 1  ON 26
 eO_7                -4.230729e-02 1 1  ON 27
 eO_8                -2.283007e-01 1 1  ON 28
 eO_9                -9.249907e-02 1 1  ON 29
eH1_0                -2.549660e-01 1 1  ON 30
eH1_1                -1.518818e-01 1 1  ON 31
eH1_2                -1.032898e-01 1 1  ON 32
eH1_3                -4.827953e-02 1 1  ON 33
eH1_4                 1.757742e-03 1 1  ON 34
eH1_5                 3.783822e-02 1 1  ON 35
eH1_6                 9.718744e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867351e-01 1 1  ON 38
eH1_9                 7.951580e-02 1 1  ON 39
eH2_0                -2.516181e-01 1 1  ON 40
eH2_1                -1.477186e-01 1 1  ON 41
eH2_2                -9.980492e-02 1 1  ON 42
eH2_3                -4.503131e-02 1 1  ON 43
eH2_4                 4.511680e-03 1 1  ON 44
eH2_5                 4.015929e-02 1 1  ON 45
eH2_6                 9.843161e-02 1 1  ON 46
eH2_7                 1.587336e-01 1 1  ON 47
eH2_8                 1.912081e-01 1 1  ON 48
eH2_9                 6.691334e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5433e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9326
    reference variance = 0.111582
====================================================
  Execution time = 2.0162e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3698e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5498e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337050048322
                                         uncertainty =       0.003144685624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337050048322
                                         uncertainty =       0.003144685624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410473892
  error estimate for blocks of size 2^( 2) =       0.000423254787
  error estimate for blocks of size 2^( 3) =       0.000436415547
  error estimate for blocks of size 2^( 4) =       0.000448425521
  error estimate for blocks of size 2^( 5) =       0.000458659000
  error estimate for blocks of size 2^( 6) =       0.000466570838
  error estimate for blocks of size 2^( 7) =       0.000472521690

      target function =                  N/A
              le_mean =     -16.906387947937
             les_mean =     286.162930909753
             stat err =       0.000461544262
             autocorr =       1.264316001032
              std dev =       0.580497745122
             le_variance =       0.336977632092


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690638794794e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906387947937       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906387949334       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906387948658       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906387950638       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906387951821       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906387952107       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906387951406       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906387951387       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+01 is 2.051348e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906387947937       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906387948287       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906387948116       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906387948611       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906387948906       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906387948978       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906387948804       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906387948798       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 5.129266e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906387947937       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906387948024       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906387947982       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906387948105       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906387948179       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906387948197       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906387948157       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906387948152       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 1.282373e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.267112 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5719e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.115762e-01 1 1  ON 0
 uu_1                 1.445835e-01 1 1  ON 1
 uu_2                 4.293943e-02 1 1  ON 2
 uu_3                -1.978161e-02 1 1  ON 3
 uu_4                -6.600954e-02 1 1  ON 4
 uu_5                -1.015323e-01 1 1  ON 5
 uu_6                -1.293718e-01 1 1  ON 6
 uu_7                -1.441039e-01 1 1  ON 7
 uu_8                -1.378684e-01 1 1  ON 8
 uu_9                -1.087596e-01 1 1  ON 9
 ud_0                 4.513454e-01 1 1  ON 10
 ud_1                 1.852761e-01 1 1  ON 11
 ud_2                 6.423618e-02 1 1  ON 12
 ud_3                -7.492890e-03 1 1  ON 13
 ud_4                -6.482399e-02 1 1  ON 14
 ud_5                -1.070181e-01 1 1  ON 15
 ud_6                -1.352783e-01 1 1  ON 16
 ud_7                -1.521018e-01 1 1  ON 17
 ud_8                -1.537718e-01 1 1  ON 18
 ud_9                -1.418146e-01 1 1  ON 19
 eO_0                -7.569958e-01 1 1  ON 20
 eO_1                -4.354255e-01 1 1  ON 21
 eO_2                -1.819183e-02 1 1  ON 22
 eO_3                 2.998423e-01 1 1  ON 23
 eO_4                 5.270154e-01 1 1  ON 24
 eO_5                 4.892160e-01 1 1  ON 25
 eO_6                 2.599637e-01 1 1  ON 26
 eO_7                -4.230734e-02 1 1  ON 27
 eO_8                -2.283011e-01 1 1  ON 28
 eO_9                -9.249940e-02 1 1  ON 29
eH1_0                -2.549662e-01 1 1  ON 30
eH1_1                -1.518816e-01 1 1  ON 31
eH1_2                -1.032900e-01 1 1  ON 32
eH1_3                -4.827936e-02 1 1  ON 33
eH1_4                 1.757348e-03 1 1  ON 34
eH1_5                 3.783793e-02 1 1  ON 35
eH1_6                 9.718722e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867354e-01 1 1  ON 38
eH1_9                 7.951631e-02 1 1  ON 39
eH2_0                -2.516181e-01 1 1  ON 40
eH2_1                -1.477190e-01 1 1  ON 41
eH2_2                -9.980459e-02 1 1  ON 42
eH2_3                -4.503124e-02 1 1  ON 43
eH2_4                 4.511312e-03 1 1  ON 44
eH2_5                 4.015921e-02 1 1  ON 45
eH2_6                 9.843154e-02 1 1  ON 46
eH2_7                 1.587335e-01 1 1  ON 47
eH2_8                 1.912081e-01 1 1  ON 48
eH2_9                 6.691380e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9259
    reference variance = 0.192841
====================================================
  Execution time = 2.0005e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5038e-01
  Total weights = 2.0000e+06
  Execution time = 1.9066e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350436655516
                                         uncertainty =       0.008442872153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350436655516
                                         uncertainty =       0.008442872153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418554679
  error estimate for blocks of size 2^( 2) =       0.000431064557
  error estimate for blocks of size 2^( 3) =       0.000443951523
  error estimate for blocks of size 2^( 4) =       0.000455680253
  error estimate for blocks of size 2^( 5) =       0.000466942508
  error estimate for blocks of size 2^( 6) =       0.000475980937
  error estimate for blocks of size 2^( 7) =       0.000482159103

      target function =                  N/A
              le_mean =     -16.905047939100
             les_mean =     286.131021687002
             stat err =       0.000470190700
             autocorr =       1.261954415350
              std dev =       0.591925703896
             le_variance =       0.350376038933

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350436759827
                                         uncertainty =       0.008442852544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350436759827
                                         uncertainty =       0.008442852544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418554741
  error estimate for blocks of size 2^( 2) =       0.000431064600
  error estimate for blocks of size 2^( 3) =       0.000443951552
  error estimate for blocks of size 2^( 4) =       0.000455680272
  error estimate for blocks of size 2^( 5) =       0.000466942504
  error estimate for blocks of size 2^( 6) =       0.000475980953
  error estimate for blocks of size 2^( 7) =       0.000482159170

      target function =                  N/A
              le_mean =     -16.905047947919
             les_mean =     286.131022089245
             stat err =       0.000470190725
             autocorr =       1.261954170904
              std dev =       0.591925791789
             le_variance =       0.350376142985

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350436708110
                                         uncertainty =       0.008442862349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350436708110
                                         uncertainty =       0.008442862349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418554711
  error estimate for blocks of size 2^( 2) =       0.000431064579
  error estimate for blocks of size 2^( 3) =       0.000443951538
  error estimate for blocks of size 2^( 4) =       0.000455680263
  error estimate for blocks of size 2^( 5) =       0.000466942506
  error estimate for blocks of size 2^( 6) =       0.000475980946
  error estimate for blocks of size 2^( 7) =       0.000482159137

      target function =                  N/A
              le_mean =     -16.905047943517
             les_mean =     286.131021888833
             stat err =       0.000470190713
             autocorr =       1.261954292585
              std dev =       0.591925748213
             le_variance =       0.350376091397

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350436662102
                                         uncertainty =       0.008442870928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350436662102
                                         uncertainty =       0.008442870928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418554683
  error estimate for blocks of size 2^( 2) =       0.000431064560
  error estimate for blocks of size 2^( 3) =       0.000443951525
  error estimate for blocks of size 2^( 4) =       0.000455680254
  error estimate for blocks of size 2^( 5) =       0.000466942507
  error estimate for blocks of size 2^( 6) =       0.000475980938
  error estimate for blocks of size 2^( 7) =       0.000482159107

      target function =                  N/A
              le_mean =     -16.905047939652
             les_mean =     286.131021712241
             stat err =       0.000470190702
             autocorr =       1.261954399986
              std dev =       0.591925709446
             le_variance =       0.350376045503


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905047939100        initial
     9.0949e+01     9.0949e+02             2.0513e-06       -16.905047947919  <--
     3.6380e+02     3.6380e+03             5.1293e-07       -16.905047943517
     1.4552e+03     1.4552e+04             1.2824e-07       -16.905047939652

*****************************************************************************
Applying the update for shift_i =   9.0949e+01     and shift_s =   9.0949e+02
*****************************************************************************

  Execution time = 2.9620e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.115760e-01 1 1  ON 0
 uu_1                 1.445829e-01 1 1  ON 1
 uu_2                 4.293969e-02 1 1  ON 2
 uu_3                -1.978169e-02 1 1  ON 3
 uu_4                -6.600940e-02 1 1  ON 4
 uu_5                -1.015321e-01 1 1  ON 5
 uu_6                -1.293719e-01 1 1  ON 6
 uu_7                -1.441037e-01 1 1  ON 7
 uu_8                -1.378683e-01 1 1  ON 8
 uu_9                -1.087603e-01 1 1  ON 9
 ud_0                 4.513459e-01 1 1  ON 10
 ud_1                 1.852763e-01 1 1  ON 11
 ud_2                 6.423632e-02 1 1  ON 12
 ud_3                -7.492154e-03 1 1  ON 13
 ud_4                -6.482425e-02 1 1  ON 14
 ud_5                -1.070174e-01 1 1  ON 15
 ud_6                -1.352779e-01 1 1  ON 16
 ud_7                -1.521017e-01 1 1  ON 17
 ud_8                -1.537728e-01 1 1  ON 18
 ud_9                -1.418151e-01 1 1  ON 19
 eO_0                -7.569963e-01 1 1  ON 20
 eO_1                -4.354246e-01 1 1  ON 21
 eO_2                -1.819153e-02 1 1  ON 22
 eO_3                 2.998427e-01 1 1  ON 23
 eO_4                 5.270153e-01 1 1  ON 24
 eO_5                 4.892165e-01 1 1  ON 25
 eO_6                 2.599645e-01 1 1  ON 26
 eO_7                -4.230751e-02 1 1  ON 27
 eO_8                -2.283021e-01 1 1  ON 28
 eO_9                -9.250039e-02 1 1  ON 29
eH1_0                -2.549669e-01 1 1  ON 30
eH1_1                -1.518810e-01 1 1  ON 31
eH1_2                -1.032905e-01 1 1  ON 32
eH1_3                -4.827885e-02 1 1  ON 33
eH1_4                 1.756167e-03 1 1  ON 34
eH1_5                 3.783704e-02 1 1  ON 35
eH1_6                 9.718659e-02 1 1  ON 36
eH1_7                 1.565089e-01 1 1  ON 37
eH1_8                 1.867365e-01 1 1  ON 38
eH1_9                 7.951785e-02 1 1  ON 39
eH2_0                -2.516180e-01 1 1  ON 40
eH2_1                -1.477201e-01 1 1  ON 41
eH2_2                -9.980361e-02 1 1  ON 42
eH2_3                -4.503102e-02 1 1  ON 43
eH2_4                 4.510211e-03 1 1  ON 44
eH2_5                 4.015897e-02 1 1  ON 45
eH2_6                 9.843132e-02 1 1  ON 46
eH2_7                 1.587333e-01 1 1  ON 47
eH2_8                 1.912083e-01 1 1  ON 48
eH2_9                 6.691519e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5447e+01 secs
  Total Execution time = 2.2811e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
