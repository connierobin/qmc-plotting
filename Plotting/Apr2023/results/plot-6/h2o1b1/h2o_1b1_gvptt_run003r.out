Rank =    0  Free Memory = 88689 MB
Rank =    1  Free Memory = 88689 MB
Rank =    2  Free Memory = 88688 MB
Rank =    3  Free Memory = 88688 MB
Rank =    4  Free Memory = 88688 MB
Rank =    5  Free Memory = 88688 MB
Rank =    6  Free Memory = 88687 MB
Rank =    7  Free Memory = 88687 MB
Rank =    8  Free Memory = 88687 MB
Rank =    9  Free Memory = 88687 MB
Rank =   10  Free Memory = 88687 MB
Rank =   11  Free Memory = 88686 MB
Rank =   12  Free Memory = 88686 MB
Rank =   13  Free Memory = 88686 MB
Rank =   14  Free Memory = 88686 MB
Rank =   15  Free Memory = 88675 MB
Rank =   16  Free Memory = 88675 MB
Rank =   17  Free Memory = 88675 MB
Rank =   18  Free Memory = 88674 MB
Rank =   19  Free Memory = 88674 MB
Rank =   20  Free Memory = 88674 MB
Rank =   21  Free Memory = 88674 MB
Rank =   22  Free Memory = 88673 MB
Rank =   23  Free Memory = 88673 MB
Rank =   24  Free Memory = 88673 MB
Rank =   25  Free Memory = 88673 MB
Rank =   26  Free Memory = 88673 MB
Rank =   27  Free Memory = 88673 MB
Rank =   28  Free Memory = 88673 MB
Rank =   29  Free Memory = 88673 MB
Rank =   30  Free Memory = 88672 MB
Rank =   31  Free Memory = 88672 MB
Rank =   32  Free Memory = 86673 MB
Rank =   33  Free Memory = 86673 MB
Rank =   34  Free Memory = 86673 MB
Rank =   35  Free Memory = 86673 MB
Rank =   36  Free Memory = 86673 MB
Rank =   37  Free Memory = 86673 MB
Rank =   38  Free Memory = 86673 MB
Rank =   39  Free Memory = 86673 MB
Rank =   40  Free Memory = 86673 MB
Rank =   41  Free Memory = 86673 MB
Rank =   42  Free Memory = 86673 MB
Rank =   43  Free Memory = 86673 MB
Rank =   44  Free Memory = 86673 MB
Rank =   45  Free Memory = 86673 MB
Rank =   46  Free Memory = 86673 MB
Rank =   47  Free Memory = 86673 MB
Rank =   48  Free Memory = 86673 MB
Rank =   49  Free Memory = 86673 MB
Rank =   50  Free Memory = 86672 MB
Rank =   51  Free Memory = 86672 MB
Rank =   52  Free Memory = 86672 MB
Rank =   53  Free Memory = 86672 MB
Rank =   54  Free Memory = 86672 MB
Rank =   55  Free Memory = 86672 MB
Rank =   56  Free Memory = 86672 MB
Rank =   57  Free Memory = 86672 MB
Rank =   58  Free Memory = 86672 MB
Rank =   59  Free Memory = 86672 MB
Rank =   60  Free Memory = 86672 MB
Rank =   61  Free Memory = 86672 MB
Rank =   62  Free Memory = 86672 MB
Rank =   63  Free Memory = 86672 MB
Rank =   64  Free Memory = 64234 MB
Rank =   65  Free Memory = 64234 MB
Rank =   66  Free Memory = 64234 MB
Rank =   67  Free Memory = 64234 MB
Rank =   68  Free Memory = 64234 MB
Rank =   69  Free Memory = 64234 MB
Rank =   70  Free Memory = 64234 MB
Rank =   71  Free Memory = 64234 MB
Rank =   72  Free Memory = 64234 MB
Rank =   73  Free Memory = 64234 MB
Rank =   74  Free Memory = 64234 MB
Rank =   75  Free Memory = 64234 MB
Rank =   76  Free Memory = 64234 MB
Rank =   77  Free Memory = 64234 MB
Rank =   78  Free Memory = 64234 MB
Rank =   79  Free Memory = 64234 MB
Rank =   80  Free Memory = 64234 MB
Rank =   81  Free Memory = 64234 MB
Rank =   82  Free Memory = 64234 MB
Rank =   83  Free Memory = 64234 MB
Rank =   84  Free Memory = 64234 MB
Rank =   85  Free Memory = 64234 MB
Rank =   86  Free Memory = 64234 MB
Rank =   87  Free Memory = 64234 MB
Rank =   88  Free Memory = 64234 MB
Rank =   89  Free Memory = 64234 MB
Rank =   90  Free Memory = 64234 MB
Rank =   91  Free Memory = 64234 MB
Rank =   92  Free Memory = 64234 MB
Rank =   93  Free Memory = 64234 MB
Rank =   94  Free Memory = 64234 MB
Rank =   95  Free Memory = 64234 MB
Rank =   96  Free Memory = 64234 MB
Rank =   97  Free Memory = 64234 MB
Rank =   98  Free Memory = 64234 MB
Rank =   99  Free Memory = 64234 MB
Rank =  100  Free Memory = 64234 MB
Rank =  101  Free Memory = 64234 MB
Rank =  102  Free Memory = 64234 MB
Rank =  103  Free Memory = 64234 MB
Rank =  104  Free Memory = 71011 MB
Rank =  105  Free Memory = 71011 MB
  Input file(s): opt_h2o_1b1_gvptt_run003r.xml 
Rank =  106  Free Memory = 71011 MB
Rank =  107  Free Memory = 71011 MB
Rank =  108  Free Memory = 71011 MB
Rank =  109  Free Memory = 71011 MB
Rank =  110  Free Memory = 71011 MB
Rank =  111  Free Memory = 71011 MB
Rank =  112  Free Memory = 71011 MB
Rank =  113  Free Memory = 71011 MB
Rank =  114  Free Memory = 71011 MB
Rank =  115  Free Memory = 71011 MB
Rank =  116  Free Memory = 71011 MB
Rank =  117  Free Memory = 71011 MB
Rank =  118  Free Memory = 71011 MB
Rank =  119  Free Memory = 71011 MB
Rank =  120  Free Memory = 71011 MB
Rank =  121  Free Memory = 71011 MB
Rank =  122  Free Memory = 71011 MB
Rank =  123  Free Memory = 71011 MB
Rank =  124  Free Memory = 71011 MB
Rank =  125  Free Memory = 71011 MB
Rank =  126  Free Memory = 71011 MB
Rank =  127  Free Memory = 71011 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run003r.xml

  Project = H2O
  date    = 2023-04-17 23:15:24 PDT
  host    = n0121.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 380

  Range of prime numbers to use as seeds over processors and threads = 2633-3643


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.118537e-01    1         1  ON     0
     uu_1                 1.444302e-01    1         1  ON     1
     uu_2                 4.256672e-02    1         1  ON     2
     uu_3                -2.040531e-02    1         1  ON     3
     uu_4                -6.650397e-02    1         1  ON     4
     uu_5                -1.022390e-01    1         1  ON     5
     uu_6                -1.308794e-01    1         1  ON     6
     uu_7                -1.456294e-01    1         1  ON     7
     uu_8                -1.383924e-01    1         1  ON     8
     uu_9                -1.104636e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.526302e-01    1         1  ON     0
     ud_1                 1.864436e-01    1         1  ON     1
     ud_2                 6.530131e-02    1         1  ON     2
     ud_3                -6.584169e-03    1         1  ON     3
     ud_4                -6.420802e-02    1         1  ON     4
     ud_5                -1.064395e-01    1         1  ON     5
     ud_6                -1.346207e-01    1         1  ON     6
     ud_7                -1.522420e-01    1         1  ON     7
     ud_8                -1.529168e-01    1         1  ON     8
     ud_9                -1.431063e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.559302e-01    1         1  ON     0
     eO_1                -4.340968e-01    1         1  ON     1
     eO_2                -1.751725e-02    1         1  ON     2
     eO_3                 3.008485e-01    1         1  ON     3
     eO_4                 5.290559e-01    1         1  ON     4
     eO_5                 4.926777e-01    1         1  ON     5
     eO_6                 2.633746e-01    1         1  ON     6
     eO_7                -4.204680e-02    1         1  ON     7
     eO_8                -2.326766e-01    1         1  ON     8
     eO_9                -9.994062e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.592723e-01    1         1  ON     0
     eH1_1                -1.542809e-01    1         1  ON     1
     eH1_2                -1.053969e-01    1         1  ON     2
     eH1_3                -4.994178e-02    1         1  ON     3
     eH1_4                -6.639533e-04    1         1  ON     4
     eH1_5                 3.500430e-02    1         1  ON     5
     eH1_6                 9.570738e-02    1         1  ON     6
     eH1_7                 1.583323e-01    1         1  ON     7
     eH1_8                 1.916517e-01    1         1  ON     8
     eH1_9                 8.922325e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.568450e-01    1         1  ON     0
     eH2_1                -1.515724e-01    1         1  ON     1
     eH2_2                -1.029136e-01    1         1  ON     2
     eH2_3                -4.756574e-02    1         1  ON     3
     eH2_4                 1.773898e-03    1         1  ON     4
     eH2_5                 3.748327e-02    1         1  ON     5
     eH2_6                 9.955954e-02    1         1  ON     6
     eH2_7                 1.599958e-01    1         1  ON     7
     eH2_8                 1.960314e-01    1         1  ON     8
     eH2_9                 7.798369e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.366528e+01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.2990e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.952
    reference variance = 0.148023
====================================================
  Execution time = 2.0943e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4817e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348200850507
                                         uncertainty =       0.006507050706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348200850507
                                         uncertainty =       0.006507050706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417235880
  error estimate for blocks of size 2^( 2) =       0.000430008246
  error estimate for blocks of size 2^( 3) =       0.000442734051
  error estimate for blocks of size 2^( 4) =       0.000455253527
  error estimate for blocks of size 2^( 5) =       0.000466593951
  error estimate for blocks of size 2^( 6) =       0.000474607672
  error estimate for blocks of size 2^( 7) =       0.000481230905

      target function =                  N/A
              le_mean =     -16.906037700177
             les_mean =     286.162282104445
             stat err =       0.000469421514
             autocorr =       1.265792980701
              std dev =       0.590060639858
             le_variance =       0.348171558709


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690603770018e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906037700177       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906038231219       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906038343974       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906038788376       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906039453060       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906039862446       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906040233450       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906040325864       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906040211155       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906040074040       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 8.446967e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906037700177       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906037890531       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906038015875       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906038185737       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906038438590       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906038547334       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906038635337       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906038646903       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.063250e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906037700177       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906037753555       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906037802303       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906037856391       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906037929818       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906037965290       residual = 9.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906037986043       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906037988907       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 5.223750e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.132680 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6587e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.119349e-01                 1 1 ON  0
uu_1  1.444226e-01                 1 1 ON  1
uu_2  4.247928e-02                 1 1 ON  2
uu_3  -2.039868e-02                1 1 ON  3
uu_4  -6.654176e-02                1 1 ON  4
uu_5  -1.022467e-01                1 1 ON  5
uu_6  -1.309726e-01                1 1 ON  6
uu_7  -1.456734e-01                1 1 ON  7
uu_8  -1.384706e-01                1 1 ON  8
uu_9  -1.104255e-01                1 1 ON  9
ud_0  4.525786e-01                 1 1 ON  10
ud_1  1.864252e-01                 1 1 ON  11
ud_2  6.524125e-02                 1 1 ON  12
ud_3  -6.556400e-03                1 1 ON  13
ud_4  -6.420450e-02                1 1 ON  14
ud_5  -1.065091e-01                1 1 ON  15
ud_6  -1.345976e-01                1 1 ON  16
ud_7  -1.522005e-01                1 1 ON  17
ud_8  -1.528712e-01                1 1 ON  18
ud_9  -1.430677e-01                1 1 ON  19
eO_0  -7.558824e-01                1 1 ON  20
eO_1  -4.340062e-01                1 1 ON  21
eO_2  -1.748933e-02                1 1 ON  22
eO_3  3.007680e-01                 1 1 ON  23
eO_4  5.289797e-01                 1 1 ON  24
eO_5  4.927394e-01                 1 1 ON  25
eO_6  2.634321e-01                 1 1 ON  26
eO_7  -4.202900e-02                1 1 ON  27
eO_8  -2.327276e-01                1 1 ON  28
eO_9  -1.000272e-01                1 1 ON  29
eH1_0 -2.592905e-01                1 1 ON  30
eH1_1 -1.543269e-01                1 1 ON  31
eH1_2 -1.054796e-01                1 1 ON  32
eH1_3 -4.998609e-02                1 1 ON  33
eH1_4 -7.866805e-04                1 1 ON  34
eH1_5 3.494844e-02                 1 1 ON  35
eH1_6 9.569610e-02                 1 1 ON  36
eH1_7 1.583845e-01                 1 1 ON  37
eH1_8 1.917830e-01                 1 1 ON  38
eH1_9 8.939558e-02                 1 1 ON  39
eH2_0 -2.569919e-01                1 1 ON  40
eH2_1 -1.516952e-01                1 1 ON  41
eH2_2 -1.029782e-01                1 1 ON  42
eH2_3 -4.755374e-02                1 1 ON  43
eH2_4 1.734407e-03                 1 1 ON  44
eH2_5 3.744716e-02                 1 1 ON  45
eH2_6 9.955483e-02                 1 1 ON  46
eH2_7 1.600427e-01                 1 1 ON  47
eH2_8 1.961471e-01                 1 1 ON  48
eH2_9 7.819002e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9586
    reference variance = 0.230923
====================================================
  Execution time = 2.0471e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3724e-01
  Total weights = 2.0000e+06
  Execution time = 1.9073e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337209185234
                                         uncertainty =       0.003100622549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337209185234
                                         uncertainty =       0.003100622549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410610993
  error estimate for blocks of size 2^( 2) =       0.000423337763
  error estimate for blocks of size 2^( 3) =       0.000436547124
  error estimate for blocks of size 2^( 4) =       0.000448756770
  error estimate for blocks of size 2^( 5) =       0.000460092106
  error estimate for blocks of size 2^( 6) =       0.000469919200
  error estimate for blocks of size 2^( 7) =       0.000476086934

      target function =                  N/A
              le_mean =     -16.906150664581
             les_mean =     286.155132899682
             stat err =       0.000463713753
             autocorr =       1.275377668150
              std dev =       0.580691634825
             le_variance =       0.337202774756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337281851888
                                         uncertainty =       0.003099451110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337281851888
                                         uncertainty =       0.003099451110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410655257
  error estimate for blocks of size 2^( 2) =       0.000423379533
  error estimate for blocks of size 2^( 3) =       0.000436588127
  error estimate for blocks of size 2^( 4) =       0.000448796338
  error estimate for blocks of size 2^( 5) =       0.000460132001
  error estimate for blocks of size 2^( 6) =       0.000469959127
  error estimate for blocks of size 2^( 7) =       0.000476120663

      target function =                  N/A
              le_mean =     -16.906149643923
             les_mean =     286.155171094377
             stat err =       0.000463752032
             autocorr =       1.275313268614
              std dev =       0.580754233982
             le_variance =       0.337275480287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337289508988
                                         uncertainty =       0.003099778910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337289508988
                                         uncertainty =       0.003099778910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410659920
  error estimate for blocks of size 2^( 2) =       0.000423384063
  error estimate for blocks of size 2^( 3) =       0.000436592406
  error estimate for blocks of size 2^( 4) =       0.000448800021
  error estimate for blocks of size 2^( 5) =       0.000460135083
  error estimate for blocks of size 2^( 6) =       0.000469962836
  error estimate for blocks of size 2^( 7) =       0.000476124317

      target function =                  N/A
              le_mean =     -16.906149481261
             les_mean =     286.155173253611
             stat err =       0.000463755564
             autocorr =       1.275303732822
              std dev =       0.580760828162
             le_variance =       0.337283139527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337222710687
                                         uncertainty =       0.003100495926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337222710687
                                         uncertainty =       0.003100495926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410619232
  error estimate for blocks of size 2^( 2) =       0.000423345524
  error estimate for blocks of size 2^( 3) =       0.000436554672
  error estimate for blocks of size 2^( 4) =       0.000448763937
  error estimate for blocks of size 2^( 5) =       0.000460099196
  error estimate for blocks of size 2^( 6) =       0.000469926420
  error estimate for blocks of size 2^( 7) =       0.000476093155

      target function =                  N/A
              le_mean =     -16.906150424202
             les_mean =     286.155138305262
             stat err =       0.000463720677
             autocorr =       1.275364571652
              std dev =       0.580703287521
             le_variance =       0.337216308138


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906150664581        initial  <--
     2.5000e-01     2.5000e+00             8.4470e-04       -16.906149643923
     1.0000e+00     1.0000e+01             2.0632e-04       -16.906149481261
     4.0000e+00     4.0000e+01             5.2238e-05       -16.906150424202

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0374
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.118537e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040531e-02 1 1  ON 3
 uu_4                -6.650397e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530131e-02 1 1  ON 12
 ud_3                -6.584169e-03 1 1  ON 13
 ud_4                -6.420802e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994062e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994178e-02 1 1  ON 33
eH1_4                -6.639533e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570738e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922325e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756574e-02 1 1  ON 43
eH2_4                 1.773898e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955954e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960314e-01 1 1  ON 48
eH2_9                 7.798369e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6632e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6955e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.7736
    reference variance = 0.479218
====================================================
  Execution time = 2.0341e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4119e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5312e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341264291005
                                         uncertainty =       0.005119368723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341264291005
                                         uncertainty =       0.005119368723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413033499
  error estimate for blocks of size 2^( 2) =       0.000425924632
  error estimate for blocks of size 2^( 3) =       0.000438967251
  error estimate for blocks of size 2^( 4) =       0.000451002814
  error estimate for blocks of size 2^( 5) =       0.000460545006
  error estimate for blocks of size 2^( 6) =       0.000468593887
  error estimate for blocks of size 2^( 7) =       0.000472338852

      target function =                  N/A
              le_mean =     -16.906379672862
             les_mean =     286.166866814563
             stat err =       0.000463120140
             autocorr =       1.257235926722
              std dev =       0.584117575668
             le_variance =       0.341193342204


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690637967286e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906379672862       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906379811345       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906379781074       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906379892412       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906379937825       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906380024673       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906380006972       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906380034756       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 9.345221e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906379672862       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906379708935       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906379701723       residual = 9.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906379730603       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906379740636       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906379764810       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906379760491       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906379767999       residual = 2.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.346536e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906379672862       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906379681976       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906379680203       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906379687492       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906379689904       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906379696117       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906379695047       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906379696965       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 5.873369e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135442 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5879e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.118563e-01 1 1  ON 0
 uu_1                 1.444371e-01 1 1  ON 1
 uu_2                 4.257085e-02 1 1  ON 2
 uu_3                -2.040465e-02 1 1  ON 3
 uu_4                -6.651131e-02 1 1  ON 4
 uu_5                -1.022372e-01 1 1  ON 5
 uu_6                -1.308863e-01 1 1  ON 6
 uu_7                -1.456335e-01 1 1  ON 7
 uu_8                -1.384013e-01 1 1  ON 8
 uu_9                -1.104668e-01 1 1  ON 9
 ud_0                 4.526236e-01 1 1  ON 10
 ud_1                 1.864468e-01 1 1  ON 11
 ud_2                 6.530231e-02 1 1  ON 12
 ud_3                -6.576656e-03 1 1  ON 13
 ud_4                -6.420439e-02 1 1  ON 14
 ud_5                -1.064347e-01 1 1  ON 15
 ud_6                -1.346229e-01 1 1  ON 16
 ud_7                -1.522464e-01 1 1  ON 17
 ud_8                -1.529174e-01 1 1  ON 18
 ud_9                -1.431075e-01 1 1  ON 19
 eO_0                -7.559171e-01 1 1  ON 20
 eO_1                -4.340925e-01 1 1  ON 21
 eO_2                -1.751189e-02 1 1  ON 22
 eO_3                 3.008456e-01 1 1  ON 23
 eO_4                 5.290507e-01 1 1  ON 24
 eO_5                 4.926866e-01 1 1  ON 25
 eO_6                 2.633755e-01 1 1  ON 26
 eO_7                -4.204646e-02 1 1  ON 27
 eO_8                -2.326856e-01 1 1  ON 28
 eO_9                -9.995339e-02 1 1  ON 29
eH1_0                -2.592761e-01 1 1  ON 30
eH1_1                -1.542936e-01 1 1  ON 31
eH1_2                -1.053941e-01 1 1  ON 32
eH1_3                -4.995042e-02 1 1  ON 33
eH1_4                -6.619131e-04 1 1  ON 34
eH1_5                 3.500251e-02 1 1  ON 35
eH1_6                 9.570201e-02 1 1  ON 36
eH1_7                 1.583308e-01 1 1  ON 37
eH1_8                 1.916619e-01 1 1  ON 38
eH1_9                 8.923950e-02 1 1  ON 39
eH2_0                -2.568492e-01 1 1  ON 40
eH2_1                -1.515841e-01 1 1  ON 41
eH2_2                -1.029165e-01 1 1  ON 42
eH2_3                -4.757675e-02 1 1  ON 43
eH2_4                 1.776412e-03 1 1  ON 44
eH2_5                 3.748119e-02 1 1  ON 45
eH2_6                 9.955874e-02 1 1  ON 46
eH2_7                 1.599912e-01 1 1  ON 47
eH2_8                 1.960390e-01 1 1  ON 48
eH2_9                 7.800716e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8221
    reference variance = 1.04254
====================================================
  Execution time = 2.1901e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3795e-01
  Total weights = 2.0000e+06
  Execution time = 1.9120e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337876313154
                                         uncertainty =       0.004684685985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337876313154
                                         uncertainty =       0.004684685985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411071922
  error estimate for blocks of size 2^( 2) =       0.000424095360
  error estimate for blocks of size 2^( 3) =       0.000437174645
  error estimate for blocks of size 2^( 4) =       0.000449032640
  error estimate for blocks of size 2^( 5) =       0.000460236651
  error estimate for blocks of size 2^( 6) =       0.000467151952
  error estimate for blocks of size 2^( 7) =       0.000471738238

      target function =                  N/A
              le_mean =     -16.905873085549
             les_mean =     286.146504865059
             stat err =       0.000462039870
             autocorr =       1.263348824638
              std dev =       0.581343486532
             le_variance =       0.337960249333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337843872901
                                         uncertainty =       0.004684365326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337843872901
                                         uncertainty =       0.004684365326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411052186
  error estimate for blocks of size 2^( 2) =       0.000424075859
  error estimate for blocks of size 2^( 3) =       0.000437155558
  error estimate for blocks of size 2^( 4) =       0.000449013919
  error estimate for blocks of size 2^( 5) =       0.000460217819
  error estimate for blocks of size 2^( 6) =       0.000467134216
  error estimate for blocks of size 2^( 7) =       0.000471721129

      target function =                  N/A
              le_mean =     -16.905873111164
             les_mean =     286.146473281587
             stat err =       0.000462021771
             autocorr =       1.263371150585
              std dev =       0.581315576738
             le_variance =       0.337927799758

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337858684365
                                         uncertainty =       0.004684509904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337858684365
                                         uncertainty =       0.004684509904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411061197
  error estimate for blocks of size 2^( 2) =       0.000424084765
  error estimate for blocks of size 2^( 3) =       0.000437164279
  error estimate for blocks of size 2^( 4) =       0.000449022463
  error estimate for blocks of size 2^( 5) =       0.000460226402
  error estimate for blocks of size 2^( 6) =       0.000467142312
  error estimate for blocks of size 2^( 7) =       0.000471728902

      target function =                  N/A
              le_mean =     -16.905873091263
             les_mean =     286.146487424553
             stat err =       0.000462030020
             autocorr =       1.263360873202
              std dev =       0.581328319996
             le_variance =       0.337942615629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337874060244
                                         uncertainty =       0.004684663405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337874060244
                                         uncertainty =       0.004684663405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411070551
  error estimate for blocks of size 2^( 2) =       0.000424094006
  error estimate for blocks of size 2^( 3) =       0.000437173320
  error estimate for blocks of size 2^( 4) =       0.000449031339
  error estimate for blocks of size 2^( 5) =       0.000460235341
  error estimate for blocks of size 2^( 6) =       0.000467150720
  error estimate for blocks of size 2^( 7) =       0.000471737043

      target function =                  N/A
              le_mean =     -16.905873085797
             les_mean =     286.146502619886
             stat err =       0.000462038611
             autocorr =       1.263350359429
              std dev =       0.581341548318
             le_variance =       0.337957995801


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905873085549        initial
     2.5000e+00     2.5000e+01             9.3452e-05       -16.905873111164  <--
     1.0000e+01     1.0000e+02             2.3465e-05       -16.905873091263
     4.0000e+01     4.0000e+02             5.8734e-06       -16.905873085797

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 3.1504e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.118641e-01 1 1  ON 0
 uu_1                 1.444562e-01 1 1  ON 1
 uu_2                 4.258311e-02 1 1  ON 2
 uu_3                -2.040279e-02 1 1  ON 3
 uu_4                -6.653027e-02 1 1  ON 4
 uu_5                -1.022339e-01 1 1  ON 5
 uu_6                -1.309062e-01 1 1  ON 6
 uu_7                -1.456455e-01 1 1  ON 7
 uu_8                -1.384277e-01 1 1  ON 8
 uu_9                -1.104764e-01 1 1  ON 9
 ud_0                 4.526063e-01 1 1  ON 10
 ud_1                 1.864547e-01 1 1  ON 11
 ud_2                 6.530625e-02 1 1  ON 12
 ud_3                -6.556414e-03 1 1  ON 13
 ud_4                -6.419253e-02 1 1  ON 14
 ud_5                -1.064218e-01 1 1  ON 15
 ud_6                -1.346288e-01 1 1  ON 16
 ud_7                -1.522593e-01 1 1  ON 17
 ud_8                -1.529198e-01 1 1  ON 18
 ud_9                -1.431114e-01 1 1  ON 19
 eO_0                -7.558806e-01 1 1  ON 20
 eO_1                -4.340767e-01 1 1  ON 21
 eO_2                -1.749650e-02 1 1  ON 22
 eO_3                 3.008375e-01 1 1  ON 23
 eO_4                 5.290351e-01 1 1  ON 24
 eO_5                 4.927130e-01 1 1  ON 25
 eO_6                 2.633782e-01 1 1  ON 26
 eO_7                -4.204553e-02 1 1  ON 27
 eO_8                -2.327124e-01 1 1  ON 28
 eO_9                -9.999150e-02 1 1  ON 29
eH1_0                -2.592876e-01 1 1  ON 30
eH1_1                -1.543295e-01 1 1  ON 31
eH1_2                -1.053878e-01 1 1  ON 32
eH1_3                -4.997471e-02 1 1  ON 33
eH1_4                -6.565235e-04 1 1  ON 34
eH1_5                 3.499738e-02 1 1  ON 35
eH1_6                 9.568589e-02 1 1  ON 36
eH1_7                 1.583262e-01 1 1  ON 37
eH1_8                 1.916921e-01 1 1  ON 38
eH1_9                 8.928797e-02 1 1  ON 39
eH2_0                -2.568622e-01 1 1  ON 40
eH2_1                -1.516184e-01 1 1  ON 41
eH2_2                -1.029265e-01 1 1  ON 42
eH2_3                -4.760835e-02 1 1  ON 43
eH2_4                 1.782954e-03 1 1  ON 44
eH2_5                 3.747556e-02 1 1  ON 45
eH2_6                 9.955639e-02 1 1  ON 46
eH2_7                 1.599775e-01 1 1  ON 47
eH2_8                 1.960616e-01 1 1  ON 48
eH2_9                 7.807714e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7391e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6877e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8911
    reference variance = 0.159411
====================================================
  Execution time = 2.0159e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6459e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6509e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364658742745
                                         uncertainty =       0.026306887977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364658742745
                                         uncertainty =       0.026306887977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426960223
  error estimate for blocks of size 2^( 2) =       0.000438944401
  error estimate for blocks of size 2^( 3) =       0.000450959326
  error estimate for blocks of size 2^( 4) =       0.000462633185
  error estimate for blocks of size 2^( 5) =       0.000473079149
  error estimate for blocks of size 2^( 6) =       0.000479771009
  error estimate for blocks of size 2^( 7) =       0.000483010460

      target function =                  N/A
              le_mean =     -16.906473607709
             les_mean =     286.193439730083
             stat err =       0.000474623451
             autocorr =       1.235729890936
              std dev =       0.603812938107
             le_variance =       0.364590064226


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690647360771e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906473607709       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906474235400       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906474345070       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906474820504       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906474889516       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906474711987       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906474655813       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906474649155       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906474683718       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.704142e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906473607709       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906473791581       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906473834339       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906473998086       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906474042524       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906474010835       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906473976688       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906473965531       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 7.095527e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906473607709       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906473655739       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906473668138       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906473713037       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906473727443       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906473721569       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906473711418       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906473708488       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 1.837163e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138313 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5817e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.119316e-01 1 1  ON 0
 uu_1                 1.444832e-01 1 1  ON 1
 uu_2                 4.257523e-02 1 1  ON 2
 uu_3                -2.039250e-02 1 1  ON 3
 uu_4                -6.657134e-02 1 1  ON 4
 uu_5                -1.023049e-01 1 1  ON 5
 uu_6                -1.308904e-01 1 1  ON 6
 uu_7                -1.456747e-01 1 1  ON 7
 uu_8                -1.384603e-01 1 1  ON 8
 uu_9                -1.104894e-01 1 1  ON 9
 ud_0                 4.526222e-01 1 1  ON 10
 ud_1                 1.864551e-01 1 1  ON 11
 ud_2                 6.533971e-02 1 1  ON 12
 ud_3                -6.523025e-03 1 1  ON 13
 ud_4                -6.416208e-02 1 1  ON 14
 ud_5                -1.063830e-01 1 1  ON 15
 ud_6                -1.346172e-01 1 1  ON 16
 ud_7                -1.522405e-01 1 1  ON 17
 ud_8                -1.529784e-01 1 1  ON 18
 ud_9                -1.431522e-01 1 1  ON 19
 eO_0                -7.558276e-01 1 1  ON 20
 eO_1                -4.340896e-01 1 1  ON 21
 eO_2                -1.745233e-02 1 1  ON 22
 eO_3                 3.008096e-01 1 1  ON 23
 eO_4                 5.290520e-01 1 1  ON 24
 eO_5                 4.927300e-01 1 1  ON 25
 eO_6                 2.634224e-01 1 1  ON 26
 eO_7                -4.206811e-02 1 1  ON 27
 eO_8                -2.327698e-01 1 1  ON 28
 eO_9                -1.000392e-01 1 1  ON 29
eH1_0                -2.593538e-01 1 1  ON 30
eH1_1                -1.543058e-01 1 1  ON 31
eH1_2                -1.053901e-01 1 1  ON 32
eH1_3                -5.000385e-02 1 1  ON 33
eH1_4                -7.005550e-04 1 1  ON 34
eH1_5                 3.503159e-02 1 1  ON 35
eH1_6                 9.571229e-02 1 1  ON 36
eH1_7                 1.583026e-01 1 1  ON 37
eH1_8                 1.916993e-01 1 1  ON 38
eH1_9                 8.935376e-02 1 1  ON 39
eH2_0                -2.568767e-01 1 1  ON 40
eH2_1                -1.516493e-01 1 1  ON 41
eH2_2                -1.029066e-01 1 1  ON 42
eH2_3                -4.763970e-02 1 1  ON 43
eH2_4                 1.759714e-03 1 1  ON 44
eH2_5                 3.744030e-02 1 1  ON 45
eH2_6                 9.957432e-02 1 1  ON 46
eH2_7                 1.600015e-01 1 1  ON 47
eH2_8                 1.960867e-01 1 1  ON 48
eH2_9                 7.812653e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8202
    reference variance = 0.596419
====================================================
  Execution time = 2.0104e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4393e-01
  Total weights = 2.0000e+06
  Execution time = 1.8976e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343965138262
                                         uncertainty =       0.006181563598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343965138262
                                         uncertainty =       0.006181563598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414683252
  error estimate for blocks of size 2^( 2) =       0.000427258193
  error estimate for blocks of size 2^( 3) =       0.000440283131
  error estimate for blocks of size 2^( 4) =       0.000451949174
  error estimate for blocks of size 2^( 5) =       0.000462822771
  error estimate for blocks of size 2^( 6) =       0.000472021436
  error estimate for blocks of size 2^( 7) =       0.000478020794

      target function =                  N/A
              le_mean =     -16.906273053439
             les_mean =     286.165992785216
             stat err =       0.000466203544
             autocorr =       1.263915816031
              std dev =       0.586450679724
             le_variance =       0.343924399749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343964445101
                                         uncertainty =       0.006182024986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343964445101
                                         uncertainty =       0.006182024986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414682758
  error estimate for blocks of size 2^( 2) =       0.000427256276
  error estimate for blocks of size 2^( 3) =       0.000440280048
  error estimate for blocks of size 2^( 4) =       0.000451947465
  error estimate for blocks of size 2^( 5) =       0.000462823875
  error estimate for blocks of size 2^( 6) =       0.000472025162
  error estimate for blocks of size 2^( 7) =       0.000478028139

      target function =                  N/A
              le_mean =     -16.906273208486
             les_mean =     286.165997207963
             stat err =       0.000466206160
             autocorr =       1.263933015341
              std dev =       0.586449980789
             le_variance =       0.343923579967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343971482466
                                         uncertainty =       0.006181890218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343971482466
                                         uncertainty =       0.006181890218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414687024
  error estimate for blocks of size 2^( 2) =       0.000427260948
  error estimate for blocks of size 2^( 3) =       0.000440285163
  error estimate for blocks of size 2^( 4) =       0.000451952151
  error estimate for blocks of size 2^( 5) =       0.000462827050
  error estimate for blocks of size 2^( 6) =       0.000472027262
  error estimate for blocks of size 2^( 7) =       0.000478028949

      target function =                  N/A
              le_mean =     -16.906272984150
             les_mean =     286.165996698162
             stat err =       0.000466208853
             autocorr =       1.263921614346
              std dev =       0.586456013301
             le_variance =       0.343930655537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343966437878
                                         uncertainty =       0.006181622255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343966437878
                                         uncertainty =       0.006181622255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414684028
  error estimate for blocks of size 2^( 2) =       0.000427258822
  error estimate for blocks of size 2^( 3) =       0.000440283662
  error estimate for blocks of size 2^( 4) =       0.000451949837
  error estimate for blocks of size 2^( 5) =       0.000462823587
  error estimate for blocks of size 2^( 6) =       0.000472022458
  error estimate for blocks of size 2^( 7) =       0.000478022132

      target function =                  N/A
              le_mean =     -16.906273028425
             les_mean =     286.165993226239
             stat err =       0.000466204504
             autocorr =       1.263916291662
              std dev =       0.586451776848
             le_variance =       0.343925686568


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906273053439        initial
     6.2500e-01     6.2500e+00             2.7041e-04       -16.906273208486  <--
     2.5000e+00     2.5000e+01             7.0955e-05       -16.906272984150
     1.0000e+01     1.0000e+02             1.8372e-05       -16.906273028425

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.9647e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.120863e-01 1 1  ON 0
 uu_1                 1.445347e-01 1 1  ON 1
 uu_2                 4.257775e-02 1 1  ON 2
 uu_3                -2.038474e-02 1 1  ON 3
 uu_4                -6.666776e-02 1 1  ON 4
 uu_5                -1.024662e-01 1 1  ON 5
 uu_6                -1.308807e-01 1 1  ON 6
 uu_7                -1.457537e-01 1 1  ON 7
 uu_8                -1.385439e-01 1 1  ON 8
 uu_9                -1.105256e-01 1 1  ON 9
 ud_0                 4.526611e-01 1 1  ON 10
 ud_1                 1.864755e-01 1 1  ON 11
 ud_2                 6.542804e-02 1 1  ON 12
 ud_3                -6.427563e-03 1 1  ON 13
 ud_4                -6.406846e-02 1 1  ON 14
 ud_5                -1.062802e-01 1 1  ON 15
 ud_6                -1.345851e-01 1 1  ON 16
 ud_7                -1.521813e-01 1 1  ON 17
 ud_8                -1.531335e-01 1 1  ON 18
 ud_9                -1.432706e-01 1 1  ON 19
 eO_0                -7.557154e-01 1 1  ON 20
 eO_1                -4.340792e-01 1 1  ON 21
 eO_2                -1.734896e-02 1 1  ON 22
 eO_3                 3.007684e-01 1 1  ON 23
 eO_4                 5.290933e-01 1 1  ON 24
 eO_5                 4.927755e-01 1 1  ON 25
 eO_6                 2.635547e-01 1 1  ON 26
 eO_7                -4.213161e-02 1 1  ON 27
 eO_8                -2.329426e-01 1 1  ON 28
 eO_9                -1.001862e-01 1 1  ON 29
eH1_0                -2.595404e-01 1 1  ON 30
eH1_1                -1.542703e-01 1 1  ON 31
eH1_2                -1.054129e-01 1 1  ON 32
eH1_3                -5.007028e-02 1 1  ON 33
eH1_4                -8.155662e-04 1 1  ON 34
eH1_5                 3.512143e-02 1 1  ON 35
eH1_6                 9.578811e-02 1 1  ON 36
eH1_7                 1.582368e-01 1 1  ON 37
eH1_8                 1.917253e-01 1 1  ON 38
eH1_9                 8.955838e-02 1 1  ON 39
eH2_0                -2.569319e-01 1 1  ON 40
eH2_1                -1.517197e-01 1 1  ON 41
eH2_2                -1.028874e-01 1 1  ON 42
eH2_3                -4.771978e-02 1 1  ON 43
eH2_4                 1.686429e-03 1 1  ON 44
eH2_5                 3.734736e-02 1 1  ON 45
eH2_6                 9.962493e-02 1 1  ON 46
eH2_7                 1.600736e-01 1 1  ON 47
eH2_8                 1.961653e-01 1 1  ON 48
eH2_9                 7.828078e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5471e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6870e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9088
    reference variance = 0.230301
====================================================
  Execution time = 2.0342e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.8933e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6606e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.389493301692
                                         uncertainty =       0.039851139641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.389493301692
                                         uncertainty =       0.039851139641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000441208871
  error estimate for blocks of size 2^( 2) =       0.000453244569
  error estimate for blocks of size 2^( 3) =       0.000465583777
  error estimate for blocks of size 2^( 4) =       0.000477313112
  error estimate for blocks of size 2^( 5) =       0.000488277903
  error estimate for blocks of size 2^( 6) =       0.000495306967
  error estimate for blocks of size 2^( 7) =       0.000501155146

      target function =                  N/A
              le_mean =     -16.906410490472
             les_mean =     286.216046013063
             stat err =       0.000490513282
             autocorr =       1.235984635175
              std dev =       0.623963568955
             le_variance =       0.389330535383


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690641049047e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906410490472       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906411578286       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906411200081       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906411983995       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906412827581       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906413066842       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906413354282       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906413939280       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906413582286       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906413413022       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906413534827       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.208375e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906410490472       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906410954617       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906410714027       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906411086506       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906411083208       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906411163190       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906411309618       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906411436179       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906411413780       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.986066e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906410490472       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906410631408       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906410550230       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906410570007       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906410613669       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906410614977       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906410665065       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906410700422       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 7.368835e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.142338 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6011e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.120212e-01 1 1  ON 0
 uu_1                 1.445721e-01 1 1  ON 1
 uu_2                 4.261228e-02 1 1  ON 2
 uu_3                -2.040517e-02 1 1  ON 3
 uu_4                -6.665042e-02 1 1  ON 4
 uu_5                -1.024845e-01 1 1  ON 5
 uu_6                -1.309449e-01 1 1  ON 6
 uu_7                -1.456882e-01 1 1  ON 7
 uu_8                -1.385146e-01 1 1  ON 8
 uu_9                -1.106581e-01 1 1  ON 9
 ud_0                 4.526299e-01 1 1  ON 10
 ud_1                 1.865931e-01 1 1  ON 11
 ud_2                 6.555379e-02 1 1  ON 12
 ud_3                -6.284341e-03 1 1  ON 13
 ud_4                -6.404187e-02 1 1  ON 14
 ud_5                -1.062162e-01 1 1  ON 15
 ud_6                -1.345084e-01 1 1  ON 16
 ud_7                -1.520833e-01 1 1  ON 17
 ud_8                -1.532429e-01 1 1  ON 18
 ud_9                -1.435196e-01 1 1  ON 19
 eO_0                -7.555925e-01 1 1  ON 20
 eO_1                -4.339123e-01 1 1  ON 21
 eO_2                -1.741910e-02 1 1  ON 22
 eO_3                 3.007010e-01 1 1  ON 23
 eO_4                 5.291507e-01 1 1  ON 24
 eO_5                 4.928488e-01 1 1  ON 25
 eO_6                 2.636818e-01 1 1  ON 26
 eO_7                -4.202128e-02 1 1  ON 27
 eO_8                -2.331530e-01 1 1  ON 28
 eO_9                -1.004648e-01 1 1  ON 29
eH1_0                -2.595208e-01 1 1  ON 30
eH1_1                -1.544795e-01 1 1  ON 31
eH1_2                -1.055272e-01 1 1  ON 32
eH1_3                -5.018602e-02 1 1  ON 33
eH1_4                -7.565661e-04 1 1  ON 34
eH1_5                 3.518390e-02 1 1  ON 35
eH1_6                 9.581848e-02 1 1  ON 36
eH1_7                 1.580582e-01 1 1  ON 37
eH1_8                 1.918376e-01 1 1  ON 38
eH1_9                 8.980998e-02 1 1  ON 39
eH2_0                -2.571290e-01 1 1  ON 40
eH2_1                -1.519404e-01 1 1  ON 41
eH2_2                -1.029331e-01 1 1  ON 42
eH2_3                -4.774498e-02 1 1  ON 43
eH2_4                 1.621887e-03 1 1  ON 44
eH2_5                 3.750396e-02 1 1  ON 45
eH2_6                 9.960164e-02 1 1  ON 46
eH2_7                 1.600500e-01 1 1  ON 47
eH2_8                 1.962948e-01 1 1  ON 48
eH2_9                 7.857939e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9529
    reference variance = 0.126895
====================================================
  Execution time = 2.0286e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3913e-01
  Total weights = 2.0000e+06
  Execution time = 1.9054e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339349818558
                                         uncertainty =       0.005336610818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339349818558
                                         uncertainty =       0.005336610818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411877245
  error estimate for blocks of size 2^( 2) =       0.000424961094
  error estimate for blocks of size 2^( 3) =       0.000438199591
  error estimate for blocks of size 2^( 4) =       0.000451164036
  error estimate for blocks of size 2^( 5) =       0.000463448766
  error estimate for blocks of size 2^( 6) =       0.000471536916
  error estimate for blocks of size 2^( 7) =       0.000476019694

      target function =                  N/A
              le_mean =     -16.906346062570
             les_mean =     286.163822747597
             stat err =       0.000465542353
             autocorr =       1.277564385463
              std dev =       0.582482385892
             le_variance =       0.339285729875

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339053978919
                                         uncertainty =       0.005328133464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339053978919
                                         uncertainty =       0.005328133464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411697739
  error estimate for blocks of size 2^( 2) =       0.000424784577
  error estimate for blocks of size 2^( 3) =       0.000438024261
  error estimate for blocks of size 2^( 4) =       0.000450991111
  error estimate for blocks of size 2^( 5) =       0.000463285729
  error estimate for blocks of size 2^( 6) =       0.000471384058
  error estimate for blocks of size 2^( 7) =       0.000475879253

      target function =                  N/A
              le_mean =     -16.906345427657
             les_mean =     286.163505606952
             stat err =       0.000465385038
             autocorr =       1.277814665392
              std dev =       0.582228526601
             le_variance =       0.338990057188

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339047241921
                                         uncertainty =       0.005329204309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339047241921
                                         uncertainty =       0.005329204309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411693632
  error estimate for blocks of size 2^( 2) =       0.000424781951
  error estimate for blocks of size 2^( 3) =       0.000438023643
  error estimate for blocks of size 2^( 4) =       0.000450991312
  error estimate for blocks of size 2^( 5) =       0.000463285076
  error estimate for blocks of size 2^( 6) =       0.000471380337
  error estimate for blocks of size 2^( 7) =       0.000475873106

      target function =                  N/A
              le_mean =     -16.906345156453
             les_mean =     286.163489672809
             stat err =       0.000465382458
             autocorr =       1.277825995898
              std dev =       0.582222717860
             le_variance =       0.338983293193

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339289447130
                                         uncertainty =       0.005335340366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339289447130
                                         uncertainty =       0.005335340366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411840613
  error estimate for blocks of size 2^( 2) =       0.000424925479
  error estimate for blocks of size 2^( 3) =       0.000438164870
  error estimate for blocks of size 2^( 4) =       0.000451130079
  error estimate for blocks of size 2^( 5) =       0.000463416445
  error estimate for blocks of size 2^( 6) =       0.000471505698
  error estimate for blocks of size 2^( 7) =       0.000475990017

      target function =                  N/A
              le_mean =     -16.906345819664
             les_mean =     286.163754186145
             stat err =       0.000465510560
             autocorr =       1.277617140649
              std dev =       0.582430580996
             le_variance =       0.339225381680


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906346062570        initial  <--
     1.5625e-01     1.5625e+00             1.2084e-03       -16.906345427657
     6.2500e-01     6.2500e+00             2.9861e-04       -16.906345156453
     2.5000e+00     2.5000e+01             7.3688e-05       -16.906345819664

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8857
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.120863e-01 1 1  ON 0
 uu_1                 1.445347e-01 1 1  ON 1
 uu_2                 4.257775e-02 1 1  ON 2
 uu_3                -2.038474e-02 1 1  ON 3
 uu_4                -6.666776e-02 1 1  ON 4
 uu_5                -1.024662e-01 1 1  ON 5
 uu_6                -1.308807e-01 1 1  ON 6
 uu_7                -1.457537e-01 1 1  ON 7
 uu_8                -1.385439e-01 1 1  ON 8
 uu_9                -1.105256e-01 1 1  ON 9
 ud_0                 4.526611e-01 1 1  ON 10
 ud_1                 1.864755e-01 1 1  ON 11
 ud_2                 6.542804e-02 1 1  ON 12
 ud_3                -6.427563e-03 1 1  ON 13
 ud_4                -6.406846e-02 1 1  ON 14
 ud_5                -1.062802e-01 1 1  ON 15
 ud_6                -1.345851e-01 1 1  ON 16
 ud_7                -1.521813e-01 1 1  ON 17
 ud_8                -1.531335e-01 1 1  ON 18
 ud_9                -1.432706e-01 1 1  ON 19
 eO_0                -7.557154e-01 1 1  ON 20
 eO_1                -4.340792e-01 1 1  ON 21
 eO_2                -1.734896e-02 1 1  ON 22
 eO_3                 3.007684e-01 1 1  ON 23
 eO_4                 5.290933e-01 1 1  ON 24
 eO_5                 4.927755e-01 1 1  ON 25
 eO_6                 2.635547e-01 1 1  ON 26
 eO_7                -4.213161e-02 1 1  ON 27
 eO_8                -2.329426e-01 1 1  ON 28
 eO_9                -1.001862e-01 1 1  ON 29
eH1_0                -2.595404e-01 1 1  ON 30
eH1_1                -1.542703e-01 1 1  ON 31
eH1_2                -1.054129e-01 1 1  ON 32
eH1_3                -5.007028e-02 1 1  ON 33
eH1_4                -8.155662e-04 1 1  ON 34
eH1_5                 3.512143e-02 1 1  ON 35
eH1_6                 9.578811e-02 1 1  ON 36
eH1_7                 1.582368e-01 1 1  ON 37
eH1_8                 1.917253e-01 1 1  ON 38
eH1_9                 8.955838e-02 1 1  ON 39
eH2_0                -2.569319e-01 1 1  ON 40
eH2_1                -1.517197e-01 1 1  ON 41
eH2_2                -1.028874e-01 1 1  ON 42
eH2_3                -4.771978e-02 1 1  ON 43
eH2_4                 1.686429e-03 1 1  ON 44
eH2_5                 3.734736e-02 1 1  ON 45
eH2_6                 9.962493e-02 1 1  ON 46
eH2_7                 1.600736e-01 1 1  ON 47
eH2_8                 1.961653e-01 1 1  ON 48
eH2_9                 7.828078e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5904e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6885e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8097
    reference variance = 0.403411
====================================================
  Execution time = 2.0183e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5185e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6422e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351897211726
                                         uncertainty =       0.018703825537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351897211726
                                         uncertainty =       0.018703825537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419434055
  error estimate for blocks of size 2^( 2) =       0.000431786309
  error estimate for blocks of size 2^( 3) =       0.000444709925
  error estimate for blocks of size 2^( 4) =       0.000456966844
  error estimate for blocks of size 2^( 5) =       0.000466854696
  error estimate for blocks of size 2^( 6) =       0.000476895222
  error estimate for blocks of size 2^( 7) =       0.000482285583

      target function =                  N/A
              le_mean =     -16.905929678039
             les_mean =     286.162307955060
             stat err =       0.000470750586
             autocorr =       1.259662967731
              std dev =       0.593169328428
             le_variance =       0.351849852188


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690592967804e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905929678039       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905929989596       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905929890016       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905930004126       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905929861100       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905929892612       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905929981780       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905930005006       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.264158e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905929678039       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905929762376       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905929741647       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905929789165       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905929769205       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905929777229       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905929782096       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905929783769       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.192040e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905929678039       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905929699569       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905929694758       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905929708450       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905929704316       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905929706809       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905929706990       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905929706851       residual = 2.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 7.998612e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145071 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5832e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.120867e-01 1 1  ON 0
 uu_1                 1.445493e-01 1 1  ON 1
 uu_2                 4.258704e-02 1 1  ON 2
 uu_3                -2.040587e-02 1 1  ON 3
 uu_4                -6.667390e-02 1 1  ON 4
 uu_5                -1.024743e-01 1 1  ON 5
 uu_6                -1.308814e-01 1 1  ON 6
 uu_7                -1.457653e-01 1 1  ON 7
 uu_8                -1.385438e-01 1 1  ON 8
 uu_9                -1.105239e-01 1 1  ON 9
 ud_0                 4.526571e-01 1 1  ON 10
 ud_1                 1.864696e-01 1 1  ON 11
 ud_2                 6.542292e-02 1 1  ON 12
 ud_3                -6.420251e-03 1 1  ON 13
 ud_4                -6.407192e-02 1 1  ON 14
 ud_5                -1.062752e-01 1 1  ON 15
 ud_6                -1.345836e-01 1 1  ON 16
 ud_7                -1.521698e-01 1 1  ON 17
 ud_8                -1.531262e-01 1 1  ON 18
 ud_9                -1.432719e-01 1 1  ON 19
 eO_0                -7.557167e-01 1 1  ON 20
 eO_1                -4.340682e-01 1 1  ON 21
 eO_2                -1.733983e-02 1 1  ON 22
 eO_3                 3.007847e-01 1 1  ON 23
 eO_4                 5.290853e-01 1 1  ON 24
 eO_5                 4.927730e-01 1 1  ON 25
 eO_6                 2.635593e-01 1 1  ON 26
 eO_7                -4.212691e-02 1 1  ON 27
 eO_8                -2.329555e-01 1 1  ON 28
 eO_9                -1.002045e-01 1 1  ON 29
eH1_0                -2.595547e-01 1 1  ON 30
eH1_1                -1.542825e-01 1 1  ON 31
eH1_2                -1.054111e-01 1 1  ON 32
eH1_3                -5.008892e-02 1 1  ON 33
eH1_4                -8.097344e-04 1 1  ON 34
eH1_5                 3.511532e-02 1 1  ON 35
eH1_6                 9.577759e-02 1 1  ON 36
eH1_7                 1.582300e-01 1 1  ON 37
eH1_8                 1.917477e-01 1 1  ON 38
eH1_9                 8.959030e-02 1 1  ON 39
eH2_0                -2.569283e-01 1 1  ON 40
eH2_1                -1.517291e-01 1 1  ON 41
eH2_2                -1.029032e-01 1 1  ON 42
eH2_3                -4.770969e-02 1 1  ON 43
eH2_4                 1.673181e-03 1 1  ON 44
eH2_5                 3.732892e-02 1 1  ON 45
eH2_6                 9.961433e-02 1 1  ON 46
eH2_7                 1.600844e-01 1 1  ON 47
eH2_8                 1.961792e-01 1 1  ON 48
eH2_9                 7.830833e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8616
    reference variance = 0.234405
====================================================
  Execution time = 2.0019e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3499e-01
  Total weights = 2.0000e+06
  Execution time = 1.9011e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334678944219
                                         uncertainty =       0.002569622056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334678944219
                                         uncertainty =       0.002569622056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409261837
  error estimate for blocks of size 2^( 2) =       0.000422034344
  error estimate for blocks of size 2^( 3) =       0.000434993535
  error estimate for blocks of size 2^( 4) =       0.000447758554
  error estimate for blocks of size 2^( 5) =       0.000457616088
  error estimate for blocks of size 2^( 6) =       0.000465568910
  error estimate for blocks of size 2^( 7) =       0.000471103511

      target function =                  N/A
              le_mean =     -16.906243176676
             les_mean =     286.156048683346
             stat err =       0.000460511766
             autocorr =       1.266131936131
              std dev =       0.578783640011
             le_variance =       0.334990501945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334692552596
                                         uncertainty =       0.002569916238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334692552596
                                         uncertainty =       0.002569916238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409270104
  error estimate for blocks of size 2^( 2) =       0.000422041431
  error estimate for blocks of size 2^( 3) =       0.000434999970
  error estimate for blocks of size 2^( 4) =       0.000447764931
  error estimate for blocks of size 2^( 5) =       0.000457624099
  error estimate for blocks of size 2^( 6) =       0.000465576227
  error estimate for blocks of size 2^( 7) =       0.000471110030

      target function =                  N/A
              le_mean =     -16.906243476112
             les_mean =     286.156072341397
             stat err =       0.000460518822
             autocorr =       1.266119584811
              std dev =       0.578795331118
             le_variance =       0.335004035324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334686459711
                                         uncertainty =       0.002569785940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334686459711
                                         uncertainty =       0.002569785940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409266401
  error estimate for blocks of size 2^( 2) =       0.000422038233
  error estimate for blocks of size 2^( 3) =       0.000434997070
  error estimate for blocks of size 2^( 4) =       0.000447762026
  error estimate for blocks of size 2^( 5) =       0.000457620431
  error estimate for blocks of size 2^( 6) =       0.000465572794
  error estimate for blocks of size 2^( 7) =       0.000471106975

      target function =                  N/A
              le_mean =     -16.906243357750
             les_mean =     286.156062278344
             stat err =       0.000460515556
             autocorr =       1.266124537949
              std dev =       0.578790095264
             le_variance =       0.334997974375

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334679907195
                                         uncertainty =       0.002569643209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334679907195
                                         uncertainty =       0.002569643209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409262422
  error estimate for blocks of size 2^( 2) =       0.000422034840
  error estimate for blocks of size 2^( 3) =       0.000434993986
  error estimate for blocks of size 2^( 4) =       0.000447758995
  error estimate for blocks of size 2^( 5) =       0.000457616640
  error estimate for blocks of size 2^( 6) =       0.000465569400
  error estimate for blocks of size 2^( 7) =       0.000471103948

      target function =                  N/A
              le_mean =     -16.906243199683
             les_mean =     286.156050418646
             stat err =       0.000460512246
             autocorr =       1.266130956779
              std dev =       0.578784467062
             le_variance =       0.334991459312


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906243176676        initial
     1.5625e+00     1.5625e+01             1.2642e-04       -16.906243476112  <--
     6.2500e+00     6.2500e+01             3.1920e-05       -16.906243357750
     2.5000e+01     2.5000e+02             7.9986e-06       -16.906243199683

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.9753e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.120937e-01 1 1  ON 0
 uu_1                 1.445865e-01 1 1  ON 1
 uu_2                 4.260772e-02 1 1  ON 2
 uu_3                -2.045773e-02 1 1  ON 3
 uu_4                -6.669671e-02 1 1  ON 4
 uu_5                -1.024959e-01 1 1  ON 5
 uu_6                -1.308861e-01 1 1  ON 6
 uu_7                -1.457996e-01 1 1  ON 7
 uu_8                -1.385432e-01 1 1  ON 8
 uu_9                -1.105186e-01 1 1  ON 9
 ud_0                 4.526446e-01 1 1  ON 10
 ud_1                 1.864545e-01 1 1  ON 11
 ud_2                 6.540926e-02 1 1  ON 12
 ud_3                -6.403940e-03 1 1  ON 13
 ud_4                -6.407907e-02 1 1  ON 14
 ud_5                -1.062614e-01 1 1  ON 15
 ud_6                -1.345781e-01 1 1  ON 16
 ud_7                -1.521374e-01 1 1  ON 17
 ud_8                -1.531046e-01 1 1  ON 18
 ud_9                -1.432754e-01 1 1  ON 19
 eO_0                -7.557185e-01 1 1  ON 20
 eO_1                -4.340359e-01 1 1  ON 21
 eO_2                -1.731175e-02 1 1  ON 22
 eO_3                 3.008301e-01 1 1  ON 23
 eO_4                 5.290618e-01 1 1  ON 24
 eO_5                 4.927653e-01 1 1  ON 25
 eO_6                 2.635729e-01 1 1  ON 26
 eO_7                -4.211290e-02 1 1  ON 27
 eO_8                -2.329935e-01 1 1  ON 28
 eO_9                -1.002586e-01 1 1  ON 29
eH1_0                -2.595972e-01 1 1  ON 30
eH1_1                -1.543174e-01 1 1  ON 31
eH1_2                -1.054095e-01 1 1  ON 32
eH1_3                -5.013913e-02 1 1  ON 33
eH1_4                -7.959514e-04 1 1  ON 34
eH1_5                 3.509804e-02 1 1  ON 35
eH1_6                 9.574682e-02 1 1  ON 36
eH1_7                 1.582098e-01 1 1  ON 37
eH1_8                 1.918139e-01 1 1  ON 38
eH1_9                 8.968480e-02 1 1  ON 39
eH2_0                -2.569190e-01 1 1  ON 40
eH2_1                -1.517568e-01 1 1  ON 41
eH2_2                -1.029439e-01 1 1  ON 42
eH2_3                -4.768684e-02 1 1  ON 43
eH2_4                 1.637252e-03 1 1  ON 44
eH2_5                 3.727342e-02 1 1  ON 45
eH2_6                 9.958221e-02 1 1  ON 46
eH2_7                 1.601164e-01 1 1  ON 47
eH2_8                 1.962206e-01 1 1  ON 48
eH2_9                 7.838993e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5592e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6875e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.85
    reference variance = 0.216882
====================================================
  Execution time = 2.0335e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3309e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6301e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333071519709
                                         uncertainty =       0.002599044135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333071519709
                                         uncertainty =       0.002599044135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408100008
  error estimate for blocks of size 2^( 2) =       0.000421052738
  error estimate for blocks of size 2^( 3) =       0.000434515869
  error estimate for blocks of size 2^( 4) =       0.000447007832
  error estimate for blocks of size 2^( 5) =       0.000458168150
  error estimate for blocks of size 2^( 6) =       0.000469226589
  error estimate for blocks of size 2^( 7) =       0.000476154939

      target function =                  N/A
              le_mean =     -16.905558065293
             les_mean =     286.130984565107
             stat err =       0.000462639377
             autocorr =       1.285144563724
              std dev =       0.577140565778
             le_variance =       0.333091232666


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690555806529e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905558065293       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905559336841       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905560546843       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905562182372       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905562524564       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905562711844       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905562205596       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905562365780       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905562473279       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 4.757157e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905558065293       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905558469281       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905558963403       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905559466732       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905559607557       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905559655777       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905559517330       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905559525018       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.200593e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905558065293       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905558173625       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905558324214       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905558446903       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905558501213       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905558506606       residual = 8.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905558478684       residual = 7.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.009664e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147868 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5974e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.120542e-01 1 1  ON 0
 uu_1                 1.445349e-01 1 1  ON 1
 uu_2                 4.260284e-02 1 1  ON 2
 uu_3                -2.049787e-02 1 1  ON 3
 uu_4                -6.664542e-02 1 1  ON 4
 uu_5                -1.024991e-01 1 1  ON 5
 uu_6                -1.308811e-01 1 1  ON 6
 uu_7                -1.457991e-01 1 1  ON 7
 uu_8                -1.385649e-01 1 1  ON 8
 uu_9                -1.105424e-01 1 1  ON 9
 ud_0                 4.526620e-01 1 1  ON 10
 ud_1                 1.864956e-01 1 1  ON 11
 ud_2                 6.541088e-02 1 1  ON 12
 ud_3                -6.407176e-03 1 1  ON 13
 ud_4                -6.407421e-02 1 1  ON 14
 ud_5                -1.063127e-01 1 1  ON 15
 ud_6                -1.345392e-01 1 1  ON 16
 ud_7                -1.521121e-01 1 1  ON 17
 ud_8                -1.531556e-01 1 1  ON 18
 ud_9                -1.433005e-01 1 1  ON 19
 eO_0                -7.557061e-01 1 1  ON 20
 eO_1                -4.340150e-01 1 1  ON 21
 eO_2                -1.731672e-02 1 1  ON 22
 eO_3                 3.008267e-01 1 1  ON 23
 eO_4                 5.290864e-01 1 1  ON 24
 eO_5                 4.927466e-01 1 1  ON 25
 eO_6                 2.636347e-01 1 1  ON 26
 eO_7                -4.204941e-02 1 1  ON 27
 eO_8                -2.330542e-01 1 1  ON 28
 eO_9                -1.003432e-01 1 1  ON 29
eH1_0                -2.596933e-01 1 1  ON 30
eH1_1                -1.543910e-01 1 1  ON 31
eH1_2                -1.054081e-01 1 1  ON 32
eH1_3                -5.018665e-02 1 1  ON 33
eH1_4                -8.120550e-04 1 1  ON 34
eH1_5                 3.507876e-02 1 1  ON 35
eH1_6                 9.578962e-02 1 1  ON 36
eH1_7                 1.582123e-01 1 1  ON 37
eH1_8                 1.918687e-01 1 1  ON 38
eH1_9                 8.980360e-02 1 1  ON 39
eH2_0                -2.570391e-01 1 1  ON 40
eH2_1                -1.518538e-01 1 1  ON 41
eH2_2                -1.029805e-01 1 1  ON 42
eH2_3                -4.769580e-02 1 1  ON 43
eH2_4                 1.605436e-03 1 1  ON 44
eH2_5                 3.734028e-02 1 1  ON 45
eH2_6                 9.959608e-02 1 1  ON 46
eH2_7                 1.601430e-01 1 1  ON 47
eH2_8                 1.962970e-01 1 1  ON 48
eH2_9                 7.849431e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.923
    reference variance = 0.417675
====================================================
  Execution time = 2.0251e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3641e-01
  Total weights = 2.0000e+06
  Execution time = 1.8994e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336488758265
                                         uncertainty =       0.003773953283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336488758265
                                         uncertainty =       0.003773953283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410142700
  error estimate for blocks of size 2^( 2) =       0.000423453269
  error estimate for blocks of size 2^( 3) =       0.000436202352
  error estimate for blocks of size 2^( 4) =       0.000448526302
  error estimate for blocks of size 2^( 5) =       0.000458915959
  error estimate for blocks of size 2^( 6) =       0.000467557660
  error estimate for blocks of size 2^( 7) =       0.000472981790

      target function =                  N/A
              le_mean =     -16.905475605701
             les_mean =     286.131539355416
             stat err =       0.000461995428
             autocorr =       1.268835680458
              std dev =       0.580029368813
             le_variance =       0.336434068686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336444004983
                                         uncertainty =       0.003773767869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336444004983
                                         uncertainty =       0.003773767869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410115458
  error estimate for blocks of size 2^( 2) =       0.000423427419
  error estimate for blocks of size 2^( 3) =       0.000436178987
  error estimate for blocks of size 2^( 4) =       0.000448503790
  error estimate for blocks of size 2^( 5) =       0.000458895886
  error estimate for blocks of size 2^( 6) =       0.000467538165
  error estimate for blocks of size 2^( 7) =       0.000472966094

      target function =                  N/A
              le_mean =     -16.905474490093
             les_mean =     286.131456945042
             stat err =       0.000461975983
             autocorr =       1.268897433580
              std dev =       0.579990843064
             le_variance =       0.336389378038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336446901154
                                         uncertainty =       0.003773727747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336446901154
                                         uncertainty =       0.003773727747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410117212
  error estimate for blocks of size 2^( 2) =       0.000423428867
  error estimate for blocks of size 2^( 3) =       0.000436179969
  error estimate for blocks of size 2^( 4) =       0.000448504684
  error estimate for blocks of size 2^( 5) =       0.000458896414
  error estimate for blocks of size 2^( 6) =       0.000467539171
  error estimate for blocks of size 2^( 7) =       0.000472965737

      target function =                  N/A
              le_mean =     -16.905474544416
             les_mean =     286.131461659099
             stat err =       0.000461976501
             autocorr =       1.268889424803
              std dev =       0.579993323566
             le_variance =       0.336392255382

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336480814614
                                         uncertainty =       0.003773898473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336480814614
                                         uncertainty =       0.003773898473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410137862
  error estimate for blocks of size 2^( 2) =       0.000423448630
  error estimate for blocks of size 2^( 3) =       0.000436198048
  error estimate for blocks of size 2^( 4) =       0.000448522133
  error estimate for blocks of size 2^( 5) =       0.000458912128
  error estimate for blocks of size 2^( 6) =       0.000467554023
  error estimate for blocks of size 2^( 7) =       0.000472978496

      target function =                  N/A
              le_mean =     -16.905475423294
             les_mean =     286.131525250686
             stat err =       0.000461991695
             autocorr =       1.268845113368
              std dev =       0.580022526535
             le_variance =       0.336426131287


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905475605701        initial  <--
     3.9062e-01     3.9062e+00             4.7572e-04       -16.905474490093
     1.5625e+00     1.5625e+01             1.2006e-04       -16.905474544416
     6.2500e+00     6.2500e+01             3.0097e-05       -16.905475423294

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7954
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.120937e-01 1 1  ON 0
 uu_1                 1.445865e-01 1 1  ON 1
 uu_2                 4.260772e-02 1 1  ON 2
 uu_3                -2.045773e-02 1 1  ON 3
 uu_4                -6.669671e-02 1 1  ON 4
 uu_5                -1.024959e-01 1 1  ON 5
 uu_6                -1.308861e-01 1 1  ON 6
 uu_7                -1.457996e-01 1 1  ON 7
 uu_8                -1.385432e-01 1 1  ON 8
 uu_9                -1.105186e-01 1 1  ON 9
 ud_0                 4.526446e-01 1 1  ON 10
 ud_1                 1.864545e-01 1 1  ON 11
 ud_2                 6.540926e-02 1 1  ON 12
 ud_3                -6.403940e-03 1 1  ON 13
 ud_4                -6.407907e-02 1 1  ON 14
 ud_5                -1.062614e-01 1 1  ON 15
 ud_6                -1.345781e-01 1 1  ON 16
 ud_7                -1.521374e-01 1 1  ON 17
 ud_8                -1.531046e-01 1 1  ON 18
 ud_9                -1.432754e-01 1 1  ON 19
 eO_0                -7.557185e-01 1 1  ON 20
 eO_1                -4.340359e-01 1 1  ON 21
 eO_2                -1.731175e-02 1 1  ON 22
 eO_3                 3.008301e-01 1 1  ON 23
 eO_4                 5.290618e-01 1 1  ON 24
 eO_5                 4.927653e-01 1 1  ON 25
 eO_6                 2.635729e-01 1 1  ON 26
 eO_7                -4.211290e-02 1 1  ON 27
 eO_8                -2.329935e-01 1 1  ON 28
 eO_9                -1.002586e-01 1 1  ON 29
eH1_0                -2.595972e-01 1 1  ON 30
eH1_1                -1.543174e-01 1 1  ON 31
eH1_2                -1.054095e-01 1 1  ON 32
eH1_3                -5.013913e-02 1 1  ON 33
eH1_4                -7.959514e-04 1 1  ON 34
eH1_5                 3.509804e-02 1 1  ON 35
eH1_6                 9.574682e-02 1 1  ON 36
eH1_7                 1.582098e-01 1 1  ON 37
eH1_8                 1.918139e-01 1 1  ON 38
eH1_9                 8.968480e-02 1 1  ON 39
eH2_0                -2.569190e-01 1 1  ON 40
eH2_1                -1.517568e-01 1 1  ON 41
eH2_2                -1.029439e-01 1 1  ON 42
eH2_3                -4.768684e-02 1 1  ON 43
eH2_4                 1.637252e-03 1 1  ON 44
eH2_5                 3.727342e-02 1 1  ON 45
eH2_6                 9.958221e-02 1 1  ON 46
eH2_7                 1.601164e-01 1 1  ON 47
eH2_8                 1.962206e-01 1 1  ON 48
eH2_9                 7.838993e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5777e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6877e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8942
    reference variance = 0.206371
====================================================
  Execution time = 2.0470e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5107e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5690e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351093737104
                                         uncertainty =       0.013876071840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351093737104
                                         uncertainty =       0.013876071840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418969925
  error estimate for blocks of size 2^( 2) =       0.000431270112
  error estimate for blocks of size 2^( 3) =       0.000443923858
  error estimate for blocks of size 2^( 4) =       0.000455136619
  error estimate for blocks of size 2^( 5) =       0.000464293887
  error estimate for blocks of size 2^( 6) =       0.000470148523
  error estimate for blocks of size 2^( 7) =       0.000473357252

      target function =                  N/A
              le_mean =     -16.906175012647
             les_mean =     286.169824979584
             stat err =       0.000465734070
             autocorr =       1.235692241013
              std dev =       0.592512950800
             le_variance =       0.351071596866


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690617501265e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906175012647       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906175258105       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906175437619       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906175544294       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906175600787       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906175569157       residual = 7.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906175514742       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906175521654       residual = 7.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 5.451170e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906175012647       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906175077179       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906175124307       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906175153004       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906175168627       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906175160977       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906175147805       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906175149271       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.366580e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906175012647       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906175028991       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906175040926       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906175048241       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906175052252       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906175050363       residual = 6.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906175047108       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906175047454       residual = 5.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 3.418962e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150615 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6047e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.120928e-01 1 1  ON 0
 uu_1                 1.445893e-01 1 1  ON 1
 uu_2                 4.260162e-02 1 1  ON 2
 uu_3                -2.045993e-02 1 1  ON 3
 uu_4                -6.669109e-02 1 1  ON 4
 uu_5                -1.025009e-01 1 1  ON 5
 uu_6                -1.308786e-01 1 1  ON 6
 uu_7                -1.457995e-01 1 1  ON 7
 uu_8                -1.385509e-01 1 1  ON 8
 uu_9                -1.105248e-01 1 1  ON 9
 ud_0                 4.526446e-01 1 1  ON 10
 ud_1                 1.864607e-01 1 1  ON 11
 ud_2                 6.541316e-02 1 1  ON 12
 ud_3                -6.398534e-03 1 1  ON 13
 ud_4                -6.407507e-02 1 1  ON 14
 ud_5                -1.062608e-01 1 1  ON 15
 ud_6                -1.345734e-01 1 1  ON 16
 ud_7                -1.521391e-01 1 1  ON 17
 ud_8                -1.531145e-01 1 1  ON 18
 ud_9                -1.432846e-01 1 1  ON 19
 eO_0                -7.557145e-01 1 1  ON 20
 eO_1                -4.340273e-01 1 1  ON 21
 eO_2                -1.731218e-02 1 1  ON 22
 eO_3                 3.008299e-01 1 1  ON 23
 eO_4                 5.290647e-01 1 1  ON 24
 eO_5                 4.927633e-01 1 1  ON 25
 eO_6                 2.635809e-01 1 1  ON 26
 eO_7                -4.211010e-02 1 1  ON 27
 eO_8                -2.330053e-01 1 1  ON 28
 eO_9                -1.002693e-01 1 1  ON 29
eH1_0                -2.595992e-01 1 1  ON 30
eH1_1                -1.543216e-01 1 1  ON 31
eH1_2                -1.054138e-01 1 1  ON 32
eH1_3                -5.013743e-02 1 1  ON 33
eH1_4                -7.983154e-04 1 1  ON 34
eH1_5                 3.509557e-02 1 1  ON 35
eH1_6                 9.574764e-02 1 1  ON 36
eH1_7                 1.582115e-01 1 1  ON 37
eH1_8                 1.918176e-01 1 1  ON 38
eH1_9                 8.969162e-02 1 1  ON 39
eH2_0                -2.569211e-01 1 1  ON 40
eH2_1                -1.517685e-01 1 1  ON 41
eH2_2                -1.029408e-01 1 1  ON 42
eH2_3                -4.768706e-02 1 1  ON 43
eH2_4                 1.636489e-03 1 1  ON 44
eH2_5                 3.727465e-02 1 1  ON 45
eH2_6                 9.957692e-02 1 1  ON 46
eH2_7                 1.601107e-01 1 1  ON 47
eH2_8                 1.962245e-01 1 1  ON 48
eH2_9                 7.840360e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9736
    reference variance = 0.288483
====================================================
  Execution time = 2.0214e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4124e-01
  Total weights = 2.0000e+06
  Execution time = 1.9013e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341145407264
                                         uncertainty =       0.006681223384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341145407264
                                         uncertainty =       0.006681223384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413065646
  error estimate for blocks of size 2^( 2) =       0.000425410495
  error estimate for blocks of size 2^( 3) =       0.000438543074
  error estimate for blocks of size 2^( 4) =       0.000449685804
  error estimate for blocks of size 2^( 5) =       0.000459195487
  error estimate for blocks of size 2^( 6) =       0.000466665507
  error estimate for blocks of size 2^( 7) =       0.000471533907

      target function =                  N/A
              le_mean =     -16.906488778032
             les_mean =     286.170609087049
             stat err =       0.000461770176
             autocorr =       1.249722550750
              std dev =       0.584163038849
             le_variance =       0.341246455957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341136653671
                                         uncertainty =       0.006680889513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341136653671
                                         uncertainty =       0.006680889513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413060351
  error estimate for blocks of size 2^( 2) =       0.000425405252
  error estimate for blocks of size 2^( 3) =       0.000438538190
  error estimate for blocks of size 2^( 4) =       0.000449680864
  error estimate for blocks of size 2^( 5) =       0.000459190377
  error estimate for blocks of size 2^( 6) =       0.000466660546
  error estimate for blocks of size 2^( 7) =       0.000471529898

      target function =                  N/A
              le_mean =     -16.906489154567
             les_mean =     286.170613069337
             stat err =       0.000461765421
             autocorr =       1.249728855891
              std dev =       0.584155549887
             le_variance =       0.341237706464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341140687582
                                         uncertainty =       0.006681038398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341140687582
                                         uncertainty =       0.006681038398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413062791
  error estimate for blocks of size 2^( 2) =       0.000425407676
  error estimate for blocks of size 2^( 3) =       0.000438540455
  error estimate for blocks of size 2^( 4) =       0.000449683160
  error estimate for blocks of size 2^( 5) =       0.000459192747
  error estimate for blocks of size 2^( 6) =       0.000466662849
  error estimate for blocks of size 2^( 7) =       0.000471531760

      target function =                  N/A
              le_mean =     -16.906488982593
             les_mean =     286.170611286607
             stat err =       0.000461767629
             autocorr =       1.249726039621
              std dev =       0.584159001208
             le_variance =       0.341241738692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341144805353
                                         uncertainty =       0.006681199645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341144805353
                                         uncertainty =       0.006681199645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413065282
  error estimate for blocks of size 2^( 2) =       0.000425410136
  error estimate for blocks of size 2^( 3) =       0.000438542741
  error estimate for blocks of size 2^( 4) =       0.000449685468
  error estimate for blocks of size 2^( 5) =       0.000459195138
  error estimate for blocks of size 2^( 6) =       0.000466665168
  error estimate for blocks of size 2^( 7) =       0.000471533633

      target function =                  N/A
              le_mean =     -16.906488803993
             les_mean =     286.170609363264
             stat err =       0.000461769852
             autocorr =       1.249722997212
              std dev =       0.584162523928
             le_variance =       0.341245854362


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906488778032        initial
     3.9062e+00     3.9062e+01             5.4512e-05       -16.906489154567  <--
     1.5625e+01     1.5625e+02             1.3666e-05       -16.906488982593
     6.2500e+01     6.2500e+02             3.4190e-06       -16.906488803993

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 3.2676e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.120907e-01 1 1  ON 0
 uu_1                 1.445958e-01 1 1  ON 1
 uu_2                 4.258531e-02 1 1  ON 2
 uu_3                -2.046640e-02 1 1  ON 3
 uu_4                -6.667567e-02 1 1  ON 4
 uu_5                -1.025144e-01 1 1  ON 5
 uu_6                -1.308573e-01 1 1  ON 6
 uu_7                -1.457990e-01 1 1  ON 7
 uu_8                -1.385738e-01 1 1  ON 8
 uu_9                -1.105434e-01 1 1  ON 9
 ud_0                 4.526462e-01 1 1  ON 10
 ud_1                 1.864780e-01 1 1  ON 11
 ud_2                 6.542515e-02 1 1  ON 12
 ud_3                -6.383102e-03 1 1  ON 13
 ud_4                -6.406303e-02 1 1  ON 14
 ud_5                -1.062583e-01 1 1  ON 15
 ud_6                -1.345602e-01 1 1  ON 16
 ud_7                -1.521438e-01 1 1  ON 17
 ud_8                -1.531438e-01 1 1  ON 18
 ud_9                -1.433121e-01 1 1  ON 19
 eO_0                -7.557019e-01 1 1  ON 20
 eO_1                -4.340023e-01 1 1  ON 21
 eO_2                -1.731335e-02 1 1  ON 22
 eO_3                 3.008294e-01 1 1  ON 23
 eO_4                 5.290735e-01 1 1  ON 24
 eO_5                 4.927574e-01 1 1  ON 25
 eO_6                 2.636045e-01 1 1  ON 26
 eO_7                -4.210169e-02 1 1  ON 27
 eO_8                -2.330407e-01 1 1  ON 28
 eO_9                -1.003010e-01 1 1  ON 29
eH1_0                -2.596052e-01 1 1  ON 30
eH1_1                -1.543341e-01 1 1  ON 31
eH1_2                -1.054263e-01 1 1  ON 32
eH1_3                -5.013339e-02 1 1  ON 33
eH1_4                -8.048801e-04 1 1  ON 34
eH1_5                 3.508823e-02 1 1  ON 35
eH1_6                 9.575013e-02 1 1  ON 36
eH1_7                 1.582166e-01 1 1  ON 37
eH1_8                 1.918286e-01 1 1  ON 38
eH1_9                 8.971203e-02 1 1  ON 39
eH2_0                -2.569275e-01 1 1  ON 40
eH2_1                -1.518019e-01 1 1  ON 41
eH2_2                -1.029328e-01 1 1  ON 42
eH2_3                -4.768778e-02 1 1  ON 43
eH2_4                 1.634382e-03 1 1  ON 44
eH2_5                 3.727805e-02 1 1  ON 45
eH2_6                 9.956111e-02 1 1  ON 46
eH2_7                 1.600937e-01 1 1  ON 47
eH2_8                 1.962359e-01 1 1  ON 48
eH2_9                 7.844445e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8730e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6885e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.901
    reference variance = 0.245044
====================================================
  Execution time = 2.0304e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4076e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340856930898
                                         uncertainty =       0.003298280049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340856930898
                                         uncertainty =       0.003298280049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412770261
  error estimate for blocks of size 2^( 2) =       0.000425267724
  error estimate for blocks of size 2^( 3) =       0.000437808637
  error estimate for blocks of size 2^( 4) =       0.000449555140
  error estimate for blocks of size 2^( 5) =       0.000461143619
  error estimate for blocks of size 2^( 6) =       0.000470214297
  error estimate for blocks of size 2^( 7) =       0.000476187087

      target function =                  N/A
              le_mean =     -16.906383157051
             les_mean =     286.166549858559
             stat err =       0.000464275036
             autocorr =       1.265126244555
              std dev =       0.583745300546
             le_variance =       0.340758575909


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690638315705e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906383157051       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906383397706       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906384783271       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906385400518       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906385535603       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906385517314       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906385377292       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906385304378       residual = 6.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 1.902106e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906383157051       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906383227557       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906383637751       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906383820925       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906383861904       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906383851396       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906383811806       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906383802421       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 4.830303e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906383157051       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906383175469       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906383283144       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906383331165       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906383342499       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906383339357       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906383329040       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906383327329       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.211160e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153280 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5890e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.120808e-01 1 1  ON 0
 uu_1                 1.445927e-01 1 1  ON 1
 uu_2                 4.259659e-02 1 1  ON 2
 uu_3                -2.047047e-02 1 1  ON 3
 uu_4                -6.666586e-02 1 1  ON 4
 uu_5                -1.024916e-01 1 1  ON 5
 uu_6                -1.308693e-01 1 1  ON 6
 uu_7                -1.458049e-01 1 1  ON 7
 uu_8                -1.386006e-01 1 1  ON 8
 uu_9                -1.105672e-01 1 1  ON 9
 ud_0                 4.526402e-01 1 1  ON 10
 ud_1                 1.864876e-01 1 1  ON 11
 ud_2                 6.542559e-02 1 1  ON 12
 ud_3                -6.376111e-03 1 1  ON 13
 ud_4                -6.404324e-02 1 1  ON 14
 ud_5                -1.062770e-01 1 1  ON 15
 ud_6                -1.345398e-01 1 1  ON 16
 ud_7                -1.521033e-01 1 1  ON 17
 ud_8                -1.531677e-01 1 1  ON 18
 ud_9                -1.433341e-01 1 1  ON 19
 eO_0                -7.557056e-01 1 1  ON 20
 eO_1                -4.339852e-01 1 1  ON 21
 eO_2                -1.731074e-02 1 1  ON 22
 eO_3                 3.008250e-01 1 1  ON 23
 eO_4                 5.290911e-01 1 1  ON 24
 eO_5                 4.927566e-01 1 1  ON 25
 eO_6                 2.636397e-01 1 1  ON 26
 eO_7                -4.208825e-02 1 1  ON 27
 eO_8                -2.330788e-01 1 1  ON 28
 eO_9                -1.003333e-01 1 1  ON 29
eH1_0                -2.596359e-01 1 1  ON 30
eH1_1                -1.543635e-01 1 1  ON 31
eH1_2                -1.054059e-01 1 1  ON 32
eH1_3                -5.014902e-02 1 1  ON 33
eH1_4                -8.081032e-04 1 1  ON 34
eH1_5                 3.508785e-02 1 1  ON 35
eH1_6                 9.575490e-02 1 1  ON 36
eH1_7                 1.582357e-01 1 1  ON 37
eH1_8                 1.918466e-01 1 1  ON 38
eH1_9                 8.973401e-02 1 1  ON 39
eH2_0                -2.569466e-01 1 1  ON 40
eH2_1                -1.517975e-01 1 1  ON 41
eH2_2                -1.029392e-01 1 1  ON 42
eH2_3                -4.771167e-02 1 1  ON 43
eH2_4                 1.628832e-03 1 1  ON 44
eH2_5                 3.723822e-02 1 1  ON 45
eH2_6                 9.954620e-02 1 1  ON 46
eH2_7                 1.601156e-01 1 1  ON 47
eH2_8                 1.962647e-01 1 1  ON 48
eH2_9                 7.849275e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8668
    reference variance = 0.227289
====================================================
  Execution time = 1.9808e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3996e-01
  Total weights = 2.0000e+06
  Execution time = 1.8964e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340055972129
                                         uncertainty =       0.003273273494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340055972129
                                         uncertainty =       0.003273273494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412298238
  error estimate for blocks of size 2^( 2) =       0.000425316252
  error estimate for blocks of size 2^( 3) =       0.000438072489
  error estimate for blocks of size 2^( 4) =       0.000450061672
  error estimate for blocks of size 2^( 5) =       0.000460261256
  error estimate for blocks of size 2^( 6) =       0.000469592790
  error estimate for blocks of size 2^( 7) =       0.000475827971

      target function =                  N/A
              le_mean =     -16.905766369804
             les_mean =     286.144916053932
             stat err =       0.000463935922
             autocorr =       1.266172990102
              std dev =       0.583077759424
             le_variance =       0.339979673535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339999768064
                                         uncertainty =       0.003273022793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339999768064
                                         uncertainty =       0.003273022793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412264170
  error estimate for blocks of size 2^( 2) =       0.000425282966
  error estimate for blocks of size 2^( 3) =       0.000438040325
  error estimate for blocks of size 2^( 4) =       0.000450031067
  error estimate for blocks of size 2^( 5) =       0.000460232963
  error estimate for blocks of size 2^( 6) =       0.000469564592
  error estimate for blocks of size 2^( 7) =       0.000475802290

      target function =                  N/A
              le_mean =     -16.905766878106
             les_mean =     286.144877057956
             stat err =       0.000463907728
             autocorr =       1.266228346082
              std dev =       0.583029579918
             le_variance =       0.339923491060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340018691898
                                         uncertainty =       0.003273115850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340018691898
                                         uncertainty =       0.003273115850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412275640
  error estimate for blocks of size 2^( 2) =       0.000425294216
  error estimate for blocks of size 2^( 3) =       0.000438051192
  error estimate for blocks of size 2^( 4) =       0.000450041321
  error estimate for blocks of size 2^( 5) =       0.000460242374
  error estimate for blocks of size 2^( 6) =       0.000469573935
  error estimate for blocks of size 2^( 7) =       0.000475810385

      target function =                  N/A
              le_mean =     -16.905766662342
             les_mean =     286.144888677528
             stat err =       0.000463917004
             autocorr =       1.266208524975
              std dev =       0.583045800904
             le_variance =       0.339942405952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340050869931
                                         uncertainty =       0.003273251894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340050869931
                                         uncertainty =       0.003273251894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412295145
  error estimate for blocks of size 2^( 2) =       0.000425313237
  error estimate for blocks of size 2^( 3) =       0.000438069575
  error estimate for blocks of size 2^( 4) =       0.000450058883
  error estimate for blocks of size 2^( 5) =       0.000460258665
  error estimate for blocks of size 2^( 6) =       0.000469590202
  error estimate for blocks of size 2^( 7) =       0.000475825542

      target function =                  N/A
              le_mean =     -16.905766405899
             les_mean =     286.144912173819
             stat err =       0.000463933323
             autocorr =       1.266177798336
              std dev =       0.583073385599
             le_variance =       0.339974572993


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905766369804        initial
     9.7656e-01     9.7656e+00             1.9021e-04       -16.905766878106  <--
     3.9062e+00     3.9062e+01             4.8303e-05       -16.905766662342
     1.5625e+01     1.5625e+02             1.2112e-05       -16.905766405899

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 2.9336e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.120577e-01 1 1  ON 0
 uu_1                 1.445933e-01 1 1  ON 1
 uu_2                 4.261710e-02 1 1  ON 2
 uu_3                -2.047201e-02 1 1  ON 3
 uu_4                -6.664289e-02 1 1  ON 4
 uu_5                -1.024344e-01 1 1  ON 5
 uu_6                -1.309004e-01 1 1  ON 6
 uu_7                -1.458239e-01 1 1  ON 7
 uu_8                -1.386795e-01 1 1  ON 8
 uu_9                -1.106372e-01 1 1  ON 9
 ud_0                 4.526347e-01 1 1  ON 10
 ud_1                 1.865072e-01 1 1  ON 11
 ud_2                 6.543230e-02 1 1  ON 12
 ud_3                -6.355577e-03 1 1  ON 13
 ud_4                -6.399972e-02 1 1  ON 14
 ud_5                -1.063090e-01 1 1  ON 15
 ud_6                -1.344938e-01 1 1  ON 16
 ud_7                -1.519923e-01 1 1  ON 17
 ud_8                -1.532332e-01 1 1  ON 18
 ud_9                -1.433983e-01 1 1  ON 19
 eO_0                -7.557113e-01 1 1  ON 20
 eO_1                -4.339403e-01 1 1  ON 21
 eO_2                -1.730105e-02 1 1  ON 22
 eO_3                 3.008111e-01 1 1  ON 23
 eO_4                 5.291428e-01 1 1  ON 24
 eO_5                 4.927544e-01 1 1  ON 25
 eO_6                 2.637409e-01 1 1  ON 26
 eO_7                -4.204849e-02 1 1  ON 27
 eO_8                -2.331902e-01 1 1  ON 28
 eO_9                -1.004283e-01 1 1  ON 29
eH1_0                -2.597247e-01 1 1  ON 30
eH1_1                -1.544365e-01 1 1  ON 31
eH1_2                -1.053644e-01 1 1  ON 32
eH1_3                -5.018713e-02 1 1  ON 33
eH1_4                -8.200183e-04 1 1  ON 34
eH1_5                 3.508510e-02 1 1  ON 35
eH1_6                 9.576951e-02 1 1  ON 36
eH1_7                 1.582916e-01 1 1  ON 37
eH1_8                 1.918996e-01 1 1  ON 38
eH1_9                 8.979839e-02 1 1  ON 39
eH2_0                -2.569977e-01 1 1  ON 40
eH2_1                -1.517917e-01 1 1  ON 41
eH2_2                -1.029577e-01 1 1  ON 42
eH2_3                -4.777732e-02 1 1  ON 43
eH2_4                 1.608611e-03 1 1  ON 44
eH2_5                 3.712354e-02 1 1  ON 45
eH2_6                 9.950168e-02 1 1  ON 46
eH2_7                 1.601793e-01 1 1  ON 47
eH2_8                 1.963498e-01 1 1  ON 48
eH2_9                 7.863466e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5235e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6885e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8725
    reference variance = 0.326089
====================================================
  Execution time = 2.0260e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3816e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6325e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338198458468
                                         uncertainty =       0.005423759812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338198458468
                                         uncertainty =       0.005423759812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411191670
  error estimate for blocks of size 2^( 2) =       0.000424117247
  error estimate for blocks of size 2^( 3) =       0.000437501695
  error estimate for blocks of size 2^( 4) =       0.000449381934
  error estimate for blocks of size 2^( 5) =       0.000460895505
  error estimate for blocks of size 2^( 6) =       0.000468978032
  error estimate for blocks of size 2^( 7) =       0.000474037337

      target function =                  N/A
              le_mean =     -16.906818071251
             les_mean =     286.178654304727
             stat err =       0.000463323202
             autocorr =       1.269636740405
              std dev =       0.581512836849
             le_variance =       0.338157179420


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690681807125e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906818071251       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906820024761       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906821216721       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906820150855       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906820640505       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906820332333       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906821083887       residual = 8.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906821315275       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906821194537       residual = 8.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 8.674018e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906818071251       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906818889996       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906819416048       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906819150463       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906818933054       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906819147242       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906819147459       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906819157437       residual = 8.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.143086e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906818071251       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906818317598       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906818481981       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906818429146       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906818340348       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906818359557       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906818388551       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906818384274       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 5.442160e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156098 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5899e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.120002e-01 1 1  ON 0
 uu_1                 1.446568e-01 1 1  ON 1
 uu_2                 4.263559e-02 1 1  ON 2
 uu_3                -2.044144e-02 1 1  ON 3
 uu_4                -6.672656e-02 1 1  ON 4
 uu_5                -1.024475e-01 1 1  ON 5
 uu_6                -1.309670e-01 1 1  ON 6
 uu_7                -1.458365e-01 1 1  ON 7
 uu_8                -1.386621e-01 1 1  ON 8
 uu_9                -1.106820e-01 1 1  ON 9
 ud_0                 4.526696e-01 1 1  ON 10
 ud_1                 1.864757e-01 1 1  ON 11
 ud_2                 6.542913e-02 1 1  ON 12
 ud_3                -6.381315e-03 1 1  ON 13
 ud_4                -6.397129e-02 1 1  ON 14
 ud_5                -1.061395e-01 1 1  ON 15
 ud_6                -1.345212e-01 1 1  ON 16
 ud_7                -1.520225e-01 1 1  ON 17
 ud_8                -1.532237e-01 1 1  ON 18
 ud_9                -1.433944e-01 1 1  ON 19
 eO_0                -7.557767e-01 1 1  ON 20
 eO_1                -4.338689e-01 1 1  ON 21
 eO_2                -1.721605e-02 1 1  ON 22
 eO_3                 3.008427e-01 1 1  ON 23
 eO_4                 5.291435e-01 1 1  ON 24
 eO_5                 4.928620e-01 1 1  ON 25
 eO_6                 2.637462e-01 1 1  ON 26
 eO_7                -4.204714e-02 1 1  ON 27
 eO_8                -2.332799e-01 1 1  ON 28
 eO_9                -1.005520e-01 1 1  ON 29
eH1_0                -2.597738e-01 1 1  ON 30
eH1_1                -1.545153e-01 1 1  ON 31
eH1_2                -1.053880e-01 1 1  ON 32
eH1_3                -5.019072e-02 1 1  ON 33
eH1_4                -8.923382e-04 1 1  ON 34
eH1_5                 3.501240e-02 1 1  ON 35
eH1_6                 9.572886e-02 1 1  ON 36
eH1_7                 1.582556e-01 1 1  ON 37
eH1_8                 1.919925e-01 1 1  ON 38
eH1_9                 9.001270e-02 1 1  ON 39
eH2_0                -2.570728e-01 1 1  ON 40
eH2_1                -1.518550e-01 1 1  ON 41
eH2_2                -1.030154e-01 1 1  ON 42
eH2_3                -4.783351e-02 1 1  ON 43
eH2_4                 1.618818e-03 1 1  ON 44
eH2_5                 3.696560e-02 1 1  ON 45
eH2_6                 9.944733e-02 1 1  ON 46
eH2_7                 1.602855e-01 1 1  ON 47
eH2_8                 1.964640e-01 1 1  ON 48
eH2_9                 7.883462e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8686
    reference variance = 0.183254
====================================================
  Execution time = 2.0125e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3300e-01
  Total weights = 2.0000e+06
  Execution time = 1.9119e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332953554484
                                         uncertainty =       0.002699848732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332953554484
                                         uncertainty =       0.002699848732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408026870
  error estimate for blocks of size 2^( 2) =       0.000420246704
  error estimate for blocks of size 2^( 3) =       0.000433104912
  error estimate for blocks of size 2^( 4) =       0.000444836191
  error estimate for blocks of size 2^( 5) =       0.000453665750
  error estimate for blocks of size 2^( 6) =       0.000458468667
  error estimate for blocks of size 2^( 7) =       0.000464215826

      target function =                  N/A
              le_mean =     -16.907047682031
             les_mean =     286.181233009233
             stat err =       0.000455296608
             autocorr =       1.245120268757
              std dev =       0.577037133347
             le_variance =       0.332971853261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333015195425
                                         uncertainty =       0.002699941510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333015195425
                                         uncertainty =       0.002699941510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408064706
  error estimate for blocks of size 2^( 2) =       0.000420279509
  error estimate for blocks of size 2^( 3) =       0.000433134990
  error estimate for blocks of size 2^( 4) =       0.000444860819
  error estimate for blocks of size 2^( 5) =       0.000453690432
  error estimate for blocks of size 2^( 6) =       0.000458491823
  error estimate for blocks of size 2^( 7) =       0.000464239272

      target function =                  N/A
              le_mean =     -16.907049106493
             les_mean =     286.181342930925
             stat err =       0.000455320587
             autocorr =       1.245020511328
              std dev =       0.577090641116
             le_variance =       0.333033608064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333008919690
                                         uncertainty =       0.002699855691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333008919690
                                         uncertainty =       0.002699855691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408060862
  error estimate for blocks of size 2^( 2) =       0.000420276496
  error estimate for blocks of size 2^( 3) =       0.000433132670
  error estimate for blocks of size 2^( 4) =       0.000444859118
  error estimate for blocks of size 2^( 5) =       0.000453688197
  error estimate for blocks of size 2^( 6) =       0.000458490167
  error estimate for blocks of size 2^( 7) =       0.000464237770

      target function =                  N/A
              le_mean =     -16.907048775933
             les_mean =     286.181325479579
             stat err =       0.000455318813
             autocorr =       1.245034266491
              std dev =       0.577085205406
             le_variance =       0.333027334299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332963359944
                                         uncertainty =       0.002699853132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332963359944
                                         uncertainty =       0.002699853132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408032889
  error estimate for blocks of size 2^( 2) =       0.000420252043
  error estimate for blocks of size 2^( 3) =       0.000433109886
  error estimate for blocks of size 2^( 4) =       0.000444840357
  error estimate for blocks of size 2^( 5) =       0.000453669747
  error estimate for blocks of size 2^( 6) =       0.000458472466
  error estimate for blocks of size 2^( 7) =       0.000464219740

      target function =                  N/A
              le_mean =     -16.907047796950
             les_mean =     286.181246718107
             stat err =       0.000455300578
             autocorr =       1.245105245780
              std dev =       0.577045644863
             le_variance =       0.332981676255


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907047682031        initial
     2.4414e-01     2.4414e+00             8.6740e-04       -16.907049106493  <--
     9.7656e-01     9.7656e+00             2.1431e-04       -16.907048775933
     3.9062e+00     3.9062e+01             5.4422e-05       -16.907047796950

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 2.9745e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.119750e-01 1 1  ON 0
 uu_1                 1.447258e-01 1 1  ON 1
 uu_2                 4.264920e-02 1 1  ON 2
 uu_3                -2.042333e-02 1 1  ON 3
 uu_4                -6.687946e-02 1 1  ON 4
 uu_5                -1.025093e-01 1 1  ON 5
 uu_6                -1.311037e-01 1 1  ON 6
 uu_7                -1.458944e-01 1 1  ON 7
 uu_8                -1.386394e-01 1 1  ON 8
 uu_9                -1.108239e-01 1 1  ON 9
 ud_0                 4.527200e-01 1 1  ON 10
 ud_1                 1.864729e-01 1 1  ON 11
 ud_2                 6.543044e-02 1 1  ON 12
 ud_3                -6.372867e-03 1 1  ON 13
 ud_4                -6.387142e-02 1 1  ON 14
 ud_5                -1.058836e-01 1 1  ON 15
 ud_6                -1.344716e-01 1 1  ON 16
 ud_7                -1.520713e-01 1 1  ON 17
 ud_8                -1.532348e-01 1 1  ON 18
 ud_9                -1.433990e-01 1 1  ON 19
 eO_0                -7.558185e-01 1 1  ON 20
 eO_1                -4.337367e-01 1 1  ON 21
 eO_2                -1.705421e-02 1 1  ON 22
 eO_3                 3.009361e-01 1 1  ON 23
 eO_4                 5.291751e-01 1 1  ON 24
 eO_5                 4.931932e-01 1 1  ON 25
 eO_6                 2.637841e-01 1 1  ON 26
 eO_7                -4.205422e-02 1 1  ON 27
 eO_8                -2.335646e-01 1 1  ON 28
 eO_9                -1.009326e-01 1 1  ON 29
eH1_0                -2.599233e-01 1 1  ON 30
eH1_1                -1.547170e-01 1 1  ON 31
eH1_2                -1.054614e-01 1 1  ON 32
eH1_3                -5.024839e-02 1 1  ON 33
eH1_4                -1.082923e-03 1 1  ON 34
eH1_5                 3.477726e-02 1 1  ON 35
eH1_6                 9.559538e-02 1 1  ON 36
eH1_7                 1.581485e-01 1 1  ON 37
eH1_8                 1.922748e-01 1 1  ON 38
eH1_9                 9.066579e-02 1 1  ON 39
eH2_0                -2.572815e-01 1 1  ON 40
eH2_1                -1.520559e-01 1 1  ON 41
eH2_2                -1.031856e-01 1 1  ON 42
eH2_3                -4.800122e-02 1 1  ON 43
eH2_4                 1.563473e-03 1 1  ON 44
eH2_5                 3.656309e-02 1 1  ON 45
eH2_6                 9.928481e-02 1 1  ON 46
eH2_7                 1.605933e-01 1 1  ON 47
eH2_8                 1.968087e-01 1 1  ON 48
eH2_9                 7.944567e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5655e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6883e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9534
    reference variance = 0.230801
====================================================
  Execution time = 2.0495e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4861e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5187e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348670503125
                                         uncertainty =       0.013437595278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348670503125
                                         uncertainty =       0.013437595278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417500510
  error estimate for blocks of size 2^( 2) =       0.000430253898
  error estimate for blocks of size 2^( 3) =       0.000443644257
  error estimate for blocks of size 2^( 4) =       0.000456651016
  error estimate for blocks of size 2^( 5) =       0.000466200729
  error estimate for blocks of size 2^( 6) =       0.000475048316
  error estimate for blocks of size 2^( 7) =       0.000479824229

      target function =                  N/A
              le_mean =     -16.905988495210
             les_mean =     286.161060176894
             stat err =       0.000469431073
             autocorr =       1.264240347082
              std dev =       0.590434882984
             le_variance =       0.348613351045


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690598849521e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905988495210       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905990629589       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905994061557       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905994185655       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905996139641       residual = 8.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905996132724       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905996058495       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905997303793       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905995782325       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905997520793       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905997051072       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905997044460       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905996555450       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 2.794621e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905988495210       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905989575633       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905991082136       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905991493005       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905992865496       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905991808063       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905992706385       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905992138242       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905992207956       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905992272753       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 7.092289e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905988495210       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905988858353       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905989369223       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905989593691       residual = 8.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905990236959       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905989767189       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905989944186       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905989907854       residual = 8.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 1.728370e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160876 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6022e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.123015e-01 1 1  ON 0
 uu_1                 1.448243e-01 1 1  ON 1
 uu_2                 4.267565e-02 1 1  ON 2
 uu_3                -2.041125e-02 1 1  ON 3
 uu_4                -6.674303e-02 1 1  ON 4
 uu_5                -1.024856e-01 1 1  ON 5
 uu_6                -1.310283e-01 1 1  ON 6
 uu_7                -1.462129e-01 1 1  ON 7
 uu_8                -1.390162e-01 1 1  ON 8
 uu_9                -1.111221e-01 1 1  ON 9
 ud_0                 4.529081e-01 1 1  ON 10
 ud_1                 1.868372e-01 1 1  ON 11
 ud_2                 6.574941e-02 1 1  ON 12
 ud_3                -6.082927e-03 1 1  ON 13
 ud_4                -6.366532e-02 1 1  ON 14
 ud_5                -1.059141e-01 1 1  ON 15
 ud_6                -1.344750e-01 1 1  ON 16
 ud_7                -1.521953e-01 1 1  ON 17
 ud_8                -1.533818e-01 1 1  ON 18
 ud_9                -1.437221e-01 1 1  ON 19
 eO_0                -7.553637e-01 1 1  ON 20
 eO_1                -4.335184e-01 1 1  ON 21
 eO_2                -1.681399e-02 1 1  ON 22
 eO_3                 3.009730e-01 1 1  ON 23
 eO_4                 5.293206e-01 1 1  ON 24
 eO_5                 4.931479e-01 1 1  ON 25
 eO_6                 2.638953e-01 1 1  ON 26
 eO_7                -4.215358e-02 1 1  ON 27
 eO_8                -2.339166e-01 1 1  ON 28
 eO_9                -1.015022e-01 1 1  ON 29
eH1_0                -2.603382e-01 1 1  ON 30
eH1_1                -1.548416e-01 1 1  ON 31
eH1_2                -1.057624e-01 1 1  ON 32
eH1_3                -5.030784e-02 1 1  ON 33
eH1_4                -1.012503e-03 1 1  ON 34
eH1_5                 3.445164e-02 1 1  ON 35
eH1_6                 9.544838e-02 1 1  ON 36
eH1_7                 1.585040e-01 1 1  ON 37
eH1_8                 1.926973e-01 1 1  ON 38
eH1_9                 9.122430e-02 1 1  ON 39
eH2_0                -2.576079e-01 1 1  ON 40
eH2_1                -1.524512e-01 1 1  ON 41
eH2_2                -1.034017e-01 1 1  ON 42
eH2_3                -4.832290e-02 1 1  ON 43
eH2_4                 1.398124e-03 1 1  ON 44
eH2_5                 3.673483e-02 1 1  ON 45
eH2_6                 9.936422e-02 1 1  ON 46
eH2_7                 1.606400e-01 1 1  ON 47
eH2_8                 1.970588e-01 1 1  ON 48
eH2_9                 8.015490e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8921
    reference variance = 0.328969
====================================================
  Execution time = 2.0218e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4093e-01
  Total weights = 2.0000e+06
  Execution time = 1.8909e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340977906157
                                         uncertainty =       0.006018221833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340977906157
                                         uncertainty =       0.006018221833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412902162
  error estimate for blocks of size 2^( 2) =       0.000426101871
  error estimate for blocks of size 2^( 3) =       0.000438918869
  error estimate for blocks of size 2^( 4) =       0.000451008627
  error estimate for blocks of size 2^( 5) =       0.000462208052
  error estimate for blocks of size 2^( 6) =       0.000469690857
  error estimate for blocks of size 2^( 7) =       0.000474674457

      target function =                  N/A
              le_mean =     -16.906327510320
             les_mean =     286.164886105920
             stat err =       0.000464395498
             autocorr =       1.264974262303
              std dev =       0.583931836940
             le_variance =       0.340976390193

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340969800178
                                         uncertainty =       0.006019377362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340969800178
                                         uncertainty =       0.006019377362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412897295
  error estimate for blocks of size 2^( 2) =       0.000426093524
  error estimate for blocks of size 2^( 3) =       0.000438903540
  error estimate for blocks of size 2^( 4) =       0.000450977997
  error estimate for blocks of size 2^( 5) =       0.000462174422
  error estimate for blocks of size 2^( 6) =       0.000469661036
  error estimate for blocks of size 2^( 7) =       0.000474650922

      target function =                  N/A
              le_mean =     -16.906329375431
             les_mean =     286.164941132707
             stat err =       0.000464366094
             autocorr =       1.264843894713
              std dev =       0.583924954623
             le_variance =       0.340968352632

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340893607449
                                         uncertainty =       0.006018704300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340893607449
                                         uncertainty =       0.006018704300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412851127
  error estimate for blocks of size 2^( 2) =       0.000426051771
  error estimate for blocks of size 2^( 3) =       0.000438866368
  error estimate for blocks of size 2^( 4) =       0.000450945726
  error estimate for blocks of size 2^( 5) =       0.000462146326
  error estimate for blocks of size 2^( 6) =       0.000469632135
  error estimate for blocks of size 2^( 7) =       0.000474621473

      target function =                  N/A
              le_mean =     -16.906329035379
             les_mean =     286.164853388382
             stat err =       0.000464336415
             autocorr =       1.264965086540
              std dev =       0.583859663201
             le_variance =       0.340892106313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340945497217
                                         uncertainty =       0.006018168417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340945497217
                                         uncertainty =       0.006018168417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412882542
  error estimate for blocks of size 2^( 2) =       0.000426083116
  error estimate for blocks of size 2^( 3) =       0.000438900349
  error estimate for blocks of size 2^( 4) =       0.000450988779
  error estimate for blocks of size 2^( 5) =       0.000462188987
  error estimate for blocks of size 2^( 6) =       0.000469672404
  error estimate for blocks of size 2^( 7) =       0.000474656963

      target function =                  N/A
              le_mean =     -16.906327425537
             les_mean =     286.164850836026
             stat err =       0.000464376783
             autocorr =       1.264992520959
              std dev =       0.583904090603
             le_variance =       0.340943987023


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906327510320        initial
     6.1035e-02     6.1035e-01             2.7946e-03       -16.906329375431  <--
     2.4414e-01     2.4414e+00             7.0923e-04       -16.906329035379
     9.7656e-01     9.7656e+00             1.7284e-04       -16.906327425537

*****************************************************************************
Applying the update for shift_i =   6.1035e-02     and shift_s =   6.1035e-01
*****************************************************************************

  Execution time = 2.9740e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.126493e-01 1 1  ON 0
 uu_1                 1.450516e-01 1 1  ON 1
 uu_2                 4.289895e-02 1 1  ON 2
 uu_3                -2.023884e-02 1 1  ON 3
 uu_4                -6.651749e-02 1 1  ON 4
 uu_5                -1.023498e-01 1 1  ON 5
 uu_6                -1.310670e-01 1 1  ON 6
 uu_7                -1.466763e-01 1 1  ON 7
 uu_8                -1.398079e-01 1 1  ON 8
 uu_9                -1.119833e-01 1 1  ON 9
 ud_0                 4.535562e-01 1 1  ON 10
 ud_1                 1.874754e-01 1 1  ON 11
 ud_2                 6.639820e-02 1 1  ON 12
 ud_3                -5.487618e-03 1 1  ON 13
 ud_4                -6.316628e-02 1 1  ON 14
 ud_5                -1.056694e-01 1 1  ON 15
 ud_6                -1.343179e-01 1 1  ON 16
 ud_7                -1.523404e-01 1 1  ON 17
 ud_8                -1.535993e-01 1 1  ON 18
 ud_9                -1.445774e-01 1 1  ON 19
 eO_0                -7.544760e-01 1 1  ON 20
 eO_1                -4.327875e-01 1 1  ON 21
 eO_2                -1.612588e-02 1 1  ON 22
 eO_3                 3.014834e-01 1 1  ON 23
 eO_4                 5.296895e-01 1 1  ON 24
 eO_5                 4.931102e-01 1 1  ON 25
 eO_6                 2.640858e-01 1 1  ON 26
 eO_7                -4.239750e-02 1 1  ON 27
 eO_8                -2.349108e-01 1 1  ON 28
 eO_9                -1.031839e-01 1 1  ON 29
eH1_0                -2.612044e-01 1 1  ON 30
eH1_1                -1.554357e-01 1 1  ON 31
eH1_2                -1.064644e-01 1 1  ON 32
eH1_3                -5.074908e-02 1 1  ON 33
eH1_4                -1.301468e-03 1 1  ON 34
eH1_5                 3.400568e-02 1 1  ON 35
eH1_6                 9.514561e-02 1 1  ON 36
eH1_7                 1.593795e-01 1 1  ON 37
eH1_8                 1.939004e-01 1 1  ON 38
eH1_9                 9.288529e-02 1 1  ON 39
eH2_0                -2.586184e-01 1 1  ON 40
eH2_1                -1.533549e-01 1 1  ON 41
eH2_2                -1.042073e-01 1 1  ON 42
eH2_3                -4.906056e-02 1 1  ON 43
eH2_4                 8.882252e-04 1 1  ON 44
eH2_5                 3.678274e-02 1 1  ON 45
eH2_6                 9.965637e-02 1 1  ON 46
eH2_7                 1.609133e-01 1 1  ON 47
eH2_8                 1.978336e-01 1 1  ON 48
eH2_9                 8.224029e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5770e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8759
    reference variance = 0.445148
====================================================
  Execution time = 2.0343e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3264e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5579e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332465898338
                                         uncertainty =       0.002463789791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332465898338
                                         uncertainty =       0.002463789791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407825347
  error estimate for blocks of size 2^( 2) =       0.000420518726
  error estimate for blocks of size 2^( 3) =       0.000433502306
  error estimate for blocks of size 2^( 4) =       0.000445898518
  error estimate for blocks of size 2^( 5) =       0.000455834592
  error estimate for blocks of size 2^( 6) =       0.000463712148
  error estimate for blocks of size 2^( 7) =       0.000467503869

      target function =                  N/A
              le_mean =     -16.906611162800
             les_mean =     286.166143871822
             stat err =       0.000458237282
             autocorr =       1.262502975319
              std dev =       0.576752137426
             le_variance =       0.332643028026


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690661116280e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906611162800       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906615646092       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906614292968       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906616347913       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906615020145       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906616648426       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906615552300       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906620168924       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906619076649       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906622403478       residual = 8.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906624263519       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906627607832       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906626838954       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906628531393       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906627050591       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906626915521       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906626978121       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906627953726       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906628037428       residual = 9.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-02 is 1.147113e-02

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906611162800       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906614918231       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906614071085       residual = 9.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906615055484       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906614621043       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906614781481       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906614051931       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906616382406       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906617025197       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906616255713       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906617203262       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906617753174       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906617518954       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 2.821595e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906611162800       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906613439647       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906613344276       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906612603749       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906613527088       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906613356493       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906612856001       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906613595883       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906613784623       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906613640314       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 7.188979e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168608 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5913e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.120254e-01 1 1  ON 0
 uu_1                 1.447963e-01 1 1  ON 1
 uu_2                 4.271000e-02 1 1  ON 2
 uu_3                -2.063182e-02 1 1  ON 3
 uu_4                -6.700508e-02 1 1  ON 4
 uu_5                -1.029807e-01 1 1  ON 5
 uu_6                -1.315589e-01 1 1  ON 6
 uu_7                -1.469953e-01 1 1  ON 7
 uu_8                -1.403081e-01 1 1  ON 8
 uu_9                -1.112008e-01 1 1  ON 9
 ud_0                 4.532704e-01 1 1  ON 10
 ud_1                 1.870861e-01 1 1  ON 11
 ud_2                 6.604837e-02 1 1  ON 12
 ud_3                -5.452852e-03 1 1  ON 13
 ud_4                -6.317696e-02 1 1  ON 14
 ud_5                -1.056321e-01 1 1  ON 15
 ud_6                -1.342790e-01 1 1  ON 16
 ud_7                -1.521893e-01 1 1  ON 17
 ud_8                -1.532897e-01 1 1  ON 18
 ud_9                -1.444690e-01 1 1  ON 19
 eO_0                -7.544597e-01 1 1  ON 20
 eO_1                -4.319882e-01 1 1  ON 21
 eO_2                -1.565445e-02 1 1  ON 22
 eO_3                 3.018416e-01 1 1  ON 23
 eO_4                 5.300486e-01 1 1  ON 24
 eO_5                 4.937732e-01 1 1  ON 25
 eO_6                 2.644025e-01 1 1  ON 26
 eO_7                -4.196244e-02 1 1  ON 27
 eO_8                -2.363630e-01 1 1  ON 28
 eO_9                -1.049184e-01 1 1  ON 29
eH1_0                -2.618820e-01 1 1  ON 30
eH1_1                -1.569708e-01 1 1  ON 31
eH1_2                -1.076007e-01 1 1  ON 32
eH1_3                -5.228764e-02 1 1  ON 33
eH1_4                -2.125500e-03 1 1  ON 34
eH1_5                 3.354535e-02 1 1  ON 35
eH1_6                 9.520557e-02 1 1  ON 36
eH1_7                 1.602750e-01 1 1  ON 37
eH1_8                 1.961043e-01 1 1  ON 38
eH1_9                 9.566970e-02 1 1  ON 39
eH2_0                -2.594390e-01 1 1  ON 40
eH2_1                -1.535159e-01 1 1  ON 41
eH2_2                -1.043139e-01 1 1  ON 42
eH2_3                -4.884647e-02 1 1  ON 43
eH2_4                 1.041632e-03 1 1  ON 44
eH2_5                 3.676205e-02 1 1  ON 45
eH2_6                 9.807810e-02 1 1  ON 46
eH2_7                 1.596384e-01 1 1  ON 47
eH2_8                 1.977876e-01 1 1  ON 48
eH2_9                 8.506189e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9184
    reference variance = 0.228108
====================================================
  Execution time = 2.0035e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3812e-01
  Total weights = 2.0000e+06
  Execution time = 1.8938e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338233500730
                                         uncertainty =       0.006116978428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338233500730
                                         uncertainty =       0.006116978428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411200819
  error estimate for blocks of size 2^( 2) =       0.000423842049
  error estimate for blocks of size 2^( 3) =       0.000437130380
  error estimate for blocks of size 2^( 4) =       0.000449662132
  error estimate for blocks of size 2^( 5) =       0.000459338092
  error estimate for blocks of size 2^( 6) =       0.000465707887
  error estimate for blocks of size 2^( 7) =       0.000471423087

      target function =                  N/A
              le_mean =     -16.905941496045
             les_mean =     286.149029925684
             stat err =       0.000461532800
             autocorr =       1.259787221231
              std dev =       0.581525775077
             le_variance =       0.338172227079

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338181517039
                                         uncertainty =       0.006102426768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338181517039
                                         uncertainty =       0.006102426768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411169091
  error estimate for blocks of size 2^( 2) =       0.000423812564
  error estimate for blocks of size 2^( 3) =       0.000437103972
  error estimate for blocks of size 2^( 4) =       0.000449638904
  error estimate for blocks of size 2^( 5) =       0.000459305930
  error estimate for blocks of size 2^( 6) =       0.000465658088
  error estimate for blocks of size 2^( 7) =       0.000471344284

      target function =                  N/A
              le_mean =     -16.905941434697
             les_mean =     286.148975667267
             stat err =       0.000461486802
             autocorr =       1.259730516000
              std dev =       0.581480905038
             le_variance =       0.338120042923

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338149253814
                                         uncertainty =       0.006091419662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338149253814
                                         uncertainty =       0.006091419662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411149403
  error estimate for blocks of size 2^( 2) =       0.000423794332
  error estimate for blocks of size 2^( 3) =       0.000437090359
  error estimate for blocks of size 2^( 4) =       0.000449633258
  error estimate for blocks of size 2^( 5) =       0.000459305429
  error estimate for blocks of size 2^( 6) =       0.000465665062
  error estimate for blocks of size 2^( 7) =       0.000471351931

      target function =                  N/A
              le_mean =     -16.905944900442
             les_mean =     286.149060471697
             stat err =       0.000461488920
             autocorr =       1.259862727707
              std dev =       0.581453062549
             le_variance =       0.338087663948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338243105822
                                         uncertainty =       0.006109526074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338243105822
                                         uncertainty =       0.006109526074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411206593
  error estimate for blocks of size 2^( 2) =       0.000423846543
  error estimate for blocks of size 2^( 3) =       0.000437135360
  error estimate for blocks of size 2^( 4) =       0.000449668798
  error estimate for blocks of size 2^( 5) =       0.000459343615
  error estimate for blocks of size 2^( 6) =       0.000465710932
  error estimate for blocks of size 2^( 7) =       0.000471418328

      target function =                  N/A
              le_mean =     -16.905940780540
             les_mean =     286.149015229863
             stat err =       0.000461535418
             autocorr =       1.259766138699
              std dev =       0.581533940394
             le_variance =       0.338181723830


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905941496045        initial
     1.5259e-02     1.5259e-01             1.1471e-02       -16.905941434697
     6.1035e-02     6.1035e-01             2.8216e-03       -16.905944900442  <--
     2.4414e-01     2.4414e+00             7.1890e-04       -16.905940780540

*****************************************************************************
Applying the update for shift_i =   6.1035e-02     and shift_s =   6.1035e-01
*****************************************************************************

  Execution time = 2.9582e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.120254e-01 1 1  ON 0
 uu_1                 1.447963e-01 1 1  ON 1
 uu_2                 4.271000e-02 1 1  ON 2
 uu_3                -2.063182e-02 1 1  ON 3
 uu_4                -6.700508e-02 1 1  ON 4
 uu_5                -1.029807e-01 1 1  ON 5
 uu_6                -1.315589e-01 1 1  ON 6
 uu_7                -1.469953e-01 1 1  ON 7
 uu_8                -1.403081e-01 1 1  ON 8
 uu_9                -1.112008e-01 1 1  ON 9
 ud_0                 4.532704e-01 1 1  ON 10
 ud_1                 1.870861e-01 1 1  ON 11
 ud_2                 6.604837e-02 1 1  ON 12
 ud_3                -5.452852e-03 1 1  ON 13
 ud_4                -6.317696e-02 1 1  ON 14
 ud_5                -1.056321e-01 1 1  ON 15
 ud_6                -1.342790e-01 1 1  ON 16
 ud_7                -1.521893e-01 1 1  ON 17
 ud_8                -1.532897e-01 1 1  ON 18
 ud_9                -1.444690e-01 1 1  ON 19
 eO_0                -7.544597e-01 1 1  ON 20
 eO_1                -4.319882e-01 1 1  ON 21
 eO_2                -1.565445e-02 1 1  ON 22
 eO_3                 3.018416e-01 1 1  ON 23
 eO_4                 5.300486e-01 1 1  ON 24
 eO_5                 4.937732e-01 1 1  ON 25
 eO_6                 2.644025e-01 1 1  ON 26
 eO_7                -4.196244e-02 1 1  ON 27
 eO_8                -2.363630e-01 1 1  ON 28
 eO_9                -1.049184e-01 1 1  ON 29
eH1_0                -2.618820e-01 1 1  ON 30
eH1_1                -1.569708e-01 1 1  ON 31
eH1_2                -1.076007e-01 1 1  ON 32
eH1_3                -5.228764e-02 1 1  ON 33
eH1_4                -2.125500e-03 1 1  ON 34
eH1_5                 3.354535e-02 1 1  ON 35
eH1_6                 9.520557e-02 1 1  ON 36
eH1_7                 1.602750e-01 1 1  ON 37
eH1_8                 1.961043e-01 1 1  ON 38
eH1_9                 9.566970e-02 1 1  ON 39
eH2_0                -2.594390e-01 1 1  ON 40
eH2_1                -1.535159e-01 1 1  ON 41
eH2_2                -1.043139e-01 1 1  ON 42
eH2_3                -4.884647e-02 1 1  ON 43
eH2_4                 1.041632e-03 1 1  ON 44
eH2_5                 3.676205e-02 1 1  ON 45
eH2_6                 9.807810e-02 1 1  ON 46
eH2_7                 1.596384e-01 1 1  ON 47
eH2_8                 1.977876e-01 1 1  ON 48
eH2_9                 8.506189e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5502e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6888e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8457
    reference variance = 0.205952
====================================================
  Execution time = 2.0855e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3514e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6191e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335185632738
                                         uncertainty =       0.002638297828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335185632738
                                         uncertainty =       0.002638297828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409350255
  error estimate for blocks of size 2^( 2) =       0.000421735517
  error estimate for blocks of size 2^( 3) =       0.000434932874
  error estimate for blocks of size 2^( 4) =       0.000447050105
  error estimate for blocks of size 2^( 5) =       0.000456786947
  error estimate for blocks of size 2^( 6) =       0.000464638248
  error estimate for blocks of size 2^( 7) =       0.000467159820

      target function =                  N/A
              le_mean =     -16.906506397855
             les_mean =     286.165093675229
             stat err =       0.000458908780
             autocorr =       1.256789674158
              std dev =       0.578908681983
             le_variance =       0.335135262076


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690650639786e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906506397855       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906509815241       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906510874012       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906513149513       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906513713017       residual = 8.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906515758858       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906520348891       residual = 9.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906521803106       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906520842536       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906519819571       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906517931745       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906518715033       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906519724253       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906521123756       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906521588072       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906521407650       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906521890069       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906521990870       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-02 is 1.162651e-02

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906506397855       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906509175739       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906510259677       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906512248941       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906512216753       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906513022761       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906515544340       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906515337097       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906515055715       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906514513546       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906513815351       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906513957225       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906514189192       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 3.010648e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906506397855       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906507986554       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906509074086       residual = 9.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906510135089       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906509708777       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906509869600       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906510630826       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906510369474       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906510428961       residual = 8.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 7.270217e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175286 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6485e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.121782e-01 1 1  ON 0
 uu_1                 1.446429e-01 1 1  ON 1
 uu_2                 4.269327e-02 1 1  ON 2
 uu_3                -2.063905e-02 1 1  ON 3
 uu_4                -6.731575e-02 1 1  ON 4
 uu_5                -1.031554e-01 1 1  ON 5
 uu_6                -1.318289e-01 1 1  ON 6
 uu_7                -1.469741e-01 1 1  ON 7
 uu_8                -1.401348e-01 1 1  ON 8
 uu_9                -1.117707e-01 1 1  ON 9
 ud_0                 4.539437e-01 1 1  ON 10
 ud_1                 1.877014e-01 1 1  ON 11
 ud_2                 6.661565e-02 1 1  ON 12
 ud_3                -5.054022e-03 1 1  ON 13
 ud_4                -6.297976e-02 1 1  ON 14
 ud_5                -1.054071e-01 1 1  ON 15
 ud_6                -1.340482e-01 1 1  ON 16
 ud_7                -1.521768e-01 1 1  ON 17
 ud_8                -1.534793e-01 1 1  ON 18
 ud_9                -1.447903e-01 1 1  ON 19
 eO_0                -7.528448e-01 1 1  ON 20
 eO_1                -4.307252e-01 1 1  ON 21
 eO_2                -1.504342e-02 1 1  ON 22
 eO_3                 3.024506e-01 1 1  ON 23
 eO_4                 5.299312e-01 1 1  ON 24
 eO_5                 4.936071e-01 1 1  ON 25
 eO_6                 2.639288e-01 1 1  ON 26
 eO_7                -4.183678e-02 1 1  ON 27
 eO_8                -2.370341e-01 1 1  ON 28
 eO_9                -1.071507e-01 1 1  ON 29
eH1_0                -2.634734e-01 1 1  ON 30
eH1_1                -1.579484e-01 1 1  ON 31
eH1_2                -1.089532e-01 1 1  ON 32
eH1_3                -5.318125e-02 1 1  ON 33
eH1_4                -2.442488e-03 1 1  ON 34
eH1_5                 3.448266e-02 1 1  ON 35
eH1_6                 9.572930e-02 1 1  ON 36
eH1_7                 1.595454e-01 1 1  ON 37
eH1_8                 1.970842e-01 1 1  ON 38
eH1_9                 9.843636e-02 1 1  ON 39
eH2_0                -2.597574e-01 1 1  ON 40
eH2_1                -1.545105e-01 1 1  ON 41
eH2_2                -1.050354e-01 1 1  ON 42
eH2_3                -4.959765e-02 1 1  ON 43
eH2_4                 5.358441e-04 1 1  ON 44
eH2_5                 3.659354e-02 1 1  ON 45
eH2_6                 9.830819e-02 1 1  ON 46
eH2_7                 1.588201e-01 1 1  ON 47
eH2_8                 1.987900e-01 1 1  ON 48
eH2_9                 8.807254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9121
    reference variance = 0.337282
====================================================
  Execution time = 1.9949e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3391e-01
  Total weights = 2.0000e+06
  Execution time = 1.8970e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333812264570
                                         uncertainty =       0.002688552143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333812264570
                                         uncertainty =       0.002688552143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408522363
  error estimate for blocks of size 2^( 2) =       0.000420906560
  error estimate for blocks of size 2^( 3) =       0.000433518421
  error estimate for blocks of size 2^( 4) =       0.000446186702
  error estimate for blocks of size 2^( 5) =       0.000457051838
  error estimate for blocks of size 2^( 6) =       0.000464809681
  error estimate for blocks of size 2^( 7) =       0.000469353100

      target function =                  N/A
              le_mean =     -16.906444805306
             les_mean =     286.161656830441
             stat err =       0.000459350330
             autocorr =       1.264318214555
              std dev =       0.577737866565
             le_variance =       0.333781042463

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333905002734
                                         uncertainty =       0.002688142156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333905002734
                                         uncertainty =       0.002688142156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408579144
  error estimate for blocks of size 2^( 2) =       0.000420950290
  error estimate for blocks of size 2^( 3) =       0.000433545289
  error estimate for blocks of size 2^( 4) =       0.000446210976
  error estimate for blocks of size 2^( 5) =       0.000457080587
  error estimate for blocks of size 2^( 6) =       0.000464851967
  error estimate for blocks of size 2^( 7) =       0.000469386360

      target function =                  N/A
              le_mean =     -16.906446895566
             les_mean =     286.161820299633
             stat err =       0.000459382472
             autocorr =       1.264143723515
              std dev =       0.577818166878
             le_variance =       0.333873833974

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334075497646
                                         uncertainty =       0.002688575381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334075497646
                                         uncertainty =       0.002688575381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408683364
  error estimate for blocks of size 2^( 2) =       0.000421053021
  error estimate for blocks of size 2^( 3) =       0.000433643899
  error estimate for blocks of size 2^( 4) =       0.000446311281
  error estimate for blocks of size 2^( 5) =       0.000457181296
  error estimate for blocks of size 2^( 6) =       0.000464967755
  error estimate for blocks of size 2^( 7) =       0.000469504162

      target function =                  N/A
              le_mean =     -16.906449725701
             les_mean =     286.162086344533
             stat err =       0.000459491123
             autocorr =       1.264096802717
              std dev =       0.577965555993
             le_variance =       0.334044183914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333899823772
                                         uncertainty =       0.002688915208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333899823772
                                         uncertainty =       0.002688915208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408575917
  error estimate for blocks of size 2^( 2) =       0.000420955698
  error estimate for blocks of size 2^( 3) =       0.000433561083
  error estimate for blocks of size 2^( 4) =       0.000446229146
  error estimate for blocks of size 2^( 5) =       0.000457094217
  error estimate for blocks of size 2^( 6) =       0.000464860829
  error estimate for blocks of size 2^( 7) =       0.000469403033

      target function =                  N/A
              le_mean =     -16.906444874920
             les_mean =     286.161746701491
             stat err =       0.000459396806
             autocorr =       1.264242585473
              std dev =       0.577813602930
             le_variance =       0.333868559731


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906444805306        initial
     1.5259e-02     1.5259e-01             1.1627e-02       -16.906446895566
     6.1035e-02     6.1035e-01             3.0106e-03       -16.906449725701  <--
     2.4414e-01     2.4414e+00             7.2702e-04       -16.906444874920

*****************************************************************************
Applying the update for shift_i =   6.1035e-02     and shift_s =   6.1035e-01
*****************************************************************************

  Execution time = 2.9496e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.121782e-01 1 1  ON 0
 uu_1                 1.446429e-01 1 1  ON 1
 uu_2                 4.269327e-02 1 1  ON 2
 uu_3                -2.063905e-02 1 1  ON 3
 uu_4                -6.731575e-02 1 1  ON 4
 uu_5                -1.031554e-01 1 1  ON 5
 uu_6                -1.318289e-01 1 1  ON 6
 uu_7                -1.469741e-01 1 1  ON 7
 uu_8                -1.401348e-01 1 1  ON 8
 uu_9                -1.117707e-01 1 1  ON 9
 ud_0                 4.539437e-01 1 1  ON 10
 ud_1                 1.877014e-01 1 1  ON 11
 ud_2                 6.661565e-02 1 1  ON 12
 ud_3                -5.054022e-03 1 1  ON 13
 ud_4                -6.297976e-02 1 1  ON 14
 ud_5                -1.054071e-01 1 1  ON 15
 ud_6                -1.340482e-01 1 1  ON 16
 ud_7                -1.521768e-01 1 1  ON 17
 ud_8                -1.534793e-01 1 1  ON 18
 ud_9                -1.447903e-01 1 1  ON 19
 eO_0                -7.528448e-01 1 1  ON 20
 eO_1                -4.307252e-01 1 1  ON 21
 eO_2                -1.504342e-02 1 1  ON 22
 eO_3                 3.024506e-01 1 1  ON 23
 eO_4                 5.299312e-01 1 1  ON 24
 eO_5                 4.936071e-01 1 1  ON 25
 eO_6                 2.639288e-01 1 1  ON 26
 eO_7                -4.183678e-02 1 1  ON 27
 eO_8                -2.370341e-01 1 1  ON 28
 eO_9                -1.071507e-01 1 1  ON 29
eH1_0                -2.634734e-01 1 1  ON 30
eH1_1                -1.579484e-01 1 1  ON 31
eH1_2                -1.089532e-01 1 1  ON 32
eH1_3                -5.318125e-02 1 1  ON 33
eH1_4                -2.442488e-03 1 1  ON 34
eH1_5                 3.448266e-02 1 1  ON 35
eH1_6                 9.572930e-02 1 1  ON 36
eH1_7                 1.595454e-01 1 1  ON 37
eH1_8                 1.970842e-01 1 1  ON 38
eH1_9                 9.843636e-02 1 1  ON 39
eH2_0                -2.597574e-01 1 1  ON 40
eH2_1                -1.545105e-01 1 1  ON 41
eH2_2                -1.050354e-01 1 1  ON 42
eH2_3                -4.959765e-02 1 1  ON 43
eH2_4                 5.358441e-04 1 1  ON 44
eH2_5                 3.659354e-02 1 1  ON 45
eH2_6                 9.830819e-02 1 1  ON 46
eH2_7                 1.588201e-01 1 1  ON 47
eH2_8                 1.987900e-01 1 1  ON 48
eH2_9                 8.807254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5989e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8946
    reference variance = 0.240123
====================================================
  Execution time = 2.2418e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3833e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5002e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338422564472
                                         uncertainty =       0.003655739251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338422564472
                                         uncertainty =       0.003655739251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411297965
  error estimate for blocks of size 2^( 2) =       0.000424160116
  error estimate for blocks of size 2^( 3) =       0.000437348568
  error estimate for blocks of size 2^( 4) =       0.000448751247
  error estimate for blocks of size 2^( 5) =       0.000458544978
  error estimate for blocks of size 2^( 6) =       0.000465269134
  error estimate for blocks of size 2^( 7) =       0.000467877900

      target function =                  N/A
              le_mean =     -16.906237978134
             les_mean =     286.159214436342
             stat err =       0.000460110815
             autocorr =       1.251444980796
              std dev =       0.581663160445
             le_variance =       0.338332032219


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690623797813e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906237978134       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906239535764       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906239383805       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906236982285       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906234479814       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906240412089       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906239827220       residual = 8.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906240557410       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906242648987       residual = 9.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906241959689       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906244906324       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906244835279       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906245515054       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906247140989       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906247191289       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906247662371       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906247807185       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906247467341       residual = 8.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-02 is 1.046224e-02

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906237978134       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906239246486       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906239094265       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906237016107       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906234831158       residual = 9.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906238990950       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906238340861       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906238902043       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906239744440       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906239621922       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906239840908       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906239690014       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906239763197       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 2.649578e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906237978134       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906238705873       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906238605572       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906237504177       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906235984966       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906237508063       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906237426584       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906237484050       residual = 7.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906237932044       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906237930219       residual = 7.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 6.587186e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182145 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7929e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.118599e-01 1 1  ON 0
 uu_1                 1.443948e-01 1 1  ON 1
 uu_2                 4.253423e-02 1 1  ON 2
 uu_3                -2.029142e-02 1 1  ON 3
 uu_4                -6.663020e-02 1 1  ON 4
 uu_5                -1.029589e-01 1 1  ON 5
 uu_6                -1.314296e-01 1 1  ON 6
 uu_7                -1.463619e-01 1 1  ON 7
 uu_8                -1.406712e-01 1 1  ON 8
 uu_9                -1.126965e-01 1 1  ON 9
 ud_0                 4.543918e-01 1 1  ON 10
 ud_1                 1.884425e-01 1 1  ON 11
 ud_2                 6.733596e-02 1 1  ON 12
 ud_3                -4.346225e-03 1 1  ON 13
 ud_4                -6.235285e-02 1 1  ON 14
 ud_5                -1.045711e-01 1 1  ON 15
 ud_6                -1.331950e-01 1 1  ON 16
 ud_7                -1.520731e-01 1 1  ON 17
 ud_8                -1.539934e-01 1 1  ON 18
 ud_9                -1.465712e-01 1 1  ON 19
 eO_0                -7.517643e-01 1 1  ON 20
 eO_1                -4.302297e-01 1 1  ON 21
 eO_2                -1.437915e-02 1 1  ON 22
 eO_3                 3.031469e-01 1 1  ON 23
 eO_4                 5.301015e-01 1 1  ON 24
 eO_5                 4.939149e-01 1 1  ON 25
 eO_6                 2.654559e-01 1 1  ON 26
 eO_7                -4.115583e-02 1 1  ON 27
 eO_8                -2.393278e-01 1 1  ON 28
 eO_9                -1.098003e-01 1 1  ON 29
eH1_0                -2.638411e-01 1 1  ON 30
eH1_1                -1.587785e-01 1 1  ON 31
eH1_2                -1.093484e-01 1 1  ON 32
eH1_3                -5.393289e-02 1 1  ON 33
eH1_4                -3.797943e-03 1 1  ON 34
eH1_5                 3.390123e-02 1 1  ON 35
eH1_6                 9.597416e-02 1 1  ON 36
eH1_7                 1.599143e-01 1 1  ON 37
eH1_8                 1.986293e-01 1 1  ON 38
eH1_9                 1.006390e-01 1 1  ON 39
eH2_0                -2.601320e-01 1 1  ON 40
eH2_1                -1.546501e-01 1 1  ON 41
eH2_2                -1.056292e-01 1 1  ON 42
eH2_3                -5.039804e-02 1 1  ON 43
eH2_4                -5.477682e-04 1 1  ON 44
eH2_5                 3.579220e-02 1 1  ON 45
eH2_6                 9.805610e-02 1 1  ON 46
eH2_7                 1.594909e-01 1 1  ON 47
eH2_8                 1.996434e-01 1 1  ON 48
eH2_9                 9.069078e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8793
    reference variance = 0.337758
====================================================
  Execution time = 2.0013e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4375e-01
  Total weights = 2.0000e+06
  Execution time = 1.8973e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344195933775
                                         uncertainty =       0.007021403974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344195933775
                                         uncertainty =       0.007021403974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414851208
  error estimate for blocks of size 2^( 2) =       0.000427233686
  error estimate for blocks of size 2^( 3) =       0.000439635756
  error estimate for blocks of size 2^( 4) =       0.000451767205
  error estimate for blocks of size 2^( 5) =       0.000460860476
  error estimate for blocks of size 2^( 6) =       0.000468056827
  error estimate for blocks of size 2^( 7) =       0.000473681468

      target function =                  N/A
              le_mean =     -16.905638557966
             les_mean =     286.144817929440
             stat err =       0.000463591494
             autocorr =       1.248780765051
              std dev =       0.586688204208
             le_variance =       0.344203048957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343695532875
                                         uncertainty =       0.007019664398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343695532875
                                         uncertainty =       0.007019664398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414549710
  error estimate for blocks of size 2^( 2) =       0.000426941965
  error estimate for blocks of size 2^( 3) =       0.000439353303
  error estimate for blocks of size 2^( 4) =       0.000451485869
  error estimate for blocks of size 2^( 5) =       0.000460596579
  error estimate for blocks of size 2^( 6) =       0.000467791220
  error estimate for blocks of size 2^( 7) =       0.000473407436

      target function =                  N/A
              le_mean =     -16.905639052256
             les_mean =     286.144334518239
             stat err =       0.000463320276
             autocorr =       1.249135007649
              std dev =       0.586261822841
             le_variance =       0.343702924921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343312019545
                                         uncertainty =       0.007017358109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343312019545
                                         uncertainty =       0.007017358109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414318447
  error estimate for blocks of size 2^( 2) =       0.000426726806
  error estimate for blocks of size 2^( 3) =       0.000439157563
  error estimate for blocks of size 2^( 4) =       0.000451302481
  error estimate for blocks of size 2^( 5) =       0.000460427126
  error estimate for blocks of size 2^( 6) =       0.000467630848
  error estimate for blocks of size 2^( 7) =       0.000473252623

      target function =                  N/A
              le_mean =     -16.905642112800
             les_mean =     286.144054624984
             stat err =       0.000463153269
             autocorr =       1.249628520414
              std dev =       0.585934766465
             le_variance =       0.343319550553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343943875175
                                         uncertainty =       0.007019957000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343943875175
                                         uncertainty =       0.007019957000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414699355
  error estimate for blocks of size 2^( 2) =       0.000427089772
  error estimate for blocks of size 2^( 3) =       0.000439500584
  error estimate for blocks of size 2^( 4) =       0.000451635158
  error estimate for blocks of size 2^( 5) =       0.000460735360
  error estimate for blocks of size 2^( 6) =       0.000467933786
  error estimate for blocks of size 2^( 7) =       0.000473559092

      target function =                  N/A
              le_mean =     -16.905637800466
             les_mean =     286.144540378801
             stat err =       0.000463465849
             autocorr =       1.249018170528
              std dev =       0.586473452276
             le_variance =       0.343951110225


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905638557966        initial
     1.5259e-02     1.5259e-01             1.0462e-02       -16.905639052256
     6.1035e-02     6.1035e-01             2.6496e-03       -16.905642112800  <--
     2.4414e-01     2.4414e+00             6.5872e-04       -16.905637800466

*****************************************************************************
Applying the update for shift_i =   6.1035e-02     and shift_s =   6.1035e-01
*****************************************************************************

  Execution time = 2.9555e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.118599e-01 1 1  ON 0
 uu_1                 1.443948e-01 1 1  ON 1
 uu_2                 4.253423e-02 1 1  ON 2
 uu_3                -2.029142e-02 1 1  ON 3
 uu_4                -6.663020e-02 1 1  ON 4
 uu_5                -1.029589e-01 1 1  ON 5
 uu_6                -1.314296e-01 1 1  ON 6
 uu_7                -1.463619e-01 1 1  ON 7
 uu_8                -1.406712e-01 1 1  ON 8
 uu_9                -1.126965e-01 1 1  ON 9
 ud_0                 4.543918e-01 1 1  ON 10
 ud_1                 1.884425e-01 1 1  ON 11
 ud_2                 6.733596e-02 1 1  ON 12
 ud_3                -4.346225e-03 1 1  ON 13
 ud_4                -6.235285e-02 1 1  ON 14
 ud_5                -1.045711e-01 1 1  ON 15
 ud_6                -1.331950e-01 1 1  ON 16
 ud_7                -1.520731e-01 1 1  ON 17
 ud_8                -1.539934e-01 1 1  ON 18
 ud_9                -1.465712e-01 1 1  ON 19
 eO_0                -7.517643e-01 1 1  ON 20
 eO_1                -4.302297e-01 1 1  ON 21
 eO_2                -1.437915e-02 1 1  ON 22
 eO_3                 3.031469e-01 1 1  ON 23
 eO_4                 5.301015e-01 1 1  ON 24
 eO_5                 4.939149e-01 1 1  ON 25
 eO_6                 2.654559e-01 1 1  ON 26
 eO_7                -4.115583e-02 1 1  ON 27
 eO_8                -2.393278e-01 1 1  ON 28
 eO_9                -1.098003e-01 1 1  ON 29
eH1_0                -2.638411e-01 1 1  ON 30
eH1_1                -1.587785e-01 1 1  ON 31
eH1_2                -1.093484e-01 1 1  ON 32
eH1_3                -5.393289e-02 1 1  ON 33
eH1_4                -3.797943e-03 1 1  ON 34
eH1_5                 3.390123e-02 1 1  ON 35
eH1_6                 9.597416e-02 1 1  ON 36
eH1_7                 1.599143e-01 1 1  ON 37
eH1_8                 1.986293e-01 1 1  ON 38
eH1_9                 1.006390e-01 1 1  ON 39
eH2_0                -2.601320e-01 1 1  ON 40
eH2_1                -1.546501e-01 1 1  ON 41
eH2_2                -1.056292e-01 1 1  ON 42
eH2_3                -5.039804e-02 1 1  ON 43
eH2_4                -5.477682e-04 1 1  ON 44
eH2_5                 3.579220e-02 1 1  ON 45
eH2_6                 9.805610e-02 1 1  ON 46
eH2_7                 1.594909e-01 1 1  ON 47
eH2_8                 1.996434e-01 1 1  ON 48
eH2_9                 9.069078e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7497e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9357
    reference variance = 0.355269
====================================================
  Execution time = 2.0637e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4710e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5116e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347131279666
                                         uncertainty =       0.010085253479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347131279666
                                         uncertainty =       0.010085253479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416595167
  error estimate for blocks of size 2^( 2) =       0.000429346277
  error estimate for blocks of size 2^( 3) =       0.000442332806
  error estimate for blocks of size 2^( 4) =       0.000454110858
  error estimate for blocks of size 2^( 5) =       0.000464417068
  error estimate for blocks of size 2^( 6) =       0.000472229927
  error estimate for blocks of size 2^( 7) =       0.000474646372

      target function =                  N/A
              le_mean =     -16.906160079208
             les_mean =     286.165351515875
             stat err =       0.000466351056
             autocorr =       1.253133890064
              std dev =       0.589154534593
             le_variance =       0.347103065631


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690616007921e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906160079208       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906160072371       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906161078436       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906160074266       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906163894741       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906162365735       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906162833757       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906164824909       residual = 8.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906164920389       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906164449389       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906166107840       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906170196729       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906171398667       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906169830293       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906169461927       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906170854855       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906170776612       residual = 9.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-02 is 1.161981e-02

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906160079208       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906160073315       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906160957166       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906160941374       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906161231855       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906164016344       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906162140162       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906163084837       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906162496087       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906162407959       residual = 9.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906162439694       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906163393449       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906163727678       residual = 5.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 2.960060e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906160079208       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906160075412       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906160670692       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906161512901       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906160635523       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906161900398       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906161612969       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906161346226       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906161325203       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 7.138309e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188426 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6159e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.122239e-01 1 1  ON 0
 uu_1                 1.449313e-01 1 1  ON 1
 uu_2                 4.279706e-02 1 1  ON 2
 uu_3                -2.030627e-02 1 1  ON 3
 uu_4                -6.666616e-02 1 1  ON 4
 uu_5                -1.029092e-01 1 1  ON 5
 uu_6                -1.315580e-01 1 1  ON 6
 uu_7                -1.465742e-01 1 1  ON 7
 uu_8                -1.404863e-01 1 1  ON 8
 uu_9                -1.137687e-01 1 1  ON 9
 ud_0                 4.548302e-01 1 1  ON 10
 ud_1                 1.885176e-01 1 1  ON 11
 ud_2                 6.741078e-02 1 1  ON 12
 ud_3                -4.304952e-03 1 1  ON 13
 ud_4                -6.180984e-02 1 1  ON 14
 ud_5                -1.038049e-01 1 1  ON 15
 ud_6                -1.330763e-01 1 1  ON 16
 ud_7                -1.515009e-01 1 1  ON 17
 ud_8                -1.534780e-01 1 1  ON 18
 ud_9                -1.470439e-01 1 1  ON 19
 eO_0                -7.519852e-01 1 1  ON 20
 eO_1                -4.297862e-01 1 1  ON 21
 eO_2                -1.345000e-02 1 1  ON 22
 eO_3                 3.039122e-01 1 1  ON 23
 eO_4                 5.310796e-01 1 1  ON 24
 eO_5                 4.948841e-01 1 1  ON 25
 eO_6                 2.656456e-01 1 1  ON 26
 eO_7                -4.123599e-02 1 1  ON 27
 eO_8                -2.404978e-01 1 1  ON 28
 eO_9                -1.119943e-01 1 1  ON 29
eH1_0                -2.646245e-01 1 1  ON 30
eH1_1                -1.595357e-01 1 1  ON 31
eH1_2                -1.100943e-01 1 1  ON 32
eH1_3                -5.453534e-02 1 1  ON 33
eH1_4                -4.620439e-03 1 1  ON 34
eH1_5                 3.264551e-02 1 1  ON 35
eH1_6                 9.559887e-02 1 1  ON 36
eH1_7                 1.603215e-01 1 1  ON 37
eH1_8                 2.002960e-01 1 1  ON 38
eH1_9                 1.035991e-01 1 1  ON 39
eH2_0                -2.600591e-01 1 1  ON 40
eH2_1                -1.544729e-01 1 1  ON 41
eH2_2                -1.054642e-01 1 1  ON 42
eH2_3                -5.024573e-02 1 1  ON 43
eH2_4                -8.270745e-04 1 1  ON 44
eH2_5                 3.488940e-02 1 1  ON 45
eH2_6                 9.638766e-02 1 1  ON 46
eH2_7                 1.585399e-01 1 1  ON 47
eH2_8                 2.004765e-01 1 1  ON 48
eH2_9                 9.296388e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8304
    reference variance = 0.187353
====================================================
  Execution time = 2.0228e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3237e-01
  Total weights = 2.0000e+06
  Execution time = 1.8960e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331969750232
                                         uncertainty =       0.002587196766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331969750232
                                         uncertainty =       0.002587196766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407396156
  error estimate for blocks of size 2^( 2) =       0.000420226941
  error estimate for blocks of size 2^( 3) =       0.000432908875
  error estimate for blocks of size 2^( 4) =       0.000444891419
  error estimate for blocks of size 2^( 5) =       0.000454988803
  error estimate for blocks of size 2^( 6) =       0.000462408006
  error estimate for blocks of size 2^( 7) =       0.000467623580

      target function =                  N/A
              le_mean =     -16.906891577652
             les_mean =     286.174925907865
             stat err =       0.000457477952
             autocorr =       1.260975019282
              std dev =       0.576145168636
             le_variance =       0.331943255342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332454604883
                                         uncertainty =       0.002590608081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332454604883
                                         uncertainty =       0.002590608081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407693514
  error estimate for blocks of size 2^( 2) =       0.000420498265
  error estimate for blocks of size 2^( 3) =       0.000433149233
  error estimate for blocks of size 2^( 4) =       0.000445111144
  error estimate for blocks of size 2^( 5) =       0.000455184826
  error estimate for blocks of size 2^( 6) =       0.000462603597
  error estimate for blocks of size 2^( 7) =       0.000467820378

      target function =                  N/A
              le_mean =     -16.906886971381
             les_mean =     286.175254900140
             stat err =       0.000457679986
             autocorr =       1.260248641397
              std dev =       0.576565697296
             le_variance =       0.332428003299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332835043252
                                         uncertainty =       0.002592284168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332835043252
                                         uncertainty =       0.002592284168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407926619
  error estimate for blocks of size 2^( 2) =       0.000420719234
  error estimate for blocks of size 2^( 3) =       0.000433355286
  error estimate for blocks of size 2^( 4) =       0.000445313202
  error estimate for blocks of size 2^( 5) =       0.000455383632
  error estimate for blocks of size 2^( 6) =       0.000462810572
  error estimate for blocks of size 2^( 7) =       0.000468021634

      target function =                  N/A
              le_mean =     -16.906887505348
             les_mean =     286.175653205365
             stat err =       0.000457882260
             autocorr =       1.259921662884
              std dev =       0.576895357287
             le_variance =       0.332808253260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332235004739
                                         uncertainty =       0.002588538789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332235004739
                                         uncertainty =       0.002588538789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407558826
  error estimate for blocks of size 2^( 2) =       0.000420378004
  error estimate for blocks of size 2^( 3) =       0.000433046030
  error estimate for blocks of size 2^( 4) =       0.000445021807
  error estimate for blocks of size 2^( 5) =       0.000455111760
  error estimate for blocks of size 2^( 6) =       0.000462534616
  error estimate for blocks of size 2^( 7) =       0.000467746424

      target function =                  N/A
              le_mean =     -16.906889310145
             les_mean =     286.175114372728
             stat err =       0.000457603652
             autocorr =       1.260661118656
              std dev =       0.576375219239
             le_variance =       0.332208393353


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906891577652        initial  <--
     1.5259e-02     1.5259e-01             1.1620e-02       -16.906886971381
     6.1035e-02     6.1035e-01             2.9601e-03       -16.906887505348
     2.4414e-01     2.4414e+00             7.1383e-04       -16.906889310145

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7774
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.118599e-01 1 1  ON 0
 uu_1                 1.443948e-01 1 1  ON 1
 uu_2                 4.253423e-02 1 1  ON 2
 uu_3                -2.029142e-02 1 1  ON 3
 uu_4                -6.663020e-02 1 1  ON 4
 uu_5                -1.029589e-01 1 1  ON 5
 uu_6                -1.314296e-01 1 1  ON 6
 uu_7                -1.463619e-01 1 1  ON 7
 uu_8                -1.406712e-01 1 1  ON 8
 uu_9                -1.126965e-01 1 1  ON 9
 ud_0                 4.543918e-01 1 1  ON 10
 ud_1                 1.884425e-01 1 1  ON 11
 ud_2                 6.733596e-02 1 1  ON 12
 ud_3                -4.346225e-03 1 1  ON 13
 ud_4                -6.235285e-02 1 1  ON 14
 ud_5                -1.045711e-01 1 1  ON 15
 ud_6                -1.331950e-01 1 1  ON 16
 ud_7                -1.520731e-01 1 1  ON 17
 ud_8                -1.539934e-01 1 1  ON 18
 ud_9                -1.465712e-01 1 1  ON 19
 eO_0                -7.517643e-01 1 1  ON 20
 eO_1                -4.302297e-01 1 1  ON 21
 eO_2                -1.437915e-02 1 1  ON 22
 eO_3                 3.031469e-01 1 1  ON 23
 eO_4                 5.301015e-01 1 1  ON 24
 eO_5                 4.939149e-01 1 1  ON 25
 eO_6                 2.654559e-01 1 1  ON 26
 eO_7                -4.115583e-02 1 1  ON 27
 eO_8                -2.393278e-01 1 1  ON 28
 eO_9                -1.098003e-01 1 1  ON 29
eH1_0                -2.638411e-01 1 1  ON 30
eH1_1                -1.587785e-01 1 1  ON 31
eH1_2                -1.093484e-01 1 1  ON 32
eH1_3                -5.393289e-02 1 1  ON 33
eH1_4                -3.797943e-03 1 1  ON 34
eH1_5                 3.390123e-02 1 1  ON 35
eH1_6                 9.597416e-02 1 1  ON 36
eH1_7                 1.599143e-01 1 1  ON 37
eH1_8                 1.986293e-01 1 1  ON 38
eH1_9                 1.006390e-01 1 1  ON 39
eH2_0                -2.601320e-01 1 1  ON 40
eH2_1                -1.546501e-01 1 1  ON 41
eH2_2                -1.056292e-01 1 1  ON 42
eH2_3                -5.039804e-02 1 1  ON 43
eH2_4                -5.477682e-04 1 1  ON 44
eH2_5                 3.579220e-02 1 1  ON 45
eH2_6                 9.805610e-02 1 1  ON 46
eH2_7                 1.594909e-01 1 1  ON 47
eH2_8                 1.996434e-01 1 1  ON 48
eH2_9                 9.069078e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5944e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.966
    reference variance = 0.445281
====================================================
  Execution time = 2.0456e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3665e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6625e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336711707233
                                         uncertainty =       0.002966864649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336711707233
                                         uncertainty =       0.002966864649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410276624
  error estimate for blocks of size 2^( 2) =       0.000423412364
  error estimate for blocks of size 2^( 3) =       0.000436776591
  error estimate for blocks of size 2^( 4) =       0.000449496777
  error estimate for blocks of size 2^( 5) =       0.000461574849
  error estimate for blocks of size 2^( 6) =       0.000471249616
  error estimate for blocks of size 2^( 7) =       0.000477517968

      target function =                  N/A
              le_mean =     -16.906294576222
             les_mean =     286.159449946141
             stat err =       0.000464959802
             autocorr =       1.284331898363
              std dev =       0.580218766039
             le_variance =       0.336653816464


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690629457622e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906294576222       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906296073358       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906296552642       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906296074410       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906297099296       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906297635745       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906297452505       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906298803493       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906298906937       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906298900171       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906298594825       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906298408019       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.456744e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906294576222       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906295090423       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906295110946       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906294801777       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906295201137       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906295564777       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906295523007       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906295791007       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906295793823       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 3.565702e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906294576222       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906294718025       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906294702944       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906294596855       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906294702670       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906294802971       residual = 9.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906294829463       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906294868872       residual = 4.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 8.893166e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192063 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6126e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.117299e-01 1 1  ON 0
 uu_1                 1.443720e-01 1 1  ON 1
 uu_2                 4.256971e-02 1 1  ON 2
 uu_3                -2.032864e-02 1 1  ON 3
 uu_4                -6.666335e-02 1 1  ON 4
 uu_5                -1.029548e-01 1 1  ON 5
 uu_6                -1.315094e-01 1 1  ON 6
 uu_7                -1.465557e-01 1 1  ON 7
 uu_8                -1.405258e-01 1 1  ON 8
 uu_9                -1.125973e-01 1 1  ON 9
 ud_0                 4.543378e-01 1 1  ON 10
 ud_1                 1.882755e-01 1 1  ON 11
 ud_2                 6.724245e-02 1 1  ON 12
 ud_3                -4.445729e-03 1 1  ON 13
 ud_4                -6.231518e-02 1 1  ON 14
 ud_5                -1.045929e-01 1 1  ON 15
 ud_6                -1.332237e-01 1 1  ON 16
 ud_7                -1.519322e-01 1 1  ON 17
 ud_8                -1.537394e-01 1 1  ON 18
 ud_9                -1.464375e-01 1 1  ON 19
 eO_0                -7.516847e-01 1 1  ON 20
 eO_1                -4.301324e-01 1 1  ON 21
 eO_2                -1.438408e-02 1 1  ON 22
 eO_3                 3.032489e-01 1 1  ON 23
 eO_4                 5.300525e-01 1 1  ON 24
 eO_5                 4.938698e-01 1 1  ON 25
 eO_6                 2.655310e-01 1 1  ON 26
 eO_7                -4.114591e-02 1 1  ON 27
 eO_8                -2.393565e-01 1 1  ON 28
 eO_9                -1.099833e-01 1 1  ON 29
eH1_0                -2.640556e-01 1 1  ON 30
eH1_1                -1.587588e-01 1 1  ON 31
eH1_2                -1.093918e-01 1 1  ON 32
eH1_3                -5.396739e-02 1 1  ON 33
eH1_4                -3.926454e-03 1 1  ON 34
eH1_5                 3.363179e-02 1 1  ON 35
eH1_6                 9.600254e-02 1 1  ON 36
eH1_7                 1.600402e-01 1 1  ON 37
eH1_8                 1.988303e-01 1 1  ON 38
eH1_9                 1.009056e-01 1 1  ON 39
eH2_0                -2.602951e-01 1 1  ON 40
eH2_1                -1.547959e-01 1 1  ON 41
eH2_2                -1.057390e-01 1 1  ON 42
eH2_3                -5.048401e-02 1 1  ON 43
eH2_4                -6.951589e-04 1 1  ON 44
eH2_5                 3.565873e-02 1 1  ON 45
eH2_6                 9.810143e-02 1 1  ON 46
eH2_7                 1.596026e-01 1 1  ON 47
eH2_8                 1.998537e-01 1 1  ON 48
eH2_9                 9.104735e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9198
    reference variance = 0.765726
====================================================
  Execution time = 2.0271e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4586e-01
  Total weights = 2.0000e+06
  Execution time = 1.8985e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345894905068
                                         uncertainty =       0.005318232350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345894905068
                                         uncertainty =       0.005318232350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415847594
  error estimate for blocks of size 2^( 2) =       0.000428617254
  error estimate for blocks of size 2^( 3) =       0.000440821405
  error estimate for blocks of size 2^( 4) =       0.000452614820
  error estimate for blocks of size 2^( 5) =       0.000463234913
  error estimate for blocks of size 2^( 6) =       0.000469594917
  error estimate for blocks of size 2^( 7) =       0.000473976775

      target function =                  N/A
              le_mean =     -16.906561221362
             les_mean =     286.177670601980
             stat err =       0.000464855356
             autocorr =       1.249589282324
              std dev =       0.588097307642
             le_variance =       0.345858443255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345850534799
                                         uncertainty =       0.005320423823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345850534799
                                         uncertainty =       0.005320423823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415820980
  error estimate for blocks of size 2^( 2) =       0.000428596330
  error estimate for blocks of size 2^( 3) =       0.000440809226
  error estimate for blocks of size 2^( 4) =       0.000452608346
  error estimate for blocks of size 2^( 5) =       0.000463229315
  error estimate for blocks of size 2^( 6) =       0.000469583121
  error estimate for blocks of size 2^( 7) =       0.000473950420

      target function =                  N/A
              le_mean =     -16.906562011841
             les_mean =     286.177653062219
             stat err =       0.000464842801
             autocorr =       1.249681735884
              std dev =       0.588059669494
             le_variance =       0.345814174885

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345892076992
                                         uncertainty =       0.005321295097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345892076992
                                         uncertainty =       0.005321295097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415845933
  error estimate for blocks of size 2^( 2) =       0.000428618353
  error estimate for blocks of size 2^( 3) =       0.000440827594
  error estimate for blocks of size 2^( 4) =       0.000452624111
  error estimate for blocks of size 2^( 5) =       0.000463242305
  error estimate for blocks of size 2^( 6) =       0.000469597843
  error estimate for blocks of size 2^( 7) =       0.000473967902

      target function =                  N/A
              le_mean =     -16.906562194960
             les_mean =     286.177700758511
             stat err =       0.000464858040
             autocorr =       1.249613700623
              std dev =       0.588094957798
             le_variance =       0.345855679388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345903599652
                                         uncertainty =       0.005318868587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345903599652
                                         uncertainty =       0.005318868587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415852827
  error estimate for blocks of size 2^( 2) =       0.000428622577
  error estimate for blocks of size 2^( 3) =       0.000440827196
  error estimate for blocks of size 2^( 4) =       0.000452620852
  error estimate for blocks of size 2^( 5) =       0.000463240398
  error estimate for blocks of size 2^( 6) =       0.000469599622
  error estimate for blocks of size 2^( 7) =       0.000473979491

      target function =                  N/A
              le_mean =     -16.906561323508
             les_mean =     286.177682759327
             stat err =       0.000464860091
             autocorr =       1.249583293093
              std dev =       0.588104707287
             le_variance =       0.345867146733


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906561221362        initial
     1.5259e-01     1.5259e+00             1.4567e-03       -16.906562011841
     6.1035e-01     6.1035e+00             3.5657e-04       -16.906562194960  <--
     2.4414e+00     2.4414e+01             8.8932e-05       -16.906561323508

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 2.9830e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.117299e-01 1 1  ON 0
 uu_1                 1.443720e-01 1 1  ON 1
 uu_2                 4.256971e-02 1 1  ON 2
 uu_3                -2.032864e-02 1 1  ON 3
 uu_4                -6.666335e-02 1 1  ON 4
 uu_5                -1.029548e-01 1 1  ON 5
 uu_6                -1.315094e-01 1 1  ON 6
 uu_7                -1.465557e-01 1 1  ON 7
 uu_8                -1.405258e-01 1 1  ON 8
 uu_9                -1.125973e-01 1 1  ON 9
 ud_0                 4.543378e-01 1 1  ON 10
 ud_1                 1.882755e-01 1 1  ON 11
 ud_2                 6.724245e-02 1 1  ON 12
 ud_3                -4.445729e-03 1 1  ON 13
 ud_4                -6.231518e-02 1 1  ON 14
 ud_5                -1.045929e-01 1 1  ON 15
 ud_6                -1.332237e-01 1 1  ON 16
 ud_7                -1.519322e-01 1 1  ON 17
 ud_8                -1.537394e-01 1 1  ON 18
 ud_9                -1.464375e-01 1 1  ON 19
 eO_0                -7.516847e-01 1 1  ON 20
 eO_1                -4.301324e-01 1 1  ON 21
 eO_2                -1.438408e-02 1 1  ON 22
 eO_3                 3.032489e-01 1 1  ON 23
 eO_4                 5.300525e-01 1 1  ON 24
 eO_5                 4.938698e-01 1 1  ON 25
 eO_6                 2.655310e-01 1 1  ON 26
 eO_7                -4.114591e-02 1 1  ON 27
 eO_8                -2.393565e-01 1 1  ON 28
 eO_9                -1.099833e-01 1 1  ON 29
eH1_0                -2.640556e-01 1 1  ON 30
eH1_1                -1.587588e-01 1 1  ON 31
eH1_2                -1.093918e-01 1 1  ON 32
eH1_3                -5.396739e-02 1 1  ON 33
eH1_4                -3.926454e-03 1 1  ON 34
eH1_5                 3.363179e-02 1 1  ON 35
eH1_6                 9.600254e-02 1 1  ON 36
eH1_7                 1.600402e-01 1 1  ON 37
eH1_8                 1.988303e-01 1 1  ON 38
eH1_9                 1.009056e-01 1 1  ON 39
eH2_0                -2.602951e-01 1 1  ON 40
eH2_1                -1.547959e-01 1 1  ON 41
eH2_2                -1.057390e-01 1 1  ON 42
eH2_3                -5.048401e-02 1 1  ON 43
eH2_4                -6.951589e-04 1 1  ON 44
eH2_5                 3.565873e-02 1 1  ON 45
eH2_6                 9.810143e-02 1 1  ON 46
eH2_7                 1.596026e-01 1 1  ON 47
eH2_8                 1.998537e-01 1 1  ON 48
eH2_9                 9.104735e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5964e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6891e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.837
    reference variance = 0.233607
====================================================
  Execution time = 2.0532e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4184e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5414e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341916770869
                                         uncertainty =       0.003467794058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341916770869
                                         uncertainty =       0.003467794058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413423660
  error estimate for blocks of size 2^( 2) =       0.000426323644
  error estimate for blocks of size 2^( 3) =       0.000439138118
  error estimate for blocks of size 2^( 4) =       0.000452059738
  error estimate for blocks of size 2^( 5) =       0.000462511616
  error estimate for blocks of size 2^( 6) =       0.000470375132
  error estimate for blocks of size 2^( 7) =       0.000477141414

      target function =                  N/A
              le_mean =     -16.905907662696
             les_mean =     286.151551973839
             stat err =       0.000465521975
             autocorr =       1.267913771733
              std dev =       0.584669346867
             le_variance =       0.341838245165


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690590766270e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905907662696       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905909371594       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905909656591       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905907789291       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905910225205       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905910343179       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905910780601       residual = 9.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905910710104       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905910842298       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905910946601       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905910824895       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.161347e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905907662696       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905908344568       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905908458572       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905907630662       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905908097014       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905908610757       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905908433493       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905908428756       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905908408043       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 2.949516e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905907662696       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905907863014       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905907899022       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905907646034       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905907588054       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905907810145       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905907802493       residual = 9.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 6.981574e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.195337 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6081e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.116149e-01 1 1  ON 0
 uu_1                 1.443888e-01 1 1  ON 1
 uu_2                 4.250449e-02 1 1  ON 2
 uu_3                -2.036610e-02 1 1  ON 3
 uu_4                -6.667670e-02 1 1  ON 4
 uu_5                -1.028789e-01 1 1  ON 5
 uu_6                -1.316525e-01 1 1  ON 6
 uu_7                -1.466666e-01 1 1  ON 7
 uu_8                -1.403342e-01 1 1  ON 8
 uu_9                -1.125445e-01 1 1  ON 9
 ud_0                 4.542447e-01 1 1  ON 10
 ud_1                 1.881804e-01 1 1  ON 11
 ud_2                 6.724863e-02 1 1  ON 12
 ud_3                -4.503981e-03 1 1  ON 13
 ud_4                -6.213056e-02 1 1  ON 14
 ud_5                -1.045768e-01 1 1  ON 15
 ud_6                -1.333318e-01 1 1  ON 16
 ud_7                -1.517334e-01 1 1  ON 17
 ud_8                -1.537602e-01 1 1  ON 18
 ud_9                -1.463867e-01 1 1  ON 19
 eO_0                -7.516172e-01 1 1  ON 20
 eO_1                -4.299753e-01 1 1  ON 21
 eO_2                -1.433985e-02 1 1  ON 22
 eO_3                 3.032141e-01 1 1  ON 23
 eO_4                 5.301350e-01 1 1  ON 24
 eO_5                 4.938489e-01 1 1  ON 25
 eO_6                 2.654765e-01 1 1  ON 26
 eO_7                -4.109027e-02 1 1  ON 27
 eO_8                -2.394339e-01 1 1  ON 28
 eO_9                -1.101574e-01 1 1  ON 29
eH1_0                -2.641282e-01 1 1  ON 30
eH1_1                -1.589956e-01 1 1  ON 31
eH1_2                -1.094412e-01 1 1  ON 32
eH1_3                -5.405951e-02 1 1  ON 33
eH1_4                -3.851727e-03 1 1  ON 34
eH1_5                 3.355166e-02 1 1  ON 35
eH1_6                 9.605627e-02 1 1  ON 36
eH1_7                 1.600712e-01 1 1  ON 37
eH1_8                 1.988811e-01 1 1  ON 38
eH1_9                 1.011843e-01 1 1  ON 39
eH2_0                -2.604133e-01 1 1  ON 40
eH2_1                -1.548946e-01 1 1  ON 41
eH2_2                -1.057921e-01 1 1  ON 42
eH2_3                -5.060911e-02 1 1  ON 43
eH2_4                -5.524247e-04 1 1  ON 44
eH2_5                 3.549670e-02 1 1  ON 45
eH2_6                 9.797075e-02 1 1  ON 46
eH2_7                 1.596632e-01 1 1  ON 47
eH2_8                 1.999667e-01 1 1  ON 48
eH2_9                 9.134230e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9297
    reference variance = 0.256967
====================================================
  Execution time = 2.0066e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3880e-01
  Total weights = 2.0000e+06
  Execution time = 1.9029e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338842255559
                                         uncertainty =       0.003640063860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338842255559
                                         uncertainty =       0.003640063860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411626518
  error estimate for blocks of size 2^( 2) =       0.000424627802
  error estimate for blocks of size 2^( 3) =       0.000437951023
  error estimate for blocks of size 2^( 4) =       0.000450707175
  error estimate for blocks of size 2^( 5) =       0.000461641193
  error estimate for blocks of size 2^( 6) =       0.000469263333
  error estimate for blocks of size 2^( 7) =       0.000474888664

      target function =                  N/A
              le_mean =     -16.905220294881
             les_mean =     286.125345829001
             stat err =       0.000464125091
             autocorr =       1.271344959169
              std dev =       0.582127803828
             le_variance =       0.338872779990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338648322437
                                         uncertainty =       0.003637349999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338648322437
                                         uncertainty =       0.003637349999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411508762
  error estimate for blocks of size 2^( 2) =       0.000424518034
  error estimate for blocks of size 2^( 3) =       0.000437851983
  error estimate for blocks of size 2^( 4) =       0.000450614178
  error estimate for blocks of size 2^( 5) =       0.000461547734
  error estimate for blocks of size 2^( 6) =       0.000469167988
  error estimate for blocks of size 2^( 7) =       0.000474781297

      target function =                  N/A
              le_mean =     -16.905221070358
             les_mean =     286.125178190656
             stat err =       0.000464027799
             autocorr =       1.271539408845
              std dev =       0.581961272171
             le_variance =       0.338678922306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338696205133
                                         uncertainty =       0.003638345665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338696205133
                                         uncertainty =       0.003638345665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411537843
  error estimate for blocks of size 2^( 2) =       0.000424544851
  error estimate for blocks of size 2^( 3) =       0.000437876519
  error estimate for blocks of size 2^( 4) =       0.000450637367
  error estimate for blocks of size 2^( 5) =       0.000461571656
  error estimate for blocks of size 2^( 6) =       0.000469192147
  error estimate for blocks of size 2^( 7) =       0.000474805345

      target function =                  N/A
              le_mean =     -16.905220514433
             les_mean =     286.125207264070
             stat err =       0.000464051629
             autocorr =       1.271490294258
              std dev =       0.582002398463
             le_variance =       0.338726791816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338820147135
                                         uncertainty =       0.003639840683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338820147135
                                         uncertainty =       0.003639840683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411613094
  error estimate for blocks of size 2^( 2) =       0.000424615198
  error estimate for blocks of size 2^( 3) =       0.000437939686
  error estimate for blocks of size 2^( 4) =       0.000450696538
  error estimate for blocks of size 2^( 5) =       0.000461630636
  error estimate for blocks of size 2^( 6) =       0.000469252647
  error estimate for blocks of size 2^( 7) =       0.000474875762

      target function =                  N/A
              le_mean =     -16.905220155406
             les_mean =     286.125319011047
             stat err =       0.000464113896
             autocorr =       1.271366549308
              std dev =       0.582108819483
             le_variance =       0.338850677720


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905220294881        initial
     1.5259e-01     1.5259e+00             1.1613e-03       -16.905221070358  <--
     6.1035e-01     6.1035e+00             2.9495e-04       -16.905220514433
     2.4414e+00     2.4414e+01             6.9816e-05       -16.905220155406

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 2.9552e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.114404e-01 1 1  ON 0
 uu_1                 1.443007e-01 1 1  ON 1
 uu_2                 4.238355e-02 1 1  ON 2
 uu_3                -2.046059e-02 1 1  ON 3
 uu_4                -6.672707e-02 1 1  ON 4
 uu_5                -1.028577e-01 1 1  ON 5
 uu_6                -1.318400e-01 1 1  ON 6
 uu_7                -1.469665e-01 1 1  ON 7
 uu_8                -1.399332e-01 1 1  ON 8
 uu_9                -1.124002e-01 1 1  ON 9
 ud_0                 4.540855e-01 1 1  ON 10
 ud_1                 1.880832e-01 1 1  ON 11
 ud_2                 6.721828e-02 1 1  ON 12
 ud_3                -4.506472e-03 1 1  ON 13
 ud_4                -6.193099e-02 1 1  ON 14
 ud_5                -1.045006e-01 1 1  ON 15
 ud_6                -1.334076e-01 1 1  ON 16
 ud_7                -1.514613e-01 1 1  ON 17
 ud_8                -1.538544e-01 1 1  ON 18
 ud_9                -1.462378e-01 1 1  ON 19
 eO_0                -7.513277e-01 1 1  ON 20
 eO_1                -4.296372e-01 1 1  ON 21
 eO_2                -1.424757e-02 1 1  ON 22
 eO_3                 3.031766e-01 1 1  ON 23
 eO_4                 5.304106e-01 1 1  ON 24
 eO_5                 4.938417e-01 1 1  ON 25
 eO_6                 2.652984e-01 1 1  ON 26
 eO_7                -4.097734e-02 1 1  ON 27
 eO_8                -2.396739e-01 1 1  ON 28
 eO_9                -1.106693e-01 1 1  ON 29
eH1_0                -2.643651e-01 1 1  ON 30
eH1_1                -1.594372e-01 1 1  ON 31
eH1_2                -1.096738e-01 1 1  ON 32
eH1_3                -5.431959e-02 1 1  ON 33
eH1_4                -3.812229e-03 1 1  ON 34
eH1_5                 3.337072e-02 1 1  ON 35
eH1_6                 9.619464e-02 1 1  ON 36
eH1_7                 1.601549e-01 1 1  ON 37
eH1_8                 1.990284e-01 1 1  ON 38
eH1_9                 1.020021e-01 1 1  ON 39
eH2_0                -2.606737e-01 1 1  ON 40
eH2_1                -1.551683e-01 1 1  ON 41
eH2_2                -1.059812e-01 1 1  ON 42
eH2_3                -5.084748e-02 1 1  ON 43
eH2_4                -4.366652e-04 1 1  ON 44
eH2_5                 3.515257e-02 1 1  ON 45
eH2_6                 9.761254e-02 1 1  ON 46
eH2_7                 1.598006e-01 1 1  ON 47
eH2_8                 2.002829e-01 1 1  ON 48
eH2_9                 9.220870e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5640e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6890e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9008
    reference variance = 0.215854
====================================================
  Execution time = 2.0702e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4532e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5359e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345028614303
                                         uncertainty =       0.005379017177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345028614303
                                         uncertainty =       0.005379017177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415525313
  error estimate for blocks of size 2^( 2) =       0.000428623413
  error estimate for blocks of size 2^( 3) =       0.000441840983
  error estimate for blocks of size 2^( 4) =       0.000455247816
  error estimate for blocks of size 2^( 5) =       0.000466219251
  error estimate for blocks of size 2^( 6) =       0.000476665024
  error estimate for blocks of size 2^( 7) =       0.000479871121

      target function =                  N/A
              le_mean =     -16.905760124983
             les_mean =     286.150047802680
             stat err =       0.000469500803
             autocorr =       1.276667220499
              std dev =       0.587641533482
             le_variance =       0.345322571873


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690576012498e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905760124983       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905759670157       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905759645432       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905759975782       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905759057583       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905761182136       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905761096551       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905766209707       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905765142898       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905764706711       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905763426573       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905766042039       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905767271485       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905766470457       residual = 8.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 5.913075e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905760124983       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905759871372       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905759906120       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905760743850       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905761010355       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905759795893       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905762105051       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905761912931       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905761828719       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905761280106       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905761399104       residual = 8.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.481827e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905760124983       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905760033413       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905760052893       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905760541988       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905760884371       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905760299849       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905760886056       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905760811267       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905760666982       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 3.746658e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.200033 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6248e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.112944e-01 1 1  ON 0
 uu_1                 1.442223e-01 1 1  ON 1
 uu_2                 4.231676e-02 1 1  ON 2
 uu_3                -2.065441e-02 1 1  ON 3
 uu_4                -6.701802e-02 1 1  ON 4
 uu_5                -1.027878e-01 1 1  ON 5
 uu_6                -1.315970e-01 1 1  ON 6
 uu_7                -1.475355e-01 1 1  ON 7
 uu_8                -1.401464e-01 1 1  ON 8
 uu_9                -1.122729e-01 1 1  ON 9
 ud_0                 4.540926e-01 1 1  ON 10
 ud_1                 1.879628e-01 1 1  ON 11
 ud_2                 6.707266e-02 1 1  ON 12
 ud_3                -4.615388e-03 1 1  ON 13
 ud_4                -6.219495e-02 1 1  ON 14
 ud_5                -1.046878e-01 1 1  ON 15
 ud_6                -1.335458e-01 1 1  ON 16
 ud_7                -1.516084e-01 1 1  ON 17
 ud_8                -1.533186e-01 1 1  ON 18
 ud_9                -1.455594e-01 1 1  ON 19
 eO_0                -7.512939e-01 1 1  ON 20
 eO_1                -4.296362e-01 1 1  ON 21
 eO_2                -1.407377e-02 1 1  ON 22
 eO_3                 3.034608e-01 1 1  ON 23
 eO_4                 5.306850e-01 1 1  ON 24
 eO_5                 4.943468e-01 1 1  ON 25
 eO_6                 2.654101e-01 1 1  ON 26
 eO_7                -4.113117e-02 1 1  ON 27
 eO_8                -2.400452e-01 1 1  ON 28
 eO_9                -1.113638e-01 1 1  ON 29
eH1_0                -2.644601e-01 1 1  ON 30
eH1_1                -1.594831e-01 1 1  ON 31
eH1_2                -1.101625e-01 1 1  ON 32
eH1_3                -5.487118e-02 1 1  ON 33
eH1_4                -4.188802e-03 1 1  ON 34
eH1_5                 3.257432e-02 1 1  ON 35
eH1_6                 9.628801e-02 1 1  ON 36
eH1_7                 1.608528e-01 1 1  ON 37
eH1_8                 1.994957e-01 1 1  ON 38
eH1_9                 1.029503e-01 1 1  ON 39
eH2_0                -2.610095e-01 1 1  ON 40
eH2_1                -1.557376e-01 1 1  ON 41
eH2_2                -1.068909e-01 1 1  ON 42
eH2_3                -5.138537e-02 1 1  ON 43
eH2_4                -9.124456e-04 1 1  ON 44
eH2_5                 3.507122e-02 1 1  ON 45
eH2_6                 9.759716e-02 1 1  ON 46
eH2_7                 1.600830e-01 1 1  ON 47
eH2_8                 2.011289e-01 1 1  ON 48
eH2_9                 9.369053e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9687
    reference variance = 0.332285
====================================================
  Execution time = 1.9952e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4347e-01
  Total weights = 2.0000e+06
  Execution time = 1.8739e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343095566565
                                         uncertainty =       0.005406156043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343095566565
                                         uncertainty =       0.005406156043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414276702
  error estimate for blocks of size 2^( 2) =       0.000427136449
  error estimate for blocks of size 2^( 3) =       0.000439925563
  error estimate for blocks of size 2^( 4) =       0.000451399970
  error estimate for blocks of size 2^( 5) =       0.000460292210
  error estimate for blocks of size 2^( 6) =       0.000467169566
  error estimate for blocks of size 2^( 7) =       0.000471238087

      target function =                  N/A
              le_mean =     -16.906586452346
             les_mean =     286.175915670775
             stat err =       0.000462524958
             autocorr =       1.246491509218
              std dev =       0.585875730631
             le_variance =       0.343250371742

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343428227266
                                         uncertainty =       0.005409479943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343428227266
                                         uncertainty =       0.005409479943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414476698
  error estimate for blocks of size 2^( 2) =       0.000427337712
  error estimate for blocks of size 2^( 3) =       0.000440122046
  error estimate for blocks of size 2^( 4) =       0.000451587239
  error estimate for blocks of size 2^( 5) =       0.000460475063
  error estimate for blocks of size 2^( 6) =       0.000467329219
  error estimate for blocks of size 2^( 7) =       0.000471400319

      target function =                  N/A
              le_mean =     -16.906584187728
             les_mean =     286.176170592043
             stat err =       0.000462697960
             autocorr =       1.246220612872
              std dev =       0.586158568232
             le_variance =       0.343581867112

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343536741297
                                         uncertainty =       0.005407173814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343536741297
                                         uncertainty =       0.005407173814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414541902
  error estimate for blocks of size 2^( 2) =       0.000427395718
  error estimate for blocks of size 2^( 3) =       0.000440173439
  error estimate for blocks of size 2^( 4) =       0.000451633924
  error estimate for blocks of size 2^( 5) =       0.000460524180
  error estimate for blocks of size 2^( 6) =       0.000467382804
  error estimate for blocks of size 2^( 7) =       0.000471452881

      target function =                  N/A
              le_mean =     -16.906585489035
             les_mean =     286.176322703760
             stat err =       0.000462748447
             autocorr =       1.246100492984
              std dev =       0.586250780430
             le_variance =       0.343689977555

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343198644804
                                         uncertainty =       0.005405933001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343198644804
                                         uncertainty =       0.005405933001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414338686
  error estimate for blocks of size 2^( 2) =       0.000427196092
  error estimate for blocks of size 2^( 3) =       0.000439981763
  error estimate for blocks of size 2^( 4) =       0.000451452546
  error estimate for blocks of size 2^( 5) =       0.000460344419
  error estimate for blocks of size 2^( 6) =       0.000467217468
  error estimate for blocks of size 2^( 7) =       0.000471285640

      target function =                  N/A
              le_mean =     -16.906585761879
             les_mean =     286.175995045719
             stat err =       0.000462575018
             autocorr =       1.246388348100
              std dev =       0.585963389331
             le_variance =       0.343353093636


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906586452346        initial  <--
     3.8147e-02     3.8147e-01             5.9131e-03       -16.906584187728
     1.5259e-01     1.5259e+00             1.4818e-03       -16.906585489035
     6.1035e-01     6.1035e+00             3.7467e-04       -16.906585761879

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3806
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.114404e-01 1 1  ON 0
 uu_1                 1.443007e-01 1 1  ON 1
 uu_2                 4.238355e-02 1 1  ON 2
 uu_3                -2.046059e-02 1 1  ON 3
 uu_4                -6.672707e-02 1 1  ON 4
 uu_5                -1.028577e-01 1 1  ON 5
 uu_6                -1.318400e-01 1 1  ON 6
 uu_7                -1.469665e-01 1 1  ON 7
 uu_8                -1.399332e-01 1 1  ON 8
 uu_9                -1.124002e-01 1 1  ON 9
 ud_0                 4.540855e-01 1 1  ON 10
 ud_1                 1.880832e-01 1 1  ON 11
 ud_2                 6.721828e-02 1 1  ON 12
 ud_3                -4.506472e-03 1 1  ON 13
 ud_4                -6.193099e-02 1 1  ON 14
 ud_5                -1.045006e-01 1 1  ON 15
 ud_6                -1.334076e-01 1 1  ON 16
 ud_7                -1.514613e-01 1 1  ON 17
 ud_8                -1.538544e-01 1 1  ON 18
 ud_9                -1.462378e-01 1 1  ON 19
 eO_0                -7.513277e-01 1 1  ON 20
 eO_1                -4.296372e-01 1 1  ON 21
 eO_2                -1.424757e-02 1 1  ON 22
 eO_3                 3.031766e-01 1 1  ON 23
 eO_4                 5.304106e-01 1 1  ON 24
 eO_5                 4.938417e-01 1 1  ON 25
 eO_6                 2.652984e-01 1 1  ON 26
 eO_7                -4.097734e-02 1 1  ON 27
 eO_8                -2.396739e-01 1 1  ON 28
 eO_9                -1.106693e-01 1 1  ON 29
eH1_0                -2.643651e-01 1 1  ON 30
eH1_1                -1.594372e-01 1 1  ON 31
eH1_2                -1.096738e-01 1 1  ON 32
eH1_3                -5.431959e-02 1 1  ON 33
eH1_4                -3.812229e-03 1 1  ON 34
eH1_5                 3.337072e-02 1 1  ON 35
eH1_6                 9.619464e-02 1 1  ON 36
eH1_7                 1.601549e-01 1 1  ON 37
eH1_8                 1.990284e-01 1 1  ON 38
eH1_9                 1.020021e-01 1 1  ON 39
eH2_0                -2.606737e-01 1 1  ON 40
eH2_1                -1.551683e-01 1 1  ON 41
eH2_2                -1.059812e-01 1 1  ON 42
eH2_3                -5.084748e-02 1 1  ON 43
eH2_4                -4.366652e-04 1 1  ON 44
eH2_5                 3.515257e-02 1 1  ON 45
eH2_6                 9.761254e-02 1 1  ON 46
eH2_7                 1.598006e-01 1 1  ON 47
eH2_8                 2.002829e-01 1 1  ON 48
eH2_9                 9.220870e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5637e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9626
    reference variance = 0.31557
====================================================
  Execution time = 2.0727e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6123e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5261e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361344085963
                                         uncertainty =       0.019426247176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361344085963
                                         uncertainty =       0.019426247176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424988217
  error estimate for blocks of size 2^( 2) =       0.000437351823
  error estimate for blocks of size 2^( 3) =       0.000450426761
  error estimate for blocks of size 2^( 4) =       0.000462334793
  error estimate for blocks of size 2^( 5) =       0.000472867177
  error estimate for blocks of size 2^( 6) =       0.000479924031
  error estimate for blocks of size 2^( 7) =       0.000481229139

      target function =                  N/A
              le_mean =     -16.905550164031
             les_mean =     286.158856137476
             stat err =       0.000474088785
             autocorr =       1.244415995361
              std dev =       0.601024100625
             le_variance =       0.361229969532


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690555016403e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905550164031       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905551601282       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905552576859       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905552331358       residual = 9.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905552478558       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905553153160       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905553927722       residual = 6.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905553843108       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905553494241       residual = 7.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 5.384557e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905550164031       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905550611167       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905550932209       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905550839936       residual = 9.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905550885136       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905551144581       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905551360627       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905551285505       residual = 6.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.416698e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905550164031       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905550283090       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905550373468       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905550347621       residual = 9.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905550360868       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905550437066       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905550487582       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905550468345       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 3.790291e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.202918 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6260e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.115503e-01 1 1  ON 0
 uu_1                 1.442598e-01 1 1  ON 1
 uu_2                 4.233807e-02 1 1  ON 2
 uu_3                -2.053957e-02 1 1  ON 3
 uu_4                -6.676660e-02 1 1  ON 4
 uu_5                -1.028768e-01 1 1  ON 5
 uu_6                -1.318407e-01 1 1  ON 6
 uu_7                -1.470432e-01 1 1  ON 7
 uu_8                -1.399174e-01 1 1  ON 8
 uu_9                -1.123465e-01 1 1  ON 9
 ud_0                 4.542141e-01 1 1  ON 10
 ud_1                 1.881024e-01 1 1  ON 11
 ud_2                 6.714149e-02 1 1  ON 12
 ud_3                -4.508081e-03 1 1  ON 13
 ud_4                -6.201315e-02 1 1  ON 14
 ud_5                -1.045175e-01 1 1  ON 15
 ud_6                -1.333676e-01 1 1  ON 16
 ud_7                -1.515197e-01 1 1  ON 17
 ud_8                -1.538429e-01 1 1  ON 18
 ud_9                -1.462002e-01 1 1  ON 19
 eO_0                -7.513481e-01 1 1  ON 20
 eO_1                -4.296417e-01 1 1  ON 21
 eO_2                -1.412896e-02 1 1  ON 22
 eO_3                 3.031386e-01 1 1  ON 23
 eO_4                 5.304937e-01 1 1  ON 24
 eO_5                 4.938237e-01 1 1  ON 25
 eO_6                 2.653224e-01 1 1  ON 26
 eO_7                -4.101469e-02 1 1  ON 27
 eO_8                -2.397200e-01 1 1  ON 28
 eO_9                -1.107185e-01 1 1  ON 29
eH1_0                -2.643870e-01 1 1  ON 30
eH1_1                -1.594568e-01 1 1  ON 31
eH1_2                -1.097798e-01 1 1  ON 32
eH1_3                -5.429046e-02 1 1  ON 33
eH1_4                -3.826336e-03 1 1  ON 34
eH1_5                 3.339612e-02 1 1  ON 35
eH1_6                 9.617002e-02 1 1  ON 36
eH1_7                 1.601442e-01 1 1  ON 37
eH1_8                 1.990625e-01 1 1  ON 38
eH1_9                 1.020909e-01 1 1  ON 39
eH2_0                -2.607131e-01 1 1  ON 40
eH2_1                -1.553100e-01 1 1  ON 41
eH2_2                -1.060370e-01 1 1  ON 42
eH2_3                -5.084081e-02 1 1  ON 43
eH2_4                -4.641339e-04 1 1  ON 44
eH2_5                 3.520488e-02 1 1  ON 45
eH2_6                 9.759307e-02 1 1  ON 46
eH2_7                 1.598068e-01 1 1  ON 47
eH2_8                 2.003289e-01 1 1  ON 48
eH2_9                 9.234556e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9043
    reference variance = 0.32776
====================================================
  Execution time = 2.1972e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5531e-01
  Total weights = 2.0000e+06
  Execution time = 1.8810e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355216006953
                                         uncertainty =       0.016212782047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355216006953
                                         uncertainty =       0.016212782047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421370643
  error estimate for blocks of size 2^( 2) =       0.000433531691
  error estimate for blocks of size 2^( 3) =       0.000446167170
  error estimate for blocks of size 2^( 4) =       0.000458441939
  error estimate for blocks of size 2^( 5) =       0.000467974525
  error estimate for blocks of size 2^( 6) =       0.000476492905
  error estimate for blocks of size 2^( 7) =       0.000482794481

      target function =                  N/A
              le_mean =     -16.906272410465
             les_mean =     286.177153076538
             stat err =       0.000471425962
             autocorr =       1.251694786478
              std dev =       0.595908077832
             le_variance =       0.355106437226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355754092787
                                         uncertainty =       0.016205048945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355754092787
                                         uncertainty =       0.016205048945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421689591
  error estimate for blocks of size 2^( 2) =       0.000433831962
  error estimate for blocks of size 2^( 3) =       0.000446448757
  error estimate for blocks of size 2^( 4) =       0.000458708520
  error estimate for blocks of size 2^( 5) =       0.000468233079
  error estimate for blocks of size 2^( 6) =       0.000476750986
  error estimate for blocks of size 2^( 7) =       0.000483049393

      target function =                  N/A
              le_mean =     -16.906271308653
             les_mean =     286.177653606502
             stat err =       0.000471685494
             autocorr =       1.251178517138
              std dev =       0.596359138901
             le_variance =       0.355644222551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355630664774
                                         uncertainty =       0.016204418788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355630664774
                                         uncertainty =       0.016204418788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421616454
  error estimate for blocks of size 2^( 2) =       0.000433763009
  error estimate for blocks of size 2^( 3) =       0.000446384532
  error estimate for blocks of size 2^( 4) =       0.000458648063
  error estimate for blocks of size 2^( 5) =       0.000468174976
  error estimate for blocks of size 2^( 6) =       0.000476692763
  error estimate for blocks of size 2^( 7) =       0.000482992506

      target function =                  N/A
              le_mean =     -16.906271481858
             les_mean =     286.177536109699
             stat err =       0.000471627077
             autocorr =       1.251302632519
              std dev =       0.596255707886
             le_variance =       0.355520869186

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355275824104
                                         uncertainty =       0.016211880456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355275824104
                                         uncertainty =       0.016211880456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421406111
  error estimate for blocks of size 2^( 2) =       0.000433565040
  error estimate for blocks of size 2^( 3) =       0.000446198490
  error estimate for blocks of size 2^( 4) =       0.000458471618
  error estimate for blocks of size 2^( 5) =       0.000468003436
  error estimate for blocks of size 2^( 6) =       0.000476521707
  error estimate for blocks of size 2^( 7) =       0.000482823043

      target function =                  N/A
              le_mean =     -16.906272221655
             les_mean =     286.177206476523
             stat err =       0.000471454951
             autocorr =       1.251638006221
              std dev =       0.595958237981
             le_variance =       0.355166221418


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906272410465        initial  <--
     3.8147e-01     3.8147e+00             5.3846e-04       -16.906271308653
     1.5259e+00     1.5259e+01             1.4167e-04       -16.906271481858
     6.1035e+00     6.1035e+01             3.7903e-05       -16.906272221655

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.3961
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.114404e-01 1 1  ON 0
 uu_1                 1.443007e-01 1 1  ON 1
 uu_2                 4.238355e-02 1 1  ON 2
 uu_3                -2.046059e-02 1 1  ON 3
 uu_4                -6.672707e-02 1 1  ON 4
 uu_5                -1.028577e-01 1 1  ON 5
 uu_6                -1.318400e-01 1 1  ON 6
 uu_7                -1.469665e-01 1 1  ON 7
 uu_8                -1.399332e-01 1 1  ON 8
 uu_9                -1.124002e-01 1 1  ON 9
 ud_0                 4.540855e-01 1 1  ON 10
 ud_1                 1.880832e-01 1 1  ON 11
 ud_2                 6.721828e-02 1 1  ON 12
 ud_3                -4.506472e-03 1 1  ON 13
 ud_4                -6.193099e-02 1 1  ON 14
 ud_5                -1.045006e-01 1 1  ON 15
 ud_6                -1.334076e-01 1 1  ON 16
 ud_7                -1.514613e-01 1 1  ON 17
 ud_8                -1.538544e-01 1 1  ON 18
 ud_9                -1.462378e-01 1 1  ON 19
 eO_0                -7.513277e-01 1 1  ON 20
 eO_1                -4.296372e-01 1 1  ON 21
 eO_2                -1.424757e-02 1 1  ON 22
 eO_3                 3.031766e-01 1 1  ON 23
 eO_4                 5.304106e-01 1 1  ON 24
 eO_5                 4.938417e-01 1 1  ON 25
 eO_6                 2.652984e-01 1 1  ON 26
 eO_7                -4.097734e-02 1 1  ON 27
 eO_8                -2.396739e-01 1 1  ON 28
 eO_9                -1.106693e-01 1 1  ON 29
eH1_0                -2.643651e-01 1 1  ON 30
eH1_1                -1.594372e-01 1 1  ON 31
eH1_2                -1.096738e-01 1 1  ON 32
eH1_3                -5.431959e-02 1 1  ON 33
eH1_4                -3.812229e-03 1 1  ON 34
eH1_5                 3.337072e-02 1 1  ON 35
eH1_6                 9.619464e-02 1 1  ON 36
eH1_7                 1.601549e-01 1 1  ON 37
eH1_8                 1.990284e-01 1 1  ON 38
eH1_9                 1.020021e-01 1 1  ON 39
eH2_0                -2.606737e-01 1 1  ON 40
eH2_1                -1.551683e-01 1 1  ON 41
eH2_2                -1.059812e-01 1 1  ON 42
eH2_3                -5.084748e-02 1 1  ON 43
eH2_4                -4.366652e-04 1 1  ON 44
eH2_5                 3.515257e-02 1 1  ON 45
eH2_6                 9.761254e-02 1 1  ON 46
eH2_7                 1.598006e-01 1 1  ON 47
eH2_8                 2.002829e-01 1 1  ON 48
eH2_9                 9.220870e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7664e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9072
    reference variance = 0.366081
====================================================
  Execution time = 2.0513e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3933e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5665e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339349616076
                                         uncertainty =       0.004037624297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339349616076
                                         uncertainty =       0.004037624297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411905266
  error estimate for blocks of size 2^( 2) =       0.000425023038
  error estimate for blocks of size 2^( 3) =       0.000438562334
  error estimate for blocks of size 2^( 4) =       0.000452013540
  error estimate for blocks of size 2^( 5) =       0.000462316017
  error estimate for blocks of size 2^( 6) =       0.000471755006
  error estimate for blocks of size 2^( 7) =       0.000476551183

      target function =                  N/A
              le_mean =     -16.906092471245
             les_mean =     286.155294372511
             stat err =       0.000465658937
             autocorr =       1.278030434401
              std dev =       0.582522013211
             le_variance =       0.339331895876


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690609247125e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906092471245       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906092466170       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906092489459       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906092343656       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906092304520       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906092392303       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906092408162       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906092432328       residual = 4.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 4.970440e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906092471245       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906092469942       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906092475909       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906092437865       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906092424498       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906092447762       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906092450723       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906092457633       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.299576e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906092471245       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906092470917       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906092472419       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906092462805       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906092459214       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906092465107       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906092465775       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906092467555       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 3.286425e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.205624 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6089e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.114396e-01 1 1  ON 0
 uu_1                 1.443013e-01 1 1  ON 1
 uu_2                 4.238443e-02 1 1  ON 2
 uu_3                -2.046258e-02 1 1  ON 3
 uu_4                -6.673200e-02 1 1  ON 4
 uu_5                -1.028573e-01 1 1  ON 5
 uu_6                -1.318429e-01 1 1  ON 6
 uu_7                -1.469694e-01 1 1  ON 7
 uu_8                -1.399360e-01 1 1  ON 8
 uu_9                -1.123988e-01 1 1  ON 9
 ud_0                 4.540938e-01 1 1  ON 10
 ud_1                 1.880835e-01 1 1  ON 11
 ud_2                 6.721736e-02 1 1  ON 12
 ud_3                -4.506199e-03 1 1  ON 13
 ud_4                -6.193759e-02 1 1  ON 14
 ud_5                -1.045027e-01 1 1  ON 15
 ud_6                -1.334097e-01 1 1  ON 16
 ud_7                -1.514670e-01 1 1  ON 17
 ud_8                -1.538484e-01 1 1  ON 18
 ud_9                -1.462308e-01 1 1  ON 19
 eO_0                -7.513229e-01 1 1  ON 20
 eO_1                -4.296440e-01 1 1  ON 21
 eO_2                -1.423961e-02 1 1  ON 22
 eO_3                 3.031817e-01 1 1  ON 23
 eO_4                 5.304098e-01 1 1  ON 24
 eO_5                 4.938425e-01 1 1  ON 25
 eO_6                 2.652974e-01 1 1  ON 26
 eO_7                -4.097966e-02 1 1  ON 27
 eO_8                -2.396740e-01 1 1  ON 28
 eO_9                -1.106749e-01 1 1  ON 29
eH1_0                -2.643682e-01 1 1  ON 30
eH1_1                -1.594371e-01 1 1  ON 31
eH1_2                -1.096788e-01 1 1  ON 32
eH1_3                -5.432531e-02 1 1  ON 33
eH1_4                -3.818157e-03 1 1  ON 34
eH1_5                 3.336795e-02 1 1  ON 35
eH1_6                 9.619306e-02 1 1  ON 36
eH1_7                 1.601578e-01 1 1  ON 37
eH1_8                 1.990353e-01 1 1  ON 38
eH1_9                 1.020137e-01 1 1  ON 39
eH2_0                -2.606689e-01 1 1  ON 40
eH2_1                -1.551677e-01 1 1  ON 41
eH2_2                -1.059942e-01 1 1  ON 42
eH2_3                -5.084193e-02 1 1  ON 43
eH2_4                -4.478997e-04 1 1  ON 44
eH2_5                 3.515368e-02 1 1  ON 45
eH2_6                 9.760841e-02 1 1  ON 46
eH2_7                 1.598010e-01 1 1  ON 47
eH2_8                 2.002863e-01 1 1  ON 48
eH2_9                 9.221988e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9389
    reference variance = 0.200262
====================================================
  Execution time = 1.9827e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3725e-01
  Total weights = 2.0000e+06
  Execution time = 1.8712e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337294852895
                                         uncertainty =       0.003016278255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337294852895
                                         uncertainty =       0.003016278255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410635602
  error estimate for blocks of size 2^( 2) =       0.000423453319
  error estimate for blocks of size 2^( 3) =       0.000435903841
  error estimate for blocks of size 2^( 4) =       0.000447729582
  error estimate for blocks of size 2^( 5) =       0.000459463289
  error estimate for blocks of size 2^( 6) =       0.000465206561
  error estimate for blocks of size 2^( 7) =       0.000468785361

      target function =                  N/A
              le_mean =     -16.905352969110
             les_mean =     286.128202036248
             stat err =       0.000460296198
             autocorr =       1.256497350022
              std dev =       0.580726437037
             le_variance =       0.337243194673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337328774996
                                         uncertainty =       0.003016631738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337328774996
                                         uncertainty =       0.003016631738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410656253
  error estimate for blocks of size 2^( 2) =       0.000423472549
  error estimate for blocks of size 2^( 3) =       0.000435921710
  error estimate for blocks of size 2^( 4) =       0.000447745748
  error estimate for blocks of size 2^( 5) =       0.000459479307
  error estimate for blocks of size 2^( 6) =       0.000465222152
  error estimate for blocks of size 2^( 7) =       0.000468801046

      target function =                  N/A
              le_mean =     -16.905352659688
             les_mean =     286.128225496046
             stat err =       0.000460312063
             autocorr =       1.256457584639
              std dev =       0.580755642473
             le_variance =       0.337277116264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337313094696
                                         uncertainty =       0.003016466551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337313094696
                                         uncertainty =       0.003016466551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410646707
  error estimate for blocks of size 2^( 2) =       0.000423463652
  error estimate for blocks of size 2^( 3) =       0.000435913444
  error estimate for blocks of size 2^( 4) =       0.000447738275
  error estimate for blocks of size 2^( 5) =       0.000459471901
  error estimate for blocks of size 2^( 6) =       0.000465214956
  error estimate for blocks of size 2^( 7) =       0.000468793801

      target function =                  N/A
              le_mean =     -16.905352799337
             les_mean =     286.128214537789
             stat err =       0.000460304733
             autocorr =       1.256475981729
              std dev =       0.580742142753
             le_variance =       0.337261436369

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337297176157
                                         uncertainty =       0.003016302181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337297176157
                                         uncertainty =       0.003016302181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410637016
  error estimate for blocks of size 2^( 2) =       0.000423454634
  error estimate for blocks of size 2^( 3) =       0.000435905063
  error estimate for blocks of size 2^( 4) =       0.000447730689
  error estimate for blocks of size 2^( 5) =       0.000459464386
  error estimate for blocks of size 2^( 6) =       0.000465207630
  error estimate for blocks of size 2^( 7) =       0.000468786436

      target function =                  N/A
              le_mean =     -16.905352947188
             les_mean =     286.128203618304
             stat err =       0.000460297285
             autocorr =       1.256494627741
              std dev =       0.580728437333
             le_variance =       0.337245517927


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905352969110        initial  <--
     3.8147e+00     3.8147e+01             4.9704e-05       -16.905352659688
     1.5259e+01     1.5259e+02             1.2996e-05       -16.905352799337
     6.1035e+01     6.1035e+02             3.2864e-06       -16.905352947188

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2518
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.114404e-01 1 1  ON 0
 uu_1                 1.443007e-01 1 1  ON 1
 uu_2                 4.238355e-02 1 1  ON 2
 uu_3                -2.046059e-02 1 1  ON 3
 uu_4                -6.672707e-02 1 1  ON 4
 uu_5                -1.028577e-01 1 1  ON 5
 uu_6                -1.318400e-01 1 1  ON 6
 uu_7                -1.469665e-01 1 1  ON 7
 uu_8                -1.399332e-01 1 1  ON 8
 uu_9                -1.124002e-01 1 1  ON 9
 ud_0                 4.540855e-01 1 1  ON 10
 ud_1                 1.880832e-01 1 1  ON 11
 ud_2                 6.721828e-02 1 1  ON 12
 ud_3                -4.506472e-03 1 1  ON 13
 ud_4                -6.193099e-02 1 1  ON 14
 ud_5                -1.045006e-01 1 1  ON 15
 ud_6                -1.334076e-01 1 1  ON 16
 ud_7                -1.514613e-01 1 1  ON 17
 ud_8                -1.538544e-01 1 1  ON 18
 ud_9                -1.462378e-01 1 1  ON 19
 eO_0                -7.513277e-01 1 1  ON 20
 eO_1                -4.296372e-01 1 1  ON 21
 eO_2                -1.424757e-02 1 1  ON 22
 eO_3                 3.031766e-01 1 1  ON 23
 eO_4                 5.304106e-01 1 1  ON 24
 eO_5                 4.938417e-01 1 1  ON 25
 eO_6                 2.652984e-01 1 1  ON 26
 eO_7                -4.097734e-02 1 1  ON 27
 eO_8                -2.396739e-01 1 1  ON 28
 eO_9                -1.106693e-01 1 1  ON 29
eH1_0                -2.643651e-01 1 1  ON 30
eH1_1                -1.594372e-01 1 1  ON 31
eH1_2                -1.096738e-01 1 1  ON 32
eH1_3                -5.431959e-02 1 1  ON 33
eH1_4                -3.812229e-03 1 1  ON 34
eH1_5                 3.337072e-02 1 1  ON 35
eH1_6                 9.619464e-02 1 1  ON 36
eH1_7                 1.601549e-01 1 1  ON 37
eH1_8                 1.990284e-01 1 1  ON 38
eH1_9                 1.020021e-01 1 1  ON 39
eH2_0                -2.606737e-01 1 1  ON 40
eH2_1                -1.551683e-01 1 1  ON 41
eH2_2                -1.059812e-01 1 1  ON 42
eH2_3                -5.084748e-02 1 1  ON 43
eH2_4                -4.366652e-04 1 1  ON 44
eH2_5                 3.515257e-02 1 1  ON 45
eH2_6                 9.761254e-02 1 1  ON 46
eH2_7                 1.598006e-01 1 1  ON 47
eH2_8                 2.002829e-01 1 1  ON 48
eH2_9                 9.220870e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5348e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8371
    reference variance = 1.36385
====================================================
  Execution time = 2.0305e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3763e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4899e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337585755888
                                         uncertainty =       0.003205781112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337585755888
                                         uncertainty =       0.003205781112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410872734
  error estimate for blocks of size 2^( 2) =       0.000424214934
  error estimate for blocks of size 2^( 3) =       0.000437597477
  error estimate for blocks of size 2^( 4) =       0.000449599704
  error estimate for blocks of size 2^( 5) =       0.000460735444
  error estimate for blocks of size 2^( 6) =       0.000469076999
  error estimate for blocks of size 2^( 7) =       0.000475568472

      target function =                  N/A
              le_mean =     -16.905780299257
             les_mean =     286.143040164661
             stat err =       0.000463745154
             autocorr =       1.273925779765
              std dev =       0.581061792534
             le_variance =       0.337632806743


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690578029926e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905780299257       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905780303828       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905780308150       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905780309556       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905780301413       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905780296872       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905780310926       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905780312583       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 4.107974e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905780299257       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905780300405       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905780301490       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905780301839       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905780299793       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905780298623       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905780302107       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905780302545       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.027729e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905780299257       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905780299544       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905780299816       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905780299903       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905780299390       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905780299096       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905780299965       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905780300075       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 2.569784e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.208311 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5829e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.114413e-01 1 1  ON 0
 uu_1                 1.443005e-01 1 1  ON 1
 uu_2                 4.238338e-02 1 1  ON 2
 uu_3                -2.046050e-02 1 1  ON 3
 uu_4                -6.672682e-02 1 1  ON 4
 uu_5                -1.028578e-01 1 1  ON 5
 uu_6                -1.318401e-01 1 1  ON 6
 uu_7                -1.469675e-01 1 1  ON 7
 uu_8                -1.399340e-01 1 1  ON 8
 uu_9                -1.124004e-01 1 1  ON 9
 ud_0                 4.540863e-01 1 1  ON 10
 ud_1                 1.880839e-01 1 1  ON 11
 ud_2                 6.721805e-02 1 1  ON 12
 ud_3                -4.506510e-03 1 1  ON 13
 ud_4                -6.193166e-02 1 1  ON 14
 ud_5                -1.045001e-01 1 1  ON 15
 ud_6                -1.334071e-01 1 1  ON 16
 ud_7                -1.514623e-01 1 1  ON 17
 ud_8                -1.538546e-01 1 1  ON 18
 ud_9                -1.462379e-01 1 1  ON 19
 eO_0                -7.513271e-01 1 1  ON 20
 eO_1                -4.296381e-01 1 1  ON 21
 eO_2                -1.424713e-02 1 1  ON 22
 eO_3                 3.031767e-01 1 1  ON 23
 eO_4                 5.304111e-01 1 1  ON 24
 eO_5                 4.938426e-01 1 1  ON 25
 eO_6                 2.652986e-01 1 1  ON 26
 eO_7                -4.097777e-02 1 1  ON 27
 eO_8                -2.396745e-01 1 1  ON 28
 eO_9                -1.106699e-01 1 1  ON 29
eH1_0                -2.643651e-01 1 1  ON 30
eH1_1                -1.594369e-01 1 1  ON 31
eH1_2                -1.096747e-01 1 1  ON 32
eH1_3                -5.432008e-02 1 1  ON 33
eH1_4                -3.812755e-03 1 1  ON 34
eH1_5                 3.337017e-02 1 1  ON 35
eH1_6                 9.619484e-02 1 1  ON 36
eH1_7                 1.601552e-01 1 1  ON 37
eH1_8                 1.990288e-01 1 1  ON 38
eH1_9                 1.020031e-01 1 1  ON 39
eH2_0                -2.606738e-01 1 1  ON 40
eH2_1                -1.551685e-01 1 1  ON 41
eH2_2                -1.059812e-01 1 1  ON 42
eH2_3                -5.084793e-02 1 1  ON 43
eH2_4                -4.370820e-04 1 1  ON 44
eH2_5                 3.515270e-02 1 1  ON 45
eH2_6                 9.761192e-02 1 1  ON 46
eH2_7                 1.598008e-01 1 1  ON 47
eH2_8                 2.002833e-01 1 1  ON 48
eH2_9                 9.220957e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8928
    reference variance = 0.224455
====================================================
  Execution time = 2.0053e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4629e-01
  Total weights = 2.0000e+06
  Execution time = 1.8813e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346022234616
                                         uncertainty =       0.005987057091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346022234616
                                         uncertainty =       0.005987057091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416104149
  error estimate for blocks of size 2^( 2) =       0.000429140162
  error estimate for blocks of size 2^( 3) =       0.000443037913
  error estimate for blocks of size 2^( 4) =       0.000456019394
  error estimate for blocks of size 2^( 5) =       0.000468679210
  error estimate for blocks of size 2^( 6) =       0.000481376188
  error estimate for blocks of size 2^( 7) =       0.000488788650

      target function =                  N/A
              le_mean =     -16.905494662146
             les_mean =     286.142034924564
             stat err =       0.000473715860
             autocorr =       1.296079849115
              std dev =       0.588460131057
             le_variance =       0.346285325843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346025346105
                                         uncertainty =       0.005987057132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346025346105
                                         uncertainty =       0.005987057132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416106017
  error estimate for blocks of size 2^( 2) =       0.000429141933
  error estimate for blocks of size 2^( 3) =       0.000443039540
  error estimate for blocks of size 2^( 4) =       0.000456020906
  error estimate for blocks of size 2^( 5) =       0.000468680723
  error estimate for blocks of size 2^( 6) =       0.000481377580
  error estimate for blocks of size 2^( 7) =       0.000488790017

      target function =                  N/A
              le_mean =     -16.905494668553
             les_mean =     286.142038249280
             stat err =       0.000473717306
             autocorr =       1.296076127832
              std dev =       0.588462771943
             le_variance =       0.346288433962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346023796993
                                         uncertainty =       0.005987056866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346023796993
                                         uncertainty =       0.005987056866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416105087
  error estimate for blocks of size 2^( 2) =       0.000429141051
  error estimate for blocks of size 2^( 3) =       0.000443038730
  error estimate for blocks of size 2^( 4) =       0.000456020153
  error estimate for blocks of size 2^( 5) =       0.000468679970
  error estimate for blocks of size 2^( 6) =       0.000481376886
  error estimate for blocks of size 2^( 7) =       0.000488789336

      target function =                  N/A
              le_mean =     -16.905494665450
             les_mean =     286.142036596941
             stat err =       0.000473716586
             autocorr =       1.296077979793
              std dev =       0.588461457115
             le_variance =       0.346286886510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346022430104
                                         uncertainty =       0.005987057055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346022430104
                                         uncertainty =       0.005987057055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416104266
  error estimate for blocks of size 2^( 2) =       0.000429140273
  error estimate for blocks of size 2^( 3) =       0.000443038015
  error estimate for blocks of size 2^( 4) =       0.000456019489
  error estimate for blocks of size 2^( 5) =       0.000468679305
  error estimate for blocks of size 2^( 6) =       0.000481376275
  error estimate for blocks of size 2^( 7) =       0.000488788736

      target function =                  N/A
              le_mean =     -16.905494662560
             les_mean =     286.142035133828
             stat err =       0.000473715951
             autocorr =       1.296079615170
              std dev =       0.588460296975
             le_variance =       0.346285521116


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905494662146        initial
     3.8147e+01     3.8147e+02             4.1080e-06       -16.905494668553  <--
     1.5259e+02     1.5259e+03             1.0277e-06       -16.905494665450
     6.1035e+02     6.1035e+03             2.5698e-07       -16.905494662560

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 2.9505e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.114437e-01 1 1  ON 0
 uu_1                 1.443001e-01 1 1  ON 1
 uu_2                 4.238285e-02 1 1  ON 2
 uu_3                -2.046023e-02 1 1  ON 3
 uu_4                -6.672608e-02 1 1  ON 4
 uu_5                -1.028580e-01 1 1  ON 5
 uu_6                -1.318404e-01 1 1  ON 6
 uu_7                -1.469705e-01 1 1  ON 7
 uu_8                -1.399363e-01 1 1  ON 8
 uu_9                -1.124007e-01 1 1  ON 9
 ud_0                 4.540884e-01 1 1  ON 10
 ud_1                 1.880863e-01 1 1  ON 11
 ud_2                 6.721741e-02 1 1  ON 12
 ud_3                -4.506634e-03 1 1  ON 13
 ud_4                -6.193367e-02 1 1  ON 14
 ud_5                -1.044988e-01 1 1  ON 15
 ud_6                -1.334056e-01 1 1  ON 16
 ud_7                -1.514652e-01 1 1  ON 17
 ud_8                -1.538552e-01 1 1  ON 18
 ud_9                -1.462382e-01 1 1  ON 19
 eO_0                -7.513254e-01 1 1  ON 20
 eO_1                -4.296408e-01 1 1  ON 21
 eO_2                -1.424581e-02 1 1  ON 22
 eO_3                 3.031770e-01 1 1  ON 23
 eO_4                 5.304126e-01 1 1  ON 24
 eO_5                 4.938452e-01 1 1  ON 25
 eO_6                 2.652994e-01 1 1  ON 26
 eO_7                -4.097907e-02 1 1  ON 27
 eO_8                -2.396762e-01 1 1  ON 28
 eO_9                -1.106720e-01 1 1  ON 29
eH1_0                -2.643653e-01 1 1  ON 30
eH1_1                -1.594360e-01 1 1  ON 31
eH1_2                -1.096773e-01 1 1  ON 32
eH1_3                -5.432155e-02 1 1  ON 33
eH1_4                -3.814334e-03 1 1  ON 34
eH1_5                 3.336853e-02 1 1  ON 35
eH1_6                 9.619546e-02 1 1  ON 36
eH1_7                 1.601560e-01 1 1  ON 37
eH1_8                 1.990300e-01 1 1  ON 38
eH1_9                 1.020062e-01 1 1  ON 39
eH2_0                -2.606741e-01 1 1  ON 40
eH2_1                -1.551693e-01 1 1  ON 41
eH2_2                -1.059813e-01 1 1  ON 42
eH2_3                -5.084929e-02 1 1  ON 43
eH2_4                -4.383328e-04 1 1  ON 44
eH2_5                 3.515310e-02 1 1  ON 45
eH2_6                 9.761009e-02 1 1  ON 46
eH2_7                 1.598015e-01 1 1  ON 47
eH2_8                 2.002847e-01 1 1  ON 48
eH2_9                 9.221216e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5343e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8749
    reference variance = 0.166907
====================================================
  Execution time = 2.0480e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3605e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4784e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335910481712
                                         uncertainty =       0.004104864941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335910481712
                                         uncertainty =       0.004104864941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409906573
  error estimate for blocks of size 2^( 2) =       0.000422887176
  error estimate for blocks of size 2^( 3) =       0.000435728535
  error estimate for blocks of size 2^( 4) =       0.000449021451
  error estimate for blocks of size 2^( 5) =       0.000460221952
  error estimate for blocks of size 2^( 6) =       0.000469202075
  error estimate for blocks of size 2^( 7) =       0.000475647827

      target function =                  N/A
              le_mean =     -16.906363414131
             les_mean =     286.161170519689
             stat err =       0.000463523326
             autocorr =       1.278714010959
              std dev =       0.579695434722
             le_variance =       0.336046797038


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690636341413e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906363414131       residual = 9.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906363464999       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906363405891       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906363382150       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906363407458       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906363389158       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906363398032       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906363399565       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.018789e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906363414131       residual = 9.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906363427028       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906363412334       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906363406132       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906363412524       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906363407908       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906363410120       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906363410461       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 5.132225e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906363414131       residual = 9.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906363417367       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906363413699       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906363412132       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906363413734       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906363412577       residual = 7.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906363413130       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906363413212       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.288502e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.210949 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5965e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.114456e-01 1 1  ON 0
 uu_1                 1.442984e-01 1 1  ON 1
 uu_2                 4.238152e-02 1 1  ON 2
 uu_3                -2.046042e-02 1 1  ON 3
 uu_4                -6.672390e-02 1 1  ON 4
 uu_5                -1.028561e-01 1 1  ON 5
 uu_6                -1.318405e-01 1 1  ON 6
 uu_7                -1.469710e-01 1 1  ON 7
 uu_8                -1.399387e-01 1 1  ON 8
 uu_9                -1.124028e-01 1 1  ON 9
 ud_0                 4.540925e-01 1 1  ON 10
 ud_1                 1.880883e-01 1 1  ON 11
 ud_2                 6.721609e-02 1 1  ON 12
 ud_3                -4.505009e-03 1 1  ON 13
 ud_4                -6.193851e-02 1 1  ON 14
 ud_5                -1.045009e-01 1 1  ON 15
 ud_6                -1.334046e-01 1 1  ON 16
 ud_7                -1.514665e-01 1 1  ON 17
 ud_8                -1.538548e-01 1 1  ON 18
 ud_9                -1.462363e-01 1 1  ON 19
 eO_0                -7.513246e-01 1 1  ON 20
 eO_1                -4.296401e-01 1 1  ON 21
 eO_2                -1.424347e-02 1 1  ON 22
 eO_3                 3.031754e-01 1 1  ON 23
 eO_4                 5.304139e-01 1 1  ON 24
 eO_5                 4.938469e-01 1 1  ON 25
 eO_6                 2.653008e-01 1 1  ON 26
 eO_7                -4.097947e-02 1 1  ON 27
 eO_8                -2.396788e-01 1 1  ON 28
 eO_9                -1.106751e-01 1 1  ON 29
eH1_0                -2.643675e-01 1 1  ON 30
eH1_1                -1.594354e-01 1 1  ON 31
eH1_2                -1.096773e-01 1 1  ON 32
eH1_3                -5.432430e-02 1 1  ON 33
eH1_4                -3.816264e-03 1 1  ON 34
eH1_5                 3.336775e-02 1 1  ON 35
eH1_6                 9.619475e-02 1 1  ON 36
eH1_7                 1.601554e-01 1 1  ON 37
eH1_8                 1.990325e-01 1 1  ON 38
eH1_9                 1.020111e-01 1 1  ON 39
eH2_0                -2.606746e-01 1 1  ON 40
eH2_1                -1.551744e-01 1 1  ON 41
eH2_2                -1.059810e-01 1 1  ON 42
eH2_3                -5.084670e-02 1 1  ON 43
eH2_4                -4.422722e-04 1 1  ON 44
eH2_5                 3.515292e-02 1 1  ON 45
eH2_6                 9.761098e-02 1 1  ON 46
eH2_7                 1.598029e-01 1 1  ON 47
eH2_8                 2.002856e-01 1 1  ON 48
eH2_9                 9.221511e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8859
    reference variance = 0.237751
====================================================
  Execution time = 2.0119e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3686e-01
  Total weights = 2.0000e+06
  Execution time = 1.8692e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336767637148
                                         uncertainty =       0.003615816708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336767637148
                                         uncertainty =       0.003615816708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410398058
  error estimate for blocks of size 2^( 2) =       0.000422901372
  error estimate for blocks of size 2^( 3) =       0.000435126951
  error estimate for blocks of size 2^( 4) =       0.000445958276
  error estimate for blocks of size 2^( 5) =       0.000456056426
  error estimate for blocks of size 2^( 6) =       0.000463434512
  error estimate for blocks of size 2^( 7) =       0.000466389688

      target function =                  N/A
              le_mean =     -16.907024776021
             les_mean =     286.184339740180
             stat err =       0.000457959726
             autocorr =       1.245213955790
              std dev =       0.580390499249
             le_variance =       0.336853131619

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336784277908
                                         uncertainty =       0.003616185653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336784277908
                                         uncertainty =       0.003616185653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410408195
  error estimate for blocks of size 2^( 2) =       0.000422910939
  error estimate for blocks of size 2^( 3) =       0.000435135896
  error estimate for blocks of size 2^( 4) =       0.000445966881
  error estimate for blocks of size 2^( 5) =       0.000456064642
  error estimate for blocks of size 2^( 6) =       0.000463442523
  error estimate for blocks of size 2^( 7) =       0.000466397430

      target function =                  N/A
              le_mean =     -16.907024839648
             les_mean =     286.184358533789
             stat err =       0.000457967869
             autocorr =       1.245196722496
              std dev =       0.580404836071
             le_variance =       0.336869773735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336776183678
                                         uncertainty =       0.003616005561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336776183678
                                         uncertainty =       0.003616005561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410403264
  error estimate for blocks of size 2^( 2) =       0.000422906284
  error estimate for blocks of size 2^( 3) =       0.000435131543
  error estimate for blocks of size 2^( 4) =       0.000445962695
  error estimate for blocks of size 2^( 5) =       0.000456060643
  error estimate for blocks of size 2^( 6) =       0.000463438625
  error estimate for blocks of size 2^( 7) =       0.000466393665

      target function =                  N/A
              le_mean =     -16.907024808328
             les_mean =     286.184349379884
             stat err =       0.000457963907
             autocorr =       1.245205097218
              std dev =       0.580397862591
             le_variance =       0.336861678900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336768712541
                                         uncertainty =       0.003615840456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336768712541
                                         uncertainty =       0.003615840456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410398713
  error estimate for blocks of size 2^( 2) =       0.000422901990
  error estimate for blocks of size 2^( 3) =       0.000435127529
  error estimate for blocks of size 2^( 4) =       0.000445958832
  error estimate for blocks of size 2^( 5) =       0.000456056956
  error estimate for blocks of size 2^( 6) =       0.000463435030
  error estimate for blocks of size 2^( 7) =       0.000466390188

      target function =                  N/A
              le_mean =     -16.907024780028
             les_mean =     286.184340951156
             stat err =       0.000457960252
             autocorr =       1.245212840419
              std dev =       0.580391425771
             le_variance =       0.336854207109


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907024776021        initial
     9.5367e+00     9.5367e+01             2.0188e-05       -16.907024839648  <--
     3.8147e+01     3.8147e+02             5.1322e-06       -16.907024808328
     1.5259e+02     1.5259e+03             1.2885e-06       -16.907024780028

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 2.9544e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.114511e-01 1 1  ON 0
 uu_1                 1.442935e-01 1 1  ON 1
 uu_2                 4.237765e-02 1 1  ON 2
 uu_3                -2.046091e-02 1 1  ON 3
 uu_4                -6.671751e-02 1 1  ON 4
 uu_5                -1.028506e-01 1 1  ON 5
 uu_6                -1.318409e-01 1 1  ON 6
 uu_7                -1.469723e-01 1 1  ON 7
 uu_8                -1.399460e-01 1 1  ON 8
 uu_9                -1.124090e-01 1 1  ON 9
 ud_0                 4.541044e-01 1 1  ON 10
 ud_1                 1.880941e-01 1 1  ON 11
 ud_2                 6.721254e-02 1 1  ON 12
 ud_3                -4.500625e-03 1 1  ON 13
 ud_4                -6.195241e-02 1 1  ON 14
 ud_5                -1.045073e-01 1 1  ON 15
 ud_6                -1.334016e-01 1 1  ON 16
 ud_7                -1.514702e-01 1 1  ON 17
 ud_8                -1.538537e-01 1 1  ON 18
 ud_9                -1.462306e-01 1 1  ON 19
 eO_0                -7.513222e-01 1 1  ON 20
 eO_1                -4.296381e-01 1 1  ON 21
 eO_2                -1.423658e-02 1 1  ON 22
 eO_3                 3.031707e-01 1 1  ON 23
 eO_4                 5.304176e-01 1 1  ON 24
 eO_5                 4.938519e-01 1 1  ON 25
 eO_6                 2.653048e-01 1 1  ON 26
 eO_7                -4.098067e-02 1 1  ON 27
 eO_8                -2.396865e-01 1 1  ON 28
 eO_9                -1.106843e-01 1 1  ON 29
eH1_0                -2.643741e-01 1 1  ON 30
eH1_1                -1.594337e-01 1 1  ON 31
eH1_2                -1.096772e-01 1 1  ON 32
eH1_3                -5.433243e-02 1 1  ON 33
eH1_4                -3.822077e-03 1 1  ON 34
eH1_5                 3.336540e-02 1 1  ON 35
eH1_6                 9.619265e-02 1 1  ON 36
eH1_7                 1.601538e-01 1 1  ON 37
eH1_8                 1.990400e-01 1 1  ON 38
eH1_9                 1.020258e-01 1 1  ON 39
eH2_0                -2.606763e-01 1 1  ON 40
eH2_1                -1.551895e-01 1 1  ON 41
eH2_2                -1.059802e-01 1 1  ON 42
eH2_3                -5.083919e-02 1 1  ON 43
eH2_4                -4.538653e-04 1 1  ON 44
eH2_5                 3.515234e-02 1 1  ON 45
eH2_6                 9.761365e-02 1 1  ON 46
eH2_7                 1.598072e-01 1 1  ON 47
eH2_8                 2.002882e-01 1 1  ON 48
eH2_9                 9.222391e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5517e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.846
    reference variance = 0.580258
====================================================
  Execution time = 2.0717e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4387e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6420e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343937693133
                                         uncertainty =       0.009339803921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343937693133
                                         uncertainty =       0.009339803921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414650818
  error estimate for blocks of size 2^( 2) =       0.000427960973
  error estimate for blocks of size 2^( 3) =       0.000441613140
  error estimate for blocks of size 2^( 4) =       0.000453696366
  error estimate for blocks of size 2^( 5) =       0.000464327571
  error estimate for blocks of size 2^( 6) =       0.000472886820
  error estimate for blocks of size 2^( 7) =       0.000476522572

      target function =                  N/A
              le_mean =     -16.905765465004
             les_mean =     286.148776387448
             stat err =       0.000466858332
             autocorr =       1.267666972773
              std dev =       0.586404810396
             le_variance =       0.343870601656


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690576546500e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905765465004       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905765224963       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905765099234       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905765116650       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905765120965       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905765126455       residual = 7.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905765104043       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905765088806       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 8.199118e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905765465004       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905765401758       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905765367883       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905765371650       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905765371501       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905765371640       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905765366015       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905765363849       residual = 3.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.163473e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905765465004       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905765448976       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905765440341       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905765441212       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905765441097       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905765441044       residual = 6.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905765439627       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905765439185       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 5.484875e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213589 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6366e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.114599e-01 1 1  ON 0
 uu_1                 1.442993e-01 1 1  ON 1
 uu_2                 4.237860e-02 1 1  ON 2
 uu_3                -2.047172e-02 1 1  ON 3
 uu_4                -6.671657e-02 1 1  ON 4
 uu_5                -1.028530e-01 1 1  ON 5
 uu_6                -1.318373e-01 1 1  ON 6
 uu_7                -1.469826e-01 1 1  ON 7
 uu_8                -1.399585e-01 1 1  ON 8
 uu_9                -1.124103e-01 1 1  ON 9
 ud_0                 4.541218e-01 1 1  ON 10
 ud_1                 1.881013e-01 1 1  ON 11
 ud_2                 6.721482e-02 1 1  ON 12
 ud_3                -4.502168e-03 1 1  ON 13
 ud_4                -6.196628e-02 1 1  ON 14
 ud_5                -1.045043e-01 1 1  ON 15
 ud_6                -1.333927e-01 1 1  ON 16
 ud_7                -1.514799e-01 1 1  ON 17
 ud_8                -1.538585e-01 1 1  ON 18
 ud_9                -1.462274e-01 1 1  ON 19
 eO_0                -7.513205e-01 1 1  ON 20
 eO_1                -4.296506e-01 1 1  ON 21
 eO_2                -1.421495e-02 1 1  ON 22
 eO_3                 3.031796e-01 1 1  ON 23
 eO_4                 5.304201e-01 1 1  ON 24
 eO_5                 4.938559e-01 1 1  ON 25
 eO_6                 2.653115e-01 1 1  ON 26
 eO_7                -4.098833e-02 1 1  ON 27
 eO_8                -2.396987e-01 1 1  ON 28
 eO_9                -1.106952e-01 1 1  ON 29
eH1_0                -2.643856e-01 1 1  ON 30
eH1_1                -1.594241e-01 1 1  ON 31
eH1_2                -1.096910e-01 1 1  ON 32
eH1_3                -5.432845e-02 1 1  ON 33
eH1_4                -3.822100e-03 1 1  ON 34
eH1_5                 3.335976e-02 1 1  ON 35
eH1_6                 9.618357e-02 1 1  ON 36
eH1_7                 1.601544e-01 1 1  ON 37
eH1_8                 1.990479e-01 1 1  ON 38
eH1_9                 1.020392e-01 1 1  ON 39
eH2_0                -2.606853e-01 1 1  ON 40
eH2_1                -1.551969e-01 1 1  ON 41
eH2_2                -1.059823e-01 1 1  ON 42
eH2_3                -5.084101e-02 1 1  ON 43
eH2_4                -4.622015e-04 1 1  ON 44
eH2_5                 3.515684e-02 1 1  ON 45
eH2_6                 9.761766e-02 1 1  ON 46
eH2_7                 1.598072e-01 1 1  ON 47
eH2_8                 2.002902e-01 1 1  ON 48
eH2_9                 9.223874e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9092
    reference variance = 0.300093
====================================================
  Execution time = 1.9814e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4247e-01
  Total weights = 2.0000e+06
  Execution time = 1.8801e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342395334007
                                         uncertainty =       0.005387922442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342395334007
                                         uncertainty =       0.005387922442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413795676
  error estimate for blocks of size 2^( 2) =       0.000426423499
  error estimate for blocks of size 2^( 3) =       0.000439467749
  error estimate for blocks of size 2^( 4) =       0.000450324367
  error estimate for blocks of size 2^( 5) =       0.000459562877
  error estimate for blocks of size 2^( 6) =       0.000467391911
  error estimate for blocks of size 2^( 7) =       0.000470994500

      target function =                  N/A
              le_mean =     -16.906439147990
             les_mean =     286.170138215605
             stat err =       0.000462068414
             autocorr =       1.246925964182
              std dev =       0.585195456368
             le_variance =       0.342453722154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342455914961
                                         uncertainty =       0.005388416795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342455914961
                                         uncertainty =       0.005388416795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413832278
  error estimate for blocks of size 2^( 2) =       0.000426457550
  error estimate for blocks of size 2^( 3) =       0.000439499171
  error estimate for blocks of size 2^( 4) =       0.000450354772
  error estimate for blocks of size 2^( 5) =       0.000459592018
  error estimate for blocks of size 2^( 6) =       0.000467420438
  error estimate for blocks of size 2^( 7) =       0.000471022545

      target function =                  N/A
              le_mean =     -16.906439133968
             les_mean =     286.170198327979
             stat err =       0.000462097443
             autocorr =       1.246862052134
              std dev =       0.585247220137
             le_variance =       0.342514308678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342427660547
                                         uncertainty =       0.005388175442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342427660547
                                         uncertainty =       0.005388175442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413815207
  error estimate for blocks of size 2^( 2) =       0.000426441658
  error estimate for blocks of size 2^( 3) =       0.000439484504
  error estimate for blocks of size 2^( 4) =       0.000450340595
  error estimate for blocks of size 2^( 5) =       0.000459578415
  error estimate for blocks of size 2^( 6) =       0.000467407136
  error estimate for blocks of size 2^( 7) =       0.000471009433

      target function =                  N/A
              le_mean =     -16.906439134556
             les_mean =     286.170170090459
             stat err =       0.000462083895
             autocorr =       1.246891807188
              std dev =       0.585223078195
             le_variance =       0.342486051252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342399448181
                                         uncertainty =       0.005387954280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342399448181
                                         uncertainty =       0.005387954280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413798161
  error estimate for blocks of size 2^( 2) =       0.000426425809
  error estimate for blocks of size 2^( 3) =       0.000439469880
  error estimate for blocks of size 2^( 4) =       0.000450326432
  error estimate for blocks of size 2^( 5) =       0.000459564853
  error estimate for blocks of size 2^( 6) =       0.000467393848
  error estimate for blocks of size 2^( 7) =       0.000470996397

      target function =                  N/A
              le_mean =     -16.906439145508
             les_mean =     286.170142246160
             stat err =       0.000462070382
             autocorr =       1.246921608662
              std dev =       0.585198971834
             le_variance =       0.342457836636


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906439147990        initial  <--
     2.3842e+00     2.3842e+01             8.1991e-05       -16.906439133968
     9.5367e+00     9.5367e+01             2.1635e-05       -16.906439134556
     3.8147e+01     3.8147e+02             5.4849e-06       -16.906439145508

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2947
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.114511e-01 1 1  ON 0
 uu_1                 1.442935e-01 1 1  ON 1
 uu_2                 4.237765e-02 1 1  ON 2
 uu_3                -2.046091e-02 1 1  ON 3
 uu_4                -6.671751e-02 1 1  ON 4
 uu_5                -1.028506e-01 1 1  ON 5
 uu_6                -1.318409e-01 1 1  ON 6
 uu_7                -1.469723e-01 1 1  ON 7
 uu_8                -1.399460e-01 1 1  ON 8
 uu_9                -1.124090e-01 1 1  ON 9
 ud_0                 4.541044e-01 1 1  ON 10
 ud_1                 1.880941e-01 1 1  ON 11
 ud_2                 6.721254e-02 1 1  ON 12
 ud_3                -4.500625e-03 1 1  ON 13
 ud_4                -6.195241e-02 1 1  ON 14
 ud_5                -1.045073e-01 1 1  ON 15
 ud_6                -1.334016e-01 1 1  ON 16
 ud_7                -1.514702e-01 1 1  ON 17
 ud_8                -1.538537e-01 1 1  ON 18
 ud_9                -1.462306e-01 1 1  ON 19
 eO_0                -7.513222e-01 1 1  ON 20
 eO_1                -4.296381e-01 1 1  ON 21
 eO_2                -1.423658e-02 1 1  ON 22
 eO_3                 3.031707e-01 1 1  ON 23
 eO_4                 5.304176e-01 1 1  ON 24
 eO_5                 4.938519e-01 1 1  ON 25
 eO_6                 2.653048e-01 1 1  ON 26
 eO_7                -4.098067e-02 1 1  ON 27
 eO_8                -2.396865e-01 1 1  ON 28
 eO_9                -1.106843e-01 1 1  ON 29
eH1_0                -2.643741e-01 1 1  ON 30
eH1_1                -1.594337e-01 1 1  ON 31
eH1_2                -1.096772e-01 1 1  ON 32
eH1_3                -5.433243e-02 1 1  ON 33
eH1_4                -3.822077e-03 1 1  ON 34
eH1_5                 3.336540e-02 1 1  ON 35
eH1_6                 9.619265e-02 1 1  ON 36
eH1_7                 1.601538e-01 1 1  ON 37
eH1_8                 1.990400e-01 1 1  ON 38
eH1_9                 1.020258e-01 1 1  ON 39
eH2_0                -2.606763e-01 1 1  ON 40
eH2_1                -1.551895e-01 1 1  ON 41
eH2_2                -1.059802e-01 1 1  ON 42
eH2_3                -5.083919e-02 1 1  ON 43
eH2_4                -4.538653e-04 1 1  ON 44
eH2_5                 3.515234e-02 1 1  ON 45
eH2_6                 9.761365e-02 1 1  ON 46
eH2_7                 1.598072e-01 1 1  ON 47
eH2_8                 2.002882e-01 1 1  ON 48
eH2_9                 9.222391e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5668e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9489
    reference variance = 0.35914
====================================================
  Execution time = 2.0254e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4101e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5426e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341032207003
                                         uncertainty =       0.005551940696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341032207003
                                         uncertainty =       0.005551940696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412924609
  error estimate for blocks of size 2^( 2) =       0.000425375606
  error estimate for blocks of size 2^( 3) =       0.000438403377
  error estimate for blocks of size 2^( 4) =       0.000450934078
  error estimate for blocks of size 2^( 5) =       0.000460655734
  error estimate for blocks of size 2^( 6) =       0.000469650671
  error estimate for blocks of size 2^( 7) =       0.000473589085

      target function =                  N/A
              le_mean =     -16.906453427979
             les_mean =     286.169180807493
             stat err =       0.000463707392
             autocorr =       1.261091228985
              std dev =       0.583963582419
             le_variance =       0.341013465591


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690645342798e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906453427979       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906453437620       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906453443371       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906453455800       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906453458673       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906453465797       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906453462094       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906453462150       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 8.472777e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906453427979       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906453430401       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906453431860       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906453434982       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906453435696       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906453437488       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906453436595       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906453436615       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.120674e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906453427979       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906453428585       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906453428951       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906453429732       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906453429911       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906453430359       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906453430138       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906453430145       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 5.303237e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216234 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5803e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.114516e-01 1 1  ON 0
 uu_1                 1.442930e-01 1 1  ON 1
 uu_2                 4.237694e-02 1 1  ON 2
 uu_3                -2.046094e-02 1 1  ON 3
 uu_4                -6.671792e-02 1 1  ON 4
 uu_5                -1.028504e-01 1 1  ON 5
 uu_6                -1.318400e-01 1 1  ON 6
 uu_7                -1.469730e-01 1 1  ON 7
 uu_8                -1.399465e-01 1 1  ON 8
 uu_9                -1.124093e-01 1 1  ON 9
 ud_0                 4.541049e-01 1 1  ON 10
 ud_1                 1.880949e-01 1 1  ON 11
 ud_2                 6.721286e-02 1 1  ON 12
 ud_3                -4.499932e-03 1 1  ON 13
 ud_4                -6.195322e-02 1 1  ON 14
 ud_5                -1.045076e-01 1 1  ON 15
 ud_6                -1.334012e-01 1 1  ON 16
 ud_7                -1.514701e-01 1 1  ON 17
 ud_8                -1.538551e-01 1 1  ON 18
 ud_9                -1.462307e-01 1 1  ON 19
 eO_0                -7.513224e-01 1 1  ON 20
 eO_1                -4.296379e-01 1 1  ON 21
 eO_2                -1.423592e-02 1 1  ON 22
 eO_3                 3.031715e-01 1 1  ON 23
 eO_4                 5.304180e-01 1 1  ON 24
 eO_5                 4.938530e-01 1 1  ON 25
 eO_6                 2.653053e-01 1 1  ON 26
 eO_7                -4.098149e-02 1 1  ON 27
 eO_8                -2.396877e-01 1 1  ON 28
 eO_9                -1.106853e-01 1 1  ON 29
eH1_0                -2.643747e-01 1 1  ON 30
eH1_1                -1.594324e-01 1 1  ON 31
eH1_2                -1.096786e-01 1 1  ON 32
eH1_3                -5.433331e-02 1 1  ON 33
eH1_4                -3.823946e-03 1 1  ON 34
eH1_5                 3.336430e-02 1 1  ON 35
eH1_6                 9.619296e-02 1 1  ON 36
eH1_7                 1.601553e-01 1 1  ON 37
eH1_8                 1.990406e-01 1 1  ON 38
eH1_9                 1.020274e-01 1 1  ON 39
eH2_0                -2.606752e-01 1 1  ON 40
eH2_1                -1.551897e-01 1 1  ON 41
eH2_2                -1.059800e-01 1 1  ON 42
eH2_3                -5.083942e-02 1 1  ON 43
eH2_4                -4.558243e-04 1 1  ON 44
eH2_5                 3.515226e-02 1 1  ON 45
eH2_6                 9.761254e-02 1 1  ON 46
eH2_7                 1.598062e-01 1 1  ON 47
eH2_8                 2.002889e-01 1 1  ON 48
eH2_9                 9.222603e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.0157
    reference variance = 0.225223
====================================================
  Execution time = 2.0021e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3598e-01
  Total weights = 2.0000e+06
  Execution time = 1.8798e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336020613234
                                         uncertainty =       0.003730279641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336020613234
                                         uncertainty =       0.003730279641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409863017
  error estimate for blocks of size 2^( 2) =       0.000422519951
  error estimate for blocks of size 2^( 3) =       0.000434841116
  error estimate for blocks of size 2^( 4) =       0.000446369549
  error estimate for blocks of size 2^( 5) =       0.000456683305
  error estimate for blocks of size 2^( 6) =       0.000463742442
  error estimate for blocks of size 2^( 7) =       0.000468673448

      target function =                  N/A
              le_mean =     -16.906819721197
             les_mean =     286.176528302022
             stat err =       0.000458867186
             autocorr =       1.253419767245
              std dev =       0.579633836976
             le_variance =       0.335975384967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336022385733
                                         uncertainty =       0.003730258759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336022385733
                                         uncertainty =       0.003730258759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409864099
  error estimate for blocks of size 2^( 2) =       0.000422520986
  error estimate for blocks of size 2^( 3) =       0.000434842053
  error estimate for blocks of size 2^( 4) =       0.000446370508
  error estimate for blocks of size 2^( 5) =       0.000456684131
  error estimate for blocks of size 2^( 6) =       0.000463743345
  error estimate for blocks of size 2^( 7) =       0.000468674440

      target function =                  N/A
              le_mean =     -16.906819737306
             les_mean =     286.176530621843
             stat err =       0.000458868106
             autocorr =       1.253418172129
              std dev =       0.579635368200
             le_variance =       0.335977160069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336021503607
                                         uncertainty =       0.003730269299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336021503607
                                         uncertainty =       0.003730269299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409863561
  error estimate for blocks of size 2^( 2) =       0.000422520471
  error estimate for blocks of size 2^( 3) =       0.000434841586
  error estimate for blocks of size 2^( 4) =       0.000446370031
  error estimate for blocks of size 2^( 5) =       0.000456683720
  error estimate for blocks of size 2^( 6) =       0.000463742896
  error estimate for blocks of size 2^( 7) =       0.000468673947

      target function =                  N/A
              le_mean =     -16.906819729328
             les_mean =     286.176529468673
             stat err =       0.000458867649
             autocorr =       1.253418967572
              std dev =       0.579634606159
             le_variance =       0.335976276657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336020724644
                                         uncertainty =       0.003730278352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336020724644
                                         uncertainty =       0.003730278352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409863085
  error estimate for blocks of size 2^( 2) =       0.000422520016
  error estimate for blocks of size 2^( 3) =       0.000434841175
  error estimate for blocks of size 2^( 4) =       0.000446369609
  error estimate for blocks of size 2^( 5) =       0.000456683357
  error estimate for blocks of size 2^( 6) =       0.000463742499
  error estimate for blocks of size 2^( 7) =       0.000468673511

      target function =                  N/A
              le_mean =     -16.906819722212
             les_mean =     286.176528447936
             stat err =       0.000458867244
             autocorr =       1.253419667197
              std dev =       0.579633933222
             le_variance =       0.335975496543


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906819721197        initial
     2.3842e+01     2.3842e+02             8.4728e-06       -16.906819737306  <--
     9.5367e+01     9.5367e+02             2.1207e-06       -16.906819729328
     3.8147e+02     3.8147e+03             5.3032e-07       -16.906819722212

*****************************************************************************
Applying the update for shift_i =   2.3842e+01     and shift_s =   2.3842e+02
*****************************************************************************

  Execution time = 3.3128e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.114531e-01 1 1  ON 0
 uu_1                 1.442914e-01 1 1  ON 1
 uu_2                 4.237484e-02 1 1  ON 2
 uu_3                -2.046105e-02 1 1  ON 3
 uu_4                -6.671914e-02 1 1  ON 4
 uu_5                -1.028498e-01 1 1  ON 5
 uu_6                -1.318372e-01 1 1  ON 6
 uu_7                -1.469751e-01 1 1  ON 7
 uu_8                -1.399478e-01 1 1  ON 8
 uu_9                -1.124101e-01 1 1  ON 9
 ud_0                 4.541063e-01 1 1  ON 10
 ud_1                 1.880971e-01 1 1  ON 11
 ud_2                 6.721381e-02 1 1  ON 12
 ud_3                -4.497897e-03 1 1  ON 13
 ud_4                -6.195561e-02 1 1  ON 14
 ud_5                -1.045084e-01 1 1  ON 15
 ud_6                -1.334001e-01 1 1  ON 16
 ud_7                -1.514698e-01 1 1  ON 17
 ud_8                -1.538592e-01 1 1  ON 18
 ud_9                -1.462311e-01 1 1  ON 19
 eO_0                -7.513232e-01 1 1  ON 20
 eO_1                -4.296373e-01 1 1  ON 21
 eO_2                -1.423393e-02 1 1  ON 22
 eO_3                 3.031740e-01 1 1  ON 23
 eO_4                 5.304191e-01 1 1  ON 24
 eO_5                 4.938560e-01 1 1  ON 25
 eO_6                 2.653068e-01 1 1  ON 26
 eO_7                -4.098393e-02 1 1  ON 27
 eO_8                -2.396912e-01 1 1  ON 28
 eO_9                -1.106884e-01 1 1  ON 29
eH1_0                -2.643767e-01 1 1  ON 30
eH1_1                -1.594287e-01 1 1  ON 31
eH1_2                -1.096826e-01 1 1  ON 32
eH1_3                -5.433598e-02 1 1  ON 33
eH1_4                -3.829541e-03 1 1  ON 34
eH1_5                 3.336101e-02 1 1  ON 35
eH1_6                 9.619390e-02 1 1  ON 36
eH1_7                 1.601599e-01 1 1  ON 37
eH1_8                 1.990426e-01 1 1  ON 38
eH1_9                 1.020321e-01 1 1  ON 39
eH2_0                -2.606720e-01 1 1  ON 40
eH2_1                -1.551902e-01 1 1  ON 41
eH2_2                -1.059796e-01 1 1  ON 42
eH2_3                -5.084010e-02 1 1  ON 43
eH2_4                -4.616761e-04 1 1  ON 44
eH2_5                 3.515200e-02 1 1  ON 45
eH2_6                 9.760922e-02 1 1  ON 46
eH2_7                 1.598032e-01 1 1  ON 47
eH2_8                 2.002911e-01 1 1  ON 48
eH2_9                 9.223238e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8938e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8298
    reference variance = 0.335895
====================================================
  Execution time = 2.0340e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3879e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6424e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338863636835
                                         uncertainty =       0.004398168498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338863636835
                                         uncertainty =       0.004398168498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411577829
  error estimate for blocks of size 2^( 2) =       0.000424106353
  error estimate for blocks of size 2^( 3) =       0.000436936701
  error estimate for blocks of size 2^( 4) =       0.000448971964
  error estimate for blocks of size 2^( 5) =       0.000459638143
  error estimate for blocks of size 2^( 6) =       0.000467091840
  error estimate for blocks of size 2^( 7) =       0.000469929006

      target function =                  N/A
              le_mean =     -16.906647093888
             les_mean =     286.173508406514
             stat err =       0.000461407738
             autocorr =       1.256798933966
              std dev =       0.582058947722
             le_variance =       0.338792618624


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690664709389e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906647093888       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906647106046       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906647177205       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906647218962       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906647160354       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906647074690       residual = 8.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906647090588       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906647094140       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 3.660293e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906647093888       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906647096989       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906647115409       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906647125820       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906647111647       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906647088946       residual = 7.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906647091998       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906647092680       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 9.406973e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906647093888       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906647094668       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906647099314       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906647101914       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906647098403       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906647092644       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906647093345       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906647093500       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.369483e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.218923 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5989e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.114537e-01 1 1  ON 0
 uu_1                 1.442906e-01 1 1  ON 1
 uu_2                 4.237590e-02 1 1  ON 2
 uu_3                -2.046021e-02 1 1  ON 3
 uu_4                -6.672158e-02 1 1  ON 4
 uu_5                -1.028530e-01 1 1  ON 5
 uu_6                -1.318332e-01 1 1  ON 6
 uu_7                -1.469756e-01 1 1  ON 7
 uu_8                -1.399510e-01 1 1  ON 8
 uu_9                -1.124114e-01 1 1  ON 9
 ud_0                 4.541140e-01 1 1  ON 10
 ud_1                 1.880958e-01 1 1  ON 11
 ud_2                 6.721372e-02 1 1  ON 12
 ud_3                -4.500541e-03 1 1  ON 13
 ud_4                -6.195636e-02 1 1  ON 14
 ud_5                -1.045109e-01 1 1  ON 15
 ud_6                -1.334017e-01 1 1  ON 16
 ud_7                -1.514736e-01 1 1  ON 17
 ud_8                -1.538578e-01 1 1  ON 18
 ud_9                -1.462275e-01 1 1  ON 19
 eO_0                -7.513216e-01 1 1  ON 20
 eO_1                -4.296353e-01 1 1  ON 21
 eO_2                -1.423422e-02 1 1  ON 22
 eO_3                 3.031755e-01 1 1  ON 23
 eO_4                 5.304251e-01 1 1  ON 24
 eO_5                 4.938556e-01 1 1  ON 25
 eO_6                 2.653057e-01 1 1  ON 26
 eO_7                -4.098659e-02 1 1  ON 27
 eO_8                -2.396933e-01 1 1  ON 28
 eO_9                -1.106924e-01 1 1  ON 29
eH1_0                -2.643828e-01 1 1  ON 30
eH1_1                -1.594267e-01 1 1  ON 31
eH1_2                -1.096921e-01 1 1  ON 32
eH1_3                -5.433349e-02 1 1  ON 33
eH1_4                -3.827872e-03 1 1  ON 34
eH1_5                 3.336299e-02 1 1  ON 35
eH1_6                 9.619574e-02 1 1  ON 36
eH1_7                 1.601602e-01 1 1  ON 37
eH1_8                 1.990430e-01 1 1  ON 38
eH1_9                 1.020359e-01 1 1  ON 39
eH2_0                -2.606704e-01 1 1  ON 40
eH2_1                -1.551915e-01 1 1  ON 41
eH2_2                -1.059832e-01 1 1  ON 42
eH2_3                -5.084125e-02 1 1  ON 43
eH2_4                -4.640603e-04 1 1  ON 44
eH2_5                 3.514659e-02 1 1  ON 45
eH2_6                 9.760597e-02 1 1  ON 46
eH2_7                 1.598037e-01 1 1  ON 47
eH2_8                 2.002950e-01 1 1  ON 48
eH2_9                 9.224155e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8425
    reference variance = 0.318811
====================================================
  Execution time = 1.9882e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4233e-01
  Total weights = 2.0000e+06
  Execution time = 1.8850e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342429654795
                                         uncertainty =       0.005523234585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342429654795
                                         uncertainty =       0.005523234585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413717404
  error estimate for blocks of size 2^( 2) =       0.000426491084
  error estimate for blocks of size 2^( 3) =       0.000439276128
  error estimate for blocks of size 2^( 4) =       0.000451160341
  error estimate for blocks of size 2^( 5) =       0.000460071226
  error estimate for blocks of size 2^( 6) =       0.000467263560
  error estimate for blocks of size 2^( 7) =       0.000470914646

      target function =                  N/A
              le_mean =     -16.905779580814
             les_mean =     286.147707244287
             stat err =       0.000462352444
             autocorr =       1.248931827407
              std dev =       0.585084763411
             le_variance =       0.342324180376

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342460334521
                                         uncertainty =       0.005523436210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342460334521
                                         uncertainty =       0.005523436210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413735936
  error estimate for blocks of size 2^( 2) =       0.000426508780
  error estimate for blocks of size 2^( 3) =       0.000439292654
  error estimate for blocks of size 2^( 4) =       0.000451176166
  error estimate for blocks of size 2^( 5) =       0.000460086079
  error estimate for blocks of size 2^( 6) =       0.000467278280
  error estimate for blocks of size 2^( 7) =       0.000470928802

      target function =                  N/A
              le_mean =     -16.905779583200
             les_mean =     286.147737994259
             stat err =       0.000462367332
             autocorr =       1.248900371597
              std dev =       0.585110972123
             le_variance =       0.342354849699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342445698395
                                         uncertainty =       0.005523340678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342445698395
                                         uncertainty =       0.005523340678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413727095
  error estimate for blocks of size 2^( 2) =       0.000426500339
  error estimate for blocks of size 2^( 3) =       0.000439284773
  error estimate for blocks of size 2^( 4) =       0.000451168623
  error estimate for blocks of size 2^( 5) =       0.000460079001
  error estimate for blocks of size 2^( 6) =       0.000467271269
  error estimate for blocks of size 2^( 7) =       0.000470922057

      target function =                  N/A
              le_mean =     -16.905779580700
             les_mean =     286.147723278630
             stat err =       0.000462360237
             autocorr =       1.248915421566
              std dev =       0.585098469125
             le_variance =       0.342340218573

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342431682587
                                         uncertainty =       0.005523248017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342431682587
                                         uncertainty =       0.005523248017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413718629
  error estimate for blocks of size 2^( 2) =       0.000426492254
  error estimate for blocks of size 2^( 3) =       0.000439277221
  error estimate for blocks of size 2^( 4) =       0.000451161388
  error estimate for blocks of size 2^( 5) =       0.000460072209
  error estimate for blocks of size 2^( 6) =       0.000467264535
  error estimate for blocks of size 2^( 7) =       0.000470915583

      target function =                  N/A
              le_mean =     -16.905779580691
             les_mean =     286.147709267219
             stat err =       0.000462353429
             autocorr =       1.248929754672
              std dev =       0.585086495730
             le_variance =       0.342326207486


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905779580814        initial
     5.9605e+00     5.9605e+01             3.6603e-05       -16.905779583200  <--
     2.3842e+01     2.3842e+02             9.4070e-06       -16.905779580700
     9.5367e+01     9.5367e+02             2.3695e-06       -16.905779580691

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 2.9389e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.114553e-01 1 1  ON 0
 uu_1                 1.442882e-01 1 1  ON 1
 uu_2                 4.237887e-02 1 1  ON 2
 uu_3                -2.045798e-02 1 1  ON 3
 uu_4                -6.672855e-02 1 1  ON 4
 uu_5                -1.028623e-01 1 1  ON 5
 uu_6                -1.318215e-01 1 1  ON 6
 uu_7                -1.469768e-01 1 1  ON 7
 uu_8                -1.399606e-01 1 1  ON 8
 uu_9                -1.124152e-01 1 1  ON 9
 ud_0                 4.541360e-01 1 1  ON 10
 ud_1                 1.880926e-01 1 1  ON 11
 ud_2                 6.721345e-02 1 1  ON 12
 ud_3                -4.507962e-03 1 1  ON 13
 ud_4                -6.195885e-02 1 1  ON 14
 ud_5                -1.045181e-01 1 1  ON 15
 ud_6                -1.334065e-01 1 1  ON 16
 ud_7                -1.514849e-01 1 1  ON 17
 ud_8                -1.538536e-01 1 1  ON 18
 ud_9                -1.462169e-01 1 1  ON 19
 eO_0                -7.513169e-01 1 1  ON 20
 eO_1                -4.296296e-01 1 1  ON 21
 eO_2                -1.423480e-02 1 1  ON 22
 eO_3                 3.031800e-01 1 1  ON 23
 eO_4                 5.304430e-01 1 1  ON 24
 eO_5                 4.938542e-01 1 1  ON 25
 eO_6                 2.653025e-01 1 1  ON 26
 eO_7                -4.099448e-02 1 1  ON 27
 eO_8                -2.396995e-01 1 1  ON 28
 eO_9                -1.107042e-01 1 1  ON 29
eH1_0                -2.644011e-01 1 1  ON 30
eH1_1                -1.594214e-01 1 1  ON 31
eH1_2                -1.097192e-01 1 1  ON 32
eH1_3                -5.432657e-02 1 1  ON 33
eH1_4                -3.822786e-03 1 1  ON 34
eH1_5                 3.336893e-02 1 1  ON 35
eH1_6                 9.620124e-02 1 1  ON 36
eH1_7                 1.601613e-01 1 1  ON 37
eH1_8                 1.990442e-01 1 1  ON 38
eH1_9                 1.020470e-01 1 1  ON 39
eH2_0                -2.606659e-01 1 1  ON 40
eH2_1                -1.551952e-01 1 1  ON 41
eH2_2                -1.059937e-01 1 1  ON 42
eH2_3                -5.084485e-02 1 1  ON 43
eH2_4                -4.711383e-04 1 1  ON 44
eH2_5                 3.513041e-02 1 1  ON 45
eH2_6                 9.759626e-02 1 1  ON 46
eH2_7                 1.598052e-01 1 1  ON 47
eH2_8                 2.003067e-01 1 1  ON 48
eH2_9                 9.226898e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5385e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9273
    reference variance = 0.340746
====================================================
  Execution time = 2.0509e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3229e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5897e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331966557019
                                         uncertainty =       0.002386208130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331966557019
                                         uncertainty =       0.002386208130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407610281
  error estimate for blocks of size 2^( 2) =       0.000420476998
  error estimate for blocks of size 2^( 3) =       0.000433325602
  error estimate for blocks of size 2^( 4) =       0.000446021890
  error estimate for blocks of size 2^( 5) =       0.000456575981
  error estimate for blocks of size 2^( 6) =       0.000465737095
  error estimate for blocks of size 2^( 7) =       0.000473425628

      target function =                  N/A
              le_mean =     -16.906343947188
             les_mean =     286.156757776468
             stat err =       0.000460440148
             autocorr =       1.276015976517
              std dev =       0.576447987231
             le_variance =       0.332292281982


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690634394719e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906343947188       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906344143461       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906343544858       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906343373786       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906343368298       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906343385527       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906343488745       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906343515451       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 1.383646e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906343947188       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906344000839       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906343837333       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906343769836       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906343762753       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906343765678       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906343787962       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906343794960       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 3.642889e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906343947188       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906343960922       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906343919112       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906343900109       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906343897844       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906343898430       residual = 6.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906343903565       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906343905391       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 9.572492e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.221580 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6105e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.114741e-01 1 1  ON 0
 uu_1                 1.442851e-01 1 1  ON 1
 uu_2                 4.237917e-02 1 1  ON 2
 uu_3                -2.046869e-02 1 1  ON 3
 uu_4                -6.674250e-02 1 1  ON 4
 uu_5                -1.028486e-01 1 1  ON 5
 uu_6                -1.318184e-01 1 1  ON 6
 uu_7                -1.469767e-01 1 1  ON 7
 uu_8                -1.399742e-01 1 1  ON 8
 uu_9                -1.124241e-01 1 1  ON 9
 ud_0                 4.541724e-01 1 1  ON 10
 ud_1                 1.880857e-01 1 1  ON 11
 ud_2                 6.721413e-02 1 1  ON 12
 ud_3                -4.497126e-03 1 1  ON 13
 ud_4                -6.195945e-02 1 1  ON 14
 ud_5                -1.045083e-01 1 1  ON 15
 ud_6                -1.334085e-01 1 1  ON 16
 ud_7                -1.515139e-01 1 1  ON 17
 ud_8                -1.538535e-01 1 1  ON 18
 ud_9                -1.462190e-01 1 1  ON 19
 eO_0                -7.513129e-01 1 1  ON 20
 eO_1                -4.296232e-01 1 1  ON 21
 eO_2                -1.422869e-02 1 1  ON 22
 eO_3                 3.031876e-01 1 1  ON 23
 eO_4                 5.304469e-01 1 1  ON 24
 eO_5                 4.938641e-01 1 1  ON 25
 eO_6                 2.653083e-01 1 1  ON 26
 eO_7                -4.100425e-02 1 1  ON 27
 eO_8                -2.397115e-01 1 1  ON 28
 eO_9                -1.107222e-01 1 1  ON 29
eH1_0                -2.644061e-01 1 1  ON 30
eH1_1                -1.593972e-01 1 1  ON 31
eH1_2                -1.097110e-01 1 1  ON 32
eH1_3                -5.433818e-02 1 1  ON 33
eH1_4                -3.842512e-03 1 1  ON 34
eH1_5                 3.334951e-02 1 1  ON 35
eH1_6                 9.618964e-02 1 1  ON 36
eH1_7                 1.601586e-01 1 1  ON 37
eH1_8                 1.990532e-01 1 1  ON 38
eH1_9                 1.020719e-01 1 1  ON 39
eH2_0                -2.606652e-01 1 1  ON 40
eH2_1                -1.551917e-01 1 1  ON 41
eH2_2                -1.060090e-01 1 1  ON 42
eH2_3                -5.084677e-02 1 1  ON 43
eH2_4                -5.075672e-04 1 1  ON 44
eH2_5                 3.511867e-02 1 1  ON 45
eH2_6                 9.760630e-02 1 1  ON 46
eH2_7                 1.598209e-01 1 1  ON 47
eH2_8                 2.003172e-01 1 1  ON 48
eH2_9                 9.229498e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9707
    reference variance = 1.91391
====================================================
  Execution time = 2.0079e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3777e-01
  Total weights = 2.0000e+06
  Execution time = 1.8700e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337701935869
                                         uncertainty =       0.003024189131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337701935869
                                         uncertainty =       0.003024189131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410930614
  error estimate for blocks of size 2^( 2) =       0.000423512144
  error estimate for blocks of size 2^( 3) =       0.000437046009
  error estimate for blocks of size 2^( 4) =       0.000450319852
  error estimate for blocks of size 2^( 5) =       0.000461938431
  error estimate for blocks of size 2^( 6) =       0.000471006311
  error estimate for blocks of size 2^( 7) =       0.000478338597

      target function =                  N/A
              le_mean =     -16.906179886922
             les_mean =     286.156646139903
             stat err =       0.000465400797
             autocorr =       1.282676834166
              std dev =       0.581143648151
             le_variance =       0.337727939786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337833317589
                                         uncertainty =       0.003025398753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337833317589
                                         uncertainty =       0.003025398753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411010538
  error estimate for blocks of size 2^( 2) =       0.000423587492
  error estimate for blocks of size 2^( 3) =       0.000437117535
  error estimate for blocks of size 2^( 4) =       0.000450388355
  error estimate for blocks of size 2^( 5) =       0.000462004958
  error estimate for blocks of size 2^( 6) =       0.000471073480
  error estimate for blocks of size 2^( 7) =       0.000478407902

      target function =                  N/A
              le_mean =     -16.906179889111
             les_mean =     286.156777599369
             stat err =       0.000465468674
             autocorr =       1.282552056797
              std dev =       0.581256677668
             le_variance =       0.337859325334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337781741974
                                         uncertainty =       0.003024895921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337781741974
                                         uncertainty =       0.003024895921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410979166
  error estimate for blocks of size 2^( 2) =       0.000423557971
  error estimate for blocks of size 2^( 3) =       0.000437089542
  error estimate for blocks of size 2^( 4) =       0.000450361596
  error estimate for blocks of size 2^( 5) =       0.000461978961
  error estimate for blocks of size 2^( 6) =       0.000471047075
  error estimate for blocks of size 2^( 7) =       0.000478380497

      target function =                  N/A
              le_mean =     -16.906179885090
             les_mean =     286.156725888287
             stat err =       0.000465442032
             autocorr =       1.282601037375
              std dev =       0.581212310753
             le_variance =       0.337807750170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337712455428
                                         uncertainty =       0.003024281385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337712455428
                                         uncertainty =       0.003024281385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410937015
  error estimate for blocks of size 2^( 2) =       0.000423518186
  error estimate for blocks of size 2^( 3) =       0.000437051749
  error estimate for blocks of size 2^( 4) =       0.000450325358
  error estimate for blocks of size 2^( 5) =       0.000461943776
  error estimate for blocks of size 2^( 6) =       0.000471011681
  error estimate for blocks of size 2^( 7) =       0.000478344113

      target function =                  N/A
              le_mean =     -16.906179885063
             les_mean =     286.156656597231
             stat err =       0.000465406232
             autocorr =       1.282666833360
              std dev =       0.581152699380
             le_variance =       0.337738459996


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906179886922        initial
     1.4901e+00     1.4901e+01             1.3836e-04       -16.906179889111  <--
     5.9605e+00     5.9605e+01             3.6429e-05       -16.906179885090
     2.3842e+01     2.3842e+02             9.5725e-06       -16.906179885063

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 2.9479e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237861e-02 1 1  ON 2
 uu_3                -2.049806e-02 1 1  ON 3
 uu_4                -6.677619e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469736e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880756e-01 1 1  ON 11
 ud_2                 6.722074e-02 1 1  ON 12
 ud_3                -4.470057e-03 1 1  ON 13
 ud_4                -6.195227e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538547e-01 1 1  ON 18
 ud_9                -1.462259e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420846e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397469e-01 1 1  ON 28
 eO_9                -1.107748e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436769e-02 1 1  ON 33
eH1_4                -3.900218e-03 1 1  ON 34
eH1_5                 3.329282e-02 1 1  ON 35
eH1_6                 9.615574e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021446e-01 1 1  ON 39
eH2_0                -2.606646e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085491e-02 1 1  ON 43
eH2_4                -6.095030e-04 1 1  ON 44
eH2_5                 3.508372e-02 1 1  ON 45
eH2_6                 9.763621e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237093e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5592e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.7984
    reference variance = 0.24133
====================================================
  Execution time = 2.0371e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6290e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5758e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362598122163
                                         uncertainty =       0.017306369812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362598122163
                                         uncertainty =       0.017306369812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425970115
  error estimate for blocks of size 2^( 2) =       0.000438733285
  error estimate for blocks of size 2^( 3) =       0.000451531283
  error estimate for blocks of size 2^( 4) =       0.000462978793
  error estimate for blocks of size 2^( 5) =       0.000474556415
  error estimate for blocks of size 2^( 6) =       0.000483985778
  error estimate for blocks of size 2^( 7) =       0.000489652783

      target function =                  N/A
              le_mean =     -16.905614196094
             les_mean =     286.162692243920
             stat err =       0.000477793442
             autocorr =       1.258120116439
              std dev =       0.602412714172
             le_variance =       0.362901078196


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690561419609e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905614196094       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905615947793       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905616142263       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905616352368       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905617614152       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905617376294       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905617829108       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905617473824       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905617428779       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e-01 is 6.235000e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905614196094       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905614725411       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905614837683       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905614979729       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905615435078       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905615367213       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905615449727       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905615350786       residual = 5.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 1.557912e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905614196094       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905614335707       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905614374915       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905614420140       residual = 7.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905614548527       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905614537698       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905614553552       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905614528867       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 3.915103e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224520 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5954e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.115407e-01 1 1  ON 0
 uu_1                 1.442224e-01 1 1  ON 1
 uu_2                 4.233959e-02 1 1  ON 2
 uu_3                -2.056659e-02 1 1  ON 3
 uu_4                -6.679428e-02 1 1  ON 4
 uu_5                -1.028102e-01 1 1  ON 5
 uu_6                -1.317910e-01 1 1  ON 6
 uu_7                -1.469979e-01 1 1  ON 7
 uu_8                -1.400500e-01 1 1  ON 8
 uu_9                -1.123610e-01 1 1  ON 9
 ud_0                 4.543115e-01 1 1  ON 10
 ud_1                 1.880994e-01 1 1  ON 11
 ud_2                 6.720117e-02 1 1  ON 12
 ud_3                -4.475573e-03 1 1  ON 13
 ud_4                -6.199707e-02 1 1  ON 14
 ud_5                -1.044963e-01 1 1  ON 15
 ud_6                -1.334343e-01 1 1  ON 16
 ud_7                -1.516403e-01 1 1  ON 17
 ud_8                -1.538554e-01 1 1  ON 18
 ud_9                -1.461586e-01 1 1  ON 19
 eO_0                -7.512712e-01 1 1  ON 20
 eO_1                -4.296569e-01 1 1  ON 21
 eO_2                -1.411795e-02 1 1  ON 22
 eO_3                 3.031976e-01 1 1  ON 23
 eO_4                 5.304841e-01 1 1  ON 24
 eO_5                 4.939238e-01 1 1  ON 25
 eO_6                 2.653415e-01 1 1  ON 26
 eO_7                -4.102611e-02 1 1  ON 27
 eO_8                -2.397970e-01 1 1  ON 28
 eO_9                -1.108509e-01 1 1  ON 29
eH1_0                -2.644789e-01 1 1  ON 30
eH1_1                -1.593555e-01 1 1  ON 31
eH1_2                -1.097340e-01 1 1  ON 32
eH1_3                -5.437598e-02 1 1  ON 33
eH1_4                -3.961232e-03 1 1  ON 34
eH1_5                 3.327246e-02 1 1  ON 35
eH1_6                 9.616320e-02 1 1  ON 36
eH1_7                 1.601735e-01 1 1  ON 37
eH1_8                 1.991568e-01 1 1  ON 38
eH1_9                 1.022470e-01 1 1  ON 39
eH2_0                -2.606630e-01 1 1  ON 40
eH2_1                -1.552253e-01 1 1  ON 41
eH2_2                -1.061347e-01 1 1  ON 42
eH2_3                -5.092233e-02 1 1  ON 43
eH2_4                -6.506914e-04 1 1  ON 44
eH2_5                 3.510694e-02 1 1  ON 45
eH2_6                 9.757996e-02 1 1  ON 46
eH2_7                 1.598553e-01 1 1  ON 47
eH2_8                 2.004311e-01 1 1  ON 48
eH2_9                 9.252672e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9226
    reference variance = 0.228358
====================================================
  Execution time = 2.0003e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3864e-01
  Total weights = 2.0000e+06
  Execution time = 1.8708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338616133519
                                         uncertainty =       0.003270876672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338616133519
                                         uncertainty =       0.003270876672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411439202
  error estimate for blocks of size 2^( 2) =       0.000423780169
  error estimate for blocks of size 2^( 3) =       0.000435896445
  error estimate for blocks of size 2^( 4) =       0.000447414931
  error estimate for blocks of size 2^( 5) =       0.000458387313
  error estimate for blocks of size 2^( 6) =       0.000466072395
  error estimate for blocks of size 2^( 7) =       0.000471280851

      target function =                  N/A
              le_mean =     -16.905886653078
             les_mean =     286.147567791418
             stat err =       0.000460788872
             autocorr =       1.254274599930
              std dev =       0.581862899632
             le_variance =       0.338564433968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338805497298
                                         uncertainty =       0.003273155073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338805497298
                                         uncertainty =       0.003273155073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411554220
  error estimate for blocks of size 2^( 2) =       0.000423888849
  error estimate for blocks of size 2^( 3) =       0.000435999108
  error estimate for blocks of size 2^( 4) =       0.000447511641
  error estimate for blocks of size 2^( 5) =       0.000458479580
  error estimate for blocks of size 2^( 6) =       0.000466159739
  error estimate for blocks of size 2^( 7) =       0.000471370571

      target function =                  N/A
              le_mean =     -16.905885358770
             les_mean =     286.147713345988
             stat err =       0.000460880383
             autocorr =       1.254071586450
              std dev =       0.582025559131
             le_variance =       0.338753751482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338761067450
                                         uncertainty =       0.003272721627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338761067450
                                         uncertainty =       0.003272721627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411527232
  error estimate for blocks of size 2^( 2) =       0.000423863135
  error estimate for blocks of size 2^( 3) =       0.000435974764
  error estimate for blocks of size 2^( 4) =       0.000447488506
  error estimate for blocks of size 2^( 5) =       0.000458457680
  error estimate for blocks of size 2^( 6) =       0.000466139209
  error estimate for blocks of size 2^( 7) =       0.000471350911

      target function =                  N/A
              le_mean =     -16.905885700960
             les_mean =     286.147680489405
             stat err =       0.000460859077
             autocorr =       1.254120113322
              std dev =       0.581987392326
             le_variance =       0.338709324827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338636475536
                                         uncertainty =       0.003271143157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338636475536
                                         uncertainty =       0.003271143157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411451558
  error estimate for blocks of size 2^( 2) =       0.000423791794
  error estimate for blocks of size 2^( 3) =       0.000435907407
  error estimate for blocks of size 2^( 4) =       0.000447425209
  error estimate for blocks of size 2^( 5) =       0.000458397134
  error estimate for blocks of size 2^( 6) =       0.000466081733
  error estimate for blocks of size 2^( 7) =       0.000471290742

      target function =                  N/A
              le_mean =     -16.905886506696
             les_mean =     286.147583176900
             stat err =       0.000460798705
             autocorr =       1.254252793344
              std dev =       0.581880373370
             le_variance =       0.338584768914


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905886653078        initial  <--
     3.7253e-01     3.7253e+00             6.2350e-04       -16.905885358770
     1.4901e+00     1.4901e+01             1.5579e-04       -16.905885700960
     5.9605e+00     5.9605e+01             3.9151e-05       -16.905886506696

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4481
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237861e-02 1 1  ON 2
 uu_3                -2.049806e-02 1 1  ON 3
 uu_4                -6.677619e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469736e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880756e-01 1 1  ON 11
 ud_2                 6.722074e-02 1 1  ON 12
 ud_3                -4.470057e-03 1 1  ON 13
 ud_4                -6.195227e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538547e-01 1 1  ON 18
 ud_9                -1.462259e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420846e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397469e-01 1 1  ON 28
 eO_9                -1.107748e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436769e-02 1 1  ON 33
eH1_4                -3.900218e-03 1 1  ON 34
eH1_5                 3.329282e-02 1 1  ON 35
eH1_6                 9.615574e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021446e-01 1 1  ON 39
eH2_0                -2.606646e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085491e-02 1 1  ON 43
eH2_4                -6.095030e-04 1 1  ON 44
eH2_5                 3.508372e-02 1 1  ON 45
eH2_6                 9.763621e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237093e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5417e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8642
    reference variance = 0.29734
====================================================
  Execution time = 2.0296e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 4.0168e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5250e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.401743777464
                                         uncertainty =       0.064397754228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.401743777464
                                         uncertainty =       0.064397754228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000448154594
  error estimate for blocks of size 2^( 2) =       0.000459455686
  error estimate for blocks of size 2^( 3) =       0.000471639044
  error estimate for blocks of size 2^( 4) =       0.000483389556
  error estimate for blocks of size 2^( 5) =       0.000493156625
  error estimate for blocks of size 2^( 6) =       0.000500134425
  error estimate for blocks of size 2^( 7) =       0.000505361722

      target function =                  N/A
              le_mean =     -16.906452892929
             les_mean =     286.229834299987
             stat err =       0.000495510582
             autocorr =       1.222503642780
              std dev =       0.633786304677
             le_variance =       0.401685079996


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690645289293e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906452892929       residual = 7.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906452911727       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906452833734       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906452816167       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906452854726       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906452873523       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906452891575       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906452912329       residual = 2.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 4.674818e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906452892929       residual = 7.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906452897802       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906452878621       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906452872338       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906452879820       residual = 9.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906452884454       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906452890184       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906452894472       residual = 2.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 1.214925e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906452892929       residual = 7.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906452894159       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906452889391       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906452887708       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906452889398       residual = 8.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906452890562       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906452892123       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906452893065       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 3.068832e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.227209 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5827e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.115326e-01 1 1  ON 0
 uu_1                 1.442815e-01 1 1  ON 1
 uu_2                 4.237433e-02 1 1  ON 2
 uu_3                -2.049715e-02 1 1  ON 3
 uu_4                -6.678253e-02 1 1  ON 4
 uu_5                -1.028106e-01 1 1  ON 5
 uu_6                -1.318107e-01 1 1  ON 6
 uu_7                -1.469802e-01 1 1  ON 7
 uu_8                -1.400186e-01 1 1  ON 8
 uu_9                -1.124545e-01 1 1  ON 9
 ud_0                 4.542613e-01 1 1  ON 10
 ud_1                 1.880806e-01 1 1  ON 11
 ud_2                 6.721948e-02 1 1  ON 12
 ud_3                -4.469310e-03 1 1  ON 13
 ud_4                -6.195459e-02 1 1  ON 14
 ud_5                -1.044837e-01 1 1  ON 15
 ud_6                -1.334078e-01 1 1  ON 16
 ud_7                -1.515993e-01 1 1  ON 17
 ud_8                -1.538499e-01 1 1  ON 18
 ud_9                -1.462229e-01 1 1  ON 19
 eO_0                -7.513053e-01 1 1  ON 20
 eO_1                -4.296048e-01 1 1  ON 21
 eO_2                -1.419631e-02 1 1  ON 22
 eO_3                 3.032079e-01 1 1  ON 23
 eO_4                 5.304601e-01 1 1  ON 24
 eO_5                 4.938980e-01 1 1  ON 25
 eO_6                 2.653283e-01 1 1  ON 26
 eO_7                -4.103443e-02 1 1  ON 27
 eO_8                -2.397532e-01 1 1  ON 28
 eO_9                -1.107828e-01 1 1  ON 29
eH1_0                -2.644262e-01 1 1  ON 30
eH1_1                -1.593252e-01 1 1  ON 31
eH1_2                -1.096912e-01 1 1  ON 32
eH1_3                -5.436780e-02 1 1  ON 33
eH1_4                -3.904766e-03 1 1  ON 34
eH1_5                 3.329093e-02 1 1  ON 35
eH1_6                 9.615395e-02 1 1  ON 36
eH1_7                 1.601472e-01 1 1  ON 37
eH1_8                 1.990833e-01 1 1  ON 38
eH1_9                 1.021552e-01 1 1  ON 39
eH2_0                -2.606704e-01 1 1  ON 40
eH2_1                -1.551892e-01 1 1  ON 41
eH2_2                -1.060589e-01 1 1  ON 42
eH2_3                -5.086221e-02 1 1  ON 43
eH2_4                -6.108634e-04 1 1  ON 44
eH2_5                 3.508732e-02 1 1  ON 45
eH2_6                 9.763590e-02 1 1  ON 46
eH2_7                 1.598735e-01 1 1  ON 47
eH2_8                 2.003557e-01 1 1  ON 48
eH2_9                 9.238079e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9846
    reference variance = 0.354695
====================================================
  Execution time = 2.0089e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4780e-01
  Total weights = 2.0000e+06
  Execution time = 1.8808e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347734376529
                                         uncertainty =       0.005082449086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347734376529
                                         uncertainty =       0.005082449086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417008317
  error estimate for blocks of size 2^( 2) =       0.000429165933
  error estimate for blocks of size 2^( 3) =       0.000442243886
  error estimate for blocks of size 2^( 4) =       0.000454332884
  error estimate for blocks of size 2^( 5) =       0.000463811863
  error estimate for blocks of size 2^( 6) =       0.000471423058
  error estimate for blocks of size 2^( 7) =       0.000474230103

      target function =                  N/A
              le_mean =     -16.906023184104
             les_mean =     286.161411600856
             stat err =       0.000465949477
             autocorr =       1.248499068653
              std dev =       0.589738817860
             le_variance =       0.347791873291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347767140398
                                         uncertainty =       0.005082813402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347767140398
                                         uncertainty =       0.005082813402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417027962
  error estimate for blocks of size 2^( 2) =       0.000429184399
  error estimate for blocks of size 2^( 3) =       0.000442260960
  error estimate for blocks of size 2^( 4) =       0.000454348662
  error estimate for blocks of size 2^( 5) =       0.000463826830
  error estimate for blocks of size 2^( 6) =       0.000471437807
  error estimate for blocks of size 2^( 7) =       0.000474244198

      target function =                  N/A
              le_mean =     -16.906023145286
             les_mean =     286.161443057547
             stat err =       0.000465964374
             autocorr =       1.248461272081
              std dev =       0.589766600025
             le_variance =       0.347824642505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347751438940
                                         uncertainty =       0.005082641925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347751438940
                                         uncertainty =       0.005082641925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417018548
  error estimate for blocks of size 2^( 2) =       0.000429175543
  error estimate for blocks of size 2^( 3) =       0.000442252778
  error estimate for blocks of size 2^( 4) =       0.000454341094
  error estimate for blocks of size 2^( 5) =       0.000463819647
  error estimate for blocks of size 2^( 6) =       0.000471430723
  error estimate for blocks of size 2^( 7) =       0.000474237420

      target function =                  N/A
              le_mean =     -16.906023155259
             les_mean =     286.161427690361
             stat err =       0.000465957221
             autocorr =       1.248479312653
              std dev =       0.589753285802
             le_variance =       0.347808938114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347736531887
                                         uncertainty =       0.005082473596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347736531887
                                         uncertainty =       0.005082473596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417009610
  error estimate for blocks of size 2^( 2) =       0.000429167147
  error estimate for blocks of size 2^( 3) =       0.000442245009
  error estimate for blocks of size 2^( 4) =       0.000454333921
  error estimate for blocks of size 2^( 5) =       0.000463812846
  error estimate for blocks of size 2^( 6) =       0.000471424025
  error estimate for blocks of size 2^( 7) =       0.000474231026

      target function =                  N/A
              le_mean =     -16.906023179983
             les_mean =     286.161413617170
             stat err =       0.000465950454
             autocorr =       1.248496569101
              std dev =       0.589740645486
             le_variance =       0.347794028939


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906023184104        initial  <--
     3.7253e+00     3.7253e+01             4.6748e-05       -16.906023145286
     1.4901e+01     1.4901e+02             1.2149e-05       -16.906023155259
     5.9605e+01     5.9605e+02             3.0688e-06       -16.906023179983

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5820
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237861e-02 1 1  ON 2
 uu_3                -2.049806e-02 1 1  ON 3
 uu_4                -6.677619e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469736e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880756e-01 1 1  ON 11
 ud_2                 6.722074e-02 1 1  ON 12
 ud_3                -4.470057e-03 1 1  ON 13
 ud_4                -6.195227e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538547e-01 1 1  ON 18
 ud_9                -1.462259e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420846e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397469e-01 1 1  ON 28
 eO_9                -1.107748e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436769e-02 1 1  ON 33
eH1_4                -3.900218e-03 1 1  ON 34
eH1_5                 3.329282e-02 1 1  ON 35
eH1_6                 9.615574e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021446e-01 1 1  ON 39
eH2_0                -2.606646e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085491e-02 1 1  ON 43
eH2_4                -6.095030e-04 1 1  ON 44
eH2_5                 3.508372e-02 1 1  ON 45
eH2_6                 9.763621e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237093e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5421e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.7904
    reference variance = 1.08106
====================================================
  Execution time = 2.0452e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3159e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5707e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331563855375
                                         uncertainty =       0.002668307347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331563855375
                                         uncertainty =       0.002668307347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407176453
  error estimate for blocks of size 2^( 2) =       0.000419628915
  error estimate for blocks of size 2^( 3) =       0.000432646487
  error estimate for blocks of size 2^( 4) =       0.000444765003
  error estimate for blocks of size 2^( 5) =       0.000454462784
  error estimate for blocks of size 2^( 6) =       0.000463149875
  error estimate for blocks of size 2^( 7) =       0.000468753273

      target function =                  N/A
              le_mean =     -16.906193351948
             les_mean =     286.150958816241
             stat err =       0.000457782734
             autocorr =       1.264018720276
              std dev =       0.575834462816
             le_variance =       0.331585328567


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690619335195e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906193351948       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906193361819       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906193390760       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906193393620       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906193396539       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906193400071       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906193399910       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906193398201       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 7.277420e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906193351948       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906193354430       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906193361734       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906193362492       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906193363234       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906193364126       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906193364093       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906193363674       residual = 5.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.828003e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906193351948       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906193352570       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906193354400       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906193354592       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906193354778       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906193355002       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906193354995       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906193354890       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 4.575464e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.229866 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6055e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.115242e-01 1 1  ON 0
 uu_1                 1.442748e-01 1 1  ON 1
 uu_2                 4.237820e-02 1 1  ON 2
 uu_3                -2.049821e-02 1 1  ON 3
 uu_4                -6.677563e-02 1 1  ON 4
 uu_5                -1.028149e-01 1 1  ON 5
 uu_6                -1.318070e-01 1 1  ON 6
 uu_7                -1.469747e-01 1 1  ON 7
 uu_8                -1.400138e-01 1 1  ON 8
 uu_9                -1.124500e-01 1 1  ON 9
 ud_0                 4.542579e-01 1 1  ON 10
 ud_1                 1.880764e-01 1 1  ON 11
 ud_2                 6.721977e-02 1 1  ON 12
 ud_3                -4.469699e-03 1 1  ON 13
 ud_4                -6.195251e-02 1 1  ON 14
 ud_5                -1.044851e-01 1 1  ON 15
 ud_6                -1.334103e-01 1 1  ON 16
 ud_7                -1.515927e-01 1 1  ON 17
 ud_8                -1.538544e-01 1 1  ON 18
 ud_9                -1.462260e-01 1 1  ON 19
 eO_0                -7.513046e-01 1 1  ON 20
 eO_1                -4.296045e-01 1 1  ON 21
 eO_2                -1.420663e-02 1 1  ON 22
 eO_3                 3.032102e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938931e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103299e-02 1 1  ON 27
 eO_8                -2.397474e-01 1 1  ON 28
 eO_9                -1.107757e-01 1 1  ON 29
eH1_0                -2.644189e-01 1 1  ON 30
eH1_1                -1.593307e-01 1 1  ON 31
eH1_2                -1.096895e-01 1 1  ON 32
eH1_3                -5.436811e-02 1 1  ON 33
eH1_4                -3.900831e-03 1 1  ON 34
eH1_5                 3.329303e-02 1 1  ON 35
eH1_6                 9.615547e-02 1 1  ON 36
eH1_7                 1.601510e-01 1 1  ON 37
eH1_8                 1.990796e-01 1 1  ON 38
eH1_9                 1.021460e-01 1 1  ON 39
eH2_0                -2.606651e-01 1 1  ON 40
eH2_1                -1.551857e-01 1 1  ON 41
eH2_2                -1.060507e-01 1 1  ON 42
eH2_3                -5.085567e-02 1 1  ON 43
eH2_4                -6.099490e-04 1 1  ON 44
eH2_5                 3.508411e-02 1 1  ON 45
eH2_6                 9.763570e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003484e-01 1 1  ON 48
eH2_9                 9.237209e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8563
    reference variance = 0.415097
====================================================
  Execution time = 2.0114e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3676e-01
  Total weights = 2.0000e+06
  Execution time = 1.8787e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336782844394
                                         uncertainty =       0.004612277238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336782844394
                                         uncertainty =       0.004612277238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410340335
  error estimate for blocks of size 2^( 2) =       0.000423035045
  error estimate for blocks of size 2^( 3) =       0.000436012641
  error estimate for blocks of size 2^( 4) =       0.000449373349
  error estimate for blocks of size 2^( 5) =       0.000461614024
  error estimate for blocks of size 2^( 6) =       0.000470480121
  error estimate for blocks of size 2^( 7) =       0.000477513246

      target function =                  N/A
              le_mean =     -16.906018757824
             les_mean =     286.150228452909
             stat err =       0.000464745185
             autocorr =       1.282748100497
              std dev =       0.580308867232
             le_variance =       0.336758381388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336786909744
                                         uncertainty =       0.004612381646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336786909744
                                         uncertainty =       0.004612381646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410342811
  error estimate for blocks of size 2^( 2) =       0.000423037328
  error estimate for blocks of size 2^( 3) =       0.000436014783
  error estimate for blocks of size 2^( 4) =       0.000449375440
  error estimate for blocks of size 2^( 5) =       0.000461616028
  error estimate for blocks of size 2^( 6) =       0.000470482180
  error estimate for blocks of size 2^( 7) =       0.000477515306

      target function =                  N/A
              le_mean =     -16.906018747650
             les_mean =     286.150232172584
             stat err =       0.000464747239
             autocorr =       1.282743957736
              std dev =       0.580312368533
             le_variance =       0.336762445072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336784887004
                                         uncertainty =       0.004612329824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336784887004
                                         uncertainty =       0.004612329824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410341579
  error estimate for blocks of size 2^( 2) =       0.000423036192
  error estimate for blocks of size 2^( 3) =       0.000436013717
  error estimate for blocks of size 2^( 4) =       0.000449374400
  error estimate for blocks of size 2^( 5) =       0.000461615030
  error estimate for blocks of size 2^( 6) =       0.000470481156
  error estimate for blocks of size 2^( 7) =       0.000477514282

      target function =                  N/A
              le_mean =     -16.906018752685
             les_mean =     286.150230320925
             stat err =       0.000464746217
             autocorr =       1.282746018509
              std dev =       0.580310626438
             le_variance =       0.336760423157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336783100008
                                         uncertainty =       0.004612283824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336783100008
                                         uncertainty =       0.004612283824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410340491
  error estimate for blocks of size 2^( 2) =       0.000423035189
  error estimate for blocks of size 2^( 3) =       0.000436012775
  error estimate for blocks of size 2^( 4) =       0.000449373481
  error estimate for blocks of size 2^( 5) =       0.000461614150
  error estimate for blocks of size 2^( 6) =       0.000470480250
  error estimate for blocks of size 2^( 7) =       0.000477513376

      target function =                  N/A
              le_mean =     -16.906018757178
             les_mean =     286.150228686554
             stat err =       0.000464745314
             autocorr =       1.282747839919
              std dev =       0.580309087380
             le_variance =       0.336758636896


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906018757824        initial  <--
     3.7253e+01     3.7253e+02             7.2774e-06       -16.906018747650
     1.4901e+02     1.4901e+03             1.8280e-06       -16.906018752685
     5.9605e+02     5.9605e+03             4.5755e-07       -16.906018757178

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5849
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237861e-02 1 1  ON 2
 uu_3                -2.049806e-02 1 1  ON 3
 uu_4                -6.677619e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469736e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880756e-01 1 1  ON 11
 ud_2                 6.722074e-02 1 1  ON 12
 ud_3                -4.470057e-03 1 1  ON 13
 ud_4                -6.195227e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538547e-01 1 1  ON 18
 ud_9                -1.462259e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420846e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397469e-01 1 1  ON 28
 eO_9                -1.107748e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436769e-02 1 1  ON 33
eH1_4                -3.900218e-03 1 1  ON 34
eH1_5                 3.329282e-02 1 1  ON 35
eH1_6                 9.615574e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021446e-01 1 1  ON 39
eH2_0                -2.606646e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085491e-02 1 1  ON 43
eH2_4                -6.095030e-04 1 1  ON 44
eH2_5                 3.508372e-02 1 1  ON 45
eH2_6                 9.763621e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237093e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5647e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9401
    reference variance = 0.283867
====================================================
  Execution time = 2.2508e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4199e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4949e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341864979253
                                         uncertainty =       0.003831077743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341864979253
                                         uncertainty =       0.003831077743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413515276
  error estimate for blocks of size 2^( 2) =       0.000426409118
  error estimate for blocks of size 2^( 3) =       0.000439325885
  error estimate for blocks of size 2^( 4) =       0.000452129181
  error estimate for blocks of size 2^( 5) =       0.000463832818
  error estimate for blocks of size 2^( 6) =       0.000472349077
  error estimate for blocks of size 2^( 7) =       0.000478031718

      target function =                  N/A
              le_mean =     -16.905589028775
             les_mean =     286.140930005669
             stat err =       0.000466585699
             autocorr =       1.273150457631
              std dev =       0.584798911443
             le_variance =       0.341989766825


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690558902878e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905589028775       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905589028604       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905589027996       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905589027802       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905589027916       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905589028443       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905589028385       residual = 9.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 5.036187e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905589028775       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905589028732       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905589028580       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905589028532       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905589028560       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905589028692       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905589028678       residual = 9.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.259176e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905589028775       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905589028764       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905589028726       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905589028712       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905589028726       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905589028749       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905589028750       residual = 9.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 3.148021e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.232150 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8010e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237858e-02 1 1  ON 2
 uu_3                -2.049805e-02 1 1  ON 3
 uu_4                -6.677626e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469737e-01 1 1  ON 7
 uu_8                -1.400137e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880757e-01 1 1  ON 11
 ud_2                 6.722068e-02 1 1  ON 12
 ud_3                -4.470077e-03 1 1  ON 13
 ud_4                -6.195229e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334103e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538547e-01 1 1  ON 18
 ud_9                -1.462259e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296052e-01 1 1  ON 21
 eO_2                -1.420835e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304577e-01 1 1  ON 24
 eO_5                 4.938933e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103290e-02 1 1  ON 27
 eO_8                -2.397470e-01 1 1  ON 28
 eO_9                -1.107749e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436768e-02 1 1  ON 33
eH1_4                -3.900236e-03 1 1  ON 34
eH1_5                 3.329273e-02 1 1  ON 35
eH1_6                 9.615567e-02 1 1  ON 36
eH1_7                 1.601510e-01 1 1  ON 37
eH1_8                 1.990793e-01 1 1  ON 38
eH1_9                 1.021447e-01 1 1  ON 39
eH2_0                -2.606647e-01 1 1  ON 40
eH2_1                -1.551855e-01 1 1  ON 41
eH2_2                -1.060509e-01 1 1  ON 42
eH2_3                -5.085496e-02 1 1  ON 43
eH2_4                -6.095776e-04 1 1  ON 44
eH2_5                 3.508371e-02 1 1  ON 45
eH2_6                 9.763626e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237105e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8985
    reference variance = 0.293296
====================================================
  Execution time = 1.9745e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3650e-01
  Total weights = 2.0000e+06
  Execution time = 1.8656e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336434745179
                                         uncertainty =       0.003520730632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336434745179
                                         uncertainty =       0.003520730632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410181661
  error estimate for blocks of size 2^( 2) =       0.000423122317
  error estimate for blocks of size 2^( 3) =       0.000435907653
  error estimate for blocks of size 2^( 4) =       0.000448061170
  error estimate for blocks of size 2^( 5) =       0.000458629267
  error estimate for blocks of size 2^( 6) =       0.000467813364
  error estimate for blocks of size 2^( 7) =       0.000474016323

      target function =                  N/A
              le_mean =     -16.906765289899
             les_mean =     286.175210389086
             stat err =       0.000462130031
             autocorr =       1.269333975221
              std dev =       0.580084467629
             le_variance =       0.336497989585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336434953396
                                         uncertainty =       0.003520734874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336434953396
                                         uncertainty =       0.003520734874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410181788
  error estimate for blocks of size 2^( 2) =       0.000423122435
  error estimate for blocks of size 2^( 3) =       0.000435907763
  error estimate for blocks of size 2^( 4) =       0.000448061277
  error estimate for blocks of size 2^( 5) =       0.000458629378
  error estimate for blocks of size 2^( 6) =       0.000467813459
  error estimate for blocks of size 2^( 7) =       0.000474016418

      target function =                  N/A
              le_mean =     -16.906765289669
             les_mean =     286.175210589358
             stat err =       0.000462130133
             autocorr =       1.269333752250
              std dev =       0.580084646985
             le_variance =       0.336498197668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336434849319
                                         uncertainty =       0.003520732754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336434849319
                                         uncertainty =       0.003520732754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410181724
  error estimate for blocks of size 2^( 2) =       0.000423122376
  error estimate for blocks of size 2^( 3) =       0.000435907708
  error estimate for blocks of size 2^( 4) =       0.000448061223
  error estimate for blocks of size 2^( 5) =       0.000458629322
  error estimate for blocks of size 2^( 6) =       0.000467813412
  error estimate for blocks of size 2^( 7) =       0.000474016370

      target function =                  N/A
              le_mean =     -16.906765289784
             les_mean =     286.175210489258
             stat err =       0.000462130082
             autocorr =       1.269333863696
              std dev =       0.580084557335
             le_variance =       0.336498093658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336434758197
                                         uncertainty =       0.003520730897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336434758197
                                         uncertainty =       0.003520730897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410181669
  error estimate for blocks of size 2^( 2) =       0.000423122324
  error estimate for blocks of size 2^( 3) =       0.000435907660
  error estimate for blocks of size 2^( 4) =       0.000448061176
  error estimate for blocks of size 2^( 5) =       0.000458629274
  error estimate for blocks of size 2^( 6) =       0.000467813370
  error estimate for blocks of size 2^( 7) =       0.000474016329

      target function =                  N/A
              le_mean =     -16.906765289885
             les_mean =     286.175210401608
             stat err =       0.000462130037
             autocorr =       1.269333961282
              std dev =       0.580084478843
             le_variance =       0.336498002595


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906765289899        initial  <--
     3.7253e+02     3.7253e+03             5.0362e-07       -16.906765289669
     1.4901e+03     1.4901e+04             1.2592e-07       -16.906765289784
     5.9605e+03     5.9605e+04             3.1480e-08       -16.906765289885

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1649
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237861e-02 1 1  ON 2
 uu_3                -2.049806e-02 1 1  ON 3
 uu_4                -6.677619e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469736e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880756e-01 1 1  ON 11
 ud_2                 6.722074e-02 1 1  ON 12
 ud_3                -4.470057e-03 1 1  ON 13
 ud_4                -6.195227e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538547e-01 1 1  ON 18
 ud_9                -1.462259e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420846e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397469e-01 1 1  ON 28
 eO_9                -1.107748e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436769e-02 1 1  ON 33
eH1_4                -3.900218e-03 1 1  ON 34
eH1_5                 3.329282e-02 1 1  ON 35
eH1_6                 9.615574e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021446e-01 1 1  ON 39
eH2_0                -2.606646e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085491e-02 1 1  ON 43
eH2_4                -6.095030e-04 1 1  ON 44
eH2_5                 3.508372e-02 1 1  ON 45
eH2_6                 9.763621e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237093e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7204e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8566
    reference variance = 0.169505
====================================================
  Execution time = 2.0483e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4057e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5640e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340627476851
                                         uncertainty =       0.003032469857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340627476851
                                         uncertainty =       0.003032469857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412654696
  error estimate for blocks of size 2^( 2) =       0.000425005470
  error estimate for blocks of size 2^( 3) =       0.000438196038
  error estimate for blocks of size 2^( 4) =       0.000449505995
  error estimate for blocks of size 2^( 5) =       0.000459217548
  error estimate for blocks of size 2^( 6) =       0.000467761226
  error estimate for blocks of size 2^( 7) =       0.000469879790

      target function =                  N/A
              le_mean =     -16.906686008838
             les_mean =     286.176599427106
             stat err =       0.000461591140
             autocorr =       1.251242089743
              std dev =       0.583581867396
             le_variance =       0.340567795953


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690668600884e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906686008838       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906686008948       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906686008949       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906686008943       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906686009045       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906686008917       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906686008991       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906686008994       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 5.027091e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906686008838       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906686008866       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906686008866       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906686008864       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906686008905       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906686008860       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906686008961       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906686008860       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.256814e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906686008838       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906686008845       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906686008845       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906686008848       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906686008853       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906686008822       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906686008806       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906686008865       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 3.142060e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.234840 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6054e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237861e-02 1 1  ON 2
 uu_3                -2.049806e-02 1 1  ON 3
 uu_4                -6.677618e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469736e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880756e-01 1 1  ON 11
 ud_2                 6.722075e-02 1 1  ON 12
 ud_3                -4.470055e-03 1 1  ON 13
 ud_4                -6.195227e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538547e-01 1 1  ON 18
 ud_9                -1.462259e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420845e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397470e-01 1 1  ON 28
 eO_9                -1.107748e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436769e-02 1 1  ON 33
eH1_4                -3.900222e-03 1 1  ON 34
eH1_5                 3.329282e-02 1 1  ON 35
eH1_6                 9.615574e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021446e-01 1 1  ON 39
eH2_0                -2.606646e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085490e-02 1 1  ON 43
eH2_4                -6.095083e-04 1 1  ON 44
eH2_5                 3.508373e-02 1 1  ON 45
eH2_6                 9.763620e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237093e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9488
    reference variance = 0.626569
====================================================
  Execution time = 2.0127e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3462e-01
  Total weights = 2.0000e+06
  Execution time = 1.9057e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334680286688
                                         uncertainty =       0.002820020823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334680286688
                                         uncertainty =       0.002820020823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409035040
  error estimate for blocks of size 2^( 2) =       0.000422560839
  error estimate for blocks of size 2^( 3) =       0.000436051261
  error estimate for blocks of size 2^( 4) =       0.000447831635
  error estimate for blocks of size 2^( 5) =       0.000457807501
  error estimate for blocks of size 2^( 6) =       0.000467078617
  error estimate for blocks of size 2^( 7) =       0.000469717525

      target function =                  N/A
              le_mean =     -16.905726517266
             les_mean =     286.138208236425
             stat err =       0.000460608820
             autocorr =       1.268070714784
              std dev =       0.578462900412
             le_variance =       0.334619327153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334680295448
                                         uncertainty =       0.002820020836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334680295448
                                         uncertainty =       0.002820020836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409035045
  error estimate for blocks of size 2^( 2) =       0.000422560844
  error estimate for blocks of size 2^( 3) =       0.000436051265
  error estimate for blocks of size 2^( 4) =       0.000447831638
  error estimate for blocks of size 2^( 5) =       0.000457807504
  error estimate for blocks of size 2^( 6) =       0.000467078621
  error estimate for blocks of size 2^( 7) =       0.000469717530

      target function =                  N/A
              le_mean =     -16.905726517315
             les_mean =     286.138208246849
             stat err =       0.000460608823
             autocorr =       1.268070701951
              std dev =       0.578462907977
             le_variance =       0.334619335906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334680291068
                                         uncertainty =       0.002820020830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334680291068
                                         uncertainty =       0.002820020830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409035042
  error estimate for blocks of size 2^( 2) =       0.000422560842
  error estimate for blocks of size 2^( 3) =       0.000436051263
  error estimate for blocks of size 2^( 4) =       0.000447831637
  error estimate for blocks of size 2^( 5) =       0.000457807503
  error estimate for blocks of size 2^( 6) =       0.000467078619
  error estimate for blocks of size 2^( 7) =       0.000469717528

      target function =                  N/A
              le_mean =     -16.905726517290
             les_mean =     286.138208241637
             stat err =       0.000460608821
             autocorr =       1.268070708358
              std dev =       0.578462904195
             le_variance =       0.334619331529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334680287235
                                         uncertainty =       0.002820020824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334680287235
                                         uncertainty =       0.002820020824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409035040
  error estimate for blocks of size 2^( 2) =       0.000422560839
  error estimate for blocks of size 2^( 3) =       0.000436051261
  error estimate for blocks of size 2^( 4) =       0.000447831635
  error estimate for blocks of size 2^( 5) =       0.000457807501
  error estimate for blocks of size 2^( 6) =       0.000467078617
  error estimate for blocks of size 2^( 7) =       0.000469717526

      target function =                  N/A
              le_mean =     -16.905726517269
             les_mean =     286.138208237076
             stat err =       0.000460608820
             autocorr =       1.268070713970
              std dev =       0.578462900885
             le_variance =       0.334619327700


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905726517266        initial
     3.7253e+03     3.7253e+04             5.0271e-08       -16.905726517315  <--
     1.4901e+04     1.4901e+05             1.2568e-08       -16.905726517290
     5.9605e+04     5.9605e+05             3.1421e-09       -16.905726517269

*****************************************************************************
Applying the update for shift_i =   3.7253e+03     and shift_s =   3.7253e+04
*****************************************************************************

  Execution time = 2.9629e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237860e-02 1 1  ON 2
 uu_3                -2.049806e-02 1 1  ON 3
 uu_4                -6.677617e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469737e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880757e-01 1 1  ON 11
 ud_2                 6.722077e-02 1 1  ON 12
 ud_3                -4.470047e-03 1 1  ON 13
 ud_4                -6.195226e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538548e-01 1 1  ON 18
 ud_9                -1.462260e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420843e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397470e-01 1 1  ON 28
 eO_9                -1.107748e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436770e-02 1 1  ON 33
eH1_4                -3.900233e-03 1 1  ON 34
eH1_5                 3.329279e-02 1 1  ON 35
eH1_6                 9.615575e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021447e-01 1 1  ON 39
eH2_0                -2.606647e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085487e-02 1 1  ON 43
eH2_4                -6.095243e-04 1 1  ON 44
eH2_5                 3.508374e-02 1 1  ON 45
eH2_6                 9.763619e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237096e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5693e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8565
    reference variance = 0.23485
====================================================
  Execution time = 2.0417e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3983e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4651e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339840176144
                                         uncertainty =       0.006358023719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339840176144
                                         uncertainty =       0.006358023719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412205735
  error estimate for blocks of size 2^( 2) =       0.000424855541
  error estimate for blocks of size 2^( 3) =       0.000437741057
  error estimate for blocks of size 2^( 4) =       0.000450119317
  error estimate for blocks of size 2^( 5) =       0.000460608021
  error estimate for blocks of size 2^( 6) =       0.000469091109
  error estimate for blocks of size 2^( 7) =       0.000474648965

      target function =                  N/A
              le_mean =     -16.905854229948
             les_mean =     286.147734210247
             stat err =       0.000463616853
             autocorr =       1.264999545962
              std dev =       0.582946940893
             le_variance =       0.339827135896


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690585422995e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905854229948       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905854230085       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905854230267       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905854230034       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905854229800       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905854229858       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905854229974       residual = 7.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 1.836261e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905854229948       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905854229983       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905854230028       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905854229968       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905854229912       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905854229924       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905854229954       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 4.590887e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905854229948       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905854229957       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905854229968       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905854229947       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905854229936       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905854229953       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905854229944       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.147736e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.237133 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5888e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237861e-02 1 1  ON 2
 uu_3                -2.049807e-02 1 1  ON 3
 uu_4                -6.677616e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469737e-01 1 1  ON 7
 uu_8                -1.400137e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880757e-01 1 1  ON 11
 ud_2                 6.722078e-02 1 1  ON 12
 ud_3                -4.470027e-03 1 1  ON 13
 ud_4                -6.195225e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538548e-01 1 1  ON 18
 ud_9                -1.462260e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420839e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397470e-01 1 1  ON 28
 eO_9                -1.107749e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436772e-02 1 1  ON 33
eH1_4                -3.900276e-03 1 1  ON 34
eH1_5                 3.329282e-02 1 1  ON 35
eH1_6                 9.615577e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021447e-01 1 1  ON 39
eH2_0                -2.606646e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060509e-01 1 1  ON 42
eH2_3                -5.085487e-02 1 1  ON 43
eH2_4                -6.095468e-04 1 1  ON 44
eH2_5                 3.508372e-02 1 1  ON 45
eH2_6                 9.763617e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237101e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9762
    reference variance = 0.272504
====================================================
  Execution time = 1.9820e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3833e-01
  Total weights = 2.0000e+06
  Execution time = 1.8728e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338347914432
                                         uncertainty =       0.004203040877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338347914432
                                         uncertainty =       0.004203040877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411299115
  error estimate for blocks of size 2^( 2) =       0.000423933104
  error estimate for blocks of size 2^( 3) =       0.000436525125
  error estimate for blocks of size 2^( 4) =       0.000448900839
  error estimate for blocks of size 2^( 5) =       0.000459485298
  error estimate for blocks of size 2^( 6) =       0.000468263289
  error estimate for blocks of size 2^( 7) =       0.000470250265

      target function =                  N/A
              le_mean =     -16.906320348032
             les_mean =     286.162001465431
             stat err =       0.000461724923
             autocorr =       1.260233687357
              std dev =       0.581664786894
             le_variance =       0.338333924312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338347948461
                                         uncertainty =       0.004203042132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338347948461
                                         uncertainty =       0.004203042132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411299136
  error estimate for blocks of size 2^( 2) =       0.000423933122
  error estimate for blocks of size 2^( 3) =       0.000436525140
  error estimate for blocks of size 2^( 4) =       0.000448900852
  error estimate for blocks of size 2^( 5) =       0.000459485310
  error estimate for blocks of size 2^( 6) =       0.000468263302
  error estimate for blocks of size 2^( 7) =       0.000470250275

      target function =                  N/A
              le_mean =     -16.906320347591
             les_mean =     286.162001484495
             stat err =       0.000461724935
             autocorr =       1.260233624062
              std dev =       0.581664816102
             le_variance =       0.338333958291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338347931447
                                         uncertainty =       0.004203041505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338347931447
                                         uncertainty =       0.004203041505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411299126
  error estimate for blocks of size 2^( 2) =       0.000423933113
  error estimate for blocks of size 2^( 3) =       0.000436525133
  error estimate for blocks of size 2^( 4) =       0.000448900845
  error estimate for blocks of size 2^( 5) =       0.000459485304
  error estimate for blocks of size 2^( 6) =       0.000468263295
  error estimate for blocks of size 2^( 7) =       0.000470250270

      target function =                  N/A
              le_mean =     -16.906320347812
             les_mean =     286.162001474962
             stat err =       0.000461724929
             autocorr =       1.260233655695
              std dev =       0.581664801498
             le_variance =       0.338333941302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338347916559
                                         uncertainty =       0.004203040955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338347916559
                                         uncertainty =       0.004203040955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411299116
  error estimate for blocks of size 2^( 2) =       0.000423933105
  error estimate for blocks of size 2^( 3) =       0.000436525126
  error estimate for blocks of size 2^( 4) =       0.000448900840
  error estimate for blocks of size 2^( 5) =       0.000459485299
  error estimate for blocks of size 2^( 6) =       0.000468263290
  error estimate for blocks of size 2^( 7) =       0.000470250266

      target function =                  N/A
              le_mean =     -16.906320348005
             les_mean =     286.162001466623
             stat err =       0.000461724924
             autocorr =       1.260233683406
              std dev =       0.581664788719
             le_variance =       0.338333926436


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906320348032        initial  <--
     9.3132e+02     9.3132e+03             1.8363e-07       -16.906320347591
     3.7253e+03     3.7253e+04             4.5909e-08       -16.906320347812
     1.4901e+04     1.4901e+05             1.1477e-08       -16.906320348005

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2419
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237860e-02 1 1  ON 2
 uu_3                -2.049806e-02 1 1  ON 3
 uu_4                -6.677617e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469737e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880757e-01 1 1  ON 11
 ud_2                 6.722077e-02 1 1  ON 12
 ud_3                -4.470047e-03 1 1  ON 13
 ud_4                -6.195226e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538548e-01 1 1  ON 18
 ud_9                -1.462260e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420843e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397470e-01 1 1  ON 28
 eO_9                -1.107748e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436770e-02 1 1  ON 33
eH1_4                -3.900233e-03 1 1  ON 34
eH1_5                 3.329279e-02 1 1  ON 35
eH1_6                 9.615575e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021447e-01 1 1  ON 39
eH2_0                -2.606647e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085487e-02 1 1  ON 43
eH2_4                -6.095243e-04 1 1  ON 44
eH2_5                 3.508374e-02 1 1  ON 45
eH2_6                 9.763619e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237096e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5138e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8858
    reference variance = 0.878136
====================================================
  Execution time = 2.0102e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4182e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4813e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341747682441
                                         uncertainty =       0.004204877307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341747682441
                                         uncertainty =       0.004204877307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413413606
  error estimate for blocks of size 2^( 2) =       0.000426143686
  error estimate for blocks of size 2^( 3) =       0.000439709542
  error estimate for blocks of size 2^( 4) =       0.000452025420
  error estimate for blocks of size 2^( 5) =       0.000461570162
  error estimate for blocks of size 2^( 6) =       0.000468889908
  error estimate for blocks of size 2^( 7) =       0.000474478975

      target function =                  N/A
              le_mean =     -16.906354253934
             les_mean =     286.166635608370
             stat err =       0.000464241116
             autocorr =       1.261007504367
              std dev =       0.584655128910
             le_variance =       0.341821619760


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690635425393e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906354253934       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906354253954       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906354253913       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906354253912       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906354253929       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906354253929       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906354253936       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 1.922480e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906354253934       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906354253939       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906354253929       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906354253904       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906354253945       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906354253945       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906354253939       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 4.806237e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906354253934       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906354253936       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906354253933       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906354253917       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906354253878       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906354253950       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906354253919       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 1.201562e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.239329 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5589e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237860e-02 1 1  ON 2
 uu_3                -2.049807e-02 1 1  ON 3
 uu_4                -6.677617e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469737e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880757e-01 1 1  ON 11
 ud_2                 6.722077e-02 1 1  ON 12
 ud_3                -4.470047e-03 1 1  ON 13
 ud_4                -6.195226e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538548e-01 1 1  ON 18
 ud_9                -1.462260e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420843e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103287e-02 1 1  ON 27
 eO_8                -2.397470e-01 1 1  ON 28
 eO_9                -1.107749e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436770e-02 1 1  ON 33
eH1_4                -3.900236e-03 1 1  ON 34
eH1_5                 3.329278e-02 1 1  ON 35
eH1_6                 9.615575e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021447e-01 1 1  ON 39
eH2_0                -2.606647e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085487e-02 1 1  ON 43
eH2_4                -6.095267e-04 1 1  ON 44
eH2_5                 3.508374e-02 1 1  ON 45
eH2_6                 9.763619e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237096e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9658
    reference variance = 0.182137
====================================================
  Execution time = 1.9676e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4263e-01
  Total weights = 2.0000e+06
  Execution time = 1.8783e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342280609020
                                         uncertainty =       0.003939686563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342280609020
                                         uncertainty =       0.003939686563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413904892
  error estimate for blocks of size 2^( 2) =       0.000426759606
  error estimate for blocks of size 2^( 3) =       0.000439681897
  error estimate for blocks of size 2^( 4) =       0.000452654724
  error estimate for blocks of size 2^( 5) =       0.000464062951
  error estimate for blocks of size 2^( 6) =       0.000471518098
  error estimate for blocks of size 2^( 7) =       0.000477500998

      target function =                  N/A
              le_mean =     -16.906147287905
             les_mean =     286.160450468165
             stat err =       0.000466434193
             autocorr =       1.269929584058
              std dev =       0.585349911701
             le_variance =       0.342634519128

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342280615612
                                         uncertainty =       0.003939686611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342280615612
                                         uncertainty =       0.003939686611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413904896
  error estimate for blocks of size 2^( 2) =       0.000426759610
  error estimate for blocks of size 2^( 3) =       0.000439681900
  error estimate for blocks of size 2^( 4) =       0.000452654728
  error estimate for blocks of size 2^( 5) =       0.000464062954
  error estimate for blocks of size 2^( 6) =       0.000471518101
  error estimate for blocks of size 2^( 7) =       0.000477501001

      target function =                  N/A
              le_mean =     -16.906147287872
             les_mean =     286.160450473663
             stat err =       0.000466434196
             autocorr =       1.269929576627
              std dev =       0.585349917374
             le_variance =       0.342634525770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342280612316
                                         uncertainty =       0.003939686587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342280612316
                                         uncertainty =       0.003939686587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413904894
  error estimate for blocks of size 2^( 2) =       0.000426759608
  error estimate for blocks of size 2^( 3) =       0.000439681899
  error estimate for blocks of size 2^( 4) =       0.000452654726
  error estimate for blocks of size 2^( 5) =       0.000464062952
  error estimate for blocks of size 2^( 6) =       0.000471518100
  error estimate for blocks of size 2^( 7) =       0.000477500999

      target function =                  N/A
              le_mean =     -16.906147287889
             les_mean =     286.160450470914
             stat err =       0.000466434194
             autocorr =       1.269929580352
              std dev =       0.585349914537
             le_variance =       0.342634522449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342280609432
                                         uncertainty =       0.003939686566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342280609432
                                         uncertainty =       0.003939686566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413904892
  error estimate for blocks of size 2^( 2) =       0.000426759607
  error estimate for blocks of size 2^( 3) =       0.000439681897
  error estimate for blocks of size 2^( 4) =       0.000452654725
  error estimate for blocks of size 2^( 5) =       0.000464062951
  error estimate for blocks of size 2^( 6) =       0.000471518098
  error estimate for blocks of size 2^( 7) =       0.000477500998

      target function =                  N/A
              le_mean =     -16.906147287903
             les_mean =     286.160450468508
             stat err =       0.000466434193
             autocorr =       1.269929583592
              std dev =       0.585349912055
             le_variance =       0.342634519543


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906147287905        initial  <--
     9.3132e+03     9.3132e+04             1.9225e-08       -16.906147287872
     3.7253e+04     3.7253e+05             4.8062e-09       -16.906147287889
     1.4901e+05     1.4901e+06             1.2016e-09       -16.906147287903

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1215
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237860e-02 1 1  ON 2
 uu_3                -2.049806e-02 1 1  ON 3
 uu_4                -6.677617e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469737e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880757e-01 1 1  ON 11
 ud_2                 6.722077e-02 1 1  ON 12
 ud_3                -4.470047e-03 1 1  ON 13
 ud_4                -6.195226e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538548e-01 1 1  ON 18
 ud_9                -1.462260e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420843e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397470e-01 1 1  ON 28
 eO_9                -1.107748e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436770e-02 1 1  ON 33
eH1_4                -3.900233e-03 1 1  ON 34
eH1_5                 3.329279e-02 1 1  ON 35
eH1_6                 9.615575e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021447e-01 1 1  ON 39
eH2_0                -2.606647e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085487e-02 1 1  ON 43
eH2_4                -6.095243e-04 1 1  ON 44
eH2_5                 3.508374e-02 1 1  ON 45
eH2_6                 9.763619e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237096e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4718e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8739
    reference variance = 0.322451
====================================================
  Execution time = 2.0407e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3654e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5499e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336401669436
                                         uncertainty =       0.003185742514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336401669436
                                         uncertainty =       0.003185742514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410210152
  error estimate for blocks of size 2^( 2) =       0.000423162523
  error estimate for blocks of size 2^( 3) =       0.000436622278
  error estimate for blocks of size 2^( 4) =       0.000449097012
  error estimate for blocks of size 2^( 5) =       0.000459628851
  error estimate for blocks of size 2^( 6) =       0.000466926510
  error estimate for blocks of size 2^( 7) =       0.000469698178

      target function =                  N/A
              le_mean =     -16.906645534216
             les_mean =     286.171207789210
             stat err =       0.000461337638
             autocorr =       1.264809055750
              std dev =       0.580124760600
             le_variance =       0.336544737861


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690664553422e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906645534216       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906645534217       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906645534214       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906645534180       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906645534244       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906645534145       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906645534198       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906645534256       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.473000e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906645534216       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906645534216       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906645534215       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906645533841       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906645534365       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906645534222       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906645534137       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906645533634       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 6.182517e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906645534216       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906645534216       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906645534216       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906645534216       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906645534180       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906645534097       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906645534087       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906645533983       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.545630e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.241943 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5985e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237860e-02 1 1  ON 2
 uu_3                -2.049806e-02 1 1  ON 3
 uu_4                -6.677617e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469737e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880757e-01 1 1  ON 11
 ud_2                 6.722077e-02 1 1  ON 12
 ud_3                -4.470047e-03 1 1  ON 13
 ud_4                -6.195226e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538548e-01 1 1  ON 18
 ud_9                -1.462260e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420843e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397470e-01 1 1  ON 28
 eO_9                -1.107748e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436770e-02 1 1  ON 33
eH1_4                -3.900233e-03 1 1  ON 34
eH1_5                 3.329279e-02 1 1  ON 35
eH1_6                 9.615575e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021447e-01 1 1  ON 39
eH2_0                -2.606647e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085487e-02 1 1  ON 43
eH2_4                -6.095242e-04 1 1  ON 44
eH2_5                 3.508374e-02 1 1  ON 45
eH2_6                 9.763619e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237096e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9416
    reference variance = 0.166701
====================================================
  Execution time = 1.9855e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4003e-01
  Total weights = 2.0000e+06
  Execution time = 1.8773e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340108405418
                                         uncertainty =       0.004216408288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340108405418
                                         uncertainty =       0.004216408288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412328291
  error estimate for blocks of size 2^( 2) =       0.000424828813
  error estimate for blocks of size 2^( 3) =       0.000437841682
  error estimate for blocks of size 2^( 4) =       0.000450139351
  error estimate for blocks of size 2^( 5) =       0.000461362422
  error estimate for blocks of size 2^( 6) =       0.000468780076
  error estimate for blocks of size 2^( 7) =       0.000476662265

      target function =                  N/A
              le_mean =     -16.906561389921
             les_mean =     286.171847100593
             stat err =       0.000464236029
             autocorr =       1.267626811428
              std dev =       0.583120261572
             le_variance =       0.340029239456

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340108405051
                                         uncertainty =       0.004216408272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340108405051
                                         uncertainty =       0.004216408272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412328291
  error estimate for blocks of size 2^( 2) =       0.000424828813
  error estimate for blocks of size 2^( 3) =       0.000437841682
  error estimate for blocks of size 2^( 4) =       0.000450139351
  error estimate for blocks of size 2^( 5) =       0.000461362422
  error estimate for blocks of size 2^( 6) =       0.000468780076
  error estimate for blocks of size 2^( 7) =       0.000476662265

      target function =                  N/A
              le_mean =     -16.906561389909
             les_mean =     286.171847099846
             stat err =       0.000464236028
             autocorr =       1.267626811653
              std dev =       0.583120261257
             le_variance =       0.340029239088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340108405234
                                         uncertainty =       0.004216408280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340108405234
                                         uncertainty =       0.004216408280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412328291
  error estimate for blocks of size 2^( 2) =       0.000424828813
  error estimate for blocks of size 2^( 3) =       0.000437841682
  error estimate for blocks of size 2^( 4) =       0.000450139351
  error estimate for blocks of size 2^( 5) =       0.000461362422
  error estimate for blocks of size 2^( 6) =       0.000468780076
  error estimate for blocks of size 2^( 7) =       0.000476662265

      target function =                  N/A
              le_mean =     -16.906561389915
             les_mean =     286.171847100220
             stat err =       0.000464236029
             autocorr =       1.267626811540
              std dev =       0.583120261414
             le_variance =       0.340029239272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340108405395
                                         uncertainty =       0.004216408287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340108405395
                                         uncertainty =       0.004216408287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412328291
  error estimate for blocks of size 2^( 2) =       0.000424828813
  error estimate for blocks of size 2^( 3) =       0.000437841682
  error estimate for blocks of size 2^( 4) =       0.000450139351
  error estimate for blocks of size 2^( 5) =       0.000461362422
  error estimate for blocks of size 2^( 6) =       0.000468780076
  error estimate for blocks of size 2^( 7) =       0.000476662265

      target function =                  N/A
              le_mean =     -16.906561389920
             les_mean =     286.171847100547
             stat err =       0.000464236029
             autocorr =       1.267626811432
              std dev =       0.583120261552
             le_variance =       0.340029239433


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906561389921        initial  <--
     9.3132e+04     9.3132e+05             2.4730e-09       -16.906561389909
     3.7253e+05     3.7253e+06             6.1825e-10       -16.906561389915
     1.4901e+06     1.4901e+07             1.5456e-10       -16.906561389920

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2945
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237860e-02 1 1  ON 2
 uu_3                -2.049806e-02 1 1  ON 3
 uu_4                -6.677617e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469737e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880757e-01 1 1  ON 11
 ud_2                 6.722077e-02 1 1  ON 12
 ud_3                -4.470047e-03 1 1  ON 13
 ud_4                -6.195226e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538548e-01 1 1  ON 18
 ud_9                -1.462260e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420843e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397470e-01 1 1  ON 28
 eO_9                -1.107748e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436770e-02 1 1  ON 33
eH1_4                -3.900233e-03 1 1  ON 34
eH1_5                 3.329279e-02 1 1  ON 35
eH1_6                 9.615575e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021447e-01 1 1  ON 39
eH2_0                -2.606647e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085487e-02 1 1  ON 43
eH2_4                -6.095243e-04 1 1  ON 44
eH2_5                 3.508374e-02 1 1  ON 45
eH2_6                 9.763619e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237096e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5287e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9634
    reference variance = 0.235945
====================================================
  Execution time = 2.0277e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3796e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4958e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337981157380
                                         uncertainty =       0.003803044432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337981157380
                                         uncertainty =       0.003803044432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411072622
  error estimate for blocks of size 2^( 2) =       0.000423856255
  error estimate for blocks of size 2^( 3) =       0.000437127271
  error estimate for blocks of size 2^( 4) =       0.000448918928
  error estimate for blocks of size 2^( 5) =       0.000459221274
  error estimate for blocks of size 2^( 6) =       0.000469022478
  error estimate for blocks of size 2^( 7) =       0.000474272947

      target function =                  N/A
              le_mean =     -16.905167434330
             les_mean =     286.122647214414
             stat err =       0.000462858907
             autocorr =       1.267827433517
              std dev =       0.581344476765
             le_variance =       0.337961400665


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690516743433e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905167434330       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905167434331       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905167434332       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905167434331       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905167434331       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905167432208       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905167434132       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905167435423       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 2.442936e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905167434330       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905167434330       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905167434330       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905167434330       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905167432590       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905167434428       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905167430257       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905167434282       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 6.107348e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905167434330       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905167434330       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905167434330       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905167434330       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905167429133       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905167431023       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905167414532       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905167422357       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 1.526796e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.244641 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5781e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237860e-02 1 1  ON 2
 uu_3                -2.049806e-02 1 1  ON 3
 uu_4                -6.677617e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469737e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880757e-01 1 1  ON 11
 ud_2                 6.722077e-02 1 1  ON 12
 ud_3                -4.470047e-03 1 1  ON 13
 ud_4                -6.195226e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538548e-01 1 1  ON 18
 ud_9                -1.462260e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420843e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397470e-01 1 1  ON 28
 eO_9                -1.107748e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436770e-02 1 1  ON 33
eH1_4                -3.900233e-03 1 1  ON 34
eH1_5                 3.329279e-02 1 1  ON 35
eH1_6                 9.615575e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021447e-01 1 1  ON 39
eH2_0                -2.606647e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085487e-02 1 1  ON 43
eH2_4                -6.095244e-04 1 1  ON 44
eH2_5                 3.508374e-02 1 1  ON 45
eH2_6                 9.763619e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237096e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9279
    reference variance = 0.271091
====================================================
  Execution time = 2.1779e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5102e-01
  Total weights = 2.0000e+06
  Execution time = 1.8789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350980133507
                                         uncertainty =       0.016002278159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350980133507
                                         uncertainty =       0.016002278159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418940426
  error estimate for blocks of size 2^( 2) =       0.000431907824
  error estimate for blocks of size 2^( 3) =       0.000444997285
  error estimate for blocks of size 2^( 4) =       0.000456446855
  error estimate for blocks of size 2^( 5) =       0.000467000021
  error estimate for blocks of size 2^( 6) =       0.000476511318
  error estimate for blocks of size 2^( 7) =       0.000482549791

      target function =                  N/A
              le_mean =     -16.906694297502
             les_mean =     286.187334054477
             stat err =       0.000470626996
             autocorr =       1.261970293250
              std dev =       0.592471232046
             le_variance =       0.351022160803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350980133708
                                         uncertainty =       0.016002278182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350980133708
                                         uncertainty =       0.016002278182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418940426
  error estimate for blocks of size 2^( 2) =       0.000431907824
  error estimate for blocks of size 2^( 3) =       0.000444997285
  error estimate for blocks of size 2^( 4) =       0.000456446855
  error estimate for blocks of size 2^( 5) =       0.000467000021
  error estimate for blocks of size 2^( 6) =       0.000476511318
  error estimate for blocks of size 2^( 7) =       0.000482549792

      target function =                  N/A
              le_mean =     -16.906694297502
             les_mean =     286.187334054684
             stat err =       0.000470626996
             autocorr =       1.261970293083
              std dev =       0.592471232216
             le_variance =       0.351022161003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350980133608
                                         uncertainty =       0.016002278171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350980133608
                                         uncertainty =       0.016002278171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418940426
  error estimate for blocks of size 2^( 2) =       0.000431907824
  error estimate for blocks of size 2^( 3) =       0.000444997285
  error estimate for blocks of size 2^( 4) =       0.000456446855
  error estimate for blocks of size 2^( 5) =       0.000467000021
  error estimate for blocks of size 2^( 6) =       0.000476511318
  error estimate for blocks of size 2^( 7) =       0.000482549792

      target function =                  N/A
              le_mean =     -16.906694297502
             les_mean =     286.187334054580
             stat err =       0.000470626996
             autocorr =       1.261970293167
              std dev =       0.592471232131
             le_variance =       0.351022160903

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350980133520
                                         uncertainty =       0.016002278161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350980133520
                                         uncertainty =       0.016002278161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418940426
  error estimate for blocks of size 2^( 2) =       0.000431907824
  error estimate for blocks of size 2^( 3) =       0.000444997285
  error estimate for blocks of size 2^( 4) =       0.000456446855
  error estimate for blocks of size 2^( 5) =       0.000467000021
  error estimate for blocks of size 2^( 6) =       0.000476511318
  error estimate for blocks of size 2^( 7) =       0.000482549791

      target function =                  N/A
              le_mean =     -16.906694297502
             les_mean =     286.187334054490
             stat err =       0.000470626996
             autocorr =       1.261970293239
              std dev =       0.592471232057
             le_variance =       0.351022160815


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906694297502        initial
     9.3132e+05     9.3132e+06             2.4429e-10       -16.906694297502  <--
     3.7253e+06     3.7253e+07             6.1073e-11       -16.906694297502
     1.4901e+07     1.4901e+08             1.5268e-11       -16.906694297502

*****************************************************************************
Applying the update for shift_i =   9.3132e+05     and shift_s =   9.3132e+06
*****************************************************************************

  Execution time = 3.1229e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237860e-02 1 1  ON 2
 uu_3                -2.049806e-02 1 1  ON 3
 uu_4                -6.677617e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469737e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880757e-01 1 1  ON 11
 ud_2                 6.722077e-02 1 1  ON 12
 ud_3                -4.470047e-03 1 1  ON 13
 ud_4                -6.195226e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538548e-01 1 1  ON 18
 ud_9                -1.462260e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420843e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397470e-01 1 1  ON 28
 eO_9                -1.107748e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436770e-02 1 1  ON 33
eH1_4                -3.900233e-03 1 1  ON 34
eH1_5                 3.329279e-02 1 1  ON 35
eH1_6                 9.615575e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021447e-01 1 1  ON 39
eH2_0                -2.606647e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085487e-02 1 1  ON 43
eH2_4                -6.095245e-04 1 1  ON 44
eH2_5                 3.508374e-02 1 1  ON 45
eH2_6                 9.763619e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237096e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7018e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8687
    reference variance = 0.306581
====================================================
  Execution time = 2.0287e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3476e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5539e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334803718257
                                         uncertainty =       0.003665415951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334803718257
                                         uncertainty =       0.003665415951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409118964
  error estimate for blocks of size 2^( 2) =       0.000421281623
  error estimate for blocks of size 2^( 3) =       0.000434122046
  error estimate for blocks of size 2^( 4) =       0.000446153668
  error estimate for blocks of size 2^( 5) =       0.000455310129
  error estimate for blocks of size 2^( 6) =       0.000460654778
  error estimate for blocks of size 2^( 7) =       0.000463773819

      target function =                  N/A
              le_mean =     -16.906420596295
             les_mean =     286.161813865173
             stat err =       0.000456473099
             autocorr =       1.244890504168
              std dev =       0.578581587770
             le_variance =       0.334756653707


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690642059630e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906420596295       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906420596297       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906420596294       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906420596294       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906420596194       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906420596370       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906420596607       residual = 9.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 7.430245e-10

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906420596295       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906420596296       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906420596295       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906420596207       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906420596295       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906420595946       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906420596171       residual = 9.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 1.857563e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906420596295       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906420596296       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906420596295       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906420595575       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906420597744       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906420597053       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906420595405       residual = 9.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 4.643887e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.246909 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5848e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237860e-02 1 1  ON 2
 uu_3                -2.049806e-02 1 1  ON 3
 uu_4                -6.677617e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469737e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880757e-01 1 1  ON 11
 ud_2                 6.722077e-02 1 1  ON 12
 ud_3                -4.470047e-03 1 1  ON 13
 ud_4                -6.195226e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538548e-01 1 1  ON 18
 ud_9                -1.462260e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420843e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397470e-01 1 1  ON 28
 eO_9                -1.107748e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436770e-02 1 1  ON 33
eH1_4                -3.900233e-03 1 1  ON 34
eH1_5                 3.329279e-02 1 1  ON 35
eH1_6                 9.615575e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021447e-01 1 1  ON 39
eH2_0                -2.606647e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085487e-02 1 1  ON 43
eH2_4                -6.095246e-04 1 1  ON 44
eH2_5                 3.508374e-02 1 1  ON 45
eH2_6                 9.763619e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237096e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9223
    reference variance = 0.228919
====================================================
  Execution time = 1.9829e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4512e-01
  Total weights = 2.0000e+06
  Execution time = 1.8713e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345124599148
                                         uncertainty =       0.007723188815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345124599148
                                         uncertainty =       0.007723188815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415402857
  error estimate for blocks of size 2^( 2) =       0.000428307568
  error estimate for blocks of size 2^( 3) =       0.000441934744
  error estimate for blocks of size 2^( 4) =       0.000454052108
  error estimate for blocks of size 2^( 5) =       0.000464126283
  error estimate for blocks of size 2^( 6) =       0.000472630637
  error estimate for blocks of size 2^( 7) =       0.000478473258

      target function =                  N/A
              le_mean =     -16.906623142634
             les_mean =     286.179024981083
             stat err =       0.000467320571
             autocorr =       1.265583606288
              std dev =       0.587468353700
             le_variance =       0.345119066599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345124599262
                                         uncertainty =       0.007723188837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345124599262
                                         uncertainty =       0.007723188837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415402857
  error estimate for blocks of size 2^( 2) =       0.000428307568
  error estimate for blocks of size 2^( 3) =       0.000441934744
  error estimate for blocks of size 2^( 4) =       0.000454052108
  error estimate for blocks of size 2^( 5) =       0.000464126283
  error estimate for blocks of size 2^( 6) =       0.000472630637
  error estimate for blocks of size 2^( 7) =       0.000478473258

      target function =                  N/A
              le_mean =     -16.906623142633
             les_mean =     286.179024981151
             stat err =       0.000467320571
             autocorr =       1.265583606140
              std dev =       0.587468353796
             le_variance =       0.345119066712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345124599205
                                         uncertainty =       0.007723188826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345124599205
                                         uncertainty =       0.007723188826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415402857
  error estimate for blocks of size 2^( 2) =       0.000428307568
  error estimate for blocks of size 2^( 3) =       0.000441934744
  error estimate for blocks of size 2^( 4) =       0.000454052108
  error estimate for blocks of size 2^( 5) =       0.000464126283
  error estimate for blocks of size 2^( 6) =       0.000472630637
  error estimate for blocks of size 2^( 7) =       0.000478473258

      target function =                  N/A
              le_mean =     -16.906623142633
             les_mean =     286.179024981117
             stat err =       0.000467320571
             autocorr =       1.265583606218
              std dev =       0.587468353748
             le_variance =       0.345119066655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345124599155
                                         uncertainty =       0.007723188817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345124599155
                                         uncertainty =       0.007723188817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415402857
  error estimate for blocks of size 2^( 2) =       0.000428307568
  error estimate for blocks of size 2^( 3) =       0.000441934744
  error estimate for blocks of size 2^( 4) =       0.000454052108
  error estimate for blocks of size 2^( 5) =       0.000464126283
  error estimate for blocks of size 2^( 6) =       0.000472630637
  error estimate for blocks of size 2^( 7) =       0.000478473258

      target function =                  N/A
              le_mean =     -16.906623142634
             les_mean =     286.179024981087
             stat err =       0.000467320571
             autocorr =       1.265583606272
              std dev =       0.587468353706
             le_variance =       0.345119066606


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906623142634        initial  <--
     2.3283e+05     2.3283e+06             7.4302e-10       -16.906623142633
     9.3132e+05     9.3132e+06             1.8576e-10       -16.906623142633
     3.7253e+06     3.7253e+07             4.6439e-11       -16.906623142634

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2507
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237860e-02 1 1  ON 2
 uu_3                -2.049806e-02 1 1  ON 3
 uu_4                -6.677617e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469737e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880757e-01 1 1  ON 11
 ud_2                 6.722077e-02 1 1  ON 12
 ud_3                -4.470047e-03 1 1  ON 13
 ud_4                -6.195226e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538548e-01 1 1  ON 18
 ud_9                -1.462260e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420843e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397470e-01 1 1  ON 28
 eO_9                -1.107748e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436770e-02 1 1  ON 33
eH1_4                -3.900233e-03 1 1  ON 34
eH1_5                 3.329279e-02 1 1  ON 35
eH1_6                 9.615575e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021447e-01 1 1  ON 39
eH2_0                -2.606647e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085487e-02 1 1  ON 43
eH2_4                -6.095245e-04 1 1  ON 44
eH2_5                 3.508374e-02 1 1  ON 45
eH2_6                 9.763619e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237096e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5131e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9467
    reference variance = 0.260322
====================================================
  Execution time = 2.0201e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3625e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5615e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336230008153
                                         uncertainty =       0.002113685450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336230008153
                                         uncertainty =       0.002113685450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410032459
  error estimate for blocks of size 2^( 2) =       0.000422456546
  error estimate for blocks of size 2^( 3) =       0.000435155057
  error estimate for blocks of size 2^( 4) =       0.000447146885
  error estimate for blocks of size 2^( 5) =       0.000456070012
  error estimate for blocks of size 2^( 6) =       0.000463448582
  error estimate for blocks of size 2^( 7) =       0.000468324407

      target function =                  N/A
              le_mean =     -16.906221957864
             les_mean =     286.156593955169
             stat err =       0.000458747471
             autocorr =       1.251730663981
              std dev =       0.579873464416
             le_variance =       0.336253234733


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690622195786e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906221957864       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906221957864       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906221957864       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906221958680       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906221957539       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906221956917       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906221958343       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906221957167       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 1.118662e-10

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906221957864       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906221957864       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906221957864       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906221957864       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906221956244       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906221957864       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906221958102       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906221957120       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 2.796657e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906221957864       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906221957864       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906221957864       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906221957864       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906221945729       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906221977493       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906221954899       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906221950621       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 6.991649e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.249524 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5770e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237860e-02 1 1  ON 2
 uu_3                -2.049806e-02 1 1  ON 3
 uu_4                -6.677617e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469737e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880757e-01 1 1  ON 11
 ud_2                 6.722077e-02 1 1  ON 12
 ud_3                -4.470047e-03 1 1  ON 13
 ud_4                -6.195226e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538548e-01 1 1  ON 18
 ud_9                -1.462260e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420843e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397470e-01 1 1  ON 28
 eO_9                -1.107748e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436770e-02 1 1  ON 33
eH1_4                -3.900233e-03 1 1  ON 34
eH1_5                 3.329279e-02 1 1  ON 35
eH1_6                 9.615575e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021447e-01 1 1  ON 39
eH2_0                -2.606647e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085487e-02 1 1  ON 43
eH2_4                -6.095245e-04 1 1  ON 44
eH2_5                 3.508374e-02 1 1  ON 45
eH2_6                 9.763619e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237096e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8482
    reference variance = 0.190143
====================================================
  Execution time = 2.0175e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3566e-01
  Total weights = 2.0000e+06
  Execution time = 1.8719e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335685114789
                                         uncertainty =       0.003614544743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335685114789
                                         uncertainty =       0.003614544743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409672435
  error estimate for blocks of size 2^( 2) =       0.000422018016
  error estimate for blocks of size 2^( 3) =       0.000434887637
  error estimate for blocks of size 2^( 4) =       0.000447703727
  error estimate for blocks of size 2^( 5) =       0.000458178094
  error estimate for blocks of size 2^( 6) =       0.000466390862
  error estimate for blocks of size 2^( 7) =       0.000472211765

      target function =                  N/A
              le_mean =     -16.905839050941
             les_mean =     286.143056856494
             stat err =       0.000461121112
             autocorr =       1.266941395047
              std dev =       0.579364313700
             le_variance =       0.335663007989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335685114785
                                         uncertainty =       0.003614544743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335685114785
                                         uncertainty =       0.003614544743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409672435
  error estimate for blocks of size 2^( 2) =       0.000422018016
  error estimate for blocks of size 2^( 3) =       0.000434887637
  error estimate for blocks of size 2^( 4) =       0.000447703727
  error estimate for blocks of size 2^( 5) =       0.000458178094
  error estimate for blocks of size 2^( 6) =       0.000466390862
  error estimate for blocks of size 2^( 7) =       0.000472211765

      target function =                  N/A
              le_mean =     -16.905839050942
             les_mean =     286.143056856499
             stat err =       0.000461121112
             autocorr =       1.266941395017
              std dev =       0.579364313697
             le_variance =       0.335663007985

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335685114787
                                         uncertainty =       0.003614544743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335685114787
                                         uncertainty =       0.003614544743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409672435
  error estimate for blocks of size 2^( 2) =       0.000422018016
  error estimate for blocks of size 2^( 3) =       0.000434887637
  error estimate for blocks of size 2^( 4) =       0.000447703727
  error estimate for blocks of size 2^( 5) =       0.000458178094
  error estimate for blocks of size 2^( 6) =       0.000466390862
  error estimate for blocks of size 2^( 7) =       0.000472211765

      target function =                  N/A
              le_mean =     -16.905839050942
             les_mean =     286.143056856496
             stat err =       0.000461121112
             autocorr =       1.266941395034
              std dev =       0.579364313698
             le_variance =       0.335663007987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335685114789
                                         uncertainty =       0.003614544743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335685114789
                                         uncertainty =       0.003614544743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409672435
  error estimate for blocks of size 2^( 2) =       0.000422018016
  error estimate for blocks of size 2^( 3) =       0.000434887637
  error estimate for blocks of size 2^( 4) =       0.000447703727
  error estimate for blocks of size 2^( 5) =       0.000458178094
  error estimate for blocks of size 2^( 6) =       0.000466390862
  error estimate for blocks of size 2^( 7) =       0.000472211765

      target function =                  N/A
              le_mean =     -16.905839050941
             les_mean =     286.143056856494
             stat err =       0.000461121112
             autocorr =       1.266941395041
              std dev =       0.579364313700
             le_variance =       0.335663007989


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905839050941        initial
     2.3283e+06     2.3283e+07             1.1187e-10       -16.905839050942  <--
     9.3132e+06     9.3132e+07             2.7967e-11       -16.905839050942
     3.7253e+07     3.7253e+08             6.9916e-12       -16.905839050941

*****************************************************************************
Applying the update for shift_i =   2.3283e+06     and shift_s =   2.3283e+07
*****************************************************************************

  Execution time = 2.9602e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237860e-02 1 1  ON 2
 uu_3                -2.049806e-02 1 1  ON 3
 uu_4                -6.677617e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469737e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880757e-01 1 1  ON 11
 ud_2                 6.722077e-02 1 1  ON 12
 ud_3                -4.470047e-03 1 1  ON 13
 ud_4                -6.195226e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538548e-01 1 1  ON 18
 ud_9                -1.462260e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420843e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397470e-01 1 1  ON 28
 eO_9                -1.107748e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436770e-02 1 1  ON 33
eH1_4                -3.900233e-03 1 1  ON 34
eH1_5                 3.329279e-02 1 1  ON 35
eH1_6                 9.615575e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021447e-01 1 1  ON 39
eH2_0                -2.606647e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085487e-02 1 1  ON 43
eH2_4                -6.095245e-04 1 1  ON 44
eH2_5                 3.508374e-02 1 1  ON 45
eH2_6                 9.763619e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237096e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5379e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8435
    reference variance = 0.297461
====================================================
  Execution time = 2.0034e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3710e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5860e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337065836361
                                         uncertainty =       0.003371993691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337065836361
                                         uncertainty =       0.003371993691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410550888
  error estimate for blocks of size 2^( 2) =       0.000423369920
  error estimate for blocks of size 2^( 3) =       0.000436417319
  error estimate for blocks of size 2^( 4) =       0.000448064449
  error estimate for blocks of size 2^( 5) =       0.000458515991
  error estimate for blocks of size 2^( 6) =       0.000465843688
  error estimate for blocks of size 2^( 7) =       0.000468716821

      target function =                  N/A
              le_mean =     -16.905695955269
             les_mean =     286.139659626743
             stat err =       0.000460285237
             autocorr =       1.256956070892
              std dev =       0.580606633862
             le_variance =       0.337104063284


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690569595527e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905695955269       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905695955271       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905695955271       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905695955281       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905695954811       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905695955209       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905695955597       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905695955871       residual = 5.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 3.539732e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905695955269       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905695955270       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905695955270       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905695955270       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905695955497       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905695956636       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905695955607       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905695955814       residual = 5.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 8.849314e-11

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905695955269       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905695955269       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905695955269       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905695955270       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905695955270       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905695955171       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905695957372       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905695955758       residual = 5.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 2.212311e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.252130 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5627e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237860e-02 1 1  ON 2
 uu_3                -2.049806e-02 1 1  ON 3
 uu_4                -6.677617e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469737e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880757e-01 1 1  ON 11
 ud_2                 6.722077e-02 1 1  ON 12
 ud_3                -4.470047e-03 1 1  ON 13
 ud_4                -6.195226e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538548e-01 1 1  ON 18
 ud_9                -1.462260e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420843e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397470e-01 1 1  ON 28
 eO_9                -1.107748e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436770e-02 1 1  ON 33
eH1_4                -3.900233e-03 1 1  ON 34
eH1_5                 3.329279e-02 1 1  ON 35
eH1_6                 9.615575e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021447e-01 1 1  ON 39
eH2_0                -2.606647e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085487e-02 1 1  ON 43
eH2_4                -6.095245e-04 1 1  ON 44
eH2_5                 3.508374e-02 1 1  ON 45
eH2_6                 9.763619e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237096e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.987
    reference variance = 0.314936
====================================================
  Execution time = 1.9925e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3247e-01
  Total weights = 2.0000e+06
  Execution time = 1.8750e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332510990281
                                         uncertainty =       0.003016293327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332510990281
                                         uncertainty =       0.003016293327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407718406
  error estimate for blocks of size 2^( 2) =       0.000420325942
  error estimate for blocks of size 2^( 3) =       0.000433029747
  error estimate for blocks of size 2^( 4) =       0.000443860160
  error estimate for blocks of size 2^( 5) =       0.000453100889
  error estimate for blocks of size 2^( 6) =       0.000462105636
  error estimate for blocks of size 2^( 7) =       0.000465034333

      target function =                  N/A
              le_mean =     -16.906424424521
             les_mean =     286.159655253749
             stat err =       0.000456025255
             autocorr =       1.250999548209
              std dev =       0.576600900063
             le_variance =       0.332468597954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332510990224
                                         uncertainty =       0.003016293325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332510990224
                                         uncertainty =       0.003016293325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407718406
  error estimate for blocks of size 2^( 2) =       0.000420325942
  error estimate for blocks of size 2^( 3) =       0.000433029747
  error estimate for blocks of size 2^( 4) =       0.000443860160
  error estimate for blocks of size 2^( 5) =       0.000453100889
  error estimate for blocks of size 2^( 6) =       0.000462105636
  error estimate for blocks of size 2^( 7) =       0.000465034333

      target function =                  N/A
              le_mean =     -16.906424424521
             les_mean =     286.159655253713
             stat err =       0.000456025255
             autocorr =       1.250999548234
              std dev =       0.576600900013
             le_variance =       0.332468597896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332510990252
                                         uncertainty =       0.003016293326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332510990252
                                         uncertainty =       0.003016293326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407718406
  error estimate for blocks of size 2^( 2) =       0.000420325942
  error estimate for blocks of size 2^( 3) =       0.000433029747
  error estimate for blocks of size 2^( 4) =       0.000443860160
  error estimate for blocks of size 2^( 5) =       0.000453100889
  error estimate for blocks of size 2^( 6) =       0.000462105636
  error estimate for blocks of size 2^( 7) =       0.000465034333

      target function =                  N/A
              le_mean =     -16.906424424521
             les_mean =     286.159655253731
             stat err =       0.000456025255
             autocorr =       1.250999548219
              std dev =       0.576600900038
             le_variance =       0.332468597925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332510990278
                                         uncertainty =       0.003016293326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332510990278
                                         uncertainty =       0.003016293326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407718406
  error estimate for blocks of size 2^( 2) =       0.000420325942
  error estimate for blocks of size 2^( 3) =       0.000433029747
  error estimate for blocks of size 2^( 4) =       0.000443860160
  error estimate for blocks of size 2^( 5) =       0.000453100889
  error estimate for blocks of size 2^( 6) =       0.000462105636
  error estimate for blocks of size 2^( 7) =       0.000465034333

      target function =                  N/A
              le_mean =     -16.906424424521
             les_mean =     286.159655253747
             stat err =       0.000456025255
             autocorr =       1.250999548207
              std dev =       0.576600900060
             le_variance =       0.332468597950


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906424424521        initial
     5.8208e+05     5.8208e+06             3.5397e-10       -16.906424424521  <--
     2.3283e+06     2.3283e+07             8.8493e-11       -16.906424424521
     9.3132e+06     9.3132e+07             2.2123e-11       -16.906424424521

*****************************************************************************
Applying the update for shift_i =   5.8208e+05     and shift_s =   5.8208e+06
*****************************************************************************

  Execution time = 2.9360e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237860e-02 1 1  ON 2
 uu_3                -2.049807e-02 1 1  ON 3
 uu_4                -6.677617e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469737e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880757e-01 1 1  ON 11
 ud_2                 6.722077e-02 1 1  ON 12
 ud_3                -4.470047e-03 1 1  ON 13
 ud_4                -6.195226e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538548e-01 1 1  ON 18
 ud_9                -1.462260e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420843e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397470e-01 1 1  ON 28
 eO_9                -1.107749e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436770e-02 1 1  ON 33
eH1_4                -3.900233e-03 1 1  ON 34
eH1_5                 3.329279e-02 1 1  ON 35
eH1_6                 9.615575e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021447e-01 1 1  ON 39
eH2_0                -2.606647e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085487e-02 1 1  ON 43
eH2_4                -6.095246e-04 1 1  ON 44
eH2_5                 3.508374e-02 1 1  ON 45
eH2_6                 9.763619e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237096e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4995e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.7987
    reference variance = 0.19317
====================================================
  Execution time = 2.0638e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3748e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5835e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337519083983
                                         uncertainty =       0.003421209931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337519083983
                                         uncertainty =       0.003421209931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410778668
  error estimate for blocks of size 2^( 2) =       0.000423778149
  error estimate for blocks of size 2^( 3) =       0.000436757399
  error estimate for blocks of size 2^( 4) =       0.000449404193
  error estimate for blocks of size 2^( 5) =       0.000459483323
  error estimate for blocks of size 2^( 6) =       0.000465872571
  error estimate for blocks of size 2^( 7) =       0.000469956521

      target function =                  N/A
              le_mean =     -16.905568007284
             les_mean =     286.135707708352
             stat err =       0.000461179152
             autocorr =       1.260444036600
              std dev =       0.580928763437
             le_variance =       0.337478228188


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690556800728e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905568007284       residual = 8.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905568007284       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905568007278       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905568007282       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905568007229       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905568007285       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905568007176       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905568007305       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 1.473678e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905568007284       residual = 8.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905568007284       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905568007282       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905568007282       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905568006979       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905568007036       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905568006503       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905568008107       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 3.684192e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905568007284       residual = 8.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905568007284       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905568007284       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905568007383       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905568007019       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905568008247       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905568006402       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905568007067       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 9.210496e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.254771 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6230e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237860e-02 1 1  ON 2
 uu_3                -2.049807e-02 1 1  ON 3
 uu_4                -6.677617e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469737e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880757e-01 1 1  ON 11
 ud_2                 6.722077e-02 1 1  ON 12
 ud_3                -4.470047e-03 1 1  ON 13
 ud_4                -6.195226e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538548e-01 1 1  ON 18
 ud_9                -1.462260e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420843e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397470e-01 1 1  ON 28
 eO_9                -1.107749e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436770e-02 1 1  ON 33
eH1_4                -3.900233e-03 1 1  ON 34
eH1_5                 3.329279e-02 1 1  ON 35
eH1_6                 9.615575e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021447e-01 1 1  ON 39
eH2_0                -2.606647e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085487e-02 1 1  ON 43
eH2_4                -6.095248e-04 1 1  ON 44
eH2_5                 3.508374e-02 1 1  ON 45
eH2_6                 9.763619e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237096e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8839
    reference variance = 0.398805
====================================================
  Execution time = 2.0113e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3824e-01
  Total weights = 2.0000e+06
  Execution time = 1.8704e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338285168653
                                         uncertainty =       0.006052195917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338285168653
                                         uncertainty =       0.006052195917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411240543
  error estimate for blocks of size 2^( 2) =       0.000424051107
  error estimate for blocks of size 2^( 3) =       0.000436823606
  error estimate for blocks of size 2^( 4) =       0.000448869614
  error estimate for blocks of size 2^( 5) =       0.000460255254
  error estimate for blocks of size 2^( 6) =       0.000468735717
  error estimate for blocks of size 2^( 7) =       0.000476164069

      target function =                  N/A
              le_mean =     -16.906620785890
             les_mean =     286.172063797305
             stat err =       0.000463506164
             autocorr =       1.270337677665
              std dev =       0.581581953415
             le_variance =       0.338237568538

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338285170181
                                         uncertainty =       0.006052195937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338285170181
                                         uncertainty =       0.006052195937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411240544
  error estimate for blocks of size 2^( 2) =       0.000424051108
  error estimate for blocks of size 2^( 3) =       0.000436823606
  error estimate for blocks of size 2^( 4) =       0.000448869615
  error estimate for blocks of size 2^( 5) =       0.000460255255
  error estimate for blocks of size 2^( 6) =       0.000468735718
  error estimate for blocks of size 2^( 7) =       0.000476164070

      target function =                  N/A
              le_mean =     -16.906620785879
             les_mean =     286.172063798476
             stat err =       0.000463506164
             autocorr =       1.270337676129
              std dev =       0.581581954729
             le_variance =       0.338237570066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338285169417
                                         uncertainty =       0.006052195927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338285169417
                                         uncertainty =       0.006052195927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411240544
  error estimate for blocks of size 2^( 2) =       0.000424051108
  error estimate for blocks of size 2^( 3) =       0.000436823606
  error estimate for blocks of size 2^( 4) =       0.000448869614
  error estimate for blocks of size 2^( 5) =       0.000460255255
  error estimate for blocks of size 2^( 6) =       0.000468735718
  error estimate for blocks of size 2^( 7) =       0.000476164069

      target function =                  N/A
              le_mean =     -16.906620785885
             les_mean =     286.172063797890
             stat err =       0.000463506164
             autocorr =       1.270337676900
              std dev =       0.581581954072
             le_variance =       0.338237569302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338285168748
                                         uncertainty =       0.006052195918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338285168748
                                         uncertainty =       0.006052195918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411240543
  error estimate for blocks of size 2^( 2) =       0.000424051108
  error estimate for blocks of size 2^( 3) =       0.000436823606
  error estimate for blocks of size 2^( 4) =       0.000448869614
  error estimate for blocks of size 2^( 5) =       0.000460255254
  error estimate for blocks of size 2^( 6) =       0.000468735717
  error estimate for blocks of size 2^( 7) =       0.000476164069

      target function =                  N/A
              le_mean =     -16.906620785889
             les_mean =     286.172063797378
             stat err =       0.000463506164
             autocorr =       1.270337677572
              std dev =       0.581581953497
             le_variance =       0.338237568633


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906620785890        initial  <--
     1.4552e+05     1.4552e+06             1.4737e-09       -16.906620785879
     5.8208e+05     5.8208e+06             3.6842e-10       -16.906620785885
     2.3283e+06     2.3283e+07             9.2105e-11       -16.906620785889

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5442
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237860e-02 1 1  ON 2
 uu_3                -2.049807e-02 1 1  ON 3
 uu_4                -6.677617e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469737e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880757e-01 1 1  ON 11
 ud_2                 6.722077e-02 1 1  ON 12
 ud_3                -4.470047e-03 1 1  ON 13
 ud_4                -6.195226e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538548e-01 1 1  ON 18
 ud_9                -1.462260e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420843e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397470e-01 1 1  ON 28
 eO_9                -1.107749e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436770e-02 1 1  ON 33
eH1_4                -3.900233e-03 1 1  ON 34
eH1_5                 3.329279e-02 1 1  ON 35
eH1_6                 9.615575e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021447e-01 1 1  ON 39
eH2_0                -2.606647e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085487e-02 1 1  ON 43
eH2_4                -6.095246e-04 1 1  ON 44
eH2_5                 3.508374e-02 1 1  ON 45
eH2_6                 9.763619e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237096e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5782e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.835
    reference variance = 0.212512
====================================================
  Execution time = 2.0026e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4559e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5010e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345596605528
                                         uncertainty =       0.008273238693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345596605528
                                         uncertainty =       0.008273238693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415683395
  error estimate for blocks of size 2^( 2) =       0.000428357133
  error estimate for blocks of size 2^( 3) =       0.000441141431
  error estimate for blocks of size 2^( 4) =       0.000453288433
  error estimate for blocks of size 2^( 5) =       0.000463524178
  error estimate for blocks of size 2^( 6) =       0.000469881634
  error estimate for blocks of size 2^( 7) =       0.000474906111

      target function =                  N/A
              le_mean =     -16.906410954635
             les_mean =     286.172316563735
             stat err =       0.000465400089
             autocorr =       1.253509332844
              std dev =       0.587865094664
             le_variance =       0.345585369525


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690641095464e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906410954635       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906410954636       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906410954636       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906410954637       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906410954640       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906410953836       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906410956194       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906410954421       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.353950e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906410954635       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906410954635       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906410954635       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906410956790       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906410954636       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906410950037       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906410959707       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906410947492       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 3.384874e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906410954635       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906410954635       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906410954635       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906410954635       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906410962945       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906410955223       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906410964304       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906410985480       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 8.461964e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.257419 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5534e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237860e-02 1 1  ON 2
 uu_3                -2.049807e-02 1 1  ON 3
 uu_4                -6.677617e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469737e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880757e-01 1 1  ON 11
 ud_2                 6.722077e-02 1 1  ON 12
 ud_3                -4.470047e-03 1 1  ON 13
 ud_4                -6.195226e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538548e-01 1 1  ON 18
 ud_9                -1.462260e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420843e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397470e-01 1 1  ON 28
 eO_9                -1.107749e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436770e-02 1 1  ON 33
eH1_4                -3.900233e-03 1 1  ON 34
eH1_5                 3.329279e-02 1 1  ON 35
eH1_6                 9.615575e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021447e-01 1 1  ON 39
eH2_0                -2.606647e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085487e-02 1 1  ON 43
eH2_4                -6.095246e-04 1 1  ON 44
eH2_5                 3.508374e-02 1 1  ON 45
eH2_6                 9.763619e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237096e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9232
    reference variance = 0.366593
====================================================
  Execution time = 1.9782e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3149e-01
  Total weights = 2.0000e+06
  Execution time = 1.8718e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331201559504
                                         uncertainty =       0.002464914036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331201559504
                                         uncertainty =       0.002464914036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407118766
  error estimate for blocks of size 2^( 2) =       0.000419835624
  error estimate for blocks of size 2^( 3) =       0.000432511265
  error estimate for blocks of size 2^( 4) =       0.000444330201
  error estimate for blocks of size 2^( 5) =       0.000453690290
  error estimate for blocks of size 2^( 6) =       0.000460779454
  error estimate for blocks of size 2^( 7) =       0.000464358968

      target function =                  N/A
              le_mean =     -16.907468654856
             les_mean =     286.193987527750
             stat err =       0.000455789728
             autocorr =       1.253391731043
              std dev =       0.575752879761
             le_variance =       0.331491378553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331201559504
                                         uncertainty =       0.002464914036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331201559504
                                         uncertainty =       0.002464914036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407118766
  error estimate for blocks of size 2^( 2) =       0.000419835624
  error estimate for blocks of size 2^( 3) =       0.000432511265
  error estimate for blocks of size 2^( 4) =       0.000444330201
  error estimate for blocks of size 2^( 5) =       0.000453690290
  error estimate for blocks of size 2^( 6) =       0.000460779454
  error estimate for blocks of size 2^( 7) =       0.000464358968

      target function =                  N/A
              le_mean =     -16.907468654857
             les_mean =     286.193987527779
             stat err =       0.000455789728
             autocorr =       1.253391731029
              std dev =       0.575752879761
             le_variance =       0.331491378553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331201559504
                                         uncertainty =       0.002464914036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331201559504
                                         uncertainty =       0.002464914036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407118766
  error estimate for blocks of size 2^( 2) =       0.000419835624
  error estimate for blocks of size 2^( 3) =       0.000432511265
  error estimate for blocks of size 2^( 4) =       0.000444330201
  error estimate for blocks of size 2^( 5) =       0.000453690290
  error estimate for blocks of size 2^( 6) =       0.000460779454
  error estimate for blocks of size 2^( 7) =       0.000464358968

      target function =                  N/A
              le_mean =     -16.907468654857
             les_mean =     286.193987527765
             stat err =       0.000455789728
             autocorr =       1.253391731032
              std dev =       0.575752879761
             le_variance =       0.331491378553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331201559504
                                         uncertainty =       0.002464914036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331201559504
                                         uncertainty =       0.002464914036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407118766
  error estimate for blocks of size 2^( 2) =       0.000419835624
  error estimate for blocks of size 2^( 3) =       0.000432511265
  error estimate for blocks of size 2^( 4) =       0.000444330201
  error estimate for blocks of size 2^( 5) =       0.000453690290
  error estimate for blocks of size 2^( 6) =       0.000460779454
  error estimate for blocks of size 2^( 7) =       0.000464358968

      target function =                  N/A
              le_mean =     -16.907468654856
             les_mean =     286.193987527752
             stat err =       0.000455789728
             autocorr =       1.253391731046
              std dev =       0.575752879761
             le_variance =       0.331491378553


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907468654856        initial
     1.4552e+06     1.4552e+07             1.3539e-10       -16.907468654857  <--
     5.8208e+06     5.8208e+07             3.3849e-11       -16.907468654857
     2.3283e+07     2.3283e+08             8.4620e-12       -16.907468654856

*****************************************************************************
Applying the update for shift_i =   1.4552e+06     and shift_s =   1.4552e+07
*****************************************************************************

  Execution time = 2.9204e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237860e-02 1 1  ON 2
 uu_3                -2.049807e-02 1 1  ON 3
 uu_4                -6.677617e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469737e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880757e-01 1 1  ON 11
 ud_2                 6.722077e-02 1 1  ON 12
 ud_3                -4.470047e-03 1 1  ON 13
 ud_4                -6.195226e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538548e-01 1 1  ON 18
 ud_9                -1.462260e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420843e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397470e-01 1 1  ON 28
 eO_9                -1.107749e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436770e-02 1 1  ON 33
eH1_4                -3.900233e-03 1 1  ON 34
eH1_5                 3.329279e-02 1 1  ON 35
eH1_6                 9.615575e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021447e-01 1 1  ON 39
eH2_0                -2.606647e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085487e-02 1 1  ON 43
eH2_4                -6.095246e-04 1 1  ON 44
eH2_5                 3.508374e-02 1 1  ON 45
eH2_6                 9.763619e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237096e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4748e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9098
    reference variance = 0.181449
====================================================
  Execution time = 2.2114e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5626e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5136e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356200255468
                                         uncertainty =       0.012255942602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356200255468
                                         uncertainty =       0.012255942602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422052702
  error estimate for blocks of size 2^( 2) =       0.000435052046
  error estimate for blocks of size 2^( 3) =       0.000447845814
  error estimate for blocks of size 2^( 4) =       0.000460419893
  error estimate for blocks of size 2^( 5) =       0.000471457358
  error estimate for blocks of size 2^( 6) =       0.000478936021
  error estimate for blocks of size 2^( 7) =       0.000482831843

      target function =                  N/A
              le_mean =     -16.906104992343
             les_mean =     286.172642800550
             stat err =       0.000473411279
             autocorr =       1.258183052751
              std dev =       0.596872655220
             le_variance =       0.356256966549


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690610499234e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906104992343       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906104992345       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906104992346       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906104992345       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906104992507       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906104992189       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906104992455       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906104991955       residual = 1.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 7.464245e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906104992343       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906104992344       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906104992344       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906104992344       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906104992577       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906104993277       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906104992127       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906104992788       residual = 1.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.866060e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906104992343       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906104992343       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906104992343       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906104992343       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906104992343       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906104992343       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906104990188       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906104992598       residual = 1.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 4.665164e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.260069 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7635e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237860e-02 1 1  ON 2
 uu_3                -2.049807e-02 1 1  ON 3
 uu_4                -6.677617e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469737e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880757e-01 1 1  ON 11
 ud_2                 6.722077e-02 1 1  ON 12
 ud_3                -4.470047e-03 1 1  ON 13
 ud_4                -6.195226e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538548e-01 1 1  ON 18
 ud_9                -1.462260e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420843e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397470e-01 1 1  ON 28
 eO_9                -1.107749e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436770e-02 1 1  ON 33
eH1_4                -3.900233e-03 1 1  ON 34
eH1_5                 3.329279e-02 1 1  ON 35
eH1_6                 9.615575e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021447e-01 1 1  ON 39
eH2_0                -2.606647e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085487e-02 1 1  ON 43
eH2_4                -6.095247e-04 1 1  ON 44
eH2_5                 3.508374e-02 1 1  ON 45
eH2_6                 9.763619e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237096e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.903
    reference variance = 0.20161
====================================================
  Execution time = 1.9799e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3723e-01
  Total weights = 2.0000e+06
  Execution time = 1.8782e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337224253314
                                         uncertainty =       0.005560259341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337224253314
                                         uncertainty =       0.005560259341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410626592
  error estimate for blocks of size 2^( 2) =       0.000423282414
  error estimate for blocks of size 2^( 3) =       0.000436588110
  error estimate for blocks of size 2^( 4) =       0.000448021329
  error estimate for blocks of size 2^( 5) =       0.000458545937
  error estimate for blocks of size 2^( 6) =       0.000465753634
  error estimate for blocks of size 2^( 7) =       0.000471786443

      target function =                  N/A
              le_mean =     -16.905711770557
             les_mean =     286.140318697390
             stat err =       0.000461026836
             autocorr =       1.260544755996
              std dev =       0.580713696100
             le_variance =       0.337228396838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337224253228
                                         uncertainty =       0.005560259330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337224253228
                                         uncertainty =       0.005560259330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410626592
  error estimate for blocks of size 2^( 2) =       0.000423282413
  error estimate for blocks of size 2^( 3) =       0.000436588110
  error estimate for blocks of size 2^( 4) =       0.000448021329
  error estimate for blocks of size 2^( 5) =       0.000458545937
  error estimate for blocks of size 2^( 6) =       0.000465753634
  error estimate for blocks of size 2^( 7) =       0.000471786443

      target function =                  N/A
              le_mean =     -16.905711770558
             les_mean =     286.140318697329
             stat err =       0.000461026836
             autocorr =       1.260544755998
              std dev =       0.580713696026
             le_variance =       0.337228396752

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337224253271
                                         uncertainty =       0.005560259336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337224253271
                                         uncertainty =       0.005560259336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410626592
  error estimate for blocks of size 2^( 2) =       0.000423282413
  error estimate for blocks of size 2^( 3) =       0.000436588110
  error estimate for blocks of size 2^( 4) =       0.000448021329
  error estimate for blocks of size 2^( 5) =       0.000458545937
  error estimate for blocks of size 2^( 6) =       0.000465753634
  error estimate for blocks of size 2^( 7) =       0.000471786443

      target function =                  N/A
              le_mean =     -16.905711770558
             les_mean =     286.140318697359
             stat err =       0.000461026836
             autocorr =       1.260544755994
              std dev =       0.580713696063
             le_variance =       0.337228396795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337224253309
                                         uncertainty =       0.005560259340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337224253309
                                         uncertainty =       0.005560259340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410626592
  error estimate for blocks of size 2^( 2) =       0.000423282414
  error estimate for blocks of size 2^( 3) =       0.000436588110
  error estimate for blocks of size 2^( 4) =       0.000448021329
  error estimate for blocks of size 2^( 5) =       0.000458545937
  error estimate for blocks of size 2^( 6) =       0.000465753634
  error estimate for blocks of size 2^( 7) =       0.000471786443

      target function =                  N/A
              le_mean =     -16.905711770558
             les_mean =     286.140318697386
             stat err =       0.000461026836
             autocorr =       1.260544755996
              std dev =       0.580713696095
             le_variance =       0.337228396832


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905711770557        initial
     3.6380e+05     3.6380e+06             7.4642e-10       -16.905711770558  <--
     1.4552e+06     1.4552e+07             1.8661e-10       -16.905711770558
     5.8208e+06     5.8208e+07             4.6652e-11       -16.905711770558

*****************************************************************************
Applying the update for shift_i =   3.6380e+05     and shift_s =   3.6380e+06
*****************************************************************************

  Execution time = 2.9249e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237860e-02 1 1  ON 2
 uu_3                -2.049807e-02 1 1  ON 3
 uu_4                -6.677617e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469737e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880757e-01 1 1  ON 11
 ud_2                 6.722077e-02 1 1  ON 12
 ud_3                -4.470047e-03 1 1  ON 13
 ud_4                -6.195226e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538548e-01 1 1  ON 18
 ud_9                -1.462260e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420843e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397470e-01 1 1  ON 28
 eO_9                -1.107749e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436770e-02 1 1  ON 33
eH1_4                -3.900233e-03 1 1  ON 34
eH1_5                 3.329279e-02 1 1  ON 35
eH1_6                 9.615575e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021447e-01 1 1  ON 39
eH2_0                -2.606647e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085487e-02 1 1  ON 43
eH2_4                -6.095250e-04 1 1  ON 44
eH2_5                 3.508374e-02 1 1  ON 45
eH2_6                 9.763619e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237096e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6893e+01 secs
  Total Execution time = 2.2387e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
