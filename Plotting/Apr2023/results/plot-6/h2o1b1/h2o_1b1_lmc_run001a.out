Rank =    0  Free Memory = 84217 MB
Rank =    1  Free Memory = 84217 MB
Rank =    2  Free Memory = 84216 MB
Rank =    3  Free Memory = 84216 MB
Rank =    4  Free Memory = 84215 MB
Rank =    5  Free Memory = 84214 MB
Rank =    6  Free Memory = 84214 MB
Rank =    7  Free Memory = 84214 MB
Rank =    8  Free Memory = 84214 MB
Rank =    9  Free Memory = 84213 MB
Rank =   10  Free Memory = 84213 MB
Rank =   11  Free Memory = 84213 MB
Rank =   12  Free Memory = 84213 MB
Rank =   13  Free Memory = 84213 MB
Rank =   14  Free Memory = 84212 MB
Rank =   15  Free Memory = 84200 MB
Rank =   16  Free Memory = 84200 MB
Rank =   17  Free Memory = 84200 MB
Rank =   18  Free Memory = 84200 MB
Rank =   19  Free Memory = 84200 MB
Rank =   20  Free Memory = 84200 MB
Rank =   21  Free Memory = 84200 MB
Rank =   22  Free Memory = 84200 MB
Rank =   23  Free Memory = 84200 MB
Rank =   24  Free Memory = 84200 MB
Rank =   25  Free Memory = 84200 MB
Rank =   26  Free Memory = 84200 MB
Rank =   27  Free Memory = 84200 MB
Rank =   28  Free Memory = 84199 MB
Rank =   29  Free Memory = 84199 MB
Rank =   30  Free Memory = 84199 MB
Rank =   31  Free Memory = 84199 MB
Rank =   32  Free Memory = 74904 MB
Rank =   33  Free Memory = 74904 MB
Rank =   34  Free Memory = 74904 MB
Rank =   35  Free Memory = 74904 MB
Rank =   36  Free Memory = 74904 MB
Rank =   37  Free Memory = 74903 MB
Rank =   38  Free Memory = 74903 MB
Rank =   39  Free Memory = 74903 MB
Rank =   40  Free Memory = 74903 MB
Rank =   41  Free Memory = 74903 MB
Rank =   42  Free Memory = 74903 MB
Rank =   43  Free Memory = 74903 MB
Rank =   44  Free Memory = 74903 MB
Rank =   45  Free Memory = 74903 MB
Rank =   46  Free Memory = 74903 MB
Rank =   47  Free Memory = 74903 MB
Rank =   48  Free Memory = 74903 MB
Rank =   49  Free Memory = 74903 MB
Rank =   50  Free Memory = 74903 MB
Rank =   51  Free Memory = 74903 MB
Rank =   52  Free Memory = 74903 MB
Rank =   53  Free Memory = 74903 MB
Rank =   54  Free Memory = 74903 MB
Rank =   55  Free Memory = 74903 MB
Rank =   56  Free Memory = 74903 MB
Rank =   57  Free Memory = 74903 MB
Rank =   58  Free Memory = 74903 MB
Rank =   59  Free Memory = 74903 MB
Rank =   60  Free Memory = 74903 MB
Rank =   61  Free Memory = 74903 MB
Rank =   62  Free Memory = 74903 MB
Rank =   63  Free Memory = 74903 MB
Rank =   64  Free Memory = 75409 MB
Rank =   65  Free Memory = 75409 MB
Rank =   66  Free Memory = 75409 MB
Rank =   67  Free Memory = 75409 MB
Rank =   68  Free Memory = 75409 MB
Rank =   69  Free Memory = 75409 MB
Rank =   70  Free Memory = 75409 MB
Rank =   71  Free Memory = 75409 MB
Rank =   72  Free Memory = 75409 MB
Rank =   73  Free Memory = 75409 MB
Rank =   74  Free Memory = 75409 MB
Rank =   75  Free Memory = 75409 MB
Rank =   76  Free Memory = 75409 MB
Rank =   77  Free Memory = 75409 MB
Rank =   78  Free Memory = 75409 MB
Rank =   79  Free Memory = 75409 MB
Rank =   80  Free Memory = 75409 MB
Rank =   81  Free Memory = 75409 MB
Rank =   82  Free Memory = 75409 MB
Rank =   83  Free Memory = 75409 MB
Rank =   84  Free Memory = 75409 MB
Rank =   85  Free Memory = 75409 MB
Rank =   86  Free Memory = 75409 MB
Rank =   87  Free Memory = 75409 MB
Rank =   88  Free Memory = 75409 MB
Rank =   89  Free Memory = 75409 MB
Rank =   90  Free Memory = 75409 MB
Rank =   91  Free Memory = 75409 MB
Rank =   92  Free Memory = 75409 MB
Rank =   93  Free Memory = 75409 MB
Rank =   94  Free Memory = 75409 MB
Rank =   95  Free Memory = 75409 MB
Rank =   96  Free Memory = 76244 MB
Rank =   97  Free Memory = 76244 MB
Rank =   98  Free Memory = 76244 MB
Rank =   99  Free Memory = 76244 MB
Rank =  100  Free Memory = 76244 MB
Rank =  101  Free Memory = 76243 MB
Rank =  102  Free Memory = 76243 MB
Rank =  103  Free Memory = 76243 MB
Rank =  104  Free Memory = 76243 MB
Rank =  105  Free Memory = 76243 MB
Rank =  106  Free Memory = 76243 MB
Rank =  107  Free Memory = 76243 MB
Rank =  108  Free Memory = 76243 MB
Rank =  109  Free Memory = 76243 MB
Rank =  110  Free Memory = 76243 MB
Rank =  111  Free Memory = 76243 MB
Rank =  112  Free Memory = 76243 MB
Rank =  113  Free Memory = 76243 MB
Rank =  114  Free Memory = 76243 MB
Rank =  115  Free Memory = 76243 MB
Rank =  116  Free Memory = 76243 MB
Rank =  117  Free Memory = 76243 MB
Rank =  118  Free Memory = 76243 MB
Rank =  119  Free Memory = 76243 MB
Rank =  120  Free Memory = 76243 MB
Rank =  121  Free Memory = 76243 MB
Rank =  122  Free Memory = 76243 MB
Rank =  123  Free Memory = 76243 MB
Rank =  124  Free Memory = 76243 MB
Rank =  125  Free Memory = 76243 MB
Rank =  126  Free Memory = 76243 MB
Rank =  127  Free Memory = 76243 MB
  Input file(s): opt_h2o_1b1_lmc_run001a.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_lmc_run001a.xml

  Project = H2O
  date    = 2023-03-02 18:11:05 PST
  host    = n0073.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 825

  Range of prime numbers to use as seeds over processors and threads = 6353-7537


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.027108e-01    1         1  ON     0
     uu_1                 1.395499e-01    1         1  ON     1
     uu_2                 4.158458e-02    1         1  ON     2
     uu_3                -1.946409e-02    1         1  ON     3
     uu_4                -6.333239e-02    1         1  ON     4
     uu_5                -9.587524e-02    1         1  ON     5
     uu_6                -1.205706e-01    1         1  ON     6
     uu_7                -1.310580e-01    1         1  ON     7
     uu_8                -1.203232e-01    1         1  ON     8
     uu_9                -9.277332e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.114416e-01    1         1  ON     0
     ud_1                 1.583401e-01    1         1  ON     1
     ud_2                 6.092685e-02    1         1  ON     2
     ud_3                 2.699750e-03    1         1  ON     3
     ud_4                -5.713986e-02    1         1  ON     4
     ud_5                -1.014997e-01    1         1  ON     5
     ud_6                -1.286687e-01    1         1  ON     6
     ud_7                -1.435029e-01    1         1  ON     7
     ud_8                -1.424319e-01    1         1  ON     8
     ud_9                -1.344547e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.043100e-01    1         1  ON     0
     eO_1                -4.137154e-01    1         1  ON     1
     eO_2                -3.185752e-02    1         1  ON     2
     eO_3                 2.692030e-01    1         1  ON     3
     eO_4                 4.916456e-01    1         1  ON     4
     eO_5                 4.596091e-01    1         1  ON     5
     eO_6                 2.360353e-01    1         1  ON     6
     eO_7                -5.591968e-02    1         1  ON     7
     eO_8                -1.959242e-01    1         1  ON     8
     eO_9                -5.768884e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.099404e-01    1         1  ON     0
     eH1_1                -1.274877e-01    1         1  ON     1
     eH1_2                -8.838243e-02    1         1  ON     2
     eH1_3                -3.738645e-02    1         1  ON     3
     eH1_4                 1.159942e-02    1         1  ON     4
     eH1_5                 4.473069e-02    1         1  ON     5
     eH1_6                 9.476145e-02    1         1  ON     6
     eH1_7                 1.381756e-01    1         1  ON     7
     eH1_8                 1.456924e-01    1         1  ON     8
     eH1_9                 3.283823e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.088198e-01    1         1  ON     0
     eH2_1                -1.265485e-01    1         1  ON     1
     eH2_2                -8.741031e-02    1         1  ON     2
     eH2_3                -3.640778e-02    1         1  ON     3
     eH2_4                 1.289653e-02    1         1  ON     4
     eH2_5                 4.794967e-02    1         1  ON     5
     eH2_6                 1.006131e-01    1         1  ON     6
     eH2_7                 1.496008e-01    1         1  ON     7
     eH2_8                 1.537439e-01    1         1  ON     8
     eH2_9                 1.292423e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.913765e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.1055e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 124
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8419
    reference variance = 0.260592
====================================================
  Execution time = 2.1861e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6894e+01
  VMC Evar = 3.8484e-01
  Total weights = 1.950858421e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1074e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370325373636
                                         uncertainty =       0.002874821838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370325373636
                                         uncertainty =       0.002874821838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430244651
  error estimate for blocks of size 2^( 2) =       0.000444573708
  error estimate for blocks of size 2^( 3) =       0.000459041101
  error estimate for blocks of size 2^( 4) =       0.000471214162
  error estimate for blocks of size 2^( 5) =       0.000481808064
  error estimate for blocks of size 2^( 6) =       0.000490019755
  error estimate for blocks of size 2^( 7) =       0.000497933635

      target function =                  N/A
              le_mean =     -16.894050212189
             les_mean =     285.793777104119
             stat err =       0.000485243904
             autocorr =       1.272006165835
              std dev =       0.608457821053
             le_variance =       0.370220920001


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.689405021219e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.894050212218       residual = 2.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.899067543142       residual = 3.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.899407042508       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.899650563144       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.899771199777       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.899825863069       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.899874999772       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.899880978543       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.899891863985       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.899896308768       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.899896683816       residual = 9.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.899896554931       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.899895673159       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.899895246170       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.899895550083       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.899895971643       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.899896164083       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.899896129644       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.5000e-01 is 1.053681e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.894050212218       residual = 2.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.896139399574       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.896254026562       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.896351480742       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.896392059577       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.896408134666       residual = 9.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.896424695751       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.896426716650       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.896429254574       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.896429422661       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.896430015390       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.896430225724       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.896429946128       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.896429855891       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.896429736387       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.0000e+00 is 3.583437e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.894050212218       residual = 2.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.894676630728       residual = 3.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.894709489724       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.894738439227       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.894750172606       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.894754100381       residual = 7.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.894758456167       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.894759200583       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.894759654256       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.894759780425       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.894759920877       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.894759953546       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.894759948362       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.894759928377       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 4.0000e+00 is 1.020155e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177600 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8150e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0    3.026844e-01                 1 1 ON  0
uu_1    1.393684e-01                 1 1 ON  1
uu_2    4.173419e-02                 1 1 ON  2
uu_3    -1.890187e-02                1 1 ON  3
uu_4    -6.287973e-02                1 1 ON  4
uu_5    -9.585719e-02                1 1 ON  5
uu_6    -1.208607e-01                1 1 ON  6
uu_7    -1.313599e-01                1 1 ON  7
uu_8    -1.206424e-01                1 1 ON  8
uu_9    -9.297392e-02                1 1 ON  9
ud_0    4.150250e-01                 1 1 ON  10
ud_1    1.612457e-01                 1 1 ON  11
ud_2    5.956330e-02                 1 1 ON  12
ud_3    9.492842e-05                 1 1 ON  13
ud_4    -5.817520e-02                1 1 ON  14
ud_5    -1.017465e-01                1 1 ON  15
ud_6    -1.289928e-01                1 1 ON  16
ud_7    -1.438839e-01                1 1 ON  17
ud_8    -1.428548e-01                1 1 ON  18
ud_9    -1.345540e-01                1 1 ON  19
eO_0    -7.073306e-01                1 1 ON  20
eO_1    -4.139164e-01                1 1 ON  21
eO_2    -2.935437e-02                1 1 ON  22
eO_3    2.703451e-01                 1 1 ON  23
eO_4    4.919498e-01                 1 1 ON  24
eO_5    4.593025e-01                 1 1 ON  25
eO_6    2.359595e-01                 1 1 ON  26
eO_7    -5.587420e-02                1 1 ON  27
eO_8    -1.961385e-01                1 1 ON  28
eO_9    -5.784709e-02                1 1 ON  29
eH1_0   -2.117276e-01                1 1 ON  30
eH1_1   -1.283124e-01                1 1 ON  31
eH1_2   -8.780222e-02                1 1 ON  32
eH1_3   -3.651461e-02                1 1 ON  33
eH1_4   1.209482e-02                 1 1 ON  34
eH1_5   4.489942e-02                 1 1 ON  35
eH1_6   9.480608e-02                 1 1 ON  36
eH1_7   1.382630e-01                 1 1 ON  37
eH1_8   1.458967e-01                 1 1 ON  38
eH1_9   3.301050e-02                 1 1 ON  39
eH2_0   -2.106488e-01                1 1 ON  40
eH2_1   -1.272517e-01                1 1 ON  41
eH2_2   -8.673190e-02                1 1 ON  42
eH2_3   -3.552102e-02                1 1 ON  43
eH2_4   1.339964e-02                 1 1 ON  44
eH2_5   4.807976e-02                 1 1 ON  45
eH2_6   1.006430e-01                 1 1 ON  46
eH2_7   1.495400e-01                 1 1 ON  47
eH2_8   1.539425e-01                 1 1 ON  48
eH2_9   1.311224e-02                 1 1 ON  49
ci_0001 6.948532e-01                 3 1 ON  50
ci_0002 6.947966e-01                 3 1 ON  51
ci_0003 -4.502696e-02                3 1 ON  52
ci_0004 -4.509228e-02                3 1 ON  53
ci_0005 -4.464713e-02                3 1 ON  54
ci_0006 -4.481063e-02                3 1 ON  55
ci_0007 -3.232686e-02                3 1 ON  56
ci_0008 -3.262700e-02                3 1 ON  57
ci_0009 -2.889185e-02                3 1 ON  58
ci_0010 -2.900510e-02                3 1 ON  59
ci_0011 -2.439743e-02                3 1 ON  60
ci_0012 -2.438504e-02                3 1 ON  61
ci_0013 2.410612e-02                 3 1 ON  62
ci_0014 2.386403e-02                 3 1 ON  63
ci_0015 2.381336e-02                 3 1 ON  64
ci_0016 2.386686e-02                 3 1 ON  65
ci_0017 2.167210e-02                 3 1 ON  66
ci_0018 2.170673e-02                 3 1 ON  67
ci_0019 1.856506e-02                 3 1 ON  68
ci_0020 1.829853e-02                 3 1 ON  69
ci_0021 1.749994e-02                 3 1 ON  70
ci_0022 1.737283e-02                 3 1 ON  71
ci_0023 -1.718707e-02                3 1 ON  72
ci_0024 -1.731409e-02                3 1 ON  73
ci_0025 -1.768089e-02                3 1 ON  74
ci_0026 -1.746117e-02                3 1 ON  75
ci_0027 -1.671638e-02                3 1 ON  76
ci_0028 -1.671007e-02                3 1 ON  77
ci_0029 -1.561834e-02                3 1 ON  78
ci_0030 -1.560299e-02                3 1 ON  79
ci_0031 1.710728e-02                 3 1 ON  80
ci_0032 1.700273e-02                 3 1 ON  81
ci_0033 1.518332e-02                 3 1 ON  82
ci_0034 1.544491e-02                 3 1 ON  83
ci_0035 1.437056e-02                 3 1 ON  84
ci_0036 1.441347e-02                 3 1 ON  85
ci_0037 -1.403417e-02                3 1 ON  86
ci_0038 -1.432111e-02                3 1 ON  87
ci_0039 -1.171074e-02                3 1 ON  88
ci_0040 -1.165691e-02                3 1 ON  89
ci_0041 1.344786e-02                 3 1 ON  90
ci_0042 1.341884e-02                 3 1 ON  91
ci_0043 -1.441077e-02                3 1 ON  92
ci_0044 -1.442392e-02                3 1 ON  93
ci_0045 1.322742e-02                 3 1 ON  94
ci_0046 1.308836e-02                 3 1 ON  95
ci_0047 -1.086140e-02                3 1 ON  96
ci_0048 -1.094560e-02                3 1 ON  97
ci_0049 -1.149423e-02                3 1 ON  98
ci_0050 -1.160541e-02                3 1 ON  99
ci_0051 -1.066342e-02                3 1 ON  100
ci_0052 -1.049045e-02                3 1 ON  101
ci_0053 -1.050542e-02                3 1 ON  102
ci_0054 -1.040025e-02                3 1 ON  103
ci_0055 1.123634e-02                 3 1 ON  104
ci_0056 1.155815e-02                 3 1 ON  105
ci_0057 1.091453e-02                 3 1 ON  106
ci_0058 1.091884e-02                 3 1 ON  107
ci_0059 -1.030820e-02                3 1 ON  108
ci_0060 -1.035315e-02                3 1 ON  109
ci_0061 -1.044701e-02                3 1 ON  110
ci_0062 -1.015035e-02                3 1 ON  111
ci_0063 -1.101031e-02                3 1 ON  112
ci_0064 -1.088899e-02                3 1 ON  113
ci_0065 -1.004244e-02                3 1 ON  114
ci_0066 -1.002598e-02                3 1 ON  115
ci_0067 -9.562280e-03                3 1 ON  116
ci_0068 -9.563410e-03                3 1 ON  117
ci_0069 9.147504e-03                 3 1 ON  118
ci_0070 9.214380e-03                 3 1 ON  119
ci_0071 8.891082e-03                 3 1 ON  120
ci_0072 8.833867e-03                 3 1 ON  121
ci_0073 8.495807e-03                 3 1 ON  122
ci_0074 8.921369e-03                 3 1 ON  123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8397
    reference variance = 0.691491
====================================================
  Execution time = 2.0813e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.6236e-01
  Total weights = 1.9511e+06
  Execution time = 1.9000e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.256758
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.408879900847
                                         uncertainty =       0.020931127765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.408879900847
                                         uncertainty =       0.020931127765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000452162136
  error estimate for blocks of size 2^( 2) =       0.000466211187
  error estimate for blocks of size 2^( 3) =       0.000479856461
  error estimate for blocks of size 2^( 4) =       0.000492916966
  error estimate for blocks of size 2^( 5) =       0.000502225939
  error estimate for blocks of size 2^( 6) =       0.000509858191
  error estimate for blocks of size 2^( 7) =       0.000512331925

      target function =                  N/A
              le_mean =     -16.898240277772
             les_mean =     286.612974783285
             stat err =       0.000504333255
             autocorr =       1.244075760638
              std dev =       0.639453825539
             le_variance =       0.408901194996

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00553072
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342119961498
                                         uncertainty =       0.008366706639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342119961498
                                         uncertainty =       0.008366706639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413629531
  error estimate for blocks of size 2^( 2) =       0.000426868278
  error estimate for blocks of size 2^( 3) =       0.000440247818
  error estimate for blocks of size 2^( 4) =       0.000453281758
  error estimate for blocks of size 2^( 5) =       0.000463414761
  error estimate for blocks of size 2^( 6) =       0.000471430625
  error estimate for blocks of size 2^( 7) =       0.000474525787

      target function =                  N/A
              le_mean =     -16.899173362120
             les_mean =     286.223378745057
             stat err =       0.000465663233
             autocorr =       1.267420774771
              std dev =       0.584960493182
             le_variance =       0.342178778584

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.233638
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337307491573
                                         uncertainty =       0.003486733161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337307491573
                                         uncertainty =       0.003486733161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410720460
  error estimate for blocks of size 2^( 2) =       0.000424329218
  error estimate for blocks of size 2^( 3) =       0.000437936096
  error estimate for blocks of size 2^( 4) =       0.000451187266
  error estimate for blocks of size 2^( 5) =       0.000461103042
  error estimate for blocks of size 2^( 6) =       0.000469466325
  error estimate for blocks of size 2^( 7) =       0.000472166173

      target function =                  N/A
              le_mean =     -16.898605907909
             les_mean =     286.264831798864
             stat err =       0.000463480702
             autocorr =       1.273416978692
              std dev =       0.580846444816
             le_variance =       0.337382592455

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364910908827
                                         uncertainty =       0.002384681027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364910908827
                                         uncertainty =       0.002384681027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427192939
  error estimate for blocks of size 2^( 2) =       0.000441887200
  error estimate for blocks of size 2^( 3) =       0.000456062633
  error estimate for blocks of size 2^( 4) =       0.000469494587
  error estimate for blocks of size 2^( 5) =       0.000479309234
  error estimate for blocks of size 2^( 6) =       0.000487314150
  error estimate for blocks of size 2^( 7) =       0.000490212245

      target function =                  N/A
              le_mean =     -16.898257951960
             les_mean =     285.999482739698
             stat err =       0.000481582554
             autocorr =       1.270847270349
              std dev =       0.604142047531
             le_variance =       0.364987613595


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.898240277772        initial
     2.5000e-01     2.5000e+00             1.0537e-02       -16.899173362120  <--
     1.0000e+00     1.0000e+01             3.5834e-03       -16.898605907909
     4.0000e+00     4.0000e+01             1.0202e-03       -16.898257951960

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0438e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
   uu_0                 3.033680e-01 1 1  ON 0
   uu_1                 1.396793e-01 1 1  ON 1
   uu_2                 4.162212e-02 1 1  ON 2
   uu_3                -1.850973e-02 1 1  ON 3
   uu_4                -6.235555e-02 1 1  ON 4
   uu_5                -9.573179e-02 1 1  ON 5
   uu_6                -1.213050e-01 1 1  ON 6
   uu_7                -1.319950e-01 1 1  ON 7
   uu_8                -1.214176e-01 1 1  ON 8
   uu_9                -9.348633e-02 1 1  ON 9
   ud_0                 4.219784e-01 1 1  ON 10
   ud_1                 1.652396e-01 1 1  ON 11
   ud_2                 5.786646e-02 1 1  ON 12
   ud_3                -3.962632e-03 1 1  ON 13
   ud_4                -6.027861e-02 1 1  ON 14
   ud_5                -1.024224e-01 1 1  ON 15
   ud_6                -1.295024e-01 1 1  ON 16
   ud_7                -1.445657e-01 1 1  ON 17
   ud_8                -1.438100e-01 1 1  ON 18
   ud_9                -1.347980e-01 1 1  ON 19
   eO_0                -7.138244e-01 1 1  ON 20
   eO_1                -4.145216e-01 1 1  ON 21
   eO_2                -2.507502e-02 1 1  ON 22
   eO_3                 2.735007e-01 1 1  ON 23
   eO_4                 4.929120e-01 1 1  ON 24
   eO_5                 4.589619e-01 1 1  ON 25
   eO_6                 2.359205e-01 1 1  ON 26
   eO_7                -5.568763e-02 1 1  ON 27
   eO_8                -1.967343e-01 1 1  ON 28
   eO_9                -5.830369e-02 1 1  ON 29
  eH1_0                -2.160477e-01 1 1  ON 30
  eH1_1                -1.295972e-01 1 1  ON 31
  eH1_2                -8.667388e-02 1 1  ON 32
  eH1_3                -3.502195e-02 1 1  ON 33
  eH1_4                 1.310245e-02 1 1  ON 34
  eH1_5                 4.532348e-02 1 1  ON 35
  eH1_6                 9.500772e-02 1 1  ON 36
  eH1_7                 1.385356e-01 1 1  ON 37
  eH1_8                 1.464985e-01 1 1  ON 38
  eH1_9                 3.352122e-02 1 1  ON 39
  eH2_0                -2.149865e-01 1 1  ON 40
  eH2_1                -1.282718e-01 1 1  ON 41
  eH2_2                -8.539605e-02 1 1  ON 42
  eH2_3                -3.394085e-02 1 1  ON 43
  eH2_4                 1.445043e-02 1 1  ON 44
  eH2_5                 4.838807e-02 1 1  ON 45
  eH2_6                 1.007906e-01 1 1  ON 46
  eH2_7                 1.494063e-01 1 1  ON 47
  eH2_8                 1.545205e-01 1 1  ON 48
  eH2_9                 1.366640e-02 1 1  ON 49
ci_0001                 6.974075e-01 3 1  ON 50
ci_0002                 6.971858e-01 3 1  ON 51
ci_0003                -3.950047e-02 3 1  ON 52
ci_0004                -3.960730e-02 3 1  ON 53
ci_0005                -4.255013e-02 3 1  ON 54
ci_0006                -4.303241e-02 3 1  ON 55
ci_0007                -3.023461e-02 3 1  ON 56
ci_0008                -3.111840e-02 3 1  ON 57
ci_0009                -2.447812e-02 3 1  ON 58
ci_0010                -2.467884e-02 3 1  ON 59
ci_0011                -2.052062e-02 3 1  ON 60
ci_0012                -2.049329e-02 3 1  ON 61
ci_0013                 2.064395e-02 3 1  ON 62
ci_0014                 2.002461e-02 3 1  ON 63
ci_0015                 2.004634e-02 3 1  ON 64
ci_0016                 2.020935e-02 3 1  ON 65
ci_0017                 1.786043e-02 3 1  ON 66
ci_0018                 1.793632e-02 3 1  ON 67
ci_0019                 1.615420e-02 3 1  ON 68
ci_0020                 1.550903e-02 3 1  ON 69
ci_0021                 1.433196e-02 3 1  ON 70
ci_0022                 1.390250e-02 3 1  ON 71
ci_0023                -1.467478e-02 3 1  ON 72
ci_0024                -1.496604e-02 3 1  ON 73
ci_0025                -1.562342e-02 3 1  ON 74
ci_0026                -1.503943e-02 3 1  ON 75
ci_0027                -1.466930e-02 3 1  ON 76
ci_0028                -1.459430e-02 3 1  ON 77
ci_0029                -1.370427e-02 3 1  ON 78
ci_0030                -1.366452e-02 3 1  ON 79
ci_0031                 1.812279e-02 3 1  ON 80
ci_0032                 1.775039e-02 3 1  ON 81
ci_0033                 1.384384e-02 3 1  ON 82
ci_0034                 1.462411e-02 3 1  ON 83
ci_0035                 1.205166e-02 3 1  ON 84
ci_0036                 1.214382e-02 3 1  ON 85
ci_0037                -1.248556e-02 3 1  ON 86
ci_0038                -1.326799e-02 3 1  ON 87
ci_0039                -7.847933e-03 3 1  ON 88
ci_0040                -7.719427e-03 3 1  ON 89
ci_0041                 1.154950e-02 3 1  ON 90
ci_0042                 1.154442e-02 3 1  ON 91
ci_0043                -1.504442e-02 3 1  ON 92
ci_0044                -1.512636e-02 3 1  ON 93
ci_0045                 1.186300e-02 3 1  ON 94
ci_0046                 1.145306e-02 3 1  ON 95
ci_0047                -7.111080e-03 3 1  ON 96
ci_0048                -7.316315e-03 3 1  ON 97
ci_0049                -9.659816e-03 3 1  ON 98
ci_0050                -9.968672e-03 3 1  ON 99
ci_0051                -8.110394e-03 3 1  ON 100
ci_0052                -7.772667e-03 3 1  ON 101
ci_0053                -8.249812e-03 3 1  ON 102
ci_0054                -7.997365e-03 3 1  ON 103
ci_0055                 9.727793e-03 3 1  ON 104
ci_0056                 1.065447e-02 3 1  ON 105
ci_0057                 9.159419e-03 3 1  ON 106
ci_0058                 9.178078e-03 3 1  ON 107
ci_0059                -8.236192e-03 3 1  ON 108
ci_0060                -8.364331e-03 3 1  ON 109
ci_0061                -8.369003e-03 3 1  ON 110
ci_0062                -7.598028e-03 3 1  ON 111
ci_0063                -1.039992e-02 3 1  ON 112
ci_0064                -1.020328e-02 3 1  ON 113
ci_0065                -8.339375e-03 3 1  ON 114
ci_0066                -8.357247e-03 3 1  ON 115
ci_0067                -7.528747e-03 3 1  ON 116
ci_0068                -7.574475e-03 3 1  ON 117
ci_0069                 7.364371e-03 3 1  ON 118
ci_0070                 7.512484e-03 3 1  ON 119
ci_0071                 6.241066e-03 3 1  ON 120
ci_0072                 6.113637e-03 3 1  ON 121
ci_0073                 6.411303e-03 3 1  ON 122
ci_0074                 7.318989e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8595e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6841e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9021
    reference variance = 0.407274
====================================================
  Execution time = 2.3690e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.5182e-01
  Total weights = 1.951199060e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1008e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336822793386
                                         uncertainty =       0.003606380872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336822793386
                                         uncertainty =       0.003606380872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410349891
  error estimate for blocks of size 2^( 2) =       0.000423712022
  error estimate for blocks of size 2^( 3) =       0.000438116618
  error estimate for blocks of size 2^( 4) =       0.000450383649
  error estimate for blocks of size 2^( 5) =       0.000461339233
  error estimate for blocks of size 2^( 6) =       0.000468423557
  error estimate for blocks of size 2^( 7) =       0.000471504853

      target function =                  N/A
              le_mean =     -16.902069838801
             les_mean =     286.031787283973
             stat err =       0.000462912823
             autocorr =       1.272593725803
              std dev =       0.580322380899
             le_variance =       0.336774065773


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690206983880e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.902069838822       residual = 5.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904188699223       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904392139401       residual = 6.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904532810319       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904648735193       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904676903529       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904722937672       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904756860836       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904781365299       residual = 9.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904777669322       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904776997418       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904777321942       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904778661492       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904777159960       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.904779448594       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.904780151329       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.904782101388       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.904783459250       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.904784351967       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.904784227055       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.904783832428       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.904783736925       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.904783578836       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.904783620965       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e-02 is 1.603610e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.902069838822       residual = 5.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903404614645       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903496146374       residual = 5.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903565203581       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.903619789305       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.903638142819       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.903656737222       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.903666297927       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.903674250087       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.903671142832       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.903670593799       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.903670548421       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.903670450917       residual = 9.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.903670284555       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.903670256846       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.903670427568       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.903670551318       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.5000e-01 is 6.936038e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.902069838822       residual = 5.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.902607922119       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.902639433038       residual = 4.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.902665050070       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.902682271791       residual = 8.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.902687952030       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.902694082580       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.902695732752       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.902698095563       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.902697364273       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.902697120941       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.902697099776       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.902697078966       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.902697032857       residual = 4.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.0000e+00 is 2.400740e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191739 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9809e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
   uu_0                 3.041113e-01 1 1  ON 0
   uu_1                 1.400913e-01 1 1  ON 1
   uu_2                 4.141003e-02 1 1  ON 2
   uu_3                -1.845041e-02 1 1  ON 3
   uu_4                -6.193252e-02 1 1  ON 4
   uu_5                -9.566699e-02 1 1  ON 5
   uu_6                -1.213593e-01 1 1  ON 6
   uu_7                -1.327573e-01 1 1  ON 7
   uu_8                -1.226197e-01 1 1  ON 8
   uu_9                -9.400793e-02 1 1  ON 9
   ud_0                 4.288845e-01 1 1  ON 10
   ud_1                 1.690323e-01 1 1  ON 11
   ud_2                 5.663020e-02 1 1  ON 12
   ud_3                -7.855297e-03 1 1  ON 13
   ud_4                -6.260321e-02 1 1  ON 14
   ud_5                -1.035825e-01 1 1  ON 15
   ud_6                -1.302868e-01 1 1  ON 16
   ud_7                -1.453858e-01 1 1  ON 17
   ud_8                -1.445693e-01 1 1  ON 18
   ud_9                -1.347605e-01 1 1  ON 19
   eO_0                -7.207605e-01 1 1  ON 20
   eO_1                -4.153486e-01 1 1  ON 21
   eO_2                -2.111034e-02 1 1  ON 22
   eO_3                 2.768323e-01 1 1  ON 23
   eO_4                 4.945045e-01 1 1  ON 24
   eO_5                 4.587618e-01 1 1  ON 25
   eO_6                 2.361448e-01 1 1  ON 26
   eO_7                -5.551729e-02 1 1  ON 27
   eO_8                -1.975364e-01 1 1  ON 28
   eO_9                -5.879344e-02 1 1  ON 29
  eH1_0                -2.212064e-01 1 1  ON 30
  eH1_1                -1.308759e-01 1 1  ON 31
  eH1_2                -8.590425e-02 1 1  ON 32
  eH1_3                -3.383433e-02 1 1  ON 33
  eH1_4                 1.442600e-02 1 1  ON 34
  eH1_5                 4.579083e-02 1 1  ON 35
  eH1_6                 9.563188e-02 1 1  ON 36
  eH1_7                 1.392083e-01 1 1  ON 37
  eH1_8                 1.472484e-01 1 1  ON 38
  eH1_9                 3.419420e-02 1 1  ON 39
  eH2_0                -2.202600e-01 1 1  ON 40
  eH2_1                -1.294658e-01 1 1  ON 41
  eH2_2                -8.441197e-02 1 1  ON 42
  eH2_3                -3.242068e-02 1 1  ON 43
  eH2_4                 1.588595e-02 1 1  ON 44
  eH2_5                 4.882684e-02 1 1  ON 45
  eH2_6                 1.011300e-01 1 1  ON 46
  eH2_7                 1.493495e-01 1 1  ON 47
  eH2_8                 1.552224e-01 1 1  ON 48
  eH2_9                 1.466363e-02 1 1  ON 49
ci_0001                 6.991636e-01 3 1  ON 50
ci_0002                 6.988083e-01 3 1  ON 51
ci_0003                -3.434380e-02 3 1  ON 52
ci_0004                -3.434384e-02 3 1  ON 53
ci_0005                -4.086264e-02 3 1  ON 54
ci_0006                -4.109831e-02 3 1  ON 55
ci_0007                -2.813542e-02 3 1  ON 56
ci_0008                -2.853714e-02 3 1  ON 57
ci_0009                -2.115871e-02 3 1  ON 58
ci_0010                -2.116596e-02 3 1  ON 59
ci_0011                -1.674083e-02 3 1  ON 60
ci_0012                -1.669704e-02 3 1  ON 61
ci_0013                 1.708387e-02 3 1  ON 62
ci_0014                 1.696550e-02 3 1  ON 63
ci_0015                 1.724566e-02 3 1  ON 64
ci_0016                 1.698827e-02 3 1  ON 65
ci_0017                 1.456175e-02 3 1  ON 66
ci_0018                 1.440160e-02 3 1  ON 67
ci_0019                 1.377233e-02 3 1  ON 68
ci_0020                 1.324694e-02 3 1  ON 69
ci_0021                 1.000680e-02 3 1  ON 70
ci_0022                 9.673316e-03 3 1  ON 71
ci_0023                -1.310869e-02 3 1  ON 72
ci_0024                -1.304579e-02 3 1  ON 73
ci_0025                -1.398507e-02 3 1  ON 74
ci_0026                -1.352188e-02 3 1  ON 75
ci_0027                -1.284717e-02 3 1  ON 76
ci_0028                -1.228701e-02 3 1  ON 77
ci_0029                -1.227180e-02 3 1  ON 78
ci_0030                -1.230408e-02 3 1  ON 79
ci_0031                 1.925670e-02 3 1  ON 80
ci_0032                 1.908753e-02 3 1  ON 81
ci_0033                 1.317498e-02 3 1  ON 82
ci_0034                 1.283647e-02 3 1  ON 83
ci_0035                 9.893277e-03 3 1  ON 84
ci_0036                 1.022511e-02 3 1  ON 85
ci_0037                -1.181216e-02 3 1  ON 86
ci_0038                -1.248512e-02 3 1  ON 87
ci_0039                -5.271183e-03 3 1  ON 88
ci_0040                -5.014055e-03 3 1  ON 89
ci_0041                 9.385145e-03 3 1  ON 90
ci_0042                 9.192416e-03 3 1  ON 91
ci_0043                -1.609753e-02 3 1  ON 92
ci_0044                -1.620531e-02 3 1  ON 93
ci_0045                 1.068428e-02 3 1  ON 94
ci_0046                 1.001883e-02 3 1  ON 95
ci_0047                -3.994380e-03 3 1  ON 96
ci_0048                -4.179919e-03 3 1  ON 97
ci_0049                -7.188873e-03 3 1  ON 98
ci_0050                -8.305238e-03 3 1  ON 99
ci_0051                -5.959380e-03 3 1  ON 100
ci_0052                -5.455421e-03 3 1  ON 101
ci_0053                -6.545615e-03 3 1  ON 102
ci_0054                -6.192673e-03 3 1  ON 103
ci_0055                 8.887984e-03 3 1  ON 104
ci_0056                 8.308442e-03 3 1  ON 105
ci_0057                 7.592980e-03 3 1  ON 106
ci_0058                 7.279387e-03 3 1  ON 107
ci_0059                -6.866631e-03 3 1  ON 108
ci_0060                -6.533438e-03 3 1  ON 109
ci_0061                -6.597541e-03 3 1  ON 110
ci_0062                -5.876444e-03 3 1  ON 111
ci_0063                -1.009040e-02 3 1  ON 112
ci_0064                -8.926260e-03 3 1  ON 113
ci_0065                -7.450948e-03 3 1  ON 114
ci_0066                -6.695487e-03 3 1  ON 115
ci_0067                -5.812984e-03 3 1  ON 116
ci_0068                -5.878997e-03 3 1  ON 117
ci_0069                 5.963876e-03 3 1  ON 118
ci_0070                 5.641787e-03 3 1  ON 119
ci_0071                 4.369898e-03 3 1  ON 120
ci_0072                 4.039934e-03 3 1  ON 121
ci_0073                 5.232132e-03 3 1  ON 122
ci_0074                 5.826168e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8901
    reference variance = 0.249668
====================================================
  Execution time = 2.1063e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4004e-01
  Total weights = 1.9512e+06
  Execution time = 1.8970e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.390271814586
                                         uncertainty =       0.031800501124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.390271814586
                                         uncertainty =       0.031800501124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000441562379
  error estimate for blocks of size 2^( 2) =       0.000453850511
  error estimate for blocks of size 2^( 3) =       0.000465883673
  error estimate for blocks of size 2^( 4) =       0.000476857289
  error estimate for blocks of size 2^( 5) =       0.000487355985
  error estimate for blocks of size 2^( 6) =       0.000496837155
  error estimate for blocks of size 2^( 7) =       0.000501606844

      target function =                  N/A
              le_mean =     -16.905449603164
             les_mean =     286.683450108140
             stat err =       0.000490664318
             autocorr =       1.234766461719
              std dev =       0.624463504377
             le_variance =       0.389954668299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323556697721
                                         uncertainty =       0.003706833515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323556697721
                                         uncertainty =       0.003706833515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402158429
  error estimate for blocks of size 2^( 2) =       0.000415061204
  error estimate for blocks of size 2^( 3) =       0.000427862628
  error estimate for blocks of size 2^( 4) =       0.000439743568
  error estimate for blocks of size 2^( 5) =       0.000450828921
  error estimate for blocks of size 2^( 6) =       0.000461530506
  error estimate for blocks of size 2^( 7) =       0.000467041473

      target function =                  N/A
              le_mean =     -16.905474820966
             les_mean =     286.185836347205
             stat err =       0.000454786117
             autocorr =       1.278851293796
              std dev =       0.568737903828
             le_variance =       0.323462803250

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324491930596
                                         uncertainty =       0.003767038068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324491930596
                                         uncertainty =       0.003767038068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402736706
  error estimate for blocks of size 2^( 2) =       0.000415701636
  error estimate for blocks of size 2^( 3) =       0.000428711212
  error estimate for blocks of size 2^( 4) =       0.000440625055
  error estimate for blocks of size 2^( 5) =       0.000451711543
  error estimate for blocks of size 2^( 6) =       0.000462472358
  error estimate for blocks of size 2^( 7) =       0.000468012514

      target function =                  N/A
              le_mean =     -16.905882095260
             les_mean =     286.193178390494
             stat err =       0.000455705367
             autocorr =       1.280341611861
              std dev =       0.569555711667
             le_variance =       0.324393708693

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.374927175117
                                         uncertainty =       0.036878100835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.374927175117
                                         uncertainty =       0.036878100835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000432799855
  error estimate for blocks of size 2^( 2) =       0.000445066621
  error estimate for blocks of size 2^( 3) =       0.000457000662
  error estimate for blocks of size 2^( 4) =       0.000468385904
  error estimate for blocks of size 2^( 5) =       0.000478842002
  error estimate for blocks of size 2^( 6) =       0.000489190083
  error estimate for blocks of size 2^( 7) =       0.000494666870

      target function =                  N/A
              le_mean =     -16.905318874170
             les_mean =     286.338877612934
             stat err =       0.000482771215
             autocorr =       1.244252498326
              std dev =       0.612071424693
             le_variance =       0.374631428926


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905449603164        initial
     6.2500e-02     6.2500e-01             1.6036e-02       -16.905474820966
     2.5000e-01     2.5000e+00             6.9360e-03       -16.905882095260  <--
     1.0000e+00     1.0000e+01             2.4007e-03       -16.905318874170

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0598e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
   uu_0                 3.041113e-01 1 1  ON 0
   uu_1                 1.400913e-01 1 1  ON 1
   uu_2                 4.141003e-02 1 1  ON 2
   uu_3                -1.845041e-02 1 1  ON 3
   uu_4                -6.193252e-02 1 1  ON 4
   uu_5                -9.566699e-02 1 1  ON 5
   uu_6                -1.213593e-01 1 1  ON 6
   uu_7                -1.327573e-01 1 1  ON 7
   uu_8                -1.226197e-01 1 1  ON 8
   uu_9                -9.400793e-02 1 1  ON 9
   ud_0                 4.288845e-01 1 1  ON 10
   ud_1                 1.690323e-01 1 1  ON 11
   ud_2                 5.663020e-02 1 1  ON 12
   ud_3                -7.855297e-03 1 1  ON 13
   ud_4                -6.260321e-02 1 1  ON 14
   ud_5                -1.035825e-01 1 1  ON 15
   ud_6                -1.302868e-01 1 1  ON 16
   ud_7                -1.453858e-01 1 1  ON 17
   ud_8                -1.445693e-01 1 1  ON 18
   ud_9                -1.347605e-01 1 1  ON 19
   eO_0                -7.207605e-01 1 1  ON 20
   eO_1                -4.153486e-01 1 1  ON 21
   eO_2                -2.111034e-02 1 1  ON 22
   eO_3                 2.768323e-01 1 1  ON 23
   eO_4                 4.945045e-01 1 1  ON 24
   eO_5                 4.587618e-01 1 1  ON 25
   eO_6                 2.361448e-01 1 1  ON 26
   eO_7                -5.551729e-02 1 1  ON 27
   eO_8                -1.975364e-01 1 1  ON 28
   eO_9                -5.879344e-02 1 1  ON 29
  eH1_0                -2.212064e-01 1 1  ON 30
  eH1_1                -1.308759e-01 1 1  ON 31
  eH1_2                -8.590425e-02 1 1  ON 32
  eH1_3                -3.383433e-02 1 1  ON 33
  eH1_4                 1.442600e-02 1 1  ON 34
  eH1_5                 4.579083e-02 1 1  ON 35
  eH1_6                 9.563188e-02 1 1  ON 36
  eH1_7                 1.392083e-01 1 1  ON 37
  eH1_8                 1.472484e-01 1 1  ON 38
  eH1_9                 3.419420e-02 1 1  ON 39
  eH2_0                -2.202600e-01 1 1  ON 40
  eH2_1                -1.294658e-01 1 1  ON 41
  eH2_2                -8.441197e-02 1 1  ON 42
  eH2_3                -3.242068e-02 1 1  ON 43
  eH2_4                 1.588595e-02 1 1  ON 44
  eH2_5                 4.882684e-02 1 1  ON 45
  eH2_6                 1.011300e-01 1 1  ON 46
  eH2_7                 1.493495e-01 1 1  ON 47
  eH2_8                 1.552224e-01 1 1  ON 48
  eH2_9                 1.466363e-02 1 1  ON 49
ci_0001                 6.991636e-01 3 1  ON 50
ci_0002                 6.988083e-01 3 1  ON 51
ci_0003                -3.434380e-02 3 1  ON 52
ci_0004                -3.434384e-02 3 1  ON 53
ci_0005                -4.086264e-02 3 1  ON 54
ci_0006                -4.109831e-02 3 1  ON 55
ci_0007                -2.813542e-02 3 1  ON 56
ci_0008                -2.853714e-02 3 1  ON 57
ci_0009                -2.115871e-02 3 1  ON 58
ci_0010                -2.116596e-02 3 1  ON 59
ci_0011                -1.674083e-02 3 1  ON 60
ci_0012                -1.669704e-02 3 1  ON 61
ci_0013                 1.708387e-02 3 1  ON 62
ci_0014                 1.696550e-02 3 1  ON 63
ci_0015                 1.724566e-02 3 1  ON 64
ci_0016                 1.698827e-02 3 1  ON 65
ci_0017                 1.456175e-02 3 1  ON 66
ci_0018                 1.440160e-02 3 1  ON 67
ci_0019                 1.377233e-02 3 1  ON 68
ci_0020                 1.324694e-02 3 1  ON 69
ci_0021                 1.000680e-02 3 1  ON 70
ci_0022                 9.673316e-03 3 1  ON 71
ci_0023                -1.310869e-02 3 1  ON 72
ci_0024                -1.304579e-02 3 1  ON 73
ci_0025                -1.398507e-02 3 1  ON 74
ci_0026                -1.352188e-02 3 1  ON 75
ci_0027                -1.284717e-02 3 1  ON 76
ci_0028                -1.228701e-02 3 1  ON 77
ci_0029                -1.227180e-02 3 1  ON 78
ci_0030                -1.230408e-02 3 1  ON 79
ci_0031                 1.925670e-02 3 1  ON 80
ci_0032                 1.908753e-02 3 1  ON 81
ci_0033                 1.317498e-02 3 1  ON 82
ci_0034                 1.283647e-02 3 1  ON 83
ci_0035                 9.893277e-03 3 1  ON 84
ci_0036                 1.022511e-02 3 1  ON 85
ci_0037                -1.181216e-02 3 1  ON 86
ci_0038                -1.248512e-02 3 1  ON 87
ci_0039                -5.271183e-03 3 1  ON 88
ci_0040                -5.014055e-03 3 1  ON 89
ci_0041                 9.385145e-03 3 1  ON 90
ci_0042                 9.192416e-03 3 1  ON 91
ci_0043                -1.609753e-02 3 1  ON 92
ci_0044                -1.620531e-02 3 1  ON 93
ci_0045                 1.068428e-02 3 1  ON 94
ci_0046                 1.001883e-02 3 1  ON 95
ci_0047                -3.994380e-03 3 1  ON 96
ci_0048                -4.179919e-03 3 1  ON 97
ci_0049                -7.188873e-03 3 1  ON 98
ci_0050                -8.305238e-03 3 1  ON 99
ci_0051                -5.959380e-03 3 1  ON 100
ci_0052                -5.455421e-03 3 1  ON 101
ci_0053                -6.545615e-03 3 1  ON 102
ci_0054                -6.192673e-03 3 1  ON 103
ci_0055                 8.887984e-03 3 1  ON 104
ci_0056                 8.308442e-03 3 1  ON 105
ci_0057                 7.592980e-03 3 1  ON 106
ci_0058                 7.279387e-03 3 1  ON 107
ci_0059                -6.866631e-03 3 1  ON 108
ci_0060                -6.533438e-03 3 1  ON 109
ci_0061                -6.597541e-03 3 1  ON 110
ci_0062                -5.876444e-03 3 1  ON 111
ci_0063                -1.009040e-02 3 1  ON 112
ci_0064                -8.926260e-03 3 1  ON 113
ci_0065                -7.450948e-03 3 1  ON 114
ci_0066                -6.695487e-03 3 1  ON 115
ci_0067                -5.812984e-03 3 1  ON 116
ci_0068                -5.878997e-03 3 1  ON 117
ci_0069                 5.963876e-03 3 1  ON 118
ci_0070                 5.641787e-03 3 1  ON 119
ci_0071                 4.369898e-03 3 1  ON 120
ci_0072                 4.039934e-03 3 1  ON 121
ci_0073                 5.232132e-03 3 1  ON 122
ci_0074                 5.826168e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0414e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6868e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.898
    reference variance = 0.196462
====================================================
  Execution time = 2.1375e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5227e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3467e-01
  Total weights = 1.951521381e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0939e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321160912171
                                         uncertainty =       0.002133822010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321160912171
                                         uncertainty =       0.002133822010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400766424
  error estimate for blocks of size 2^( 2) =       0.000413801660
  error estimate for blocks of size 2^( 3) =       0.000427258164
  error estimate for blocks of size 2^( 4) =       0.000440163786
  error estimate for blocks of size 2^( 5) =       0.000451386197
  error estimate for blocks of size 2^( 6) =       0.000460425311
  error estimate for blocks of size 2^( 7) =       0.000467652870

      target function =                  N/A
              le_mean =     -16.904263835094
             les_mean =     286.088803384887
             stat err =       0.000454907041
             autocorr =       1.288435430588
              std dev =       0.566769312399
             le_variance =       0.321227453478


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690426383509e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904263835085       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904769079005       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904839538698       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904908816383       residual = 6.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904946246995       residual = 6.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904965717800       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904994370947       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904996950794       residual = 8.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905006220423       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905015016162       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905011731502       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905010509039       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905010152843       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905009128481       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905008132101       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905011322794       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905011643370       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905012143728       residual = 9.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905011970366       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905011931684       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905012286347       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905012327015       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905012491092       residual = 8.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e-02 is 1.268381e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904263835085       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904577226813       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904606044361       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904640049394       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904658975347       residual = 4.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904669973657       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904677614707       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904678891818       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904680392220       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904682916598       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904681962006       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904681869036       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904681548046       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904681066871       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.904681145535       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.904681411604       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.5000e-01 is 5.216491e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904263835085       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904388246612       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904396679126       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904407792137       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904414375939       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904418889207       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904420412940       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904420797442       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904420660206       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904420869519       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904420989072       residual = 7.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904420991945       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904420973983       residual = 8.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.0000e+00 is 1.620595e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.203981 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7485e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
   uu_0                 3.051658e-01 1 1  ON 0
   uu_1                 1.403072e-01 1 1  ON 1
   uu_2                 4.103316e-02 1 1  ON 2
   uu_3                -1.879975e-02 1 1  ON 3
   uu_4                -6.216549e-02 1 1  ON 4
   uu_5                -9.566615e-02 1 1  ON 5
   uu_6                -1.214399e-01 1 1  ON 6
   uu_7                -1.330491e-01 1 1  ON 7
   uu_8                -1.234195e-01 1 1  ON 8
   uu_9                -9.410770e-02 1 1  ON 9
   ud_0                 4.331201e-01 1 1  ON 10
   ud_1                 1.711139e-01 1 1  ON 11
   ud_2                 5.615150e-02 1 1  ON 12
   ud_3                -9.919889e-03 1 1  ON 13
   ud_4                -6.434801e-02 1 1  ON 14
   ud_5                -1.046589e-01 1 1  ON 15
   ud_6                -1.310908e-01 1 1  ON 16
   ud_7                -1.458028e-01 1 1  ON 17
   ud_8                -1.444130e-01 1 1  ON 18
   ud_9                -1.344426e-01 1 1  ON 19
   eO_0                -7.259770e-01 1 1  ON 20
   eO_1                -4.164201e-01 1 1  ON 21
   eO_2                -1.871895e-02 1 1  ON 22
   eO_3                 2.796935e-01 1 1  ON 23
   eO_4                 4.964491e-01 1 1  ON 24
   eO_5                 4.585672e-01 1 1  ON 25
   eO_6                 2.361555e-01 1 1  ON 26
   eO_7                -5.507849e-02 1 1  ON 27
   eO_8                -1.981027e-01 1 1  ON 28
   eO_9                -5.932497e-02 1 1  ON 29
  eH1_0                -2.249621e-01 1 1  ON 30
  eH1_1                -1.317522e-01 1 1  ON 31
  eH1_2                -8.543943e-02 1 1  ON 32
  eH1_3                -3.327519e-02 1 1  ON 33
  eH1_4                 1.482645e-02 1 1  ON 34
  eH1_5                 4.621755e-02 1 1  ON 35
  eH1_6                 9.618874e-02 1 1  ON 36
  eH1_7                 1.398358e-01 1 1  ON 37
  eH1_8                 1.480135e-01 1 1  ON 38
  eH1_9                 3.497054e-02 1 1  ON 39
  eH2_0                -2.241643e-01 1 1  ON 40
  eH2_1                -1.301523e-01 1 1  ON 41
  eH2_2                -8.384996e-02 1 1  ON 42
  eH2_3                -3.160706e-02 1 1  ON 43
  eH2_4                 1.687377e-02 1 1  ON 44
  eH2_5                 4.927338e-02 1 1  ON 45
  eH2_6                 1.011824e-01 1 1  ON 46
  eH2_7                 1.494490e-01 1 1  ON 47
  eH2_8                 1.559008e-01 1 1  ON 48
  eH2_9                 1.554109e-02 1 1  ON 49
ci_0001                 7.001503e-01 3 1  ON 50
ci_0002                 6.994331e-01 3 1  ON 51
ci_0003                -3.123160e-02 3 1  ON 52
ci_0004                -3.142761e-02 3 1  ON 53
ci_0005                -3.979941e-02 3 1  ON 54
ci_0006                -3.997322e-02 3 1  ON 55
ci_0007                -2.689182e-02 3 1  ON 56
ci_0008                -2.747687e-02 3 1  ON 57
ci_0009                -1.953866e-02 3 1  ON 58
ci_0010                -1.917536e-02 3 1  ON 59
ci_0011                -1.479835e-02 3 1  ON 60
ci_0012                -1.482075e-02 3 1  ON 61
ci_0013                 1.541293e-02 3 1  ON 62
ci_0014                 1.538869e-02 3 1  ON 63
ci_0015                 1.534645e-02 3 1  ON 64
ci_0016                 1.519120e-02 3 1  ON 65
ci_0017                 1.240534e-02 3 1  ON 66
ci_0018                 1.276443e-02 3 1  ON 67
ci_0019                 1.298670e-02 3 1  ON 68
ci_0020                 1.209401e-02 3 1  ON 69
ci_0021                 7.078414e-03 3 1  ON 70
ci_0022                 7.232168e-03 3 1  ON 71
ci_0023                -1.201854e-02 3 1  ON 72
ci_0024                -1.190146e-02 3 1  ON 73
ci_0025                -1.238527e-02 3 1  ON 74
ci_0026                -1.220939e-02 3 1  ON 75
ci_0027                -1.191473e-02 3 1  ON 76
ci_0028                -1.166807e-02 3 1  ON 77
ci_0029                -1.103314e-02 3 1  ON 78
ci_0030                -1.146027e-02 3 1  ON 79
ci_0031                 1.906781e-02 3 1  ON 80
ci_0032                 1.965394e-02 3 1  ON 81
ci_0033                 1.232702e-02 3 1  ON 82
ci_0034                 1.207221e-02 3 1  ON 83
ci_0035                 8.835303e-03 3 1  ON 84
ci_0036                 9.020448e-03 3 1  ON 85
ci_0037                -1.065511e-02 3 1  ON 86
ci_0038                -1.181105e-02 3 1  ON 87
ci_0039                -3.556372e-03 3 1  ON 88
ci_0040                -3.930124e-03 3 1  ON 89
ci_0041                 8.728336e-03 3 1  ON 90
ci_0042                 8.405810e-03 3 1  ON 91
ci_0043                -1.609029e-02 3 1  ON 92
ci_0044                -1.668564e-02 3 1  ON 93
ci_0045                 9.469953e-03 3 1  ON 94
ci_0046                 9.076740e-03 3 1  ON 95
ci_0047                -2.602077e-03 3 1  ON 96
ci_0048                -2.947835e-03 3 1  ON 97
ci_0049                -5.969921e-03 3 1  ON 98
ci_0050                -7.148670e-03 3 1  ON 99
ci_0051                -4.327952e-03 3 1  ON 100
ci_0052                -4.376187e-03 3 1  ON 101
ci_0053                -5.829099e-03 3 1  ON 102
ci_0054                -5.577318e-03 3 1  ON 103
ci_0055                 7.563920e-03 3 1  ON 104
ci_0056                 7.465179e-03 3 1  ON 105
ci_0057                 6.476011e-03 3 1  ON 106
ci_0058                 6.499145e-03 3 1  ON 107
ci_0059                -5.727312e-03 3 1  ON 108
ci_0060                -5.790597e-03 3 1  ON 109
ci_0061                -5.868245e-03 3 1  ON 110
ci_0062                -4.948968e-03 3 1  ON 111
ci_0063                -9.484210e-03 3 1  ON 112
ci_0064                -8.859019e-03 3 1  ON 113
ci_0065                -6.811596e-03 3 1  ON 114
ci_0066                -6.364396e-03 3 1  ON 115
ci_0067                -5.460523e-03 3 1  ON 116
ci_0068                -5.392257e-03 3 1  ON 117
ci_0069                 5.064483e-03 3 1  ON 118
ci_0070                 5.172918e-03 3 1  ON 119
ci_0071                 2.915064e-03 3 1  ON 120
ci_0072                 2.982565e-03 3 1  ON 121
ci_0073                 4.758016e-03 3 1  ON 122
ci_0074                 4.612250e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9174
    reference variance = 0.219955
====================================================
  Execution time = 2.1043e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3391e-01
  Total weights = 1.9516e+06
  Execution time = 1.8923e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.126094
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326153721867
                                         uncertainty =       0.002475208275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326153721867
                                         uncertainty =       0.002475208275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403844120
  error estimate for blocks of size 2^( 2) =       0.000417048209
  error estimate for blocks of size 2^( 3) =       0.000430555086
  error estimate for blocks of size 2^( 4) =       0.000443530872
  error estimate for blocks of size 2^( 5) =       0.000454630182
  error estimate for blocks of size 2^( 6) =       0.000462912063
  error estimate for blocks of size 2^( 7) =       0.000469075626

      target function =                  N/A
              le_mean =     -16.905512700803
             les_mean =     286.337332721566
             stat err =       0.000457537186
             autocorr =       1.283586869648
              std dev =       0.571121831160
             le_variance =       0.326180146028

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323227524016
                                         uncertainty =       0.002531797711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323227524016
                                         uncertainty =       0.002531797711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402025506
  error estimate for blocks of size 2^( 2) =       0.000415170089
  error estimate for blocks of size 2^( 3) =       0.000428644848
  error estimate for blocks of size 2^( 4) =       0.000441737506
  error estimate for blocks of size 2^( 5) =       0.000452888865
  error estimate for blocks of size 2^( 6) =       0.000461108572
  error estimate for blocks of size 2^( 7) =       0.000467048203

      target function =                  N/A
              le_mean =     -16.905390489092
             les_mean =     286.137613765976
             stat err =       0.000455695786
             autocorr =       1.284821545298
              std dev =       0.568549923290
             le_variance =       0.323249015273

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.112758
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325742464129
                                         uncertainty =       0.003711437800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325742464129
                                         uncertainty =       0.003711437800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403583479
  error estimate for blocks of size 2^( 2) =       0.000416726184
  error estimate for blocks of size 2^( 3) =       0.000430235015
  error estimate for blocks of size 2^( 4) =       0.000443341098
  error estimate for blocks of size 2^( 5) =       0.000454448314
  error estimate for blocks of size 2^( 6) =       0.000462533391
  error estimate for blocks of size 2^( 7) =       0.000468226190

      target function =                  N/A
              le_mean =     -16.905443635835
             les_mean =     286.868656595652
             stat err =       0.000457137248
             autocorr =       1.282999418286
              std dev =       0.570753229922
             le_variance =       0.325759249466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323486546629
                                         uncertainty =       0.002444639342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323486546629
                                         uncertainty =       0.002444639342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402190072
  error estimate for blocks of size 2^( 2) =       0.000415400572
  error estimate for blocks of size 2^( 3) =       0.000428933706
  error estimate for blocks of size 2^( 4) =       0.000441959346
  error estimate for blocks of size 2^( 5) =       0.000453160725
  error estimate for blocks of size 2^( 6) =       0.000461409694
  error estimate for blocks of size 2^( 7) =       0.000467498203

      target function =                  N/A
              le_mean =     -16.905369396213
             les_mean =     286.133625619824
             stat err =       0.000456006992
             autocorr =       1.285524365759
              std dev =       0.568782653911
             le_variance =       0.323513707390


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905512700803        initial  <--
     6.2500e-02     6.2500e-01             1.2684e-02       -16.905390489092
     2.5000e-01     2.5000e+00             5.2165e-03       -16.905443635835
     1.0000e+00     1.0000e+01             1.6206e-03       -16.905369396213

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6013
  </log>
  <optVariables href="H2O.s002.opt.xml">
   uu_0                 3.041113e-01 1 1  ON 0
   uu_1                 1.400913e-01 1 1  ON 1
   uu_2                 4.141003e-02 1 1  ON 2
   uu_3                -1.845041e-02 1 1  ON 3
   uu_4                -6.193252e-02 1 1  ON 4
   uu_5                -9.566699e-02 1 1  ON 5
   uu_6                -1.213593e-01 1 1  ON 6
   uu_7                -1.327573e-01 1 1  ON 7
   uu_8                -1.226197e-01 1 1  ON 8
   uu_9                -9.400793e-02 1 1  ON 9
   ud_0                 4.288845e-01 1 1  ON 10
   ud_1                 1.690323e-01 1 1  ON 11
   ud_2                 5.663020e-02 1 1  ON 12
   ud_3                -7.855297e-03 1 1  ON 13
   ud_4                -6.260321e-02 1 1  ON 14
   ud_5                -1.035825e-01 1 1  ON 15
   ud_6                -1.302868e-01 1 1  ON 16
   ud_7                -1.453858e-01 1 1  ON 17
   ud_8                -1.445693e-01 1 1  ON 18
   ud_9                -1.347605e-01 1 1  ON 19
   eO_0                -7.207605e-01 1 1  ON 20
   eO_1                -4.153486e-01 1 1  ON 21
   eO_2                -2.111034e-02 1 1  ON 22
   eO_3                 2.768323e-01 1 1  ON 23
   eO_4                 4.945045e-01 1 1  ON 24
   eO_5                 4.587618e-01 1 1  ON 25
   eO_6                 2.361448e-01 1 1  ON 26
   eO_7                -5.551729e-02 1 1  ON 27
   eO_8                -1.975364e-01 1 1  ON 28
   eO_9                -5.879344e-02 1 1  ON 29
  eH1_0                -2.212064e-01 1 1  ON 30
  eH1_1                -1.308759e-01 1 1  ON 31
  eH1_2                -8.590425e-02 1 1  ON 32
  eH1_3                -3.383433e-02 1 1  ON 33
  eH1_4                 1.442600e-02 1 1  ON 34
  eH1_5                 4.579083e-02 1 1  ON 35
  eH1_6                 9.563188e-02 1 1  ON 36
  eH1_7                 1.392083e-01 1 1  ON 37
  eH1_8                 1.472484e-01 1 1  ON 38
  eH1_9                 3.419420e-02 1 1  ON 39
  eH2_0                -2.202600e-01 1 1  ON 40
  eH2_1                -1.294658e-01 1 1  ON 41
  eH2_2                -8.441197e-02 1 1  ON 42
  eH2_3                -3.242068e-02 1 1  ON 43
  eH2_4                 1.588595e-02 1 1  ON 44
  eH2_5                 4.882684e-02 1 1  ON 45
  eH2_6                 1.011300e-01 1 1  ON 46
  eH2_7                 1.493495e-01 1 1  ON 47
  eH2_8                 1.552224e-01 1 1  ON 48
  eH2_9                 1.466363e-02 1 1  ON 49
ci_0001                 6.991636e-01 3 1  ON 50
ci_0002                 6.988083e-01 3 1  ON 51
ci_0003                -3.434380e-02 3 1  ON 52
ci_0004                -3.434384e-02 3 1  ON 53
ci_0005                -4.086264e-02 3 1  ON 54
ci_0006                -4.109831e-02 3 1  ON 55
ci_0007                -2.813542e-02 3 1  ON 56
ci_0008                -2.853714e-02 3 1  ON 57
ci_0009                -2.115871e-02 3 1  ON 58
ci_0010                -2.116596e-02 3 1  ON 59
ci_0011                -1.674083e-02 3 1  ON 60
ci_0012                -1.669704e-02 3 1  ON 61
ci_0013                 1.708387e-02 3 1  ON 62
ci_0014                 1.696550e-02 3 1  ON 63
ci_0015                 1.724566e-02 3 1  ON 64
ci_0016                 1.698827e-02 3 1  ON 65
ci_0017                 1.456175e-02 3 1  ON 66
ci_0018                 1.440160e-02 3 1  ON 67
ci_0019                 1.377233e-02 3 1  ON 68
ci_0020                 1.324694e-02 3 1  ON 69
ci_0021                 1.000680e-02 3 1  ON 70
ci_0022                 9.673316e-03 3 1  ON 71
ci_0023                -1.310869e-02 3 1  ON 72
ci_0024                -1.304579e-02 3 1  ON 73
ci_0025                -1.398507e-02 3 1  ON 74
ci_0026                -1.352188e-02 3 1  ON 75
ci_0027                -1.284717e-02 3 1  ON 76
ci_0028                -1.228701e-02 3 1  ON 77
ci_0029                -1.227180e-02 3 1  ON 78
ci_0030                -1.230408e-02 3 1  ON 79
ci_0031                 1.925670e-02 3 1  ON 80
ci_0032                 1.908753e-02 3 1  ON 81
ci_0033                 1.317498e-02 3 1  ON 82
ci_0034                 1.283647e-02 3 1  ON 83
ci_0035                 9.893277e-03 3 1  ON 84
ci_0036                 1.022511e-02 3 1  ON 85
ci_0037                -1.181216e-02 3 1  ON 86
ci_0038                -1.248512e-02 3 1  ON 87
ci_0039                -5.271183e-03 3 1  ON 88
ci_0040                -5.014055e-03 3 1  ON 89
ci_0041                 9.385145e-03 3 1  ON 90
ci_0042                 9.192416e-03 3 1  ON 91
ci_0043                -1.609753e-02 3 1  ON 92
ci_0044                -1.620531e-02 3 1  ON 93
ci_0045                 1.068428e-02 3 1  ON 94
ci_0046                 1.001883e-02 3 1  ON 95
ci_0047                -3.994380e-03 3 1  ON 96
ci_0048                -4.179919e-03 3 1  ON 97
ci_0049                -7.188873e-03 3 1  ON 98
ci_0050                -8.305238e-03 3 1  ON 99
ci_0051                -5.959380e-03 3 1  ON 100
ci_0052                -5.455421e-03 3 1  ON 101
ci_0053                -6.545615e-03 3 1  ON 102
ci_0054                -6.192673e-03 3 1  ON 103
ci_0055                 8.887984e-03 3 1  ON 104
ci_0056                 8.308442e-03 3 1  ON 105
ci_0057                 7.592980e-03 3 1  ON 106
ci_0058                 7.279387e-03 3 1  ON 107
ci_0059                -6.866631e-03 3 1  ON 108
ci_0060                -6.533438e-03 3 1  ON 109
ci_0061                -6.597541e-03 3 1  ON 110
ci_0062                -5.876444e-03 3 1  ON 111
ci_0063                -1.009040e-02 3 1  ON 112
ci_0064                -8.926260e-03 3 1  ON 113
ci_0065                -7.450948e-03 3 1  ON 114
ci_0066                -6.695487e-03 3 1  ON 115
ci_0067                -5.812984e-03 3 1  ON 116
ci_0068                -5.878997e-03 3 1  ON 117
ci_0069                 5.963876e-03 3 1  ON 118
ci_0070                 5.641787e-03 3 1  ON 119
ci_0071                 4.369898e-03 3 1  ON 120
ci_0072                 4.039934e-03 3 1  ON 121
ci_0073                 5.232132e-03 3 1  ON 122
ci_0074                 5.826168e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8102e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6882e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.7943
    reference variance = 0.303939
====================================================
  Execution time = 2.1157e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3757e-01
  Total weights = 1.951026655e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1311e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323534561613
                                         uncertainty =       0.002358106586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323534561613
                                         uncertainty =       0.002358106586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402192910
  error estimate for blocks of size 2^( 2) =       0.000415210087
  error estimate for blocks of size 2^( 3) =       0.000427520753
  error estimate for blocks of size 2^( 4) =       0.000439571273
  error estimate for blocks of size 2^( 5) =       0.000449923120
  error estimate for blocks of size 2^( 6) =       0.000458353657
  error estimate for blocks of size 2^( 7) =       0.000463413120

      target function =                  N/A
              le_mean =     -16.905541408325
             les_mean =     286.134901784608
             stat err =       0.000452815292
             autocorr =       1.267574081376
              std dev =       0.568786667650
             le_variance =       0.323518273296


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690554140832e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905541408341       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905749695047       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905764721262       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905774447270       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905784850034       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905793315600       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905801120716       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905802697533       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905802878081       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905802212377       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905802190040       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905802201243       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905802095898       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905802038695       residual = 3.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e-01 is 2.453686e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905541408341       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905606930414       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905611403864       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905613974396       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905616627299       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905618808484       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905620974584       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905621537996       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905621691915       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905621633052       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905621624609       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905621640543       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905621607830       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.5000e+00 is 6.873345e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905541408341       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905558919597       residual = 4.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905560117475       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905560779761       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905561445073       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905561985576       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905562519159       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905562680845       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905562725397       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905562724201       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905562727866       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905562732154       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905562727418       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.0000e+01 is 1.771745e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216485 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7309e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
   uu_0                 3.041814e-01 1 1  ON 0
   uu_1                 1.400932e-01 1 1  ON 1
   uu_2                 4.139969e-02 1 1  ON 2
   uu_3                -1.840841e-02 1 1  ON 3
   uu_4                -6.190602e-02 1 1  ON 4
   uu_5                -9.564458e-02 1 1  ON 5
   uu_6                -1.214023e-01 1 1  ON 6
   uu_7                -1.328061e-01 1 1  ON 7
   uu_8                -1.227023e-01 1 1  ON 8
   uu_9                -9.406951e-02 1 1  ON 9
   ud_0                 4.294858e-01 1 1  ON 10
   ud_1                 1.694243e-01 1 1  ON 11
   ud_2                 5.654214e-02 1 1  ON 12
   ud_3                -8.219894e-03 1 1  ON 13
   ud_4                -6.281442e-02 1 1  ON 14
   ud_5                -1.036444e-01 1 1  ON 15
   ud_6                -1.303651e-01 1 1  ON 16
   ud_7                -1.454315e-01 1 1  ON 17
   ud_8                -1.446425e-01 1 1  ON 18
   ud_9                -1.348095e-01 1 1  ON 19
   eO_0                -7.214478e-01 1 1  ON 20
   eO_1                -4.154187e-01 1 1  ON 21
   eO_2                -2.076014e-02 1 1  ON 22
   eO_3                 2.771770e-01 1 1  ON 23
   eO_4                 4.946829e-01 1 1  ON 24
   eO_5                 4.587574e-01 1 1  ON 25
   eO_6                 2.361658e-01 1 1  ON 26
   eO_7                -5.550249e-02 1 1  ON 27
   eO_8                -1.976214e-01 1 1  ON 28
   eO_9                -5.884927e-02 1 1  ON 29
  eH1_0                -2.217446e-01 1 1  ON 30
  eH1_1                -1.310169e-01 1 1  ON 31
  eH1_2                -8.575798e-02 1 1  ON 32
  eH1_3                -3.368749e-02 1 1  ON 33
  eH1_4                 1.458078e-02 1 1  ON 34
  eH1_5                 4.588460e-02 1 1  ON 35
  eH1_6                 9.564934e-02 1 1  ON 36
  eH1_7                 1.392237e-01 1 1  ON 37
  eH1_8                 1.472996e-01 1 1  ON 38
  eH1_9                 3.424933e-02 1 1  ON 39
  eH2_0                -2.207687e-01 1 1  ON 40
  eH2_1                -1.295711e-01 1 1  ON 41
  eH2_2                -8.431028e-02 1 1  ON 42
  eH2_3                -3.226344e-02 1 1  ON 43
  eH2_4                 1.599398e-02 1 1  ON 44
  eH2_5                 4.889990e-02 1 1  ON 45
  eH2_6                 1.011189e-01 1 1  ON 46
  eH2_7                 1.493635e-01 1 1  ON 47
  eH2_8                 1.553147e-01 1 1  ON 48
  eH2_9                 1.474076e-02 1 1  ON 49
ci_0001                 6.992704e-01 3 1  ON 50
ci_0002                 6.989778e-01 3 1  ON 51
ci_0003                -3.380439e-02 3 1  ON 52
ci_0004                -3.392035e-02 3 1  ON 53
ci_0005                -4.067992e-02 3 1  ON 54
ci_0006                -4.095065e-02 3 1  ON 55
ci_0007                -2.803275e-02 3 1  ON 56
ci_0008                -2.828599e-02 3 1  ON 57
ci_0009                -2.082501e-02 3 1  ON 58
ci_0010                -2.074988e-02 3 1  ON 59
ci_0011                -1.633108e-02 3 1  ON 60
ci_0012                -1.633896e-02 3 1  ON 61
ci_0013                 1.681213e-02 3 1  ON 62
ci_0014                 1.668437e-02 3 1  ON 63
ci_0015                 1.687054e-02 3 1  ON 64
ci_0016                 1.662085e-02 3 1  ON 65
ci_0017                 1.423595e-02 3 1  ON 66
ci_0018                 1.413135e-02 3 1  ON 67
ci_0019                 1.351512e-02 3 1  ON 68
ci_0020                 1.306091e-02 3 1  ON 69
ci_0021                 9.587732e-03 3 1  ON 70
ci_0022                 9.249827e-03 3 1  ON 71
ci_0023                -1.307382e-02 3 1  ON 72
ci_0024                -1.291318e-02 3 1  ON 73
ci_0025                -1.375029e-02 3 1  ON 74
ci_0026                -1.330954e-02 3 1  ON 75
ci_0027                -1.271012e-02 3 1  ON 76
ci_0028                -1.209936e-02 3 1  ON 77
ci_0029                -1.205645e-02 3 1  ON 78
ci_0030                -1.214061e-02 3 1  ON 79
ci_0031                 1.926024e-02 3 1  ON 80
ci_0032                 1.911674e-02 3 1  ON 81
ci_0033                 1.309711e-02 3 1  ON 82
ci_0034                 1.273955e-02 3 1  ON 83
ci_0035                 9.620806e-03 3 1  ON 84
ci_0036                 9.897086e-03 3 1  ON 85
ci_0037                -1.172049e-02 3 1  ON 86
ci_0038                -1.241074e-02 3 1  ON 87
ci_0039                -4.985119e-03 3 1  ON 88
ci_0040                -4.715231e-03 3 1  ON 89
ci_0041                 9.288548e-03 3 1  ON 90
ci_0042                 9.038943e-03 3 1  ON 91
ci_0043                -1.625395e-02 3 1  ON 92
ci_0044                -1.620151e-02 3 1  ON 93
ci_0045                 1.050599e-02 3 1  ON 94
ci_0046                 9.908233e-03 3 1  ON 95
ci_0047                -3.707763e-03 3 1  ON 96
ci_0048                -3.919703e-03 3 1  ON 97
ci_0049                -7.059147e-03 3 1  ON 98
ci_0050                -8.037776e-03 3 1  ON 99
ci_0051                -5.712856e-03 3 1  ON 100
ci_0052                -5.250845e-03 3 1  ON 101
ci_0053                -6.347810e-03 3 1  ON 102
ci_0054                -6.119051e-03 3 1  ON 103
ci_0055                 8.755418e-03 3 1  ON 104
ci_0056                 8.233451e-03 3 1  ON 105
ci_0057                 7.421444e-03 3 1  ON 106
ci_0058                 7.106284e-03 3 1  ON 107
ci_0059                -6.587333e-03 3 1  ON 108
ci_0060                -6.311221e-03 3 1  ON 109
ci_0061                -6.370937e-03 3 1  ON 110
ci_0062                -5.762627e-03 3 1  ON 111
ci_0063                -9.954780e-03 3 1  ON 112
ci_0064                -8.884058e-03 3 1  ON 113
ci_0065                -7.310356e-03 3 1  ON 114
ci_0066                -6.610196e-03 3 1  ON 115
ci_0067                -5.744423e-03 3 1  ON 116
ci_0068                -5.719372e-03 3 1  ON 117
ci_0069                 5.801593e-03 3 1  ON 118
ci_0070                 5.451819e-03 3 1  ON 119
ci_0071                 4.105200e-03 3 1  ON 120
ci_0072                 3.806174e-03 3 1  ON 121
ci_0073                 5.134752e-03 3 1  ON 122
ci_0074                 5.644530e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8889
    reference variance = 0.19663
====================================================
  Execution time = 2.0846e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4235e-01
  Total weights = 1.9513e+06
  Execution time = 1.8865e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327862246377
                                         uncertainty =       0.004932492543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327862246377
                                         uncertainty =       0.004932492543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404832313
  error estimate for blocks of size 2^( 2) =       0.000418034555
  error estimate for blocks of size 2^( 3) =       0.000432458456
  error estimate for blocks of size 2^( 4) =       0.000445652757
  error estimate for blocks of size 2^( 5) =       0.000456739031
  error estimate for blocks of size 2^( 6) =       0.000465271607
  error estimate for blocks of size 2^( 7) =       0.000470773283

      target function =                  N/A
              le_mean =     -16.904977270747
             les_mean =     286.627760604345
             stat err =       0.000459609169
             autocorr =       1.288923168640
              std dev =       0.572519346851
             le_variance =       0.327778402519

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0506009
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325672400009
                                         uncertainty =       0.005117888713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325672400009
                                         uncertainty =       0.005117888713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403476811
  error estimate for blocks of size 2^( 2) =       0.000416672807
  error estimate for blocks of size 2^( 3) =       0.000431072281
  error estimate for blocks of size 2^( 4) =       0.000444329881
  error estimate for blocks of size 2^( 5) =       0.000455450121
  error estimate for blocks of size 2^( 6) =       0.000464049513
  error estimate for blocks of size 2^( 7) =       0.000469456302

      target function =                  N/A
              le_mean =     -16.905000606096
             les_mean =     286.154990545169
             stat err =       0.000458321454
             autocorr =       1.290337194072
              std dev =       0.570602377926
             le_variance =       0.325587073695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326058671049
                                         uncertainty =       0.005034515959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326058671049
                                         uncertainty =       0.005034515959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403716632
  error estimate for blocks of size 2^( 2) =       0.000416918841
  error estimate for blocks of size 2^( 3) =       0.000431326803
  error estimate for blocks of size 2^( 4) =       0.000444584571
  error estimate for blocks of size 2^( 5) =       0.000455713705
  error estimate for blocks of size 2^( 6) =       0.000464310752
  error estimate for blocks of size 2^( 7) =       0.000469745744

      target function =                  N/A
              le_mean =     -16.904982414511
             les_mean =     286.121241992908
             stat err =       0.000458588693
             autocorr =       1.290308039996
              std dev =       0.570941535656
             le_variance =       0.325974237137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327289806402
                                         uncertainty =       0.004947674397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327289806402
                                         uncertainty =       0.004947674397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404478903
  error estimate for blocks of size 2^( 2) =       0.000417674350
  error estimate for blocks of size 2^( 3) =       0.000432083658
  error estimate for blocks of size 2^( 4) =       0.000445329706
  error estimate for blocks of size 2^( 5) =       0.000456460569
  error estimate for blocks of size 2^( 6) =       0.000465040863
  error estimate for blocks of size 2^( 7) =       0.000470513500

      target function =                  N/A
              le_mean =     -16.904983475328
             les_mean =     286.125352121741
             stat err =       0.000459336160
             autocorr =       1.289643048491
              std dev =       0.572019550418
             le_variance =       0.327206366061


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904977270747        initial
     6.2500e-01     6.2500e+00             2.4537e-03       -16.905000606096  <--
     2.5000e+00     2.5000e+01             6.8733e-04       -16.904982414511
     1.0000e+01     1.0000e+02             1.7717e-04       -16.904983475328

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.0435e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
   uu_0                 3.044474e-01 1 1  ON 0
   uu_1                 1.401724e-01 1 1  ON 1
   uu_2                 4.135921e-02 1 1  ON 2
   uu_3                -1.838991e-02 1 1  ON 3
   uu_4                -6.188784e-02 1 1  ON 4
   uu_5                -9.560604e-02 1 1  ON 5
   uu_6                -1.214986e-01 1 1  ON 6
   uu_7                -1.329317e-01 1 1  ON 7
   uu_8                -1.229327e-01 1 1  ON 8
   uu_9                -9.424714e-02 1 1  ON 9
   ud_0                 4.309936e-01 1 1  ON 10
   ud_1                 1.703081e-01 1 1  ON 11
   ud_2                 5.638060e-02 1 1  ON 12
   ud_3                -9.013167e-03 1 1  ON 13
   ud_4                -6.334619e-02 1 1  ON 14
   ud_5                -1.038403e-01 1 1  ON 15
   ud_6                -1.305525e-01 1 1  ON 16
   ud_7                -1.455494e-01 1 1  ON 17
   ud_8                -1.448414e-01 1 1  ON 18
   ud_9                -1.349505e-01 1 1  ON 19
   eO_0                -7.232142e-01 1 1  ON 20
   eO_1                -4.156883e-01 1 1  ON 21
   eO_2                -1.993795e-02 1 1  ON 22
   eO_3                 2.781338e-01 1 1  ON 23
   eO_4                 4.952154e-01 1 1  ON 24
   eO_5                 4.587963e-01 1 1  ON 25
   eO_6                 2.362375e-01 1 1  ON 26
   eO_7                -5.545495e-02 1 1  ON 27
   eO_8                -1.978705e-01 1 1  ON 28
   eO_9                -5.901471e-02 1 1  ON 29
  eH1_0                -2.232128e-01 1 1  ON 30
  eH1_1                -1.313381e-01 1 1  ON 31
  eH1_2                -8.540682e-02 1 1  ON 32
  eH1_3                -3.331683e-02 1 1  ON 33
  eH1_4                 1.496768e-02 1 1  ON 34
  eH1_5                 4.614718e-02 1 1  ON 35
  eH1_6                 9.571306e-02 1 1  ON 36
  eH1_7                 1.392700e-01 1 1  ON 37
  eH1_8                 1.474491e-01 1 1  ON 38
  eH1_9                 3.441326e-02 1 1  ON 39
  eH2_0                -2.221556e-01 1 1  ON 40
  eH2_1                -1.298250e-01 1 1  ON 41
  eH2_2                -8.405191e-02 1 1  ON 42
  eH2_3                -3.187916e-02 1 1  ON 43
  eH2_4                 1.626326e-02 1 1  ON 44
  eH2_5                 4.909931e-02 1 1  ON 45
  eH2_6                 1.010986e-01 1 1  ON 46
  eH2_7                 1.494054e-01 1 1  ON 47
  eH2_8                 1.555871e-01 1 1  ON 48
  eH2_9                 1.497084e-02 1 1  ON 49
ci_0001                 6.994784e-01 3 1  ON 50
ci_0002                 6.993848e-01 3 1  ON 51
ci_0003                -3.259009e-02 3 1  ON 52
ci_0004                -3.297351e-02 3 1  ON 53
ci_0005                -4.021026e-02 3 1  ON 54
ci_0006                -4.057322e-02 3 1  ON 55
ci_0007                -2.775595e-02 3 1  ON 56
ci_0008                -2.761905e-02 3 1  ON 57
ci_0009                -2.012776e-02 3 1  ON 58
ci_0010                -1.987448e-02 3 1  ON 59
ci_0011                -1.543977e-02 3 1  ON 60
ci_0012                -1.556136e-02 3 1  ON 61
ci_0013                 1.623265e-02 3 1  ON 62
ci_0014                 1.608720e-02 3 1  ON 63
ci_0015                 1.605897e-02 3 1  ON 64
ci_0016                 1.582453e-02 3 1  ON 65
ci_0017                 1.355196e-02 3 1  ON 66
ci_0018                 1.357536e-02 3 1  ON 67
ci_0019                 1.296786e-02 3 1  ON 68
ci_0020                 1.267373e-02 3 1  ON 69
ci_0021                 8.506190e-03 3 1  ON 70
ci_0022                 8.156744e-03 3 1  ON 71
ci_0023                -1.302024e-02 3 1  ON 72
ci_0024                -1.264804e-02 3 1  ON 73
ci_0025                -1.323363e-02 3 1  ON 74
ci_0026                -1.283509e-02 3 1  ON 75
ci_0027                -1.242972e-02 3 1  ON 76
ci_0028                -1.170915e-02 3 1  ON 77
ci_0029                -1.161281e-02 3 1  ON 78
ci_0030                -1.181146e-02 3 1  ON 79
ci_0031                 1.926546e-02 3 1  ON 80
ci_0032                 1.918031e-02 3 1  ON 81
ci_0033                 1.290591e-02 3 1  ON 82
ci_0034                 1.249564e-02 3 1  ON 83
ci_0035                 9.006458e-03 3 1  ON 84
ci_0036                 9.164005e-03 3 1  ON 85
ci_0037                -1.151136e-02 3 1  ON 86
ci_0038                -1.224108e-02 3 1  ON 87
ci_0039                -4.437609e-03 3 1  ON 88
ci_0040                -4.141876e-03 3 1  ON 89
ci_0041                 9.063489e-03 3 1  ON 90
ci_0042                 8.688968e-03 3 1  ON 91
ci_0043                -1.667853e-02 3 1  ON 92
ci_0044                -1.620135e-02 3 1  ON 93
ci_0045                 1.008077e-02 3 1  ON 94
ci_0046                 9.648075e-03 3 1  ON 95
ci_0047                -3.150012e-03 3 1  ON 96
ci_0048                -3.411281e-03 3 1  ON 97
ci_0049                -6.773494e-03 3 1  ON 98
ci_0050                -7.453357e-03 3 1  ON 99
ci_0051                -5.216497e-03 3 1  ON 100
ci_0052                -4.842303e-03 3 1  ON 101
ci_0053                -5.938341e-03 3 1  ON 102
ci_0054                -5.963519e-03 3 1  ON 103
ci_0055                 8.439507e-03 3 1  ON 104
ci_0056                 8.053487e-03 3 1  ON 105
ci_0057                 7.027310e-03 3 1  ON 106
ci_0058                 6.708323e-03 3 1  ON 107
ci_0059                -6.024017e-03 3 1  ON 108
ci_0060                -5.861469e-03 3 1  ON 109
ci_0061                -5.861999e-03 3 1  ON 110
ci_0062                -5.506973e-03 3 1  ON 111
ci_0063                -9.673406e-03 3 1  ON 112
ci_0064                -8.800810e-03 3 1  ON 113
ci_0065                -7.004580e-03 3 1  ON 114
ci_0066                -6.420856e-03 3 1  ON 115
ci_0067                -5.605724e-03 3 1  ON 116
ci_0068                -5.401527e-03 3 1  ON 117
ci_0069                 5.481292e-03 3 1  ON 118
ci_0070                 5.078918e-03 3 1  ON 119
ci_0071                 3.494103e-03 3 1  ON 120
ci_0072                 3.260114e-03 3 1  ON 121
ci_0073                 4.941553e-03 3 1  ON 122
ci_0074                 5.290243e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7768e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6872e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8694
    reference variance = 0.207263
====================================================
  Execution time = 2.1233e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3335e-01
  Total weights = 1.951534639e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319203461209
                                         uncertainty =       0.002011148494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319203461209
                                         uncertainty =       0.002011148494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399794482
  error estimate for blocks of size 2^( 2) =       0.000412710319
  error estimate for blocks of size 2^( 3) =       0.000426477553
  error estimate for blocks of size 2^( 4) =       0.000439330613
  error estimate for blocks of size 2^( 5) =       0.000450594873
  error estimate for blocks of size 2^( 6) =       0.000459734866
  error estimate for blocks of size 2^( 7) =       0.000465500093

      target function =                  N/A
              le_mean =     -16.905532275337
             les_mean =     286.130371780164
             stat err =       0.000453790111
             autocorr =       1.288357718736
              std dev =       0.565394778971
             le_variance =       0.319671256088


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690553227534e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905532275326       residual = 9.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905790773774       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905825371884       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905854428973       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905884260209       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905894169828       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905897251446       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905894418763       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905894979445       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905896257833       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905894428385       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905895465351       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905896847157       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905896218893       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905896400625       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905896257774       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905896598210       residual = 8.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5625e-01 is 6.506816e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905532275326       residual = 9.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905647532902       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905660002936       residual = 8.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905671956514       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905682732242       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905687852389       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905687081761       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905685923784       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905686002611       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905686016847       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905685953843       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905685918604       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905685974629       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905685983315       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e-01 is 2.135217e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905532275326       residual = 9.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905568107897       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905571841188       residual = 8.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905575408565       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905578347622       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905580139728       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905579975311       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905579576926       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905579530514       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905579494109       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905579563765       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905579543549       residual = 6.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.5000e+00 is 5.864666e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.230582 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7422e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
   uu_0                 3.050209e-01 1 1  ON 0
   uu_1                 1.403460e-01 1 1  ON 1
   uu_2                 4.124591e-02 1 1  ON 2
   uu_3                -1.853287e-02 1 1  ON 3
   uu_4                -6.195670e-02 1 1  ON 4
   uu_5                -9.557029e-02 1 1  ON 5
   uu_6                -1.217095e-01 1 1  ON 6
   uu_7                -1.333453e-01 1 1  ON 7
   uu_8                -1.231876e-01 1 1  ON 8
   uu_9                -9.424795e-02 1 1  ON 9
   ud_0                 4.326699e-01 1 1  ON 10
   ud_1                 1.710540e-01 1 1  ON 11
   ud_2                 5.616903e-02 1 1  ON 12
   ud_3                -9.815630e-03 1 1  ON 13
   ud_4                -6.405456e-02 1 1  ON 14
   ud_5                -1.040945e-01 1 1  ON 15
   ud_6                -1.307865e-01 1 1  ON 16
   ud_7                -1.458137e-01 1 1  ON 17
   ud_8                -1.449574e-01 1 1  ON 18
   ud_9                -1.348724e-01 1 1  ON 19
   eO_0                -7.253494e-01 1 1  ON 20
   eO_1                -4.161475e-01 1 1  ON 21
   eO_2                -1.909846e-02 1 1  ON 22
   eO_3                 2.793505e-01 1 1  ON 23
   eO_4                 4.960415e-01 1 1  ON 24
   eO_5                 4.588118e-01 1 1  ON 25
   eO_6                 2.362399e-01 1 1  ON 26
   eO_7                -5.537715e-02 1 1  ON 27
   eO_8                -1.980770e-01 1 1  ON 28
   eO_9                -5.917541e-02 1 1  ON 29
  eH1_0                -2.250178e-01 1 1  ON 30
  eH1_1                -1.315523e-01 1 1  ON 31
  eH1_2                -8.518134e-02 1 1  ON 32
  eH1_3                -3.299051e-02 1 1  ON 33
  eH1_4                 1.535035e-02 1 1  ON 34
  eH1_5                 4.637904e-02 1 1  ON 35
  eH1_6                 9.585983e-02 1 1  ON 36
  eH1_7                 1.393217e-01 1 1  ON 37
  eH1_8                 1.477526e-01 1 1  ON 38
  eH1_9                 3.475222e-02 1 1  ON 39
  eH2_0                -2.237651e-01 1 1  ON 40
  eH2_1                -1.301496e-01 1 1  ON 41
  eH2_2                -8.382573e-02 1 1  ON 42
  eH2_3                -3.162619e-02 1 1  ON 43
  eH2_4                 1.657596e-02 1 1  ON 44
  eH2_5                 4.915525e-02 1 1  ON 45
  eH2_6                 1.012574e-01 1 1  ON 46
  eH2_7                 1.494908e-01 1 1  ON 47
  eH2_8                 1.559298e-01 1 1  ON 48
  eH2_9                 1.543675e-02 1 1  ON 49
ci_0001                 6.998092e-01 3 1  ON 50
ci_0002                 6.996553e-01 3 1  ON 51
ci_0003                -3.167541e-02 3 1  ON 52
ci_0004                -3.178355e-02 3 1  ON 53
ci_0005                -3.970930e-02 3 1  ON 54
ci_0006                -4.011792e-02 3 1  ON 55
ci_0007                -2.720968e-02 3 1  ON 56
ci_0008                -2.715138e-02 3 1  ON 57
ci_0009                -1.931734e-02 3 1  ON 58
ci_0010                -1.899074e-02 3 1  ON 59
ci_0011                -1.449040e-02 3 1  ON 60
ci_0012                -1.464337e-02 3 1  ON 61
ci_0013                 1.566500e-02 3 1  ON 62
ci_0014                 1.538365e-02 3 1  ON 63
ci_0015                 1.522302e-02 3 1  ON 64
ci_0016                 1.524849e-02 3 1  ON 65
ci_0017                 1.333123e-02 3 1  ON 66
ci_0018                 1.297989e-02 3 1  ON 67
ci_0019                 1.243110e-02 3 1  ON 68
ci_0020                 1.232297e-02 3 1  ON 69
ci_0021                 7.380902e-03 3 1  ON 70
ci_0022                 7.296683e-03 3 1  ON 71
ci_0023                -1.260434e-02 3 1  ON 72
ci_0024                -1.215371e-02 3 1  ON 73
ci_0025                -1.263581e-02 3 1  ON 74
ci_0026                -1.267684e-02 3 1  ON 75
ci_0027                -1.218722e-02 3 1  ON 76
ci_0028                -1.130076e-02 3 1  ON 77
ci_0029                -1.131851e-02 3 1  ON 78
ci_0030                -1.137110e-02 3 1  ON 79
ci_0031                 1.923727e-02 3 1  ON 80
ci_0032                 1.952154e-02 3 1  ON 81
ci_0033                 1.241101e-02 3 1  ON 82
ci_0034                 1.205025e-02 3 1  ON 83
ci_0035                 8.476251e-03 3 1  ON 84
ci_0036                 8.448952e-03 3 1  ON 85
ci_0037                -1.132301e-02 3 1  ON 86
ci_0038                -1.177990e-02 3 1  ON 87
ci_0039                -4.096935e-03 3 1  ON 88
ci_0040                -3.794767e-03 3 1  ON 89
ci_0041                 8.647776e-03 3 1  ON 90
ci_0042                 8.377159e-03 3 1  ON 91
ci_0043                -1.674779e-02 3 1  ON 92
ci_0044                -1.624415e-02 3 1  ON 93
ci_0045                 9.826661e-03 3 1  ON 94
ci_0046                 9.312378e-03 3 1  ON 95
ci_0047                -2.742235e-03 3 1  ON 96
ci_0048                -2.907379e-03 3 1  ON 97
ci_0049                -6.366703e-03 3 1  ON 98
ci_0050                -6.883610e-03 3 1  ON 99
ci_0051                -4.406554e-03 3 1  ON 100
ci_0052                -4.460751e-03 3 1  ON 101
ci_0053                -5.543369e-03 3 1  ON 102
ci_0054                -5.659239e-03 3 1  ON 103
ci_0055                 7.828458e-03 3 1  ON 104
ci_0056                 7.742543e-03 3 1  ON 105
ci_0057                 6.383062e-03 3 1  ON 106
ci_0058                 6.451416e-03 3 1  ON 107
ci_0059                -5.812450e-03 3 1  ON 108
ci_0060                -5.497143e-03 3 1  ON 109
ci_0061                -5.445697e-03 3 1  ON 110
ci_0062                -5.082742e-03 3 1  ON 111
ci_0063                -9.407431e-03 3 1  ON 112
ci_0064                -8.640851e-03 3 1  ON 113
ci_0065                -6.572523e-03 3 1  ON 114
ci_0066                -6.175902e-03 3 1  ON 115
ci_0067                -5.282592e-03 3 1  ON 116
ci_0068                -5.288537e-03 3 1  ON 117
ci_0069                 5.136101e-03 3 1  ON 118
ci_0070                 4.815293e-03 3 1  ON 119
ci_0071                 2.763906e-03 3 1  ON 120
ci_0072                 2.687286e-03 3 1  ON 121
ci_0073                 4.879285e-03 3 1  ON 122
ci_0074                 4.901230e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.839
    reference variance = 0.212804
====================================================
  Execution time = 2.1475e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3252e-01
  Total weights = 1.9515e+06
  Execution time = 1.8799e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322440942013
                                         uncertainty =       0.002574075785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322440942013
                                         uncertainty =       0.002574075785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401490188
  error estimate for blocks of size 2^( 2) =       0.000414397455
  error estimate for blocks of size 2^( 3) =       0.000428136709
  error estimate for blocks of size 2^( 4) =       0.000440837652
  error estimate for blocks of size 2^( 5) =       0.000451535282
  error estimate for blocks of size 2^( 6) =       0.000461464468
  error estimate for blocks of size 2^( 7) =       0.000469336489

      target function =                  N/A
              le_mean =     -16.905363349233
             les_mean =     286.127219656967
             stat err =       0.000455793473
             autocorr =       1.288802385958
              std dev =       0.567792868511
             le_variance =       0.322388741531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321771501568
                                         uncertainty =       0.002480946282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321771501568
                                         uncertainty =       0.002480946282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401075481
  error estimate for blocks of size 2^( 2) =       0.000413964340
  error estimate for blocks of size 2^( 3) =       0.000427742210
  error estimate for blocks of size 2^( 4) =       0.000440456888
  error estimate for blocks of size 2^( 5) =       0.000451198062
  error estimate for blocks of size 2^( 6) =       0.000461271659
  error estimate for blocks of size 2^( 7) =       0.000469150158

      target function =                  N/A
              le_mean =     -16.905410933348
             les_mean =     286.135489490320
             stat err =       0.000455519192
             autocorr =       1.289915114999
              std dev =       0.567206385242
             le_variance =       0.321723083459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322341177887
                                         uncertainty =       0.002696708876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322341177887
                                         uncertainty =       0.002696708876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401430011
  error estimate for blocks of size 2^( 2) =       0.000414318587
  error estimate for blocks of size 2^( 3) =       0.000428090342
  error estimate for blocks of size 2^( 4) =       0.000440788829
  error estimate for blocks of size 2^( 5) =       0.000451650566
  error estimate for blocks of size 2^( 6) =       0.000461664026
  error estimate for blocks of size 2^( 7) =       0.000469510310

      target function =                  N/A
              le_mean =     -16.905358792271
             les_mean =     286.236368833065
             stat err =       0.000455903433
             autocorr =       1.289810918814
              std dev =       0.567707766237
             le_variance =       0.322292107846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322100735581
                                         uncertainty =       0.002558318395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322100735581
                                         uncertainty =       0.002558318395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401278791
  error estimate for blocks of size 2^( 2) =       0.000414185288
  error estimate for blocks of size 2^( 3) =       0.000427934376
  error estimate for blocks of size 2^( 4) =       0.000440634676
  error estimate for blocks of size 2^( 5) =       0.000451350146
  error estimate for blocks of size 2^( 6) =       0.000461299261
  error estimate for blocks of size 2^( 7) =       0.000469178212

      target function =                  N/A
              le_mean =     -16.905348182819
             les_mean =     286.125507596845
             stat err =       0.000455615573
             autocorr =       1.289153725267
              std dev =       0.567493908592
             le_variance =       0.322049336289


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905363349233        initial
     1.5625e-01     1.5625e+00             6.5068e-03       -16.905410933348  <--
     6.2500e-01     6.2500e+00             2.1352e-03       -16.905358792271
     2.5000e+00     2.5000e+01             5.8647e-04       -16.905348182819

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 3.1028e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
   uu_0                 3.063029e-01 1 1  ON 0
   uu_1                 1.409151e-01 1 1  ON 1
   uu_2                 4.119464e-02 1 1  ON 2
   uu_3                -1.891450e-02 1 1  ON 3
   uu_4                -6.236099e-02 1 1  ON 4
   uu_5                -9.576056e-02 1 1  ON 5
   uu_6                -1.221389e-01 1 1  ON 6
   uu_7                -1.342197e-01 1 1  ON 7
   uu_8                -1.239239e-01 1 1  ON 8
   uu_9                -9.429873e-02 1 1  ON 9
   ud_0                 4.352996e-01 1 1  ON 10
   ud_1                 1.723932e-01 1 1  ON 11
   ud_2                 5.608208e-02 1 1  ON 12
   ud_3                -1.092480e-02 1 1  ON 13
   ud_4                -6.524649e-02 1 1  ON 14
   ud_5                -1.047843e-01 1 1  ON 15
   ud_6                -1.312527e-01 1 1  ON 16
   ud_7                -1.463371e-01 1 1  ON 17
   ud_8                -1.453102e-01 1 1  ON 18
   ud_9                -1.346924e-01 1 1  ON 19
   eO_0                -7.297210e-01 1 1  ON 20
   eO_1                -4.176074e-01 1 1  ON 21
   eO_2                -1.799783e-02 1 1  ON 22
   eO_3                 2.819598e-01 1 1  ON 23
   eO_4                 4.983469e-01 1 1  ON 24
   eO_5                 4.593897e-01 1 1  ON 25
   eO_6                 2.364302e-01 1 1  ON 26
   eO_7                -5.516776e-02 1 1  ON 27
   eO_8                -1.987077e-01 1 1  ON 28
   eO_9                -5.965694e-02 1 1  ON 29
  eH1_0                -2.288036e-01 1 1  ON 30
  eH1_1                -1.321278e-01 1 1  ON 31
  eH1_2                -8.502443e-02 1 1  ON 32
  eH1_3                -3.253387e-02 1 1  ON 33
  eH1_4                 1.592245e-02 1 1  ON 34
  eH1_5                 4.689645e-02 1 1  ON 35
  eH1_6                 9.637393e-02 1 1  ON 36
  eH1_7                 1.395529e-01 1 1  ON 37
  eH1_8                 1.486371e-01 1 1  ON 38
  eH1_9                 3.574630e-02 1 1  ON 39
  eH2_0                -2.272483e-01 1 1  ON 40
  eH2_1                -1.308901e-01 1 1  ON 41
  eH2_2                -8.372869e-02 1 1  ON 42
  eH2_3                -3.131061e-02 1 1  ON 43
  eH2_4                 1.696588e-02 1 1  ON 44
  eH2_5                 4.928308e-02 1 1  ON 45
  eH2_6                 1.017546e-01 1 1  ON 46
  eH2_7                 1.498001e-01 1 1  ON 47
  eH2_8                 1.569352e-01 1 1  ON 48
  eH2_9                 1.681760e-02 1 1  ON 49
ci_0001                 7.003162e-01 3 1  ON 50
ci_0002                 6.999775e-01 3 1  ON 51
ci_0003                -3.045267e-02 3 1  ON 52
ci_0004                -3.017953e-02 3 1  ON 53
ci_0005                -3.876293e-02 3 1  ON 54
ci_0006                -3.928580e-02 3 1  ON 55
ci_0007                -2.614080e-02 3 1  ON 56
ci_0008                -2.626233e-02 3 1  ON 57
ci_0009                -1.836710e-02 3 1  ON 58
ci_0010                -1.797225e-02 3 1  ON 59
ci_0011                -1.327884e-02 3 1  ON 60
ci_0012                -1.348967e-02 3 1  ON 61
ci_0013                 1.498538e-02 3 1  ON 62
ci_0014                 1.454015e-02 3 1  ON 63
ci_0015                 1.418089e-02 3 1  ON 64
ci_0016                 1.454981e-02 3 1  ON 65
ci_0017                 1.310659e-02 3 1  ON 66
ci_0018                 1.230512e-02 3 1  ON 67
ci_0019                 1.181183e-02 3 1  ON 68
ci_0020                 1.193903e-02 3 1  ON 69
ci_0021                 5.224258e-03 3 1  ON 70
ci_0022                 5.632880e-03 3 1  ON 71
ci_0023                -1.214504e-02 3 1  ON 72
ci_0024                -1.161212e-02 3 1  ON 73
ci_0025                -1.189336e-02 3 1  ON 74
ci_0026                -1.247874e-02 3 1  ON 75
ci_0027                -1.195023e-02 3 1  ON 76
ci_0028                -1.084439e-02 3 1  ON 77
ci_0029                -1.100684e-02 3 1  ON 78
ci_0030                -1.089167e-02 3 1  ON 79
ci_0031                 1.915849e-02 3 1  ON 80
ci_0032                 2.010785e-02 3 1  ON 81
ci_0033                 1.155459e-02 3 1  ON 82
ci_0034                 1.123076e-02 3 1  ON 83
ci_0035                 7.761994e-03 3 1  ON 84
ci_0036                 7.488469e-03 3 1  ON 85
ci_0037                -1.104967e-02 3 1  ON 86
ci_0038                -1.110333e-02 3 1  ON 87
ci_0039                -3.749489e-03 3 1  ON 88
ci_0040                -3.437317e-03 3 1  ON 89
ci_0041                 8.078252e-03 3 1  ON 90
ci_0042                 7.937620e-03 3 1  ON 91
ci_0043                -1.689978e-02 3 1  ON 92
ci_0044                -1.634740e-02 3 1  ON 93
ci_0045                 9.423937e-03 3 1  ON 94
ci_0046                 8.795333e-03 3 1  ON 95
ci_0047                -2.314187e-03 3 1  ON 96
ci_0048                -2.399773e-03 3 1  ON 97
ci_0049                -5.844890e-03 3 1  ON 98
ci_0050                -6.167886e-03 3 1  ON 99
ci_0051                -3.597989e-03 3 1  ON 100
ci_0052                -4.054074e-03 3 1  ON 101
ci_0053                -5.091354e-03 3 1  ON 102
ci_0054                -5.314114e-03 3 1  ON 103
ci_0055                 6.920066e-03 3 1  ON 104
ci_0056                 7.251019e-03 3 1  ON 105
ci_0057                 5.490162e-03 3 1  ON 106
ci_0058                 6.092632e-03 3 1  ON 107
ci_0059                -5.568321e-03 3 1  ON 108
ci_0060                -5.097915e-03 3 1  ON 109
ci_0061                -4.886903e-03 3 1  ON 110
ci_0062                -4.510645e-03 3 1  ON 111
ci_0063                -9.124251e-03 3 1  ON 112
ci_0064                -8.483666e-03 3 1  ON 113
ci_0065                -6.052687e-03 3 1  ON 114
ci_0066                -5.867509e-03 3 1  ON 115
ci_0067                -4.943871e-03 3 1  ON 116
ci_0068                -5.155923e-03 3 1  ON 117
ci_0069                 4.783308e-03 3 1  ON 118
ci_0070                 4.542356e-03 3 1  ON 119
ci_0071                 1.732500e-03 3 1  ON 120
ci_0072                 1.841731e-03 3 1  ON 121
ci_0073                 4.802678e-03 3 1  ON 122
ci_0074                 4.508321e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8476e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6868e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8492
    reference variance = 0.307058
====================================================
  Execution time = 2.1191e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2743e-01
  Total weights = 1.951403212e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2060e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317340196498
                                         uncertainty =       0.002363443957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317340196498
                                         uncertainty =       0.002363443957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398317011
  error estimate for blocks of size 2^( 2) =       0.000411224224
  error estimate for blocks of size 2^( 3) =       0.000424515342
  error estimate for blocks of size 2^( 4) =       0.000436977479
  error estimate for blocks of size 2^( 5) =       0.000448404236
  error estimate for blocks of size 2^( 6) =       0.000455967528
  error estimate for blocks of size 2^( 7) =       0.000462488482

      target function =                  N/A
              le_mean =     -16.906076239199
             les_mean =     286.142843113037
             stat err =       0.000450959431
             autocorr =       1.281791065613
              std dev =       0.563305318554
             le_variance =       0.317312881911


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690607623920e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906076239186       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906216362017       residual = 8.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906221938280       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906229375302       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906252126737       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906258088796       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906264483127       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906258358279       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906265867768       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906266927920       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906269470603       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906270751638       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906273190444       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906276527430       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906277048205       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906276824661       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906276225426       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906277033418       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906276418183       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906276903577       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906276740922       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906276426527       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906276149127       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.906276479139       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.906276804927       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e-02 is 1.019197e-02

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906076239186       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906169859746       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906171672568       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906173274263       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906184601736       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906187887440       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906191015636       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906189242650       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906191954972       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906192133735       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906191543681       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906191330519       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906192043935       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906192228971       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906192278382       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906192381364       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5625e-01 is 4.297643e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906076239186       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906116462747       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906117272418       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906117615435       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906121061223       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906121748030       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906123141517       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906122751427       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906123266231       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906123189082       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906123235416       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906123142398       residual = 7.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e-01 is 1.391823e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.244181 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7415e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
   uu_0                 3.070948e-01 1 1  ON 0
   uu_1                 1.413088e-01 1 1  ON 1
   uu_2                 4.118014e-02 1 1  ON 2
   uu_3                -1.927309e-02 1 1  ON 3
   uu_4                -6.276600e-02 1 1  ON 4
   uu_5                -9.591450e-02 1 1  ON 5
   uu_6                -1.221934e-01 1 1  ON 6
   uu_7                -1.344001e-01 1 1  ON 7
   uu_8                -1.247813e-01 1 1  ON 8
   uu_9                -9.481067e-02 1 1  ON 9
   ud_0                 4.381701e-01 1 1  ON 10
   ud_1                 1.741267e-01 1 1  ON 11
   ud_2                 5.637756e-02 1 1  ON 12
   ud_3                -1.178100e-02 1 1  ON 13
   ud_4                -6.634434e-02 1 1  ON 14
   ud_5                -1.059806e-01 1 1  ON 15
   ud_6                -1.316898e-01 1 1  ON 16
   ud_7                -1.464399e-01 1 1  ON 17
   ud_8                -1.463636e-01 1 1  ON 18
   ud_9                -1.349893e-01 1 1  ON 19
   eO_0                -7.340186e-01 1 1  ON 20
   eO_1                -4.194121e-01 1 1  ON 21
   eO_2                -1.685192e-02 1 1  ON 22
   eO_3                 2.848923e-01 1 1  ON 23
   eO_4                 5.003462e-01 1 1  ON 24
   eO_5                 4.602463e-01 1 1  ON 25
   eO_6                 2.368779e-01 1 1  ON 26
   eO_7                -5.440950e-02 1 1  ON 27
   eO_8                -1.998696e-01 1 1  ON 28
   eO_9                -6.047226e-02 1 1  ON 29
  eH1_0                -2.322442e-01 1 1  ON 30
  eH1_1                -1.329701e-01 1 1  ON 31
  eH1_2                -8.517573e-02 1 1  ON 32
  eH1_3                -3.250730e-02 1 1  ON 33
  eH1_4                 1.617437e-02 1 1  ON 34
  eH1_5                 4.730441e-02 1 1  ON 35
  eH1_6                 9.719156e-02 1 1  ON 36
  eH1_7                 1.402492e-01 1 1  ON 37
  eH1_8                 1.498232e-01 1 1  ON 38
  eH1_9                 3.675300e-02 1 1  ON 39
  eH2_0                -2.311773e-01 1 1  ON 40
  eH2_1                -1.314453e-01 1 1  ON 41
  eH2_2                -8.396016e-02 1 1  ON 42
  eH2_3                -3.102046e-02 1 1  ON 43
  eH2_4                 1.746559e-02 1 1  ON 44
  eH2_5                 5.024414e-02 1 1  ON 45
  eH2_6                 1.023606e-01 1 1  ON 46
  eH2_7                 1.494700e-01 1 1  ON 47
  eH2_8                 1.578830e-01 1 1  ON 48
  eH2_9                 1.838797e-02 1 1  ON 49
ci_0001                 6.999976e-01 3 1  ON 50
ci_0002                 7.009974e-01 3 1  ON 51
ci_0003                -2.933983e-02 3 1  ON 52
ci_0004                -2.901398e-02 3 1  ON 53
ci_0005                -3.760619e-02 3 1  ON 54
ci_0006                -3.808511e-02 3 1  ON 55
ci_0007                -2.465529e-02 3 1  ON 56
ci_0008                -2.522853e-02 3 1  ON 57
ci_0009                -1.795411e-02 3 1  ON 58
ci_0010                -1.766360e-02 3 1  ON 59
ci_0011                -1.252393e-02 3 1  ON 60
ci_0012                -1.246937e-02 3 1  ON 61
ci_0013                 1.359191e-02 3 1  ON 62
ci_0014                 1.292097e-02 3 1  ON 63
ci_0015                 1.364612e-02 3 1  ON 64
ci_0016                 1.375851e-02 3 1  ON 65
ci_0017                 1.218543e-02 3 1  ON 66
ci_0018                 1.130490e-02 3 1  ON 67
ci_0019                 1.155062e-02 3 1  ON 68
ci_0020                 1.191226e-02 3 1  ON 69
ci_0021                 3.656716e-03 3 1  ON 70
ci_0022                 3.610122e-03 3 1  ON 71
ci_0023                -1.229438e-02 3 1  ON 72
ci_0024                -1.098411e-02 3 1  ON 73
ci_0025                -1.062548e-02 3 1  ON 74
ci_0026                -1.135728e-02 3 1  ON 75
ci_0027                -1.146489e-02 3 1  ON 76
ci_0028                -1.102472e-02 3 1  ON 77
ci_0029                -1.004628e-02 3 1  ON 78
ci_0030                -1.042241e-02 3 1  ON 79
ci_0031                 1.879257e-02 3 1  ON 80
ci_0032                 2.069415e-02 3 1  ON 81
ci_0033                 1.135243e-02 3 1  ON 82
ci_0034                 9.787405e-03 3 1  ON 83
ci_0035                 8.077451e-03 3 1  ON 84
ci_0036                 6.721227e-03 3 1  ON 85
ci_0037                -1.101496e-02 3 1  ON 86
ci_0038                -1.077734e-02 3 1  ON 87
ci_0039                -2.924965e-03 3 1  ON 88
ci_0040                -2.869929e-03 3 1  ON 89
ci_0041                 7.609802e-03 3 1  ON 90
ci_0042                 7.595228e-03 3 1  ON 91
ci_0043                -1.715286e-02 3 1  ON 92
ci_0044                -1.676549e-02 3 1  ON 93
ci_0045                 8.436318e-03 3 1  ON 94
ci_0046                 8.439711e-03 3 1  ON 95
ci_0047                -2.252803e-03 3 1  ON 96
ci_0048                -2.257335e-03 3 1  ON 97
ci_0049                -5.421913e-03 3 1  ON 98
ci_0050                -5.514690e-03 3 1  ON 99
ci_0051                -3.593597e-03 3 1  ON 100
ci_0052                -4.017821e-03 3 1  ON 101
ci_0053                -4.626698e-03 3 1  ON 102
ci_0054                -4.724000e-03 3 1  ON 103
ci_0055                 6.972789e-03 3 1  ON 104
ci_0056                 7.213934e-03 3 1  ON 105
ci_0057                 5.140603e-03 3 1  ON 106
ci_0058                 5.828690e-03 3 1  ON 107
ci_0059                -5.253947e-03 3 1  ON 108
ci_0060                -5.423221e-03 3 1  ON 109
ci_0061                -4.355038e-03 3 1  ON 110
ci_0062                -4.101406e-03 3 1  ON 111
ci_0063                -8.880996e-03 3 1  ON 112
ci_0064                -8.539140e-03 3 1  ON 113
ci_0065                -5.584584e-03 3 1  ON 114
ci_0066                -5.909828e-03 3 1  ON 115
ci_0067                -5.094167e-03 3 1  ON 116
ci_0068                -4.901298e-03 3 1  ON 117
ci_0069                 4.823555e-03 3 1  ON 118
ci_0070                 4.591801e-03 3 1  ON 119
ci_0071                 1.163966e-03 3 1  ON 120
ci_0072                 1.460219e-03 3 1  ON 121
ci_0073                 4.476258e-03 3 1  ON 122
ci_0074                 4.616343e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8934
    reference variance = 0.2666
====================================================
  Execution time = 2.0755e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3049e-01
  Total weights = 1.9514e+06
  Execution time = 1.8937e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318578008393
                                         uncertainty =       0.002121923822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318578008393
                                         uncertainty =       0.002121923822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399078677
  error estimate for blocks of size 2^( 2) =       0.000412643879
  error estimate for blocks of size 2^( 3) =       0.000425711616
  error estimate for blocks of size 2^( 4) =       0.000438146519
  error estimate for blocks of size 2^( 5) =       0.000449623845
  error estimate for blocks of size 2^( 6) =       0.000458242791
  error estimate for blocks of size 2^( 7) =       0.000464983244

      target function =                  N/A
              le_mean =     -16.905435464936
             les_mean =     286.140835128131
             stat err =       0.000452749100
             autocorr =       1.287058075904
              std dev =       0.564382476968
             le_variance =       0.318527580308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321018119923
                                         uncertainty =       0.002677263730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321018119923
                                         uncertainty =       0.002677263730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400606060
  error estimate for blocks of size 2^( 2) =       0.000413998408
  error estimate for blocks of size 2^( 3) =       0.000427000674
  error estimate for blocks of size 2^( 4) =       0.000439342733
  error estimate for blocks of size 2^( 5) =       0.000450853536
  error estimate for blocks of size 2^( 6) =       0.000459429841
  error estimate for blocks of size 2^( 7) =       0.000466177395

      target function =                  N/A
              le_mean =     -16.905390972342
             les_mean =     286.232875458321
             stat err =       0.000453950876
             autocorr =       1.284052225747
              std dev =       0.566542523540
             le_variance =       0.320970430979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321632318888
                                         uncertainty =       0.002675400821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321632318888
                                         uncertainty =       0.002675400821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400986027
  error estimate for blocks of size 2^( 2) =       0.000414417971
  error estimate for blocks of size 2^( 3) =       0.000427460200
  error estimate for blocks of size 2^( 4) =       0.000439871950
  error estimate for blocks of size 2^( 5) =       0.000451343155
  error estimate for blocks of size 2^( 6) =       0.000459942833
  error estimate for blocks of size 2^( 7) =       0.000466751491

      target function =                  N/A
              le_mean =     -16.905463085305
             les_mean =     286.395682557191
             stat err =       0.000454477357
             autocorr =       1.284594398332
              std dev =       0.567079877662
             le_variance =       0.321579587649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318193283807
                                         uncertainty =       0.002133064009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318193283807
                                         uncertainty =       0.002133064009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398838243
  error estimate for blocks of size 2^( 2) =       0.000412358860
  error estimate for blocks of size 2^( 3) =       0.000425431580
  error estimate for blocks of size 2^( 4) =       0.000437867405
  error estimate for blocks of size 2^( 5) =       0.000449346301
  error estimate for blocks of size 2^( 6) =       0.000457981688
  error estimate for blocks of size 2^( 7) =       0.000464662142

      target function =                  N/A
              le_mean =     -16.905404645416
             les_mean =     286.125286180596
             stat err =       0.000452464384
             autocorr =       1.286990109193
              std dev =       0.564042452777
             le_variance =       0.318143888535


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905435464936        initial
     3.9062e-02     3.9062e-01             1.0192e-02       -16.905390972342
     1.5625e-01     1.5625e+00             4.2976e-03       -16.905463085305  <--
     6.2500e-01     6.2500e+00             1.3918e-03       -16.905404645416

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 3.0311e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
   uu_0                 3.070948e-01 1 1  ON 0
   uu_1                 1.413088e-01 1 1  ON 1
   uu_2                 4.118014e-02 1 1  ON 2
   uu_3                -1.927309e-02 1 1  ON 3
   uu_4                -6.276600e-02 1 1  ON 4
   uu_5                -9.591450e-02 1 1  ON 5
   uu_6                -1.221934e-01 1 1  ON 6
   uu_7                -1.344001e-01 1 1  ON 7
   uu_8                -1.247813e-01 1 1  ON 8
   uu_9                -9.481067e-02 1 1  ON 9
   ud_0                 4.381701e-01 1 1  ON 10
   ud_1                 1.741267e-01 1 1  ON 11
   ud_2                 5.637756e-02 1 1  ON 12
   ud_3                -1.178100e-02 1 1  ON 13
   ud_4                -6.634434e-02 1 1  ON 14
   ud_5                -1.059806e-01 1 1  ON 15
   ud_6                -1.316898e-01 1 1  ON 16
   ud_7                -1.464399e-01 1 1  ON 17
   ud_8                -1.463636e-01 1 1  ON 18
   ud_9                -1.349893e-01 1 1  ON 19
   eO_0                -7.340186e-01 1 1  ON 20
   eO_1                -4.194121e-01 1 1  ON 21
   eO_2                -1.685192e-02 1 1  ON 22
   eO_3                 2.848923e-01 1 1  ON 23
   eO_4                 5.003462e-01 1 1  ON 24
   eO_5                 4.602463e-01 1 1  ON 25
   eO_6                 2.368779e-01 1 1  ON 26
   eO_7                -5.440950e-02 1 1  ON 27
   eO_8                -1.998696e-01 1 1  ON 28
   eO_9                -6.047226e-02 1 1  ON 29
  eH1_0                -2.322442e-01 1 1  ON 30
  eH1_1                -1.329701e-01 1 1  ON 31
  eH1_2                -8.517573e-02 1 1  ON 32
  eH1_3                -3.250730e-02 1 1  ON 33
  eH1_4                 1.617437e-02 1 1  ON 34
  eH1_5                 4.730441e-02 1 1  ON 35
  eH1_6                 9.719156e-02 1 1  ON 36
  eH1_7                 1.402492e-01 1 1  ON 37
  eH1_8                 1.498232e-01 1 1  ON 38
  eH1_9                 3.675300e-02 1 1  ON 39
  eH2_0                -2.311773e-01 1 1  ON 40
  eH2_1                -1.314453e-01 1 1  ON 41
  eH2_2                -8.396016e-02 1 1  ON 42
  eH2_3                -3.102046e-02 1 1  ON 43
  eH2_4                 1.746559e-02 1 1  ON 44
  eH2_5                 5.024414e-02 1 1  ON 45
  eH2_6                 1.023606e-01 1 1  ON 46
  eH2_7                 1.494700e-01 1 1  ON 47
  eH2_8                 1.578830e-01 1 1  ON 48
  eH2_9                 1.838797e-02 1 1  ON 49
ci_0001                 6.999976e-01 3 1  ON 50
ci_0002                 7.009974e-01 3 1  ON 51
ci_0003                -2.933983e-02 3 1  ON 52
ci_0004                -2.901398e-02 3 1  ON 53
ci_0005                -3.760619e-02 3 1  ON 54
ci_0006                -3.808511e-02 3 1  ON 55
ci_0007                -2.465529e-02 3 1  ON 56
ci_0008                -2.522853e-02 3 1  ON 57
ci_0009                -1.795411e-02 3 1  ON 58
ci_0010                -1.766360e-02 3 1  ON 59
ci_0011                -1.252393e-02 3 1  ON 60
ci_0012                -1.246937e-02 3 1  ON 61
ci_0013                 1.359191e-02 3 1  ON 62
ci_0014                 1.292097e-02 3 1  ON 63
ci_0015                 1.364612e-02 3 1  ON 64
ci_0016                 1.375851e-02 3 1  ON 65
ci_0017                 1.218543e-02 3 1  ON 66
ci_0018                 1.130490e-02 3 1  ON 67
ci_0019                 1.155062e-02 3 1  ON 68
ci_0020                 1.191226e-02 3 1  ON 69
ci_0021                 3.656716e-03 3 1  ON 70
ci_0022                 3.610122e-03 3 1  ON 71
ci_0023                -1.229438e-02 3 1  ON 72
ci_0024                -1.098411e-02 3 1  ON 73
ci_0025                -1.062548e-02 3 1  ON 74
ci_0026                -1.135728e-02 3 1  ON 75
ci_0027                -1.146489e-02 3 1  ON 76
ci_0028                -1.102472e-02 3 1  ON 77
ci_0029                -1.004628e-02 3 1  ON 78
ci_0030                -1.042241e-02 3 1  ON 79
ci_0031                 1.879257e-02 3 1  ON 80
ci_0032                 2.069415e-02 3 1  ON 81
ci_0033                 1.135243e-02 3 1  ON 82
ci_0034                 9.787405e-03 3 1  ON 83
ci_0035                 8.077451e-03 3 1  ON 84
ci_0036                 6.721227e-03 3 1  ON 85
ci_0037                -1.101496e-02 3 1  ON 86
ci_0038                -1.077734e-02 3 1  ON 87
ci_0039                -2.924965e-03 3 1  ON 88
ci_0040                -2.869929e-03 3 1  ON 89
ci_0041                 7.609802e-03 3 1  ON 90
ci_0042                 7.595228e-03 3 1  ON 91
ci_0043                -1.715286e-02 3 1  ON 92
ci_0044                -1.676549e-02 3 1  ON 93
ci_0045                 8.436318e-03 3 1  ON 94
ci_0046                 8.439711e-03 3 1  ON 95
ci_0047                -2.252803e-03 3 1  ON 96
ci_0048                -2.257335e-03 3 1  ON 97
ci_0049                -5.421913e-03 3 1  ON 98
ci_0050                -5.514690e-03 3 1  ON 99
ci_0051                -3.593597e-03 3 1  ON 100
ci_0052                -4.017821e-03 3 1  ON 101
ci_0053                -4.626698e-03 3 1  ON 102
ci_0054                -4.724000e-03 3 1  ON 103
ci_0055                 6.972789e-03 3 1  ON 104
ci_0056                 7.213934e-03 3 1  ON 105
ci_0057                 5.140603e-03 3 1  ON 106
ci_0058                 5.828690e-03 3 1  ON 107
ci_0059                -5.253947e-03 3 1  ON 108
ci_0060                -5.423221e-03 3 1  ON 109
ci_0061                -4.355038e-03 3 1  ON 110
ci_0062                -4.101406e-03 3 1  ON 111
ci_0063                -8.880996e-03 3 1  ON 112
ci_0064                -8.539140e-03 3 1  ON 113
ci_0065                -5.584584e-03 3 1  ON 114
ci_0066                -5.909828e-03 3 1  ON 115
ci_0067                -5.094167e-03 3 1  ON 116
ci_0068                -4.901298e-03 3 1  ON 117
ci_0069                 4.823555e-03 3 1  ON 118
ci_0070                 4.591801e-03 3 1  ON 119
ci_0071                 1.163966e-03 3 1  ON 120
ci_0072                 1.460219e-03 3 1  ON 121
ci_0073                 4.476258e-03 3 1  ON 122
ci_0074                 4.616343e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7733e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6869e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9538
    reference variance = 0.286807
====================================================
  Execution time = 2.1253e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5228e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3005e-01
  Total weights = 1.951631786e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318465269671
                                         uncertainty =       0.002082768195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318465269671
                                         uncertainty =       0.002082768195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399028119
  error estimate for blocks of size 2^( 2) =       0.000411467684
  error estimate for blocks of size 2^( 3) =       0.000424223031
  error estimate for blocks of size 2^( 4) =       0.000435875556
  error estimate for blocks of size 2^( 5) =       0.000447545207
  error estimate for blocks of size 2^( 6) =       0.000455122892
  error estimate for blocks of size 2^( 7) =       0.000459619461

      target function =                  N/A
              le_mean =     -16.905852522383
             les_mean =     286.137902762250
             stat err =       0.000449540779
             autocorr =       1.269203278184
              std dev =       0.564310978252
             le_variance =       0.318446880176


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690585252238e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905852522376       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905903204977       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905934672149       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905935545735       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905942402008       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905947279532       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905950775236       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905944357522       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905945440114       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905943192278       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905942952987       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905946008325       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905947962670       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905949362782       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905950796856       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905949684550       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905951483859       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905952227846       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905951911971       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905952610548       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905952074505       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905951973644       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905952221788       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.905952049468       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.905952181764       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e-02 is 8.509063e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905852522376       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905885637563       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905899592191       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905901186110       residual = 8.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905904088663       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905905145742       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905905394456       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905902977092       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905903135141       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905902821351       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905903135988       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905903528483       residual = 8.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905903700761       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905903852105       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905903987299       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905904097863       residual = 4.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5625e-01 is 3.274901e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905852522376       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905866398547       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905869967429       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905870964045       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905872203811       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905872258797       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905871509869       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905871199583       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905871185990       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905871256554       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905871344344       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905871264437       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e-01 is 1.057080e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.257753 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0105e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
   uu_0                 3.084433e-01 1 1  ON 0
   uu_1                 1.419215e-01 1 1  ON 1
   uu_2                 4.115612e-02 1 1  ON 2
   uu_3                -1.969410e-02 1 1  ON 3
   uu_4                -6.362927e-02 1 1  ON 4
   uu_5                -9.640502e-02 1 1  ON 5
   uu_6                -1.225749e-01 1 1  ON 6
   uu_7                -1.349569e-01 1 1  ON 7
   uu_8                -1.258544e-01 1 1  ON 8
   uu_9                -9.499992e-02 1 1  ON 9
   ud_0                 4.397197e-01 1 1  ON 10
   ud_1                 1.753386e-01 1 1  ON 11
   ud_2                 5.670647e-02 1 1  ON 12
   ud_3                -1.200564e-02 1 1  ON 13
   ud_4                -6.680405e-02 1 1  ON 14
   ud_5                -1.065246e-01 1 1  ON 15
   ud_6                -1.318793e-01 1 1  ON 16
   ud_7                -1.470094e-01 1 1  ON 17
   ud_8                -1.469556e-01 1 1  ON 18
   ud_9                -1.354018e-01 1 1  ON 19
   eO_0                -7.372395e-01 1 1  ON 20
   eO_1                -4.205608e-01 1 1  ON 21
   eO_2                -1.669404e-02 1 1  ON 22
   eO_3                 2.865504e-01 1 1  ON 23
   eO_4                 5.022528e-01 1 1  ON 24
   eO_5                 4.616745e-01 1 1  ON 25
   eO_6                 2.375342e-01 1 1  ON 26
   eO_7                -5.426400e-02 1 1  ON 27
   eO_8                -2.006646e-01 1 1  ON 28
   eO_9                -6.115372e-02 1 1  ON 29
  eH1_0                -2.355191e-01 1 1  ON 30
  eH1_1                -1.338974e-01 1 1  ON 31
  eH1_2                -8.551651e-02 1 1  ON 32
  eH1_3                -3.250974e-02 1 1  ON 33
  eH1_4                 1.578863e-02 1 1  ON 34
  eH1_5                 4.787004e-02 1 1  ON 35
  eH1_6                 9.786123e-02 1 1  ON 36
  eH1_7                 1.410891e-01 1 1  ON 37
  eH1_8                 1.513096e-01 1 1  ON 38
  eH1_9                 3.795860e-02 1 1  ON 39
  eH2_0                -2.342305e-01 1 1  ON 40
  eH2_1                -1.325630e-01 1 1  ON 41
  eH2_2                -8.417931e-02 1 1  ON 42
  eH2_3                -3.072742e-02 1 1  ON 43
  eH2_4                 1.810112e-02 1 1  ON 44
  eH2_5                 5.081105e-02 1 1  ON 45
  eH2_6                 1.029383e-01 1 1  ON 46
  eH2_7                 1.495686e-01 1 1  ON 47
  eH2_8                 1.585584e-01 1 1  ON 48
  eH2_9                 1.970297e-02 1 1  ON 49
ci_0001                 7.006418e-01 3 1  ON 50
ci_0002                 7.006784e-01 3 1  ON 51
ci_0003                -2.808464e-02 3 1  ON 52
ci_0004                -2.792820e-02 3 1  ON 53
ci_0005                -3.708436e-02 3 1  ON 54
ci_0006                -3.750011e-02 3 1  ON 55
ci_0007                -2.326236e-02 3 1  ON 56
ci_0008                -2.390767e-02 3 1  ON 57
ci_0009                -1.797495e-02 3 1  ON 58
ci_0010                -1.761032e-02 3 1  ON 59
ci_0011                -1.191864e-02 3 1  ON 60
ci_0012                -1.292034e-02 3 1  ON 61
ci_0013                 1.310041e-02 3 1  ON 62
ci_0014                 1.362612e-02 3 1  ON 63
ci_0015                 1.320047e-02 3 1  ON 64
ci_0016                 1.344878e-02 3 1  ON 65
ci_0017                 1.096136e-02 3 1  ON 66
ci_0018                 1.156901e-02 3 1  ON 67
ci_0019                 1.136224e-02 3 1  ON 68
ci_0020                 1.198123e-02 3 1  ON 69
ci_0021                 2.034247e-03 3 1  ON 70
ci_0022                 2.028011e-03 3 1  ON 71
ci_0023                -1.210881e-02 3 1  ON 72
ci_0024                -1.087527e-02 3 1  ON 73
ci_0025                -1.022567e-02 3 1  ON 74
ci_0026                -1.094246e-02 3 1  ON 75
ci_0027                -1.076521e-02 3 1  ON 76
ci_0028                -1.107796e-02 3 1  ON 77
ci_0029                -1.043776e-02 3 1  ON 78
ci_0030                -1.094683e-02 3 1  ON 79
ci_0031                 1.996090e-02 3 1  ON 80
ci_0032                 2.053502e-02 3 1  ON 81
ci_0033                 1.072897e-02 3 1  ON 82
ci_0034                 1.037268e-02 3 1  ON 83
ci_0035                 7.379575e-03 3 1  ON 84
ci_0036                 6.593614e-03 3 1  ON 85
ci_0037                -1.036132e-02 3 1  ON 86
ci_0038                -1.094233e-02 3 1  ON 87
ci_0039                -2.638479e-03 3 1  ON 88
ci_0040                -2.839590e-03 3 1  ON 89
ci_0041                 7.677399e-03 3 1  ON 90
ci_0042                 6.964587e-03 3 1  ON 91
ci_0043                -1.763829e-02 3 1  ON 92
ci_0044                -1.768191e-02 3 1  ON 93
ci_0045                 8.201501e-03 3 1  ON 94
ci_0046                 8.169388e-03 3 1  ON 95
ci_0047                -1.943983e-03 3 1  ON 96
ci_0048                -2.141665e-03 3 1  ON 97
ci_0049                -5.532092e-03 3 1  ON 98
ci_0050                -5.043399e-03 3 1  ON 99
ci_0051                -3.446721e-03 3 1  ON 100
ci_0052                -3.594726e-03 3 1  ON 101
ci_0053                -4.937634e-03 3 1  ON 102
ci_0054                -4.377937e-03 3 1  ON 103
ci_0055                 7.802298e-03 3 1  ON 104
ci_0056                 6.693008e-03 3 1  ON 105
ci_0057                 5.435882e-03 3 1  ON 106
ci_0058                 5.022592e-03 3 1  ON 107
ci_0059                -4.932808e-03 3 1  ON 108
ci_0060                -4.955680e-03 3 1  ON 109
ci_0061                -3.964814e-03 3 1  ON 110
ci_0062                -3.608000e-03 3 1  ON 111
ci_0063                -9.304584e-03 3 1  ON 112
ci_0064                -8.318828e-03 3 1  ON 113
ci_0065                -5.194040e-03 3 1  ON 114
ci_0066                -5.353393e-03 3 1  ON 115
ci_0067                -4.783521e-03 3 1  ON 116
ci_0068                -4.894618e-03 3 1  ON 117
ci_0069                 4.604230e-03 3 1  ON 118
ci_0070                 4.630263e-03 3 1  ON 119
ci_0071                 1.019264e-03 3 1  ON 120
ci_0072                 1.119015e-03 3 1  ON 121
ci_0073                 4.494744e-03 3 1  ON 122
ci_0074                 4.150811e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9182
    reference variance = 0.265087
====================================================
  Execution time = 2.1264e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3785e-01
  Total weights = 1.9514e+06
  Execution time = 1.8991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321380571947
                                         uncertainty =       0.002744555367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321380571947
                                         uncertainty =       0.002744555367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400807486
  error estimate for blocks of size 2^( 2) =       0.000413694803
  error estimate for blocks of size 2^( 3) =       0.000426885181
  error estimate for blocks of size 2^( 4) =       0.000439518273
  error estimate for blocks of size 2^( 5) =       0.000450234993
  error estimate for blocks of size 2^( 6) =       0.000458582019
  error estimate for blocks of size 2^( 7) =       0.000462373401

      target function =                  N/A
              le_mean =     -16.906696052060
             les_mean =     286.195358534252
             stat err =       0.000452677171
             autocorr =       1.275573643943
              std dev =       0.566827383285
             le_variance =       0.321293282442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321102340806
                                         uncertainty =       0.002067305089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321102340806
                                         uncertainty =       0.002067305089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400639752
  error estimate for blocks of size 2^( 2) =       0.000413515841
  error estimate for blocks of size 2^( 3) =       0.000426690028
  error estimate for blocks of size 2^( 4) =       0.000439091439
  error estimate for blocks of size 2^( 5) =       0.000449396480
  error estimate for blocks of size 2^( 6) =       0.000457720704
  error estimate for blocks of size 2^( 7) =       0.000461578641

      target function =                  N/A
              le_mean =     -16.906738267072
             les_mean =     286.176516376921
             stat err =       0.000451946816
             autocorr =       1.272525768616
              std dev =       0.566590170962
             le_variance =       0.321024421830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320817568675
                                         uncertainty =       0.002052167529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320817568675
                                         uncertainty =       0.002052167529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400462177
  error estimate for blocks of size 2^( 2) =       0.000413340886
  error estimate for blocks of size 2^( 3) =       0.000426548782
  error estimate for blocks of size 2^( 4) =       0.000438998048
  error estimate for blocks of size 2^( 5) =       0.000449380176
  error estimate for blocks of size 2^( 6) =       0.000457715862
  error estimate for blocks of size 2^( 7) =       0.000461473502

      target function =                  N/A
              le_mean =     -16.906753721191
             les_mean =     286.188166650229
             stat err =       0.000451891897
             autocorr =       1.273345037495
              std dev =       0.566339041871
             le_variance =       0.320739910348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346097963131
                                         uncertainty =       0.026613370136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346097963131
                                         uncertainty =       0.026613370136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415856693
  error estimate for blocks of size 2^( 2) =       0.000428340976
  error estimate for blocks of size 2^( 3) =       0.000441130538
  error estimate for blocks of size 2^( 4) =       0.000453763620
  error estimate for blocks of size 2^( 5) =       0.000465006035
  error estimate for blocks of size 2^( 6) =       0.000473152310
  error estimate for blocks of size 2^( 7) =       0.000476547594

      target function =                  N/A
              le_mean =     -16.906589644427
             les_mean =     286.203362246762
             stat err =       0.000467117390
             autocorr =       1.261724914682
              std dev =       0.588110175652
             le_variance =       0.345873578706


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906696052060        initial
     3.9062e-02     3.9062e-01             8.5091e-03       -16.906738267072
     1.5625e-01     1.5625e+00             3.2749e-03       -16.906753721191  <--
     6.2500e-01     6.2500e+00             1.0571e-03       -16.906589644427

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 3.0846e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
   uu_0                 3.084433e-01 1 1  ON 0
   uu_1                 1.419215e-01 1 1  ON 1
   uu_2                 4.115612e-02 1 1  ON 2
   uu_3                -1.969410e-02 1 1  ON 3
   uu_4                -6.362927e-02 1 1  ON 4
   uu_5                -9.640502e-02 1 1  ON 5
   uu_6                -1.225749e-01 1 1  ON 6
   uu_7                -1.349569e-01 1 1  ON 7
   uu_8                -1.258544e-01 1 1  ON 8
   uu_9                -9.499992e-02 1 1  ON 9
   ud_0                 4.397197e-01 1 1  ON 10
   ud_1                 1.753386e-01 1 1  ON 11
   ud_2                 5.670647e-02 1 1  ON 12
   ud_3                -1.200564e-02 1 1  ON 13
   ud_4                -6.680405e-02 1 1  ON 14
   ud_5                -1.065246e-01 1 1  ON 15
   ud_6                -1.318793e-01 1 1  ON 16
   ud_7                -1.470094e-01 1 1  ON 17
   ud_8                -1.469556e-01 1 1  ON 18
   ud_9                -1.354018e-01 1 1  ON 19
   eO_0                -7.372395e-01 1 1  ON 20
   eO_1                -4.205608e-01 1 1  ON 21
   eO_2                -1.669404e-02 1 1  ON 22
   eO_3                 2.865504e-01 1 1  ON 23
   eO_4                 5.022528e-01 1 1  ON 24
   eO_5                 4.616745e-01 1 1  ON 25
   eO_6                 2.375342e-01 1 1  ON 26
   eO_7                -5.426400e-02 1 1  ON 27
   eO_8                -2.006646e-01 1 1  ON 28
   eO_9                -6.115372e-02 1 1  ON 29
  eH1_0                -2.355191e-01 1 1  ON 30
  eH1_1                -1.338974e-01 1 1  ON 31
  eH1_2                -8.551651e-02 1 1  ON 32
  eH1_3                -3.250974e-02 1 1  ON 33
  eH1_4                 1.578863e-02 1 1  ON 34
  eH1_5                 4.787004e-02 1 1  ON 35
  eH1_6                 9.786123e-02 1 1  ON 36
  eH1_7                 1.410891e-01 1 1  ON 37
  eH1_8                 1.513096e-01 1 1  ON 38
  eH1_9                 3.795860e-02 1 1  ON 39
  eH2_0                -2.342305e-01 1 1  ON 40
  eH2_1                -1.325630e-01 1 1  ON 41
  eH2_2                -8.417931e-02 1 1  ON 42
  eH2_3                -3.072742e-02 1 1  ON 43
  eH2_4                 1.810112e-02 1 1  ON 44
  eH2_5                 5.081105e-02 1 1  ON 45
  eH2_6                 1.029383e-01 1 1  ON 46
  eH2_7                 1.495686e-01 1 1  ON 47
  eH2_8                 1.585584e-01 1 1  ON 48
  eH2_9                 1.970297e-02 1 1  ON 49
ci_0001                 7.006418e-01 3 1  ON 50
ci_0002                 7.006784e-01 3 1  ON 51
ci_0003                -2.808464e-02 3 1  ON 52
ci_0004                -2.792820e-02 3 1  ON 53
ci_0005                -3.708436e-02 3 1  ON 54
ci_0006                -3.750011e-02 3 1  ON 55
ci_0007                -2.326236e-02 3 1  ON 56
ci_0008                -2.390767e-02 3 1  ON 57
ci_0009                -1.797495e-02 3 1  ON 58
ci_0010                -1.761032e-02 3 1  ON 59
ci_0011                -1.191864e-02 3 1  ON 60
ci_0012                -1.292034e-02 3 1  ON 61
ci_0013                 1.310041e-02 3 1  ON 62
ci_0014                 1.362612e-02 3 1  ON 63
ci_0015                 1.320047e-02 3 1  ON 64
ci_0016                 1.344878e-02 3 1  ON 65
ci_0017                 1.096136e-02 3 1  ON 66
ci_0018                 1.156901e-02 3 1  ON 67
ci_0019                 1.136224e-02 3 1  ON 68
ci_0020                 1.198123e-02 3 1  ON 69
ci_0021                 2.034247e-03 3 1  ON 70
ci_0022                 2.028011e-03 3 1  ON 71
ci_0023                -1.210881e-02 3 1  ON 72
ci_0024                -1.087527e-02 3 1  ON 73
ci_0025                -1.022567e-02 3 1  ON 74
ci_0026                -1.094246e-02 3 1  ON 75
ci_0027                -1.076521e-02 3 1  ON 76
ci_0028                -1.107796e-02 3 1  ON 77
ci_0029                -1.043776e-02 3 1  ON 78
ci_0030                -1.094683e-02 3 1  ON 79
ci_0031                 1.996090e-02 3 1  ON 80
ci_0032                 2.053502e-02 3 1  ON 81
ci_0033                 1.072897e-02 3 1  ON 82
ci_0034                 1.037268e-02 3 1  ON 83
ci_0035                 7.379575e-03 3 1  ON 84
ci_0036                 6.593614e-03 3 1  ON 85
ci_0037                -1.036132e-02 3 1  ON 86
ci_0038                -1.094233e-02 3 1  ON 87
ci_0039                -2.638479e-03 3 1  ON 88
ci_0040                -2.839590e-03 3 1  ON 89
ci_0041                 7.677399e-03 3 1  ON 90
ci_0042                 6.964587e-03 3 1  ON 91
ci_0043                -1.763829e-02 3 1  ON 92
ci_0044                -1.768191e-02 3 1  ON 93
ci_0045                 8.201501e-03 3 1  ON 94
ci_0046                 8.169388e-03 3 1  ON 95
ci_0047                -1.943983e-03 3 1  ON 96
ci_0048                -2.141665e-03 3 1  ON 97
ci_0049                -5.532092e-03 3 1  ON 98
ci_0050                -5.043399e-03 3 1  ON 99
ci_0051                -3.446721e-03 3 1  ON 100
ci_0052                -3.594726e-03 3 1  ON 101
ci_0053                -4.937634e-03 3 1  ON 102
ci_0054                -4.377937e-03 3 1  ON 103
ci_0055                 7.802298e-03 3 1  ON 104
ci_0056                 6.693008e-03 3 1  ON 105
ci_0057                 5.435882e-03 3 1  ON 106
ci_0058                 5.022592e-03 3 1  ON 107
ci_0059                -4.932808e-03 3 1  ON 108
ci_0060                -4.955680e-03 3 1  ON 109
ci_0061                -3.964814e-03 3 1  ON 110
ci_0062                -3.608000e-03 3 1  ON 111
ci_0063                -9.304584e-03 3 1  ON 112
ci_0064                -8.318828e-03 3 1  ON 113
ci_0065                -5.194040e-03 3 1  ON 114
ci_0066                -5.353393e-03 3 1  ON 115
ci_0067                -4.783521e-03 3 1  ON 116
ci_0068                -4.894618e-03 3 1  ON 117
ci_0069                 4.604230e-03 3 1  ON 118
ci_0070                 4.630263e-03 3 1  ON 119
ci_0071                 1.019264e-03 3 1  ON 120
ci_0072                 1.119015e-03 3 1  ON 121
ci_0073                 4.494744e-03 3 1  ON 122
ci_0074                 4.150811e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0959e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6878e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9271
    reference variance = 0.204756
====================================================
  Execution time = 2.1487e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3893e-01
  Total weights = 1.951776880e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0912e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324872495187
                                         uncertainty =       0.003809793954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324872495187
                                         uncertainty =       0.003809793954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403044476
  error estimate for blocks of size 2^( 2) =       0.000415991312
  error estimate for blocks of size 2^( 3) =       0.000429446261
  error estimate for blocks of size 2^( 4) =       0.000442488613
  error estimate for blocks of size 2^( 5) =       0.000454385145
  error estimate for blocks of size 2^( 6) =       0.000463506779
  error estimate for blocks of size 2^( 7) =       0.000468136637

      target function =                  N/A
              le_mean =     -16.905855200883
             les_mean =     286.146868321985
             stat err =       0.000457129294
             autocorr =       1.286388526547
              std dev =       0.569990964548
             le_variance =       0.324889699666


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690585520088e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905855200845       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905887974159       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905885624586       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905886593191       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905892034327       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905898473442       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905902777662       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905898567763       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905899675901       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905903526717       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905903853135       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905905977806       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905907280665       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905908231457       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905909917444       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905910753021       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905911143696       residual = 8.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905912038974       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905911381775       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905911026894       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905910750457       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905910729807       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905910682146       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.905910958704       residual = 8.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e-02 is 6.161028e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905855200845       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905877631457       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905874846295       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905874607487       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905876938286       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905879450034       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905881780040       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905879140266       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905879780365       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905881059333       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905881010660       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905881280132       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905881275763       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905881228568       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905881406763       residual = 8.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5625e-01 is 2.391133e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905855200845       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905865115633       residual = 9.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905863976275       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905863462788       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905863674440       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905864917200       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905865326439       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905864841983       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905864918306       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905865074295       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905865184894       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e-01 is 7.442462e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.270016 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7594e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
   uu_0                 3.093045e-01 1 1  ON 0
   uu_1                 1.424551e-01 1 1  ON 1
   uu_2                 4.147066e-02 1 1  ON 2
   uu_3                -1.954438e-02 1 1  ON 3
   uu_4                -6.364263e-02 1 1  ON 4
   uu_5                -9.701357e-02 1 1  ON 5
   uu_6                -1.232350e-01 1 1  ON 6
   uu_7                -1.354443e-01 1 1  ON 7
   uu_8                -1.265162e-01 1 1  ON 8
   uu_9                -9.555039e-02 1 1  ON 9
   ud_0                 4.413153e-01 1 1  ON 10
   ud_1                 1.762880e-01 1 1  ON 11
   ud_2                 5.727381e-02 1 1  ON 12
   ud_3                -1.218533e-02 1 1  ON 13
   ud_4                -6.700945e-02 1 1  ON 14
   ud_5                -1.067429e-01 1 1  ON 15
   ud_6                -1.322740e-01 1 1  ON 16
   ud_7                -1.473490e-01 1 1  ON 17
   ud_8                -1.474010e-01 1 1  ON 18
   ud_9                -1.360959e-01 1 1  ON 19
   eO_0                -7.392273e-01 1 1  ON 20
   eO_1                -4.217267e-01 1 1  ON 21
   eO_2                -1.667003e-02 1 1  ON 22
   eO_3                 2.879134e-01 1 1  ON 23
   eO_4                 5.038355e-01 1 1  ON 24
   eO_5                 4.626875e-01 1 1  ON 25
   eO_6                 2.383597e-01 1 1  ON 26
   eO_7                -5.391938e-02 1 1  ON 27
   eO_8                -2.016155e-01 1 1  ON 28
   eO_9                -6.203165e-02 1 1  ON 29
  eH1_0                -2.377684e-01 1 1  ON 30
  eH1_1                -1.347294e-01 1 1  ON 31
  eH1_2                -8.593706e-02 1 1  ON 32
  eH1_3                -3.271302e-02 1 1  ON 33
  eH1_4                 1.540096e-02 1 1  ON 34
  eH1_5                 4.776003e-02 1 1  ON 35
  eH1_6                 9.856992e-02 1 1  ON 36
  eH1_7                 1.421430e-01 1 1  ON 37
  eH1_8                 1.525388e-01 1 1  ON 38
  eH1_9                 3.914125e-02 1 1  ON 39
  eH2_0                -2.366217e-01 1 1  ON 40
  eH2_1                -1.332885e-01 1 1  ON 41
  eH2_2                -8.440264e-02 1 1  ON 42
  eH2_3                -3.058904e-02 1 1  ON 43
  eH2_4                 1.836284e-02 1 1  ON 44
  eH2_5                 5.093012e-02 1 1  ON 45
  eH2_6                 1.034494e-01 1 1  ON 46
  eH2_7                 1.498681e-01 1 1  ON 47
  eH2_8                 1.595162e-01 1 1  ON 48
  eH2_9                 2.087584e-02 1 1  ON 49
ci_0001                 7.011443e-01 3 1  ON 50
ci_0002                 7.002893e-01 3 1  ON 51
ci_0003                -2.785946e-02 3 1  ON 52
ci_0004                -2.711312e-02 3 1  ON 53
ci_0005                -3.681918e-02 3 1  ON 54
ci_0006                -3.727193e-02 3 1  ON 55
ci_0007                -2.344986e-02 3 1  ON 56
ci_0008                -2.302558e-02 3 1  ON 57
ci_0009                -1.755167e-02 3 1  ON 58
ci_0010                -1.758991e-02 3 1  ON 59
ci_0011                -1.209350e-02 3 1  ON 60
ci_0012                -1.223944e-02 3 1  ON 61
ci_0013                 1.316501e-02 3 1  ON 62
ci_0014                 1.337093e-02 3 1  ON 63
ci_0015                 1.299791e-02 3 1  ON 64
ci_0016                 1.256610e-02 3 1  ON 65
ci_0017                 1.116159e-02 3 1  ON 66
ci_0018                 1.164302e-02 3 1  ON 67
ci_0019                 1.188671e-02 3 1  ON 68
ci_0020                 1.095979e-02 3 1  ON 69
ci_0021                 1.190248e-03 3 1  ON 70
ci_0022                 1.082251e-03 3 1  ON 71
ci_0023                -1.136351e-02 3 1  ON 72
ci_0024                -1.079148e-02 3 1  ON 73
ci_0025                -1.094346e-02 3 1  ON 74
ci_0026                -1.120682e-02 3 1  ON 75
ci_0027                -1.095728e-02 3 1  ON 76
ci_0028                -1.096544e-02 3 1  ON 77
ci_0029                -1.058109e-02 3 1  ON 78
ci_0030                -1.046681e-02 3 1  ON 79
ci_0031                 1.981288e-02 3 1  ON 80
ci_0032                 2.121133e-02 3 1  ON 81
ci_0033                 9.510429e-03 3 1  ON 82
ci_0034                 1.067838e-02 3 1  ON 83
ci_0035                 7.572828e-03 3 1  ON 84
ci_0036                 7.205585e-03 3 1  ON 85
ci_0037                -9.534701e-03 3 1  ON 86
ci_0038                -1.221348e-02 3 1  ON 87
ci_0039                -2.697556e-03 3 1  ON 88
ci_0040                -2.798403e-03 3 1  ON 89
ci_0041                 6.686860e-03 3 1  ON 90
ci_0042                 7.465671e-03 3 1  ON 91
ci_0043                -1.801429e-02 3 1  ON 92
ci_0044                -1.794273e-02 3 1  ON 93
ci_0045                 8.557844e-03 3 1  ON 94
ci_0046                 7.892420e-03 3 1  ON 95
ci_0047                -2.432127e-03 3 1  ON 96
ci_0048                -1.719785e-03 3 1  ON 97
ci_0049                -5.815502e-03 3 1  ON 98
ci_0050                -5.396053e-03 3 1  ON 99
ci_0051                -3.602096e-03 3 1  ON 100
ci_0052                -3.303942e-03 3 1  ON 101
ci_0053                -4.859114e-03 3 1  ON 102
ci_0054                -5.133658e-03 3 1  ON 103
ci_0055                 7.886294e-03 3 1  ON 104
ci_0056                 6.376698e-03 3 1  ON 105
ci_0057                 5.321085e-03 3 1  ON 106
ci_0058                 5.333996e-03 3 1  ON 107
ci_0059                -4.805426e-03 3 1  ON 108
ci_0060                -5.027143e-03 3 1  ON 109
ci_0061                -4.232931e-03 3 1  ON 110
ci_0062                -3.880712e-03 3 1  ON 111
ci_0063                -8.396742e-03 3 1  ON 112
ci_0064                -8.857413e-03 3 1  ON 113
ci_0065                -5.304282e-03 3 1  ON 114
ci_0066                -5.119195e-03 3 1  ON 115
ci_0067                -4.842648e-03 3 1  ON 116
ci_0068                -5.359721e-03 3 1  ON 117
ci_0069                 4.615811e-03 3 1  ON 118
ci_0070                 4.473305e-03 3 1  ON 119
ci_0071                 1.002332e-03 3 1  ON 120
ci_0072                 1.027510e-03 3 1  ON 121
ci_0073                 4.574595e-03 3 1  ON 122
ci_0074                 4.641290e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8724
    reference variance = 0.197987
====================================================
  Execution time = 2.0904e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3473e-01
  Total weights = 1.9515e+06
  Execution time = 1.8949e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321072106023
                                         uncertainty =       0.002074912429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321072106023
                                         uncertainty =       0.002074912429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400662001
  error estimate for blocks of size 2^( 2) =       0.000414057268
  error estimate for blocks of size 2^( 3) =       0.000428013731
  error estimate for blocks of size 2^( 4) =       0.000440639454
  error estimate for blocks of size 2^( 5) =       0.000451388300
  error estimate for blocks of size 2^( 6) =       0.000459863485
  error estimate for blocks of size 2^( 7) =       0.000467126718

      target function =                  N/A
              le_mean =     -16.906059658759
             les_mean =     286.644855357282
             stat err =       0.000454754489
             autocorr =       1.288242666073
              std dev =       0.566621635802
             le_variance =       0.321060078159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323100848179
                                         uncertainty =       0.002061378060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323100848179
                                         uncertainty =       0.002061378060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401925904
  error estimate for blocks of size 2^( 2) =       0.000415298257
  error estimate for blocks of size 2^( 3) =       0.000429192944
  error estimate for blocks of size 2^( 4) =       0.000441714918
  error estimate for blocks of size 2^( 5) =       0.000452398144
  error estimate for blocks of size 2^( 6) =       0.000460874824
  error estimate for blocks of size 2^( 7) =       0.000468224694

      target function =                  N/A
              le_mean =     -16.906057699976
             les_mean =     286.159136965403
             stat err =       0.000455803145
             autocorr =       1.286064174758
              std dev =       0.568409064815
             le_variance =       0.323088864963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323645467988
                                         uncertainty =       0.002074979969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323645467988
                                         uncertainty =       0.002074979969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402264335
  error estimate for blocks of size 2^( 2) =       0.000415653450
  error estimate for blocks of size 2^( 3) =       0.000429567402
  error estimate for blocks of size 2^( 4) =       0.000442109294
  error estimate for blocks of size 2^( 5) =       0.000452804412
  error estimate for blocks of size 2^( 6) =       0.000461321956
  error estimate for blocks of size 2^( 7) =       0.000468675438

      target function =                  N/A
              le_mean =     -16.906082673543
             les_mean =     286.160480071204
             stat err =       0.000456227775
             autocorr =       1.286294413105
              std dev =       0.568887678352
             le_variance =       0.323633190580

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321209722261
                                         uncertainty =       0.002054440854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321209722261
                                         uncertainty =       0.002054440854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400748076
  error estimate for blocks of size 2^( 2) =       0.000414138017
  error estimate for blocks of size 2^( 3) =       0.000428078690
  error estimate for blocks of size 2^( 4) =       0.000440679279
  error estimate for blocks of size 2^( 5) =       0.000451413821
  error estimate for blocks of size 2^( 6) =       0.000459897777
  error estimate for blocks of size 2^( 7) =       0.000467213808

      target function =                  N/A
              le_mean =     -16.906047940445
             les_mean =     286.155706022138
             stat err =       0.000454801171
             autocorr =       1.287953719233
              std dev =       0.566743363968
             le_variance =       0.321198040602


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906059658759        initial
     3.9062e-02     3.9062e-01             6.1610e-03       -16.906057699976
     1.5625e-01     1.5625e+00             2.3911e-03       -16.906082673543  <--
     6.2500e-01     6.2500e+00             7.4425e-04       -16.906047940445

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 3.0476e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
   uu_0                 3.093045e-01 1 1  ON 0
   uu_1                 1.424551e-01 1 1  ON 1
   uu_2                 4.147066e-02 1 1  ON 2
   uu_3                -1.954438e-02 1 1  ON 3
   uu_4                -6.364263e-02 1 1  ON 4
   uu_5                -9.701357e-02 1 1  ON 5
   uu_6                -1.232350e-01 1 1  ON 6
   uu_7                -1.354443e-01 1 1  ON 7
   uu_8                -1.265162e-01 1 1  ON 8
   uu_9                -9.555039e-02 1 1  ON 9
   ud_0                 4.413153e-01 1 1  ON 10
   ud_1                 1.762880e-01 1 1  ON 11
   ud_2                 5.727381e-02 1 1  ON 12
   ud_3                -1.218533e-02 1 1  ON 13
   ud_4                -6.700945e-02 1 1  ON 14
   ud_5                -1.067429e-01 1 1  ON 15
   ud_6                -1.322740e-01 1 1  ON 16
   ud_7                -1.473490e-01 1 1  ON 17
   ud_8                -1.474010e-01 1 1  ON 18
   ud_9                -1.360959e-01 1 1  ON 19
   eO_0                -7.392273e-01 1 1  ON 20
   eO_1                -4.217267e-01 1 1  ON 21
   eO_2                -1.667003e-02 1 1  ON 22
   eO_3                 2.879134e-01 1 1  ON 23
   eO_4                 5.038355e-01 1 1  ON 24
   eO_5                 4.626875e-01 1 1  ON 25
   eO_6                 2.383597e-01 1 1  ON 26
   eO_7                -5.391938e-02 1 1  ON 27
   eO_8                -2.016155e-01 1 1  ON 28
   eO_9                -6.203165e-02 1 1  ON 29
  eH1_0                -2.377684e-01 1 1  ON 30
  eH1_1                -1.347294e-01 1 1  ON 31
  eH1_2                -8.593706e-02 1 1  ON 32
  eH1_3                -3.271302e-02 1 1  ON 33
  eH1_4                 1.540096e-02 1 1  ON 34
  eH1_5                 4.776003e-02 1 1  ON 35
  eH1_6                 9.856992e-02 1 1  ON 36
  eH1_7                 1.421430e-01 1 1  ON 37
  eH1_8                 1.525388e-01 1 1  ON 38
  eH1_9                 3.914125e-02 1 1  ON 39
  eH2_0                -2.366217e-01 1 1  ON 40
  eH2_1                -1.332885e-01 1 1  ON 41
  eH2_2                -8.440264e-02 1 1  ON 42
  eH2_3                -3.058904e-02 1 1  ON 43
  eH2_4                 1.836284e-02 1 1  ON 44
  eH2_5                 5.093012e-02 1 1  ON 45
  eH2_6                 1.034494e-01 1 1  ON 46
  eH2_7                 1.498681e-01 1 1  ON 47
  eH2_8                 1.595162e-01 1 1  ON 48
  eH2_9                 2.087584e-02 1 1  ON 49
ci_0001                 7.011443e-01 3 1  ON 50
ci_0002                 7.002893e-01 3 1  ON 51
ci_0003                -2.785946e-02 3 1  ON 52
ci_0004                -2.711312e-02 3 1  ON 53
ci_0005                -3.681918e-02 3 1  ON 54
ci_0006                -3.727193e-02 3 1  ON 55
ci_0007                -2.344986e-02 3 1  ON 56
ci_0008                -2.302558e-02 3 1  ON 57
ci_0009                -1.755167e-02 3 1  ON 58
ci_0010                -1.758991e-02 3 1  ON 59
ci_0011                -1.209350e-02 3 1  ON 60
ci_0012                -1.223944e-02 3 1  ON 61
ci_0013                 1.316501e-02 3 1  ON 62
ci_0014                 1.337093e-02 3 1  ON 63
ci_0015                 1.299791e-02 3 1  ON 64
ci_0016                 1.256610e-02 3 1  ON 65
ci_0017                 1.116159e-02 3 1  ON 66
ci_0018                 1.164302e-02 3 1  ON 67
ci_0019                 1.188671e-02 3 1  ON 68
ci_0020                 1.095979e-02 3 1  ON 69
ci_0021                 1.190248e-03 3 1  ON 70
ci_0022                 1.082251e-03 3 1  ON 71
ci_0023                -1.136351e-02 3 1  ON 72
ci_0024                -1.079148e-02 3 1  ON 73
ci_0025                -1.094346e-02 3 1  ON 74
ci_0026                -1.120682e-02 3 1  ON 75
ci_0027                -1.095728e-02 3 1  ON 76
ci_0028                -1.096544e-02 3 1  ON 77
ci_0029                -1.058109e-02 3 1  ON 78
ci_0030                -1.046681e-02 3 1  ON 79
ci_0031                 1.981288e-02 3 1  ON 80
ci_0032                 2.121133e-02 3 1  ON 81
ci_0033                 9.510429e-03 3 1  ON 82
ci_0034                 1.067838e-02 3 1  ON 83
ci_0035                 7.572828e-03 3 1  ON 84
ci_0036                 7.205585e-03 3 1  ON 85
ci_0037                -9.534701e-03 3 1  ON 86
ci_0038                -1.221348e-02 3 1  ON 87
ci_0039                -2.697556e-03 3 1  ON 88
ci_0040                -2.798403e-03 3 1  ON 89
ci_0041                 6.686860e-03 3 1  ON 90
ci_0042                 7.465671e-03 3 1  ON 91
ci_0043                -1.801429e-02 3 1  ON 92
ci_0044                -1.794273e-02 3 1  ON 93
ci_0045                 8.557844e-03 3 1  ON 94
ci_0046                 7.892420e-03 3 1  ON 95
ci_0047                -2.432127e-03 3 1  ON 96
ci_0048                -1.719785e-03 3 1  ON 97
ci_0049                -5.815502e-03 3 1  ON 98
ci_0050                -5.396053e-03 3 1  ON 99
ci_0051                -3.602096e-03 3 1  ON 100
ci_0052                -3.303942e-03 3 1  ON 101
ci_0053                -4.859114e-03 3 1  ON 102
ci_0054                -5.133658e-03 3 1  ON 103
ci_0055                 7.886294e-03 3 1  ON 104
ci_0056                 6.376698e-03 3 1  ON 105
ci_0057                 5.321085e-03 3 1  ON 106
ci_0058                 5.333996e-03 3 1  ON 107
ci_0059                -4.805426e-03 3 1  ON 108
ci_0060                -5.027143e-03 3 1  ON 109
ci_0061                -4.232931e-03 3 1  ON 110
ci_0062                -3.880712e-03 3 1  ON 111
ci_0063                -8.396742e-03 3 1  ON 112
ci_0064                -8.857413e-03 3 1  ON 113
ci_0065                -5.304282e-03 3 1  ON 114
ci_0066                -5.119195e-03 3 1  ON 115
ci_0067                -4.842648e-03 3 1  ON 116
ci_0068                -5.359721e-03 3 1  ON 117
ci_0069                 4.615811e-03 3 1  ON 118
ci_0070                 4.473305e-03 3 1  ON 119
ci_0071                 1.002332e-03 3 1  ON 120
ci_0072                 1.027510e-03 3 1  ON 121
ci_0073                 4.574595e-03 3 1  ON 122
ci_0074                 4.641290e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8078e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6881e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8829
    reference variance = 0.31618
====================================================
  Execution time = 2.1319e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3041e-01
  Total weights = 1.951509021e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0787e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319921817149
                                         uncertainty =       0.002298557448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319921817149
                                         uncertainty =       0.002298557448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399909363
  error estimate for blocks of size 2^( 2) =       0.000412982961
  error estimate for blocks of size 2^( 3) =       0.000425691321
  error estimate for blocks of size 2^( 4) =       0.000438130027
  error estimate for blocks of size 2^( 5) =       0.000447092803
  error estimate for blocks of size 2^( 6) =       0.000455008811
  error estimate for blocks of size 2^( 7) =       0.000458215572

      target function =                  N/A
              le_mean =     -16.906696824173
             les_mean =     286.166806530503
             stat err =       0.000449611803
             autocorr =       1.264015101337
              std dev =       0.565557245267
             le_variance =       0.319854997674


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690669682417e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906696824166       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906732541947       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906730333616       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906728919019       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906736169554       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906737362584       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906736953713       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906737589086       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906741692941       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906735871490       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906734422905       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906737036432       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906738806303       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906738587488       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906740950082       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906742329374       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906742412659       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906742676133       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906742289177       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906742457789       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906742321803       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906742414810       residual = 9.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e-02 is 6.007193e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906696824166       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906720279092       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906718422593       residual = 7.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906716850147       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906719639843       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906721314064       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906720285537       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906720751805       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906721234406       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906719955298       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906720075403       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906720603197       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906720604838       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906720563956       residual = 9.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5625e-01 is 2.105726e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906696824166       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906706706937       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906706139865       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906705674875       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906706467613       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906706805942       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906706519210       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906706402675       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906706617644       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906706643388       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906706566677       residual = 8.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e-01 is 6.231037e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.280568 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7412e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
   uu_0                 3.101448e-01 1 1  ON 0
   uu_1                 1.429846e-01 1 1  ON 1
   uu_2                 4.180354e-02 1 1  ON 2
   uu_3                -1.967119e-02 1 1  ON 3
   uu_4                -6.380690e-02 1 1  ON 4
   uu_5                -9.768411e-02 1 1  ON 5
   uu_6                -1.239874e-01 1 1  ON 6
   uu_7                -1.360041e-01 1 1  ON 7
   uu_8                -1.273273e-01 1 1  ON 8
   uu_9                -9.583603e-02 1 1  ON 9
   ud_0                 4.422504e-01 1 1  ON 10
   ud_1                 1.769547e-01 1 1  ON 11
   ud_2                 5.755626e-02 1 1  ON 12
   ud_3                -1.202013e-02 1 1  ON 13
   ud_4                -6.708771e-02 1 1  ON 14
   ud_5                -1.070276e-01 1 1  ON 15
   ud_6                -1.328373e-01 1 1  ON 16
   ud_7                -1.480020e-01 1 1  ON 17
   ud_8                -1.477075e-01 1 1  ON 18
   ud_9                -1.361937e-01 1 1  ON 19
   eO_0                -7.405727e-01 1 1  ON 20
   eO_1                -4.225576e-01 1 1  ON 21
   eO_2                -1.653687e-02 1 1  ON 22
   eO_3                 2.882479e-01 1 1  ON 23
   eO_4                 5.056258e-01 1 1  ON 24
   eO_5                 4.639784e-01 1 1  ON 25
   eO_6                 2.384796e-01 1 1  ON 26
   eO_7                -5.364525e-02 1 1  ON 27
   eO_8                -2.024554e-01 1 1  ON 28
   eO_9                -6.278266e-02 1 1  ON 29
  eH1_0                -2.398741e-01 1 1  ON 30
  eH1_1                -1.353380e-01 1 1  ON 31
  eH1_2                -8.639750e-02 1 1  ON 32
  eH1_3                -3.278896e-02 1 1  ON 33
  eH1_4                 1.530912e-02 1 1  ON 34
  eH1_5                 4.693575e-02 1 1  ON 35
  eH1_6                 9.883999e-02 1 1  ON 36
  eH1_7                 1.431316e-01 1 1  ON 37
  eH1_8                 1.540568e-01 1 1  ON 38
  eH1_9                 4.042354e-02 1 1  ON 39
  eH2_0                -2.386227e-01 1 1  ON 40
  eH2_1                -1.335557e-01 1 1  ON 41
  eH2_2                -8.461779e-02 1 1  ON 42
  eH2_3                -3.050846e-02 1 1  ON 43
  eH2_4                 1.809931e-02 1 1  ON 44
  eH2_5                 5.119465e-02 1 1  ON 45
  eH2_6                 1.034955e-01 1 1  ON 46
  eH2_7                 1.500396e-01 1 1  ON 47
  eH2_8                 1.604825e-01 1 1  ON 48
  eH2_9                 2.216914e-02 1 1  ON 49
ci_0001                 7.009756e-01 3 1  ON 50
ci_0002                 7.004219e-01 3 1  ON 51
ci_0003                -2.777268e-02 3 1  ON 52
ci_0004                -2.788248e-02 3 1  ON 53
ci_0005                -3.706023e-02 3 1  ON 54
ci_0006                -3.670237e-02 3 1  ON 55
ci_0007                -2.382648e-02 3 1  ON 56
ci_0008                -2.289738e-02 3 1  ON 57
ci_0009                -1.756358e-02 3 1  ON 58
ci_0010                -1.788368e-02 3 1  ON 59
ci_0011                -1.160291e-02 3 1  ON 60
ci_0012                -1.213922e-02 3 1  ON 61
ci_0013                 1.366797e-02 3 1  ON 62
ci_0014                 1.305583e-02 3 1  ON 63
ci_0015                 1.328840e-02 3 1  ON 64
ci_0016                 1.329032e-02 3 1  ON 65
ci_0017                 1.142351e-02 3 1  ON 66
ci_0018                 1.077926e-02 3 1  ON 67
ci_0019                 1.184829e-02 3 1  ON 68
ci_0020                 1.136032e-02 3 1  ON 69
ci_0021                -7.718400e-05 3 1  ON 70
ci_0022                 1.239136e-04 3 1  ON 71
ci_0023                -1.098695e-02 3 1  ON 72
ci_0024                -1.104124e-02 3 1  ON 73
ci_0025                -1.085132e-02 3 1  ON 74
ci_0026                -1.126032e-02 3 1  ON 75
ci_0027                -1.120416e-02 3 1  ON 76
ci_0028                -1.128343e-02 3 1  ON 77
ci_0029                -1.053867e-02 3 1  ON 78
ci_0030                -1.002676e-02 3 1  ON 79
ci_0031                 2.023913e-02 3 1  ON 80
ci_0032                 2.145364e-02 3 1  ON 81
ci_0033                 1.014190e-02 3 1  ON 82
ci_0034                 1.060665e-02 3 1  ON 83
ci_0035                 7.613020e-03 3 1  ON 84
ci_0036                 6.608489e-03 3 1  ON 85
ci_0037                -1.005357e-02 3 1  ON 86
ci_0038                -1.153068e-02 3 1  ON 87
ci_0039                -2.854437e-03 3 1  ON 88
ci_0040                -2.668967e-03 3 1  ON 89
ci_0041                 6.674458e-03 3 1  ON 90
ci_0042                 7.295414e-03 3 1  ON 91
ci_0043                -1.833717e-02 3 1  ON 92
ci_0044                -1.860340e-02 3 1  ON 93
ci_0045                 7.706987e-03 3 1  ON 94
ci_0046                 7.974093e-03 3 1  ON 95
ci_0047                -2.097278e-03 3 1  ON 96
ci_0048                -1.658788e-03 3 1  ON 97
ci_0049                -5.819988e-03 3 1  ON 98
ci_0050                -5.133218e-03 3 1  ON 99
ci_0051                -3.925006e-03 3 1  ON 100
ci_0052                -3.593548e-03 3 1  ON 101
ci_0053                -4.767442e-03 3 1  ON 102
ci_0054                -4.970534e-03 3 1  ON 103
ci_0055                 7.319735e-03 3 1  ON 104
ci_0056                 6.350032e-03 3 1  ON 105
ci_0057                 5.174639e-03 3 1  ON 106
ci_0058                 4.962116e-03 3 1  ON 107
ci_0059                -4.704529e-03 3 1  ON 108
ci_0060                -4.370837e-03 3 1  ON 109
ci_0061                -4.327332e-03 3 1  ON 110
ci_0062                -3.660189e-03 3 1  ON 111
ci_0063                -8.768734e-03 3 1  ON 112
ci_0064                -8.781070e-03 3 1  ON 113
ci_0065                -5.371287e-03 3 1  ON 114
ci_0066                -4.986205e-03 3 1  ON 115
ci_0067                -4.788618e-03 3 1  ON 116
ci_0068                -5.172965e-03 3 1  ON 117
ci_0069                 4.374792e-03 3 1  ON 118
ci_0070                 4.088102e-03 3 1  ON 119
ci_0071                 1.060888e-03 3 1  ON 120
ci_0072                 1.123498e-03 3 1  ON 121
ci_0073                 4.745586e-03 3 1  ON 122
ci_0074                 4.529905e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8633
    reference variance = 0.23945
====================================================
  Execution time = 2.0896e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4034e-01
  Total weights = 1.9520e+06
  Execution time = 1.8937e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323730374907
                                         uncertainty =       0.002326748937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323730374907
                                         uncertainty =       0.002326748937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402257901
  error estimate for blocks of size 2^( 2) =       0.000415159794
  error estimate for blocks of size 2^( 3) =       0.000429118907
  error estimate for blocks of size 2^( 4) =       0.000441375658
  error estimate for blocks of size 2^( 5) =       0.000453091732
  error estimate for blocks of size 2^( 6) =       0.000461633810
  error estimate for blocks of size 2^( 7) =       0.000467596620

      target function =                  N/A
              le_mean =     -16.905614467391
             les_mean =     286.141321540325
             stat err =       0.000455924455
             autocorr =       1.284625708220
              std dev =       0.568878579136
             le_variance =       0.323622837800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324521957373
                                         uncertainty =       0.002282330431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324521957373
                                         uncertainty =       0.002282330431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402749218
  error estimate for blocks of size 2^( 2) =       0.000415597778
  error estimate for blocks of size 2^( 3) =       0.000429502957
  error estimate for blocks of size 2^( 4) =       0.000441669932
  error estimate for blocks of size 2^( 5) =       0.000453333425
  error estimate for blocks of size 2^( 6) =       0.000461845005
  error estimate for blocks of size 2^( 7) =       0.000467784242

      target function =                  N/A
              le_mean =     -16.905595190801
             les_mean =     286.140678432201
             stat err =       0.000456158151
             autocorr =       1.282807433336
              std dev =       0.569573406309
             le_variance =       0.324413865175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324469593201
                                         uncertainty =       0.002272120558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324469593201
                                         uncertainty =       0.002272120558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402716490
  error estimate for blocks of size 2^( 2) =       0.000415557089
  error estimate for blocks of size 2^( 3) =       0.000429466990
  error estimate for blocks of size 2^( 4) =       0.000441647973
  error estimate for blocks of size 2^( 5) =       0.000453316501
  error estimate for blocks of size 2^( 6) =       0.000461825231
  error estimate for blocks of size 2^( 7) =       0.000467748888

      target function =                  N/A
              le_mean =     -16.905603617442
             les_mean =     286.141222385841
             stat err =       0.000456134648
             autocorr =       1.282883738118
              std dev =       0.569527121666
             le_variance =       0.324361142313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323770639833
                                         uncertainty =       0.002312713532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323770639833
                                         uncertainty =       0.002312713532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402282826
  error estimate for blocks of size 2^( 2) =       0.000415171251
  error estimate for blocks of size 2^( 3) =       0.000429120706
  error estimate for blocks of size 2^( 4) =       0.000441363788
  error estimate for blocks of size 2^( 5) =       0.000453069785
  error estimate for blocks of size 2^( 6) =       0.000461608670
  error estimate for blocks of size 2^( 7) =       0.000467559112

      target function =                  N/A
              le_mean =     -16.905598222796
             les_mean =     286.144213112622
             stat err =       0.000455900339
             autocorr =       1.284330645928
              std dev =       0.568913828202
             le_variance =       0.323662943919


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905614467391        initial  <--
     3.9062e-02     3.9062e-01             6.0072e-03       -16.905595190801
     1.5625e-01     1.5625e+00             2.1057e-03       -16.905603617442
     6.2500e-01     6.2500e+00             6.2310e-04       -16.905598222796

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4572
  </log>
  <optVariables href="H2O.s008.opt.xml">
   uu_0                 3.093045e-01 1 1  ON 0
   uu_1                 1.424551e-01 1 1  ON 1
   uu_2                 4.147066e-02 1 1  ON 2
   uu_3                -1.954438e-02 1 1  ON 3
   uu_4                -6.364263e-02 1 1  ON 4
   uu_5                -9.701357e-02 1 1  ON 5
   uu_6                -1.232350e-01 1 1  ON 6
   uu_7                -1.354443e-01 1 1  ON 7
   uu_8                -1.265162e-01 1 1  ON 8
   uu_9                -9.555039e-02 1 1  ON 9
   ud_0                 4.413153e-01 1 1  ON 10
   ud_1                 1.762880e-01 1 1  ON 11
   ud_2                 5.727381e-02 1 1  ON 12
   ud_3                -1.218533e-02 1 1  ON 13
   ud_4                -6.700945e-02 1 1  ON 14
   ud_5                -1.067429e-01 1 1  ON 15
   ud_6                -1.322740e-01 1 1  ON 16
   ud_7                -1.473490e-01 1 1  ON 17
   ud_8                -1.474010e-01 1 1  ON 18
   ud_9                -1.360959e-01 1 1  ON 19
   eO_0                -7.392273e-01 1 1  ON 20
   eO_1                -4.217267e-01 1 1  ON 21
   eO_2                -1.667003e-02 1 1  ON 22
   eO_3                 2.879134e-01 1 1  ON 23
   eO_4                 5.038355e-01 1 1  ON 24
   eO_5                 4.626875e-01 1 1  ON 25
   eO_6                 2.383597e-01 1 1  ON 26
   eO_7                -5.391938e-02 1 1  ON 27
   eO_8                -2.016155e-01 1 1  ON 28
   eO_9                -6.203165e-02 1 1  ON 29
  eH1_0                -2.377684e-01 1 1  ON 30
  eH1_1                -1.347294e-01 1 1  ON 31
  eH1_2                -8.593706e-02 1 1  ON 32
  eH1_3                -3.271302e-02 1 1  ON 33
  eH1_4                 1.540096e-02 1 1  ON 34
  eH1_5                 4.776003e-02 1 1  ON 35
  eH1_6                 9.856992e-02 1 1  ON 36
  eH1_7                 1.421430e-01 1 1  ON 37
  eH1_8                 1.525388e-01 1 1  ON 38
  eH1_9                 3.914125e-02 1 1  ON 39
  eH2_0                -2.366217e-01 1 1  ON 40
  eH2_1                -1.332885e-01 1 1  ON 41
  eH2_2                -8.440264e-02 1 1  ON 42
  eH2_3                -3.058904e-02 1 1  ON 43
  eH2_4                 1.836284e-02 1 1  ON 44
  eH2_5                 5.093012e-02 1 1  ON 45
  eH2_6                 1.034494e-01 1 1  ON 46
  eH2_7                 1.498681e-01 1 1  ON 47
  eH2_8                 1.595162e-01 1 1  ON 48
  eH2_9                 2.087584e-02 1 1  ON 49
ci_0001                 7.011443e-01 3 1  ON 50
ci_0002                 7.002893e-01 3 1  ON 51
ci_0003                -2.785946e-02 3 1  ON 52
ci_0004                -2.711312e-02 3 1  ON 53
ci_0005                -3.681918e-02 3 1  ON 54
ci_0006                -3.727193e-02 3 1  ON 55
ci_0007                -2.344986e-02 3 1  ON 56
ci_0008                -2.302558e-02 3 1  ON 57
ci_0009                -1.755167e-02 3 1  ON 58
ci_0010                -1.758991e-02 3 1  ON 59
ci_0011                -1.209350e-02 3 1  ON 60
ci_0012                -1.223944e-02 3 1  ON 61
ci_0013                 1.316501e-02 3 1  ON 62
ci_0014                 1.337093e-02 3 1  ON 63
ci_0015                 1.299791e-02 3 1  ON 64
ci_0016                 1.256610e-02 3 1  ON 65
ci_0017                 1.116159e-02 3 1  ON 66
ci_0018                 1.164302e-02 3 1  ON 67
ci_0019                 1.188671e-02 3 1  ON 68
ci_0020                 1.095979e-02 3 1  ON 69
ci_0021                 1.190248e-03 3 1  ON 70
ci_0022                 1.082251e-03 3 1  ON 71
ci_0023                -1.136351e-02 3 1  ON 72
ci_0024                -1.079148e-02 3 1  ON 73
ci_0025                -1.094346e-02 3 1  ON 74
ci_0026                -1.120682e-02 3 1  ON 75
ci_0027                -1.095728e-02 3 1  ON 76
ci_0028                -1.096544e-02 3 1  ON 77
ci_0029                -1.058109e-02 3 1  ON 78
ci_0030                -1.046681e-02 3 1  ON 79
ci_0031                 1.981288e-02 3 1  ON 80
ci_0032                 2.121133e-02 3 1  ON 81
ci_0033                 9.510429e-03 3 1  ON 82
ci_0034                 1.067838e-02 3 1  ON 83
ci_0035                 7.572828e-03 3 1  ON 84
ci_0036                 7.205585e-03 3 1  ON 85
ci_0037                -9.534701e-03 3 1  ON 86
ci_0038                -1.221348e-02 3 1  ON 87
ci_0039                -2.697556e-03 3 1  ON 88
ci_0040                -2.798403e-03 3 1  ON 89
ci_0041                 6.686860e-03 3 1  ON 90
ci_0042                 7.465671e-03 3 1  ON 91
ci_0043                -1.801429e-02 3 1  ON 92
ci_0044                -1.794273e-02 3 1  ON 93
ci_0045                 8.557844e-03 3 1  ON 94
ci_0046                 7.892420e-03 3 1  ON 95
ci_0047                -2.432127e-03 3 1  ON 96
ci_0048                -1.719785e-03 3 1  ON 97
ci_0049                -5.815502e-03 3 1  ON 98
ci_0050                -5.396053e-03 3 1  ON 99
ci_0051                -3.602096e-03 3 1  ON 100
ci_0052                -3.303942e-03 3 1  ON 101
ci_0053                -4.859114e-03 3 1  ON 102
ci_0054                -5.133658e-03 3 1  ON 103
ci_0055                 7.886294e-03 3 1  ON 104
ci_0056                 6.376698e-03 3 1  ON 105
ci_0057                 5.321085e-03 3 1  ON 106
ci_0058                 5.333996e-03 3 1  ON 107
ci_0059                -4.805426e-03 3 1  ON 108
ci_0060                -5.027143e-03 3 1  ON 109
ci_0061                -4.232931e-03 3 1  ON 110
ci_0062                -3.880712e-03 3 1  ON 111
ci_0063                -8.396742e-03 3 1  ON 112
ci_0064                -8.857413e-03 3 1  ON 113
ci_0065                -5.304282e-03 3 1  ON 114
ci_0066                -5.119195e-03 3 1  ON 115
ci_0067                -4.842648e-03 3 1  ON 116
ci_0068                -5.359721e-03 3 1  ON 117
ci_0069                 4.615811e-03 3 1  ON 118
ci_0070                 4.473305e-03 3 1  ON 119
ci_0071                 1.002332e-03 3 1  ON 120
ci_0072                 1.027510e-03 3 1  ON 121
ci_0073                 4.574595e-03 3 1  ON 122
ci_0074                 4.641290e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7885e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6880e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8795
    reference variance = 0.203539
====================================================
  Execution time = 2.1366e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3586e-01
  Total weights = 1.951622353e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1674e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321713040385
                                         uncertainty =       0.002828611055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321713040385
                                         uncertainty =       0.002828611055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401038401
  error estimate for blocks of size 2^( 2) =       0.000413927234
  error estimate for blocks of size 2^( 3) =       0.000427407972
  error estimate for blocks of size 2^( 4) =       0.000439915963
  error estimate for blocks of size 2^( 5) =       0.000451385563
  error estimate for blocks of size 2^( 6) =       0.000460197479
  error estimate for blocks of size 2^( 7) =       0.000466327154

      target function =                  N/A
              le_mean =     -16.905594654247
             les_mean =     286.134991118634
             stat err =       0.000454456540
             autocorr =       1.284141242190
              std dev =       0.567153945865
             le_variance =       0.321663598310


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690559465425e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905594654234       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905603456948       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905604058498       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905604125929       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905605441048       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905606026595       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905605482279       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905605557339       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905605875699       residual = 7.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905605854591       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905605906219       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905605979050       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e-01 is 8.785829e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905594654234       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905597587935       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905597773280       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905597712085       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905598010733       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905598281405       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905598083314       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905598103348       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905598158496       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905598185230       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5625e+00 is 2.569126e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905594654234       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905595454280       residual = 4.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905595504907       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905595485120       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905595551553       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905595629966       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905595579685       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905595582620       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905595589138       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905595601906       residual = 6.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e+00 is 6.787293e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.284963 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7542e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
   uu_0                 3.093586e-01 1 1  ON 0
   uu_1                 1.424955e-01 1 1  ON 1
   uu_2                 4.148419e-02 1 1  ON 2
   uu_3                -1.956632e-02 1 1  ON 3
   uu_4                -6.367173e-02 1 1  ON 4
   uu_5                -9.710548e-02 1 1  ON 5
   uu_6                -1.232031e-01 1 1  ON 6
   uu_7                -1.354410e-01 1 1  ON 7
   uu_8                -1.266081e-01 1 1  ON 8
   uu_9                -9.560485e-02 1 1  ON 9
   ud_0                 4.414197e-01 1 1  ON 10
   ud_1                 1.764062e-01 1 1  ON 11
   ud_2                 5.729976e-02 1 1  ON 12
   ud_3                -1.214568e-02 1 1  ON 13
   ud_4                -6.702988e-02 1 1  ON 14
   ud_5                -1.067334e-01 1 1  ON 15
   ud_6                -1.323607e-01 1 1  ON 16
   ud_7                -1.473834e-01 1 1  ON 17
   ud_8                -1.474391e-01 1 1  ON 18
   ud_9                -1.361896e-01 1 1  ON 19
   eO_0                -7.394843e-01 1 1  ON 20
   eO_1                -4.218057e-01 1 1  ON 21
   eO_2                -1.664919e-02 1 1  ON 22
   eO_3                 2.880035e-01 1 1  ON 23
   eO_4                 5.040121e-01 1 1  ON 24
   eO_5                 4.627898e-01 1 1  ON 25
   eO_6                 2.384650e-01 1 1  ON 26
   eO_7                -5.384101e-02 1 1  ON 27
   eO_8                -2.017453e-01 1 1  ON 28
   eO_9                -6.213137e-02 1 1  ON 29
  eH1_0                -2.379797e-01 1 1  ON 30
  eH1_1                -1.347914e-01 1 1  ON 31
  eH1_2                -8.603540e-02 1 1  ON 32
  eH1_3                -3.275160e-02 1 1  ON 33
  eH1_4                 1.534264e-02 1 1  ON 34
  eH1_5                 4.781886e-02 1 1  ON 35
  eH1_6                 9.868407e-02 1 1  ON 36
  eH1_7                 1.422172e-01 1 1  ON 37
  eH1_8                 1.526789e-01 1 1  ON 38
  eH1_9                 3.923098e-02 1 1  ON 39
  eH2_0                -2.367605e-01 1 1  ON 40
  eH2_1                -1.333504e-01 1 1  ON 41
  eH2_2                -8.441197e-02 1 1  ON 42
  eH2_3                -3.064746e-02 1 1  ON 43
  eH2_4                 1.833124e-02 1 1  ON 44
  eH2_5                 5.093761e-02 1 1  ON 45
  eH2_6                 1.034319e-01 1 1  ON 46
  eH2_7                 1.499046e-01 1 1  ON 47
  eH2_8                 1.596390e-01 1 1  ON 48
  eH2_9                 2.102371e-02 1 1  ON 49
ci_0001                 7.012318e-01 3 1  ON 50
ci_0002                 7.002101e-01 3 1  ON 51
ci_0003                -2.789589e-02 3 1  ON 52
ci_0004                -2.719444e-02 3 1  ON 53
ci_0005                -3.685026e-02 3 1  ON 54
ci_0006                -3.737028e-02 3 1  ON 55
ci_0007                -2.320749e-02 3 1  ON 56
ci_0008                -2.300650e-02 3 1  ON 57
ci_0009                -1.745098e-02 3 1  ON 58
ci_0010                -1.759384e-02 3 1  ON 59
ci_0011                -1.207662e-02 3 1  ON 60
ci_0012                -1.221774e-02 3 1  ON 61
ci_0013                 1.312509e-02 3 1  ON 62
ci_0014                 1.331986e-02 3 1  ON 63
ci_0015                 1.305324e-02 3 1  ON 64
ci_0016                 1.268658e-02 3 1  ON 65
ci_0017                 1.115081e-02 3 1  ON 66
ci_0018                 1.167198e-02 3 1  ON 67
ci_0019                 1.178199e-02 3 1  ON 68
ci_0020                 1.112953e-02 3 1  ON 69
ci_0021                 1.090583e-03 3 1  ON 70
ci_0022                 9.947400e-04 3 1  ON 71
ci_0023                -1.139519e-02 3 1  ON 72
ci_0024                -1.087640e-02 3 1  ON 73
ci_0025                -1.077846e-02 3 1  ON 74
ci_0026                -1.118432e-02 3 1  ON 75
ci_0027                -1.087775e-02 3 1  ON 76
ci_0028                -1.109627e-02 3 1  ON 77
ci_0029                -1.053242e-02 3 1  ON 78
ci_0030                -1.046051e-02 3 1  ON 79
ci_0031                 1.979787e-02 3 1  ON 80
ci_0032                 2.111084e-02 3 1  ON 81
ci_0033                 9.692076e-03 3 1  ON 82
ci_0034                 1.061141e-02 3 1  ON 83
ci_0035                 7.602247e-03 3 1  ON 84
ci_0036                 7.217946e-03 3 1  ON 85
ci_0037                -9.497832e-03 3 1  ON 86
ci_0038                -1.220500e-02 3 1  ON 87
ci_0039                -2.699053e-03 3 1  ON 88
ci_0040                -2.744227e-03 3 1  ON 89
ci_0041                 6.724591e-03 3 1  ON 90
ci_0042                 7.402633e-03 3 1  ON 91
ci_0043                -1.806362e-02 3 1  ON 92
ci_0044                -1.797234e-02 3 1  ON 93
ci_0045                 8.496991e-03 3 1  ON 94
ci_0046                 7.883035e-03 3 1  ON 95
ci_0047                -2.314307e-03 3 1  ON 96
ci_0048                -1.678208e-03 3 1  ON 97
ci_0049                -5.950147e-03 3 1  ON 98
ci_0050                -5.347333e-03 3 1  ON 99
ci_0051                -3.549634e-03 3 1  ON 100
ci_0052                -3.244959e-03 3 1  ON 101
ci_0053                -4.911866e-03 3 1  ON 102
ci_0054                -5.145628e-03 3 1  ON 103
ci_0055                 7.636697e-03 3 1  ON 104
ci_0056                 6.378018e-03 3 1  ON 105
ci_0057                 5.215760e-03 3 1  ON 106
ci_0058                 5.373901e-03 3 1  ON 107
ci_0059                -4.807644e-03 3 1  ON 108
ci_0060                -4.999498e-03 3 1  ON 109
ci_0061                -4.187164e-03 3 1  ON 110
ci_0062                -3.814880e-03 3 1  ON 111
ci_0063                -8.258355e-03 3 1  ON 112
ci_0064                -8.911803e-03 3 1  ON 113
ci_0065                -5.232331e-03 3 1  ON 114
ci_0066                -5.184928e-03 3 1  ON 115
ci_0067                -4.800632e-03 3 1  ON 116
ci_0068                -5.254333e-03 3 1  ON 117
ci_0069                 4.485853e-03 3 1  ON 118
ci_0070                 4.392880e-03 3 1  ON 119
ci_0071                 1.014634e-03 3 1  ON 120
ci_0072                 8.942489e-04 3 1  ON 121
ci_0073                 4.556063e-03 3 1  ON 122
ci_0074                 4.646335e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9468
    reference variance = 0.215429
====================================================
  Execution time = 2.0848e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3038e-01
  Total weights = 1.9516e+06
  Execution time = 1.8926e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318906955488
                                         uncertainty =       0.001919786837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318906955488
                                         uncertainty =       0.001919786837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399270628
  error estimate for blocks of size 2^( 2) =       0.000411581332
  error estimate for blocks of size 2^( 3) =       0.000425239547
  error estimate for blocks of size 2^( 4) =       0.000437697039
  error estimate for blocks of size 2^( 5) =       0.000447140165
  error estimate for blocks of size 2^( 6) =       0.000453825908
  error estimate for blocks of size 2^( 7) =       0.000459683221

      target function =                  N/A
              le_mean =     -16.905706521359
             les_mean =     286.133535786402
             stat err =       0.000449586583
             autocorr =       1.267920309252
              std dev =       0.564653937711
             le_variance =       0.318834069373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318888910669
                                         uncertainty =       0.001899656010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318888910669
                                         uncertainty =       0.001899656010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399258902
  error estimate for blocks of size 2^( 2) =       0.000411569484
  error estimate for blocks of size 2^( 3) =       0.000425215383
  error estimate for blocks of size 2^( 4) =       0.000437671959
  error estimate for blocks of size 2^( 5) =       0.000447085556
  error estimate for blocks of size 2^( 6) =       0.000453773232
  error estimate for blocks of size 2^( 7) =       0.000459566465

      target function =                  N/A
              le_mean =     -16.905704879229
             les_mean =     286.159391804320
             stat err =       0.000449524303
             autocorr =       1.267643505471
              std dev =       0.564637354371
             le_variance =       0.318815341951

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318793815238
                                         uncertainty =       0.001906393681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318793815238
                                         uncertainty =       0.001906393681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399199649
  error estimate for blocks of size 2^( 2) =       0.000411513470
  error estimate for blocks of size 2^( 3) =       0.000425165482
  error estimate for blocks of size 2^( 4) =       0.000437623768
  error estimate for blocks of size 2^( 5) =       0.000447051848
  error estimate for blocks of size 2^( 6) =       0.000453738034
  error estimate for blocks of size 2^( 7) =       0.000459594361

      target function =                  N/A
              le_mean =     -16.905706755287
             les_mean =     286.134252324655
             stat err =       0.000449502003
             autocorr =       1.267894042925
              std dev =       0.564553557236
             le_variance =       0.318720718988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318883195271
                                         uncertainty =       0.001917906441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318883195271
                                         uncertainty =       0.001917906441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399255741
  error estimate for blocks of size 2^( 2) =       0.000411567021
  error estimate for blocks of size 2^( 3) =       0.000425224538
  error estimate for blocks of size 2^( 4) =       0.000437682380
  error estimate for blocks of size 2^( 5) =       0.000447123703
  error estimate for blocks of size 2^( 6) =       0.000453809390
  error estimate for blocks of size 2^( 7) =       0.000459666870

      target function =                  N/A
              le_mean =     -16.905706093647
             les_mean =     286.133526438487
             stat err =       0.000449570586
             autocorr =       1.267924629000
              std dev =       0.564632883566
             le_variance =       0.318810293204


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905706521359        initial
     3.9062e-01     3.9062e+00             8.7858e-04       -16.905704879229
     1.5625e+00     1.5625e+01             2.5691e-04       -16.905706755287  <--
     6.2500e+00     6.2500e+01             6.7873e-05       -16.905706093647

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 3.0407e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
   uu_0                 3.093586e-01 1 1  ON 0
   uu_1                 1.424955e-01 1 1  ON 1
   uu_2                 4.148419e-02 1 1  ON 2
   uu_3                -1.956632e-02 1 1  ON 3
   uu_4                -6.367173e-02 1 1  ON 4
   uu_5                -9.710548e-02 1 1  ON 5
   uu_6                -1.232031e-01 1 1  ON 6
   uu_7                -1.354410e-01 1 1  ON 7
   uu_8                -1.266081e-01 1 1  ON 8
   uu_9                -9.560485e-02 1 1  ON 9
   ud_0                 4.414197e-01 1 1  ON 10
   ud_1                 1.764062e-01 1 1  ON 11
   ud_2                 5.729976e-02 1 1  ON 12
   ud_3                -1.214568e-02 1 1  ON 13
   ud_4                -6.702988e-02 1 1  ON 14
   ud_5                -1.067334e-01 1 1  ON 15
   ud_6                -1.323607e-01 1 1  ON 16
   ud_7                -1.473834e-01 1 1  ON 17
   ud_8                -1.474391e-01 1 1  ON 18
   ud_9                -1.361896e-01 1 1  ON 19
   eO_0                -7.394843e-01 1 1  ON 20
   eO_1                -4.218057e-01 1 1  ON 21
   eO_2                -1.664919e-02 1 1  ON 22
   eO_3                 2.880035e-01 1 1  ON 23
   eO_4                 5.040121e-01 1 1  ON 24
   eO_5                 4.627898e-01 1 1  ON 25
   eO_6                 2.384650e-01 1 1  ON 26
   eO_7                -5.384101e-02 1 1  ON 27
   eO_8                -2.017453e-01 1 1  ON 28
   eO_9                -6.213137e-02 1 1  ON 29
  eH1_0                -2.379797e-01 1 1  ON 30
  eH1_1                -1.347914e-01 1 1  ON 31
  eH1_2                -8.603540e-02 1 1  ON 32
  eH1_3                -3.275160e-02 1 1  ON 33
  eH1_4                 1.534264e-02 1 1  ON 34
  eH1_5                 4.781886e-02 1 1  ON 35
  eH1_6                 9.868407e-02 1 1  ON 36
  eH1_7                 1.422172e-01 1 1  ON 37
  eH1_8                 1.526789e-01 1 1  ON 38
  eH1_9                 3.923098e-02 1 1  ON 39
  eH2_0                -2.367605e-01 1 1  ON 40
  eH2_1                -1.333504e-01 1 1  ON 41
  eH2_2                -8.441197e-02 1 1  ON 42
  eH2_3                -3.064746e-02 1 1  ON 43
  eH2_4                 1.833124e-02 1 1  ON 44
  eH2_5                 5.093761e-02 1 1  ON 45
  eH2_6                 1.034319e-01 1 1  ON 46
  eH2_7                 1.499046e-01 1 1  ON 47
  eH2_8                 1.596390e-01 1 1  ON 48
  eH2_9                 2.102371e-02 1 1  ON 49
ci_0001                 7.012318e-01 3 1  ON 50
ci_0002                 7.002101e-01 3 1  ON 51
ci_0003                -2.789589e-02 3 1  ON 52
ci_0004                -2.719444e-02 3 1  ON 53
ci_0005                -3.685026e-02 3 1  ON 54
ci_0006                -3.737028e-02 3 1  ON 55
ci_0007                -2.320749e-02 3 1  ON 56
ci_0008                -2.300650e-02 3 1  ON 57
ci_0009                -1.745098e-02 3 1  ON 58
ci_0010                -1.759384e-02 3 1  ON 59
ci_0011                -1.207662e-02 3 1  ON 60
ci_0012                -1.221774e-02 3 1  ON 61
ci_0013                 1.312509e-02 3 1  ON 62
ci_0014                 1.331986e-02 3 1  ON 63
ci_0015                 1.305324e-02 3 1  ON 64
ci_0016                 1.268658e-02 3 1  ON 65
ci_0017                 1.115081e-02 3 1  ON 66
ci_0018                 1.167198e-02 3 1  ON 67
ci_0019                 1.178199e-02 3 1  ON 68
ci_0020                 1.112953e-02 3 1  ON 69
ci_0021                 1.090583e-03 3 1  ON 70
ci_0022                 9.947400e-04 3 1  ON 71
ci_0023                -1.139519e-02 3 1  ON 72
ci_0024                -1.087640e-02 3 1  ON 73
ci_0025                -1.077846e-02 3 1  ON 74
ci_0026                -1.118432e-02 3 1  ON 75
ci_0027                -1.087775e-02 3 1  ON 76
ci_0028                -1.109627e-02 3 1  ON 77
ci_0029                -1.053242e-02 3 1  ON 78
ci_0030                -1.046051e-02 3 1  ON 79
ci_0031                 1.979787e-02 3 1  ON 80
ci_0032                 2.111084e-02 3 1  ON 81
ci_0033                 9.692076e-03 3 1  ON 82
ci_0034                 1.061141e-02 3 1  ON 83
ci_0035                 7.602247e-03 3 1  ON 84
ci_0036                 7.217946e-03 3 1  ON 85
ci_0037                -9.497832e-03 3 1  ON 86
ci_0038                -1.220500e-02 3 1  ON 87
ci_0039                -2.699053e-03 3 1  ON 88
ci_0040                -2.744227e-03 3 1  ON 89
ci_0041                 6.724591e-03 3 1  ON 90
ci_0042                 7.402633e-03 3 1  ON 91
ci_0043                -1.806362e-02 3 1  ON 92
ci_0044                -1.797234e-02 3 1  ON 93
ci_0045                 8.496991e-03 3 1  ON 94
ci_0046                 7.883035e-03 3 1  ON 95
ci_0047                -2.314307e-03 3 1  ON 96
ci_0048                -1.678208e-03 3 1  ON 97
ci_0049                -5.950147e-03 3 1  ON 98
ci_0050                -5.347333e-03 3 1  ON 99
ci_0051                -3.549634e-03 3 1  ON 100
ci_0052                -3.244959e-03 3 1  ON 101
ci_0053                -4.911866e-03 3 1  ON 102
ci_0054                -5.145628e-03 3 1  ON 103
ci_0055                 7.636697e-03 3 1  ON 104
ci_0056                 6.378018e-03 3 1  ON 105
ci_0057                 5.215760e-03 3 1  ON 106
ci_0058                 5.373901e-03 3 1  ON 107
ci_0059                -4.807644e-03 3 1  ON 108
ci_0060                -4.999498e-03 3 1  ON 109
ci_0061                -4.187164e-03 3 1  ON 110
ci_0062                -3.814880e-03 3 1  ON 111
ci_0063                -8.258355e-03 3 1  ON 112
ci_0064                -8.911803e-03 3 1  ON 113
ci_0065                -5.232331e-03 3 1  ON 114
ci_0066                -5.184928e-03 3 1  ON 115
ci_0067                -4.800632e-03 3 1  ON 116
ci_0068                -5.254333e-03 3 1  ON 117
ci_0069                 4.485853e-03 3 1  ON 118
ci_0070                 4.392880e-03 3 1  ON 119
ci_0071                 1.014634e-03 3 1  ON 120
ci_0072                 8.942489e-04 3 1  ON 121
ci_0073                 4.556063e-03 3 1  ON 122
ci_0074                 4.646335e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7957e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6883e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9069
    reference variance = 0.22596
====================================================
  Execution time = 2.1325e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3487e-01
  Total weights = 1.951429188e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1045e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322564718235
                                         uncertainty =       0.002374659925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322564718235
                                         uncertainty =       0.002374659925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401610398
  error estimate for blocks of size 2^( 2) =       0.000414716043
  error estimate for blocks of size 2^( 3) =       0.000428017760
  error estimate for blocks of size 2^( 4) =       0.000440542261
  error estimate for blocks of size 2^( 5) =       0.000452492887
  error estimate for blocks of size 2^( 6) =       0.000461021756
  error estimate for blocks of size 2^( 7) =       0.000465633271

      target function =                  N/A
              le_mean =     -16.906770147727
             les_mean =     286.173743934752
             stat err =       0.000454922543
             autocorr =       1.283113341446
              std dev =       0.567962871314
             le_variance =       0.322581823192


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690677014773e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906770147706       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906779720339       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906782197488       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906783939262       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906785860056       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906786300805       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906787347426       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906787142638       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906786969155       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906786608127       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906786716849       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906786629541       residual = 5.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e-01 is 9.352261e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906770147706       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906773338539       residual = 8.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906774198490       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906774611587       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906775387119       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906775632762       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906775727547       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906775630764       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906775640853       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906775603586       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5625e+00 is 2.541914e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906770147706       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906771017929       residual = 8.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906771258089       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906771357579       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906771580144       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906771669805       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906771679949       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906771649590       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906771653374       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906771649763       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e+00 is 6.660331e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.289390 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7438e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
   uu_0                 3.094205e-01 1 1  ON 0
   uu_1                 1.426085e-01 1 1  ON 1
   uu_2                 4.154366e-02 1 1  ON 2
   uu_3                -1.961656e-02 1 1  ON 3
   uu_4                -6.370694e-02 1 1  ON 4
   uu_5                -9.714362e-02 1 1  ON 5
   uu_6                -1.232731e-01 1 1  ON 6
   uu_7                -1.355085e-01 1 1  ON 7
   uu_8                -1.266649e-01 1 1  ON 8
   uu_9                -9.566047e-02 1 1  ON 9
   ud_0                 4.414477e-01 1 1  ON 10
   ud_1                 1.764512e-01 1 1  ON 11
   ud_2                 5.732836e-02 1 1  ON 12
   ud_3                -1.208255e-02 1 1  ON 13
   ud_4                -6.705231e-02 1 1  ON 14
   ud_5                -1.067251e-01 1 1  ON 15
   ud_6                -1.323831e-01 1 1  ON 16
   ud_7                -1.474158e-01 1 1  ON 17
   ud_8                -1.475136e-01 1 1  ON 18
   ud_9                -1.361953e-01 1 1  ON 19
   eO_0                -7.397338e-01 1 1  ON 20
   eO_1                -4.219016e-01 1 1  ON 21
   eO_2                -1.664000e-02 1 1  ON 22
   eO_3                 2.880516e-01 1 1  ON 23
   eO_4                 5.042663e-01 1 1  ON 24
   eO_5                 4.628968e-01 1 1  ON 25
   eO_6                 2.385196e-01 1 1  ON 26
   eO_7                -5.378591e-02 1 1  ON 27
   eO_8                -2.018433e-01 1 1  ON 28
   eO_9                -6.220824e-02 1 1  ON 29
  eH1_0                -2.382101e-01 1 1  ON 30
  eH1_1                -1.348713e-01 1 1  ON 31
  eH1_2                -8.613884e-02 1 1  ON 32
  eH1_3                -3.277277e-02 1 1  ON 33
  eH1_4                 1.535232e-02 1 1  ON 34
  eH1_5                 4.783856e-02 1 1  ON 35
  eH1_6                 9.877173e-02 1 1  ON 36
  eH1_7                 1.422907e-01 1 1  ON 37
  eH1_8                 1.528083e-01 1 1  ON 38
  eH1_9                 3.934689e-02 1 1  ON 39
  eH2_0                -2.369799e-01 1 1  ON 40
  eH2_1                -1.332748e-01 1 1  ON 41
  eH2_2                -8.444752e-02 1 1  ON 42
  eH2_3                -3.064535e-02 1 1  ON 43
  eH2_4                 1.826370e-02 1 1  ON 44
  eH2_5                 5.097936e-02 1 1  ON 45
  eH2_6                 1.034365e-01 1 1  ON 46
  eH2_7                 1.498851e-01 1 1  ON 47
  eH2_8                 1.597271e-01 1 1  ON 48
  eH2_9                 2.115067e-02 1 1  ON 49
ci_0001                 7.011648e-01 3 1  ON 50
ci_0002                 7.002848e-01 3 1  ON 51
ci_0003                -2.785477e-02 3 1  ON 52
ci_0004                -2.725962e-02 3 1  ON 53
ci_0005                -3.686450e-02 3 1  ON 54
ci_0006                -3.732787e-02 3 1  ON 55
ci_0007                -2.308942e-02 3 1  ON 56
ci_0008                -2.295712e-02 3 1  ON 57
ci_0009                -1.746879e-02 3 1  ON 58
ci_0010                -1.748921e-02 3 1  ON 59
ci_0011                -1.216494e-02 3 1  ON 60
ci_0012                -1.225849e-02 3 1  ON 61
ci_0013                 1.328251e-02 3 1  ON 62
ci_0014                 1.331347e-02 3 1  ON 63
ci_0015                 1.305017e-02 3 1  ON 64
ci_0016                 1.271208e-02 3 1  ON 65
ci_0017                 1.114148e-02 3 1  ON 66
ci_0018                 1.163822e-02 3 1  ON 67
ci_0019                 1.172093e-02 3 1  ON 68
ci_0020                 1.105608e-02 3 1  ON 69
ci_0021                 9.819208e-04 3 1  ON 70
ci_0022                 8.524555e-04 3 1  ON 71
ci_0023                -1.128307e-02 3 1  ON 72
ci_0024                -1.086927e-02 3 1  ON 73
ci_0025                -1.078445e-02 3 1  ON 74
ci_0026                -1.113127e-02 3 1  ON 75
ci_0027                -1.100464e-02 3 1  ON 76
ci_0028                -1.111302e-02 3 1  ON 77
ci_0029                -1.069098e-02 3 1  ON 78
ci_0030                -1.046057e-02 3 1  ON 79
ci_0031                 1.989040e-02 3 1  ON 80
ci_0032                 2.114175e-02 3 1  ON 81
ci_0033                 9.693080e-03 3 1  ON 82
ci_0034                 1.041749e-02 3 1  ON 83
ci_0035                 7.584528e-03 3 1  ON 84
ci_0036                 7.187413e-03 3 1  ON 85
ci_0037                -9.642284e-03 3 1  ON 86
ci_0038                -1.211291e-02 3 1  ON 87
ci_0039                -2.659677e-03 3 1  ON 88
ci_0040                -2.747869e-03 3 1  ON 89
ci_0041                 6.739428e-03 3 1  ON 90
ci_0042                 7.421288e-03 3 1  ON 91
ci_0043                -1.814877e-02 3 1  ON 92
ci_0044                -1.805015e-02 3 1  ON 93
ci_0045                 8.338459e-03 3 1  ON 94
ci_0046                 7.818044e-03 3 1  ON 95
ci_0047                -2.330579e-03 3 1  ON 96
ci_0048                -1.687381e-03 3 1  ON 97
ci_0049                -5.883748e-03 3 1  ON 98
ci_0050                -5.362258e-03 3 1  ON 99
ci_0051                -3.614351e-03 3 1  ON 100
ci_0052                -3.197050e-03 3 1  ON 101
ci_0053                -4.896056e-03 3 1  ON 102
ci_0054                -5.060652e-03 3 1  ON 103
ci_0055                 7.519519e-03 3 1  ON 104
ci_0056                 6.419573e-03 3 1  ON 105
ci_0057                 5.202113e-03 3 1  ON 106
ci_0058                 5.319727e-03 3 1  ON 107
ci_0059                -4.830828e-03 3 1  ON 108
ci_0060                -5.166510e-03 3 1  ON 109
ci_0061                -4.134993e-03 3 1  ON 110
ci_0062                -3.785707e-03 3 1  ON 111
ci_0063                -8.077249e-03 3 1  ON 112
ci_0064                -8.916905e-03 3 1  ON 113
ci_0065                -5.266764e-03 3 1  ON 114
ci_0066                -5.169869e-03 3 1  ON 115
ci_0067                -4.783587e-03 3 1  ON 116
ci_0068                -5.226834e-03 3 1  ON 117
ci_0069                 4.454995e-03 3 1  ON 118
ci_0070                 4.336106e-03 3 1  ON 119
ci_0071                 1.012084e-03 3 1  ON 120
ci_0072                 9.236884e-04 3 1  ON 121
ci_0073                 4.435727e-03 3 1  ON 122
ci_0074                 4.564602e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8818
    reference variance = 0.304885
====================================================
  Execution time = 2.1087e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3754e-01
  Total weights = 1.9514e+06
  Execution time = 1.9055e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323790021995
                                         uncertainty =       0.002490456594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323790021995
                                         uncertainty =       0.002490456594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402336428
  error estimate for blocks of size 2^( 2) =       0.000415331342
  error estimate for blocks of size 2^( 3) =       0.000428762095
  error estimate for blocks of size 2^( 4) =       0.000441251097
  error estimate for blocks of size 2^( 5) =       0.000452071666
  error estimate for blocks of size 2^( 6) =       0.000460192093
  error estimate for blocks of size 2^( 7) =       0.000465479196

      target function =                  N/A
              le_mean =     -16.905175309488
             les_mean =     286.124376902059
             stat err =       0.000454748513
             autocorr =       1.277508691775
              std dev =       0.568989633225
             le_variance =       0.323749202718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323697906018
                                         uncertainty =       0.002472578222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323697906018
                                         uncertainty =       0.002472578222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402279334
  error estimate for blocks of size 2^( 2) =       0.000415277069
  error estimate for blocks of size 2^( 3) =       0.000428710461
  error estimate for blocks of size 2^( 4) =       0.000441204367
  error estimate for blocks of size 2^( 5) =       0.000452019988
  error estimate for blocks of size 2^( 6) =       0.000460161116
  error estimate for blocks of size 2^( 7) =       0.000465471630

      target function =                  N/A
              le_mean =     -16.905173787879
             les_mean =     286.122972606479
             stat err =       0.000454714275
             autocorr =       1.277678926547
              std dev =       0.568908890318
             le_variance =       0.323657325482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323679501629
                                         uncertainty =       0.002477728681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323679501629
                                         uncertainty =       0.002477728681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402267963
  error estimate for blocks of size 2^( 2) =       0.000415265782
  error estimate for blocks of size 2^( 3) =       0.000428700402
  error estimate for blocks of size 2^( 4) =       0.000441194686
  error estimate for blocks of size 2^( 5) =       0.000452013707
  error estimate for blocks of size 2^( 6) =       0.000460149884
  error estimate for blocks of size 2^( 7) =       0.000465456038

      target function =                  N/A
              le_mean =     -16.905173158894
             les_mean =     286.122466346843
             stat err =       0.000454703579
             autocorr =       1.277691045834
              std dev =       0.568892809409
             le_variance =       0.323639028597

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323770276897
                                         uncertainty =       0.002488631035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323770276897
                                         uncertainty =       0.002488631035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402324195
  error estimate for blocks of size 2^( 2) =       0.000415319512
  error estimate for blocks of size 2^( 3) =       0.000428750906
  error estimate for blocks of size 2^( 4) =       0.000441240871
  error estimate for blocks of size 2^( 5) =       0.000452061108
  error estimate for blocks of size 2^( 6) =       0.000460183756
  error estimate for blocks of size 2^( 7) =       0.000465473569

      target function =                  N/A
              le_mean =     -16.905174683090
             les_mean =     286.123081953095
             stat err =       0.000454739826
             autocorr =       1.277537570169
              std dev =       0.568972333008
             le_variance =       0.323729515729


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905175309488        initial  <--
     3.9062e-01     3.9062e+00             9.3523e-04       -16.905173787879
     1.5625e+00     1.5625e+01             2.5419e-04       -16.905173158894
     6.2500e+00     6.2500e+01             6.6603e-05       -16.905174683090

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6513
  </log>
  <optVariables href="H2O.s010.opt.xml">
   uu_0                 3.093586e-01 1 1  ON 0
   uu_1                 1.424955e-01 1 1  ON 1
   uu_2                 4.148419e-02 1 1  ON 2
   uu_3                -1.956632e-02 1 1  ON 3
   uu_4                -6.367173e-02 1 1  ON 4
   uu_5                -9.710548e-02 1 1  ON 5
   uu_6                -1.232031e-01 1 1  ON 6
   uu_7                -1.354410e-01 1 1  ON 7
   uu_8                -1.266081e-01 1 1  ON 8
   uu_9                -9.560485e-02 1 1  ON 9
   ud_0                 4.414197e-01 1 1  ON 10
   ud_1                 1.764062e-01 1 1  ON 11
   ud_2                 5.729976e-02 1 1  ON 12
   ud_3                -1.214568e-02 1 1  ON 13
   ud_4                -6.702988e-02 1 1  ON 14
   ud_5                -1.067334e-01 1 1  ON 15
   ud_6                -1.323607e-01 1 1  ON 16
   ud_7                -1.473834e-01 1 1  ON 17
   ud_8                -1.474391e-01 1 1  ON 18
   ud_9                -1.361896e-01 1 1  ON 19
   eO_0                -7.394843e-01 1 1  ON 20
   eO_1                -4.218057e-01 1 1  ON 21
   eO_2                -1.664919e-02 1 1  ON 22
   eO_3                 2.880035e-01 1 1  ON 23
   eO_4                 5.040121e-01 1 1  ON 24
   eO_5                 4.627898e-01 1 1  ON 25
   eO_6                 2.384650e-01 1 1  ON 26
   eO_7                -5.384101e-02 1 1  ON 27
   eO_8                -2.017453e-01 1 1  ON 28
   eO_9                -6.213137e-02 1 1  ON 29
  eH1_0                -2.379797e-01 1 1  ON 30
  eH1_1                -1.347914e-01 1 1  ON 31
  eH1_2                -8.603540e-02 1 1  ON 32
  eH1_3                -3.275160e-02 1 1  ON 33
  eH1_4                 1.534264e-02 1 1  ON 34
  eH1_5                 4.781886e-02 1 1  ON 35
  eH1_6                 9.868407e-02 1 1  ON 36
  eH1_7                 1.422172e-01 1 1  ON 37
  eH1_8                 1.526789e-01 1 1  ON 38
  eH1_9                 3.923098e-02 1 1  ON 39
  eH2_0                -2.367605e-01 1 1  ON 40
  eH2_1                -1.333504e-01 1 1  ON 41
  eH2_2                -8.441197e-02 1 1  ON 42
  eH2_3                -3.064746e-02 1 1  ON 43
  eH2_4                 1.833124e-02 1 1  ON 44
  eH2_5                 5.093761e-02 1 1  ON 45
  eH2_6                 1.034319e-01 1 1  ON 46
  eH2_7                 1.499046e-01 1 1  ON 47
  eH2_8                 1.596390e-01 1 1  ON 48
  eH2_9                 2.102371e-02 1 1  ON 49
ci_0001                 7.012318e-01 3 1  ON 50
ci_0002                 7.002101e-01 3 1  ON 51
ci_0003                -2.789589e-02 3 1  ON 52
ci_0004                -2.719444e-02 3 1  ON 53
ci_0005                -3.685026e-02 3 1  ON 54
ci_0006                -3.737028e-02 3 1  ON 55
ci_0007                -2.320749e-02 3 1  ON 56
ci_0008                -2.300650e-02 3 1  ON 57
ci_0009                -1.745098e-02 3 1  ON 58
ci_0010                -1.759384e-02 3 1  ON 59
ci_0011                -1.207662e-02 3 1  ON 60
ci_0012                -1.221774e-02 3 1  ON 61
ci_0013                 1.312509e-02 3 1  ON 62
ci_0014                 1.331986e-02 3 1  ON 63
ci_0015                 1.305324e-02 3 1  ON 64
ci_0016                 1.268658e-02 3 1  ON 65
ci_0017                 1.115081e-02 3 1  ON 66
ci_0018                 1.167198e-02 3 1  ON 67
ci_0019                 1.178199e-02 3 1  ON 68
ci_0020                 1.112953e-02 3 1  ON 69
ci_0021                 1.090583e-03 3 1  ON 70
ci_0022                 9.947400e-04 3 1  ON 71
ci_0023                -1.139519e-02 3 1  ON 72
ci_0024                -1.087640e-02 3 1  ON 73
ci_0025                -1.077846e-02 3 1  ON 74
ci_0026                -1.118432e-02 3 1  ON 75
ci_0027                -1.087775e-02 3 1  ON 76
ci_0028                -1.109627e-02 3 1  ON 77
ci_0029                -1.053242e-02 3 1  ON 78
ci_0030                -1.046051e-02 3 1  ON 79
ci_0031                 1.979787e-02 3 1  ON 80
ci_0032                 2.111084e-02 3 1  ON 81
ci_0033                 9.692076e-03 3 1  ON 82
ci_0034                 1.061141e-02 3 1  ON 83
ci_0035                 7.602247e-03 3 1  ON 84
ci_0036                 7.217946e-03 3 1  ON 85
ci_0037                -9.497832e-03 3 1  ON 86
ci_0038                -1.220500e-02 3 1  ON 87
ci_0039                -2.699053e-03 3 1  ON 88
ci_0040                -2.744227e-03 3 1  ON 89
ci_0041                 6.724591e-03 3 1  ON 90
ci_0042                 7.402633e-03 3 1  ON 91
ci_0043                -1.806362e-02 3 1  ON 92
ci_0044                -1.797234e-02 3 1  ON 93
ci_0045                 8.496991e-03 3 1  ON 94
ci_0046                 7.883035e-03 3 1  ON 95
ci_0047                -2.314307e-03 3 1  ON 96
ci_0048                -1.678208e-03 3 1  ON 97
ci_0049                -5.950147e-03 3 1  ON 98
ci_0050                -5.347333e-03 3 1  ON 99
ci_0051                -3.549634e-03 3 1  ON 100
ci_0052                -3.244959e-03 3 1  ON 101
ci_0053                -4.911866e-03 3 1  ON 102
ci_0054                -5.145628e-03 3 1  ON 103
ci_0055                 7.636697e-03 3 1  ON 104
ci_0056                 6.378018e-03 3 1  ON 105
ci_0057                 5.215760e-03 3 1  ON 106
ci_0058                 5.373901e-03 3 1  ON 107
ci_0059                -4.807644e-03 3 1  ON 108
ci_0060                -4.999498e-03 3 1  ON 109
ci_0061                -4.187164e-03 3 1  ON 110
ci_0062                -3.814880e-03 3 1  ON 111
ci_0063                -8.258355e-03 3 1  ON 112
ci_0064                -8.911803e-03 3 1  ON 113
ci_0065                -5.232331e-03 3 1  ON 114
ci_0066                -5.184928e-03 3 1  ON 115
ci_0067                -4.800632e-03 3 1  ON 116
ci_0068                -5.254333e-03 3 1  ON 117
ci_0069                 4.485853e-03 3 1  ON 118
ci_0070                 4.392880e-03 3 1  ON 119
ci_0071                 1.014634e-03 3 1  ON 120
ci_0072                 8.942489e-04 3 1  ON 121
ci_0073                 4.556063e-03 3 1  ON 122
ci_0074                 4.646335e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8096e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6884e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8961
    reference variance = 0.405689
====================================================
  Execution time = 2.1276e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5218e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3108e-01
  Total weights = 1.951528504e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1915e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319992248774
                                         uncertainty =       0.003164849342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319992248774
                                         uncertainty =       0.003164849342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399964382
  error estimate for blocks of size 2^( 2) =       0.000413039804
  error estimate for blocks of size 2^( 3) =       0.000426248372
  error estimate for blocks of size 2^( 4) =       0.000439511773
  error estimate for blocks of size 2^( 5) =       0.000451866713
  error estimate for blocks of size 2^( 6) =       0.000462793156
  error estimate for blocks of size 2^( 7) =       0.000470734270

      target function =                  N/A
              le_mean =     -16.905600470674
             les_mean =     286.130403778849
             stat err =       0.000456226478
             autocorr =       1.301122950917
              std dev =       0.565635053745
             le_variance =       0.319943014025


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690560047067e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905600470647       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905603564614       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905603486065       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905603391358       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905603671883       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905603544069       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905603505648       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905603516949       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905603540129       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905603564113       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e+00 is 1.242461e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905600470647       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905601272843       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905601252263       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905601230283       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905601302489       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905601274413       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905601261820       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905601261334       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905601266573       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905601272671       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5625e+01 is 3.202421e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905600470647       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905600673074       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905600667869       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905600662500       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905600680670       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905600673947       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905600670624       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905600670292       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905600671538       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905600673054       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e+01 is 8.068426e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.293310 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7476e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
   uu_0                 3.093701e-01 1 1  ON 0
   uu_1                 1.425031e-01 1 1  ON 1
   uu_2                 4.148841e-02 1 1  ON 2
   uu_3                -1.957168e-02 1 1  ON 3
   uu_4                -6.367979e-02 1 1  ON 4
   uu_5                -9.710692e-02 1 1  ON 5
   uu_6                -1.232164e-01 1 1  ON 6
   uu_7                -1.354498e-01 1 1  ON 7
   uu_8                -1.266127e-01 1 1  ON 8
   uu_9                -9.560520e-02 1 1  ON 9
   ud_0                 4.414317e-01 1 1  ON 10
   ud_1                 1.764130e-01 1 1  ON 11
   ud_2                 5.729951e-02 1 1  ON 12
   ud_3                -1.214183e-02 1 1  ON 13
   ud_4                -6.703647e-02 1 1  ON 14
   ud_5                -1.067395e-01 1 1  ON 15
   ud_6                -1.323652e-01 1 1  ON 16
   ud_7                -1.473831e-01 1 1  ON 17
   ud_8                -1.474471e-01 1 1  ON 18
   ud_9                -1.361917e-01 1 1  ON 19
   eO_0                -7.394998e-01 1 1  ON 20
   eO_1                -4.218245e-01 1 1  ON 21
   eO_2                -1.665016e-02 1 1  ON 22
   eO_3                 2.880073e-01 1 1  ON 23
   eO_4                 5.040315e-01 1 1  ON 24
   eO_5                 4.628044e-01 1 1  ON 25
   eO_6                 2.384724e-01 1 1  ON 26
   eO_7                -5.383330e-02 1 1  ON 27
   eO_8                -2.017547e-01 1 1  ON 28
   eO_9                -6.213952e-02 1 1  ON 29
  eH1_0                -2.380033e-01 1 1  ON 30
  eH1_1                -1.347995e-01 1 1  ON 31
  eH1_2                -8.604086e-02 1 1  ON 32
  eH1_3                -3.275064e-02 1 1  ON 33
  eH1_4                 1.534012e-02 1 1  ON 34
  eH1_5                 4.782279e-02 1 1  ON 35
  eH1_6                 9.868693e-02 1 1  ON 36
  eH1_7                 1.422189e-01 1 1  ON 37
  eH1_8                 1.526920e-01 1 1  ON 38
  eH1_9                 3.924534e-02 1 1  ON 39
  eH2_0                -2.367831e-01 1 1  ON 40
  eH2_1                -1.333562e-01 1 1  ON 41
  eH2_2                -8.442081e-02 1 1  ON 42
  eH2_3                -3.064443e-02 1 1  ON 43
  eH2_4                 1.832557e-02 1 1  ON 44
  eH2_5                 5.094166e-02 1 1  ON 45
  eH2_6                 1.034391e-01 1 1  ON 46
  eH2_7                 1.499060e-01 1 1  ON 47
  eH2_8                 1.596494e-01 1 1  ON 48
  eH2_9                 2.103873e-02 1 1  ON 49
ci_0001                 7.012315e-01 3 1  ON 50
ci_0002                 7.002120e-01 3 1  ON 51
ci_0003                -2.790622e-02 3 1  ON 52
ci_0004                -2.719925e-02 3 1  ON 53
ci_0005                -3.685439e-02 3 1  ON 54
ci_0006                -3.735129e-02 3 1  ON 55
ci_0007                -2.320472e-02 3 1  ON 56
ci_0008                -2.300301e-02 3 1  ON 57
ci_0009                -1.745698e-02 3 1  ON 58
ci_0010                -1.758067e-02 3 1  ON 59
ci_0011                -1.208034e-02 3 1  ON 60
ci_0012                -1.221821e-02 3 1  ON 61
ci_0013                 1.312777e-02 3 1  ON 62
ci_0014                 1.330588e-02 3 1  ON 63
ci_0015                 1.306480e-02 3 1  ON 64
ci_0016                 1.269668e-02 3 1  ON 65
ci_0017                 1.116692e-02 3 1  ON 66
ci_0018                 1.166727e-02 3 1  ON 67
ci_0019                 1.178118e-02 3 1  ON 68
ci_0020                 1.113410e-02 3 1  ON 69
ci_0021                 1.077942e-03 3 1  ON 70
ci_0022                 9.839887e-04 3 1  ON 71
ci_0023                -1.138687e-02 3 1  ON 72
ci_0024                -1.086986e-02 3 1  ON 73
ci_0025                -1.078070e-02 3 1  ON 74
ci_0026                -1.116580e-02 3 1  ON 75
ci_0027                -1.088951e-02 3 1  ON 76
ci_0028                -1.109340e-02 3 1  ON 77
ci_0029                -1.052333e-02 3 1  ON 78
ci_0030                -1.046481e-02 3 1  ON 79
ci_0031                 1.979963e-02 3 1  ON 80
ci_0032                 2.110649e-02 3 1  ON 81
ci_0033                 9.703144e-03 3 1  ON 82
ci_0034                 1.059360e-02 3 1  ON 83
ci_0035                 7.587659e-03 3 1  ON 84
ci_0036                 7.214211e-03 3 1  ON 85
ci_0037                -9.505942e-03 3 1  ON 86
ci_0038                -1.217297e-02 3 1  ON 87
ci_0039                -2.705721e-03 3 1  ON 88
ci_0040                -2.735862e-03 3 1  ON 89
ci_0041                 6.728462e-03 3 1  ON 90
ci_0042                 7.407831e-03 3 1  ON 91
ci_0043                -1.806829e-02 3 1  ON 92
ci_0044                -1.798468e-02 3 1  ON 93
ci_0045                 8.480824e-03 3 1  ON 94
ci_0046                 7.871646e-03 3 1  ON 95
ci_0047                -2.300144e-03 3 1  ON 96
ci_0048                -1.680401e-03 3 1  ON 97
ci_0049                -5.955711e-03 3 1  ON 98
ci_0050                -5.347257e-03 3 1  ON 99
ci_0051                -3.552866e-03 3 1  ON 100
ci_0052                -3.252388e-03 3 1  ON 101
ci_0053                -4.903852e-03 3 1  ON 102
ci_0054                -5.129133e-03 3 1  ON 103
ci_0055                 7.626058e-03 3 1  ON 104
ci_0056                 6.393338e-03 3 1  ON 105
ci_0057                 5.214097e-03 3 1  ON 106
ci_0058                 5.350921e-03 3 1  ON 107
ci_0059                -4.802612e-03 3 1  ON 108
ci_0060                -4.991506e-03 3 1  ON 109
ci_0061                -4.199845e-03 3 1  ON 110
ci_0062                -3.816208e-03 3 1  ON 111
ci_0063                -8.273431e-03 3 1  ON 112
ci_0064                -8.914772e-03 3 1  ON 113
ci_0065                -5.222965e-03 3 1  ON 114
ci_0066                -5.186993e-03 3 1  ON 115
ci_0067                -4.794628e-03 3 1  ON 116
ci_0068                -5.249277e-03 3 1  ON 117
ci_0069                 4.481544e-03 3 1  ON 118
ci_0070                 4.394676e-03 3 1  ON 119
ci_0071                 1.004974e-03 3 1  ON 120
ci_0072                 9.036744e-04 3 1  ON 121
ci_0073                 4.536492e-03 3 1  ON 122
ci_0074                 4.642363e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8967
    reference variance = 0.503631
====================================================
  Execution time = 2.2823e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3608e-01
  Total weights = 1.9519e+06
  Execution time = 1.8794e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322934190939
                                         uncertainty =       0.002314350715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322934190939
                                         uncertainty =       0.002314350715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401890951
  error estimate for blocks of size 2^( 2) =       0.000414568959
  error estimate for blocks of size 2^( 3) =       0.000427736279
  error estimate for blocks of size 2^( 4) =       0.000439910903
  error estimate for blocks of size 2^( 5) =       0.000450120294
  error estimate for blocks of size 2^( 6) =       0.000458571525
  error estimate for blocks of size 2^( 7) =       0.000462862987

      target function =                  N/A
              le_mean =     -16.906468238344
             les_mean =     286.164739684295
             stat err =       0.000452866427
             autocorr =       1.269766302073
              std dev =       0.568359632972
             le_variance =       0.323032672392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322938133381
                                         uncertainty =       0.002312805335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322938133381
                                         uncertainty =       0.002312805335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401893368
  error estimate for blocks of size 2^( 2) =       0.000414570823
  error estimate for blocks of size 2^( 3) =       0.000427736156
  error estimate for blocks of size 2^( 4) =       0.000439909297
  error estimate for blocks of size 2^( 5) =       0.000450117081
  error estimate for blocks of size 2^( 6) =       0.000458564439
  error estimate for blocks of size 2^( 7) =       0.000462854805

      target function =                  N/A
              le_mean =     -16.906469255066
             les_mean =     286.165150973289
             stat err =       0.000452861405
             autocorr =       1.269722869512
              std dev =       0.568363050994
             le_variance =       0.323036557736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322935589279
                                         uncertainty =       0.002313526815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322935589279
                                         uncertainty =       0.002313526815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401891802
  error estimate for blocks of size 2^( 2) =       0.000414569530
  error estimate for blocks of size 2^( 3) =       0.000427735835
  error estimate for blocks of size 2^( 4) =       0.000439909618
  error estimate for blocks of size 2^( 5) =       0.000450118170
  error estimate for blocks of size 2^( 6) =       0.000458567417
  error estimate for blocks of size 2^( 7) =       0.000462858118

      target function =                  N/A
              le_mean =     -16.906468687690
             les_mean =     286.164783965707
             stat err =       0.000452863331
             autocorr =       1.269743554516
              std dev =       0.568360837622
             le_variance =       0.323034041742

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322934304002
                                         uncertainty =       0.002314245397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322934304002
                                         uncertainty =       0.002314245397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401891019
  error estimate for blocks of size 2^( 2) =       0.000414568993
  error estimate for blocks of size 2^( 3) =       0.000427736187
  error estimate for blocks of size 2^( 4) =       0.000439910705
  error estimate for blocks of size 2^( 5) =       0.000450119991
  error estimate for blocks of size 2^( 6) =       0.000458570973
  error estimate for blocks of size 2^( 7) =       0.000462862329

      target function =                  N/A
              le_mean =     -16.906468287131
             les_mean =     286.164743161077
             stat err =       0.000452866000
             autocorr =       1.269763474087
              std dev =       0.568359729224
             le_variance =       0.323032781803


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906468238344        initial
     3.9062e+00     3.9062e+01             1.2425e-04       -16.906469255066  <--
     1.5625e+01     1.5625e+02             3.2024e-05       -16.906468687690
     6.2500e+01     6.2500e+02             8.0684e-06       -16.906468287131

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 3.2400e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
   uu_0                 3.094041e-01 1 1  ON 0
   uu_1                 1.425254e-01 1 1  ON 1
   uu_2                 4.150046e-02 1 1  ON 2
   uu_3                -1.958673e-02 1 1  ON 3
   uu_4                -6.370318e-02 1 1  ON 4
   uu_5                -9.711243e-02 1 1  ON 5
   uu_6                -1.232548e-01 1 1  ON 6
   uu_7                -1.354761e-01 1 1  ON 7
   uu_8                -1.266266e-01 1 1  ON 8
   uu_9                -9.560628e-02 1 1  ON 9
   ud_0                 4.414661e-01 1 1  ON 10
   ud_1                 1.764328e-01 1 1  ON 11
   ud_2                 5.730042e-02 1 1  ON 12
   ud_3                -1.213184e-02 1 1  ON 13
   ud_4                -6.705467e-02 1 1  ON 14
   ud_5                -1.067576e-01 1 1  ON 15
   ud_6                -1.323784e-01 1 1  ON 16
   ud_7                -1.473827e-01 1 1  ON 17
   ud_8                -1.474707e-01 1 1  ON 18
   ud_9                -1.361981e-01 1 1  ON 19
   eO_0                -7.395472e-01 1 1  ON 20
   eO_1                -4.218792e-01 1 1  ON 21
   eO_2                -1.665376e-02 1 1  ON 22
   eO_3                 2.880192e-01 1 1  ON 23
   eO_4                 5.040890e-01 1 1  ON 24
   eO_5                 4.628481e-01 1 1  ON 25
   eO_6                 2.384947e-01 1 1  ON 26
   eO_7                -5.381028e-02 1 1  ON 27
   eO_8                -2.017828e-01 1 1  ON 28
   eO_9                -6.216391e-02 1 1  ON 29
  eH1_0                -2.380733e-01 1 1  ON 30
  eH1_1                -1.348232e-01 1 1  ON 31
  eH1_2                -8.605764e-02 1 1  ON 32
  eH1_3                -3.274830e-02 1 1  ON 33
  eH1_4                 1.533265e-02 1 1  ON 34
  eH1_5                 4.783429e-02 1 1  ON 35
  eH1_6                 9.869550e-02 1 1  ON 36
  eH1_7                 1.422239e-01 1 1  ON 37
  eH1_8                 1.527315e-01 1 1  ON 38
  eH1_9                 3.928831e-02 1 1  ON 39
  eH2_0                -2.368505e-01 1 1  ON 40
  eH2_1                -1.333732e-01 1 1  ON 41
  eH2_2                -8.444691e-02 1 1  ON 42
  eH2_3                -3.063649e-02 1 1  ON 43
  eH2_4                 1.830917e-02 1 1  ON 44
  eH2_5                 5.095351e-02 1 1  ON 45
  eH2_6                 1.034603e-01 1 1  ON 46
  eH2_7                 1.499103e-01 1 1  ON 47
  eH2_8                 1.596803e-01 1 1  ON 48
  eH2_9                 2.108368e-02 1 1  ON 49
ci_0001                 7.012312e-01 3 1  ON 50
ci_0002                 7.002170e-01 3 1  ON 51
ci_0003                -2.793543e-02 3 1  ON 52
ci_0004                -2.721295e-02 3 1  ON 53
ci_0005                -3.686632e-02 3 1  ON 54
ci_0006                -3.729582e-02 3 1  ON 55
ci_0007                -2.319669e-02 3 1  ON 56
ci_0008                -2.299272e-02 3 1  ON 57
ci_0009                -1.747380e-02 3 1  ON 58
ci_0010                -1.754351e-02 3 1  ON 59
ci_0011                -1.209083e-02 3 1  ON 60
ci_0012                -1.221954e-02 3 1  ON 61
ci_0013                 1.313526e-02 3 1  ON 62
ci_0014                 1.326595e-02 3 1  ON 63
ci_0015                 1.309751e-02 3 1  ON 64
ci_0016                 1.272529e-02 3 1  ON 65
ci_0017                 1.121255e-02 3 1  ON 66
ci_0018                 1.165392e-02 3 1  ON 67
ci_0019                 1.177861e-02 3 1  ON 68
ci_0020                 1.114717e-02 3 1  ON 69
ci_0021                 1.041069e-03 3 1  ON 70
ci_0022                 9.524575e-04 3 1  ON 71
ci_0023                -1.136314e-02 3 1  ON 72
ci_0024                -1.085154e-02 3 1  ON 73
ci_0025                -1.078709e-02 3 1  ON 74
ci_0026                -1.111301e-02 3 1  ON 75
ci_0027                -1.092289e-02 3 1  ON 76
ci_0028                -1.108528e-02 3 1  ON 77
ci_0029                -1.049736e-02 3 1  ON 78
ci_0030                -1.047710e-02 3 1  ON 79
ci_0031                 1.980482e-02 3 1  ON 80
ci_0032                 2.109367e-02 3 1  ON 81
ci_0033                 9.735664e-03 3 1  ON 82
ci_0034                 1.054153e-02 3 1  ON 83
ci_0035                 7.545722e-03 3 1  ON 84
ci_0036                 7.203474e-03 3 1  ON 85
ci_0037                -9.529145e-03 3 1  ON 86
ci_0038                -1.208075e-02 3 1  ON 87
ci_0039                -2.724030e-03 3 1  ON 88
ci_0040                -2.712739e-03 3 1  ON 89
ci_0041                 6.739562e-03 3 1  ON 90
ci_0042                 7.422486e-03 3 1  ON 91
ci_0043                -1.808166e-02 3 1  ON 92
ci_0044                -1.802070e-02 3 1  ON 93
ci_0045                 8.434007e-03 3 1  ON 94
ci_0046                 7.838571e-03 3 1  ON 95
ci_0047                -2.260986e-03 3 1  ON 96
ci_0048                -1.686551e-03 3 1  ON 97
ci_0049                -5.971472e-03 3 1  ON 98
ci_0050                -5.347106e-03 3 1  ON 99
ci_0051                -3.561660e-03 3 1  ON 100
ci_0052                -3.272879e-03 3 1  ON 101
ci_0053                -4.881469e-03 3 1  ON 102
ci_0054                -5.083176e-03 3 1  ON 103
ci_0055                 7.595376e-03 3 1  ON 104
ci_0056                 6.437564e-03 3 1  ON 105
ci_0057                 5.209408e-03 3 1  ON 106
ci_0058                 5.284966e-03 3 1  ON 107
ci_0059                -4.788769e-03 3 1  ON 108
ci_0060                -4.969189e-03 3 1  ON 109
ci_0061                -4.236069e-03 3 1  ON 110
ci_0062                -3.819972e-03 3 1  ON 111
ci_0063                -8.315284e-03 3 1  ON 112
ci_0064                -8.923018e-03 3 1  ON 113
ci_0065                -5.196481e-03 3 1  ON 114
ci_0066                -5.192707e-03 3 1  ON 115
ci_0067                -4.777948e-03 3 1  ON 116
ci_0068                -5.235504e-03 3 1  ON 117
ci_0069                 4.469608e-03 3 1  ON 118
ci_0070                 4.399886e-03 3 1  ON 119
ci_0071                 9.773208e-04 3 1  ON 120
ci_0072                 9.301824e-04 3 1  ON 121
ci_0073                 4.482345e-03 3 1  ON 122
ci_0074                 4.631365e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9883e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6885e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9236
    reference variance = 0.317207
====================================================
  Execution time = 2.1698e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3006e-01
  Total weights = 1.951567648e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0857e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319347756522
                                         uncertainty =       0.002372451497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319347756522
                                         uncertainty =       0.002372451497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399614561
  error estimate for blocks of size 2^( 2) =       0.000412765962
  error estimate for blocks of size 2^( 3) =       0.000426536880
  error estimate for blocks of size 2^( 4) =       0.000439286452
  error estimate for blocks of size 2^( 5) =       0.000450224629
  error estimate for blocks of size 2^( 6) =       0.000459151635
  error estimate for blocks of size 2^( 7) =       0.000462663171

      target function =                  N/A
              le_mean =     -16.905858910500
             les_mean =     286.138126382720
             stat err =       0.000452831472
             autocorr =       1.284075608582
              std dev =       0.565140331990
             le_variance =       0.319383594841


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690585891050e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905858910494       residual = 9.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905865087905       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905865232388       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905865147548       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905865904702       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905866083697       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905865873846       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905865753453       residual = 9.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905865823638       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905865961769       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905865971399       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e-01 is 4.922512e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905858910494       residual = 9.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905860680524       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905860722415       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905860702410       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905860900006       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905860929835       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905860875374       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905860866380       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905860848017       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905860871711       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e+00 is 1.287518e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905858910494       residual = 9.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905859369781       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905859380861       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905859376350       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905859425900       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905859432541       residual = 5.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905859418618       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905859418324       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905859411762       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905859416365       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5625e+01 is 3.248001e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.297428 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7792e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
   uu_0                 3.094181e-01 1 1  ON 0
   uu_1                 1.425565e-01 1 1  ON 1
   uu_2                 4.151192e-02 1 1  ON 2
   uu_3                -1.960103e-02 1 1  ON 3
   uu_4                -6.368920e-02 1 1  ON 4
   uu_5                -9.714661e-02 1 1  ON 5
   uu_6                -1.232928e-01 1 1  ON 6
   uu_7                -1.354883e-01 1 1  ON 7
   uu_8                -1.266322e-01 1 1  ON 8
   uu_9                -9.561140e-02 1 1  ON 9
   ud_0                 4.415019e-01 1 1  ON 10
   ud_1                 1.764557e-01 1 1  ON 11
   ud_2                 5.731190e-02 1 1  ON 12
   ud_3                -1.212985e-02 1 1  ON 13
   ud_4                -6.710090e-02 1 1  ON 14
   ud_5                -1.067319e-01 1 1  ON 15
   ud_6                -1.324101e-01 1 1  ON 16
   ud_7                -1.474145e-01 1 1  ON 17
   ud_8                -1.474707e-01 1 1  ON 18
   ud_9                -1.361902e-01 1 1  ON 19
   eO_0                -7.396330e-01 1 1  ON 20
   eO_1                -4.219324e-01 1 1  ON 21
   eO_2                -1.664068e-02 1 1  ON 22
   eO_3                 2.880347e-01 1 1  ON 23
   eO_4                 5.041798e-01 1 1  ON 24
   eO_5                 4.628857e-01 1 1  ON 25
   eO_6                 2.385200e-01 1 1  ON 26
   eO_7                -5.378450e-02 1 1  ON 27
   eO_8                -2.018158e-01 1 1  ON 28
   eO_9                -6.219479e-02 1 1  ON 29
  eH1_0                -2.382021e-01 1 1  ON 30
  eH1_1                -1.348619e-01 1 1  ON 31
  eH1_2                -8.605051e-02 1 1  ON 32
  eH1_3                -3.275897e-02 1 1  ON 33
  eH1_4                 1.536732e-02 1 1  ON 34
  eH1_5                 4.781792e-02 1 1  ON 35
  eH1_6                 9.872551e-02 1 1  ON 36
  eH1_7                 1.422422e-01 1 1  ON 37
  eH1_8                 1.527863e-01 1 1  ON 38
  eH1_9                 3.934091e-02 1 1  ON 39
  eH2_0                -2.369433e-01 1 1  ON 40
  eH2_1                -1.333953e-01 1 1  ON 41
  eH2_2                -8.444837e-02 1 1  ON 42
  eH2_3                -3.063483e-02 1 1  ON 43
  eH2_4                 1.829906e-02 1 1  ON 44
  eH2_5                 5.097683e-02 1 1  ON 45
  eH2_6                 1.034450e-01 1 1  ON 46
  eH2_7                 1.499110e-01 1 1  ON 47
  eH2_8                 1.597274e-01 1 1  ON 48
  eH2_9                 2.114388e-02 1 1  ON 49
ci_0001                 7.012332e-01 3 1  ON 50
ci_0002                 7.002139e-01 3 1  ON 51
ci_0003                -2.792765e-02 3 1  ON 52
ci_0004                -2.725040e-02 3 1  ON 53
ci_0005                -3.687011e-02 3 1  ON 54
ci_0006                -3.728273e-02 3 1  ON 55
ci_0007                -2.318617e-02 3 1  ON 56
ci_0008                -2.299885e-02 3 1  ON 57
ci_0009                -1.744552e-02 3 1  ON 58
ci_0010                -1.754966e-02 3 1  ON 59
ci_0011                -1.209352e-02 3 1  ON 60
ci_0012                -1.221887e-02 3 1  ON 61
ci_0013                 1.314004e-02 3 1  ON 62
ci_0014                 1.326386e-02 3 1  ON 63
ci_0015                 1.310171e-02 3 1  ON 64
ci_0016                 1.274525e-02 3 1  ON 65
ci_0017                 1.120633e-02 3 1  ON 66
ci_0018                 1.161105e-02 3 1  ON 67
ci_0019                 1.178366e-02 3 1  ON 68
ci_0020                 1.113120e-02 3 1  ON 69
ci_0021                 1.003811e-03 3 1  ON 70
ci_0022                 8.972019e-04 3 1  ON 71
ci_0023                -1.133800e-02 3 1  ON 72
ci_0024                -1.084769e-02 3 1  ON 73
ci_0025                -1.076658e-02 3 1  ON 74
ci_0026                -1.111900e-02 3 1  ON 75
ci_0027                -1.096522e-02 3 1  ON 76
ci_0028                -1.110204e-02 3 1  ON 77
ci_0029                -1.052611e-02 3 1  ON 78
ci_0030                -1.045365e-02 3 1  ON 79
ci_0031                 1.979574e-02 3 1  ON 80
ci_0032                 2.111748e-02 3 1  ON 81
ci_0033                 9.725728e-03 3 1  ON 82
ci_0034                 1.051432e-02 3 1  ON 83
ci_0035                 7.552264e-03 3 1  ON 84
ci_0036                 7.235279e-03 3 1  ON 85
ci_0037                -9.576650e-03 3 1  ON 86
ci_0038                -1.207442e-02 3 1  ON 87
ci_0039                -2.749096e-03 3 1  ON 88
ci_0040                -2.709000e-03 3 1  ON 89
ci_0041                 6.796244e-03 3 1  ON 90
ci_0042                 7.392758e-03 3 1  ON 91
ci_0043                -1.805750e-02 3 1  ON 92
ci_0044                -1.805858e-02 3 1  ON 93
ci_0045                 8.418550e-03 3 1  ON 94
ci_0046                 7.835107e-03 3 1  ON 95
ci_0047                -2.227830e-03 3 1  ON 96
ci_0048                -1.695095e-03 3 1  ON 97
ci_0049                -5.968834e-03 3 1  ON 98
ci_0050                -5.351933e-03 3 1  ON 99
ci_0051                -3.575274e-03 3 1  ON 100
ci_0052                -3.289002e-03 3 1  ON 101
ci_0053                -4.895262e-03 3 1  ON 102
ci_0054                -5.066631e-03 3 1  ON 103
ci_0055                 7.543571e-03 3 1  ON 104
ci_0056                 6.509393e-03 3 1  ON 105
ci_0057                 5.203319e-03 3 1  ON 106
ci_0058                 5.294432e-03 3 1  ON 107
ci_0059                -4.798061e-03 3 1  ON 108
ci_0060                -4.906555e-03 3 1  ON 109
ci_0061                -4.187627e-03 3 1  ON 110
ci_0062                -3.781265e-03 3 1  ON 111
ci_0063                -8.331974e-03 3 1  ON 112
ci_0064                -8.945540e-03 3 1  ON 113
ci_0065                -5.201973e-03 3 1  ON 114
ci_0066                -5.188929e-03 3 1  ON 115
ci_0067                -4.830308e-03 3 1  ON 116
ci_0068                -5.232774e-03 3 1  ON 117
ci_0069                 4.456174e-03 3 1  ON 118
ci_0070                 4.424929e-03 3 1  ON 119
ci_0071                 9.303494e-04 3 1  ON 120
ci_0072                 8.907761e-04 3 1  ON 121
ci_0073                 4.497286e-03 3 1  ON 122
ci_0074                 4.608763e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8762
    reference variance = 0.193931
====================================================
  Execution time = 2.1327e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3055e-01
  Total weights = 1.9516e+06
  Execution time = 1.8862e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318377221283
                                         uncertainty =       0.001974119765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318377221283
                                         uncertainty =       0.001974119765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398960667
  error estimate for blocks of size 2^( 2) =       0.000411662683
  error estimate for blocks of size 2^( 3) =       0.000424701844
  error estimate for blocks of size 2^( 4) =       0.000436485441
  error estimate for blocks of size 2^( 5) =       0.000445850545
  error estimate for blocks of size 2^( 6) =       0.000452588231
  error estimate for blocks of size 2^( 7) =       0.000455288305

      target function =                  N/A
              le_mean =     -16.906242028553
             les_mean =     286.154139582399
             stat err =       0.000447553131
             autocorr =       1.258429920209
              std dev =       0.564215586609
             le_variance =       0.318339228173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318467390417
                                         uncertainty =       0.001973347438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318467390417
                                         uncertainty =       0.001973347438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399017214
  error estimate for blocks of size 2^( 2) =       0.000411710421
  error estimate for blocks of size 2^( 3) =       0.000424744248
  error estimate for blocks of size 2^( 4) =       0.000436523652
  error estimate for blocks of size 2^( 5) =       0.000445894348
  error estimate for blocks of size 2^( 6) =       0.000452640931
  error estimate for blocks of size 2^( 7) =       0.000455323903

      target function =                  N/A
              le_mean =     -16.906241971010
             les_mean =     286.153709365174
             stat err =       0.000447595709
             autocorr =       1.258312656092
              std dev =       0.564295555198
             le_variance =       0.318429473616

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318422229658
                                         uncertainty =       0.001973389362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318422229658
                                         uncertainty =       0.001973389362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398988898
  error estimate for blocks of size 2^( 2) =       0.000411685973
  error estimate for blocks of size 2^( 3) =       0.000424722094
  error estimate for blocks of size 2^( 4) =       0.000436503772
  error estimate for blocks of size 2^( 5) =       0.000445872409
  error estimate for blocks of size 2^( 6) =       0.000452615548
  error estimate for blocks of size 2^( 7) =       0.000455306109

      target function =                  N/A
              le_mean =     -16.906241556676
             les_mean =     286.151598300411
             stat err =       0.000447574460
             autocorr =       1.258371778925
              std dev =       0.564255510342
             le_variance =       0.318384280952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318382626422
                                         uncertainty =       0.001974010929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318382626422
                                         uncertainty =       0.001974010929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398964058
  error estimate for blocks of size 2^( 2) =       0.000411665444
  error estimate for blocks of size 2^( 3) =       0.000424704212
  error estimate for blocks of size 2^( 4) =       0.000436487582
  error estimate for blocks of size 2^( 5) =       0.000445853176
  error estimate for blocks of size 2^( 6) =       0.000452591533
  error estimate for blocks of size 2^( 7) =       0.000455290353

      target function =                  N/A
              le_mean =     -16.906241941982
             les_mean =     286.151540751726
             stat err =       0.000447555661
             autocorr =       1.258422760235
              std dev =       0.564220381965
             le_variance =       0.318344639424


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906242028553        initial  <--
     9.7656e-01     9.7656e+00             4.9225e-04       -16.906241971010
     3.9062e+00     3.9062e+01             1.2875e-04       -16.906241556676
     1.5625e+01     1.5625e+02             3.2480e-05       -16.906241941982

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8849
  </log>
  <optVariables href="H2O.s012.opt.xml">
   uu_0                 3.094041e-01 1 1  ON 0
   uu_1                 1.425254e-01 1 1  ON 1
   uu_2                 4.150046e-02 1 1  ON 2
   uu_3                -1.958673e-02 1 1  ON 3
   uu_4                -6.370318e-02 1 1  ON 4
   uu_5                -9.711243e-02 1 1  ON 5
   uu_6                -1.232548e-01 1 1  ON 6
   uu_7                -1.354761e-01 1 1  ON 7
   uu_8                -1.266266e-01 1 1  ON 8
   uu_9                -9.560628e-02 1 1  ON 9
   ud_0                 4.414661e-01 1 1  ON 10
   ud_1                 1.764328e-01 1 1  ON 11
   ud_2                 5.730042e-02 1 1  ON 12
   ud_3                -1.213184e-02 1 1  ON 13
   ud_4                -6.705467e-02 1 1  ON 14
   ud_5                -1.067576e-01 1 1  ON 15
   ud_6                -1.323784e-01 1 1  ON 16
   ud_7                -1.473827e-01 1 1  ON 17
   ud_8                -1.474707e-01 1 1  ON 18
   ud_9                -1.361981e-01 1 1  ON 19
   eO_0                -7.395472e-01 1 1  ON 20
   eO_1                -4.218792e-01 1 1  ON 21
   eO_2                -1.665376e-02 1 1  ON 22
   eO_3                 2.880192e-01 1 1  ON 23
   eO_4                 5.040890e-01 1 1  ON 24
   eO_5                 4.628481e-01 1 1  ON 25
   eO_6                 2.384947e-01 1 1  ON 26
   eO_7                -5.381028e-02 1 1  ON 27
   eO_8                -2.017828e-01 1 1  ON 28
   eO_9                -6.216391e-02 1 1  ON 29
  eH1_0                -2.380733e-01 1 1  ON 30
  eH1_1                -1.348232e-01 1 1  ON 31
  eH1_2                -8.605764e-02 1 1  ON 32
  eH1_3                -3.274830e-02 1 1  ON 33
  eH1_4                 1.533265e-02 1 1  ON 34
  eH1_5                 4.783429e-02 1 1  ON 35
  eH1_6                 9.869550e-02 1 1  ON 36
  eH1_7                 1.422239e-01 1 1  ON 37
  eH1_8                 1.527315e-01 1 1  ON 38
  eH1_9                 3.928831e-02 1 1  ON 39
  eH2_0                -2.368505e-01 1 1  ON 40
  eH2_1                -1.333732e-01 1 1  ON 41
  eH2_2                -8.444691e-02 1 1  ON 42
  eH2_3                -3.063649e-02 1 1  ON 43
  eH2_4                 1.830917e-02 1 1  ON 44
  eH2_5                 5.095351e-02 1 1  ON 45
  eH2_6                 1.034603e-01 1 1  ON 46
  eH2_7                 1.499103e-01 1 1  ON 47
  eH2_8                 1.596803e-01 1 1  ON 48
  eH2_9                 2.108368e-02 1 1  ON 49
ci_0001                 7.012312e-01 3 1  ON 50
ci_0002                 7.002170e-01 3 1  ON 51
ci_0003                -2.793543e-02 3 1  ON 52
ci_0004                -2.721295e-02 3 1  ON 53
ci_0005                -3.686632e-02 3 1  ON 54
ci_0006                -3.729582e-02 3 1  ON 55
ci_0007                -2.319669e-02 3 1  ON 56
ci_0008                -2.299272e-02 3 1  ON 57
ci_0009                -1.747380e-02 3 1  ON 58
ci_0010                -1.754351e-02 3 1  ON 59
ci_0011                -1.209083e-02 3 1  ON 60
ci_0012                -1.221954e-02 3 1  ON 61
ci_0013                 1.313526e-02 3 1  ON 62
ci_0014                 1.326595e-02 3 1  ON 63
ci_0015                 1.309751e-02 3 1  ON 64
ci_0016                 1.272529e-02 3 1  ON 65
ci_0017                 1.121255e-02 3 1  ON 66
ci_0018                 1.165392e-02 3 1  ON 67
ci_0019                 1.177861e-02 3 1  ON 68
ci_0020                 1.114717e-02 3 1  ON 69
ci_0021                 1.041069e-03 3 1  ON 70
ci_0022                 9.524575e-04 3 1  ON 71
ci_0023                -1.136314e-02 3 1  ON 72
ci_0024                -1.085154e-02 3 1  ON 73
ci_0025                -1.078709e-02 3 1  ON 74
ci_0026                -1.111301e-02 3 1  ON 75
ci_0027                -1.092289e-02 3 1  ON 76
ci_0028                -1.108528e-02 3 1  ON 77
ci_0029                -1.049736e-02 3 1  ON 78
ci_0030                -1.047710e-02 3 1  ON 79
ci_0031                 1.980482e-02 3 1  ON 80
ci_0032                 2.109367e-02 3 1  ON 81
ci_0033                 9.735664e-03 3 1  ON 82
ci_0034                 1.054153e-02 3 1  ON 83
ci_0035                 7.545722e-03 3 1  ON 84
ci_0036                 7.203474e-03 3 1  ON 85
ci_0037                -9.529145e-03 3 1  ON 86
ci_0038                -1.208075e-02 3 1  ON 87
ci_0039                -2.724030e-03 3 1  ON 88
ci_0040                -2.712739e-03 3 1  ON 89
ci_0041                 6.739562e-03 3 1  ON 90
ci_0042                 7.422486e-03 3 1  ON 91
ci_0043                -1.808166e-02 3 1  ON 92
ci_0044                -1.802070e-02 3 1  ON 93
ci_0045                 8.434007e-03 3 1  ON 94
ci_0046                 7.838571e-03 3 1  ON 95
ci_0047                -2.260986e-03 3 1  ON 96
ci_0048                -1.686551e-03 3 1  ON 97
ci_0049                -5.971472e-03 3 1  ON 98
ci_0050                -5.347106e-03 3 1  ON 99
ci_0051                -3.561660e-03 3 1  ON 100
ci_0052                -3.272879e-03 3 1  ON 101
ci_0053                -4.881469e-03 3 1  ON 102
ci_0054                -5.083176e-03 3 1  ON 103
ci_0055                 7.595376e-03 3 1  ON 104
ci_0056                 6.437564e-03 3 1  ON 105
ci_0057                 5.209408e-03 3 1  ON 106
ci_0058                 5.284966e-03 3 1  ON 107
ci_0059                -4.788769e-03 3 1  ON 108
ci_0060                -4.969189e-03 3 1  ON 109
ci_0061                -4.236069e-03 3 1  ON 110
ci_0062                -3.819972e-03 3 1  ON 111
ci_0063                -8.315284e-03 3 1  ON 112
ci_0064                -8.923018e-03 3 1  ON 113
ci_0065                -5.196481e-03 3 1  ON 114
ci_0066                -5.192707e-03 3 1  ON 115
ci_0067                -4.777948e-03 3 1  ON 116
ci_0068                -5.235504e-03 3 1  ON 117
ci_0069                 4.469608e-03 3 1  ON 118
ci_0070                 4.399886e-03 3 1  ON 119
ci_0071                 9.773208e-04 3 1  ON 120
ci_0072                 9.301824e-04 3 1  ON 121
ci_0073                 4.482345e-03 3 1  ON 122
ci_0074                 4.631365e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8684e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6886e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9195
    reference variance = 0.19808
====================================================
  Execution time = 2.1280e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3275e-01
  Total weights = 1.951339530e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0327e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318969108435
                                         uncertainty =       0.001987521528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318969108435
                                         uncertainty =       0.001987521528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399332500
  error estimate for blocks of size 2^( 2) =       0.000412283971
  error estimate for blocks of size 2^( 3) =       0.000425138827
  error estimate for blocks of size 2^( 4) =       0.000436353212
  error estimate for blocks of size 2^( 5) =       0.000447532866
  error estimate for blocks of size 2^( 6) =       0.000456134385
  error estimate for blocks of size 2^( 7) =       0.000458335448

      target function =                  N/A
              le_mean =     -16.905323057871
             les_mean =     286.122698357425
             stat err =       0.000449588978
             autocorr =       1.267540944425
              std dev =       0.564741437455
             le_variance =       0.318932891179


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690532305787e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905323057887       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905323566390       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905323597531       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905323642743       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905323717205       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905323655944       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905323664138       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905323653081       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905323673722       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905323681312       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e+00 is 4.848854e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905323057887       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905323187169       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905323194735       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905323205628       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905323224095       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905323209060       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905323210650       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905323207698       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905323212804       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905323214904       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e+01 is 1.215632e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905323057887       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905323090345       residual = 7.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905323092223       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905323094919       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905323099524       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905323095785       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905323096153       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905323095402       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905323096673       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905323097212       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5625e+02 is 3.041231e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.301305 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7321e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
   uu_0                 3.094074e-01 1 1  ON 0
   uu_1                 1.425281e-01 1 1  ON 1
   uu_2                 4.150266e-02 1 1  ON 2
   uu_3                -1.958792e-02 1 1  ON 3
   uu_4                -6.370381e-02 1 1  ON 4
   uu_5                -9.711177e-02 1 1  ON 5
   uu_6                -1.232540e-01 1 1  ON 6
   uu_7                -1.354795e-01 1 1  ON 7
   uu_8                -1.266309e-01 1 1  ON 8
   uu_9                -9.561059e-02 1 1  ON 9
   ud_0                 4.414759e-01 1 1  ON 10
   ud_1                 1.764359e-01 1 1  ON 11
   ud_2                 5.730125e-02 1 1  ON 12
   ud_3                -1.213098e-02 1 1  ON 13
   ud_4                -6.705820e-02 1 1  ON 14
   ud_5                -1.067594e-01 1 1  ON 15
   ud_6                -1.323811e-01 1 1  ON 16
   ud_7                -1.473860e-01 1 1  ON 17
   ud_8                -1.474719e-01 1 1  ON 18
   ud_9                -1.361993e-01 1 1  ON 19
   eO_0                -7.395537e-01 1 1  ON 20
   eO_1                -4.218861e-01 1 1  ON 21
   eO_2                -1.665128e-02 1 1  ON 22
   eO_3                 2.880219e-01 1 1  ON 23
   eO_4                 5.040966e-01 1 1  ON 24
   eO_5                 4.628524e-01 1 1  ON 25
   eO_6                 2.384967e-01 1 1  ON 26
   eO_7                -5.380846e-02 1 1  ON 27
   eO_8                -2.017866e-01 1 1  ON 28
   eO_9                -6.216738e-02 1 1  ON 29
  eH1_0                -2.380855e-01 1 1  ON 30
  eH1_1                -1.348265e-01 1 1  ON 31
  eH1_2                -8.606066e-02 1 1  ON 32
  eH1_3                -3.274825e-02 1 1  ON 33
  eH1_4                 1.533574e-02 1 1  ON 34
  eH1_5                 4.783533e-02 1 1  ON 35
  eH1_6                 9.869967e-02 1 1  ON 36
  eH1_7                 1.422266e-01 1 1  ON 37
  eH1_8                 1.527354e-01 1 1  ON 38
  eH1_9                 3.929166e-02 1 1  ON 39
  eH2_0                -2.368586e-01 1 1  ON 40
  eH2_1                -1.333752e-01 1 1  ON 41
  eH2_2                -8.444656e-02 1 1  ON 42
  eH2_3                -3.063797e-02 1 1  ON 43
  eH2_4                 1.830523e-02 1 1  ON 44
  eH2_5                 5.095458e-02 1 1  ON 45
  eH2_6                 1.034615e-01 1 1  ON 46
  eH2_7                 1.499113e-01 1 1  ON 47
  eH2_8                 1.596858e-01 1 1  ON 48
  eH2_9                 2.108956e-02 1 1  ON 49
ci_0001                 7.012304e-01 3 1  ON 50
ci_0002                 7.002177e-01 3 1  ON 51
ci_0003                -2.793766e-02 3 1  ON 52
ci_0004                -2.721657e-02 3 1  ON 53
ci_0005                -3.686543e-02 3 1  ON 54
ci_0006                -3.729575e-02 3 1  ON 55
ci_0007                -2.319730e-02 3 1  ON 56
ci_0008                -2.299003e-02 3 1  ON 57
ci_0009                -1.747259e-02 3 1  ON 58
ci_0010                -1.754219e-02 3 1  ON 59
ci_0011                -1.209045e-02 3 1  ON 60
ci_0012                -1.221857e-02 3 1  ON 61
ci_0013                 1.313663e-02 3 1  ON 62
ci_0014                 1.326359e-02 3 1  ON 63
ci_0015                 1.309747e-02 3 1  ON 64
ci_0016                 1.272897e-02 3 1  ON 65
ci_0017                 1.120792e-02 3 1  ON 66
ci_0018                 1.165121e-02 3 1  ON 67
ci_0019                 1.177842e-02 3 1  ON 68
ci_0020                 1.114817e-02 3 1  ON 69
ci_0021                 1.034855e-03 3 1  ON 70
ci_0022                 9.483562e-04 3 1  ON 71
ci_0023                -1.135982e-02 3 1  ON 72
ci_0024                -1.085458e-02 3 1  ON 73
ci_0025                -1.079174e-02 3 1  ON 74
ci_0026                -1.110863e-02 3 1  ON 75
ci_0027                -1.092644e-02 3 1  ON 76
ci_0028                -1.108770e-02 3 1  ON 77
ci_0029                -1.050042e-02 3 1  ON 78
ci_0030                -1.047330e-02 3 1  ON 79
ci_0031                 1.980517e-02 3 1  ON 80
ci_0032                 2.109611e-02 3 1  ON 81
ci_0033                 9.739904e-03 3 1  ON 82
ci_0034                 1.053755e-02 3 1  ON 83
ci_0035                 7.537596e-03 3 1  ON 84
ci_0036                 7.206139e-03 3 1  ON 85
ci_0037                -9.534459e-03 3 1  ON 86
ci_0038                -1.207580e-02 3 1  ON 87
ci_0039                -2.728853e-03 3 1  ON 88
ci_0040                -2.714161e-03 3 1  ON 89
ci_0041                 6.749275e-03 3 1  ON 90
ci_0042                 7.422922e-03 3 1  ON 91
ci_0043                -1.808351e-02 3 1  ON 92
ci_0044                -1.802309e-02 3 1  ON 93
ci_0045                 8.431941e-03 3 1  ON 94
ci_0046                 7.838236e-03 3 1  ON 95
ci_0047                -2.256147e-03 3 1  ON 96
ci_0048                -1.686823e-03 3 1  ON 97
ci_0049                -5.964223e-03 3 1  ON 98
ci_0050                -5.346406e-03 3 1  ON 99
ci_0051                -3.559101e-03 3 1  ON 100
ci_0052                -3.279472e-03 3 1  ON 101
ci_0053                -4.883785e-03 3 1  ON 102
ci_0054                -5.077530e-03 3 1  ON 103
ci_0055                 7.590361e-03 3 1  ON 104
ci_0056                 6.436239e-03 3 1  ON 105
ci_0057                 5.208566e-03 3 1  ON 106
ci_0058                 5.286186e-03 3 1  ON 107
ci_0059                -4.787975e-03 3 1  ON 108
ci_0060                -4.966075e-03 3 1  ON 109
ci_0061                -4.233090e-03 3 1  ON 110
ci_0062                -3.821755e-03 3 1  ON 111
ci_0063                -8.322023e-03 3 1  ON 112
ci_0064                -8.918811e-03 3 1  ON 113
ci_0065                -5.195860e-03 3 1  ON 114
ci_0066                -5.189758e-03 3 1  ON 115
ci_0067                -4.780475e-03 3 1  ON 116
ci_0068                -5.237020e-03 3 1  ON 117
ci_0069                 4.470663e-03 3 1  ON 118
ci_0070                 4.399975e-03 3 1  ON 119
ci_0071                 9.767077e-04 3 1  ON 120
ci_0072                 9.284731e-04 3 1  ON 121
ci_0073                 4.481985e-03 3 1  ON 122
ci_0074                 4.627664e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8732
    reference variance = 0.284406
====================================================
  Execution time = 2.1014e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3573e-01
  Total weights = 1.9515e+06
  Execution time = 1.8918e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320368314283
                                         uncertainty =       0.002527893586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320368314283
                                         uncertainty =       0.002527893586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400205206
  error estimate for blocks of size 2^( 2) =       0.000413132557
  error estimate for blocks of size 2^( 3) =       0.000426349322
  error estimate for blocks of size 2^( 4) =       0.000438931591
  error estimate for blocks of size 2^( 5) =       0.000449106682
  error estimate for blocks of size 2^( 6) =       0.000454394817
  error estimate for blocks of size 2^( 7) =       0.000456267899

      target function =                  N/A
              le_mean =     -16.906665389105
             les_mean =     286.171064344892
             stat err =       0.000449675247
             autocorr =       1.262503223452
              std dev =       0.565975630613
             le_variance =       0.320328414448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320397878682
                                         uncertainty =       0.002530696247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320397878682
                                         uncertainty =       0.002530696247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400223675
  error estimate for blocks of size 2^( 2) =       0.000413149657
  error estimate for blocks of size 2^( 3) =       0.000426365359
  error estimate for blocks of size 2^( 4) =       0.000438946637
  error estimate for blocks of size 2^( 5) =       0.000449121320
  error estimate for blocks of size 2^( 6) =       0.000454408446
  error estimate for blocks of size 2^( 7) =       0.000456283644

      target function =                  N/A
              le_mean =     -16.906665860877
             les_mean =     286.171088053808
             stat err =       0.000449690011
             autocorr =       1.262469606507
              std dev =       0.566001748978
             le_variance =       0.320357979846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320383366364
                                         uncertainty =       0.002529300749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320383366364
                                         uncertainty =       0.002529300749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400214610
  error estimate for blocks of size 2^( 2) =       0.000413141258
  error estimate for blocks of size 2^( 3) =       0.000426357481
  error estimate for blocks of size 2^( 4) =       0.000438939245
  error estimate for blocks of size 2^( 5) =       0.000449114135
  error estimate for blocks of size 2^( 6) =       0.000454401757
  error estimate for blocks of size 2^( 7) =       0.000456275923

      target function =                  N/A
              le_mean =     -16.906665618077
             les_mean =     286.171074562011
             stat err =       0.000449682765
             autocorr =       1.262486111145
              std dev =       0.565988928721
             le_variance =       0.320343467434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320370196776
                                         uncertainty =       0.002528068223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320370196776
                                         uncertainty =       0.002528068223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400206382
  error estimate for blocks of size 2^( 2) =       0.000413133645
  error estimate for blocks of size 2^( 3) =       0.000426350342
  error estimate for blocks of size 2^( 4) =       0.000438932547
  error estimate for blocks of size 2^( 5) =       0.000449107614
  error estimate for blocks of size 2^( 6) =       0.000454395685
  error estimate for blocks of size 2^( 7) =       0.000456268902

      target function =                  N/A
              le_mean =     -16.906665416822
             les_mean =     286.171065440330
             stat err =       0.000449676187
             autocorr =       1.262501079939
              std dev =       0.565977293787
             le_variance =       0.320330297083


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906665389105        initial
     9.7656e+00     9.7656e+01             4.8489e-05       -16.906665860877  <--
     3.9062e+01     3.9062e+02             1.2156e-05       -16.906665618077
     1.5625e+02     1.5625e+03             3.0412e-06       -16.906665416822

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 3.0597e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
   uu_0                 3.094170e-01 1 1  ON 0
   uu_1                 1.425362e-01 1 1  ON 1
   uu_2                 4.150912e-02 1 1  ON 2
   uu_3                -1.959134e-02 1 1  ON 3
   uu_4                -6.370572e-02 1 1  ON 4
   uu_5                -9.710988e-02 1 1  ON 5
   uu_6                -1.232513e-01 1 1  ON 6
   uu_7                -1.354897e-01 1 1  ON 7
   uu_8                -1.266440e-01 1 1  ON 8
   uu_9                -9.562353e-02 1 1  ON 9
   ud_0                 4.415047e-01 1 1  ON 10
   ud_1                 1.764454e-01 1 1  ON 11
   ud_2                 5.730400e-02 1 1  ON 12
   ud_3                -1.212860e-02 1 1  ON 13
   ud_4                -6.706837e-02 1 1  ON 14
   ud_5                -1.067648e-01 1 1  ON 15
   ud_6                -1.323893e-01 1 1  ON 16
   ud_7                -1.473959e-01 1 1  ON 17
   ud_8                -1.474757e-01 1 1  ON 18
   ud_9                -1.362030e-01 1 1  ON 19
   eO_0                -7.395733e-01 1 1  ON 20
   eO_1                -4.219064e-01 1 1  ON 21
   eO_2                -1.664409e-02 1 1  ON 22
   eO_3                 2.880301e-01 1 1  ON 23
   eO_4                 5.041194e-01 1 1  ON 24
   eO_5                 4.628652e-01 1 1  ON 25
   eO_6                 2.385029e-01 1 1  ON 26
   eO_7                -5.380302e-02 1 1  ON 27
   eO_8                -2.017982e-01 1 1  ON 28
   eO_9                -6.217778e-02 1 1  ON 29
  eH1_0                -2.381218e-01 1 1  ON 30
  eH1_1                -1.348364e-01 1 1  ON 31
  eH1_2                -8.606967e-02 1 1  ON 32
  eH1_3                -3.274816e-02 1 1  ON 33
  eH1_4                 1.534489e-02 1 1  ON 34
  eH1_5                 4.783852e-02 1 1  ON 35
  eH1_6                 9.871214e-02 1 1  ON 36
  eH1_7                 1.422346e-01 1 1  ON 37
  eH1_8                 1.527471e-01 1 1  ON 38
  eH1_9                 3.930168e-02 1 1  ON 39
  eH2_0                -2.368829e-01 1 1  ON 40
  eH2_1                -1.333811e-01 1 1  ON 41
  eH2_2                -8.444574e-02 1 1  ON 42
  eH2_3                -3.064234e-02 1 1  ON 43
  eH2_4                 1.829351e-02 1 1  ON 44
  eH2_5                 5.095773e-02 1 1  ON 45
  eH2_6                 1.034652e-01 1 1  ON 46
  eH2_7                 1.499146e-01 1 1  ON 47
  eH2_8                 1.597024e-01 1 1  ON 48
  eH2_9                 2.110719e-02 1 1  ON 49
ci_0001                 7.012280e-01 3 1  ON 50
ci_0002                 7.002199e-01 3 1  ON 51
ci_0003                -2.794416e-02 3 1  ON 52
ci_0004                -2.722721e-02 3 1  ON 53
ci_0005                -3.686280e-02 3 1  ON 54
ci_0006                -3.729551e-02 3 1  ON 55
ci_0007                -2.319915e-02 3 1  ON 56
ci_0008                -2.298201e-02 3 1  ON 57
ci_0009                -1.746903e-02 3 1  ON 58
ci_0010                -1.753831e-02 3 1  ON 59
ci_0011                -1.208933e-02 3 1  ON 60
ci_0012                -1.221570e-02 3 1  ON 61
ci_0013                 1.314062e-02 3 1  ON 62
ci_0014                 1.325666e-02 3 1  ON 63
ci_0015                 1.309735e-02 3 1  ON 64
ci_0016                 1.273978e-02 3 1  ON 65
ci_0017                 1.119436e-02 3 1  ON 66
ci_0018                 1.164324e-02 3 1  ON 67
ci_0019                 1.177785e-02 3 1  ON 68
ci_0020                 1.115112e-02 3 1  ON 69
ci_0021                 1.016401e-03 3 1  ON 70
ci_0022                 9.361459e-04 3 1  ON 71
ci_0023                -1.135008e-02 3 1  ON 72
ci_0024                -1.086351e-02 3 1  ON 73
ci_0025                -1.080539e-02 3 1  ON 74
ci_0026                -1.109575e-02 3 1  ON 75
ci_0027                -1.093687e-02 3 1  ON 76
ci_0028                -1.109476e-02 3 1  ON 77
ci_0029                -1.050942e-02 3 1  ON 78
ci_0030                -1.046217e-02 3 1  ON 79
ci_0031                 1.980618e-02 3 1  ON 80
ci_0032                 2.110328e-02 3 1  ON 81
ci_0033                 9.752501e-03 3 1  ON 82
ci_0034                 1.052573e-02 3 1  ON 83
ci_0035                 7.513668e-03 3 1  ON 84
ci_0036                 7.213970e-03 3 1  ON 85
ci_0037                -9.550108e-03 3 1  ON 86
ci_0038                -1.206122e-02 3 1  ON 87
ci_0039                -2.742801e-03 3 1  ON 88
ci_0040                -2.718250e-03 3 1  ON 89
ci_0041                 6.777783e-03 3 1  ON 90
ci_0042                 7.424200e-03 3 1  ON 91
ci_0043                -1.808899e-02 3 1  ON 92
ci_0044                -1.803015e-02 3 1  ON 93
ci_0045                 8.425851e-03 3 1  ON 94
ci_0046                 7.837239e-03 3 1  ON 95
ci_0047                -2.242101e-03 3 1  ON 96
ci_0048                -1.687599e-03 3 1  ON 97
ci_0049                -5.942964e-03 3 1  ON 98
ci_0050                -5.344348e-03 3 1  ON 99
ci_0051                -3.551667e-03 3 1  ON 100
ci_0052                -3.298581e-03 3 1  ON 101
ci_0053                -4.890513e-03 3 1  ON 102
ci_0054                -5.061087e-03 3 1  ON 103
ci_0055                 7.575538e-03 3 1  ON 104
ci_0056                 6.432349e-03 3 1  ON 105
ci_0057                 5.206086e-03 3 1  ON 106
ci_0058                 5.289764e-03 3 1  ON 107
ci_0059                -4.785681e-03 3 1  ON 108
ci_0060                -4.957025e-03 3 1  ON 109
ci_0061                -4.224333e-03 3 1  ON 110
ci_0062                -3.826988e-03 3 1  ON 111
ci_0063                -8.341645e-03 3 1  ON 112
ci_0064                -8.906509e-03 3 1  ON 113
ci_0065                -5.194018e-03 3 1  ON 114
ci_0066                -5.181131e-03 3 1  ON 115
ci_0067                -4.787803e-03 3 1  ON 116
ci_0068                -5.241420e-03 3 1  ON 117
ci_0069                 4.473708e-03 3 1  ON 118
ci_0070                 4.400230e-03 3 1  ON 119
ci_0071                 9.749111e-04 3 1  ON 120
ci_0072                 9.234071e-04 3 1  ON 121
ci_0073                 4.480922e-03 3 1  ON 122
ci_0074                 4.616919e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7925e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9327
    reference variance = 0.255026
====================================================
  Execution time = 2.1532e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5228e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3929e-01
  Total weights = 1.951595362e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0549e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325244674403
                                         uncertainty =       0.002345777046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325244674403
                                         uncertainty =       0.002345777046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403221602
  error estimate for blocks of size 2^( 2) =       0.000416044419
  error estimate for blocks of size 2^( 3) =       0.000429085226
  error estimate for blocks of size 2^( 4) =       0.000441282185
  error estimate for blocks of size 2^( 5) =       0.000452014617
  error estimate for blocks of size 2^( 6) =       0.000458458815
  error estimate for blocks of size 2^( 7) =       0.000462523640

      target function =                  N/A
              le_mean =     -16.906221581401
             les_mean =     286.159622911727
             stat err =       0.000453569814
             autocorr =       1.265320971709
              std dev =       0.570241458224
             le_variance =       0.325175320678


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690622158140e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906221581397       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906224341987       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906224821082       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906224740544       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906224989944       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906225510649       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906225396651       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906225458194       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906225422092       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906225428992       residual = 4.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e+00 is 1.593105e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906221581397       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906222316176       residual = 5.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906222444608       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906222424903       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906222495544       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906222630151       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906222604585       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906222620856       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906222609167       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906222612913       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e+00 is 4.176822e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906221581397       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906221768111       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906221800825       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906221795936       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906221814144       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906221848165       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906221842060       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906221846220       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906221843120       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906221844169       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e+01 is 1.056962e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.305228 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7595e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
   uu_0                 3.094329e-01 1 1  ON 0
   uu_1                 1.425462e-01 1 1  ON 1
   uu_2                 4.152107e-02 1 1  ON 2
   uu_3                -1.960555e-02 1 1  ON 3
   uu_4                -6.370666e-02 1 1  ON 4
   uu_5                -9.712542e-02 1 1  ON 5
   uu_6                -1.232705e-01 1 1  ON 6
   uu_7                -1.354870e-01 1 1  ON 7
   uu_8                -1.266512e-01 1 1  ON 8
   uu_9                -9.563255e-02 1 1  ON 9
   ud_0                 4.415074e-01 1 1  ON 10
   ud_1                 1.764525e-01 1 1  ON 11
   ud_2                 5.731276e-02 1 1  ON 12
   ud_3                -1.212186e-02 1 1  ON 13
   ud_4                -6.706341e-02 1 1  ON 14
   ud_5                -1.067658e-01 1 1  ON 15
   ud_6                -1.323947e-01 1 1  ON 16
   ud_7                -1.474026e-01 1 1  ON 17
   ud_8                -1.474833e-01 1 1  ON 18
   ud_9                -1.362079e-01 1 1  ON 19
   eO_0                -7.396073e-01 1 1  ON 20
   eO_1                -4.219119e-01 1 1  ON 21
   eO_2                -1.664357e-02 1 1  ON 22
   eO_3                 2.880399e-01 1 1  ON 23
   eO_4                 5.041427e-01 1 1  ON 24
   eO_5                 4.628833e-01 1 1  ON 25
   eO_6                 2.385111e-01 1 1  ON 26
   eO_7                -5.379221e-02 1 1  ON 27
   eO_8                -2.018139e-01 1 1  ON 28
   eO_9                -6.219206e-02 1 1  ON 29
  eH1_0                -2.381507e-01 1 1  ON 30
  eH1_1                -1.348575e-01 1 1  ON 31
  eH1_2                -8.608227e-02 1 1  ON 32
  eH1_3                -3.275490e-02 1 1  ON 33
  eH1_4                 1.534812e-02 1 1  ON 34
  eH1_5                 4.783705e-02 1 1  ON 35
  eH1_6                 9.872559e-02 1 1  ON 36
  eH1_7                 1.422476e-01 1 1  ON 37
  eH1_8                 1.527674e-01 1 1  ON 38
  eH1_9                 3.932179e-02 1 1  ON 39
  eH2_0                -2.369163e-01 1 1  ON 40
  eH2_1                -1.333928e-01 1 1  ON 41
  eH2_2                -8.444084e-02 1 1  ON 42
  eH2_3                -3.065239e-02 1 1  ON 43
  eH2_4                 1.829019e-02 1 1  ON 44
  eH2_5                 5.096337e-02 1 1  ON 45
  eH2_6                 1.034778e-01 1 1  ON 46
  eH2_7                 1.499194e-01 1 1  ON 47
  eH2_8                 1.597148e-01 1 1  ON 48
  eH2_9                 2.112575e-02 1 1  ON 49
ci_0001                 7.012313e-01 3 1  ON 50
ci_0002                 7.002149e-01 3 1  ON 51
ci_0003                -2.793215e-02 3 1  ON 52
ci_0004                -2.725650e-02 3 1  ON 53
ci_0005                -3.687624e-02 3 1  ON 54
ci_0006                -3.730945e-02 3 1  ON 55
ci_0007                -2.319974e-02 3 1  ON 56
ci_0008                -2.297740e-02 3 1  ON 57
ci_0009                -1.749248e-02 3 1  ON 58
ci_0010                -1.753284e-02 3 1  ON 59
ci_0011                -1.208334e-02 3 1  ON 60
ci_0012                -1.220450e-02 3 1  ON 61
ci_0013                 1.314688e-02 3 1  ON 62
ci_0014                 1.324695e-02 3 1  ON 63
ci_0015                 1.310654e-02 3 1  ON 64
ci_0016                 1.273154e-02 3 1  ON 65
ci_0017                 1.120758e-02 3 1  ON 66
ci_0018                 1.163436e-02 3 1  ON 67
ci_0019                 1.176754e-02 3 1  ON 68
ci_0020                 1.112700e-02 3 1  ON 69
ci_0021                 1.005808e-03 3 1  ON 70
ci_0022                 9.313244e-04 3 1  ON 71
ci_0023                -1.134508e-02 3 1  ON 72
ci_0024                -1.087131e-02 3 1  ON 73
ci_0025                -1.079784e-02 3 1  ON 74
ci_0026                -1.108929e-02 3 1  ON 75
ci_0027                -1.095121e-02 3 1  ON 76
ci_0028                -1.110756e-02 3 1  ON 77
ci_0029                -1.053097e-02 3 1  ON 78
ci_0030                -1.046476e-02 3 1  ON 79
ci_0031                 1.979687e-02 3 1  ON 80
ci_0032                 2.110943e-02 3 1  ON 81
ci_0033                 9.754108e-03 3 1  ON 82
ci_0034                 1.054544e-02 3 1  ON 83
ci_0035                 7.484721e-03 3 1  ON 84
ci_0036                 7.235058e-03 3 1  ON 85
ci_0037                -9.556496e-03 3 1  ON 86
ci_0038                -1.201945e-02 3 1  ON 87
ci_0039                -2.743862e-03 3 1  ON 88
ci_0040                -2.706987e-03 3 1  ON 89
ci_0041                 6.794035e-03 3 1  ON 90
ci_0042                 7.409911e-03 3 1  ON 91
ci_0043                -1.809572e-02 3 1  ON 92
ci_0044                -1.803589e-02 3 1  ON 93
ci_0045                 8.416316e-03 3 1  ON 94
ci_0046                 7.832485e-03 3 1  ON 95
ci_0047                -2.242405e-03 3 1  ON 96
ci_0048                -1.701704e-03 3 1  ON 97
ci_0049                -5.931118e-03 3 1  ON 98
ci_0050                -5.361099e-03 3 1  ON 99
ci_0051                -3.557485e-03 3 1  ON 100
ci_0052                -3.280876e-03 3 1  ON 101
ci_0053                -4.905475e-03 3 1  ON 102
ci_0054                -5.051856e-03 3 1  ON 103
ci_0055                 7.568854e-03 3 1  ON 104
ci_0056                 6.453162e-03 3 1  ON 105
ci_0057                 5.210901e-03 3 1  ON 106
ci_0058                 5.287002e-03 3 1  ON 107
ci_0059                -4.780661e-03 3 1  ON 108
ci_0060                -4.931366e-03 3 1  ON 109
ci_0061                -4.231185e-03 3 1  ON 110
ci_0062                -3.817252e-03 3 1  ON 111
ci_0063                -8.365937e-03 3 1  ON 112
ci_0064                -8.917912e-03 3 1  ON 113
ci_0065                -5.165593e-03 3 1  ON 114
ci_0066                -5.176739e-03 3 1  ON 115
ci_0067                -4.796859e-03 3 1  ON 116
ci_0068                -5.213295e-03 3 1  ON 117
ci_0069                 4.480823e-03 3 1  ON 118
ci_0070                 4.416517e-03 3 1  ON 119
ci_0071                 9.505258e-04 3 1  ON 120
ci_0072                 9.140282e-04 3 1  ON 121
ci_0073                 4.466576e-03 3 1  ON 122
ci_0074                 4.603430e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8885
    reference variance = 0.310737
====================================================
  Execution time = 2.1031e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3283e-01
  Total weights = 1.9513e+06
  Execution time = 1.8879e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320104562645
                                         uncertainty =       0.002059459650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320104562645
                                         uncertainty =       0.002059459650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400072567
  error estimate for blocks of size 2^( 2) =       0.000413431565
  error estimate for blocks of size 2^( 3) =       0.000426159559
  error estimate for blocks of size 2^( 4) =       0.000439050894
  error estimate for blocks of size 2^( 5) =       0.000451059200
  error estimate for blocks of size 2^( 6) =       0.000460457365
  error estimate for blocks of size 2^( 7) =       0.000466046940

      target function =                  N/A
              le_mean =     -16.906137083148
             les_mean =     286.150385147210
             stat err =       0.000454153600
             autocorr =       1.288629226357
              std dev =       0.565788049944
             le_variance =       0.320116117460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320057764241
                                         uncertainty =       0.002055651178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320057764241
                                         uncertainty =       0.002055651178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400043199
  error estimate for blocks of size 2^( 2) =       0.000413402928
  error estimate for blocks of size 2^( 3) =       0.000426131038
  error estimate for blocks of size 2^( 4) =       0.000439022443
  error estimate for blocks of size 2^( 5) =       0.000451033953
  error estimate for blocks of size 2^( 6) =       0.000460435354
  error estimate for blocks of size 2^( 7) =       0.000466027398

      target function =                  N/A
              le_mean =     -16.906138422621
             les_mean =     286.150312987548
             stat err =       0.000454129787
             autocorr =       1.288683282046
              std dev =       0.565746517652
             le_variance =       0.320069122235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320076319534
                                         uncertainty =       0.002057385741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320076319534
                                         uncertainty =       0.002057385741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400054853
  error estimate for blocks of size 2^( 2) =       0.000413414297
  error estimate for blocks of size 2^( 3) =       0.000426142443
  error estimate for blocks of size 2^( 4) =       0.000439033899
  error estimate for blocks of size 2^( 5) =       0.000451043981
  error estimate for blocks of size 2^( 6) =       0.000460443820
  error estimate for blocks of size 2^( 7) =       0.000466034614

      target function =                  N/A
              le_mean =     -16.906137695143
             les_mean =     286.150282348285
             stat err =       0.000454139079
             autocorr =       1.288660930845
              std dev =       0.565762999360
             le_variance =       0.320087771445

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320100765408
                                         uncertainty =       0.002059192733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320100765408
                                         uncertainty =       0.002059192733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400070186
  error estimate for blocks of size 2^( 2) =       0.000413429243
  error estimate for blocks of size 2^( 3) =       0.000426157261
  error estimate for blocks of size 2^( 4) =       0.000439048617
  error estimate for blocks of size 2^( 5) =       0.000451057151
  error estimate for blocks of size 2^( 6) =       0.000460455528
  error estimate for blocks of size 2^( 7) =       0.000466045251

      target function =                  N/A
              le_mean =     -16.906137148138
             les_mean =     286.150360909003
             stat err =       0.000454151637
             autocorr =       1.288633422516
              std dev =       0.565784682763
             le_variance =       0.320112307249


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906137083148        initial
     2.4414e+00     2.4414e+01             1.5931e-04       -16.906138422621  <--
     9.7656e+00     9.7656e+01             4.1768e-05       -16.906137695143
     3.9062e+01     3.9062e+02             1.0570e-05       -16.906137148138

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 3.0601e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
   uu_0                 3.094816e-01 1 1  ON 0
   uu_1                 1.425770e-01 1 1  ON 1
   uu_2                 4.155153e-02 1 1  ON 2
   uu_3                -1.964158e-02 1 1  ON 3
   uu_4                -6.371458e-02 1 1  ON 4
   uu_5                -9.716864e-02 1 1  ON 5
   uu_6                -1.233271e-01 1 1  ON 6
   uu_7                -1.354811e-01 1 1  ON 7
   uu_8                -1.266728e-01 1 1  ON 8
   uu_9                -9.565930e-02 1 1  ON 9
   ud_0                 4.415185e-01 1 1  ON 10
   ud_1                 1.764750e-01 1 1  ON 11
   ud_2                 5.733767e-02 1 1  ON 12
   ud_3                -1.210190e-02 1 1  ON 13
   ud_4                -6.704974e-02 1 1  ON 14
   ud_5                -1.067688e-01 1 1  ON 15
   ud_6                -1.324111e-01 1 1  ON 16
   ud_7                -1.474231e-01 1 1  ON 17
   ud_8                -1.475065e-01 1 1  ON 18
   ud_9                -1.362224e-01 1 1  ON 19
   eO_0                -7.397053e-01 1 1  ON 20
   eO_1                -4.219299e-01 1 1  ON 21
   eO_2                -1.664246e-02 1 1  ON 22
   eO_3                 2.880684e-01 1 1  ON 23
   eO_4                 5.042123e-01 1 1  ON 24
   eO_5                 4.629374e-01 1 1  ON 25
   eO_6                 2.385350e-01 1 1  ON 26
   eO_7                -5.376021e-02 1 1  ON 27
   eO_8                -2.018608e-01 1 1  ON 28
   eO_9                -6.223468e-02 1 1  ON 29
  eH1_0                -2.382365e-01 1 1  ON 30
  eH1_1                -1.349197e-01 1 1  ON 31
  eH1_2                -8.611939e-02 1 1  ON 32
  eH1_3                -3.277613e-02 1 1  ON 33
  eH1_4                 1.535706e-02 1 1  ON 34
  eH1_5                 4.783306e-02 1 1  ON 35
  eH1_6                 9.876565e-02 1 1  ON 36
  eH1_7                 1.422860e-01 1 1  ON 37
  eH1_8                 1.528280e-01 1 1  ON 38
  eH1_9                 3.938185e-02 1 1  ON 39
  eH2_0                -2.370143e-01 1 1  ON 40
  eH2_1                -1.334263e-01 1 1  ON 41
  eH2_2                -8.443007e-02 1 1  ON 42
  eH2_3                -3.068075e-02 1 1  ON 43
  eH2_4                 1.828015e-02 1 1  ON 44
  eH2_5                 5.097974e-02 1 1  ON 45
  eH2_6                 1.035152e-01 1 1  ON 46
  eH2_7                 1.499340e-01 1 1  ON 47
  eH2_8                 1.597518e-01 1 1  ON 48
  eH2_9                 2.118118e-02 1 1  ON 49
ci_0001                 7.012423e-01 3 1  ON 50
ci_0002                 7.001991e-01 3 1  ON 51
ci_0003                -2.789788e-02 3 1  ON 52
ci_0004                -2.733809e-02 3 1  ON 53
ci_0005                -3.691436e-02 3 1  ON 54
ci_0006                -3.734928e-02 3 1  ON 55
ci_0007                -2.320139e-02 3 1  ON 56
ci_0008                -2.296401e-02 3 1  ON 57
ci_0009                -1.755626e-02 3 1  ON 58
ci_0010                -1.751780e-02 3 1  ON 59
ci_0011                -1.206677e-02 3 1  ON 60
ci_0012                -1.217337e-02 3 1  ON 61
ci_0013                 1.316374e-02 3 1  ON 62
ci_0014                 1.321957e-02 3 1  ON 63
ci_0015                 1.313142e-02 3 1  ON 64
ci_0016                 1.270858e-02 3 1  ON 65
ci_0017                 1.124364e-02 3 1  ON 66
ci_0018                 1.161013e-02 3 1  ON 67
ci_0019                 1.173854e-02 3 1  ON 68
ci_0020                 1.106045e-02 3 1  ON 69
ci_0021                 9.754126e-04 3 1  ON 70
ci_0022                 9.170327e-04 3 1  ON 71
ci_0023                -1.133082e-02 3 1  ON 72
ci_0024                -1.089284e-02 3 1  ON 73
ci_0025                -1.077714e-02 3 1  ON 74
ci_0026                -1.107139e-02 3 1  ON 75
ci_0027                -1.099035e-02 3 1  ON 76
ci_0028                -1.114265e-02 3 1  ON 77
ci_0029                -1.059051e-02 3 1  ON 78
ci_0030                -1.047234e-02 3 1  ON 79
ci_0031                 1.977021e-02 3 1  ON 80
ci_0032                 2.112736e-02 3 1  ON 81
ci_0033                 9.758905e-03 3 1  ON 82
ci_0034                 1.060202e-02 3 1  ON 83
ci_0035                 7.403864e-03 3 1  ON 84
ci_0036                 7.293494e-03 3 1  ON 85
ci_0037                -9.574229e-03 3 1  ON 86
ci_0038                -1.190191e-02 3 1  ON 87
ci_0039                -2.746633e-03 3 1  ON 88
ci_0040                -2.677460e-03 3 1  ON 89
ci_0041                 6.838782e-03 3 1  ON 90
ci_0042                 7.370488e-03 3 1  ON 91
ci_0043                -1.811488e-02 3 1  ON 92
ci_0044                -1.805230e-02 3 1  ON 93
ci_0045                 8.389307e-03 3 1  ON 94
ci_0046                 7.819031e-03 3 1  ON 95
ci_0047                -2.243079e-03 3 1  ON 96
ci_0048                -1.738906e-03 3 1  ON 97
ci_0049                -5.898444e-03 3 1  ON 98
ci_0050                -5.407043e-03 3 1  ON 99
ci_0051                -3.572680e-03 3 1  ON 100
ci_0052                -3.233879e-03 3 1  ON 101
ci_0053                -4.945028e-03 3 1  ON 102
ci_0054                -5.027205e-03 3 1  ON 103
ci_0055                 7.549925e-03 3 1  ON 104
ci_0056                 6.511987e-03 3 1  ON 105
ci_0057                 5.224300e-03 3 1  ON 106
ci_0058                 5.279234e-03 3 1  ON 107
ci_0059                -4.767449e-03 3 1  ON 108
ci_0060                -4.862806e-03 3 1  ON 109
ci_0061                -4.249985e-03 3 1  ON 110
ci_0062                -3.789931e-03 3 1  ON 111
ci_0063                -8.431300e-03 3 1  ON 112
ci_0064                -8.948438e-03 3 1  ON 113
ci_0065                -5.087821e-03 3 1  ON 114
ci_0066                -5.164700e-03 3 1  ON 115
ci_0067                -4.820361e-03 3 1  ON 116
ci_0068                -5.138530e-03 3 1  ON 117
ci_0069                 4.499268e-03 3 1  ON 118
ci_0070                 4.459692e-03 3 1  ON 119
ci_0071                 8.835051e-04 3 1  ON 120
ci_0072                 8.875523e-04 3 1  ON 121
ci_0073                 4.428331e-03 3 1  ON 122
ci_0074                 4.567752e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8203e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6889e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.7965
    reference variance = 0.386861
====================================================
  Execution time = 2.1242e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4270e-01
  Total weights = 1.951538567e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1256e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323905953630
                                         uncertainty =       0.002227555005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323905953630
                                         uncertainty =       0.002227555005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402433116
  error estimate for blocks of size 2^( 2) =       0.000415675624
  error estimate for blocks of size 2^( 3) =       0.000428827824
  error estimate for blocks of size 2^( 4) =       0.000440999627
  error estimate for blocks of size 2^( 5) =       0.000452050468
  error estimate for blocks of size 2^( 6) =       0.000459355794
  error estimate for blocks of size 2^( 7) =       0.000464834091

      target function =                  N/A
              le_mean =     -16.907020132716
             les_mean =     286.190034344711
             stat err =       0.000454309995
             autocorr =       1.274433446608
              std dev =       0.569126370192
             le_variance =       0.323904825248


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690702013272e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907020132738       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907031887457       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907030639573       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907031302299       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907032998425       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907034246635       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907034897959       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907035313886       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907034954876       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907034747329       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.907034756827       residual = 8.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e-01 is 5.782635e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907020132738       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907023788248       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907023431032       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907023621493       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907024236854       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907024549386       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907024708304       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907024808168       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907024730246       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907024703927       residual = 7.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e+00 is 1.792095e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907020132738       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907021105965       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907021013496       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907021064965       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907021231793       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907021312605       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907021350060       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907021378314       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907021361584       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907021356214       residual = 5.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e+00 is 4.776386e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.309347 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7376e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
   uu_0                 3.094744e-01 1 1  ON 0
   uu_1                 1.426044e-01 1 1  ON 1
   uu_2                 4.158660e-02 1 1  ON 2
   uu_3                -1.963805e-02 1 1  ON 3
   uu_4                -6.373683e-02 1 1  ON 4
   uu_5                -9.713811e-02 1 1  ON 5
   uu_6                -1.232897e-01 1 1  ON 6
   uu_7                -1.354948e-01 1 1  ON 7
   uu_8                -1.267270e-01 1 1  ON 8
   uu_9                -9.573913e-02 1 1  ON 9
   ud_0                 4.416536e-01 1 1  ON 10
   ud_1                 1.765510e-01 1 1  ON 11
   ud_2                 5.738162e-02 1 1  ON 12
   ud_3                -1.209574e-02 1 1  ON 13
   ud_4                -6.706437e-02 1 1  ON 14
   ud_5                -1.068153e-01 1 1  ON 15
   ud_6                -1.324281e-01 1 1  ON 16
   ud_7                -1.474361e-01 1 1  ON 17
   ud_8                -1.475971e-01 1 1  ON 18
   ud_9                -1.362749e-01 1 1  ON 19
   eO_0                -7.398401e-01 1 1  ON 20
   eO_1                -4.219797e-01 1 1  ON 21
   eO_2                -1.662266e-02 1 1  ON 22
   eO_3                 2.881259e-01 1 1  ON 23
   eO_4                 5.043245e-01 1 1  ON 24
   eO_5                 4.630066e-01 1 1  ON 25
   eO_6                 2.385711e-01 1 1  ON 26
   eO_7                -5.371352e-02 1 1  ON 27
   eO_8                -2.019450e-01 1 1  ON 28
   eO_9                -6.229871e-02 1 1  ON 29
  eH1_0                -2.383745e-01 1 1  ON 30
  eH1_1                -1.349494e-01 1 1  ON 31
  eH1_2                -8.617290e-02 1 1  ON 32
  eH1_3                -3.274485e-02 1 1  ON 33
  eH1_4                 1.537441e-02 1 1  ON 34
  eH1_5                 4.784036e-02 1 1  ON 35
  eH1_6                 9.876244e-02 1 1  ON 36
  eH1_7                 1.423406e-01 1 1  ON 37
  eH1_8                 1.529073e-01 1 1  ON 38
  eH1_9                 3.943234e-02 1 1  ON 39
  eH2_0                -2.371206e-01 1 1  ON 40
  eH2_1                -1.334467e-01 1 1  ON 41
  eH2_2                -8.450060e-02 1 1  ON 42
  eH2_3                -3.066807e-02 1 1  ON 43
  eH2_4                 1.820745e-02 1 1  ON 44
  eH2_5                 5.099648e-02 1 1  ON 45
  eH2_6                 1.035626e-01 1 1  ON 46
  eH2_7                 1.499565e-01 1 1  ON 47
  eH2_8                 1.598264e-01 1 1  ON 48
  eH2_9                 2.127663e-02 1 1  ON 49
ci_0001                 7.012327e-01 3 1  ON 50
ci_0002                 7.002134e-01 3 1  ON 51
ci_0003                -2.786469e-02 3 1  ON 52
ci_0004                -2.732278e-02 3 1  ON 53
ci_0005                -3.692446e-02 3 1  ON 54
ci_0006                -3.742162e-02 3 1  ON 55
ci_0007                -2.313188e-02 3 1  ON 56
ci_0008                -2.288222e-02 3 1  ON 57
ci_0009                -1.756703e-02 3 1  ON 58
ci_0010                -1.740950e-02 3 1  ON 59
ci_0011                -1.199981e-02 3 1  ON 60
ci_0012                -1.213017e-02 3 1  ON 61
ci_0013                 1.312693e-02 3 1  ON 62
ci_0014                 1.331219e-02 3 1  ON 63
ci_0015                 1.314427e-02 3 1  ON 64
ci_0016                 1.283559e-02 3 1  ON 65
ci_0017                 1.124353e-02 3 1  ON 66
ci_0018                 1.148237e-02 3 1  ON 67
ci_0019                 1.174406e-02 3 1  ON 68
ci_0020                 1.116039e-02 3 1  ON 69
ci_0021                 9.089692e-04 3 1  ON 70
ci_0022                 8.580471e-04 3 1  ON 71
ci_0023                -1.126926e-02 3 1  ON 72
ci_0024                -1.091074e-02 3 1  ON 73
ci_0025                -1.074806e-02 3 1  ON 74
ci_0026                -1.121173e-02 3 1  ON 75
ci_0027                -1.097653e-02 3 1  ON 76
ci_0028                -1.115176e-02 3 1  ON 77
ci_0029                -1.052484e-02 3 1  ON 78
ci_0030                -1.046645e-02 3 1  ON 79
ci_0031                 1.975873e-02 3 1  ON 80
ci_0032                 2.120481e-02 3 1  ON 81
ci_0033                 9.887526e-03 3 1  ON 82
ci_0034                 1.056417e-02 3 1  ON 83
ci_0035                 7.385455e-03 3 1  ON 84
ci_0036                 7.306591e-03 3 1  ON 85
ci_0037                -9.676360e-03 3 1  ON 86
ci_0038                -1.184174e-02 3 1  ON 87
ci_0039                -2.755706e-03 3 1  ON 88
ci_0040                -2.631016e-03 3 1  ON 89
ci_0041                 6.875305e-03 3 1  ON 90
ci_0042                 7.428448e-03 3 1  ON 91
ci_0043                -1.812340e-02 3 1  ON 92
ci_0044                -1.811147e-02 3 1  ON 93
ci_0045                 8.304988e-03 3 1  ON 94
ci_0046                 7.825548e-03 3 1  ON 95
ci_0047                -2.150196e-03 3 1  ON 96
ci_0048                -1.684554e-03 3 1  ON 97
ci_0049                -5.883822e-03 3 1  ON 98
ci_0050                -5.227834e-03 3 1  ON 99
ci_0051                -3.527270e-03 3 1  ON 100
ci_0052                -3.198040e-03 3 1  ON 101
ci_0053                -4.976761e-03 3 1  ON 102
ci_0054                -4.896417e-03 3 1  ON 103
ci_0055                 7.410435e-03 3 1  ON 104
ci_0056                 6.504539e-03 3 1  ON 105
ci_0057                 5.224806e-03 3 1  ON 106
ci_0058                 5.228765e-03 3 1  ON 107
ci_0059                -4.769096e-03 3 1  ON 108
ci_0060                -4.876755e-03 3 1  ON 109
ci_0061                -4.225145e-03 3 1  ON 110
ci_0062                -3.777706e-03 3 1  ON 111
ci_0063                -8.448845e-03 3 1  ON 112
ci_0064                -8.934789e-03 3 1  ON 113
ci_0065                -5.054640e-03 3 1  ON 114
ci_0066                -5.233842e-03 3 1  ON 115
ci_0067                -4.811313e-03 3 1  ON 116
ci_0068                -5.082107e-03 3 1  ON 117
ci_0069                 4.457447e-03 3 1  ON 118
ci_0070                 4.514308e-03 3 1  ON 119
ci_0071                 8.549756e-04 3 1  ON 120
ci_0072                 9.828640e-04 3 1  ON 121
ci_0073                 4.341461e-03 3 1  ON 122
ci_0074                 4.537693e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.873
    reference variance = 0.295689
====================================================
  Execution time = 2.0904e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3704e-01
  Total weights = 1.9515e+06
  Execution time = 1.9537e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323898581804
                                         uncertainty =       0.002272457300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323898581804
                                         uncertainty =       0.002272457300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402408711
  error estimate for blocks of size 2^( 2) =       0.000415399305
  error estimate for blocks of size 2^( 3) =       0.000428529280
  error estimate for blocks of size 2^( 4) =       0.000441828520
  error estimate for blocks of size 2^( 5) =       0.000452606793
  error estimate for blocks of size 2^( 6) =       0.000461834797
  error estimate for blocks of size 2^( 7) =       0.000467347040

      target function =                  N/A
              le_mean =     -16.906653530794
             les_mean =     286.173746721514
             stat err =       0.000455904287
             autocorr =       1.283549454422
              std dev =       0.569091856448
             le_variance =       0.323865541076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323983923847
                                         uncertainty =       0.002282131574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323983923847
                                         uncertainty =       0.002282131574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402461180
  error estimate for blocks of size 2^( 2) =       0.000415457397
  error estimate for blocks of size 2^( 3) =       0.000428594864
  error estimate for blocks of size 2^( 4) =       0.000441890669
  error estimate for blocks of size 2^( 5) =       0.000452664190
  error estimate for blocks of size 2^( 6) =       0.000461914071
  error estimate for blocks of size 2^( 7) =       0.000467410966

      target function =                  N/A
              le_mean =     -16.906656630820
             les_mean =     286.174788179236
             stat err =       0.000455969974
             autocorr =       1.283584601212
              std dev =       0.569166058636
             le_variance =       0.323950002304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323932104812
                                         uncertainty =       0.002278346944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323932104812
                                         uncertainty =       0.002278346944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402429211
  error estimate for blocks of size 2^( 2) =       0.000415424026
  error estimate for blocks of size 2^( 3) =       0.000428560098
  error estimate for blocks of size 2^( 4) =       0.000441858228
  error estimate for blocks of size 2^( 5) =       0.000452632520
  error estimate for blocks of size 2^( 6) =       0.000461875216
  error estimate for blocks of size 2^( 7) =       0.000467377668

      target function =                  N/A
              le_mean =     -16.906654473769
             les_mean =     286.172025883201
             stat err =       0.000455935908
             autocorr =       1.283596727255
              std dev =       0.569120847571
             le_variance =       0.323898539140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323903068831
                                         uncertainty =       0.002272981004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323903068831
                                         uncertainty =       0.002272981004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402411451
  error estimate for blocks of size 2^( 2) =       0.000415401634
  error estimate for blocks of size 2^( 3) =       0.000428531716
  error estimate for blocks of size 2^( 4) =       0.000441829715
  error estimate for blocks of size 2^( 5) =       0.000452607179
  error estimate for blocks of size 2^( 6) =       0.000461837261
  error estimate for blocks of size 2^( 7) =       0.000467326834

      target function =                  N/A
              le_mean =     -16.906654997941
             les_mean =     286.302255309306
             stat err =       0.000455900247
             autocorr =       1.283509223225
              std dev =       0.569095732215
             le_variance =       0.323869952426


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906653530794        initial
     6.1035e-01     6.1035e+00             5.7826e-04       -16.906656630820  <--
     2.4414e+00     2.4414e+01             1.7921e-04       -16.906654473769
     9.7656e+00     9.7656e+01             4.7764e-05       -16.906654997941

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 3.0557e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
   uu_0                 3.094999e-01 1 1  ON 0
   uu_1                 1.426924e-01 1 1  ON 1
   uu_2                 4.166067e-02 1 1  ON 2
   uu_3                -1.962464e-02 1 1  ON 3
   uu_4                -6.378160e-02 1 1  ON 4
   uu_5                -9.709061e-02 1 1  ON 5
   uu_6                -1.232103e-01 1 1  ON 6
   uu_7                -1.355240e-01 1 1  ON 7
   uu_8                -1.268750e-01 1 1  ON 8
   uu_9                -9.597462e-02 1 1  ON 9
   ud_0                 4.419901e-01 1 1  ON 10
   ud_1                 1.767793e-01 1 1  ON 11
   ud_2                 5.750617e-02 1 1  ON 12
   ud_3                -1.206631e-02 1 1  ON 13
   ud_4                -6.710370e-02 1 1  ON 14
   ud_5                -1.069132e-01 1 1  ON 15
   ud_6                -1.324854e-01 1 1  ON 16
   ud_7                -1.474755e-01 1 1  ON 17
   ud_8                -1.478463e-01 1 1  ON 18
   ud_9                -1.364284e-01 1 1  ON 19
   eO_0                -7.401805e-01 1 1  ON 20
   eO_1                -4.221634e-01 1 1  ON 21
   eO_2                -1.657394e-02 1 1  ON 22
   eO_3                 2.882866e-01 1 1  ON 23
   eO_4                 5.046390e-01 1 1  ON 24
   eO_5                 4.632180e-01 1 1  ON 25
   eO_6                 2.386843e-01 1 1  ON 26
   eO_7                -5.356962e-02 1 1  ON 27
   eO_8                -2.021947e-01 1 1  ON 28
   eO_9                -6.249141e-02 1 1  ON 29
  eH1_0                -2.387608e-01 1 1  ON 30
  eH1_1                -1.350421e-01 1 1  ON 31
  eH1_2                -8.631251e-02 1 1  ON 32
  eH1_3                -3.268456e-02 1 1  ON 33
  eH1_4                 1.541429e-02 1 1  ON 34
  eH1_5                 4.785893e-02 1 1  ON 35
  eH1_6                 9.875470e-02 1 1  ON 36
  eH1_7                 1.425039e-01 1 1  ON 37
  eH1_8                 1.531453e-01 1 1  ON 38
  eH1_9                 3.958554e-02 1 1  ON 39
  eH2_0                -2.374271e-01 1 1  ON 40
  eH2_1                -1.335314e-01 1 1  ON 41
  eH2_2                -8.467962e-02 1 1  ON 42
  eH2_3                -3.066798e-02 1 1  ON 43
  eH2_4                 1.802693e-02 1 1  ON 44
  eH2_5                 5.102230e-02 1 1  ON 45
  eH2_6                 1.036967e-01 1 1  ON 46
  eH2_7                 1.500296e-01 1 1  ON 47
  eH2_8                 1.600530e-01 1 1  ON 48
  eH2_9                 2.156523e-02 1 1  ON 49
ci_0001                 7.011928e-01 3 1  ON 50
ci_0002                 7.002632e-01 3 1  ON 51
ci_0003                -2.778685e-02 3 1  ON 52
ci_0004                -2.728225e-02 3 1  ON 53
ci_0005                -3.694754e-02 3 1  ON 54
ci_0006                -3.760223e-02 3 1  ON 55
ci_0007                -2.295055e-02 3 1  ON 56
ci_0008                -2.267321e-02 3 1  ON 57
ci_0009                -1.759207e-02 3 1  ON 58
ci_0010                -1.717721e-02 3 1  ON 59
ci_0011                -1.185002e-02 3 1  ON 60
ci_0012                -1.203093e-02 3 1  ON 61
ci_0013                 1.304662e-02 3 1  ON 62
ci_0014                 1.351730e-02 3 1  ON 63
ci_0015                 1.317515e-02 3 1  ON 64
ci_0016                 1.311821e-02 3 1  ON 65
ci_0017                 1.124467e-02 3 1  ON 66
ci_0018                 1.120197e-02 3 1  ON 67
ci_0019                 1.175758e-02 3 1  ON 68
ci_0020                 1.138309e-02 3 1  ON 69
ci_0021                 7.315991e-04 3 1  ON 70
ci_0022                 7.081174e-04 3 1  ON 71
ci_0023                -1.113753e-02 3 1  ON 72
ci_0024                -1.094810e-02 3 1  ON 73
ci_0025                -1.068268e-02 3 1  ON 74
ci_0026                -1.152324e-02 3 1  ON 75
ci_0027                -1.094831e-02 3 1  ON 76
ci_0028                -1.116678e-02 3 1  ON 77
ci_0029                -1.037836e-02 3 1  ON 78
ci_0030                -1.044671e-02 3 1  ON 79
ci_0031                 1.972170e-02 3 1  ON 80
ci_0032                 2.139792e-02 3 1  ON 81
ci_0033                 1.020926e-02 3 1  ON 82
ci_0034                 1.046449e-02 3 1  ON 83
ci_0035                 7.342817e-03 3 1  ON 84
ci_0036                 7.341742e-03 3 1  ON 85
ci_0037                -9.915947e-03 3 1  ON 86
ci_0038                -1.170132e-02 3 1  ON 87
ci_0039                -2.771610e-03 3 1  ON 88
ci_0040                -2.541766e-03 3 1  ON 89
ci_0041                 6.955855e-03 3 1  ON 90
ci_0042                 7.556642e-03 3 1  ON 91
ci_0043                -1.814668e-02 3 1  ON 92
ci_0044                -1.826216e-02 3 1  ON 93
ci_0045                 8.102738e-03 3 1  ON 94
ci_0046                 7.843197e-03 3 1  ON 95
ci_0047                -1.970557e-03 3 1  ON 96
ci_0048                -1.579101e-03 3 1  ON 97
ci_0049                -5.852816e-03 3 1  ON 98
ci_0050                -4.828780e-03 3 1  ON 99
ci_0051                -3.435677e-03 3 1  ON 100
ci_0052                -3.121187e-03 3 1  ON 101
ci_0053                -5.038622e-03 3 1  ON 102
ci_0054                -4.635852e-03 3 1  ON 103
ci_0055                 7.078036e-03 3 1  ON 104
ci_0056                 6.486832e-03 3 1  ON 105
ci_0057                 5.228677e-03 3 1  ON 106
ci_0058                 5.110710e-03 3 1  ON 107
ci_0059                -4.772135e-03 3 1  ON 108
ci_0060                -4.902039e-03 3 1  ON 109
ci_0061                -4.164905e-03 3 1  ON 110
ci_0062                -3.750639e-03 3 1  ON 111
ci_0063                -8.482722e-03 3 1  ON 112
ci_0064                -8.904309e-03 3 1  ON 113
ci_0065                -4.983058e-03 3 1  ON 114
ci_0066                -5.381828e-03 3 1  ON 115
ci_0067                -4.792396e-03 3 1  ON 116
ci_0068                -4.976186e-03 3 1  ON 117
ci_0069                 4.378027e-03 3 1  ON 118
ci_0070                 4.621400e-03 3 1  ON 119
ci_0071                 7.882806e-04 3 1  ON 120
ci_0072                 1.187243e-03 3 1  ON 121
ci_0073                 4.172995e-03 3 1  ON 122
ci_0074                 4.482494e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7939e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6885e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.897
    reference variance = 0.192012
====================================================
  Execution time = 2.1199e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3534e-01
  Total weights = 1.951904828e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1543e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319797382405
                                         uncertainty =       0.003093874234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319797382405
                                         uncertainty =       0.003093874234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399904992
  error estimate for blocks of size 2^( 2) =       0.000412662238
  error estimate for blocks of size 2^( 3) =       0.000425358801
  error estimate for blocks of size 2^( 4) =       0.000437328898
  error estimate for blocks of size 2^( 5) =       0.000447777238
  error estimate for blocks of size 2^( 6) =       0.000453899207
  error estimate for blocks of size 2^( 7) =       0.000460015929

      target function =                  N/A
              le_mean =     -16.905678965294
             les_mean =     286.137325032074
             stat err =       0.000449755318
             autocorr =       1.264849823117
              std dev =       0.565551062935
             le_variance =       0.319848004787


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690567896529e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905678965266       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905692154012       residual = 5.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905688947832       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905692873461       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905693649190       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905695511234       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905697903874       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905696111521       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905696757907       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905696097970       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905696575341       residual = 7.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905696421779       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905696638896       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905696634520       residual = 8.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e-01 is 2.160792e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905678965266       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905684681513       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905683233339       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905683358400       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905684893313       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905684269348       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905685046639       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905684875724       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905684740196       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905684688567       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905684790577       residual = 6.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e-01 is 6.270400e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905678965266       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905680715318       residual = 6.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905680260170       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905680106106       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905680513067       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905680444992       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905680602720       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905680540411       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905680506640       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905680508823       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e+00 is 1.775850e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.314571 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7362e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
   uu_0                 3.097515e-01 1 1  ON 0
   uu_1                 1.427945e-01 1 1  ON 1
   uu_2                 4.173181e-02 1 1  ON 2
   uu_3                -1.964182e-02 1 1  ON 3
   uu_4                -6.378338e-02 1 1  ON 4
   uu_5                -9.709483e-02 1 1  ON 5
   uu_6                -1.233692e-01 1 1  ON 6
   uu_7                -1.356826e-01 1 1  ON 7
   uu_8                -1.270290e-01 1 1  ON 8
   uu_9                -9.611714e-02 1 1  ON 9
   ud_0                 4.422927e-01 1 1  ON 10
   ud_1                 1.769953e-01 1 1  ON 11
   ud_2                 5.757217e-02 1 1  ON 12
   ud_3                -1.200037e-02 1 1  ON 13
   ud_4                -6.706998e-02 1 1  ON 14
   ud_5                -1.069963e-01 1 1  ON 15
   ud_6                -1.326704e-01 1 1  ON 16
   ud_7                -1.474890e-01 1 1  ON 17
   ud_8                -1.480205e-01 1 1  ON 18
   ud_9                -1.365849e-01 1 1  ON 19
   eO_0                -7.404872e-01 1 1  ON 20
   eO_1                -4.223455e-01 1 1  ON 21
   eO_2                -1.656228e-02 1 1  ON 22
   eO_3                 2.883697e-01 1 1  ON 23
   eO_4                 5.049611e-01 1 1  ON 24
   eO_5                 4.635700e-01 1 1  ON 25
   eO_6                 2.388376e-01 1 1  ON 26
   eO_7                -5.347424e-02 1 1  ON 27
   eO_8                -2.024506e-01 1 1  ON 28
   eO_9                -6.272071e-02 1 1  ON 29
  eH1_0                -2.393878e-01 1 1  ON 30
  eH1_1                -1.353814e-01 1 1  ON 31
  eH1_2                -8.642366e-02 1 1  ON 32
  eH1_3                -3.280621e-02 1 1  ON 33
  eH1_4                 1.550937e-02 1 1  ON 34
  eH1_5                 4.802202e-02 1 1  ON 35
  eH1_6                 9.897958e-02 1 1  ON 36
  eH1_7                 1.427659e-01 1 1  ON 37
  eH1_8                 1.533889e-01 1 1  ON 38
  eH1_9                 3.980717e-02 1 1  ON 39
  eH2_0                -2.378917e-01 1 1  ON 40
  eH2_1                -1.336831e-01 1 1  ON 41
  eH2_2                -8.469970e-02 1 1  ON 42
  eH2_3                -3.071064e-02 1 1  ON 43
  eH2_4                 1.802411e-02 1 1  ON 44
  eH2_5                 5.098249e-02 1 1  ON 45
  eH2_6                 1.037846e-01 1 1  ON 46
  eH2_7                 1.500217e-01 1 1  ON 47
  eH2_8                 1.602990e-01 1 1  ON 48
  eH2_9                 2.193775e-02 1 1  ON 49
ci_0001                 7.011895e-01 3 1  ON 50
ci_0002                 7.002791e-01 3 1  ON 51
ci_0003                -2.771759e-02 3 1  ON 52
ci_0004                -2.745469e-02 3 1  ON 53
ci_0005                -3.705077e-02 3 1  ON 54
ci_0006                -3.777854e-02 3 1  ON 55
ci_0007                -2.294534e-02 3 1  ON 56
ci_0008                -2.265608e-02 3 1  ON 57
ci_0009                -1.769582e-02 3 1  ON 58
ci_0010                -1.710326e-02 3 1  ON 59
ci_0011                -1.188266e-02 3 1  ON 60
ci_0012                -1.201354e-02 3 1  ON 61
ci_0013                 1.282089e-02 3 1  ON 62
ci_0014                 1.368513e-02 3 1  ON 63
ci_0015                 1.307799e-02 3 1  ON 64
ci_0016                 1.282198e-02 3 1  ON 65
ci_0017                 1.109830e-02 3 1  ON 66
ci_0018                 1.147589e-02 3 1  ON 67
ci_0019                 1.157285e-02 3 1  ON 68
ci_0020                 1.146416e-02 3 1  ON 69
ci_0021                 5.425272e-04 3 1  ON 70
ci_0022                 1.903528e-04 3 1  ON 71
ci_0023                -1.124140e-02 3 1  ON 72
ci_0024                -1.092425e-02 3 1  ON 73
ci_0025                -1.051418e-02 3 1  ON 74
ci_0026                -1.095395e-02 3 1  ON 75
ci_0027                -1.098835e-02 3 1  ON 76
ci_0028                -1.115558e-02 3 1  ON 77
ci_0029                -1.033530e-02 3 1  ON 78
ci_0030                -1.040598e-02 3 1  ON 79
ci_0031                 1.993184e-02 3 1  ON 80
ci_0032                 2.097673e-02 3 1  ON 81
ci_0033                 1.030741e-02 3 1  ON 82
ci_0034                 1.052730e-02 3 1  ON 83
ci_0035                 7.041553e-03 3 1  ON 84
ci_0036                 7.165746e-03 3 1  ON 85
ci_0037                -1.024793e-02 3 1  ON 86
ci_0038                -1.190254e-02 3 1  ON 87
ci_0039                -2.751959e-03 3 1  ON 88
ci_0040                -2.474955e-03 3 1  ON 89
ci_0041                 6.949705e-03 3 1  ON 90
ci_0042                 7.356246e-03 3 1  ON 91
ci_0043                -1.818891e-02 3 1  ON 92
ci_0044                -1.822513e-02 3 1  ON 93
ci_0045                 7.871536e-03 3 1  ON 94
ci_0046                 7.983256e-03 3 1  ON 95
ci_0047                -2.035415e-03 3 1  ON 96
ci_0048                -1.414822e-03 3 1  ON 97
ci_0049                -5.794332e-03 3 1  ON 98
ci_0050                -4.822754e-03 3 1  ON 99
ci_0051                -3.445965e-03 3 1  ON 100
ci_0052                -3.296522e-03 3 1  ON 101
ci_0053                -5.007799e-03 3 1  ON 102
ci_0054                -4.659647e-03 3 1  ON 103
ci_0055                 7.009779e-03 3 1  ON 104
ci_0056                 6.434058e-03 3 1  ON 105
ci_0057                 5.058309e-03 3 1  ON 106
ci_0058                 5.040117e-03 3 1  ON 107
ci_0059                -4.732698e-03 3 1  ON 108
ci_0060                -5.011877e-03 3 1  ON 109
ci_0061                -3.941216e-03 3 1  ON 110
ci_0062                -3.980247e-03 3 1  ON 111
ci_0063                -8.286119e-03 3 1  ON 112
ci_0064                -8.775094e-03 3 1  ON 113
ci_0065                -5.235691e-03 3 1  ON 114
ci_0066                -5.253280e-03 3 1  ON 115
ci_0067                -5.080551e-03 3 1  ON 116
ci_0068                -4.853509e-03 3 1  ON 117
ci_0069                 4.356049e-03 3 1  ON 118
ci_0070                 4.549589e-03 3 1  ON 119
ci_0071                 5.886446e-04 3 1  ON 120
ci_0072                 9.699417e-04 3 1  ON 121
ci_0073                 4.311282e-03 3 1  ON 122
ci_0074                 4.250193e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.898
    reference variance = 0.258809
====================================================
  Execution time = 2.3235e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3447e-01
  Total weights = 1.9515e+06
  Execution time = 1.8920e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322975142771
                                         uncertainty =       0.002866110397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322975142771
                                         uncertainty =       0.002866110397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401863653
  error estimate for blocks of size 2^( 2) =       0.000414943791
  error estimate for blocks of size 2^( 3) =       0.000428247519
  error estimate for blocks of size 2^( 4) =       0.000442060949
  error estimate for blocks of size 2^( 5) =       0.000454547222
  error estimate for blocks of size 2^( 6) =       0.000462468892
  error estimate for blocks of size 2^( 7) =       0.000471861757

      target function =                  N/A
              le_mean =     -16.905267892612
             les_mean =     286.126963422456
             stat err =       0.000457734705
             autocorr =       1.297389046990
              std dev =       0.568321028383
             le_variance =       0.322988791302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323130058568
                                         uncertainty =       0.002902005785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323130058568
                                         uncertainty =       0.002902005785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401960765
  error estimate for blocks of size 2^( 2) =       0.000415039090
  error estimate for blocks of size 2^( 3) =       0.000428325311
  error estimate for blocks of size 2^( 4) =       0.000442125099
  error estimate for blocks of size 2^( 5) =       0.000454630621
  error estimate for blocks of size 2^( 6) =       0.000462515242
  error estimate for blocks of size 2^( 7) =       0.000471945910

      target function =                  N/A
              le_mean =     -16.905273390802
             les_mean =     286.124026745067
             stat err =       0.000457804218
             autocorr =       1.297156128635
              std dev =       0.568458364770
             le_variance =       0.323144912477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323092183481
                                         uncertainty =       0.002908762707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323092183481
                                         uncertainty =       0.002908762707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401937174
  error estimate for blocks of size 2^( 2) =       0.000415015451
  error estimate for blocks of size 2^( 3) =       0.000428304934
  error estimate for blocks of size 2^( 4) =       0.000442109539
  error estimate for blocks of size 2^( 5) =       0.000454613538
  error estimate for blocks of size 2^( 6) =       0.000462503418
  error estimate for blocks of size 2^( 7) =       0.000471930257

      target function =                  N/A
              le_mean =     -16.905268800119
             les_mean =     286.122980270798
             stat err =       0.000457789188
             autocorr =       1.297223220194
              std dev =       0.568425002325
             le_variance =       0.323106983268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322977740327
                                         uncertainty =       0.002872807277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322977740327
                                         uncertainty =       0.002872807277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401865386
  error estimate for blocks of size 2^( 2) =       0.000414946118
  error estimate for blocks of size 2^( 3) =       0.000428248882
  error estimate for blocks of size 2^( 4) =       0.000442059880
  error estimate for blocks of size 2^( 5) =       0.000454546961
  error estimate for blocks of size 2^( 6) =       0.000462462381
  error estimate for blocks of size 2^( 7) =       0.000471851711

      target function =                  N/A
              le_mean =     -16.905267003589
             les_mean =     286.126269573184
             stat err =       0.000457730233
             autocorr =       1.297352506295
              std dev =       0.568323479706
             le_variance =       0.322991577585


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905267892612        initial
     1.5259e-01     1.5259e+00             2.1608e-03       -16.905273390802  <--
     6.1035e-01     6.1035e+00             6.2704e-04       -16.905268800119
     2.4414e+00     2.4414e+01             1.7758e-04       -16.905267003589

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 3.2833e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
   uu_0                 3.102654e-01 1 1  ON 0
   uu_1                 1.430982e-01 1 1  ON 1
   uu_2                 4.194262e-02 1 1  ON 2
   uu_3                -1.958493e-02 1 1  ON 3
   uu_4                -6.382726e-02 1 1  ON 4
   uu_5                -9.718846e-02 1 1  ON 5
   uu_6                -1.237129e-01 1 1  ON 6
   uu_7                -1.360830e-01 1 1  ON 7
   uu_8                -1.274538e-01 1 1  ON 8
   uu_9                -9.653050e-02 1 1  ON 9
   ud_0                 4.429337e-01 1 1  ON 10
   ud_1                 1.775000e-01 1 1  ON 11
   ud_2                 5.790484e-02 1 1  ON 12
   ud_3                -1.178283e-02 1 1  ON 13
   ud_4                -6.699776e-02 1 1  ON 14
   ud_5                -1.071445e-01 1 1  ON 15
   ud_6                -1.330092e-01 1 1  ON 16
   ud_7                -1.476545e-01 1 1  ON 17
   ud_8                -1.484715e-01 1 1  ON 18
   ud_9                -1.370282e-01 1 1  ON 19
   eO_0                -7.412339e-01 1 1  ON 20
   eO_1                -4.228297e-01 1 1  ON 21
   eO_2                -1.671664e-02 1 1  ON 22
   eO_3                 2.886373e-01 1 1  ON 23
   eO_4                 5.058669e-01 1 1  ON 24
   eO_5                 4.645853e-01 1 1  ON 25
   eO_6                 2.393182e-01 1 1  ON 26
   eO_7                -5.319732e-02 1 1  ON 27
   eO_8                -2.032001e-01 1 1  ON 28
   eO_9                -6.340219e-02 1 1  ON 29
  eH1_0                -2.409216e-01 1 1  ON 30
  eH1_1                -1.362002e-01 1 1  ON 31
  eH1_2                -8.691332e-02 1 1  ON 32
  eH1_3                -3.314931e-02 1 1  ON 33
  eH1_4                 1.551030e-02 1 1  ON 34
  eH1_5                 4.841528e-02 1 1  ON 35
  eH1_6                 9.961759e-02 1 1  ON 36
  eH1_7                 1.435510e-01 1 1  ON 37
  eH1_8                 1.541242e-01 1 1  ON 38
  eH1_9                 4.047203e-02 1 1  ON 39
  eH2_0                -2.389837e-01 1 1  ON 40
  eH2_1                -1.341370e-01 1 1  ON 41
  eH2_2                -8.496516e-02 1 1  ON 42
  eH2_3                -3.086045e-02 1 1  ON 43
  eH2_4                 1.788175e-02 1 1  ON 44
  eH2_5                 5.090896e-02 1 1  ON 45
  eH2_6                 1.040471e-01 1 1  ON 46
  eH2_7                 1.500324e-01 1 1  ON 47
  eH2_8                 1.610239e-01 1 1  ON 48
  eH2_9                 2.304550e-02 1 1  ON 49
ci_0001                 7.011736e-01 3 1  ON 50
ci_0002                 7.003126e-01 3 1  ON 51
ci_0003                -2.763294e-02 3 1  ON 52
ci_0004                -2.767152e-02 3 1  ON 53
ci_0005                -3.722380e-02 3 1  ON 54
ci_0006                -3.801396e-02 3 1  ON 55
ci_0007                -2.294341e-02 3 1  ON 56
ci_0008                -2.259468e-02 3 1  ON 57
ci_0009                -1.781240e-02 3 1  ON 58
ci_0010                -1.701679e-02 3 1  ON 59
ci_0011                -1.192923e-02 3 1  ON 60
ci_0012                -1.196409e-02 3 1  ON 61
ci_0013                 1.253386e-02 3 1  ON 62
ci_0014                 1.389861e-02 3 1  ON 63
ci_0015                 1.296428e-02 3 1  ON 64
ci_0016                 1.244121e-02 3 1  ON 65
ci_0017                 1.092128e-02 3 1  ON 66
ci_0018                 1.180812e-02 3 1  ON 67
ci_0019                 1.132652e-02 3 1  ON 68
ci_0020                 1.156153e-02 3 1  ON 69
ci_0021                 1.534944e-04 3 1  ON 70
ci_0022                -7.977454e-04 3 1  ON 71
ci_0023                -1.135946e-02 3 1  ON 72
ci_0024                -1.088894e-02 3 1  ON 73
ci_0025                -1.031011e-02 3 1  ON 74
ci_0026                -1.025690e-02 3 1  ON 75
ci_0027                -1.105478e-02 3 1  ON 76
ci_0028                -1.114042e-02 3 1  ON 77
ci_0029                -1.028926e-02 3 1  ON 78
ci_0030                -1.035049e-02 3 1  ON 79
ci_0031                 2.033159e-02 3 1  ON 80
ci_0032                 2.024520e-02 3 1  ON 81
ci_0033                 1.049646e-02 3 1  ON 82
ci_0034                 1.064238e-02 3 1  ON 83
ci_0035                 6.620663e-03 3 1  ON 84
ci_0036                 6.901468e-03 3 1  ON 85
ci_0037                -1.072227e-02 3 1  ON 86
ci_0038                -1.218465e-02 3 1  ON 87
ci_0039                -2.728251e-03 3 1  ON 88
ci_0040                -2.409549e-03 3 1  ON 89
ci_0041                 6.936664e-03 3 1  ON 90
ci_0042                 7.085207e-03 3 1  ON 91
ci_0043                -1.827296e-02 3 1  ON 92
ci_0044                -1.810671e-02 3 1  ON 93
ci_0045                 7.514875e-03 3 1  ON 94
ci_0046                 8.196466e-03 3 1  ON 95
ci_0047                -2.076371e-03 3 1  ON 96
ci_0048                -1.260678e-03 3 1  ON 97
ci_0049                -5.712348e-03 3 1  ON 98
ci_0050                -4.809918e-03 3 1  ON 99
ci_0051                -3.449504e-03 3 1  ON 100
ci_0052                -3.451199e-03 3 1  ON 101
ci_0053                -4.964888e-03 3 1  ON 102
ci_0054                -4.680438e-03 3 1  ON 103
ci_0055                 6.907891e-03 3 1  ON 104
ci_0056                 6.379076e-03 3 1  ON 105
ci_0057                 4.840215e-03 3 1  ON 106
ci_0058                 4.945352e-03 3 1  ON 107
ci_0059                -4.683015e-03 3 1  ON 108
ci_0060                -5.110124e-03 3 1  ON 109
ci_0061                -3.638429e-03 3 1  ON 110
ci_0062                -4.273026e-03 3 1  ON 111
ci_0063                -8.072154e-03 3 1  ON 112
ci_0064                -8.627246e-03 3 1  ON 113
ci_0065                -5.535174e-03 3 1  ON 114
ci_0066                -5.099381e-03 3 1  ON 115
ci_0067                -5.351971e-03 3 1  ON 116
ci_0068                -4.728054e-03 3 1  ON 117
ci_0069                 4.331399e-03 3 1  ON 118
ci_0070                 4.476708e-03 3 1  ON 119
ci_0071                 3.204429e-04 3 1  ON 120
ci_0072                 6.758957e-04 3 1  ON 121
ci_0073                 4.446867e-03 3 1  ON 122
ci_0074                 4.026569e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0202e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6886e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8553
    reference variance = 0.19895
====================================================
  Execution time = 2.1544e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5249e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3113e-01
  Total weights = 1.951947725e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9963e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320058032097
                                         uncertainty =       0.002572631434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320058032097
                                         uncertainty =       0.002572631434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400007429
  error estimate for blocks of size 2^( 2) =       0.000412889139
  error estimate for blocks of size 2^( 3) =       0.000426069345
  error estimate for blocks of size 2^( 4) =       0.000437910008
  error estimate for blocks of size 2^( 5) =       0.000447521334
  error estimate for blocks of size 2^( 6) =       0.000454596634
  error estimate for blocks of size 2^( 7) =       0.000458720598

      target function =                  N/A
              le_mean =     -16.906618800313
             les_mean =     286.164886663100
             stat err =       0.000449687144
             autocorr =       1.263818846090
              std dev =       0.565695931812
             le_variance =       0.320011887269


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690661880031e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906618800283       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906653780848       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906652355167       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906653812989       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906659872065       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906661284020       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906663488632       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906670278006       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906668215570       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906671433233       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906671252283       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906671527336       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906671350725       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906673646162       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906673451570       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906673970347       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906674759676       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906674638376       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906675064472       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906674722213       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906674637078       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906674495021       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e-02 is 5.714174e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906618800283       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906642202075       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906641065537       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906640530388       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906643063613       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906643900008       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906644458923       residual = 8.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906645995192       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906645150934       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906645913942       residual = 9.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906645767403       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906645891931       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906645916454       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906646059095       residual = 6.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e-01 is 1.470032e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906618800283       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906628869761       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906628513185       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906628157287       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906628906928       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906628743476       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906629136821       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906629250956       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906629397158       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906629285712       residual = 9.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e-01 is 4.137696e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.324333 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7554e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
   uu_0                 3.107745e-01 1 1  ON 0
   uu_1                 1.435398e-01 1 1  ON 1
   uu_2                 4.232139e-02 1 1  ON 2
   uu_3                -1.935656e-02 1 1  ON 3
   uu_4                -6.378977e-02 1 1  ON 4
   uu_5                -9.752669e-02 1 1  ON 5
   uu_6                -1.241437e-01 1 1  ON 6
   uu_7                -1.364008e-01 1 1  ON 7
   uu_8                -1.283642e-01 1 1  ON 8
   uu_9                -9.733358e-02 1 1  ON 9
   ud_0                 4.436821e-01 1 1  ON 10
   ud_1                 1.781675e-01 1 1  ON 11
   ud_2                 5.873965e-02 1 1  ON 12
   ud_3                -1.130127e-02 1 1  ON 13
   ud_4                -6.702154e-02 1 1  ON 14
   ud_5                -1.072115e-01 1 1  ON 15
   ud_6                -1.332545e-01 1 1  ON 16
   ud_7                -1.480832e-01 1 1  ON 17
   ud_8                -1.492817e-01 1 1  ON 18
   ud_9                -1.380604e-01 1 1  ON 19
   eO_0                -7.417293e-01 1 1  ON 20
   eO_1                -4.233698e-01 1 1  ON 21
   eO_2                -1.698303e-02 1 1  ON 22
   eO_3                 2.889014e-01 1 1  ON 23
   eO_4                 5.070653e-01 1 1  ON 24
   eO_5                 4.656058e-01 1 1  ON 25
   eO_6                 2.401793e-01 1 1  ON 26
   eO_7                -5.268837e-02 1 1  ON 27
   eO_8                -2.046023e-01 1 1  ON 28
   eO_9                -6.446015e-02 1 1  ON 29
  eH1_0                -2.423916e-01 1 1  ON 30
  eH1_1                -1.369055e-01 1 1  ON 31
  eH1_2                -8.777811e-02 1 1  ON 32
  eH1_3                -3.343484e-02 1 1  ON 33
  eH1_4                 1.513974e-02 1 1  ON 34
  eH1_5                 4.857669e-02 1 1  ON 35
  eH1_6                 9.959618e-02 1 1  ON 36
  eH1_7                 1.447481e-01 1 1  ON 37
  eH1_8                 1.555840e-01 1 1  ON 38
  eH1_9                 4.141352e-02 1 1  ON 39
  eH2_0                -2.399191e-01 1 1  ON 40
  eH2_1                -1.346851e-01 1 1  ON 41
  eH2_2                -8.566999e-02 1 1  ON 42
  eH2_3                -3.132733e-02 1 1  ON 43
  eH2_4                 1.768227e-02 1 1  ON 44
  eH2_5                 5.107091e-02 1 1  ON 45
  eH2_6                 1.041676e-01 1 1  ON 46
  eH2_7                 1.502125e-01 1 1  ON 47
  eH2_8                 1.621223e-01 1 1  ON 48
  eH2_9                 2.440688e-02 1 1  ON 49
ci_0001                 7.012738e-01 3 1  ON 50
ci_0002                 7.002273e-01 3 1  ON 51
ci_0003                -2.760066e-02 3 1  ON 52
ci_0004                -2.761077e-02 3 1  ON 53
ci_0005                -3.679705e-02 3 1  ON 54
ci_0006                -3.747505e-02 3 1  ON 55
ci_0007                -2.265292e-02 3 1  ON 56
ci_0008                -2.164667e-02 3 1  ON 57
ci_0009                -1.772321e-02 3 1  ON 58
ci_0010                -1.750014e-02 3 1  ON 59
ci_0011                -1.183958e-02 3 1  ON 60
ci_0012                -1.216315e-02 3 1  ON 61
ci_0013                 1.297461e-02 3 1  ON 62
ci_0014                 1.361423e-02 3 1  ON 63
ci_0015                 1.274943e-02 3 1  ON 64
ci_0016                 1.298208e-02 3 1  ON 65
ci_0017                 1.131112e-02 3 1  ON 66
ci_0018                 1.133850e-02 3 1  ON 67
ci_0019                 1.070955e-02 3 1  ON 68
ci_0020                 1.173422e-02 3 1  ON 69
ci_0021                -5.187375e-04 3 1  ON 70
ci_0022                -6.925163e-04 3 1  ON 71
ci_0023                -1.143466e-02 3 1  ON 72
ci_0024                -1.110260e-02 3 1  ON 73
ci_0025                -1.067408e-02 3 1  ON 74
ci_0026                -1.083582e-02 3 1  ON 75
ci_0027                -1.130212e-02 3 1  ON 76
ci_0028                -1.143242e-02 3 1  ON 77
ci_0029                -1.043835e-02 3 1  ON 78
ci_0030                -1.047951e-02 3 1  ON 79
ci_0031                 2.031757e-02 3 1  ON 80
ci_0032                 2.002503e-02 3 1  ON 81
ci_0033                 1.028002e-02 3 1  ON 82
ci_0034                 1.102528e-02 3 1  ON 83
ci_0035                 7.168735e-03 3 1  ON 84
ci_0036                 7.531953e-03 3 1  ON 85
ci_0037                -1.068765e-02 3 1  ON 86
ci_0038                -1.119655e-02 3 1  ON 87
ci_0039                -2.763100e-03 3 1  ON 88
ci_0040                -2.767723e-03 3 1  ON 89
ci_0041                 6.938709e-03 3 1  ON 90
ci_0042                 7.304159e-03 3 1  ON 91
ci_0043                -1.888483e-02 3 1  ON 92
ci_0044                -1.916683e-02 3 1  ON 93
ci_0045                 7.613503e-03 3 1  ON 94
ci_0046                 8.021711e-03 3 1  ON 95
ci_0047                -1.990776e-03 3 1  ON 96
ci_0048                -1.594531e-03 3 1  ON 97
ci_0049                -6.000965e-03 3 1  ON 98
ci_0050                -5.399645e-03 3 1  ON 99
ci_0051                -3.504446e-03 3 1  ON 100
ci_0052                -3.647973e-03 3 1  ON 101
ci_0053                -5.329121e-03 3 1  ON 102
ci_0054                -4.530235e-03 3 1  ON 103
ci_0055                 6.431684e-03 3 1  ON 104
ci_0056                 6.475260e-03 3 1  ON 105
ci_0057                 5.210935e-03 3 1  ON 106
ci_0058                 4.752306e-03 3 1  ON 107
ci_0059                -4.794431e-03 3 1  ON 108
ci_0060                -4.827936e-03 3 1  ON 109
ci_0061                -4.030739e-03 3 1  ON 110
ci_0062                -4.203617e-03 3 1  ON 111
ci_0063                -8.513969e-03 3 1  ON 112
ci_0064                -8.544120e-03 3 1  ON 113
ci_0065                -5.203597e-03 3 1  ON 114
ci_0066                -5.194845e-03 3 1  ON 115
ci_0067                -4.984856e-03 3 1  ON 116
ci_0068                -4.216841e-03 3 1  ON 117
ci_0069                 4.112422e-03 3 1  ON 118
ci_0070                 4.325085e-03 3 1  ON 119
ci_0071                 1.103014e-03 3 1  ON 120
ci_0072                 2.898874e-04 3 1  ON 121
ci_0073                 4.719282e-03 3 1  ON 122
ci_0074                 4.335187e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9278
    reference variance = 0.210841
====================================================
  Execution time = 2.1124e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3568e-01
  Total weights = 1.9516e+06
  Execution time = 1.8827e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324335337791
                                         uncertainty =       0.002843159044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324335337791
                                         uncertainty =       0.002843159044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402631161
  error estimate for blocks of size 2^( 2) =       0.000415897034
  error estimate for blocks of size 2^( 3) =       0.000429820738
  error estimate for blocks of size 2^( 4) =       0.000443143926
  error estimate for blocks of size 2^( 5) =       0.000455222441
  error estimate for blocks of size 2^( 6) =       0.000464113343
  error estimate for blocks of size 2^( 7) =       0.000468557683

      target function =                  N/A
              le_mean =     -16.905949233375
             les_mean =     286.154908088019
             stat err =       0.000457759348
             autocorr =       1.292586686337
              std dev =       0.569406447819
             le_variance =       0.324223702818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325094498763
                                         uncertainty =       0.002869015675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325094498763
                                         uncertainty =       0.002869015675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403102122
  error estimate for blocks of size 2^( 2) =       0.000416339362
  error estimate for blocks of size 2^( 3) =       0.000430217744
  error estimate for blocks of size 2^( 4) =       0.000443462428
  error estimate for blocks of size 2^( 5) =       0.000455476810
  error estimate for blocks of size 2^( 6) =       0.000464376366
  error estimate for blocks of size 2^( 7) =       0.000468767125

      target function =                  N/A
              le_mean =     -16.905940655850
             les_mean =     286.149415086289
             stat err =       0.000458020682
             autocorr =       1.291040929694
              std dev =       0.570072487643
             le_variance =       0.324982641167

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325245321557
                                         uncertainty =       0.002883979424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325245321557
                                         uncertainty =       0.002883979424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403195245
  error estimate for blocks of size 2^( 2) =       0.000416437163
  error estimate for blocks of size 2^( 3) =       0.000430319324
  error estimate for blocks of size 2^( 4) =       0.000443564648
  error estimate for blocks of size 2^( 5) =       0.000455585024
  error estimate for blocks of size 2^( 6) =       0.000464494250
  error estimate for blocks of size 2^( 7) =       0.000468869880

      target function =                  N/A
              le_mean =     -16.905950729104
             les_mean =     286.151619720845
             stat err =       0.000458128450
             autocorr =       1.291051962462
              std dev =       0.570204183675
             le_variance =       0.325132811080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324275287641
                                         uncertainty =       0.002837378212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324275287641
                                         uncertainty =       0.002837378212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402593913
  error estimate for blocks of size 2^( 2) =       0.000415856413
  error estimate for blocks of size 2^( 3) =       0.000429782775
  error estimate for blocks of size 2^( 4) =       0.000443094671
  error estimate for blocks of size 2^( 5) =       0.000455158182
  error estimate for blocks of size 2^( 6) =       0.000464058904
  error estimate for blocks of size 2^( 7) =       0.000468475703

      target function =                  N/A
              le_mean =     -16.905934672246
             les_mean =     286.147590963443
             stat err =       0.000457696865
             autocorr =       1.292472963117
              std dev =       0.569353772021
             le_variance =       0.324163717715


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905949233375        initial
     3.8147e-02     3.8147e-01             5.7142e-03       -16.905940655850
     1.5259e-01     1.5259e+00             1.4700e-03       -16.905950729104  <--
     6.1035e-01     6.1035e+00             4.1377e-04       -16.905934672246

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 3.0720e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
   uu_0                 3.107745e-01 1 1  ON 0
   uu_1                 1.435398e-01 1 1  ON 1
   uu_2                 4.232139e-02 1 1  ON 2
   uu_3                -1.935656e-02 1 1  ON 3
   uu_4                -6.378977e-02 1 1  ON 4
   uu_5                -9.752669e-02 1 1  ON 5
   uu_6                -1.241437e-01 1 1  ON 6
   uu_7                -1.364008e-01 1 1  ON 7
   uu_8                -1.283642e-01 1 1  ON 8
   uu_9                -9.733358e-02 1 1  ON 9
   ud_0                 4.436821e-01 1 1  ON 10
   ud_1                 1.781675e-01 1 1  ON 11
   ud_2                 5.873965e-02 1 1  ON 12
   ud_3                -1.130127e-02 1 1  ON 13
   ud_4                -6.702154e-02 1 1  ON 14
   ud_5                -1.072115e-01 1 1  ON 15
   ud_6                -1.332545e-01 1 1  ON 16
   ud_7                -1.480832e-01 1 1  ON 17
   ud_8                -1.492817e-01 1 1  ON 18
   ud_9                -1.380604e-01 1 1  ON 19
   eO_0                -7.417293e-01 1 1  ON 20
   eO_1                -4.233698e-01 1 1  ON 21
   eO_2                -1.698303e-02 1 1  ON 22
   eO_3                 2.889014e-01 1 1  ON 23
   eO_4                 5.070653e-01 1 1  ON 24
   eO_5                 4.656058e-01 1 1  ON 25
   eO_6                 2.401793e-01 1 1  ON 26
   eO_7                -5.268837e-02 1 1  ON 27
   eO_8                -2.046023e-01 1 1  ON 28
   eO_9                -6.446015e-02 1 1  ON 29
  eH1_0                -2.423916e-01 1 1  ON 30
  eH1_1                -1.369055e-01 1 1  ON 31
  eH1_2                -8.777811e-02 1 1  ON 32
  eH1_3                -3.343484e-02 1 1  ON 33
  eH1_4                 1.513974e-02 1 1  ON 34
  eH1_5                 4.857669e-02 1 1  ON 35
  eH1_6                 9.959618e-02 1 1  ON 36
  eH1_7                 1.447481e-01 1 1  ON 37
  eH1_8                 1.555840e-01 1 1  ON 38
  eH1_9                 4.141352e-02 1 1  ON 39
  eH2_0                -2.399191e-01 1 1  ON 40
  eH2_1                -1.346851e-01 1 1  ON 41
  eH2_2                -8.566999e-02 1 1  ON 42
  eH2_3                -3.132733e-02 1 1  ON 43
  eH2_4                 1.768227e-02 1 1  ON 44
  eH2_5                 5.107091e-02 1 1  ON 45
  eH2_6                 1.041676e-01 1 1  ON 46
  eH2_7                 1.502125e-01 1 1  ON 47
  eH2_8                 1.621223e-01 1 1  ON 48
  eH2_9                 2.440688e-02 1 1  ON 49
ci_0001                 7.012738e-01 3 1  ON 50
ci_0002                 7.002273e-01 3 1  ON 51
ci_0003                -2.760066e-02 3 1  ON 52
ci_0004                -2.761077e-02 3 1  ON 53
ci_0005                -3.679705e-02 3 1  ON 54
ci_0006                -3.747505e-02 3 1  ON 55
ci_0007                -2.265292e-02 3 1  ON 56
ci_0008                -2.164667e-02 3 1  ON 57
ci_0009                -1.772321e-02 3 1  ON 58
ci_0010                -1.750014e-02 3 1  ON 59
ci_0011                -1.183958e-02 3 1  ON 60
ci_0012                -1.216315e-02 3 1  ON 61
ci_0013                 1.297461e-02 3 1  ON 62
ci_0014                 1.361423e-02 3 1  ON 63
ci_0015                 1.274943e-02 3 1  ON 64
ci_0016                 1.298208e-02 3 1  ON 65
ci_0017                 1.131112e-02 3 1  ON 66
ci_0018                 1.133850e-02 3 1  ON 67
ci_0019                 1.070955e-02 3 1  ON 68
ci_0020                 1.173422e-02 3 1  ON 69
ci_0021                -5.187375e-04 3 1  ON 70
ci_0022                -6.925163e-04 3 1  ON 71
ci_0023                -1.143466e-02 3 1  ON 72
ci_0024                -1.110260e-02 3 1  ON 73
ci_0025                -1.067408e-02 3 1  ON 74
ci_0026                -1.083582e-02 3 1  ON 75
ci_0027                -1.130212e-02 3 1  ON 76
ci_0028                -1.143242e-02 3 1  ON 77
ci_0029                -1.043835e-02 3 1  ON 78
ci_0030                -1.047951e-02 3 1  ON 79
ci_0031                 2.031757e-02 3 1  ON 80
ci_0032                 2.002503e-02 3 1  ON 81
ci_0033                 1.028002e-02 3 1  ON 82
ci_0034                 1.102528e-02 3 1  ON 83
ci_0035                 7.168735e-03 3 1  ON 84
ci_0036                 7.531953e-03 3 1  ON 85
ci_0037                -1.068765e-02 3 1  ON 86
ci_0038                -1.119655e-02 3 1  ON 87
ci_0039                -2.763100e-03 3 1  ON 88
ci_0040                -2.767723e-03 3 1  ON 89
ci_0041                 6.938709e-03 3 1  ON 90
ci_0042                 7.304159e-03 3 1  ON 91
ci_0043                -1.888483e-02 3 1  ON 92
ci_0044                -1.916683e-02 3 1  ON 93
ci_0045                 7.613503e-03 3 1  ON 94
ci_0046                 8.021711e-03 3 1  ON 95
ci_0047                -1.990776e-03 3 1  ON 96
ci_0048                -1.594531e-03 3 1  ON 97
ci_0049                -6.000965e-03 3 1  ON 98
ci_0050                -5.399645e-03 3 1  ON 99
ci_0051                -3.504446e-03 3 1  ON 100
ci_0052                -3.647973e-03 3 1  ON 101
ci_0053                -5.329121e-03 3 1  ON 102
ci_0054                -4.530235e-03 3 1  ON 103
ci_0055                 6.431684e-03 3 1  ON 104
ci_0056                 6.475260e-03 3 1  ON 105
ci_0057                 5.210935e-03 3 1  ON 106
ci_0058                 4.752306e-03 3 1  ON 107
ci_0059                -4.794431e-03 3 1  ON 108
ci_0060                -4.827936e-03 3 1  ON 109
ci_0061                -4.030739e-03 3 1  ON 110
ci_0062                -4.203617e-03 3 1  ON 111
ci_0063                -8.513969e-03 3 1  ON 112
ci_0064                -8.544120e-03 3 1  ON 113
ci_0065                -5.203597e-03 3 1  ON 114
ci_0066                -5.194845e-03 3 1  ON 115
ci_0067                -4.984856e-03 3 1  ON 116
ci_0068                -4.216841e-03 3 1  ON 117
ci_0069                 4.112422e-03 3 1  ON 118
ci_0070                 4.325085e-03 3 1  ON 119
ci_0071                 1.103014e-03 3 1  ON 120
ci_0072                 2.898874e-04 3 1  ON 121
ci_0073                 4.719282e-03 3 1  ON 122
ci_0074                 4.335187e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8281e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6886e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9123
    reference variance = 0.266328
====================================================
  Execution time = 2.1430e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5215e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3279e-01
  Total weights = 1.951443964e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1246e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320756698625
                                         uncertainty =       0.001977815912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320756698625
                                         uncertainty =       0.001977815912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400637880
  error estimate for blocks of size 2^( 2) =       0.000413834058
  error estimate for blocks of size 2^( 3) =       0.000426841626
  error estimate for blocks of size 2^( 4) =       0.000439196053
  error estimate for blocks of size 2^( 5) =       0.000448689485
  error estimate for blocks of size 2^( 6) =       0.000457615942
  error estimate for blocks of size 2^( 7) =       0.000461548183

      target function =                  N/A
              le_mean =     -16.905646665849
             les_mean =     286.133676729906
             stat err =       0.000451762416
             autocorr =       1.271499452252
              std dev =       0.566587522861
             le_variance =       0.321021421062


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690564666585e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905646665825       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905659441675       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905662545901       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905659220401       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905661231043       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905664893704       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905663570522       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905663158122       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905665762717       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905663400335       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905665204310       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905665907938       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905668365277       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905666238139       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905666637087       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905666838195       residual = 8.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905667913233       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905667835103       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905667931741       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905668025689       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905668166766       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905668365241       residual = 9.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e-02 is 6.295532e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905646665825       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905655492074       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905657536390       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905655914149       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905656500177       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905657937816       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905656565672       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905657037019       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905657785321       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905657690103       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905657838499       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905658260681       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905658164481       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905657926666       residual = 8.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e-01 is 1.563826e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905646665825       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905650612129       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905651524895       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905651350469       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905651662897       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905651339066       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905650935766       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905651173406       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905651332192       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905651617661       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905651615978       residual = 6.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e-01 is 4.927723e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.334382 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7568e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
   uu_0                 3.109743e-01 1 1  ON 0
   uu_1                 1.440403e-01 1 1  ON 1
   uu_2                 4.288328e-02 1 1  ON 2
   uu_3                -1.898702e-02 1 1  ON 3
   uu_4                -6.379552e-02 1 1  ON 4
   uu_5                -9.792203e-02 1 1  ON 5
   uu_6                -1.250425e-01 1 1  ON 6
   uu_7                -1.375789e-01 1 1  ON 7
   uu_8                -1.289873e-01 1 1  ON 8
   uu_9                -9.759854e-02 1 1  ON 9
   ud_0                 4.440786e-01 1 1  ON 10
   ud_1                 1.783026e-01 1 1  ON 11
   ud_2                 5.855830e-02 1 1  ON 12
   ud_3                -1.163462e-02 1 1  ON 13
   ud_4                -6.722940e-02 1 1  ON 14
   ud_5                -1.071788e-01 1 1  ON 15
   ud_6                -1.333544e-01 1 1  ON 16
   ud_7                -1.483637e-01 1 1  ON 17
   ud_8                -1.487572e-01 1 1  ON 18
   ud_9                -1.378242e-01 1 1  ON 19
   eO_0                -7.431497e-01 1 1  ON 20
   eO_1                -4.246625e-01 1 1  ON 21
   eO_2                -1.726206e-02 1 1  ON 22
   eO_3                 2.897145e-01 1 1  ON 23
   eO_4                 5.085138e-01 1 1  ON 24
   eO_5                 4.669230e-01 1 1  ON 25
   eO_6                 2.408329e-01 1 1  ON 26
   eO_7                -5.237094e-02 1 1  ON 27
   eO_8                -2.053032e-01 1 1  ON 28
   eO_9                -6.524622e-02 1 1  ON 29
  eH1_0                -2.431867e-01 1 1  ON 30
  eH1_1                -1.371994e-01 1 1  ON 31
  eH1_2                -8.792947e-02 1 1  ON 32
  eH1_3                -3.412526e-02 1 1  ON 33
  eH1_4                 1.439995e-02 1 1  ON 34
  eH1_5                 4.701904e-02 1 1  ON 35
  eH1_6                 9.978821e-02 1 1  ON 36
  eH1_7                 1.456565e-01 1 1  ON 37
  eH1_8                 1.570894e-01 1 1  ON 38
  eH1_9                 4.296149e-02 1 1  ON 39
  eH2_0                -2.411772e-01 1 1  ON 40
  eH2_1                -1.355981e-01 1 1  ON 41
  eH2_2                -8.618088e-02 1 1  ON 42
  eH2_3                -3.201326e-02 1 1  ON 43
  eH2_4                 1.707185e-02 1 1  ON 44
  eH2_5                 5.108852e-02 1 1  ON 45
  eH2_6                 1.045669e-01 1 1  ON 46
  eH2_7                 1.508967e-01 1 1  ON 47
  eH2_8                 1.634022e-01 1 1  ON 48
  eH2_9                 2.597071e-02 1 1  ON 49
ci_0001                 7.011035e-01 3 1  ON 50
ci_0002                 7.004528e-01 3 1  ON 51
ci_0003                -2.814867e-02 3 1  ON 52
ci_0004                -2.795441e-02 3 1  ON 53
ci_0005                -3.680508e-02 3 1  ON 54
ci_0006                -3.723113e-02 3 1  ON 55
ci_0007                -2.216882e-02 3 1  ON 56
ci_0008                -2.176639e-02 3 1  ON 57
ci_0009                -1.741418e-02 3 1  ON 58
ci_0010                -1.761771e-02 3 1  ON 59
ci_0011                -1.211115e-02 3 1  ON 60
ci_0012                -1.221492e-02 3 1  ON 61
ci_0013                 1.338719e-02 3 1  ON 62
ci_0014                 1.362956e-02 3 1  ON 63
ci_0015                 1.318336e-02 3 1  ON 64
ci_0016                 1.294465e-02 3 1  ON 65
ci_0017                 1.099045e-02 3 1  ON 66
ci_0018                 1.120824e-02 3 1  ON 67
ci_0019                 1.148203e-02 3 1  ON 68
ci_0020                 1.174983e-02 3 1  ON 69
ci_0021                -4.445134e-04 3 1  ON 70
ci_0022                -7.900638e-04 3 1  ON 71
ci_0023                -1.145733e-02 3 1  ON 72
ci_0024                -1.142372e-02 3 1  ON 73
ci_0025                -1.023466e-02 3 1  ON 74
ci_0026                -1.039736e-02 3 1  ON 75
ci_0027                -1.094519e-02 3 1  ON 76
ci_0028                -1.087517e-02 3 1  ON 77
ci_0029                -1.100925e-02 3 1  ON 78
ci_0030                -1.090194e-02 3 1  ON 79
ci_0031                 2.015326e-02 3 1  ON 80
ci_0032                 1.998177e-02 3 1  ON 81
ci_0033                 9.815855e-03 3 1  ON 82
ci_0034                 1.051792e-02 3 1  ON 83
ci_0035                 6.652256e-03 3 1  ON 84
ci_0036                 6.848209e-03 3 1  ON 85
ci_0037                -1.022585e-02 3 1  ON 86
ci_0038                -1.066194e-02 3 1  ON 87
ci_0039                -2.589578e-03 3 1  ON 88
ci_0040                -2.424047e-03 3 1  ON 89
ci_0041                 7.644075e-03 3 1  ON 90
ci_0042                 7.329169e-03 3 1  ON 91
ci_0043                -1.796874e-02 3 1  ON 92
ci_0044                -1.896842e-02 3 1  ON 93
ci_0045                 7.958710e-03 3 1  ON 94
ci_0046                 7.675015e-03 3 1  ON 95
ci_0047                -1.835199e-03 3 1  ON 96
ci_0048                -1.427861e-03 3 1  ON 97
ci_0049                -5.483961e-03 3 1  ON 98
ci_0050                -6.027525e-03 3 1  ON 99
ci_0051                -3.719010e-03 3 1  ON 100
ci_0052                -3.573139e-03 3 1  ON 101
ci_0053                -5.010222e-03 3 1  ON 102
ci_0054                -4.572694e-03 3 1  ON 103
ci_0055                 6.227087e-03 3 1  ON 104
ci_0056                 6.757625e-03 3 1  ON 105
ci_0057                 5.065081e-03 3 1  ON 106
ci_0058                 4.900907e-03 3 1  ON 107
ci_0059                -4.880148e-03 3 1  ON 108
ci_0060                -4.645013e-03 3 1  ON 109
ci_0061                -3.824920e-03 3 1  ON 110
ci_0062                -3.803172e-03 3 1  ON 111
ci_0063                -8.761256e-03 3 1  ON 112
ci_0064                -8.664505e-03 3 1  ON 113
ci_0065                -5.175618e-03 3 1  ON 114
ci_0066                -5.212528e-03 3 1  ON 115
ci_0067                -4.775423e-03 3 1  ON 116
ci_0068                -4.768012e-03 3 1  ON 117
ci_0069                 4.150248e-03 3 1  ON 118
ci_0070                 4.703343e-03 3 1  ON 119
ci_0071                -3.089565e-05 3 1  ON 120
ci_0072                 6.893661e-04 3 1  ON 121
ci_0073                 4.385547e-03 3 1  ON 122
ci_0074                 3.805182e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8667
    reference variance = 0.239847
====================================================
  Execution time = 2.0930e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3789e-01
  Total weights = 1.9516e+06
  Execution time = 1.8858e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323273931242
                                         uncertainty =       0.002124165852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323273931242
                                         uncertainty =       0.002124165852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402071981
  error estimate for blocks of size 2^( 2) =       0.000415153510
  error estimate for blocks of size 2^( 3) =       0.000427988506
  error estimate for blocks of size 2^( 4) =       0.000440296692
  error estimate for blocks of size 2^( 5) =       0.000451136585
  error estimate for blocks of size 2^( 6) =       0.000458219698
  error estimate for blocks of size 2^( 7) =       0.000463932663

      target function =                  N/A
              le_mean =     -16.906312595125
             les_mean =     286.276172091002
             stat err =       0.000453396409
             autocorr =       1.271594186940
              std dev =       0.568615648437
             le_variance =       0.323323755647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323283074392
                                         uncertainty =       0.002206736942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323283074392
                                         uncertainty =       0.002206736942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402081686
  error estimate for blocks of size 2^( 2) =       0.000415117171
  error estimate for blocks of size 2^( 3) =       0.000427920796
  error estimate for blocks of size 2^( 4) =       0.000440160095
  error estimate for blocks of size 2^( 5) =       0.000450984368
  error estimate for blocks of size 2^( 6) =       0.000458028756
  error estimate for blocks of size 2^( 7) =       0.000463747831

      target function =                  N/A
              le_mean =     -16.906324621295
             les_mean =     286.186330944630
             stat err =       0.000453230263
             autocorr =       1.270601068508
              std dev =       0.568629373380
             le_variance =       0.323339364271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323261627314
                                         uncertainty =       0.002241491195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323261627314
                                         uncertainty =       0.002241491195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402068949
  error estimate for blocks of size 2^( 2) =       0.000415088851
  error estimate for blocks of size 2^( 3) =       0.000427893215
  error estimate for blocks of size 2^( 4) =       0.000440162130
  error estimate for blocks of size 2^( 5) =       0.000451019828
  error estimate for blocks of size 2^( 6) =       0.000458065139
  error estimate for blocks of size 2^( 7) =       0.000463823059

      target function =                  N/A
              le_mean =     -16.906338371083
             les_mean =     286.188882480885
             stat err =       0.000453267539
             autocorr =       1.270890598196
              std dev =       0.568611360486
             le_variance =       0.323318879274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322809162613
                                         uncertainty =       0.002118265901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322809162613
                                         uncertainty =       0.002118265901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401784427
  error estimate for blocks of size 2^( 2) =       0.000414849279
  error estimate for blocks of size 2^( 3) =       0.000427682085
  error estimate for blocks of size 2^( 4) =       0.000439979960
  error estimate for blocks of size 2^( 5) =       0.000450833274
  error estimate for blocks of size 2^( 6) =       0.000457908640
  error estimate for blocks of size 2^( 7) =       0.000463638502

      target function =                  N/A
              le_mean =     -16.906310759136
             les_mean =     286.166176176743
             stat err =       0.000453090094
             autocorr =       1.271694917910
              std dev =       0.568208985487
             le_variance =       0.322861451189


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906312595125        initial
     3.8147e-02     3.8147e-01             6.2955e-03       -16.906324621295
     1.5259e-01     1.5259e+00             1.5638e-03       -16.906338371083  <--
     6.1035e-01     6.1035e+00             4.9277e-04       -16.906310759136

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 3.0671e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
   uu_0                 3.109743e-01 1 1  ON 0
   uu_1                 1.440403e-01 1 1  ON 1
   uu_2                 4.288328e-02 1 1  ON 2
   uu_3                -1.898702e-02 1 1  ON 3
   uu_4                -6.379552e-02 1 1  ON 4
   uu_5                -9.792203e-02 1 1  ON 5
   uu_6                -1.250425e-01 1 1  ON 6
   uu_7                -1.375789e-01 1 1  ON 7
   uu_8                -1.289873e-01 1 1  ON 8
   uu_9                -9.759854e-02 1 1  ON 9
   ud_0                 4.440786e-01 1 1  ON 10
   ud_1                 1.783026e-01 1 1  ON 11
   ud_2                 5.855830e-02 1 1  ON 12
   ud_3                -1.163462e-02 1 1  ON 13
   ud_4                -6.722940e-02 1 1  ON 14
   ud_5                -1.071788e-01 1 1  ON 15
   ud_6                -1.333544e-01 1 1  ON 16
   ud_7                -1.483637e-01 1 1  ON 17
   ud_8                -1.487572e-01 1 1  ON 18
   ud_9                -1.378242e-01 1 1  ON 19
   eO_0                -7.431497e-01 1 1  ON 20
   eO_1                -4.246625e-01 1 1  ON 21
   eO_2                -1.726206e-02 1 1  ON 22
   eO_3                 2.897145e-01 1 1  ON 23
   eO_4                 5.085138e-01 1 1  ON 24
   eO_5                 4.669230e-01 1 1  ON 25
   eO_6                 2.408329e-01 1 1  ON 26
   eO_7                -5.237094e-02 1 1  ON 27
   eO_8                -2.053032e-01 1 1  ON 28
   eO_9                -6.524622e-02 1 1  ON 29
  eH1_0                -2.431867e-01 1 1  ON 30
  eH1_1                -1.371994e-01 1 1  ON 31
  eH1_2                -8.792947e-02 1 1  ON 32
  eH1_3                -3.412526e-02 1 1  ON 33
  eH1_4                 1.439995e-02 1 1  ON 34
  eH1_5                 4.701904e-02 1 1  ON 35
  eH1_6                 9.978821e-02 1 1  ON 36
  eH1_7                 1.456565e-01 1 1  ON 37
  eH1_8                 1.570894e-01 1 1  ON 38
  eH1_9                 4.296149e-02 1 1  ON 39
  eH2_0                -2.411772e-01 1 1  ON 40
  eH2_1                -1.355981e-01 1 1  ON 41
  eH2_2                -8.618088e-02 1 1  ON 42
  eH2_3                -3.201326e-02 1 1  ON 43
  eH2_4                 1.707185e-02 1 1  ON 44
  eH2_5                 5.108852e-02 1 1  ON 45
  eH2_6                 1.045669e-01 1 1  ON 46
  eH2_7                 1.508967e-01 1 1  ON 47
  eH2_8                 1.634022e-01 1 1  ON 48
  eH2_9                 2.597071e-02 1 1  ON 49
ci_0001                 7.011035e-01 3 1  ON 50
ci_0002                 7.004528e-01 3 1  ON 51
ci_0003                -2.814867e-02 3 1  ON 52
ci_0004                -2.795441e-02 3 1  ON 53
ci_0005                -3.680508e-02 3 1  ON 54
ci_0006                -3.723113e-02 3 1  ON 55
ci_0007                -2.216882e-02 3 1  ON 56
ci_0008                -2.176639e-02 3 1  ON 57
ci_0009                -1.741418e-02 3 1  ON 58
ci_0010                -1.761771e-02 3 1  ON 59
ci_0011                -1.211115e-02 3 1  ON 60
ci_0012                -1.221492e-02 3 1  ON 61
ci_0013                 1.338719e-02 3 1  ON 62
ci_0014                 1.362956e-02 3 1  ON 63
ci_0015                 1.318336e-02 3 1  ON 64
ci_0016                 1.294465e-02 3 1  ON 65
ci_0017                 1.099045e-02 3 1  ON 66
ci_0018                 1.120824e-02 3 1  ON 67
ci_0019                 1.148203e-02 3 1  ON 68
ci_0020                 1.174983e-02 3 1  ON 69
ci_0021                -4.445134e-04 3 1  ON 70
ci_0022                -7.900638e-04 3 1  ON 71
ci_0023                -1.145733e-02 3 1  ON 72
ci_0024                -1.142372e-02 3 1  ON 73
ci_0025                -1.023466e-02 3 1  ON 74
ci_0026                -1.039736e-02 3 1  ON 75
ci_0027                -1.094519e-02 3 1  ON 76
ci_0028                -1.087517e-02 3 1  ON 77
ci_0029                -1.100925e-02 3 1  ON 78
ci_0030                -1.090194e-02 3 1  ON 79
ci_0031                 2.015326e-02 3 1  ON 80
ci_0032                 1.998177e-02 3 1  ON 81
ci_0033                 9.815855e-03 3 1  ON 82
ci_0034                 1.051792e-02 3 1  ON 83
ci_0035                 6.652256e-03 3 1  ON 84
ci_0036                 6.848209e-03 3 1  ON 85
ci_0037                -1.022585e-02 3 1  ON 86
ci_0038                -1.066194e-02 3 1  ON 87
ci_0039                -2.589578e-03 3 1  ON 88
ci_0040                -2.424047e-03 3 1  ON 89
ci_0041                 7.644075e-03 3 1  ON 90
ci_0042                 7.329169e-03 3 1  ON 91
ci_0043                -1.796874e-02 3 1  ON 92
ci_0044                -1.896842e-02 3 1  ON 93
ci_0045                 7.958710e-03 3 1  ON 94
ci_0046                 7.675015e-03 3 1  ON 95
ci_0047                -1.835199e-03 3 1  ON 96
ci_0048                -1.427861e-03 3 1  ON 97
ci_0049                -5.483961e-03 3 1  ON 98
ci_0050                -6.027525e-03 3 1  ON 99
ci_0051                -3.719010e-03 3 1  ON 100
ci_0052                -3.573139e-03 3 1  ON 101
ci_0053                -5.010222e-03 3 1  ON 102
ci_0054                -4.572694e-03 3 1  ON 103
ci_0055                 6.227087e-03 3 1  ON 104
ci_0056                 6.757625e-03 3 1  ON 105
ci_0057                 5.065081e-03 3 1  ON 106
ci_0058                 4.900907e-03 3 1  ON 107
ci_0059                -4.880148e-03 3 1  ON 108
ci_0060                -4.645013e-03 3 1  ON 109
ci_0061                -3.824920e-03 3 1  ON 110
ci_0062                -3.803172e-03 3 1  ON 111
ci_0063                -8.761256e-03 3 1  ON 112
ci_0064                -8.664505e-03 3 1  ON 113
ci_0065                -5.175618e-03 3 1  ON 114
ci_0066                -5.212528e-03 3 1  ON 115
ci_0067                -4.775423e-03 3 1  ON 116
ci_0068                -4.768012e-03 3 1  ON 117
ci_0069                 4.150248e-03 3 1  ON 118
ci_0070                 4.703343e-03 3 1  ON 119
ci_0071                -3.089565e-05 3 1  ON 120
ci_0072                 6.893661e-04 3 1  ON 121
ci_0073                 4.385547e-03 3 1  ON 122
ci_0074                 3.805182e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8246e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9513
    reference variance = 0.324835
====================================================
  Execution time = 2.1239e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3392e-01
  Total weights = 1.951979298e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322215390770
                                         uncertainty =       0.002110514394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322215390770
                                         uncertainty =       0.002110514394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401382088
  error estimate for blocks of size 2^( 2) =       0.000414474621
  error estimate for blocks of size 2^( 3) =       0.000428246669
  error estimate for blocks of size 2^( 4) =       0.000440130263
  error estimate for blocks of size 2^( 5) =       0.000449982997
  error estimate for blocks of size 2^( 6) =       0.000457695475
  error estimate for blocks of size 2^( 7) =       0.000461834192

      target function =                  N/A
              le_mean =     -16.906307225982
             les_mean =     286.157146407417
             stat err =       0.000452410732
             autocorr =       1.270427306467
              std dev =       0.567639993155
             le_variance =       0.322215161830


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690630722598e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906307225975       residual = 9.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906310339072       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906311742684       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906313601899       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906315629863       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906319595162       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906321219038       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906328131832       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906325294497       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906329199212       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906328807661       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906330208220       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906330875705       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906331369543       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906330762148       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906330077962       residual = 9.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906329805563       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906330087371       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906329902718       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906329762381       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906330000738       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906330321875       residual = 7.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e-02 is 5.071628e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906307225975       residual = 9.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906309337220       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906310518129       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906311746442       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906314862112       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906315228580       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906317832611       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906317930517       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906316755403       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906317332952       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906317026669       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906317076282       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906317148297       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906317172548       residual = 5.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e-01 is 1.660621e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906307225975       residual = 9.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906308149014       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906308788071       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906309393307       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906310503359       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906310914576       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906311757623       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906311371721       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906311311253       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906311166374       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906311128817       residual = 4.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e-01 is 4.564278e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.344363 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7329e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
   uu_0                 3.115509e-01 1 1  ON 0
   uu_1                 1.445240e-01 1 1  ON 1
   uu_2                 4.305796e-02 1 1  ON 2
   uu_3                -1.898116e-02 1 1  ON 3
   uu_4                -6.406842e-02 1 1  ON 4
   uu_5                -9.840142e-02 1 1  ON 5
   uu_6                -1.251367e-01 1 1  ON 6
   uu_7                -1.377807e-01 1 1  ON 7
   uu_8                -1.298602e-01 1 1  ON 8
   uu_9                -9.831059e-02 1 1  ON 9
   ud_0                 4.445235e-01 1 1  ON 10
   ud_1                 1.788813e-01 1 1  ON 11
   ud_2                 5.903352e-02 1 1  ON 12
   ud_3                -1.122389e-02 1 1  ON 13
   ud_4                -6.703814e-02 1 1  ON 14
   ud_5                -1.069912e-01 1 1  ON 15
   ud_6                -1.336583e-01 1 1  ON 16
   ud_7                -1.483847e-01 1 1  ON 17
   ud_8                -1.493241e-01 1 1  ON 18
   ud_9                -1.386696e-01 1 1  ON 19
   eO_0                -7.441197e-01 1 1  ON 20
   eO_1                -4.248783e-01 1 1  ON 21
   eO_2                -1.730930e-02 1 1  ON 22
   eO_3                 2.900698e-01 1 1  ON 23
   eO_4                 5.090621e-01 1 1  ON 24
   eO_5                 4.680554e-01 1 1  ON 25
   eO_6                 2.416786e-01 1 1  ON 26
   eO_7                -5.188737e-02 1 1  ON 27
   eO_8                -2.063340e-01 1 1  ON 28
   eO_9                -6.620113e-02 1 1  ON 29
  eH1_0                -2.448473e-01 1 1  ON 30
  eH1_1                -1.382146e-01 1 1  ON 31
  eH1_2                -8.888628e-02 1 1  ON 32
  eH1_3                -3.481381e-02 1 1  ON 33
  eH1_4                 1.399445e-02 1 1  ON 34
  eH1_5                 4.716205e-02 1 1  ON 35
  eH1_6                 1.006263e-01 1 1  ON 36
  eH1_7                 1.468259e-01 1 1  ON 37
  eH1_8                 1.583052e-01 1 1  ON 38
  eH1_9                 4.410426e-02 1 1  ON 39
  eH2_0                -2.424562e-01 1 1  ON 40
  eH2_1                -1.362033e-01 1 1  ON 41
  eH2_2                -8.649155e-02 1 1  ON 42
  eH2_3                -3.219465e-02 1 1  ON 43
  eH2_4                 1.683859e-02 1 1  ON 44
  eH2_5                 5.070727e-02 1 1  ON 45
  eH2_6                 1.049494e-01 1 1  ON 46
  eH2_7                 1.513969e-01 1 1  ON 47
  eH2_8                 1.644539e-01 1 1  ON 48
  eH2_9                 2.717702e-02 1 1  ON 49
ci_0001                 7.010004e-01 3 1  ON 50
ci_0002                 7.004778e-01 3 1  ON 51
ci_0003                -2.808450e-02 3 1  ON 52
ci_0004                -2.730381e-02 3 1  ON 53
ci_0005                -3.705189e-02 3 1  ON 54
ci_0006                -3.758170e-02 3 1  ON 55
ci_0007                -2.211518e-02 3 1  ON 56
ci_0008                -2.242218e-02 3 1  ON 57
ci_0009                -1.796454e-02 3 1  ON 58
ci_0010                -1.787466e-02 3 1  ON 59
ci_0011                -1.227587e-02 3 1  ON 60
ci_0012                -1.155487e-02 3 1  ON 61
ci_0013                 1.308651e-02 3 1  ON 62
ci_0014                 1.309086e-02 3 1  ON 63
ci_0015                 1.309203e-02 3 1  ON 64
ci_0016                 1.285838e-02 3 1  ON 65
ci_0017                 1.084066e-02 3 1  ON 66
ci_0018                 1.121223e-02 3 1  ON 67
ci_0019                 1.112093e-02 3 1  ON 68
ci_0020                 1.151284e-02 3 1  ON 69
ci_0021                -4.165135e-04 3 1  ON 70
ci_0022                -1.556277e-03 3 1  ON 71
ci_0023                -1.134246e-02 3 1  ON 72
ci_0024                -1.126854e-02 3 1  ON 73
ci_0025                -1.020646e-02 3 1  ON 74
ci_0026                -1.088527e-02 3 1  ON 75
ci_0027                -1.128411e-02 3 1  ON 76
ci_0028                -1.142778e-02 3 1  ON 77
ci_0029                -1.076820e-02 3 1  ON 78
ci_0030                -1.088655e-02 3 1  ON 79
ci_0031                 2.051209e-02 3 1  ON 80
ci_0032                 2.067102e-02 3 1  ON 81
ci_0033                 1.034062e-02 3 1  ON 82
ci_0034                 1.061991e-02 3 1  ON 83
ci_0035                 7.036900e-03 3 1  ON 84
ci_0036                 6.747300e-03 3 1  ON 85
ci_0037                -1.054163e-02 3 1  ON 86
ci_0038                -1.029809e-02 3 1  ON 87
ci_0039                -2.840291e-03 3 1  ON 88
ci_0040                -2.382140e-03 3 1  ON 89
ci_0041                 6.799711e-03 3 1  ON 90
ci_0042                 7.255480e-03 3 1  ON 91
ci_0043                -1.846730e-02 3 1  ON 92
ci_0044                -1.907442e-02 3 1  ON 93
ci_0045                 7.811217e-03 3 1  ON 94
ci_0046                 7.710302e-03 3 1  ON 95
ci_0047                -1.747766e-03 3 1  ON 96
ci_0048                -1.802101e-03 3 1  ON 97
ci_0049                -5.742881e-03 3 1  ON 98
ci_0050                -5.605916e-03 3 1  ON 99
ci_0051                -3.783979e-03 3 1  ON 100
ci_0052                -3.390090e-03 3 1  ON 101
ci_0053                -5.126249e-03 3 1  ON 102
ci_0054                -4.790515e-03 3 1  ON 103
ci_0055                 6.908203e-03 3 1  ON 104
ci_0056                 6.650510e-03 3 1  ON 105
ci_0057                 4.675280e-03 3 1  ON 106
ci_0058                 5.436945e-03 3 1  ON 107
ci_0059                -4.915461e-03 3 1  ON 108
ci_0060                -4.477957e-03 3 1  ON 109
ci_0061                -3.451356e-03 3 1  ON 110
ci_0062                -3.920163e-03 3 1  ON 111
ci_0063                -8.739769e-03 3 1  ON 112
ci_0064                -8.823530e-03 3 1  ON 113
ci_0065                -5.361990e-03 3 1  ON 114
ci_0066                -5.517412e-03 3 1  ON 115
ci_0067                -5.042136e-03 3 1  ON 116
ci_0068                -5.182299e-03 3 1  ON 117
ci_0069                 4.200999e-03 3 1  ON 118
ci_0070                 4.970493e-03 3 1  ON 119
ci_0071                -2.628426e-04 3 1  ON 120
ci_0072                 6.978604e-04 3 1  ON 121
ci_0073                 4.395836e-03 3 1  ON 122
ci_0074                 4.052421e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8591
    reference variance = 0.202289
====================================================
  Execution time = 2.0979e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4250e-01
  Total weights = 1.9516e+06
  Execution time = 1.8808e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323880858217
                                         uncertainty =       0.002664158947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323880858217
                                         uncertainty =       0.002664158947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402398476
  error estimate for blocks of size 2^( 2) =       0.000415813527
  error estimate for blocks of size 2^( 3) =       0.000429274209
  error estimate for blocks of size 2^( 4) =       0.000442241302
  error estimate for blocks of size 2^( 5) =       0.000454240575
  error estimate for blocks of size 2^( 6) =       0.000463328650
  error estimate for blocks of size 2^( 7) =       0.000469801329

      target function =                  N/A
              le_mean =     -16.905111515607
             les_mean =     286.133661645403
             stat err =       0.000457402964
             autocorr =       1.292067773825
              std dev =       0.569077382249
             le_variance =       0.323849066987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324764299509
                                         uncertainty =       0.002604846255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324764299509
                                         uncertainty =       0.002604846255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402947037
  error estimate for blocks of size 2^( 2) =       0.000416357717
  error estimate for blocks of size 2^( 3) =       0.000429787638
  error estimate for blocks of size 2^( 4) =       0.000442727417
  error estimate for blocks of size 2^( 5) =       0.000454682754
  error estimate for blocks of size 2^( 6) =       0.000463777447
  error estimate for blocks of size 2^( 7) =       0.000470276275

      target function =                  N/A
              le_mean =     -16.905092219702
             les_mean =     286.232630407395
             stat err =       0.000457865973
             autocorr =       1.291162212142
              std dev =       0.569853164032
             le_variance =       0.324732628557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325146988589
                                         uncertainty =       0.002647773589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325146988589
                                         uncertainty =       0.002647773589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403183597
  error estimate for blocks of size 2^( 2) =       0.000416586203
  error estimate for blocks of size 2^( 3) =       0.000430044495
  error estimate for blocks of size 2^( 4) =       0.000442973431
  error estimate for blocks of size 2^( 5) =       0.000454967358
  error estimate for blocks of size 2^( 6) =       0.000464115904
  error estimate for blocks of size 2^( 7) =       0.000470650671

      target function =                  N/A
              le_mean =     -16.905088547565
             les_mean =     286.239708267646
             stat err =       0.000458176841
             autocorr =       1.291399329840
              std dev =       0.570187711429
             le_variance =       0.325114026265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323933033588
                                         uncertainty =       0.002652448765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323933033588
                                         uncertainty =       0.002652448765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402430979
  error estimate for blocks of size 2^( 2) =       0.000415849070
  error estimate for blocks of size 2^( 3) =       0.000429305215
  error estimate for blocks of size 2^( 4) =       0.000442270399
  error estimate for blocks of size 2^( 5) =       0.000454267200
  error estimate for blocks of size 2^( 6) =       0.000463375013
  error estimate for blocks of size 2^( 7) =       0.000469873826

      target function =                  N/A
              le_mean =     -16.905098257514
             les_mean =     287.302280943492
             stat err =       0.000457446610
             autocorr =       1.292105624009
              std dev =       0.569123347970
             le_variance =       0.323901385204


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905111515607        initial  <--
     3.8147e-02     3.8147e-01             5.0716e-03       -16.905092219702
     1.5259e-01     1.5259e+00             1.6606e-03       -16.905088547565
     6.1035e-01     6.1035e+00             4.5643e-04       -16.905098257514

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5105
  </log>
  <optVariables href="H2O.s019.opt.xml">
   uu_0                 3.109743e-01 1 1  ON 0
   uu_1                 1.440403e-01 1 1  ON 1
   uu_2                 4.288328e-02 1 1  ON 2
   uu_3                -1.898702e-02 1 1  ON 3
   uu_4                -6.379552e-02 1 1  ON 4
   uu_5                -9.792203e-02 1 1  ON 5
   uu_6                -1.250425e-01 1 1  ON 6
   uu_7                -1.375789e-01 1 1  ON 7
   uu_8                -1.289873e-01 1 1  ON 8
   uu_9                -9.759854e-02 1 1  ON 9
   ud_0                 4.440786e-01 1 1  ON 10
   ud_1                 1.783026e-01 1 1  ON 11
   ud_2                 5.855830e-02 1 1  ON 12
   ud_3                -1.163462e-02 1 1  ON 13
   ud_4                -6.722940e-02 1 1  ON 14
   ud_5                -1.071788e-01 1 1  ON 15
   ud_6                -1.333544e-01 1 1  ON 16
   ud_7                -1.483637e-01 1 1  ON 17
   ud_8                -1.487572e-01 1 1  ON 18
   ud_9                -1.378242e-01 1 1  ON 19
   eO_0                -7.431497e-01 1 1  ON 20
   eO_1                -4.246625e-01 1 1  ON 21
   eO_2                -1.726206e-02 1 1  ON 22
   eO_3                 2.897145e-01 1 1  ON 23
   eO_4                 5.085138e-01 1 1  ON 24
   eO_5                 4.669230e-01 1 1  ON 25
   eO_6                 2.408329e-01 1 1  ON 26
   eO_7                -5.237094e-02 1 1  ON 27
   eO_8                -2.053032e-01 1 1  ON 28
   eO_9                -6.524622e-02 1 1  ON 29
  eH1_0                -2.431867e-01 1 1  ON 30
  eH1_1                -1.371994e-01 1 1  ON 31
  eH1_2                -8.792947e-02 1 1  ON 32
  eH1_3                -3.412526e-02 1 1  ON 33
  eH1_4                 1.439995e-02 1 1  ON 34
  eH1_5                 4.701904e-02 1 1  ON 35
  eH1_6                 9.978821e-02 1 1  ON 36
  eH1_7                 1.456565e-01 1 1  ON 37
  eH1_8                 1.570894e-01 1 1  ON 38
  eH1_9                 4.296149e-02 1 1  ON 39
  eH2_0                -2.411772e-01 1 1  ON 40
  eH2_1                -1.355981e-01 1 1  ON 41
  eH2_2                -8.618088e-02 1 1  ON 42
  eH2_3                -3.201326e-02 1 1  ON 43
  eH2_4                 1.707185e-02 1 1  ON 44
  eH2_5                 5.108852e-02 1 1  ON 45
  eH2_6                 1.045669e-01 1 1  ON 46
  eH2_7                 1.508967e-01 1 1  ON 47
  eH2_8                 1.634022e-01 1 1  ON 48
  eH2_9                 2.597071e-02 1 1  ON 49
ci_0001                 7.011035e-01 3 1  ON 50
ci_0002                 7.004528e-01 3 1  ON 51
ci_0003                -2.814867e-02 3 1  ON 52
ci_0004                -2.795441e-02 3 1  ON 53
ci_0005                -3.680508e-02 3 1  ON 54
ci_0006                -3.723113e-02 3 1  ON 55
ci_0007                -2.216882e-02 3 1  ON 56
ci_0008                -2.176639e-02 3 1  ON 57
ci_0009                -1.741418e-02 3 1  ON 58
ci_0010                -1.761771e-02 3 1  ON 59
ci_0011                -1.211115e-02 3 1  ON 60
ci_0012                -1.221492e-02 3 1  ON 61
ci_0013                 1.338719e-02 3 1  ON 62
ci_0014                 1.362956e-02 3 1  ON 63
ci_0015                 1.318336e-02 3 1  ON 64
ci_0016                 1.294465e-02 3 1  ON 65
ci_0017                 1.099045e-02 3 1  ON 66
ci_0018                 1.120824e-02 3 1  ON 67
ci_0019                 1.148203e-02 3 1  ON 68
ci_0020                 1.174983e-02 3 1  ON 69
ci_0021                -4.445134e-04 3 1  ON 70
ci_0022                -7.900638e-04 3 1  ON 71
ci_0023                -1.145733e-02 3 1  ON 72
ci_0024                -1.142372e-02 3 1  ON 73
ci_0025                -1.023466e-02 3 1  ON 74
ci_0026                -1.039736e-02 3 1  ON 75
ci_0027                -1.094519e-02 3 1  ON 76
ci_0028                -1.087517e-02 3 1  ON 77
ci_0029                -1.100925e-02 3 1  ON 78
ci_0030                -1.090194e-02 3 1  ON 79
ci_0031                 2.015326e-02 3 1  ON 80
ci_0032                 1.998177e-02 3 1  ON 81
ci_0033                 9.815855e-03 3 1  ON 82
ci_0034                 1.051792e-02 3 1  ON 83
ci_0035                 6.652256e-03 3 1  ON 84
ci_0036                 6.848209e-03 3 1  ON 85
ci_0037                -1.022585e-02 3 1  ON 86
ci_0038                -1.066194e-02 3 1  ON 87
ci_0039                -2.589578e-03 3 1  ON 88
ci_0040                -2.424047e-03 3 1  ON 89
ci_0041                 7.644075e-03 3 1  ON 90
ci_0042                 7.329169e-03 3 1  ON 91
ci_0043                -1.796874e-02 3 1  ON 92
ci_0044                -1.896842e-02 3 1  ON 93
ci_0045                 7.958710e-03 3 1  ON 94
ci_0046                 7.675015e-03 3 1  ON 95
ci_0047                -1.835199e-03 3 1  ON 96
ci_0048                -1.427861e-03 3 1  ON 97
ci_0049                -5.483961e-03 3 1  ON 98
ci_0050                -6.027525e-03 3 1  ON 99
ci_0051                -3.719010e-03 3 1  ON 100
ci_0052                -3.573139e-03 3 1  ON 101
ci_0053                -5.010222e-03 3 1  ON 102
ci_0054                -4.572694e-03 3 1  ON 103
ci_0055                 6.227087e-03 3 1  ON 104
ci_0056                 6.757625e-03 3 1  ON 105
ci_0057                 5.065081e-03 3 1  ON 106
ci_0058                 4.900907e-03 3 1  ON 107
ci_0059                -4.880148e-03 3 1  ON 108
ci_0060                -4.645013e-03 3 1  ON 109
ci_0061                -3.824920e-03 3 1  ON 110
ci_0062                -3.803172e-03 3 1  ON 111
ci_0063                -8.761256e-03 3 1  ON 112
ci_0064                -8.664505e-03 3 1  ON 113
ci_0065                -5.175618e-03 3 1  ON 114
ci_0066                -5.212528e-03 3 1  ON 115
ci_0067                -4.775423e-03 3 1  ON 116
ci_0068                -4.768012e-03 3 1  ON 117
ci_0069                 4.150248e-03 3 1  ON 118
ci_0070                 4.703343e-03 3 1  ON 119
ci_0071                -3.089565e-05 3 1  ON 120
ci_0072                 6.893661e-04 3 1  ON 121
ci_0073                 4.385547e-03 3 1  ON 122
ci_0074                 3.805182e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7846e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.876
    reference variance = 0.13767
====================================================
  Execution time = 2.1205e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5236e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.2858e-01
  Total weights = 1.951712409e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1700e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317010682946
                                         uncertainty =       0.001864326316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317010682946
                                         uncertainty =       0.001864326316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398110964
  error estimate for blocks of size 2^( 2) =       0.000411078370
  error estimate for blocks of size 2^( 3) =       0.000423663582
  error estimate for blocks of size 2^( 4) =       0.000435138427
  error estimate for blocks of size 2^( 5) =       0.000445798528
  error estimate for blocks of size 2^( 6) =       0.000454413710
  error estimate for blocks of size 2^( 7) =       0.000457662178

      target function =                  N/A
              le_mean =     -16.906654378578
             les_mean =     286.163542467600
             stat err =       0.000448253211
             autocorr =       1.267764366844
              std dev =       0.563013925168
             le_variance =       0.316984679933


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690665437858e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906654378553       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906670007541       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906670397792       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906668964038       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906670036983       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906670240141       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906671040946       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906670794473       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906670777279       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906670943653       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906670984983       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e-01 is 7.020480e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906654378553       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906659735764       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906659947362       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906659583974       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906659809510       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906659869951       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906660042895       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906660068879       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906660086452       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906660068261       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+00 is 2.181124e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906654378553       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906655854814       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906655924283       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906655857268       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906655910666       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906655903940       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906655940623       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906655956570       residual = 7.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906655968739       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906655961851       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e+00 is 5.960450e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.348505 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7383e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
   uu_0                 3.109543e-01 1 1  ON 0
   uu_1                 1.440381e-01 1 1  ON 1
   uu_2                 4.287114e-02 1 1  ON 2
   uu_3                -1.899103e-02 1 1  ON 3
   uu_4                -6.378493e-02 1 1  ON 4
   uu_5                -9.789554e-02 1 1  ON 5
   uu_6                -1.250075e-01 1 1  ON 6
   uu_7                -1.375854e-01 1 1  ON 7
   uu_8                -1.290745e-01 1 1  ON 8
   uu_9                -9.766602e-02 1 1  ON 9
   ud_0                 4.439958e-01 1 1  ON 10
   ud_1                 1.783986e-01 1 1  ON 11
   ud_2                 5.864672e-02 1 1  ON 12
   ud_3                -1.158548e-02 1 1  ON 13
   ud_4                -6.722616e-02 1 1  ON 14
   ud_5                -1.072244e-01 1 1  ON 15
   ud_6                -1.333578e-01 1 1  ON 16
   ud_7                -1.483584e-01 1 1  ON 17
   ud_8                -1.488224e-01 1 1  ON 18
   ud_9                -1.378839e-01 1 1  ON 19
   eO_0                -7.433678e-01 1 1  ON 20
   eO_1                -4.246815e-01 1 1  ON 21
   eO_2                -1.729479e-02 1 1  ON 22
   eO_3                 2.897412e-01 1 1  ON 23
   eO_4                 5.086712e-01 1 1  ON 24
   eO_5                 4.670717e-01 1 1  ON 25
   eO_6                 2.409100e-01 1 1  ON 26
   eO_7                -5.229992e-02 1 1  ON 27
   eO_8                -2.054028e-01 1 1  ON 28
   eO_9                -6.534275e-02 1 1  ON 29
  eH1_0                -2.432780e-01 1 1  ON 30
  eH1_1                -1.372109e-01 1 1  ON 31
  eH1_2                -8.801289e-02 1 1  ON 32
  eH1_3                -3.414700e-02 1 1  ON 33
  eH1_4                 1.425529e-02 1 1  ON 34
  eH1_5                 4.699604e-02 1 1  ON 35
  eH1_6                 9.986821e-02 1 1  ON 36
  eH1_7                 1.456974e-01 1 1  ON 37
  eH1_8                 1.572111e-01 1 1  ON 38
  eH1_9                 4.308559e-02 1 1  ON 39
  eH2_0                -2.413083e-01 1 1  ON 40
  eH2_1                -1.356368e-01 1 1  ON 41
  eH2_2                -8.620881e-02 1 1  ON 42
  eH2_3                -3.205820e-02 1 1  ON 43
  eH2_4                 1.702101e-02 1 1  ON 44
  eH2_5                 5.104772e-02 1 1  ON 45
  eH2_6                 1.045948e-01 1 1  ON 46
  eH2_7                 1.509535e-01 1 1  ON 47
  eH2_8                 1.635188e-01 1 1  ON 48
  eH2_9                 2.609908e-02 1 1  ON 49
ci_0001                 7.011449e-01 3 1  ON 50
ci_0002                 7.004196e-01 3 1  ON 51
ci_0003                -2.814175e-02 3 1  ON 52
ci_0004                -2.786466e-02 3 1  ON 53
ci_0005                -3.683808e-02 3 1  ON 54
ci_0006                -3.721843e-02 3 1  ON 55
ci_0007                -2.221982e-02 3 1  ON 56
ci_0008                -2.183971e-02 3 1  ON 57
ci_0009                -1.745926e-02 3 1  ON 58
ci_0010                -1.748553e-02 3 1  ON 59
ci_0011                -1.203021e-02 3 1  ON 60
ci_0012                -1.228545e-02 3 1  ON 61
ci_0013                 1.330948e-02 3 1  ON 62
ci_0014                 1.356371e-02 3 1  ON 63
ci_0015                 1.311876e-02 3 1  ON 64
ci_0016                 1.294264e-02 3 1  ON 65
ci_0017                 1.100025e-02 3 1  ON 66
ci_0018                 1.123553e-02 3 1  ON 67
ci_0019                 1.138070e-02 3 1  ON 68
ci_0020                 1.168032e-02 3 1  ON 69
ci_0021                -5.622808e-04 3 1  ON 70
ci_0022                -7.926181e-04 3 1  ON 71
ci_0023                -1.144020e-02 3 1  ON 72
ci_0024                -1.142273e-02 3 1  ON 73
ci_0025                -1.029159e-02 3 1  ON 74
ci_0026                -1.045511e-02 3 1  ON 75
ci_0027                -1.099308e-02 3 1  ON 76
ci_0028                -1.088260e-02 3 1  ON 77
ci_0029                -1.107016e-02 3 1  ON 78
ci_0030                -1.084873e-02 3 1  ON 79
ci_0031                 2.016202e-02 3 1  ON 80
ci_0032                 2.005069e-02 3 1  ON 81
ci_0033                 9.849854e-03 3 1  ON 82
ci_0034                 1.049013e-02 3 1  ON 83
ci_0035                 6.686328e-03 3 1  ON 84
ci_0036                 6.911123e-03 3 1  ON 85
ci_0037                -1.026237e-02 3 1  ON 86
ci_0038                -1.069061e-02 3 1  ON 87
ci_0039                -2.652837e-03 3 1  ON 88
ci_0040                -2.416422e-03 3 1  ON 89
ci_0041                 7.505378e-03 3 1  ON 90
ci_0042                 7.232810e-03 3 1  ON 91
ci_0043                -1.785887e-02 3 1  ON 92
ci_0044                -1.893715e-02 3 1  ON 93
ci_0045                 7.878834e-03 3 1  ON 94
ci_0046                 7.654303e-03 3 1  ON 95
ci_0047                -1.852130e-03 3 1  ON 96
ci_0048                -1.555766e-03 3 1  ON 97
ci_0049                -5.400076e-03 3 1  ON 98
ci_0050                -5.924312e-03 3 1  ON 99
ci_0051                -3.653717e-03 3 1  ON 100
ci_0052                -3.603313e-03 3 1  ON 101
ci_0053                -5.026649e-03 3 1  ON 102
ci_0054                -4.573333e-03 3 1  ON 103
ci_0055                 6.219330e-03 3 1  ON 104
ci_0056                 6.683327e-03 3 1  ON 105
ci_0057                 4.943124e-03 3 1  ON 106
ci_0058                 4.822715e-03 3 1  ON 107
ci_0059                -4.934838e-03 3 1  ON 108
ci_0060                -4.756448e-03 3 1  ON 109
ci_0061                -3.829619e-03 3 1  ON 110
ci_0062                -3.842402e-03 3 1  ON 111
ci_0063                -8.734564e-03 3 1  ON 112
ci_0064                -8.681030e-03 3 1  ON 113
ci_0065                -5.325664e-03 3 1  ON 114
ci_0066                -5.193789e-03 3 1  ON 115
ci_0067                -4.866917e-03 3 1  ON 116
ci_0068                -4.730540e-03 3 1  ON 117
ci_0069                 4.193315e-03 3 1  ON 118
ci_0070                 4.654151e-03 3 1  ON 119
ci_0071                 7.457050e-06 3 1  ON 120
ci_0072                 6.922886e-04 3 1  ON 121
ci_0073                 4.399502e-03 3 1  ON 122
ci_0074                 3.932908e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9723
    reference variance = 0.377691
====================================================
  Execution time = 2.1351e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3478e-01
  Total weights = 1.9512e+06
  Execution time = 1.8921e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324559790897
                                         uncertainty =       0.002394993419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324559790897
                                         uncertainty =       0.002394993419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402862352
  error estimate for blocks of size 2^( 2) =       0.000415975845
  error estimate for blocks of size 2^( 3) =       0.000429630096
  error estimate for blocks of size 2^( 4) =       0.000442432100
  error estimate for blocks of size 2^( 5) =       0.000453052859
  error estimate for blocks of size 2^( 6) =       0.000460275765
  error estimate for blocks of size 2^( 7) =       0.000463463517

      target function =                  N/A
              le_mean =     -16.906381625844
             les_mean =     286.161004524994
             stat err =       0.000454806060
             autocorr =       1.274497883472
              std dev =       0.569733401618
             le_variance =       0.324596148919

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330769231589
                                         uncertainty =       0.006889012228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330769231589
                                         uncertainty =       0.006889012228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406709921
  error estimate for blocks of size 2^( 2) =       0.000419760799
  error estimate for blocks of size 2^( 3) =       0.000433329710
  error estimate for blocks of size 2^( 4) =       0.000446075879
  error estimate for blocks of size 2^( 5) =       0.000456543210
  error estimate for blocks of size 2^( 6) =       0.000463736605
  error estimate for blocks of size 2^( 7) =       0.000466859151

      target function =                  N/A
              le_mean =     -16.906331610128
             les_mean =     343.799108213636
             stat err =       0.000458303711
             autocorr =       1.269805533837
              std dev =       0.575174686106
             le_variance =       0.330825919537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324282624839
                                         uncertainty =       0.002386659906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324282624839
                                         uncertainty =       0.002386659906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402690615
  error estimate for blocks of size 2^( 2) =       0.000415815507
  error estimate for blocks of size 2^( 3) =       0.000429484734
  error estimate for blocks of size 2^( 4) =       0.000442298106
  error estimate for blocks of size 2^( 5) =       0.000452918675
  error estimate for blocks of size 2^( 6) =       0.000460143913
  error estimate for blocks of size 2^( 7) =       0.000463341324

      target function =                  N/A
              le_mean =     -16.906385328600
             les_mean =     286.160647010577
             stat err =       0.000454675504
             autocorr =       1.274852965105
              std dev =       0.569490529013
             le_variance =       0.324319462636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324513226379
                                         uncertainty =       0.002393757812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324513226379
                                         uncertainty =       0.002393757812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402833496
  error estimate for blocks of size 2^( 2) =       0.000415948661
  error estimate for blocks of size 2^( 3) =       0.000429605217
  error estimate for blocks of size 2^( 4) =       0.000442408526
  error estimate for blocks of size 2^( 5) =       0.000453029203
  error estimate for blocks of size 2^( 6) =       0.000460251702
  error estimate for blocks of size 2^( 7) =       0.000463441944

      target function =                  N/A
              le_mean =     -16.906381841380
             les_mean =     286.168912807623
             stat err =       0.000454782844
             autocorr =       1.274550343326
              std dev =       0.569692594013
             le_variance =       0.324549651673


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906381625844        initial
     3.8147e-01     3.8147e+00             7.0205e-04       -16.906331610128
     1.5259e+00     1.5259e+01             2.1811e-04       -16.906385328600  <--
     6.1035e+00     6.1035e+01             5.9605e-05       -16.906381841380

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 3.0939e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
   uu_0                 3.109543e-01 1 1  ON 0
   uu_1                 1.440381e-01 1 1  ON 1
   uu_2                 4.287114e-02 1 1  ON 2
   uu_3                -1.899103e-02 1 1  ON 3
   uu_4                -6.378493e-02 1 1  ON 4
   uu_5                -9.789554e-02 1 1  ON 5
   uu_6                -1.250075e-01 1 1  ON 6
   uu_7                -1.375854e-01 1 1  ON 7
   uu_8                -1.290745e-01 1 1  ON 8
   uu_9                -9.766602e-02 1 1  ON 9
   ud_0                 4.439958e-01 1 1  ON 10
   ud_1                 1.783986e-01 1 1  ON 11
   ud_2                 5.864672e-02 1 1  ON 12
   ud_3                -1.158548e-02 1 1  ON 13
   ud_4                -6.722616e-02 1 1  ON 14
   ud_5                -1.072244e-01 1 1  ON 15
   ud_6                -1.333578e-01 1 1  ON 16
   ud_7                -1.483584e-01 1 1  ON 17
   ud_8                -1.488224e-01 1 1  ON 18
   ud_9                -1.378839e-01 1 1  ON 19
   eO_0                -7.433678e-01 1 1  ON 20
   eO_1                -4.246815e-01 1 1  ON 21
   eO_2                -1.729479e-02 1 1  ON 22
   eO_3                 2.897412e-01 1 1  ON 23
   eO_4                 5.086712e-01 1 1  ON 24
   eO_5                 4.670717e-01 1 1  ON 25
   eO_6                 2.409100e-01 1 1  ON 26
   eO_7                -5.229992e-02 1 1  ON 27
   eO_8                -2.054028e-01 1 1  ON 28
   eO_9                -6.534275e-02 1 1  ON 29
  eH1_0                -2.432780e-01 1 1  ON 30
  eH1_1                -1.372109e-01 1 1  ON 31
  eH1_2                -8.801289e-02 1 1  ON 32
  eH1_3                -3.414700e-02 1 1  ON 33
  eH1_4                 1.425529e-02 1 1  ON 34
  eH1_5                 4.699604e-02 1 1  ON 35
  eH1_6                 9.986821e-02 1 1  ON 36
  eH1_7                 1.456974e-01 1 1  ON 37
  eH1_8                 1.572111e-01 1 1  ON 38
  eH1_9                 4.308559e-02 1 1  ON 39
  eH2_0                -2.413083e-01 1 1  ON 40
  eH2_1                -1.356368e-01 1 1  ON 41
  eH2_2                -8.620881e-02 1 1  ON 42
  eH2_3                -3.205820e-02 1 1  ON 43
  eH2_4                 1.702101e-02 1 1  ON 44
  eH2_5                 5.104772e-02 1 1  ON 45
  eH2_6                 1.045948e-01 1 1  ON 46
  eH2_7                 1.509535e-01 1 1  ON 47
  eH2_8                 1.635188e-01 1 1  ON 48
  eH2_9                 2.609908e-02 1 1  ON 49
ci_0001                 7.011449e-01 3 1  ON 50
ci_0002                 7.004196e-01 3 1  ON 51
ci_0003                -2.814175e-02 3 1  ON 52
ci_0004                -2.786466e-02 3 1  ON 53
ci_0005                -3.683808e-02 3 1  ON 54
ci_0006                -3.721843e-02 3 1  ON 55
ci_0007                -2.221982e-02 3 1  ON 56
ci_0008                -2.183971e-02 3 1  ON 57
ci_0009                -1.745926e-02 3 1  ON 58
ci_0010                -1.748553e-02 3 1  ON 59
ci_0011                -1.203021e-02 3 1  ON 60
ci_0012                -1.228545e-02 3 1  ON 61
ci_0013                 1.330948e-02 3 1  ON 62
ci_0014                 1.356371e-02 3 1  ON 63
ci_0015                 1.311876e-02 3 1  ON 64
ci_0016                 1.294264e-02 3 1  ON 65
ci_0017                 1.100025e-02 3 1  ON 66
ci_0018                 1.123553e-02 3 1  ON 67
ci_0019                 1.138070e-02 3 1  ON 68
ci_0020                 1.168032e-02 3 1  ON 69
ci_0021                -5.622808e-04 3 1  ON 70
ci_0022                -7.926181e-04 3 1  ON 71
ci_0023                -1.144020e-02 3 1  ON 72
ci_0024                -1.142273e-02 3 1  ON 73
ci_0025                -1.029159e-02 3 1  ON 74
ci_0026                -1.045511e-02 3 1  ON 75
ci_0027                -1.099308e-02 3 1  ON 76
ci_0028                -1.088260e-02 3 1  ON 77
ci_0029                -1.107016e-02 3 1  ON 78
ci_0030                -1.084873e-02 3 1  ON 79
ci_0031                 2.016202e-02 3 1  ON 80
ci_0032                 2.005069e-02 3 1  ON 81
ci_0033                 9.849854e-03 3 1  ON 82
ci_0034                 1.049013e-02 3 1  ON 83
ci_0035                 6.686328e-03 3 1  ON 84
ci_0036                 6.911123e-03 3 1  ON 85
ci_0037                -1.026237e-02 3 1  ON 86
ci_0038                -1.069061e-02 3 1  ON 87
ci_0039                -2.652837e-03 3 1  ON 88
ci_0040                -2.416422e-03 3 1  ON 89
ci_0041                 7.505378e-03 3 1  ON 90
ci_0042                 7.232810e-03 3 1  ON 91
ci_0043                -1.785887e-02 3 1  ON 92
ci_0044                -1.893715e-02 3 1  ON 93
ci_0045                 7.878834e-03 3 1  ON 94
ci_0046                 7.654303e-03 3 1  ON 95
ci_0047                -1.852130e-03 3 1  ON 96
ci_0048                -1.555766e-03 3 1  ON 97
ci_0049                -5.400076e-03 3 1  ON 98
ci_0050                -5.924312e-03 3 1  ON 99
ci_0051                -3.653717e-03 3 1  ON 100
ci_0052                -3.603313e-03 3 1  ON 101
ci_0053                -5.026649e-03 3 1  ON 102
ci_0054                -4.573333e-03 3 1  ON 103
ci_0055                 6.219330e-03 3 1  ON 104
ci_0056                 6.683327e-03 3 1  ON 105
ci_0057                 4.943124e-03 3 1  ON 106
ci_0058                 4.822715e-03 3 1  ON 107
ci_0059                -4.934838e-03 3 1  ON 108
ci_0060                -4.756448e-03 3 1  ON 109
ci_0061                -3.829619e-03 3 1  ON 110
ci_0062                -3.842402e-03 3 1  ON 111
ci_0063                -8.734564e-03 3 1  ON 112
ci_0064                -8.681030e-03 3 1  ON 113
ci_0065                -5.325664e-03 3 1  ON 114
ci_0066                -5.193789e-03 3 1  ON 115
ci_0067                -4.866917e-03 3 1  ON 116
ci_0068                -4.730540e-03 3 1  ON 117
ci_0069                 4.193315e-03 3 1  ON 118
ci_0070                 4.654151e-03 3 1  ON 119
ci_0071                 7.457050e-06 3 1  ON 120
ci_0072                 6.922886e-04 3 1  ON 121
ci_0073                 4.399502e-03 3 1  ON 122
ci_0074                 3.932908e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8330e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6889e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.839
    reference variance = 0.622547
====================================================
  Execution time = 2.1238e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5222e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3872e-01
  Total weights = 1.951530897e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0770e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324204251868
                                         uncertainty =       0.002334628464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324204251868
                                         uncertainty =       0.002334628464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402622912
  error estimate for blocks of size 2^( 2) =       0.000415891742
  error estimate for blocks of size 2^( 3) =       0.000429486911
  error estimate for blocks of size 2^( 4) =       0.000442240158
  error estimate for blocks of size 2^( 5) =       0.000453623272
  error estimate for blocks of size 2^( 6) =       0.000461132103
  error estimate for blocks of size 2^( 7) =       0.000463917409

      target function =                  N/A
              le_mean =     -16.905594990278
             les_mean =     286.137865463682
             stat err =       0.000455228235
             autocorr =       1.278384249953
              std dev =       0.569394782641
             le_variance =       0.324210418499


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690559499028e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905594990290       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905602045041       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905600574625       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905602125596       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905601051679       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905601199414       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905601164516       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905600890492       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905601590451       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905601833776       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905601898234       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e-01 is 9.584224e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905594990290       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905597373322       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905596873895       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905597374538       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905597184634       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905596868007       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905597066708       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905597031972       residual = 8.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905597096186       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905597170011       residual = 7.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+00 is 3.227278e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905594990290       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905595643384       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905595505478       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905595644692       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905595619343       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905595508743       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905595549485       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905595556733       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905595562917       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905595581455       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e+00 is 8.846011e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.352662 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7323e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
   uu_0                 3.110971e-01 1 1  ON 0
   uu_1                 1.440427e-01 1 1  ON 1
   uu_2                 4.283496e-02 1 1  ON 2
   uu_3                -1.903315e-02 1 1  ON 3
   uu_4                -6.383718e-02 1 1  ON 4
   uu_5                -9.792362e-02 1 1  ON 5
   uu_6                -1.249750e-01 1 1  ON 6
   uu_7                -1.376500e-01 1 1  ON 7
   uu_8                -1.291433e-01 1 1  ON 8
   uu_9                -9.771809e-02 1 1  ON 9
   ud_0                 4.440450e-01 1 1  ON 10
   ud_1                 1.784790e-01 1 1  ON 11
   ud_2                 5.868699e-02 1 1  ON 12
   ud_3                -1.156711e-02 1 1  ON 13
   ud_4                -6.723089e-02 1 1  ON 14
   ud_5                -1.072216e-01 1 1  ON 15
   ud_6                -1.333473e-01 1 1  ON 16
   ud_7                -1.483867e-01 1 1  ON 17
   ud_8                -1.489176e-01 1 1  ON 18
   ud_9                -1.379212e-01 1 1  ON 19
   eO_0                -7.434937e-01 1 1  ON 20
   eO_1                -4.248188e-01 1 1  ON 21
   eO_2                -1.726648e-02 1 1  ON 22
   eO_3                 2.897875e-01 1 1  ON 23
   eO_4                 5.088195e-01 1 1  ON 24
   eO_5                 4.671588e-01 1 1  ON 25
   eO_6                 2.410361e-01 1 1  ON 26
   eO_7                -5.226929e-02 1 1  ON 27
   eO_8                -2.055106e-01 1 1  ON 28
   eO_9                -6.542320e-02 1 1  ON 29
  eH1_0                -2.434669e-01 1 1  ON 30
  eH1_1                -1.373341e-01 1 1  ON 31
  eH1_2                -8.812641e-02 1 1  ON 32
  eH1_3                -3.414458e-02 1 1  ON 33
  eH1_4                 1.427835e-02 1 1  ON 34
  eH1_5                 4.700747e-02 1 1  ON 35
  eH1_6                 9.992158e-02 1 1  ON 36
  eH1_7                 1.458297e-01 1 1  ON 37
  eH1_8                 1.573375e-01 1 1  ON 38
  eH1_9                 4.316537e-02 1 1  ON 39
  eH2_0                -2.413668e-01 1 1  ON 40
  eH2_1                -1.356691e-01 1 1  ON 41
  eH2_2                -8.630468e-02 1 1  ON 42
  eH2_3                -3.208220e-02 1 1  ON 43
  eH2_4                 1.699842e-02 1 1  ON 44
  eH2_5                 5.094175e-02 1 1  ON 45
  eH2_6                 1.046067e-01 1 1  ON 46
  eH2_7                 1.510009e-01 1 1  ON 47
  eH2_8                 1.636218e-01 1 1  ON 48
  eH2_9                 2.626153e-02 1 1  ON 49
ci_0001                 7.011973e-01 3 1  ON 50
ci_0002                 7.003920e-01 3 1  ON 51
ci_0003                -2.801224e-02 3 1  ON 52
ci_0004                -2.787584e-02 3 1  ON 53
ci_0005                -3.682157e-02 3 1  ON 54
ci_0006                -3.714263e-02 3 1  ON 55
ci_0007                -2.217789e-02 3 1  ON 56
ci_0008                -2.182507e-02 3 1  ON 57
ci_0009                -1.735916e-02 3 1  ON 58
ci_0010                -1.747180e-02 3 1  ON 59
ci_0011                -1.207709e-02 3 1  ON 60
ci_0012                -1.235540e-02 3 1  ON 61
ci_0013                 1.324820e-02 3 1  ON 62
ci_0014                 1.346257e-02 3 1  ON 63
ci_0015                 1.315353e-02 3 1  ON 64
ci_0016                 1.261992e-02 3 1  ON 65
ci_0017                 1.090316e-02 3 1  ON 66
ci_0018                 1.137597e-02 3 1  ON 67
ci_0019                 1.137546e-02 3 1  ON 68
ci_0020                 1.168217e-02 3 1  ON 69
ci_0021                -6.759587e-04 3 1  ON 70
ci_0022                -8.710383e-04 3 1  ON 71
ci_0023                -1.150908e-02 3 1  ON 72
ci_0024                -1.121622e-02 3 1  ON 73
ci_0025                -1.037686e-02 3 1  ON 74
ci_0026                -1.051443e-02 3 1  ON 75
ci_0027                -1.098654e-02 3 1  ON 76
ci_0028                -1.099031e-02 3 1  ON 77
ci_0029                -1.103405e-02 3 1  ON 78
ci_0030                -1.072487e-02 3 1  ON 79
ci_0031                 2.015534e-02 3 1  ON 80
ci_0032                 2.016935e-02 3 1  ON 81
ci_0033                 9.895255e-03 3 1  ON 82
ci_0034                 1.032155e-02 3 1  ON 83
ci_0035                 6.674167e-03 3 1  ON 84
ci_0036                 6.841056e-03 3 1  ON 85
ci_0037                -1.025028e-02 3 1  ON 86
ci_0038                -1.054941e-02 3 1  ON 87
ci_0039                -2.668988e-03 3 1  ON 88
ci_0040                -2.369718e-03 3 1  ON 89
ci_0041                 7.446627e-03 3 1  ON 90
ci_0042                 7.166271e-03 3 1  ON 91
ci_0043                -1.786339e-02 3 1  ON 92
ci_0044                -1.892348e-02 3 1  ON 93
ci_0045                 7.783732e-03 3 1  ON 94
ci_0046                 7.524295e-03 3 1  ON 95
ci_0047                -1.897091e-03 3 1  ON 96
ci_0048                -1.524898e-03 3 1  ON 97
ci_0049                -5.472990e-03 3 1  ON 98
ci_0050                -5.854020e-03 3 1  ON 99
ci_0051                -3.551895e-03 3 1  ON 100
ci_0052                -3.678391e-03 3 1  ON 101
ci_0053                -4.923082e-03 3 1  ON 102
ci_0054                -4.701060e-03 3 1  ON 103
ci_0055                 6.210191e-03 3 1  ON 104
ci_0056                 6.746910e-03 3 1  ON 105
ci_0057                 5.029016e-03 3 1  ON 106
ci_0058                 4.898658e-03 3 1  ON 107
ci_0059                -4.991114e-03 3 1  ON 108
ci_0060                -4.796190e-03 3 1  ON 109
ci_0061                -3.942498e-03 3 1  ON 110
ci_0062                -3.877405e-03 3 1  ON 111
ci_0063                -8.634800e-03 3 1  ON 112
ci_0064                -8.685546e-03 3 1  ON 113
ci_0065                -5.355438e-03 3 1  ON 114
ci_0066                -5.159902e-03 3 1  ON 115
ci_0067                -4.878025e-03 3 1  ON 116
ci_0068                -4.653163e-03 3 1  ON 117
ci_0069                 4.346046e-03 3 1  ON 118
ci_0070                 4.681731e-03 3 1  ON 119
ci_0071                 1.357664e-04 3 1  ON 120
ci_0072                 9.111991e-04 3 1  ON 121
ci_0073                 4.325031e-03 3 1  ON 122
ci_0074                 3.877899e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8542
    reference variance = 0.222204
====================================================
  Execution time = 2.2632e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4632e-01
  Total weights = 1.9517e+06
  Execution time = 2.0355e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325378995781
                                         uncertainty =       0.002521348724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325378995781
                                         uncertainty =       0.002521348724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403339491
  error estimate for blocks of size 2^( 2) =       0.000416270535
  error estimate for blocks of size 2^( 3) =       0.000429589439
  error estimate for blocks of size 2^( 4) =       0.000442709100
  error estimate for blocks of size 2^( 5) =       0.000453124634
  error estimate for blocks of size 2^( 6) =       0.000462912704
  error estimate for blocks of size 2^( 7) =       0.000467702471

      target function =                  N/A
              le_mean =     -16.905722111417
             les_mean =     286.149681196887
             stat err =       0.000456612227
             autocorr =       1.281603197720
              std dev =       0.570408178217
             le_variance =       0.325365489777

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325621534620
                                         uncertainty =       0.002465935119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325621534620
                                         uncertainty =       0.002465935119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403489769
  error estimate for blocks of size 2^( 2) =       0.000416434856
  error estimate for blocks of size 2^( 3) =       0.000429760896
  error estimate for blocks of size 2^( 4) =       0.000442886686
  error estimate for blocks of size 2^( 5) =       0.000453302139
  error estimate for blocks of size 2^( 6) =       0.000463114472
  error estimate for blocks of size 2^( 7) =       0.000467898619

      target function =                  N/A
              le_mean =     -16.905715795427
             les_mean =     286.151225148704
             stat err =       0.000456800479
             autocorr =       1.281704908386
              std dev =       0.570620703446
             le_variance =       0.325607987202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325477385337
                                         uncertainty =       0.002477720440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325477385337
                                         uncertainty =       0.002477720440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403400458
  error estimate for blocks of size 2^( 2) =       0.000416342572
  error estimate for blocks of size 2^( 3) =       0.000429666845
  error estimate for blocks of size 2^( 4) =       0.000442791721
  error estimate for blocks of size 2^( 5) =       0.000453209597
  error estimate for blocks of size 2^( 6) =       0.000463016338
  error estimate for blocks of size 2^( 7) =       0.000467804272

      target function =                  N/A
              le_mean =     -16.905714712445
             les_mean =     286.149809784218
             stat err =       0.000456705482
             autocorr =       1.281739225327
              std dev =       0.570494398896
             le_variance =       0.325463859172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325384362353
                                         uncertainty =       0.002514788008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325384362353
                                         uncertainty =       0.002514788008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403342813
  error estimate for blocks of size 2^( 2) =       0.000416275382
  error estimate for blocks of size 2^( 3) =       0.000429594948
  error estimate for blocks of size 2^( 4) =       0.000442715513
  error estimate for blocks of size 2^( 5) =       0.000453131135
  error estimate for blocks of size 2^( 6) =       0.000462922037
  error estimate for blocks of size 2^( 7) =       0.000467711572

      target function =                  N/A
              le_mean =     -16.905720500394
             les_mean =     286.149372956926
             stat err =       0.000456620064
             autocorr =       1.281626079787
              std dev =       0.570412876274
             le_variance =       0.325370849420


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905722111417        initial  <--
     3.8147e-01     3.8147e+00             9.5842e-04       -16.905715795427
     1.5259e+00     1.5259e+01             3.2273e-04       -16.905714712445
     6.1035e+00     6.1035e+01             8.8460e-05       -16.905720500394

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.3407
  </log>
  <optVariables href="H2O.s021.opt.xml">
   uu_0                 3.109543e-01 1 1  ON 0
   uu_1                 1.440381e-01 1 1  ON 1
   uu_2                 4.287114e-02 1 1  ON 2
   uu_3                -1.899103e-02 1 1  ON 3
   uu_4                -6.378493e-02 1 1  ON 4
   uu_5                -9.789554e-02 1 1  ON 5
   uu_6                -1.250075e-01 1 1  ON 6
   uu_7                -1.375854e-01 1 1  ON 7
   uu_8                -1.290745e-01 1 1  ON 8
   uu_9                -9.766602e-02 1 1  ON 9
   ud_0                 4.439958e-01 1 1  ON 10
   ud_1                 1.783986e-01 1 1  ON 11
   ud_2                 5.864672e-02 1 1  ON 12
   ud_3                -1.158548e-02 1 1  ON 13
   ud_4                -6.722616e-02 1 1  ON 14
   ud_5                -1.072244e-01 1 1  ON 15
   ud_6                -1.333578e-01 1 1  ON 16
   ud_7                -1.483584e-01 1 1  ON 17
   ud_8                -1.488224e-01 1 1  ON 18
   ud_9                -1.378839e-01 1 1  ON 19
   eO_0                -7.433678e-01 1 1  ON 20
   eO_1                -4.246815e-01 1 1  ON 21
   eO_2                -1.729479e-02 1 1  ON 22
   eO_3                 2.897412e-01 1 1  ON 23
   eO_4                 5.086712e-01 1 1  ON 24
   eO_5                 4.670717e-01 1 1  ON 25
   eO_6                 2.409100e-01 1 1  ON 26
   eO_7                -5.229992e-02 1 1  ON 27
   eO_8                -2.054028e-01 1 1  ON 28
   eO_9                -6.534275e-02 1 1  ON 29
  eH1_0                -2.432780e-01 1 1  ON 30
  eH1_1                -1.372109e-01 1 1  ON 31
  eH1_2                -8.801289e-02 1 1  ON 32
  eH1_3                -3.414700e-02 1 1  ON 33
  eH1_4                 1.425529e-02 1 1  ON 34
  eH1_5                 4.699604e-02 1 1  ON 35
  eH1_6                 9.986821e-02 1 1  ON 36
  eH1_7                 1.456974e-01 1 1  ON 37
  eH1_8                 1.572111e-01 1 1  ON 38
  eH1_9                 4.308559e-02 1 1  ON 39
  eH2_0                -2.413083e-01 1 1  ON 40
  eH2_1                -1.356368e-01 1 1  ON 41
  eH2_2                -8.620881e-02 1 1  ON 42
  eH2_3                -3.205820e-02 1 1  ON 43
  eH2_4                 1.702101e-02 1 1  ON 44
  eH2_5                 5.104772e-02 1 1  ON 45
  eH2_6                 1.045948e-01 1 1  ON 46
  eH2_7                 1.509535e-01 1 1  ON 47
  eH2_8                 1.635188e-01 1 1  ON 48
  eH2_9                 2.609908e-02 1 1  ON 49
ci_0001                 7.011449e-01 3 1  ON 50
ci_0002                 7.004196e-01 3 1  ON 51
ci_0003                -2.814175e-02 3 1  ON 52
ci_0004                -2.786466e-02 3 1  ON 53
ci_0005                -3.683808e-02 3 1  ON 54
ci_0006                -3.721843e-02 3 1  ON 55
ci_0007                -2.221982e-02 3 1  ON 56
ci_0008                -2.183971e-02 3 1  ON 57
ci_0009                -1.745926e-02 3 1  ON 58
ci_0010                -1.748553e-02 3 1  ON 59
ci_0011                -1.203021e-02 3 1  ON 60
ci_0012                -1.228545e-02 3 1  ON 61
ci_0013                 1.330948e-02 3 1  ON 62
ci_0014                 1.356371e-02 3 1  ON 63
ci_0015                 1.311876e-02 3 1  ON 64
ci_0016                 1.294264e-02 3 1  ON 65
ci_0017                 1.100025e-02 3 1  ON 66
ci_0018                 1.123553e-02 3 1  ON 67
ci_0019                 1.138070e-02 3 1  ON 68
ci_0020                 1.168032e-02 3 1  ON 69
ci_0021                -5.622808e-04 3 1  ON 70
ci_0022                -7.926181e-04 3 1  ON 71
ci_0023                -1.144020e-02 3 1  ON 72
ci_0024                -1.142273e-02 3 1  ON 73
ci_0025                -1.029159e-02 3 1  ON 74
ci_0026                -1.045511e-02 3 1  ON 75
ci_0027                -1.099308e-02 3 1  ON 76
ci_0028                -1.088260e-02 3 1  ON 77
ci_0029                -1.107016e-02 3 1  ON 78
ci_0030                -1.084873e-02 3 1  ON 79
ci_0031                 2.016202e-02 3 1  ON 80
ci_0032                 2.005069e-02 3 1  ON 81
ci_0033                 9.849854e-03 3 1  ON 82
ci_0034                 1.049013e-02 3 1  ON 83
ci_0035                 6.686328e-03 3 1  ON 84
ci_0036                 6.911123e-03 3 1  ON 85
ci_0037                -1.026237e-02 3 1  ON 86
ci_0038                -1.069061e-02 3 1  ON 87
ci_0039                -2.652837e-03 3 1  ON 88
ci_0040                -2.416422e-03 3 1  ON 89
ci_0041                 7.505378e-03 3 1  ON 90
ci_0042                 7.232810e-03 3 1  ON 91
ci_0043                -1.785887e-02 3 1  ON 92
ci_0044                -1.893715e-02 3 1  ON 93
ci_0045                 7.878834e-03 3 1  ON 94
ci_0046                 7.654303e-03 3 1  ON 95
ci_0047                -1.852130e-03 3 1  ON 96
ci_0048                -1.555766e-03 3 1  ON 97
ci_0049                -5.400076e-03 3 1  ON 98
ci_0050                -5.924312e-03 3 1  ON 99
ci_0051                -3.653717e-03 3 1  ON 100
ci_0052                -3.603313e-03 3 1  ON 101
ci_0053                -5.026649e-03 3 1  ON 102
ci_0054                -4.573333e-03 3 1  ON 103
ci_0055                 6.219330e-03 3 1  ON 104
ci_0056                 6.683327e-03 3 1  ON 105
ci_0057                 4.943124e-03 3 1  ON 106
ci_0058                 4.822715e-03 3 1  ON 107
ci_0059                -4.934838e-03 3 1  ON 108
ci_0060                -4.756448e-03 3 1  ON 109
ci_0061                -3.829619e-03 3 1  ON 110
ci_0062                -3.842402e-03 3 1  ON 111
ci_0063                -8.734564e-03 3 1  ON 112
ci_0064                -8.681030e-03 3 1  ON 113
ci_0065                -5.325664e-03 3 1  ON 114
ci_0066                -5.193789e-03 3 1  ON 115
ci_0067                -4.866917e-03 3 1  ON 116
ci_0068                -4.730540e-03 3 1  ON 117
ci_0069                 4.193315e-03 3 1  ON 118
ci_0070                 4.654151e-03 3 1  ON 119
ci_0071                 7.457050e-06 3 1  ON 120
ci_0072                 6.922886e-04 3 1  ON 121
ci_0073                 4.399502e-03 3 1  ON 122
ci_0074                 3.932908e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9671e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8731
    reference variance = 0.198421
====================================================
  Execution time = 2.0991e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5231e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3624e-01
  Total weights = 1.951834497e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0834e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322301547547
                                         uncertainty =       0.002134529365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322301547547
                                         uncertainty =       0.002134529365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401357382
  error estimate for blocks of size 2^( 2) =       0.000414747638
  error estimate for blocks of size 2^( 3) =       0.000428848646
  error estimate for blocks of size 2^( 4) =       0.000442903121
  error estimate for blocks of size 2^( 5) =       0.000455101673
  error estimate for blocks of size 2^( 6) =       0.000463889593
  error estimate for blocks of size 2^( 7) =       0.000470897153

      target function =                  N/A
              le_mean =     -16.905973497582
             les_mean =     286.148176247034
             stat err =       0.000458197885
             autocorr =       1.303297763170
              std dev =       0.567605053028
             le_variance =       0.322175496223


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690597349758e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905973497557       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905973836255       residual = 6.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905973709442       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905973794177       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905973880791       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905973971562       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905973949593       residual = 8.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905973919657       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905973899719       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905973903804       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+00 is 9.674508e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905973497557       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905973586127       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905973553972       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905973574708       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905973603265       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905973615143       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905973628812       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905973617294       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905973609575       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905973607137       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+01 is 2.567694e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905973497557       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905973519957       residual = 7.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905973511892       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905973517040       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905973524634       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905973526989       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905973530818       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905973528229       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905973526198       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905973525562       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e+01 is 6.519890e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.356607 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7082e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
   uu_0                 3.109621e-01 1 1  ON 0
   uu_1                 1.440350e-01 1 1  ON 1
   uu_2                 4.286840e-02 1 1  ON 2
   uu_3                -1.899772e-02 1 1  ON 3
   uu_4                -6.378489e-02 1 1  ON 4
   uu_5                -9.789930e-02 1 1  ON 5
   uu_6                -1.250126e-01 1 1  ON 6
   uu_7                -1.375856e-01 1 1  ON 7
   uu_8                -1.290756e-01 1 1  ON 8
   uu_9                -9.766685e-02 1 1  ON 9
   ud_0                 4.439986e-01 1 1  ON 10
   ud_1                 1.783991e-01 1 1  ON 11
   ud_2                 5.865306e-02 1 1  ON 12
   ud_3                -1.158010e-02 1 1  ON 13
   ud_4                -6.722932e-02 1 1  ON 14
   ud_5                -1.072245e-01 1 1  ON 15
   ud_6                -1.333636e-01 1 1  ON 16
   ud_7                -1.483689e-01 1 1  ON 17
   ud_8                -1.488211e-01 1 1  ON 18
   ud_9                -1.378819e-01 1 1  ON 19
   eO_0                -7.433873e-01 1 1  ON 20
   eO_1                -4.246910e-01 1 1  ON 21
   eO_2                -1.729747e-02 1 1  ON 22
   eO_3                 2.897452e-01 1 1  ON 23
   eO_4                 5.086897e-01 1 1  ON 24
   eO_5                 4.670833e-01 1 1  ON 25
   eO_6                 2.409163e-01 1 1  ON 26
   eO_7                -5.229329e-02 1 1  ON 27
   eO_8                -2.054090e-01 1 1  ON 28
   eO_9                -6.535106e-02 1 1  ON 29
  eH1_0                -2.432859e-01 1 1  ON 30
  eH1_1                -1.372171e-01 1 1  ON 31
  eH1_2                -8.802947e-02 1 1  ON 32
  eH1_3                -3.415283e-02 1 1  ON 33
  eH1_4                 1.424387e-02 1 1  ON 34
  eH1_5                 4.699724e-02 1 1  ON 35
  eH1_6                 9.987745e-02 1 1  ON 36
  eH1_7                 1.457070e-01 1 1  ON 37
  eH1_8                 1.572231e-01 1 1  ON 38
  eH1_9                 4.309975e-02 1 1  ON 39
  eH2_0                -2.413110e-01 1 1  ON 40
  eH2_1                -1.356352e-01 1 1  ON 41
  eH2_2                -8.622121e-02 1 1  ON 42
  eH2_3                -3.206717e-02 1 1  ON 43
  eH2_4                 1.701573e-02 1 1  ON 44
  eH2_5                 5.103965e-02 1 1  ON 45
  eH2_6                 1.046006e-01 1 1  ON 46
  eH2_7                 1.509574e-01 1 1  ON 47
  eH2_8                 1.635286e-01 1 1  ON 48
  eH2_9                 2.611427e-02 1 1  ON 49
ci_0001                 7.011496e-01 3 1  ON 50
ci_0002                 7.004174e-01 3 1  ON 51
ci_0003                -2.813626e-02 3 1  ON 52
ci_0004                -2.786053e-02 3 1  ON 53
ci_0005                -3.682800e-02 3 1  ON 54
ci_0006                -3.721528e-02 3 1  ON 55
ci_0007                -2.221970e-02 3 1  ON 56
ci_0008                -2.183826e-02 3 1  ON 57
ci_0009                -1.745568e-02 3 1  ON 58
ci_0010                -1.748350e-02 3 1  ON 59
ci_0011                -1.204260e-02 3 1  ON 60
ci_0012                -1.228475e-02 3 1  ON 61
ci_0013                 1.330902e-02 3 1  ON 62
ci_0014                 1.355177e-02 3 1  ON 63
ci_0015                 1.312539e-02 3 1  ON 64
ci_0016                 1.293461e-02 3 1  ON 65
ci_0017                 1.099518e-02 3 1  ON 66
ci_0018                 1.122101e-02 3 1  ON 67
ci_0019                 1.138622e-02 3 1  ON 68
ci_0020                 1.167372e-02 3 1  ON 69
ci_0021                -5.581600e-04 3 1  ON 70
ci_0022                -7.899947e-04 3 1  ON 71
ci_0023                -1.142767e-02 3 1  ON 72
ci_0024                -1.140268e-02 3 1  ON 73
ci_0025                -1.028362e-02 3 1  ON 74
ci_0026                -1.044056e-02 3 1  ON 75
ci_0027                -1.098901e-02 3 1  ON 76
ci_0028                -1.090241e-02 3 1  ON 77
ci_0029                -1.106742e-02 3 1  ON 78
ci_0030                -1.083400e-02 3 1  ON 79
ci_0031                 2.016429e-02 3 1  ON 80
ci_0032                 2.005471e-02 3 1  ON 81
ci_0033                 9.835107e-03 3 1  ON 82
ci_0034                 1.048219e-02 3 1  ON 83
ci_0035                 6.702844e-03 3 1  ON 84
ci_0036                 6.912956e-03 3 1  ON 85
ci_0037                -1.026120e-02 3 1  ON 86
ci_0038                -1.069531e-02 3 1  ON 87
ci_0039                -2.640985e-03 3 1  ON 88
ci_0040                -2.432041e-03 3 1  ON 89
ci_0041                 7.501025e-03 3 1  ON 90
ci_0042                 7.226740e-03 3 1  ON 91
ci_0043                -1.786318e-02 3 1  ON 92
ci_0044                -1.892436e-02 3 1  ON 93
ci_0045                 7.883469e-03 3 1  ON 94
ci_0046                 7.654354e-03 3 1  ON 95
ci_0047                -1.844445e-03 3 1  ON 96
ci_0048                -1.568296e-03 3 1  ON 97
ci_0049                -5.396462e-03 3 1  ON 98
ci_0050                -5.912114e-03 3 1  ON 99
ci_0051                -3.641799e-03 3 1  ON 100
ci_0052                -3.601480e-03 3 1  ON 101
ci_0053                -5.012218e-03 3 1  ON 102
ci_0054                -4.563150e-03 3 1  ON 103
ci_0055                 6.217881e-03 3 1  ON 104
ci_0056                 6.695453e-03 3 1  ON 105
ci_0057                 4.941420e-03 3 1  ON 106
ci_0058                 4.835095e-03 3 1  ON 107
ci_0059                -4.929156e-03 3 1  ON 108
ci_0060                -4.755131e-03 3 1  ON 109
ci_0061                -3.825481e-03 3 1  ON 110
ci_0062                -3.842770e-03 3 1  ON 111
ci_0063                -8.726252e-03 3 1  ON 112
ci_0064                -8.700183e-03 3 1  ON 113
ci_0065                -5.321210e-03 3 1  ON 114
ci_0066                -5.207812e-03 3 1  ON 115
ci_0067                -4.859542e-03 3 1  ON 116
ci_0068                -4.735669e-03 3 1  ON 117
ci_0069                 4.196028e-03 3 1  ON 118
ci_0070                 4.670806e-03 3 1  ON 119
ci_0071                 8.562281e-06 3 1  ON 120
ci_0072                 6.996234e-04 3 1  ON 121
ci_0073                 4.400791e-03 3 1  ON 122
ci_0074                 3.958585e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8307
    reference variance = 0.262291
====================================================
  Execution time = 2.0888e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3986e-01
  Total weights = 1.9516e+06
  Execution time = 1.8898e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326248670159
                                         uncertainty =       0.004143924922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326248670159
                                         uncertainty =       0.004143924922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403873629
  error estimate for blocks of size 2^( 2) =       0.000416414568
  error estimate for blocks of size 2^( 3) =       0.000429199046
  error estimate for blocks of size 2^( 4) =       0.000441188679
  error estimate for blocks of size 2^( 5) =       0.000452124457
  error estimate for blocks of size 2^( 6) =       0.000459994036
  error estimate for blocks of size 2^( 7) =       0.000467071091

      target function =                  N/A
              le_mean =     -16.906328336559
             les_mean =     286.163849990337
             stat err =       0.000455094566
             autocorr =       1.269732705886
              std dev =       0.571163563314
             le_variance =       0.326227816057

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326209443880
                                         uncertainty =       0.004124227205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326209443880
                                         uncertainty =       0.004124227205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403849411
  error estimate for blocks of size 2^( 2) =       0.000416391552
  error estimate for blocks of size 2^( 3) =       0.000429177901
  error estimate for blocks of size 2^( 4) =       0.000441168491
  error estimate for blocks of size 2^( 5) =       0.000452105400
  error estimate for blocks of size 2^( 6) =       0.000459971350
  error estimate for blocks of size 2^( 7) =       0.000467050374

      target function =                  N/A
              le_mean =     -16.906328531918
             les_mean =     286.163962861934
             stat err =       0.000455073904
             autocorr =       1.269769689545
              std dev =       0.571129313975
             le_variance =       0.326188693282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326227565464
                                         uncertainty =       0.004133712826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326227565464
                                         uncertainty =       0.004133712826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403860599
  error estimate for blocks of size 2^( 2) =       0.000416402166
  error estimate for blocks of size 2^( 3) =       0.000429187637
  error estimate for blocks of size 2^( 4) =       0.000441177800
  error estimate for blocks of size 2^( 5) =       0.000452114177
  error estimate for blocks of size 2^( 6) =       0.000459981842
  error estimate for blocks of size 2^( 7) =       0.000467060064

      target function =                  N/A
              le_mean =     -16.906328369744
             les_mean =     286.163821827294
             stat err =       0.000455083470
             autocorr =       1.269752722977
              std dev =       0.571145136239
             le_variance =       0.326206766650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326245937134
                                         uncertainty =       0.004142631897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326245937134
                                         uncertainty =       0.004142631897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403871941
  error estimate for blocks of size 2^( 2) =       0.000416412979
  error estimate for blocks of size 2^( 3) =       0.000429197590
  error estimate for blocks of size 2^( 4) =       0.000441187250
  error estimate for blocks of size 2^( 5) =       0.000452123110
  error estimate for blocks of size 2^( 6) =       0.000459992507
  error estimate for blocks of size 2^( 7) =       0.000467069528

      target function =                  N/A
              le_mean =     -16.906328364950
             les_mean =     286.165258939841
             stat err =       0.000455093099
             autocorr =       1.269735129601
              std dev =       0.571161176959
             le_variance =       0.326225090065


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906328336559        initial
     3.8147e+00     3.8147e+01             9.6745e-05       -16.906328531918  <--
     1.5259e+01     1.5259e+02             2.5677e-05       -16.906328369744
     6.1035e+01     6.1035e+02             6.5199e-06       -16.906328364950

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 3.0467e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
   uu_0                 3.109846e-01 1 1  ON 0
   uu_1                 1.440266e-01 1 1  ON 1
   uu_2                 4.286024e-02 1 1  ON 2
   uu_3                -1.901638e-02 1 1  ON 3
   uu_4                -6.378592e-02 1 1  ON 4
   uu_5                -9.791037e-02 1 1  ON 5
   uu_6                -1.250278e-01 1 1  ON 6
   uu_7                -1.375866e-01 1 1  ON 7
   uu_8                -1.290793e-01 1 1  ON 8
   uu_9                -9.766932e-02 1 1  ON 9
   ud_0                 4.440067e-01 1 1  ON 10
   ud_1                 1.784020e-01 1 1  ON 11
   ud_2                 5.867096e-02 1 1  ON 12
   ud_3                -1.156481e-02 1 1  ON 13
   ud_4                -6.723757e-02 1 1  ON 14
   ud_5                -1.072259e-01 1 1  ON 15
   ud_6                -1.333807e-01 1 1  ON 16
   ud_7                -1.484001e-01 1 1  ON 17
   ud_8                -1.488178e-01 1 1  ON 18
   ud_9                -1.378760e-01 1 1  ON 19
   eO_0                -7.434444e-01 1 1  ON 20
   eO_1                -4.247210e-01 1 1  ON 21
   eO_2                -1.730515e-02 1 1  ON 22
   eO_3                 2.897577e-01 1 1  ON 23
   eO_4                 5.087445e-01 1 1  ON 24
   eO_5                 4.671182e-01 1 1  ON 25
   eO_6                 2.409353e-01 1 1  ON 26
   eO_7                -5.227358e-02 1 1  ON 27
   eO_8                -2.054278e-01 1 1  ON 28
   eO_9                -6.537592e-02 1 1  ON 29
  eH1_0                -2.433094e-01 1 1  ON 30
  eH1_1                -1.372366e-01 1 1  ON 31
  eH1_2                -8.807773e-02 1 1  ON 32
  eH1_3                -3.417117e-02 1 1  ON 33
  eH1_4                 1.421027e-02 1 1  ON 34
  eH1_5                 4.700046e-02 1 1  ON 35
  eH1_6                 9.990500e-02 1 1  ON 36
  eH1_7                 1.457360e-01 1 1  ON 37
  eH1_8                 1.572591e-01 1 1  ON 38
  eH1_9                 4.314214e-02 1 1  ON 39
  eH2_0                -2.413190e-01 1 1  ON 40
  eH2_1                -1.356320e-01 1 1  ON 41
  eH2_2                -8.625709e-02 1 1  ON 42
  eH2_3                -3.209389e-02 1 1  ON 43
  eH2_4                 1.699972e-02 1 1  ON 44
  eH2_5                 5.101570e-02 1 1  ON 45
  eH2_6                 1.046177e-01 1 1  ON 46
  eH2_7                 1.509694e-01 1 1  ON 47
  eH2_8                 1.635577e-01 1 1  ON 48
  eH2_9                 2.615971e-02 1 1  ON 49
ci_0001                 7.011633e-01 3 1  ON 50
ci_0002                 7.004111e-01 3 1  ON 51
ci_0003                -2.812049e-02 3 1  ON 52
ci_0004                -2.784848e-02 3 1  ON 53
ci_0005                -3.679861e-02 3 1  ON 54
ci_0006                -3.720631e-02 3 1  ON 55
ci_0007                -2.221924e-02 3 1  ON 56
ci_0008                -2.183376e-02 3 1  ON 57
ci_0009                -1.744570e-02 3 1  ON 58
ci_0010                -1.747796e-02 3 1  ON 59
ci_0011                -1.207803e-02 3 1  ON 60
ci_0012                -1.228312e-02 3 1  ON 61
ci_0013                 1.330779e-02 3 1  ON 62
ci_0014                 1.351783e-02 3 1  ON 63
ci_0015                 1.314432e-02 3 1  ON 64
ci_0016                 1.291185e-02 3 1  ON 65
ci_0017                 1.098089e-02 3 1  ON 66
ci_0018                 1.118029e-02 3 1  ON 67
ci_0019                 1.140199e-02 3 1  ON 68
ci_0020                 1.165518e-02 3 1  ON 69
ci_0021                -5.460304e-04 3 1  ON 70
ci_0022                -7.824764e-04 3 1  ON 71
ci_0023                -1.139229e-02 3 1  ON 72
ci_0024                -1.134609e-02 3 1  ON 73
ci_0025                -1.026093e-02 3 1  ON 74
ci_0026                -1.039916e-02 3 1  ON 75
ci_0027                -1.097758e-02 3 1  ON 76
ci_0028                -1.095906e-02 3 1  ON 77
ci_0029                -1.105967e-02 3 1  ON 78
ci_0030                -1.079225e-02 3 1  ON 79
ci_0031                 2.017070e-02 3 1  ON 80
ci_0032                 2.006642e-02 3 1  ON 81
ci_0033                 9.792076e-03 3 1  ON 82
ci_0034                 1.045903e-02 3 1  ON 83
ci_0035                 6.750010e-03 3 1  ON 84
ci_0036                 6.918238e-03 3 1  ON 85
ci_0037                -1.025797e-02 3 1  ON 86
ci_0038                -1.070860e-02 3 1  ON 87
ci_0039                -2.608532e-03 3 1  ON 88
ci_0040                -2.474916e-03 3 1  ON 89
ci_0041                 7.488583e-03 3 1  ON 90
ci_0042                 7.209503e-03 3 1  ON 91
ci_0043                -1.787584e-02 3 1  ON 92
ci_0044                -1.888679e-02 3 1  ON 93
ci_0045                 7.896828e-03 3 1  ON 94
ci_0046                 7.654492e-03 3 1  ON 95
ci_0047                -1.823306e-03 3 1  ON 96
ci_0048                -1.602789e-03 3 1  ON 97
ci_0049                -5.386127e-03 3 1  ON 98
ci_0050                -5.877580e-03 3 1  ON 99
ci_0051                -3.609056e-03 3 1  ON 100
ci_0052                -3.596419e-03 3 1  ON 101
ci_0053                -4.972202e-03 3 1  ON 102
ci_0054                -4.534840e-03 3 1  ON 103
ci_0055                 6.213736e-03 3 1  ON 104
ci_0056                 6.730405e-03 3 1  ON 105
ci_0057                 4.936492e-03 3 1  ON 106
ci_0058                 4.870508e-03 3 1  ON 107
ci_0059                -4.913345e-03 3 1  ON 108
ci_0060                -4.751476e-03 3 1  ON 109
ci_0061                -3.813685e-03 3 1  ON 110
ci_0062                -3.843688e-03 3 1  ON 111
ci_0063                -8.703066e-03 3 1  ON 112
ci_0064                -8.753569e-03 3 1  ON 113
ci_0065                -5.308538e-03 3 1  ON 114
ci_0066                -5.247430e-03 3 1  ON 115
ci_0067                -4.839254e-03 3 1  ON 116
ci_0068                -4.749965e-03 3 1  ON 117
ci_0069                 4.203633e-03 3 1  ON 118
ci_0070                 4.716872e-03 3 1  ON 119
ci_0071                 1.154671e-05 3 1  ON 120
ci_0072                 7.206110e-04 3 1  ON 121
ci_0073                 4.404358e-03 3 1  ON 122
ci_0074                 4.029654e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7557e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6886e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8834
    reference variance = 0.369075
====================================================
  Execution time = 2.1465e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3244e-01
  Total weights = 1.951615675e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0981e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318833139098
                                         uncertainty =       0.001781584301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318833139098
                                         uncertainty =       0.001781584301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399230292
  error estimate for blocks of size 2^( 2) =       0.000411790659
  error estimate for blocks of size 2^( 3) =       0.000424910531
  error estimate for blocks of size 2^( 4) =       0.000437430699
  error estimate for blocks of size 2^( 5) =       0.000447732125
  error estimate for blocks of size 2^( 6) =       0.000455829597
  error estimate for blocks of size 2^( 7) =       0.000457177724

      target function =                  N/A
              le_mean =     -16.905749086874
             les_mean =     286.136794641481
             stat err =       0.000449542536
             autocorr =       1.267928049453
              std dev =       0.564596893646
             le_variance =       0.318769652315


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574908687e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905749086852       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905751565047       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905750161449       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905749580337       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905749145232       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905749425909       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905749279432       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905749244232       residual = 8.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905749326948       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905749326757       residual = 9.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e-01 is 3.010908e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905749086852       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905749799916       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905749407185       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905749266345       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905749155399       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905749210880       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905749169560       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905749154520       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905749171091       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905749182100       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+00 is 8.727644e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905749086852       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905749272109       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905749170961       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905749137037       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905749109566       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905749120706       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905749111376       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905749106776       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905749110027       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905749113696       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+01 is 2.273416e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.360509 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7571e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
   uu_0                 3.110373e-01 1 1  ON 0
   uu_1                 1.440554e-01 1 1  ON 1
   uu_2                 4.286830e-02 1 1  ON 2
   uu_3                -1.902451e-02 1 1  ON 3
   uu_4                -6.381677e-02 1 1  ON 4
   uu_5                -9.793086e-02 1 1  ON 5
   uu_6                -1.250553e-01 1 1  ON 6
   uu_7                -1.376190e-01 1 1  ON 7
   uu_8                -1.291013e-01 1 1  ON 8
   uu_9                -9.767776e-02 1 1  ON 9
   ud_0                 4.440057e-01 1 1  ON 10
   ud_1                 1.784216e-01 1 1  ON 11
   ud_2                 5.867096e-02 1 1  ON 12
   ud_3                -1.155541e-02 1 1  ON 13
   ud_4                -6.722779e-02 1 1  ON 14
   ud_5                -1.072242e-01 1 1  ON 15
   ud_6                -1.333633e-01 1 1  ON 16
   ud_7                -1.484117e-01 1 1  ON 17
   ud_8                -1.488419e-01 1 1  ON 18
   ud_9                -1.378934e-01 1 1  ON 19
   eO_0                -7.434872e-01 1 1  ON 20
   eO_1                -4.247133e-01 1 1  ON 21
   eO_2                -1.731975e-02 1 1  ON 22
   eO_3                 2.897541e-01 1 1  ON 23
   eO_4                 5.087922e-01 1 1  ON 24
   eO_5                 4.671546e-01 1 1  ON 25
   eO_6                 2.409572e-01 1 1  ON 26
   eO_7                -5.226324e-02 1 1  ON 27
   eO_8                -2.054604e-01 1 1  ON 28
   eO_9                -6.540400e-02 1 1  ON 29
  eH1_0                -2.433488e-01 1 1  ON 30
  eH1_1                -1.372960e-01 1 1  ON 31
  eH1_2                -8.811357e-02 1 1  ON 32
  eH1_3                -3.419604e-02 1 1  ON 33
  eH1_4                 1.419498e-02 1 1  ON 34
  eH1_5                 4.699620e-02 1 1  ON 35
  eH1_6                 9.993679e-02 1 1  ON 36
  eH1_7                 1.457801e-01 1 1  ON 37
  eH1_8                 1.573113e-01 1 1  ON 38
  eH1_9                 4.318473e-02 1 1  ON 39
  eH2_0                -2.413744e-01 1 1  ON 40
  eH2_1                -1.356427e-01 1 1  ON 41
  eH2_2                -8.627648e-02 1 1  ON 42
  eH2_3                -3.208697e-02 1 1  ON 43
  eH2_4                 1.700944e-02 1 1  ON 44
  eH2_5                 5.098565e-02 1 1  ON 45
  eH2_6                 1.046142e-01 1 1  ON 46
  eH2_7                 1.509865e-01 1 1  ON 47
  eH2_8                 1.635969e-01 1 1  ON 48
  eH2_9                 2.620304e-02 1 1  ON 49
ci_0001                 7.011627e-01 3 1  ON 50
ci_0002                 7.004088e-01 3 1  ON 51
ci_0003                -2.812324e-02 3 1  ON 52
ci_0004                -2.779986e-02 3 1  ON 53
ci_0005                -3.683722e-02 3 1  ON 54
ci_0006                -3.725003e-02 3 1  ON 55
ci_0007                -2.220852e-02 3 1  ON 56
ci_0008                -2.182558e-02 3 1  ON 57
ci_0009                -1.746801e-02 3 1  ON 58
ci_0010                -1.747133e-02 3 1  ON 59
ci_0011                -1.209516e-02 3 1  ON 60
ci_0012                -1.230161e-02 3 1  ON 61
ci_0013                 1.322051e-02 3 1  ON 62
ci_0014                 1.351646e-02 3 1  ON 63
ci_0015                 1.311864e-02 3 1  ON 64
ci_0016                 1.288125e-02 3 1  ON 65
ci_0017                 1.094975e-02 3 1  ON 66
ci_0018                 1.115340e-02 3 1  ON 67
ci_0019                 1.139765e-02 3 1  ON 68
ci_0020                 1.163131e-02 3 1  ON 69
ci_0021                -5.846788e-04 3 1  ON 70
ci_0022                -7.879520e-04 3 1  ON 71
ci_0023                -1.135980e-02 3 1  ON 72
ci_0024                -1.135989e-02 3 1  ON 73
ci_0025                -1.024984e-02 3 1  ON 74
ci_0026                -1.037995e-02 3 1  ON 75
ci_0027                -1.097824e-02 3 1  ON 76
ci_0028                -1.096168e-02 3 1  ON 77
ci_0029                -1.103077e-02 3 1  ON 78
ci_0030                -1.080360e-02 3 1  ON 79
ci_0031                 2.019744e-02 3 1  ON 80
ci_0032                 2.013014e-02 3 1  ON 81
ci_0033                 9.804071e-03 3 1  ON 82
ci_0034                 1.046281e-02 3 1  ON 83
ci_0035                 6.736841e-03 3 1  ON 84
ci_0036                 6.948532e-03 3 1  ON 85
ci_0037                -1.030673e-02 3 1  ON 86
ci_0038                -1.071413e-02 3 1  ON 87
ci_0039                -2.598484e-03 3 1  ON 88
ci_0040                -2.479504e-03 3 1  ON 89
ci_0041                 7.502276e-03 3 1  ON 90
ci_0042                 7.157213e-03 3 1  ON 91
ci_0043                -1.795419e-02 3 1  ON 92
ci_0044                -1.891204e-02 3 1  ON 93
ci_0045                 7.891466e-03 3 1  ON 94
ci_0046                 7.648112e-03 3 1  ON 95
ci_0047                -1.816863e-03 3 1  ON 96
ci_0048                -1.614699e-03 3 1  ON 97
ci_0049                -5.365747e-03 3 1  ON 98
ci_0050                -5.868896e-03 3 1  ON 99
ci_0051                -3.604920e-03 3 1  ON 100
ci_0052                -3.594964e-03 3 1  ON 101
ci_0053                -4.904926e-03 3 1  ON 102
ci_0054                -4.533367e-03 3 1  ON 103
ci_0055                 6.208239e-03 3 1  ON 104
ci_0056                 6.686081e-03 3 1  ON 105
ci_0057                 4.963291e-03 3 1  ON 106
ci_0058                 4.862231e-03 3 1  ON 107
ci_0059                -4.891372e-03 3 1  ON 108
ci_0060                -4.800891e-03 3 1  ON 109
ci_0061                -3.844439e-03 3 1  ON 110
ci_0062                -3.847445e-03 3 1  ON 111
ci_0063                -8.681340e-03 3 1  ON 112
ci_0064                -8.708903e-03 3 1  ON 113
ci_0065                -5.321448e-03 3 1  ON 114
ci_0066                -5.232046e-03 3 1  ON 115
ci_0067                -4.903245e-03 3 1  ON 116
ci_0068                -4.753130e-03 3 1  ON 117
ci_0069                 4.171782e-03 3 1  ON 118
ci_0070                 4.718763e-03 3 1  ON 119
ci_0071                 1.812535e-05 3 1  ON 120
ci_0072                 6.846031e-04 3 1  ON 121
ci_0073                 4.445805e-03 3 1  ON 122
ci_0074                 4.040235e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9125
    reference variance = 0.376845
====================================================
  Execution time = 2.1494e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3240e-01
  Total weights = 1.9517e+06
  Execution time = 1.8880e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319539717144
                                         uncertainty =       0.001939072099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319539717144
                                         uncertainty =       0.001939072099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399686838
  error estimate for blocks of size 2^( 2) =       0.000412680670
  error estimate for blocks of size 2^( 3) =       0.000425696419
  error estimate for blocks of size 2^( 4) =       0.000438158553
  error estimate for blocks of size 2^( 5) =       0.000449088375
  error estimate for blocks of size 2^( 6) =       0.000458508735
  error estimate for blocks of size 2^( 7) =       0.000462931203

      target function =                  N/A
              le_mean =     -16.905521099835
             les_mean =     286.129278917566
             stat err =       0.000452171717
             autocorr =       1.279873637334
              std dev =       0.565242547077
             le_variance =       0.319499137027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319625792572
                                         uncertainty =       0.001943420742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319625792572
                                         uncertainty =       0.001943420742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399740724
  error estimate for blocks of size 2^( 2) =       0.000412735972
  error estimate for blocks of size 2^( 3) =       0.000425755573
  error estimate for blocks of size 2^( 4) =       0.000438218849
  error estimate for blocks of size 2^( 5) =       0.000449155032
  error estimate for blocks of size 2^( 6) =       0.000458568618
  error estimate for blocks of size 2^( 7) =       0.000462982099

      target function =                  N/A
              le_mean =     -16.905518682019
             les_mean =     286.134267497289
             stat err =       0.000452231149
             autocorr =       1.279864982366
              std dev =       0.565318753139
             le_variance =       0.319585292651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319580822938
                                         uncertainty =       0.001941464994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319580822938
                                         uncertainty =       0.001941464994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399712581
  error estimate for blocks of size 2^( 2) =       0.000412708383
  error estimate for blocks of size 2^( 3) =       0.000425726450
  error estimate for blocks of size 2^( 4) =       0.000438189022
  error estimate for blocks of size 2^( 5) =       0.000449122996
  error estimate for blocks of size 2^( 6) =       0.000458539140
  error estimate for blocks of size 2^( 7) =       0.000462957465

      target function =                  N/A
              le_mean =     -16.905519725186
             les_mean =     286.129043957161
             stat err =       0.000452202156
             autocorr =       1.279881084722
              std dev =       0.565278953323
             le_variance =       0.319540295070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319544356687
                                         uncertainty =       0.001939365203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319544356687
                                         uncertainty =       0.001939365203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399689745
  error estimate for blocks of size 2^( 2) =       0.000412683825
  error estimate for blocks of size 2^( 3) =       0.000425699887
  error estimate for blocks of size 2^( 4) =       0.000438162148
  error estimate for blocks of size 2^( 5) =       0.000449092470
  error estimate for blocks of size 2^( 6) =       0.000458512224
  error estimate for blocks of size 2^( 7) =       0.000462934332

      target function =                  N/A
              le_mean =     -16.905520904586
             les_mean =     286.129089845208
             stat err =       0.000452175294
             autocorr =       1.279875272270
              std dev =       0.565246657522
             le_variance =       0.319503783839


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905521099835        initial  <--
     9.5367e-01     9.5367e+00             3.0109e-04       -16.905518682019
     3.8147e+00     3.8147e+01             8.7276e-05       -16.905519725186
     1.5259e+01     1.5259e+02             2.2734e-05       -16.905520904586

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0647
  </log>
  <optVariables href="H2O.s023.opt.xml">
   uu_0                 3.109846e-01 1 1  ON 0
   uu_1                 1.440266e-01 1 1  ON 1
   uu_2                 4.286024e-02 1 1  ON 2
   uu_3                -1.901638e-02 1 1  ON 3
   uu_4                -6.378592e-02 1 1  ON 4
   uu_5                -9.791037e-02 1 1  ON 5
   uu_6                -1.250278e-01 1 1  ON 6
   uu_7                -1.375866e-01 1 1  ON 7
   uu_8                -1.290793e-01 1 1  ON 8
   uu_9                -9.766932e-02 1 1  ON 9
   ud_0                 4.440067e-01 1 1  ON 10
   ud_1                 1.784020e-01 1 1  ON 11
   ud_2                 5.867096e-02 1 1  ON 12
   ud_3                -1.156481e-02 1 1  ON 13
   ud_4                -6.723757e-02 1 1  ON 14
   ud_5                -1.072259e-01 1 1  ON 15
   ud_6                -1.333807e-01 1 1  ON 16
   ud_7                -1.484001e-01 1 1  ON 17
   ud_8                -1.488178e-01 1 1  ON 18
   ud_9                -1.378760e-01 1 1  ON 19
   eO_0                -7.434444e-01 1 1  ON 20
   eO_1                -4.247210e-01 1 1  ON 21
   eO_2                -1.730515e-02 1 1  ON 22
   eO_3                 2.897577e-01 1 1  ON 23
   eO_4                 5.087445e-01 1 1  ON 24
   eO_5                 4.671182e-01 1 1  ON 25
   eO_6                 2.409353e-01 1 1  ON 26
   eO_7                -5.227358e-02 1 1  ON 27
   eO_8                -2.054278e-01 1 1  ON 28
   eO_9                -6.537592e-02 1 1  ON 29
  eH1_0                -2.433094e-01 1 1  ON 30
  eH1_1                -1.372366e-01 1 1  ON 31
  eH1_2                -8.807773e-02 1 1  ON 32
  eH1_3                -3.417117e-02 1 1  ON 33
  eH1_4                 1.421027e-02 1 1  ON 34
  eH1_5                 4.700046e-02 1 1  ON 35
  eH1_6                 9.990500e-02 1 1  ON 36
  eH1_7                 1.457360e-01 1 1  ON 37
  eH1_8                 1.572591e-01 1 1  ON 38
  eH1_9                 4.314214e-02 1 1  ON 39
  eH2_0                -2.413190e-01 1 1  ON 40
  eH2_1                -1.356320e-01 1 1  ON 41
  eH2_2                -8.625709e-02 1 1  ON 42
  eH2_3                -3.209389e-02 1 1  ON 43
  eH2_4                 1.699972e-02 1 1  ON 44
  eH2_5                 5.101570e-02 1 1  ON 45
  eH2_6                 1.046177e-01 1 1  ON 46
  eH2_7                 1.509694e-01 1 1  ON 47
  eH2_8                 1.635577e-01 1 1  ON 48
  eH2_9                 2.615971e-02 1 1  ON 49
ci_0001                 7.011633e-01 3 1  ON 50
ci_0002                 7.004111e-01 3 1  ON 51
ci_0003                -2.812049e-02 3 1  ON 52
ci_0004                -2.784848e-02 3 1  ON 53
ci_0005                -3.679861e-02 3 1  ON 54
ci_0006                -3.720631e-02 3 1  ON 55
ci_0007                -2.221924e-02 3 1  ON 56
ci_0008                -2.183376e-02 3 1  ON 57
ci_0009                -1.744570e-02 3 1  ON 58
ci_0010                -1.747796e-02 3 1  ON 59
ci_0011                -1.207803e-02 3 1  ON 60
ci_0012                -1.228312e-02 3 1  ON 61
ci_0013                 1.330779e-02 3 1  ON 62
ci_0014                 1.351783e-02 3 1  ON 63
ci_0015                 1.314432e-02 3 1  ON 64
ci_0016                 1.291185e-02 3 1  ON 65
ci_0017                 1.098089e-02 3 1  ON 66
ci_0018                 1.118029e-02 3 1  ON 67
ci_0019                 1.140199e-02 3 1  ON 68
ci_0020                 1.165518e-02 3 1  ON 69
ci_0021                -5.460304e-04 3 1  ON 70
ci_0022                -7.824764e-04 3 1  ON 71
ci_0023                -1.139229e-02 3 1  ON 72
ci_0024                -1.134609e-02 3 1  ON 73
ci_0025                -1.026093e-02 3 1  ON 74
ci_0026                -1.039916e-02 3 1  ON 75
ci_0027                -1.097758e-02 3 1  ON 76
ci_0028                -1.095906e-02 3 1  ON 77
ci_0029                -1.105967e-02 3 1  ON 78
ci_0030                -1.079225e-02 3 1  ON 79
ci_0031                 2.017070e-02 3 1  ON 80
ci_0032                 2.006642e-02 3 1  ON 81
ci_0033                 9.792076e-03 3 1  ON 82
ci_0034                 1.045903e-02 3 1  ON 83
ci_0035                 6.750010e-03 3 1  ON 84
ci_0036                 6.918238e-03 3 1  ON 85
ci_0037                -1.025797e-02 3 1  ON 86
ci_0038                -1.070860e-02 3 1  ON 87
ci_0039                -2.608532e-03 3 1  ON 88
ci_0040                -2.474916e-03 3 1  ON 89
ci_0041                 7.488583e-03 3 1  ON 90
ci_0042                 7.209503e-03 3 1  ON 91
ci_0043                -1.787584e-02 3 1  ON 92
ci_0044                -1.888679e-02 3 1  ON 93
ci_0045                 7.896828e-03 3 1  ON 94
ci_0046                 7.654492e-03 3 1  ON 95
ci_0047                -1.823306e-03 3 1  ON 96
ci_0048                -1.602789e-03 3 1  ON 97
ci_0049                -5.386127e-03 3 1  ON 98
ci_0050                -5.877580e-03 3 1  ON 99
ci_0051                -3.609056e-03 3 1  ON 100
ci_0052                -3.596419e-03 3 1  ON 101
ci_0053                -4.972202e-03 3 1  ON 102
ci_0054                -4.534840e-03 3 1  ON 103
ci_0055                 6.213736e-03 3 1  ON 104
ci_0056                 6.730405e-03 3 1  ON 105
ci_0057                 4.936492e-03 3 1  ON 106
ci_0058                 4.870508e-03 3 1  ON 107
ci_0059                -4.913345e-03 3 1  ON 108
ci_0060                -4.751476e-03 3 1  ON 109
ci_0061                -3.813685e-03 3 1  ON 110
ci_0062                -3.843688e-03 3 1  ON 111
ci_0063                -8.703066e-03 3 1  ON 112
ci_0064                -8.753569e-03 3 1  ON 113
ci_0065                -5.308538e-03 3 1  ON 114
ci_0066                -5.247430e-03 3 1  ON 115
ci_0067                -4.839254e-03 3 1  ON 116
ci_0068                -4.749965e-03 3 1  ON 117
ci_0069                 4.203633e-03 3 1  ON 118
ci_0070                 4.716872e-03 3 1  ON 119
ci_0071                 1.154671e-05 3 1  ON 120
ci_0072                 7.206110e-04 3 1  ON 121
ci_0073                 4.404358e-03 3 1  ON 122
ci_0074                 4.029654e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8643e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6886e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9435
    reference variance = 0.158482
====================================================
  Execution time = 2.1466e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5231e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2949e-01
  Total weights = 1.951881806e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1647e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318246247084
                                         uncertainty =       0.002005838845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318246247084
                                         uncertainty =       0.002005838845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398830415
  error estimate for blocks of size 2^( 2) =       0.000411917276
  error estimate for blocks of size 2^( 3) =       0.000424780058
  error estimate for blocks of size 2^( 4) =       0.000436433928
  error estimate for blocks of size 2^( 5) =       0.000446396308
  error estimate for blocks of size 2^( 6) =       0.000453278945
  error estimate for blocks of size 2^( 7) =       0.000458306509

      target function =                  N/A
              le_mean =     -16.905962169333
             les_mean =     286.141046625972
             stat err =       0.000448603923
             autocorr =       1.265172059327
              std dev =       0.564031382406
             le_variance =       0.318131400339


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690596216933e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905962169342       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905961948631       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905961828536       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905961792675       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905961790714       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905961784282       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905961802219       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905961804390       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905961818363       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905961821034       residual = 3.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+00 is 3.378703e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905962169342       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905962113255       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905962082359       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905962072698       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905962071535       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905962069525       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905962074089       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905962074646       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905962078177       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905962079157       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+01 is 8.654279e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905962169342       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905962155262       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905962147482       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905962145023       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905962144689       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905962144157       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905962145302       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905962145443       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905962146327       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905962146592       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+02 is 2.176949e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.364399 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7639e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
   uu_0                 3.109894e-01 1 1  ON 0
   uu_1                 1.440300e-01 1 1  ON 1
   uu_2                 4.285972e-02 1 1  ON 2
   uu_3                -1.901555e-02 1 1  ON 3
   uu_4                -6.378744e-02 1 1  ON 4
   uu_5                -9.791332e-02 1 1  ON 5
   uu_6                -1.250253e-01 1 1  ON 6
   uu_7                -1.375897e-01 1 1  ON 7
   uu_8                -1.290849e-01 1 1  ON 8
   uu_9                -9.767229e-02 1 1  ON 9
   ud_0                 4.440065e-01 1 1  ON 10
   ud_1                 1.784039e-01 1 1  ON 11
   ud_2                 5.867212e-02 1 1  ON 12
   ud_3                -1.156124e-02 1 1  ON 13
   ud_4                -6.723654e-02 1 1  ON 14
   ud_5                -1.072252e-01 1 1  ON 15
   ud_6                -1.333806e-01 1 1  ON 16
   ud_7                -1.484025e-01 1 1  ON 17
   ud_8                -1.488204e-01 1 1  ON 18
   ud_9                -1.378780e-01 1 1  ON 19
   eO_0                -7.434481e-01 1 1  ON 20
   eO_1                -4.247235e-01 1 1  ON 21
   eO_2                -1.730506e-02 1 1  ON 22
   eO_3                 2.897588e-01 1 1  ON 23
   eO_4                 5.087508e-01 1 1  ON 24
   eO_5                 4.671234e-01 1 1  ON 25
   eO_6                 2.409373e-01 1 1  ON 26
   eO_7                -5.227241e-02 1 1  ON 27
   eO_8                -2.054332e-01 1 1  ON 28
   eO_9                -6.537967e-02 1 1  ON 29
  eH1_0                -2.433155e-01 1 1  ON 30
  eH1_1                -1.372391e-01 1 1  ON 31
  eH1_2                -8.808122e-02 1 1  ON 32
  eH1_3                -3.417227e-02 1 1  ON 33
  eH1_4                 1.421054e-02 1 1  ON 34
  eH1_5                 4.699989e-02 1 1  ON 35
  eH1_6                 9.990629e-02 1 1  ON 36
  eH1_7                 1.457388e-01 1 1  ON 37
  eH1_8                 1.572635e-01 1 1  ON 38
  eH1_9                 4.314674e-02 1 1  ON 39
  eH2_0                -2.413216e-01 1 1  ON 40
  eH2_1                -1.356349e-01 1 1  ON 41
  eH2_2                -8.625703e-02 1 1  ON 42
  eH2_3                -3.209415e-02 1 1  ON 43
  eH2_4                 1.699705e-02 1 1  ON 44
  eH2_5                 5.101168e-02 1 1  ON 45
  eH2_6                 1.046167e-01 1 1  ON 46
  eH2_7                 1.509722e-01 1 1  ON 47
  eH2_8                 1.635625e-01 1 1  ON 48
  eH2_9                 2.616515e-02 1 1  ON 49
ci_0001                 7.011640e-01 3 1  ON 50
ci_0002                 7.004105e-01 3 1  ON 51
ci_0003                -2.811980e-02 3 1  ON 52
ci_0004                -2.784974e-02 3 1  ON 53
ci_0005                -3.679613e-02 3 1  ON 54
ci_0006                -3.720040e-02 3 1  ON 55
ci_0007                -2.221535e-02 3 1  ON 56
ci_0008                -2.183666e-02 3 1  ON 57
ci_0009                -1.744642e-02 3 1  ON 58
ci_0010                -1.747615e-02 3 1  ON 59
ci_0011                -1.208052e-02 3 1  ON 60
ci_0012                -1.228777e-02 3 1  ON 61
ci_0013                 1.330572e-02 3 1  ON 62
ci_0014                 1.351525e-02 3 1  ON 63
ci_0015                 1.314493e-02 3 1  ON 64
ci_0016                 1.290564e-02 3 1  ON 65
ci_0017                 1.098077e-02 3 1  ON 66
ci_0018                 1.118211e-02 3 1  ON 67
ci_0019                 1.140274e-02 3 1  ON 68
ci_0020                 1.165694e-02 3 1  ON 69
ci_0021                -5.500815e-04 3 1  ON 70
ci_0022                -7.834693e-04 3 1  ON 71
ci_0023                -1.139253e-02 3 1  ON 72
ci_0024                -1.134826e-02 3 1  ON 73
ci_0025                -1.025902e-02 3 1  ON 74
ci_0026                -1.040474e-02 3 1  ON 75
ci_0027                -1.097742e-02 3 1  ON 76
ci_0028                -1.095848e-02 3 1  ON 77
ci_0029                -1.105974e-02 3 1  ON 78
ci_0030                -1.078721e-02 3 1  ON 79
ci_0031                 2.016596e-02 3 1  ON 80
ci_0032                 2.007257e-02 3 1  ON 81
ci_0033                 9.790066e-03 3 1  ON 82
ci_0034                 1.045801e-02 3 1  ON 83
ci_0035                 6.748006e-03 3 1  ON 84
ci_0036                 6.922238e-03 3 1  ON 85
ci_0037                -1.025666e-02 3 1  ON 86
ci_0038                -1.070893e-02 3 1  ON 87
ci_0039                -2.609765e-03 3 1  ON 88
ci_0040                -2.479393e-03 3 1  ON 89
ci_0041                 7.482833e-03 3 1  ON 90
ci_0042                 7.211816e-03 3 1  ON 91
ci_0043                -1.787893e-02 3 1  ON 92
ci_0044                -1.889052e-02 3 1  ON 93
ci_0045                 7.895657e-03 3 1  ON 94
ci_0046                 7.657207e-03 3 1  ON 95
ci_0047                -1.827943e-03 3 1  ON 96
ci_0048                -1.605484e-03 3 1  ON 97
ci_0049                -5.390308e-03 3 1  ON 98
ci_0050                -5.877664e-03 3 1  ON 99
ci_0051                -3.611207e-03 3 1  ON 100
ci_0052                -3.596933e-03 3 1  ON 101
ci_0053                -4.976481e-03 3 1  ON 102
ci_0054                -4.539757e-03 3 1  ON 103
ci_0055                 6.217171e-03 3 1  ON 104
ci_0056                 6.733055e-03 3 1  ON 105
ci_0057                 4.931326e-03 3 1  ON 106
ci_0058                 4.871406e-03 3 1  ON 107
ci_0059                -4.908536e-03 3 1  ON 108
ci_0060                -4.742822e-03 3 1  ON 109
ci_0061                -3.812227e-03 3 1  ON 110
ci_0062                -3.841134e-03 3 1  ON 111
ci_0063                -8.704865e-03 3 1  ON 112
ci_0064                -8.758497e-03 3 1  ON 113
ci_0065                -5.302726e-03 3 1  ON 114
ci_0066                -5.248857e-03 3 1  ON 115
ci_0067                -4.840751e-03 3 1  ON 116
ci_0068                -4.750341e-03 3 1  ON 117
ci_0069                 4.211482e-03 3 1  ON 118
ci_0070                 4.712512e-03 3 1  ON 119
ci_0071                 9.278316e-06 3 1  ON 120
ci_0072                 7.207532e-04 3 1  ON 121
ci_0073                 4.401302e-03 3 1  ON 122
ci_0074                 4.033741e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8682
    reference variance = 0.29855
====================================================
  Execution time = 2.1301e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3224e-01
  Total weights = 1.9516e+06
  Execution time = 1.9037e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319062223198
                                         uncertainty =       0.002112656627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319062223198
                                         uncertainty =       0.002112656627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399430731
  error estimate for blocks of size 2^( 2) =       0.000412324119
  error estimate for blocks of size 2^( 3) =       0.000425911612
  error estimate for blocks of size 2^( 4) =       0.000437880469
  error estimate for blocks of size 2^( 5) =       0.000449210400
  error estimate for blocks of size 2^( 6) =       0.000457907753
  error estimate for blocks of size 2^( 7) =       0.000461724363

      target function =                  N/A
              le_mean =     -16.906450693743
             les_mean =     286.160298128201
             stat err =       0.000451680746
             autocorr =       1.278733983019
              std dev =       0.564880356504
             le_variance =       0.319089817164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319076038040
                                         uncertainty =       0.002112880429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319076038040
                                         uncertainty =       0.002112880429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399439459
  error estimate for blocks of size 2^( 2) =       0.000412331736
  error estimate for blocks of size 2^( 3) =       0.000425918310
  error estimate for blocks of size 2^( 4) =       0.000437887207
  error estimate for blocks of size 2^( 5) =       0.000449217744
  error estimate for blocks of size 2^( 6) =       0.000457914164
  error estimate for blocks of size 2^( 7) =       0.000461729922

      target function =                  N/A
              le_mean =     -16.906451122392
             les_mean =     286.160415189895
             stat err =       0.000451687259
             autocorr =       1.278714977973
              std dev =       0.564892699646
             le_variance =       0.319103762113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319069203859
                                         uncertainty =       0.002112769552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319069203859
                                         uncertainty =       0.002112769552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399435141
  error estimate for blocks of size 2^( 2) =       0.000412327962
  error estimate for blocks of size 2^( 3) =       0.000425914986
  error estimate for blocks of size 2^( 4) =       0.000437883867
  error estimate for blocks of size 2^( 5) =       0.000449214107
  error estimate for blocks of size 2^( 6) =       0.000457910990
  error estimate for blocks of size 2^( 7) =       0.000461727165

      target function =                  N/A
              le_mean =     -16.906450904353
             les_mean =     286.160352230806
             stat err =       0.000451684032
             autocorr =       1.278724350165
              std dev =       0.564886593853
             le_variance =       0.319096863915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319063092373
                                         uncertainty =       0.002112670724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319063092373
                                         uncertainty =       0.002112670724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399431280
  error estimate for blocks of size 2^( 2) =       0.000412324597
  error estimate for blocks of size 2^( 3) =       0.000425912031
  error estimate for blocks of size 2^( 4) =       0.000437880892
  error estimate for blocks of size 2^( 5) =       0.000449210861
  error estimate for blocks of size 2^( 6) =       0.000457908155
  error estimate for blocks of size 2^( 7) =       0.000461724710

      target function =                  N/A
              le_mean =     -16.906450719210
             les_mean =     286.160303916140
             stat err =       0.000451681154
             autocorr =       1.278732778597
              std dev =       0.564881133169
             le_variance =       0.319090694610


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906450693743        initial
     9.5367e+00     9.5367e+01             3.3787e-05       -16.906451122392  <--
     3.8147e+01     3.8147e+02             8.6543e-06       -16.906450904353
     1.5259e+02     1.5259e+03             2.1769e-06       -16.906450719210

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 3.0905e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
   uu_0                 3.110037e-01 1 1  ON 0
   uu_1                 1.440398e-01 1 1  ON 1
   uu_2                 4.285853e-02 1 1  ON 2
   uu_3                -1.901328e-02 1 1  ON 3
   uu_4                -6.379175e-02 1 1  ON 4
   uu_5                -9.792204e-02 1 1  ON 5
   uu_6                -1.250181e-01 1 1  ON 6
   uu_7                -1.375989e-01 1 1  ON 7
   uu_8                -1.291018e-01 1 1  ON 8
   uu_9                -9.768119e-02 1 1  ON 9
   ud_0                 4.440059e-01 1 1  ON 10
   ud_1                 1.784094e-01 1 1  ON 11
   ud_2                 5.867575e-02 1 1  ON 12
   ud_3                -1.155085e-02 1 1  ON 13
   ud_4                -6.723334e-02 1 1  ON 14
   ud_5                -1.072230e-01 1 1  ON 15
   ud_6                -1.333804e-01 1 1  ON 16
   ud_7                -1.484097e-01 1 1  ON 17
   ud_8                -1.488282e-01 1 1  ON 18
   ud_9                -1.378842e-01 1 1  ON 19
   eO_0                -7.434590e-01 1 1  ON 20
   eO_1                -4.247310e-01 1 1  ON 21
   eO_2                -1.730495e-02 1 1  ON 22
   eO_3                 2.897621e-01 1 1  ON 23
   eO_4                 5.087694e-01 1 1  ON 24
   eO_5                 4.671391e-01 1 1  ON 25
   eO_6                 2.409435e-01 1 1  ON 26
   eO_7                -5.226890e-02 1 1  ON 27
   eO_8                -2.054496e-01 1 1  ON 28
   eO_9                -6.539090e-02 1 1  ON 29
  eH1_0                -2.433337e-01 1 1  ON 30
  eH1_1                -1.372465e-01 1 1  ON 31
  eH1_2                -8.809157e-02 1 1  ON 32
  eH1_3                -3.417564e-02 1 1  ON 33
  eH1_4                 1.421131e-02 1 1  ON 34
  eH1_5                 4.699823e-02 1 1  ON 35
  eH1_6                 9.991019e-02 1 1  ON 36
  eH1_7                 1.457472e-01 1 1  ON 37
  eH1_8                 1.572765e-01 1 1  ON 38
  eH1_9                 4.316052e-02 1 1  ON 39
  eH2_0                -2.413295e-01 1 1  ON 40
  eH2_1                -1.356437e-01 1 1  ON 41
  eH2_2                -8.625698e-02 1 1  ON 42
  eH2_3                -3.209501e-02 1 1  ON 43
  eH2_4                 1.698911e-02 1 1  ON 44
  eH2_5                 5.099963e-02 1 1  ON 45
  eH2_6                 1.046138e-01 1 1  ON 46
  eH2_7                 1.509807e-01 1 1  ON 47
  eH2_8                 1.635767e-01 1 1  ON 48
  eH2_9                 2.618142e-02 1 1  ON 49
ci_0001                 7.011662e-01 3 1  ON 50
ci_0002                 7.004088e-01 3 1  ON 51
ci_0003                -2.811773e-02 3 1  ON 52
ci_0004                -2.785340e-02 3 1  ON 53
ci_0005                -3.678876e-02 3 1  ON 54
ci_0006                -3.718290e-02 3 1  ON 55
ci_0007                -2.220378e-02 3 1  ON 56
ci_0008                -2.184525e-02 3 1  ON 57
ci_0009                -1.744852e-02 3 1  ON 58
ci_0010                -1.747090e-02 3 1  ON 59
ci_0011                -1.208784e-02 3 1  ON 60
ci_0012                -1.230142e-02 3 1  ON 61
ci_0013                 1.329963e-02 3 1  ON 62
ci_0014                 1.350767e-02 3 1  ON 63
ci_0015                 1.314671e-02 3 1  ON 64
ci_0016                 1.288742e-02 3 1  ON 65
ci_0017                 1.098041e-02 3 1  ON 66
ci_0018                 1.118744e-02 3 1  ON 67
ci_0019                 1.140493e-02 3 1  ON 68
ci_0020                 1.166210e-02 3 1  ON 69
ci_0021                -5.621346e-04 3 1  ON 70
ci_0022                -7.864341e-04 3 1  ON 71
ci_0023                -1.139320e-02 3 1  ON 72
ci_0024                -1.135462e-02 3 1  ON 73
ci_0025                -1.025343e-02 3 1  ON 74
ci_0026                -1.042111e-02 3 1  ON 75
ci_0027                -1.097694e-02 3 1  ON 76
ci_0028                -1.095680e-02 3 1  ON 77
ci_0029                -1.105998e-02 3 1  ON 78
ci_0030                -1.077244e-02 3 1  ON 79
ci_0031                 2.015186e-02 3 1  ON 80
ci_0032                 2.009087e-02 3 1  ON 81
ci_0033                 9.784114e-03 3 1  ON 82
ci_0034                 1.045499e-02 3 1  ON 83
ci_0035                 6.742116e-03 3 1  ON 84
ci_0036                 6.934001e-03 3 1  ON 85
ci_0037                -1.025279e-02 3 1  ON 86
ci_0038                -1.070987e-02 3 1  ON 87
ci_0039                -2.613324e-03 3 1  ON 88
ci_0040                -2.492329e-03 3 1  ON 89
ci_0041                 7.465958e-03 3 1  ON 90
ci_0042                 7.218612e-03 3 1  ON 91
ci_0043                -1.788811e-02 3 1  ON 92
ci_0044                -1.890160e-02 3 1  ON 93
ci_0045                 7.892190e-03 3 1  ON 94
ci_0046                 7.665225e-03 3 1  ON 95
ci_0047                -1.841366e-03 3 1  ON 96
ci_0048                -1.613283e-03 3 1  ON 97
ci_0049                -5.402569e-03 3 1  ON 98
ci_0050                -5.877895e-03 3 1  ON 99
ci_0051                -3.617459e-03 3 1  ON 100
ci_0052                -3.598415e-03 3 1  ON 101
ci_0053                -4.988912e-03 3 1  ON 102
ci_0054                -4.554067e-03 3 1  ON 103
ci_0055                 6.227317e-03 3 1  ON 104
ci_0056                 6.740863e-03 3 1  ON 105
ci_0057                 4.916111e-03 3 1  ON 106
ci_0058                 4.874053e-03 3 1  ON 107
ci_0059                -4.894549e-03 3 1  ON 108
ci_0060                -4.717689e-03 3 1  ON 109
ci_0061                -3.807938e-03 3 1  ON 110
ci_0062                -3.833619e-03 3 1  ON 111
ci_0063                -8.710084e-03 3 1  ON 112
ci_0064                -8.772828e-03 3 1  ON 113
ci_0065                -5.285722e-03 3 1  ON 114
ci_0066                -5.253030e-03 3 1  ON 115
ci_0067                -4.845055e-03 3 1  ON 116
ci_0068                -4.751417e-03 3 1  ON 117
ci_0069                 4.234231e-03 3 1  ON 118
ci_0070                 4.699868e-03 3 1  ON 119
ci_0071                 2.671522e-06 3 1  ON 120
ci_0072                 7.211421e-04 3 1  ON 121
ci_0073                 4.392457e-03 3 1  ON 122
ci_0074                 4.045601e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8551e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.0171
    reference variance = 0.285919
====================================================
  Execution time = 2.1824e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5240e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3677e-01
  Total weights = 1.951541326e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0899e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321165766154
                                         uncertainty =       0.002504503697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321165766154
                                         uncertainty =       0.002504503697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400700119
  error estimate for blocks of size 2^( 2) =       0.000413696713
  error estimate for blocks of size 2^( 3) =       0.000427328461
  error estimate for blocks of size 2^( 4) =       0.000440618906
  error estimate for blocks of size 2^( 5) =       0.000453100206
  error estimate for blocks of size 2^( 6) =       0.000463518661
  error estimate for blocks of size 2^( 7) =       0.000467377472

      target function =                  N/A
              le_mean =     -16.904986285347
             les_mean =     286.115334121566
             stat err =       0.000456153811
             autocorr =       1.295936350636
              std dev =       0.566675543239
             le_variance =       0.321121171305


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690498628535e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904986285311       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904988067460       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904987687451       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904987820433       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904987552423       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904987645640       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904987664763       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904987699676       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904987675757       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904987683906       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+00 is 1.282766e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904986285311       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904986759645       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904986655062       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904986669807       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904986598612       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904986628314       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904986634013       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904986644977       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904986638875       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904986639857       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+00 is 3.437167e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904986285311       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904986405842       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904986379025       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904986381363       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904986363277       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904986371054       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904986372507       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904986375478       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904986373956       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904986374142       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+01 is 8.750498e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.368323 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7922e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
   uu_0                 3.110074e-01 1 1  ON 0
   uu_1                 1.440399e-01 1 1  ON 1
   uu_2                 4.285469e-02 1 1  ON 2
   uu_3                -1.900641e-02 1 1  ON 3
   uu_4                -6.378129e-02 1 1  ON 4
   uu_5                -9.792687e-02 1 1  ON 5
   uu_6                -1.250226e-01 1 1  ON 6
   uu_7                -1.375966e-01 1 1  ON 7
   uu_8                -1.291130e-01 1 1  ON 8
   uu_9                -9.769981e-02 1 1  ON 9
   ud_0                 4.440215e-01 1 1  ON 10
   ud_1                 1.784295e-01 1 1  ON 11
   ud_2                 5.867107e-02 1 1  ON 12
   ud_3                -1.154313e-02 1 1  ON 13
   ud_4                -6.723184e-02 1 1  ON 14
   ud_5                -1.072266e-01 1 1  ON 15
   ud_6                -1.333824e-01 1 1  ON 16
   ud_7                -1.484247e-01 1 1  ON 17
   ud_8                -1.488299e-01 1 1  ON 18
   ud_9                -1.378924e-01 1 1  ON 19
   eO_0                -7.434863e-01 1 1  ON 20
   eO_1                -4.247515e-01 1 1  ON 21
   eO_2                -1.730236e-02 1 1  ON 22
   eO_3                 2.897738e-01 1 1  ON 23
   eO_4                 5.087963e-01 1 1  ON 24
   eO_5                 4.671560e-01 1 1  ON 25
   eO_6                 2.409585e-01 1 1  ON 26
   eO_7                -5.225949e-02 1 1  ON 27
   eO_8                -2.054655e-01 1 1  ON 28
   eO_9                -6.540640e-02 1 1  ON 29
  eH1_0                -2.433464e-01 1 1  ON 30
  eH1_1                -1.372504e-01 1 1  ON 31
  eH1_2                -8.811212e-02 1 1  ON 32
  eH1_3                -3.418485e-02 1 1  ON 33
  eH1_4                 1.420539e-02 1 1  ON 34
  eH1_5                 4.699427e-02 1 1  ON 35
  eH1_6                 9.992199e-02 1 1  ON 36
  eH1_7                 1.457653e-01 1 1  ON 37
  eH1_8                 1.572931e-01 1 1  ON 38
  eH1_9                 4.317387e-02 1 1  ON 39
  eH2_0                -2.413444e-01 1 1  ON 40
  eH2_1                -1.356491e-01 1 1  ON 41
  eH2_2                -8.627250e-02 1 1  ON 42
  eH2_3                -3.210733e-02 1 1  ON 43
  eH2_4                 1.697199e-02 1 1  ON 44
  eH2_5                 5.099768e-02 1 1  ON 45
  eH2_6                 1.046187e-01 1 1  ON 46
  eH2_7                 1.509914e-01 1 1  ON 47
  eH2_8                 1.635987e-01 1 1  ON 48
  eH2_9                 2.620827e-02 1 1  ON 49
ci_0001                 7.011690e-01 3 1  ON 50
ci_0002                 7.004100e-01 3 1  ON 51
ci_0003                -2.810948e-02 3 1  ON 52
ci_0004                -2.784853e-02 3 1  ON 53
ci_0005                -3.677825e-02 3 1  ON 54
ci_0006                -3.715759e-02 3 1  ON 55
ci_0007                -2.218275e-02 3 1  ON 56
ci_0008                -2.185102e-02 3 1  ON 57
ci_0009                -1.743161e-02 3 1  ON 58
ci_0010                -1.743653e-02 3 1  ON 59
ci_0011                -1.209416e-02 3 1  ON 60
ci_0012                -1.228002e-02 3 1  ON 61
ci_0013                 1.328628e-02 3 1  ON 62
ci_0014                 1.349589e-02 3 1  ON 63
ci_0015                 1.314473e-02 3 1  ON 64
ci_0016                 1.289073e-02 3 1  ON 65
ci_0017                 1.099767e-02 3 1  ON 66
ci_0018                 1.120180e-02 3 1  ON 67
ci_0019                 1.142755e-02 3 1  ON 68
ci_0020                 1.164777e-02 3 1  ON 69
ci_0021                -5.652121e-04 3 1  ON 70
ci_0022                -7.822221e-04 3 1  ON 71
ci_0023                -1.138570e-02 3 1  ON 72
ci_0024                -1.135076e-02 3 1  ON 73
ci_0025                -1.025486e-02 3 1  ON 74
ci_0026                -1.045166e-02 3 1  ON 75
ci_0027                -1.097437e-02 3 1  ON 76
ci_0028                -1.097043e-02 3 1  ON 77
ci_0029                -1.104270e-02 3 1  ON 78
ci_0030                -1.079116e-02 3 1  ON 79
ci_0031                 2.013272e-02 3 1  ON 80
ci_0032                 2.006988e-02 3 1  ON 81
ci_0033                 9.793893e-03 3 1  ON 82
ci_0034                 1.045635e-02 3 1  ON 83
ci_0035                 6.742904e-03 3 1  ON 84
ci_0036                 6.940348e-03 3 1  ON 85
ci_0037                -1.027794e-02 3 1  ON 86
ci_0038                -1.071161e-02 3 1  ON 87
ci_0039                -2.615583e-03 3 1  ON 88
ci_0040                -2.491138e-03 3 1  ON 89
ci_0041                 7.462079e-03 3 1  ON 90
ci_0042                 7.220953e-03 3 1  ON 91
ci_0043                -1.788901e-02 3 1  ON 92
ci_0044                -1.890085e-02 3 1  ON 93
ci_0045                 7.907839e-03 3 1  ON 94
ci_0046                 7.645436e-03 3 1  ON 95
ci_0047                -1.827242e-03 3 1  ON 96
ci_0048                -1.598064e-03 3 1  ON 97
ci_0049                -5.384972e-03 3 1  ON 98
ci_0050                -5.871881e-03 3 1  ON 99
ci_0051                -3.614503e-03 3 1  ON 100
ci_0052                -3.574718e-03 3 1  ON 101
ci_0053                -4.975090e-03 3 1  ON 102
ci_0054                -4.561883e-03 3 1  ON 103
ci_0055                 6.226734e-03 3 1  ON 104
ci_0056                 6.753319e-03 3 1  ON 105
ci_0057                 4.919911e-03 3 1  ON 106
ci_0058                 4.898049e-03 3 1  ON 107
ci_0059                -4.902779e-03 3 1  ON 108
ci_0060                -4.734268e-03 3 1  ON 109
ci_0061                -3.811359e-03 3 1  ON 110
ci_0062                -3.827417e-03 3 1  ON 111
ci_0063                -8.722484e-03 3 1  ON 112
ci_0064                -8.790175e-03 3 1  ON 113
ci_0065                -5.291612e-03 3 1  ON 114
ci_0066                -5.245446e-03 3 1  ON 115
ci_0067                -4.819286e-03 3 1  ON 116
ci_0068                -4.758508e-03 3 1  ON 117
ci_0069                 4.236228e-03 3 1  ON 118
ci_0070                 4.700372e-03 3 1  ON 119
ci_0071                 1.908873e-05 3 1  ON 120
ci_0072                 7.081808e-04 3 1  ON 121
ci_0073                 4.407499e-03 3 1  ON 122
ci_0074                 4.042093e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9564
    reference variance = 0.195979
====================================================
  Execution time = 2.1146e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3335e-01
  Total weights = 1.9513e+06
  Execution time = 1.8889e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321234509371
                                         uncertainty =       0.001806209445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321234509371
                                         uncertainty =       0.001806209445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400774244
  error estimate for blocks of size 2^( 2) =       0.000413920448
  error estimate for blocks of size 2^( 3) =       0.000427592356
  error estimate for blocks of size 2^( 4) =       0.000440372376
  error estimate for blocks of size 2^( 5) =       0.000452595956
  error estimate for blocks of size 2^( 6) =       0.000461679862
  error estimate for blocks of size 2^( 7) =       0.000467712505

      target function =                  N/A
              le_mean =     -16.905801396335
             les_mean =     286.139456314012
             stat err =       0.000455590175
             autocorr =       1.292257588780
              std dev =       0.566780371881
             le_variance =       0.321239989949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321296595382
                                         uncertainty =       0.001806937986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321296595382
                                         uncertainty =       0.001806937986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400812965
  error estimate for blocks of size 2^( 2) =       0.000413958707
  error estimate for blocks of size 2^( 3) =       0.000427625931
  error estimate for blocks of size 2^( 4) =       0.000440404422
  error estimate for blocks of size 2^( 5) =       0.000452625597
  error estimate for blocks of size 2^( 6) =       0.000461712682
  error estimate for blocks of size 2^( 7) =       0.000467749846

      target function =                  N/A
              le_mean =     -16.905803658579
             les_mean =     286.139779211589
             stat err =       0.000455623137
             autocorr =       1.292194879896
              std dev =       0.566835131617
             le_variance =       0.321302066436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321266672530
                                         uncertainty =       0.001806610264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321266672530
                                         uncertainty =       0.001806610264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400794302
  error estimate for blocks of size 2^( 2) =       0.000413940197
  error estimate for blocks of size 2^( 3) =       0.000427609623
  error estimate for blocks of size 2^( 4) =       0.000440388952
  error estimate for blocks of size 2^( 5) =       0.000452611235
  error estimate for blocks of size 2^( 6) =       0.000461696898
  error estimate for blocks of size 2^( 7) =       0.000467731843

      target function =                  N/A
              le_mean =     -16.905802517535
             les_mean =     286.139635621446
             stat err =       0.000455607232
             autocorr =       1.292225009852
              std dev =       0.566808737068
             le_variance =       0.321272144417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321238480401
                                         uncertainty =       0.001806258254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321238480401
                                         uncertainty =       0.001806258254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400776721
  error estimate for blocks of size 2^( 2) =       0.000413922877
  error estimate for blocks of size 2^( 3) =       0.000427594471
  error estimate for blocks of size 2^( 4) =       0.000440374409
  error estimate for blocks of size 2^( 5) =       0.000452597818
  error estimate for blocks of size 2^( 6) =       0.000461681931
  error estimate for blocks of size 2^( 7) =       0.000467714877

      target function =                  N/A
              le_mean =     -16.905801532302
             les_mean =     286.139454949151
             stat err =       0.000455592259
             autocorr =       1.292253442590
              std dev =       0.566783873932
             le_variance =       0.321243959749


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905801396335        initial
     2.3842e+00     2.3842e+01             1.2828e-04       -16.905803658579  <--
     9.5367e+00     9.5367e+01             3.4372e-05       -16.905802517535
     3.8147e+01     3.8147e+02             8.7505e-06       -16.905801532302

*****************************************************************************
Applying the update for shift_i =   2.3842e+00     and shift_s =   2.3842e+01
*****************************************************************************

  Execution time = 3.0675e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
   uu_0                 3.110172e-01 1 1  ON 0
   uu_1                 1.440408e-01 1 1  ON 1
   uu_2                 4.284695e-02 1 1  ON 2
   uu_3                -1.898801e-02 1 1  ON 3
   uu_4                -6.375330e-02 1 1  ON 4
   uu_5                -9.793903e-02 1 1  ON 5
   uu_6                -1.250356e-01 1 1  ON 6
   uu_7                -1.375904e-01 1 1  ON 7
   uu_8                -1.291464e-01 1 1  ON 8
   uu_9                -9.775534e-02 1 1  ON 9
   ud_0                 4.440696e-01 1 1  ON 10
   ud_1                 1.784827e-01 1 1  ON 11
   ud_2                 5.866477e-02 1 1  ON 12
   ud_3                -1.152441e-02 1 1  ON 13
   ud_4                -6.722555e-02 1 1  ON 14
   ud_5                -1.072366e-01 1 1  ON 15
   ud_6                -1.333888e-01 1 1  ON 16
   ud_7                -1.484687e-01 1 1  ON 17
   ud_8                -1.488352e-01 1 1  ON 18
   ud_9                -1.379172e-01 1 1  ON 19
   eO_0                -7.435661e-01 1 1  ON 20
   eO_1                -4.248127e-01 1 1  ON 21
   eO_2                -1.729804e-02 1 1  ON 22
   eO_3                 2.898105e-01 1 1  ON 23
   eO_4                 5.088768e-01 1 1  ON 24
   eO_5                 4.672062e-01 1 1  ON 25
   eO_6                 2.410033e-01 1 1  ON 26
   eO_7                -5.223153e-02 1 1  ON 27
   eO_8                -2.055133e-01 1 1  ON 28
   eO_9                -6.545272e-02 1 1  ON 29
  eH1_0                -2.433840e-01 1 1  ON 30
  eH1_1                -1.372647e-01 1 1  ON 31
  eH1_2                -8.817069e-02 1 1  ON 32
  eH1_3                -3.421308e-02 1 1  ON 33
  eH1_4                 1.418727e-02 1 1  ON 34
  eH1_5                 4.698303e-02 1 1  ON 35
  eH1_6                 9.995726e-02 1 1  ON 36
  eH1_7                 1.458195e-01 1 1  ON 37
  eH1_8                 1.573427e-01 1 1  ON 38
  eH1_9                 4.321374e-02 1 1  ON 39
  eH2_0                -2.413882e-01 1 1  ON 40
  eH2_1                -1.356670e-01 1 1  ON 41
  eH2_2                -8.631840e-02 1 1  ON 42
  eH2_3                -3.214413e-02 1 1  ON 43
  eH2_4                 1.692142e-02 1 1  ON 44
  eH2_5                 5.099172e-02 1 1  ON 45
  eH2_6                 1.046337e-01 1 1  ON 46
  eH2_7                 1.510234e-01 1 1  ON 47
  eH2_8                 1.636642e-01 1 1  ON 48
  eH2_9                 2.628842e-02 1 1  ON 49
ci_0001                 7.011775e-01 3 1  ON 50
ci_0002                 7.004130e-01 3 1  ON 51
ci_0003                -2.808611e-02 3 1  ON 52
ci_0004                -2.783483e-02 3 1  ON 53
ci_0005                -3.674812e-02 3 1  ON 54
ci_0006                -3.708547e-02 3 1  ON 55
ci_0007                -2.212154e-02 3 1  ON 56
ci_0008                -2.186773e-02 3 1  ON 57
ci_0009                -1.738577e-02 3 1  ON 58
ci_0010                -1.734262e-02 3 1  ON 59
ci_0011                -1.211173e-02 3 1  ON 60
ci_0012                -1.222107e-02 3 1  ON 61
ci_0013                 1.325000e-02 3 1  ON 62
ci_0014                 1.346331e-02 3 1  ON 63
ci_0015                 1.313946e-02 3 1  ON 64
ci_0016                 1.289981e-02 3 1  ON 65
ci_0017                 1.104496e-02 3 1  ON 66
ci_0018                 1.124143e-02 3 1  ON 67
ci_0019                 1.149004e-02 3 1  ON 68
ci_0020                 1.160822e-02 3 1  ON 69
ci_0021                -5.741515e-04 3 1  ON 70
ci_0022                -7.707204e-04 3 1  ON 71
ci_0023                -1.136526e-02 3 1  ON 72
ci_0024                -1.134054e-02 3 1  ON 73
ci_0025                -1.025867e-02 3 1  ON 74
ci_0026                -1.053540e-02 3 1  ON 75
ci_0027                -1.096759e-02 3 1  ON 76
ci_0028                -1.100844e-02 3 1  ON 77
ci_0029                -1.099479e-02 3 1  ON 78
ci_0030                -1.084321e-02 3 1  ON 79
ci_0031                 2.007838e-02 3 1  ON 80
ci_0032                 2.001074e-02 3 1  ON 81
ci_0033                 9.822075e-03 3 1  ON 82
ci_0034                 1.046012e-02 3 1  ON 83
ci_0035                 6.745249e-03 3 1  ON 84
ci_0036                 6.958019e-03 3 1  ON 85
ci_0037                -1.034840e-02 3 1  ON 86
ci_0038                -1.071647e-02 3 1  ON 87
ci_0039                -2.621416e-03 3 1  ON 88
ci_0040                -2.487998e-03 3 1  ON 89
ci_0041                 7.451752e-03 3 1  ON 90
ci_0042                 7.227793e-03 3 1  ON 91
ci_0043                -1.789175e-02 3 1  ON 92
ci_0044                -1.889919e-02 3 1  ON 93
ci_0045                 7.951964e-03 3 1  ON 94
ci_0046                 7.589292e-03 3 1  ON 95
ci_0047                -1.790015e-03 3 1  ON 96
ci_0048                -1.558048e-03 3 1  ON 97
ci_0049                -5.336513e-03 3 1  ON 98
ci_0050                -5.855455e-03 3 1  ON 99
ci_0051                -3.606630e-03 3 1  ON 100
ci_0052                -3.512115e-03 3 1  ON 101
ci_0053                -4.938586e-03 3 1  ON 102
ci_0054                -4.582408e-03 3 1  ON 103
ci_0055                 6.225089e-03 3 1  ON 104
ci_0056                 6.788417e-03 3 1  ON 105
ci_0057                 4.930531e-03 3 1  ON 106
ci_0058                 4.965033e-03 3 1  ON 107
ci_0059                -4.924660e-03 3 1  ON 108
ci_0060                -4.778345e-03 3 1  ON 109
ci_0061                -3.820824e-03 3 1  ON 110
ci_0062                -3.810260e-03 3 1  ON 111
ci_0063                -8.755450e-03 3 1  ON 112
ci_0064                -8.836752e-03 3 1  ON 113
ci_0065                -5.307705e-03 3 1  ON 114
ci_0066                -5.224992e-03 3 1  ON 115
ci_0067                -4.751602e-03 3 1  ON 116
ci_0068                -4.776922e-03 3 1  ON 117
ci_0069                 4.241897e-03 3 1  ON 118
ci_0070                 4.701474e-03 3 1  ON 119
ci_0071                 6.358760e-05 3 1  ON 120
ci_0072                 6.727085e-04 3 1  ON 121
ci_0073                 4.447219e-03 3 1  ON 122
ci_0074                 4.032379e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8603e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6891e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8558
    reference variance = 0.558479
====================================================
  Execution time = 2.1737e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5229e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3670e-01
  Total weights = 1.951796013e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0874e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324402627094
                                         uncertainty =       0.002334409837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324402627094
                                         uncertainty =       0.002334409837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402749727
  error estimate for blocks of size 2^( 2) =       0.000414912538
  error estimate for blocks of size 2^( 3) =       0.000427421131
  error estimate for blocks of size 2^( 4) =       0.000440294252
  error estimate for blocks of size 2^( 5) =       0.000449560525
  error estimate for blocks of size 2^( 6) =       0.000456150517
  error estimate for blocks of size 2^( 7) =       0.000458789749

      target function =                  N/A
              le_mean =     -16.906151580939
             les_mean =     286.154660164629
             stat err =       0.000451198761
             autocorr =       1.255062309445
              std dev =       0.569574125580
             le_variance =       0.324414684530


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690615158094e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906151580959       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906153325296       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906151804515       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906150554265       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906151974552       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906152140279       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906152799349       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906152466219       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906152411061       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906152350702       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906152259725       residual = 7.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e-01 is 4.863195e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906151580959       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906152120921       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906151673063       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906151347161       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906151690073       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906151802586       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906151907958       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906151862887       residual = 7.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906151857926       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906151841216       residual = 6.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+00 is 1.364235e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906151580959       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906151724497       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906151606429       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906151526309       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906151610128       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906151639820       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906151665298       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906151656377       residual = 6.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906151656228       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906151652730       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+00 is 3.631632e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.372469 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7832e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
   uu_0                 3.110885e-01 1 1  ON 0
   uu_1                 1.440872e-01 1 1  ON 1
   uu_2                 4.285210e-02 1 1  ON 2
   uu_3                -1.899423e-02 1 1  ON 3
   uu_4                -6.379692e-02 1 1  ON 4
   uu_5                -9.794613e-02 1 1  ON 5
   uu_6                -1.250099e-01 1 1  ON 6
   uu_7                -1.375886e-01 1 1  ON 7
   uu_8                -1.292018e-01 1 1  ON 8
   uu_9                -9.785185e-02 1 1  ON 9
   ud_0                 4.441081e-01 1 1  ON 10
   ud_1                 1.785165e-01 1 1  ON 11
   ud_2                 5.871974e-02 1 1  ON 12
   ud_3                -1.144582e-02 1 1  ON 13
   ud_4                -6.720282e-02 1 1  ON 14
   ud_5                -1.072594e-01 1 1  ON 15
   ud_6                -1.333420e-01 1 1  ON 16
   ud_7                -1.485240e-01 1 1  ON 17
   ud_8                -1.489322e-01 1 1  ON 18
   ud_9                -1.379986e-01 1 1  ON 19
   eO_0                -7.436156e-01 1 1  ON 20
   eO_1                -4.247963e-01 1 1  ON 21
   eO_2                -1.733394e-02 1 1  ON 22
   eO_3                 2.898138e-01 1 1  ON 23
   eO_4                 5.089656e-01 1 1  ON 24
   eO_5                 4.672866e-01 1 1  ON 25
   eO_6                 2.410641e-01 1 1  ON 26
   eO_7                -5.220212e-02 1 1  ON 27
   eO_8                -2.056186e-01 1 1  ON 28
   eO_9                -6.553165e-02 1 1  ON 29
  eH1_0                -2.434437e-01 1 1  ON 30
  eH1_1                -1.373398e-01 1 1  ON 31
  eH1_2                -8.819930e-02 1 1  ON 32
  eH1_3                -3.419929e-02 1 1  ON 33
  eH1_4                 1.416066e-02 1 1  ON 34
  eH1_5                 4.695649e-02 1 1  ON 35
  eH1_6                 1.000243e-01 1 1  ON 36
  eH1_7                 1.458653e-01 1 1  ON 37
  eH1_8                 1.574017e-01 1 1  ON 38
  eH1_9                 4.325591e-02 1 1  ON 39
  eH2_0                -2.414223e-01 1 1  ON 40
  eH2_1                -1.356950e-01 1 1  ON 41
  eH2_2                -8.635025e-02 1 1  ON 42
  eH2_3                -3.215516e-02 1 1  ON 43
  eH2_4                 1.688085e-02 1 1  ON 44
  eH2_5                 5.096997e-02 1 1  ON 45
  eH2_6                 1.046222e-01 1 1  ON 46
  eH2_7                 1.510486e-01 1 1  ON 47
  eH2_8                 1.637327e-01 1 1  ON 48
  eH2_9                 2.638206e-02 1 1  ON 49
ci_0001                 7.011710e-01 3 1  ON 50
ci_0002                 7.004102e-01 3 1  ON 51
ci_0003                -2.803194e-02 3 1  ON 52
ci_0004                -2.785861e-02 3 1  ON 53
ci_0005                -3.680512e-02 3 1  ON 54
ci_0006                -3.712717e-02 3 1  ON 55
ci_0007                -2.209726e-02 3 1  ON 56
ci_0008                -2.182287e-02 3 1  ON 57
ci_0009                -1.733628e-02 3 1  ON 58
ci_0010                -1.739509e-02 3 1  ON 59
ci_0011                -1.209439e-02 3 1  ON 60
ci_0012                -1.221645e-02 3 1  ON 61
ci_0013                 1.328745e-02 3 1  ON 62
ci_0014                 1.347357e-02 3 1  ON 63
ci_0015                 1.318903e-02 3 1  ON 64
ci_0016                 1.291504e-02 3 1  ON 65
ci_0017                 1.102808e-02 3 1  ON 66
ci_0018                 1.124265e-02 3 1  ON 67
ci_0019                 1.144437e-02 3 1  ON 68
ci_0020                 1.158739e-02 3 1  ON 69
ci_0021                -5.551439e-04 3 1  ON 70
ci_0022                -7.931436e-04 3 1  ON 71
ci_0023                -1.135205e-02 3 1  ON 72
ci_0024                -1.132898e-02 3 1  ON 73
ci_0025                -1.035536e-02 3 1  ON 74
ci_0026                -1.059662e-02 3 1  ON 75
ci_0027                -1.104585e-02 3 1  ON 76
ci_0028                -1.098296e-02 3 1  ON 77
ci_0029                -1.098205e-02 3 1  ON 78
ci_0030                -1.084281e-02 3 1  ON 79
ci_0031                 2.014191e-02 3 1  ON 80
ci_0032                 1.999638e-02 3 1  ON 81
ci_0033                 9.802274e-03 3 1  ON 82
ci_0034                 1.042396e-02 3 1  ON 83
ci_0035                 6.844076e-03 3 1  ON 84
ci_0036                 6.961979e-03 3 1  ON 85
ci_0037                -1.032666e-02 3 1  ON 86
ci_0038                -1.074847e-02 3 1  ON 87
ci_0039                -2.660983e-03 3 1  ON 88
ci_0040                -2.502202e-03 3 1  ON 89
ci_0041                 7.456375e-03 3 1  ON 90
ci_0042                 7.296040e-03 3 1  ON 91
ci_0043                -1.802817e-02 3 1  ON 92
ci_0044                -1.887493e-02 3 1  ON 93
ci_0045                 7.881365e-03 3 1  ON 94
ci_0046                 7.505798e-03 3 1  ON 95
ci_0047                -1.752692e-03 3 1  ON 96
ci_0048                -1.656862e-03 3 1  ON 97
ci_0049                -5.472348e-03 3 1  ON 98
ci_0050                -5.875239e-03 3 1  ON 99
ci_0051                -3.596135e-03 3 1  ON 100
ci_0052                -3.499954e-03 3 1  ON 101
ci_0053                -4.902636e-03 3 1  ON 102
ci_0054                -4.528919e-03 3 1  ON 103
ci_0055                 6.174247e-03 3 1  ON 104
ci_0056                 6.775610e-03 3 1  ON 105
ci_0057                 4.945694e-03 3 1  ON 106
ci_0058                 4.934694e-03 3 1  ON 107
ci_0059                -4.941702e-03 3 1  ON 108
ci_0060                -4.778831e-03 3 1  ON 109
ci_0061                -3.834695e-03 3 1  ON 110
ci_0062                -3.870852e-03 3 1  ON 111
ci_0063                -8.765858e-03 3 1  ON 112
ci_0064                -8.828654e-03 3 1  ON 113
ci_0065                -5.336117e-03 3 1  ON 114
ci_0066                -5.247992e-03 3 1  ON 115
ci_0067                -4.736931e-03 3 1  ON 116
ci_0068                -4.753124e-03 3 1  ON 117
ci_0069                 4.332210e-03 3 1  ON 118
ci_0070                 4.646151e-03 3 1  ON 119
ci_0071                 4.470911e-05 3 1  ON 120
ci_0072                 6.724401e-04 3 1  ON 121
ci_0073                 4.449965e-03 3 1  ON 122
ci_0074                 4.019854e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8267
    reference variance = 1.26079
====================================================
  Execution time = 2.1159e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4168e-01
  Total weights = 1.9514e+06
  Execution time = 1.8970e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323335133337
                                         uncertainty =       0.002553328839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323335133337
                                         uncertainty =       0.002553328839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402101814
  error estimate for blocks of size 2^( 2) =       0.000415016664
  error estimate for blocks of size 2^( 3) =       0.000428283420
  error estimate for blocks of size 2^( 4) =       0.000441441131
  error estimate for blocks of size 2^( 5) =       0.000452473000
  error estimate for blocks of size 2^( 6) =       0.000460351446
  error estimate for blocks of size 2^( 7) =       0.000463527604

      target function =                  N/A
              le_mean =     -16.905939513409
             les_mean =     286.174186969848
             stat err =       0.000454448296
             autocorr =       1.277311710901
              std dev =       0.568657838200
             le_variance =       0.323371736947

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364882937872
                                         uncertainty =       0.040873155724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364882937872
                                         uncertainty =       0.040873155724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427173067
  error estimate for blocks of size 2^( 2) =       0.000439381072
  error estimate for blocks of size 2^( 3) =       0.000451880844
  error estimate for blocks of size 2^( 4) =       0.000464289479
  error estimate for blocks of size 2^( 5) =       0.000474708214
  error estimate for blocks of size 2^( 6) =       0.000482439099
  error estimate for blocks of size 2^( 7) =       0.000486030006

      target function =                  N/A
              le_mean =     -16.905797945977
             les_mean =     519.171132276068
             stat err =       0.000476866700
             autocorr =       1.246195752469
              std dev =       0.604113944534
             le_variance =       0.364953657981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323528601431
                                         uncertainty =       0.002583673530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323528601431
                                         uncertainty =       0.002583673530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402222523
  error estimate for blocks of size 2^( 2) =       0.000415138159
  error estimate for blocks of size 2^( 3) =       0.000428405962
  error estimate for blocks of size 2^( 4) =       0.000441561806
  error estimate for blocks of size 2^( 5) =       0.000452597460
  error estimate for blocks of size 2^( 6) =       0.000460462146
  error estimate for blocks of size 2^( 7) =       0.000463634997

      target function =                  N/A
              le_mean =     -16.905940718781
             les_mean =     286.153689316333
             stat err =       0.000454564102
             autocorr =       1.277195854421
              std dev =       0.568828546958
             le_variance =       0.323565915834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323361341839
                                         uncertainty =       0.002557243128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323361341839
                                         uncertainty =       0.002557243128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402118167
  error estimate for blocks of size 2^( 2) =       0.000415034079
  error estimate for blocks of size 2^( 3) =       0.000428301166
  error estimate for blocks of size 2^( 4) =       0.000441458307
  error estimate for blocks of size 2^( 5) =       0.000452488250
  error estimate for blocks of size 2^( 6) =       0.000460359637
  error estimate for blocks of size 2^( 7) =       0.000463536917

      target function =                  N/A
              le_mean =     -16.905938920237
             les_mean =     286.204220063596
             stat err =       0.000454460778
             autocorr =       1.277277981827
              std dev =       0.568680965801
             le_variance =       0.323398040864


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905939513409        initial
     5.9605e-01     5.9605e+00             4.8632e-04       -16.905797945977
     2.3842e+00     2.3842e+01             1.3642e-04       -16.905940718781  <--
     9.5367e+00     9.5367e+01             3.6316e-05       -16.905938920237

*****************************************************************************
Applying the update for shift_i =   2.3842e+00     and shift_s =   2.3842e+01
*****************************************************************************

  Execution time = 3.4448e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
   uu_0                 3.110885e-01 1 1  ON 0
   uu_1                 1.440872e-01 1 1  ON 1
   uu_2                 4.285210e-02 1 1  ON 2
   uu_3                -1.899423e-02 1 1  ON 3
   uu_4                -6.379692e-02 1 1  ON 4
   uu_5                -9.794613e-02 1 1  ON 5
   uu_6                -1.250099e-01 1 1  ON 6
   uu_7                -1.375886e-01 1 1  ON 7
   uu_8                -1.292018e-01 1 1  ON 8
   uu_9                -9.785185e-02 1 1  ON 9
   ud_0                 4.441081e-01 1 1  ON 10
   ud_1                 1.785165e-01 1 1  ON 11
   ud_2                 5.871974e-02 1 1  ON 12
   ud_3                -1.144582e-02 1 1  ON 13
   ud_4                -6.720282e-02 1 1  ON 14
   ud_5                -1.072594e-01 1 1  ON 15
   ud_6                -1.333420e-01 1 1  ON 16
   ud_7                -1.485240e-01 1 1  ON 17
   ud_8                -1.489322e-01 1 1  ON 18
   ud_9                -1.379986e-01 1 1  ON 19
   eO_0                -7.436156e-01 1 1  ON 20
   eO_1                -4.247963e-01 1 1  ON 21
   eO_2                -1.733394e-02 1 1  ON 22
   eO_3                 2.898138e-01 1 1  ON 23
   eO_4                 5.089656e-01 1 1  ON 24
   eO_5                 4.672866e-01 1 1  ON 25
   eO_6                 2.410641e-01 1 1  ON 26
   eO_7                -5.220212e-02 1 1  ON 27
   eO_8                -2.056186e-01 1 1  ON 28
   eO_9                -6.553165e-02 1 1  ON 29
  eH1_0                -2.434437e-01 1 1  ON 30
  eH1_1                -1.373398e-01 1 1  ON 31
  eH1_2                -8.819930e-02 1 1  ON 32
  eH1_3                -3.419929e-02 1 1  ON 33
  eH1_4                 1.416066e-02 1 1  ON 34
  eH1_5                 4.695649e-02 1 1  ON 35
  eH1_6                 1.000243e-01 1 1  ON 36
  eH1_7                 1.458653e-01 1 1  ON 37
  eH1_8                 1.574017e-01 1 1  ON 38
  eH1_9                 4.325591e-02 1 1  ON 39
  eH2_0                -2.414223e-01 1 1  ON 40
  eH2_1                -1.356950e-01 1 1  ON 41
  eH2_2                -8.635025e-02 1 1  ON 42
  eH2_3                -3.215516e-02 1 1  ON 43
  eH2_4                 1.688085e-02 1 1  ON 44
  eH2_5                 5.096997e-02 1 1  ON 45
  eH2_6                 1.046222e-01 1 1  ON 46
  eH2_7                 1.510486e-01 1 1  ON 47
  eH2_8                 1.637327e-01 1 1  ON 48
  eH2_9                 2.638206e-02 1 1  ON 49
ci_0001                 7.011710e-01 3 1  ON 50
ci_0002                 7.004102e-01 3 1  ON 51
ci_0003                -2.803194e-02 3 1  ON 52
ci_0004                -2.785861e-02 3 1  ON 53
ci_0005                -3.680512e-02 3 1  ON 54
ci_0006                -3.712717e-02 3 1  ON 55
ci_0007                -2.209726e-02 3 1  ON 56
ci_0008                -2.182287e-02 3 1  ON 57
ci_0009                -1.733628e-02 3 1  ON 58
ci_0010                -1.739509e-02 3 1  ON 59
ci_0011                -1.209439e-02 3 1  ON 60
ci_0012                -1.221645e-02 3 1  ON 61
ci_0013                 1.328745e-02 3 1  ON 62
ci_0014                 1.347357e-02 3 1  ON 63
ci_0015                 1.318903e-02 3 1  ON 64
ci_0016                 1.291504e-02 3 1  ON 65
ci_0017                 1.102808e-02 3 1  ON 66
ci_0018                 1.124265e-02 3 1  ON 67
ci_0019                 1.144437e-02 3 1  ON 68
ci_0020                 1.158739e-02 3 1  ON 69
ci_0021                -5.551439e-04 3 1  ON 70
ci_0022                -7.931436e-04 3 1  ON 71
ci_0023                -1.135205e-02 3 1  ON 72
ci_0024                -1.132898e-02 3 1  ON 73
ci_0025                -1.035536e-02 3 1  ON 74
ci_0026                -1.059662e-02 3 1  ON 75
ci_0027                -1.104585e-02 3 1  ON 76
ci_0028                -1.098296e-02 3 1  ON 77
ci_0029                -1.098205e-02 3 1  ON 78
ci_0030                -1.084281e-02 3 1  ON 79
ci_0031                 2.014191e-02 3 1  ON 80
ci_0032                 1.999638e-02 3 1  ON 81
ci_0033                 9.802274e-03 3 1  ON 82
ci_0034                 1.042396e-02 3 1  ON 83
ci_0035                 6.844076e-03 3 1  ON 84
ci_0036                 6.961979e-03 3 1  ON 85
ci_0037                -1.032666e-02 3 1  ON 86
ci_0038                -1.074847e-02 3 1  ON 87
ci_0039                -2.660983e-03 3 1  ON 88
ci_0040                -2.502202e-03 3 1  ON 89
ci_0041                 7.456375e-03 3 1  ON 90
ci_0042                 7.296040e-03 3 1  ON 91
ci_0043                -1.802817e-02 3 1  ON 92
ci_0044                -1.887493e-02 3 1  ON 93
ci_0045                 7.881365e-03 3 1  ON 94
ci_0046                 7.505798e-03 3 1  ON 95
ci_0047                -1.752692e-03 3 1  ON 96
ci_0048                -1.656862e-03 3 1  ON 97
ci_0049                -5.472348e-03 3 1  ON 98
ci_0050                -5.875239e-03 3 1  ON 99
ci_0051                -3.596135e-03 3 1  ON 100
ci_0052                -3.499954e-03 3 1  ON 101
ci_0053                -4.902636e-03 3 1  ON 102
ci_0054                -4.528919e-03 3 1  ON 103
ci_0055                 6.174247e-03 3 1  ON 104
ci_0056                 6.775610e-03 3 1  ON 105
ci_0057                 4.945694e-03 3 1  ON 106
ci_0058                 4.934694e-03 3 1  ON 107
ci_0059                -4.941702e-03 3 1  ON 108
ci_0060                -4.778831e-03 3 1  ON 109
ci_0061                -3.834695e-03 3 1  ON 110
ci_0062                -3.870852e-03 3 1  ON 111
ci_0063                -8.765858e-03 3 1  ON 112
ci_0064                -8.828654e-03 3 1  ON 113
ci_0065                -5.336117e-03 3 1  ON 114
ci_0066                -5.247992e-03 3 1  ON 115
ci_0067                -4.736931e-03 3 1  ON 116
ci_0068                -4.753124e-03 3 1  ON 117
ci_0069                 4.332210e-03 3 1  ON 118
ci_0070                 4.646151e-03 3 1  ON 119
ci_0071                 4.470911e-05 3 1  ON 120
ci_0072                 6.724401e-04 3 1  ON 121
ci_0073                 4.449965e-03 3 1  ON 122
ci_0074                 4.019854e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.2288e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6889e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9021
    reference variance = 0.193689
====================================================
  Execution time = 2.1750e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4292e-01
  Total weights = 1.951597877e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0587e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327689152236
                                         uncertainty =       0.002879354176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327689152236
                                         uncertainty =       0.002879354176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404740005
  error estimate for blocks of size 2^( 2) =       0.000417555147
  error estimate for blocks of size 2^( 3) =       0.000430848077
  error estimate for blocks of size 2^( 4) =       0.000442358043
  error estimate for blocks of size 2^( 5) =       0.000452944461
  error estimate for blocks of size 2^( 6) =       0.000461742232
  error estimate for blocks of size 2^( 7) =       0.000466098819

      target function =                  N/A
              le_mean =     -16.907037267844
             les_mean =     286.190830201550
             stat err =       0.000455785889
             autocorr =       1.268146668693
              std dev =       0.572388803844
             le_variance =       0.327628942766


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690703726784e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907037267841       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907036021724       residual = 5.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907035006489       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907035298002       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907035223953       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907035918660       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907036326652       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907036367177       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907036554637       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907036502322       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.907036332355       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e-01 is 5.107224e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907037267841       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907036881639       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907036585880       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907036720724       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907036769855       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907036774974       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907036969480       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907037032619       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907037080985       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907037065992       residual = 5.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+00 is 1.532633e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907037267841       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907037165136       residual = 5.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907037087798       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907037126035       residual = 9.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907037141650       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907037131027       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907037184239       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907037203676       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907037218448       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907037217568       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+00 is 4.036903e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.376659 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7816e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
   uu_0                 3.111023e-01 1 1  ON 0
   uu_1                 1.441464e-01 1 1  ON 1
   uu_2                 4.284781e-02 1 1  ON 2
   uu_3                -1.899105e-02 1 1  ON 3
   uu_4                -6.380720e-02 1 1  ON 4
   uu_5                -9.796104e-02 1 1  ON 5
   uu_6                -1.249772e-01 1 1  ON 6
   uu_7                -1.376270e-01 1 1  ON 7
   uu_8                -1.292859e-01 1 1  ON 8
   uu_9                -9.789998e-02 1 1  ON 9
   ud_0                 4.440863e-01 1 1  ON 10
   ud_1                 1.785248e-01 1 1  ON 11
   ud_2                 5.874668e-02 1 1  ON 12
   ud_3                -1.143016e-02 1 1  ON 13
   ud_4                -6.715062e-02 1 1  ON 14
   ud_5                -1.072337e-01 1 1  ON 15
   ud_6                -1.333380e-01 1 1  ON 16
   ud_7                -1.485815e-01 1 1  ON 17
   ud_8                -1.489574e-01 1 1  ON 18
   ud_9                -1.380084e-01 1 1  ON 19
   eO_0                -7.436989e-01 1 1  ON 20
   eO_1                -4.248356e-01 1 1  ON 21
   eO_2                -1.731889e-02 1 1  ON 22
   eO_3                 2.898854e-01 1 1  ON 23
   eO_4                 5.090142e-01 1 1  ON 24
   eO_5                 4.673401e-01 1 1  ON 25
   eO_6                 2.411031e-01 1 1  ON 26
   eO_7                -5.218353e-02 1 1  ON 27
   eO_8                -2.056743e-01 1 1  ON 28
   eO_9                -6.558988e-02 1 1  ON 29
  eH1_0                -2.435089e-01 1 1  ON 30
  eH1_1                -1.373446e-01 1 1  ON 31
  eH1_2                -8.827356e-02 1 1  ON 32
  eH1_3                -3.421300e-02 1 1  ON 33
  eH1_4                 1.410625e-02 1 1  ON 34
  eH1_5                 4.694181e-02 1 1  ON 35
  eH1_6                 1.000808e-01 1 1  ON 36
  eH1_7                 1.458869e-01 1 1  ON 37
  eH1_8                 1.574625e-01 1 1  ON 38
  eH1_9                 4.333556e-02 1 1  ON 39
  eH2_0                -2.415327e-01 1 1  ON 40
  eH2_1                -1.356992e-01 1 1  ON 41
  eH2_2                -8.636170e-02 1 1  ON 42
  eH2_3                -3.216058e-02 1 1  ON 43
  eH2_4                 1.686506e-02 1 1  ON 44
  eH2_5                 5.093350e-02 1 1  ON 45
  eH2_6                 1.046341e-01 1 1  ON 46
  eH2_7                 1.510427e-01 1 1  ON 47
  eH2_8                 1.638075e-01 1 1  ON 48
  eH2_9                 2.648145e-02 1 1  ON 49
ci_0001                 7.011355e-01 3 1  ON 50
ci_0002                 7.004558e-01 3 1  ON 51
ci_0003                -2.787868e-02 3 1  ON 52
ci_0004                -2.785633e-02 3 1  ON 53
ci_0005                -3.684255e-02 3 1  ON 54
ci_0006                -3.708698e-02 3 1  ON 55
ci_0007                -2.208539e-02 3 1  ON 56
ci_0008                -2.186905e-02 3 1  ON 57
ci_0009                -1.719193e-02 3 1  ON 58
ci_0010                -1.731660e-02 3 1  ON 59
ci_0011                -1.214408e-02 3 1  ON 60
ci_0012                -1.217047e-02 3 1  ON 61
ci_0013                 1.337790e-02 3 1  ON 62
ci_0014                 1.350033e-02 3 1  ON 63
ci_0015                 1.310736e-02 3 1  ON 64
ci_0016                 1.294099e-02 3 1  ON 65
ci_0017                 1.106341e-02 3 1  ON 66
ci_0018                 1.127499e-02 3 1  ON 67
ci_0019                 1.140610e-02 3 1  ON 68
ci_0020                 1.157449e-02 3 1  ON 69
ci_0021                -4.713094e-04 3 1  ON 70
ci_0022                -8.010880e-04 3 1  ON 71
ci_0023                -1.132112e-02 3 1  ON 72
ci_0024                -1.126931e-02 3 1  ON 73
ci_0025                -1.024963e-02 3 1  ON 74
ci_0026                -1.064414e-02 3 1  ON 75
ci_0027                -1.103035e-02 3 1  ON 76
ci_0028                -1.099550e-02 3 1  ON 77
ci_0029                -1.096662e-02 3 1  ON 78
ci_0030                -1.083199e-02 3 1  ON 79
ci_0031                 2.013784e-02 3 1  ON 80
ci_0032                 2.000367e-02 3 1  ON 81
ci_0033                 9.851798e-03 3 1  ON 82
ci_0034                 1.028505e-02 3 1  ON 83
ci_0035                 6.896776e-03 3 1  ON 84
ci_0036                 6.883237e-03 3 1  ON 85
ci_0037                -1.029086e-02 3 1  ON 86
ci_0038                -1.073316e-02 3 1  ON 87
ci_0039                -2.630309e-03 3 1  ON 88
ci_0040                -2.555263e-03 3 1  ON 89
ci_0041                 7.491860e-03 3 1  ON 90
ci_0042                 7.261523e-03 3 1  ON 91
ci_0043                -1.803085e-02 3 1  ON 92
ci_0044                -1.888416e-02 3 1  ON 93
ci_0045                 7.876005e-03 3 1  ON 94
ci_0046                 7.521946e-03 3 1  ON 95
ci_0047                -1.770435e-03 3 1  ON 96
ci_0048                -1.728017e-03 3 1  ON 97
ci_0049                -5.519640e-03 3 1  ON 98
ci_0050                -5.826785e-03 3 1  ON 99
ci_0051                -3.613108e-03 3 1  ON 100
ci_0052                -3.430709e-03 3 1  ON 101
ci_0053                -4.994135e-03 3 1  ON 102
ci_0054                -4.469374e-03 3 1  ON 103
ci_0055                 6.161716e-03 3 1  ON 104
ci_0056                 6.783315e-03 3 1  ON 105
ci_0057                 4.960929e-03 3 1  ON 106
ci_0058                 5.007080e-03 3 1  ON 107
ci_0059                -4.947793e-03 3 1  ON 108
ci_0060                -4.736778e-03 3 1  ON 109
ci_0061                -3.872926e-03 3 1  ON 110
ci_0062                -3.861051e-03 3 1  ON 111
ci_0063                -8.875691e-03 3 1  ON 112
ci_0064                -8.868836e-03 3 1  ON 113
ci_0065                -5.370552e-03 3 1  ON 114
ci_0066                -5.293672e-03 3 1  ON 115
ci_0067                -4.713578e-03 3 1  ON 116
ci_0068                -4.818155e-03 3 1  ON 117
ci_0069                 4.362431e-03 3 1  ON 118
ci_0070                 4.626519e-03 3 1  ON 119
ci_0071                 1.096539e-04 3 1  ON 120
ci_0072                 6.610034e-04 3 1  ON 121
ci_0073                 4.485576e-03 3 1  ON 122
ci_0074                 4.035176e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.904
    reference variance = 0.283134
====================================================
  Execution time = 2.1261e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3399e-01
  Total weights = 1.9516e+06
  Execution time = 1.8921e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321999504802
                                         uncertainty =       0.002028891023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321999504802
                                         uncertainty =       0.002028891023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401250499
  error estimate for blocks of size 2^( 2) =       0.000413997022
  error estimate for blocks of size 2^( 3) =       0.000426897941
  error estimate for blocks of size 2^( 4) =       0.000438679776
  error estimate for blocks of size 2^( 5) =       0.000446863415
  error estimate for blocks of size 2^( 6) =       0.000455529587
  error estimate for blocks of size 2^( 7) =       0.000461709831

      target function =                  N/A
              le_mean =     -16.906088803692
             les_mean =     286.150116688211
             stat err =       0.000450695652
             autocorr =       1.261640338421
              std dev =       0.567453897623
             le_variance =       0.322003925928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321927277943
                                         uncertainty =       0.002026853264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321927277943
                                         uncertainty =       0.002026853264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401205336
  error estimate for blocks of size 2^( 2) =       0.000413961927
  error estimate for blocks of size 2^( 3) =       0.000426867801
  error estimate for blocks of size 2^( 4) =       0.000438647348
  error estimate for blocks of size 2^( 5) =       0.000446833938
  error estimate for blocks of size 2^( 6) =       0.000455523295
  error estimate for blocks of size 2^( 7) =       0.000461703964

      target function =                  N/A
              le_mean =     -16.906092188058
             les_mean =     286.160905544697
             stat err =       0.000450677136
             autocorr =       1.261820710098
              std dev =       0.567390026940
             le_variance =       0.321931442670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321920918774
                                         uncertainty =       0.002026938165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321920918774
                                         uncertainty =       0.002026938165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401201449
  error estimate for blocks of size 2^( 2) =       0.000413953509
  error estimate for blocks of size 2^( 3) =       0.000426857906
  error estimate for blocks of size 2^( 4) =       0.000438638640
  error estimate for blocks of size 2^( 5) =       0.000446824297
  error estimate for blocks of size 2^( 6) =       0.000455511332
  error estimate for blocks of size 2^( 7) =       0.000461692707

      target function =                  N/A
              le_mean =     -16.906090966298
             les_mean =     286.150481397756
             stat err =       0.000450666744
             autocorr =       1.261786965823
              std dev =       0.567384530251
             le_variance =       0.321925205168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321986620852
                                         uncertainty =       0.002028585965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321986620852
                                         uncertainty =       0.002028585965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401242461
  error estimate for blocks of size 2^( 2) =       0.000413989692
  error estimate for blocks of size 2^( 3) =       0.000426891096
  error estimate for blocks of size 2^( 4) =       0.000438672824
  error estimate for blocks of size 2^( 5) =       0.000446856772
  error estimate for blocks of size 2^( 6) =       0.000455525319
  error estimate for blocks of size 2^( 7) =       0.000461705650

      target function =                  N/A
              le_mean =     -16.906088946101
             les_mean =     286.149903466481
             stat err =       0.000450690141
             autocorr =       1.261660030109
              std dev =       0.567442530453
             le_variance =       0.321991025367


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906088803692        initial
     5.9605e-01     5.9605e+00             5.1072e-04       -16.906092188058  <--
     2.3842e+00     2.3842e+01             1.5326e-04       -16.906090966298
     9.5367e+00     9.5367e+01             4.0369e-05       -16.906088946101

*****************************************************************************
Applying the update for shift_i =   5.9605e-01     and shift_s =   5.9605e+00
*****************************************************************************

  Execution time = 3.0811e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
   uu_0                 3.111742e-01 1 1  ON 0
   uu_1                 1.442755e-01 1 1  ON 1
   uu_2                 4.286028e-02 1 1  ON 2
   uu_3                -1.898830e-02 1 1  ON 3
   uu_4                -6.383125e-02 1 1  ON 4
   uu_5                -9.799081e-02 1 1  ON 5
   uu_6                -1.249197e-01 1 1  ON 6
   uu_7                -1.377297e-01 1 1  ON 7
   uu_8                -1.295284e-01 1 1  ON 8
   uu_9                -9.804811e-02 1 1  ON 9
   ud_0                 4.440814e-01 1 1  ON 10
   ud_1                 1.785582e-01 1 1  ON 11
   ud_2                 5.880869e-02 1 1  ON 12
   ud_3                -1.137559e-02 1 1  ON 13
   ud_4                -6.703584e-02 1 1  ON 14
   ud_5                -1.071696e-01 1 1  ON 15
   ud_6                -1.333396e-01 1 1  ON 16
   ud_7                -1.487322e-01 1 1  ON 17
   ud_8                -1.490363e-01 1 1  ON 18
   ud_9                -1.380429e-01 1 1  ON 19
   eO_0                -7.439065e-01 1 1  ON 20
   eO_1                -4.249695e-01 1 1  ON 21
   eO_2                -1.728894e-02 1 1  ON 22
   eO_3                 2.900818e-01 1 1  ON 23
   eO_4                 5.091751e-01 1 1  ON 24
   eO_5                 4.674985e-01 1 1  ON 25
   eO_6                 2.412188e-01 1 1  ON 26
   eO_7                -5.212712e-02 1 1  ON 27
   eO_8                -2.058438e-01 1 1  ON 28
   eO_9                -6.576664e-02 1 1  ON 29
  eH1_0                -2.436902e-01 1 1  ON 30
  eH1_1                -1.373968e-01 1 1  ON 31
  eH1_2                -8.846448e-02 1 1  ON 32
  eH1_3                -3.427894e-02 1 1  ON 33
  eH1_4                 1.396074e-02 1 1  ON 34
  eH1_5                 4.689946e-02 1 1  ON 35
  eH1_6                 1.002418e-01 1 1  ON 36
  eH1_7                 1.459536e-01 1 1  ON 37
  eH1_8                 1.576471e-01 1 1  ON 38
  eH1_9                 4.357609e-02 1 1  ON 39
  eH2_0                -2.418258e-01 1 1  ON 40
  eH2_1                -1.357271e-01 1 1  ON 41
  eH2_2                -8.640716e-02 1 1  ON 42
  eH2_3                -3.218378e-02 1 1  ON 43
  eH2_4                 1.680458e-02 1 1  ON 44
  eH2_5                 5.083338e-02 1 1  ON 45
  eH2_6                 1.046673e-01 1 1  ON 46
  eH2_7                 1.510255e-01 1 1  ON 47
  eH2_8                 1.640314e-01 1 1  ON 48
  eH2_9                 2.678094e-02 1 1  ON 49
ci_0001                 7.010258e-01 3 1  ON 50
ci_0002                 7.005886e-01 3 1  ON 51
ci_0003                -2.752122e-02 3 1  ON 52
ci_0004                -2.785096e-02 3 1  ON 53
ci_0005                -3.693417e-02 3 1  ON 54
ci_0006                -3.698337e-02 3 1  ON 55
ci_0007                -2.205331e-02 3 1  ON 56
ci_0008                -2.198834e-02 3 1  ON 57
ci_0009                -1.688527e-02 3 1  ON 58
ci_0010                -1.714848e-02 3 1  ON 59
ci_0011                -1.225597e-02 3 1  ON 60
ci_0012                -1.207079e-02 3 1  ON 61
ci_0013                 1.358149e-02 3 1  ON 62
ci_0014                 1.356258e-02 3 1  ON 63
ci_0015                 1.292812e-02 3 1  ON 64
ci_0016                 1.299950e-02 3 1  ON 65
ci_0017                 1.114059e-02 3 1  ON 66
ci_0018                 1.134892e-02 3 1  ON 67
ci_0019                 1.132488e-02 3 1  ON 68
ci_0020                 1.154981e-02 3 1  ON 69
ci_0021                -2.518501e-04 3 1  ON 70
ci_0022                -8.257956e-04 3 1  ON 71
ci_0023                -1.125681e-02 3 1  ON 72
ci_0024                -1.114288e-02 3 1  ON 73
ci_0025                -1.001687e-02 3 1  ON 74
ci_0026                -1.075036e-02 3 1  ON 75
ci_0027                -1.100146e-02 3 1  ON 76
ci_0028                -1.102615e-02 3 1  ON 77
ci_0029                -1.093445e-02 3 1  ON 78
ci_0030                -1.081092e-02 3 1  ON 79
ci_0031                 2.012489e-02 3 1  ON 80
ci_0032                 2.002301e-02 3 1  ON 81
ci_0033                 9.976887e-03 3 1  ON 82
ci_0034                 9.937184e-03 3 1  ON 83
ci_0035                 7.014413e-03 3 1  ON 84
ci_0036                 6.707372e-03 3 1  ON 85
ci_0037                -1.020561e-02 3 1  ON 86
ci_0038                -1.069702e-02 3 1  ON 87
ci_0039                -2.572877e-03 3 1  ON 88
ci_0040                -2.653664e-03 3 1  ON 89
ci_0041                 7.571741e-03 3 1  ON 90
ci_0042                 7.184100e-03 3 1  ON 91
ci_0043                -1.803838e-02 3 1  ON 92
ci_0044                -1.890476e-02 3 1  ON 93
ci_0045                 7.865282e-03 3 1  ON 94
ci_0046                 7.558166e-03 3 1  ON 95
ci_0047                -1.804398e-03 3 1  ON 96
ci_0048                -1.862661e-03 3 1  ON 97
ci_0049                -5.622199e-03 3 1  ON 98
ci_0050                -5.723799e-03 3 1  ON 99
ci_0051                -3.647096e-03 3 1  ON 100
ci_0052                -3.295735e-03 3 1  ON 101
ci_0053                -5.177101e-03 3 1  ON 102
ci_0054                -4.350062e-03 3 1  ON 103
ci_0055                 6.130707e-03 3 1  ON 104
ci_0056                 6.801613e-03 3 1  ON 105
ci_0057                 4.993731e-03 3 1  ON 106
ci_0058                 5.173856e-03 3 1  ON 107
ci_0059                -4.963933e-03 3 1  ON 108
ci_0060                -4.652564e-03 3 1  ON 109
ci_0061                -3.957160e-03 3 1  ON 110
ci_0062                -3.837902e-03 3 1  ON 111
ci_0063                -9.104125e-03 3 1  ON 112
ci_0064                -8.950293e-03 3 1  ON 113
ci_0065                -5.443756e-03 3 1  ON 114
ci_0066                -5.392962e-03 3 1  ON 115
ci_0067                -4.669400e-03 3 1  ON 116
ci_0068                -4.944115e-03 3 1  ON 117
ci_0069                 4.422308e-03 3 1  ON 118
ci_0070                 4.589344e-03 3 1  ON 119
ci_0071                 2.592367e-04 3 1  ON 120
ci_0072                 6.356776e-04 3 1  ON 121
ci_0073                 4.553650e-03 3 1  ON 122
ci_0074                 4.066805e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8634e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6890e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8453
    reference variance = 0.346947
====================================================
  Execution time = 2.2185e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4194e-01
  Total weights = 1.952084530e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1407e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326524558384
                                         uncertainty =       0.005185646268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326524558384
                                         uncertainty =       0.005185646268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404026121
  error estimate for blocks of size 2^( 2) =       0.000416755407
  error estimate for blocks of size 2^( 3) =       0.000430214759
  error estimate for blocks of size 2^( 4) =       0.000442992779
  error estimate for blocks of size 2^( 5) =       0.000454456980
  error estimate for blocks of size 2^( 6) =       0.000461387429
  error estimate for blocks of size 2^( 7) =       0.000464923124

      target function =                  N/A
              le_mean =     -16.906016003737
             les_mean =     286.155321242714
             stat err =       0.000455940078
             autocorr =       1.273493258125
              std dev =       0.571379220109
             le_variance =       0.326474213172


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690601600374e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906016003724       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906020088913       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906022589208       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906020673693       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906020679254       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906023470180       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906024050425       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906024209075       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906024423278       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906024855467       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906025155373       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906025134359       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906025229511       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906025229329       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e-01 is 3.252169e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906016003724       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906017729732       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906018372854       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906017729421       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906018076823       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906019022597       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906018967450       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906018756076       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906018815494       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906018944959       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906018992580       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e-01 is 1.098396e-03

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906016003724       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906016525178       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906016669830       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906016603270       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906016561537       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906016871095       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906016842639       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906016813310       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906016806510       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906016842493       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+00 is 3.021241e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.382016 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8335e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
   uu_0                 3.113842e-01 1 1  ON 0
   uu_1                 1.442797e-01 1 1  ON 1
   uu_2                 4.286388e-02 1 1  ON 2
   uu_3                -1.905444e-02 1 1  ON 3
   uu_4                -6.393402e-02 1 1  ON 4
   uu_5                -9.817112e-02 1 1  ON 5
   uu_6                -1.250746e-01 1 1  ON 6
   uu_7                -1.378118e-01 1 1  ON 7
   uu_8                -1.296505e-01 1 1  ON 8
   uu_9                -9.809957e-02 1 1  ON 9
   ud_0                 4.441743e-01 1 1  ON 10
   ud_1                 1.785486e-01 1 1  ON 11
   ud_2                 5.876062e-02 1 1  ON 12
   ud_3                -1.141908e-02 1 1  ON 13
   ud_4                -6.713152e-02 1 1  ON 14
   ud_5                -1.073147e-01 1 1  ON 15
   ud_6                -1.333693e-01 1 1  ON 16
   ud_7                -1.488258e-01 1 1  ON 17
   ud_8                -1.491809e-01 1 1  ON 18
   ud_9                -1.378052e-01 1 1  ON 19
   eO_0                -7.440733e-01 1 1  ON 20
   eO_1                -4.252505e-01 1 1  ON 21
   eO_2                -1.737902e-02 1 1  ON 22
   eO_3                 2.901248e-01 1 1  ON 23
   eO_4                 5.094267e-01 1 1  ON 24
   eO_5                 4.677397e-01 1 1  ON 25
   eO_6                 2.414659e-01 1 1  ON 26
   eO_7                -5.197912e-02 1 1  ON 27
   eO_8                -2.060637e-01 1 1  ON 28
   eO_9                -6.592252e-02 1 1  ON 29
  eH1_0                -2.438523e-01 1 1  ON 30
  eH1_1                -1.375926e-01 1 1  ON 31
  eH1_2                -8.879407e-02 1 1  ON 32
  eH1_3                -3.455573e-02 1 1  ON 33
  eH1_4                 1.383681e-02 1 1  ON 34
  eH1_5                 4.689113e-02 1 1  ON 35
  eH1_6                 1.004373e-01 1 1  ON 36
  eH1_7                 1.461897e-01 1 1  ON 37
  eH1_8                 1.579711e-01 1 1  ON 38
  eH1_9                 4.387822e-02 1 1  ON 39
  eH2_0                -2.419485e-01 1 1  ON 40
  eH2_1                -1.359382e-01 1 1  ON 41
  eH2_2                -8.673115e-02 1 1  ON 42
  eH2_3                -3.229116e-02 1 1  ON 43
  eH2_4                 1.660793e-02 1 1  ON 44
  eH2_5                 5.059798e-02 1 1  ON 45
  eH2_6                 1.047459e-01 1 1  ON 46
  eH2_7                 1.511884e-01 1 1  ON 47
  eH2_8                 1.644101e-01 1 1  ON 48
  eH2_9                 2.730068e-02 1 1  ON 49
ci_0001                 7.010811e-01 3 1  ON 50
ci_0002                 7.004821e-01 3 1  ON 51
ci_0003                -2.737459e-02 3 1  ON 52
ci_0004                -2.808495e-02 3 1  ON 53
ci_0005                -3.679852e-02 3 1  ON 54
ci_0006                -3.714675e-02 3 1  ON 55
ci_0007                -2.315171e-02 3 1  ON 56
ci_0008                -2.181266e-02 3 1  ON 57
ci_0009                -1.693769e-02 3 1  ON 58
ci_0010                -1.739036e-02 3 1  ON 59
ci_0011                -1.212012e-02 3 1  ON 60
ci_0012                -1.204739e-02 3 1  ON 61
ci_0013                 1.362484e-02 3 1  ON 62
ci_0014                 1.335394e-02 3 1  ON 63
ci_0015                 1.298255e-02 3 1  ON 64
ci_0016                 1.288178e-02 3 1  ON 65
ci_0017                 1.124333e-02 3 1  ON 66
ci_0018                 1.112760e-02 3 1  ON 67
ci_0019                 1.138611e-02 3 1  ON 68
ci_0020                 1.132666e-02 3 1  ON 69
ci_0021                -6.009986e-04 3 1  ON 70
ci_0022                -5.380946e-04 3 1  ON 71
ci_0023                -1.130919e-02 3 1  ON 72
ci_0024                -1.139800e-02 3 1  ON 73
ci_0025                -1.024534e-02 3 1  ON 74
ci_0026                -1.072585e-02 3 1  ON 75
ci_0027                -1.116974e-02 3 1  ON 76
ci_0028                -1.116091e-02 3 1  ON 77
ci_0029                -1.087408e-02 3 1  ON 78
ci_0030                -1.082454e-02 3 1  ON 79
ci_0031                 2.006730e-02 3 1  ON 80
ci_0032                 2.018546e-02 3 1  ON 81
ci_0033                 9.912652e-03 3 1  ON 82
ci_0034                 9.889302e-03 3 1  ON 83
ci_0035                 6.965624e-03 3 1  ON 84
ci_0036                 7.006350e-03 3 1  ON 85
ci_0037                -1.049295e-02 3 1  ON 86
ci_0038                -1.073562e-02 3 1  ON 87
ci_0039                -2.717130e-03 3 1  ON 88
ci_0040                -2.833669e-03 3 1  ON 89
ci_0041                 7.408209e-03 3 1  ON 90
ci_0042                 7.253019e-03 3 1  ON 91
ci_0043                -1.814183e-02 3 1  ON 92
ci_0044                -1.880341e-02 3 1  ON 93
ci_0045                 7.980369e-03 3 1  ON 94
ci_0046                 7.384166e-03 3 1  ON 95
ci_0047                -1.745381e-03 3 1  ON 96
ci_0048                -2.045244e-03 3 1  ON 97
ci_0049                -5.937605e-03 3 1  ON 98
ci_0050                -5.630344e-03 3 1  ON 99
ci_0051                -3.582893e-03 3 1  ON 100
ci_0052                -3.420666e-03 3 1  ON 101
ci_0053                -5.119664e-03 3 1  ON 102
ci_0054                -4.286085e-03 3 1  ON 103
ci_0055                 6.163986e-03 3 1  ON 104
ci_0056                 6.681179e-03 3 1  ON 105
ci_0057                 4.975864e-03 3 1  ON 106
ci_0058                 5.625884e-03 3 1  ON 107
ci_0059                -4.784131e-03 3 1  ON 108
ci_0060                -4.976561e-03 3 1  ON 109
ci_0061                -3.676302e-03 3 1  ON 110
ci_0062                -3.393447e-03 3 1  ON 111
ci_0063                -9.423762e-03 3 1  ON 112
ci_0064                -8.755923e-03 3 1  ON 113
ci_0065                -5.421398e-03 3 1  ON 114
ci_0066                -5.368037e-03 3 1  ON 115
ci_0067                -5.077977e-03 3 1  ON 116
ci_0068                -4.881247e-03 3 1  ON 117
ci_0069                 4.417480e-03 3 1  ON 118
ci_0070                 4.497315e-03 3 1  ON 119
ci_0071                 5.077898e-04 3 1  ON 120
ci_0072                 6.318527e-04 3 1  ON 121
ci_0073                 4.287618e-03 3 1  ON 122
ci_0074                 4.082975e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8356
    reference variance = 0.304538
====================================================
  Execution time = 2.1132e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3036e-01
  Total weights = 1.9515e+06
  Execution time = 1.8910e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318148402313
                                         uncertainty =       0.001980500721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318148402313
                                         uncertainty =       0.001980500721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398893271
  error estimate for blocks of size 2^( 2) =       0.000412414760
  error estimate for blocks of size 2^( 3) =       0.000426058687
  error estimate for blocks of size 2^( 4) =       0.000439598343
  error estimate for blocks of size 2^( 5) =       0.000451242146
  error estimate for blocks of size 2^( 6) =       0.000460540930
  error estimate for blocks of size 2^( 7) =       0.000466334281

      target function =                  N/A
              le_mean =     -16.905467093559
             les_mean =     286.125438586288
             stat err =       0.000454428925
             autocorr =       1.297832106596
              std dev =       0.564120273910
             le_variance =       0.318231683436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319005785233
                                         uncertainty =       0.001985789817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319005785233
                                         uncertainty =       0.001985789817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399427388
  error estimate for blocks of size 2^( 2) =       0.000412920221
  error estimate for blocks of size 2^( 3) =       0.000426519589
  error estimate for blocks of size 2^( 4) =       0.000440007937
  error estimate for blocks of size 2^( 5) =       0.000451646891
  error estimate for blocks of size 2^( 6) =       0.000461000214
  error estimate for blocks of size 2^( 7) =       0.000466841453

      target function =                  N/A
              le_mean =     -16.905481515652
             les_mean =     286.152257941942
             stat err =       0.000454874124
             autocorr =       1.296900875438
              std dev =       0.564875629225
             le_variance =       0.319084476493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318806274616
                                         uncertainty =       0.001987255545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318806274616
                                         uncertainty =       0.001987255545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399303176
  error estimate for blocks of size 2^( 2) =       0.000412801614
  error estimate for blocks of size 2^( 3) =       0.000426407292
  error estimate for blocks of size 2^( 4) =       0.000439907918
  error estimate for blocks of size 2^( 5) =       0.000451552890
  error estimate for blocks of size 2^( 6) =       0.000460879716
  error estimate for blocks of size 2^( 7) =       0.000466709506

      target function =                  N/A
              le_mean =     -16.905470787893
             les_mean =     286.127324669195
             stat err =       0.000454762508
             autocorr =       1.297071078798
              std dev =       0.564699967144
             le_variance =       0.318886052892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318230571800
                                         uncertainty =       0.001980730969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318230571800
                                         uncertainty =       0.001980730969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398944449
  error estimate for blocks of size 2^( 2) =       0.000412462031
  error estimate for blocks of size 2^( 3) =       0.000426101021
  error estimate for blocks of size 2^( 4) =       0.000439634306
  error estimate for blocks of size 2^( 5) =       0.000451279241
  error estimate for blocks of size 2^( 6) =       0.000460581666
  error estimate for blocks of size 2^( 7) =       0.000466378814

      target function =                  N/A
              le_mean =     -16.905464451238
             les_mean =     286.125211507844
             stat err =       0.000454468507
             autocorr =       1.297725187325
              std dev =       0.564192650092
             le_variance =       0.318313346418


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905467093559        initial
     1.4901e-01     1.4901e+00             3.2522e-03       -16.905481515652  <--
     5.9605e-01     5.9605e+00             1.0984e-03       -16.905470787893
     2.3842e+00     2.3842e+01             3.0212e-04       -16.905464451238

*****************************************************************************
Applying the update for shift_i =   1.4901e-01     and shift_s =   1.4901e+00
*****************************************************************************

  Execution time = 3.0671e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
   uu_0                 3.116227e-01 1 1  ON 0
   uu_1                 1.443243e-01 1 1  ON 1
   uu_2                 4.286640e-02 1 1  ON 2
   uu_3                -1.919409e-02 1 1  ON 3
   uu_4                -6.418839e-02 1 1  ON 4
   uu_5                -9.856596e-02 1 1  ON 5
   uu_6                -1.254444e-01 1 1  ON 6
   uu_7                -1.380877e-01 1 1  ON 7
   uu_8                -1.299907e-01 1 1  ON 8
   uu_9                -9.825080e-02 1 1  ON 9
   ud_0                 4.442823e-01 1 1  ON 10
   ud_1                 1.785517e-01 1 1  ON 11
   ud_2                 5.871033e-02 1 1  ON 12
   ud_3                -1.153475e-02 1 1  ON 13
   ud_4                -6.734158e-02 1 1  ON 14
   ud_5                -1.076311e-01 1 1  ON 15
   ud_6                -1.336089e-01 1 1  ON 16
   ud_7                -1.490816e-01 1 1  ON 17
   ud_8                -1.495874e-01 1 1  ON 18
   ud_9                -1.371580e-01 1 1  ON 19
   eO_0                -7.446786e-01 1 1  ON 20
   eO_1                -4.258810e-01 1 1  ON 21
   eO_2                -1.766669e-02 1 1  ON 22
   eO_3                 2.902441e-01 1 1  ON 23
   eO_4                 5.100437e-01 1 1  ON 24
   eO_5                 4.684685e-01 1 1  ON 25
   eO_6                 2.422475e-01 1 1  ON 26
   eO_7                -5.151569e-02 1 1  ON 27
   eO_8                -2.067247e-01 1 1  ON 28
   eO_9                -6.639615e-02 1 1  ON 29
  eH1_0                -2.444397e-01 1 1  ON 30
  eH1_1                -1.382791e-01 1 1  ON 31
  eH1_2                -8.958893e-02 1 1  ON 32
  eH1_3                -3.524657e-02 1 1  ON 33
  eH1_4                 1.342037e-02 1 1  ON 34
  eH1_5                 4.678240e-02 1 1  ON 35
  eH1_6                 1.009527e-01 1 1  ON 36
  eH1_7                 1.469233e-01 1 1  ON 37
  eH1_8                 1.589693e-01 1 1  ON 38
  eH1_9                 4.479718e-02 1 1  ON 39
  eH2_0                -2.424260e-01 1 1  ON 40
  eH2_1                -1.365836e-01 1 1  ON 41
  eH2_2                -8.748564e-02 1 1  ON 42
  eH2_3                -3.278730e-02 1 1  ON 43
  eH2_4                 1.608809e-02 1 1  ON 44
  eH2_5                 4.996819e-02 1 1  ON 45
  eH2_6                 1.048993e-01 1 1  ON 46
  eH2_7                 1.516708e-01 1 1  ON 47
  eH2_8                 1.655517e-01 1 1  ON 48
  eH2_9                 2.887149e-02 1 1  ON 49
ci_0001                 7.012398e-01 3 1  ON 50
ci_0002                 7.002401e-01 3 1  ON 51
ci_0003                -2.715151e-02 3 1  ON 52
ci_0004                -2.842939e-02 3 1  ON 53
ci_0005                -3.655652e-02 3 1  ON 54
ci_0006                -3.744053e-02 3 1  ON 55
ci_0007                -2.530548e-02 3 1  ON 56
ci_0008                -2.148146e-02 3 1  ON 57
ci_0009                -1.699190e-02 3 1  ON 58
ci_0010                -1.767447e-02 3 1  ON 59
ci_0011                -1.193121e-02 3 1  ON 60
ci_0012                -1.202404e-02 3 1  ON 61
ci_0013                 1.368560e-02 3 1  ON 62
ci_0014                 1.305829e-02 3 1  ON 63
ci_0015                 1.304734e-02 3 1  ON 64
ci_0016                 1.272261e-02 3 1  ON 65
ci_0017                 1.136797e-02 3 1  ON 66
ci_0018                 1.085287e-02 3 1  ON 67
ci_0019                 1.145842e-02 3 1  ON 68
ci_0020                 1.104078e-02 3 1  ON 69
ci_0021                -1.288783e-03 3 1  ON 70
ci_0022                 3.182451e-06 3 1  ON 71
ci_0023                -1.136209e-02 3 1  ON 72
ci_0024                -1.170937e-02 3 1  ON 73
ci_0025                -1.054322e-02 3 1  ON 74
ci_0026                -1.069925e-02 3 1  ON 75
ci_0027                -1.138653e-02 3 1  ON 76
ci_0028                -1.132486e-02 3 1  ON 77
ci_0029                -1.080803e-02 3 1  ON 78
ci_0030                -1.083783e-02 3 1  ON 79
ci_0031                 1.999285e-02 3 1  ON 80
ci_0032                 2.047105e-02 3 1  ON 81
ci_0033                 9.812766e-03 3 1  ON 82
ci_0034                 9.808641e-03 3 1  ON 83
ci_0035                 6.884685e-03 3 1  ON 84
ci_0036                 7.404197e-03 3 1  ON 85
ci_0037                -1.089730e-02 3 1  ON 86
ci_0038                -1.078806e-02 3 1  ON 87
ci_0039                -2.849598e-03 3 1  ON 88
ci_0040                -2.990876e-03 3 1  ON 89
ci_0041                 7.188872e-03 3 1  ON 90
ci_0042                 7.353012e-03 3 1  ON 91
ci_0043                -1.829831e-02 3 1  ON 92
ci_0044                -1.857962e-02 3 1  ON 93
ci_0045                 8.159693e-03 3 1  ON 94
ci_0046                 7.103277e-03 3 1  ON 95
ci_0047                -1.685151e-03 3 1  ON 96
ci_0048                -2.213597e-03 3 1  ON 97
ci_0049                -6.346605e-03 3 1  ON 98
ci_0050                -5.495909e-03 3 1  ON 99
ci_0051                -3.516516e-03 3 1  ON 100
ci_0052                -3.532449e-03 3 1  ON 101
ci_0053                -5.068366e-03 3 1  ON 102
ci_0054                -4.218847e-03 3 1  ON 103
ci_0055                 6.205898e-03 3 1  ON 104
ci_0056                 6.494853e-03 3 1  ON 105
ci_0057                 4.949170e-03 3 1  ON 106
ci_0058                 6.275618e-03 3 1  ON 107
ci_0059                -4.597513e-03 3 1  ON 108
ci_0060                -5.308804e-03 3 1  ON 109
ci_0061                -3.294816e-03 3 1  ON 110
ci_0062                -2.780727e-03 3 1  ON 111
ci_0063                -9.744018e-03 3 1  ON 112
ci_0064                -8.548238e-03 3 1  ON 113
ci_0065                -5.395872e-03 3 1  ON 114
ci_0066                -5.331867e-03 3 1  ON 115
ci_0067                -5.481342e-03 3 1  ON 116
ci_0068                -4.818478e-03 3 1  ON 117
ci_0069                 4.412526e-03 3 1  ON 118
ci_0070                 4.406709e-03 3 1  ON 119
ci_0071                 8.527363e-04 3 1  ON 120
ci_0072                 6.092435e-04 3 1  ON 121
ci_0073                 4.034629e-03 3 1  ON 122
ci_0074                 4.095254e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9013e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6888e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9574
    reference variance = 0.187513
====================================================
  Execution time = 2.1870e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3588e-01
  Total weights = 1.951749874e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0943e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322280674406
                                         uncertainty =       0.002156359262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322280674406
                                         uncertainty =       0.002156359262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401406066
  error estimate for blocks of size 2^( 2) =       0.000414293120
  error estimate for blocks of size 2^( 3) =       0.000427855551
  error estimate for blocks of size 2^( 4) =       0.000440364855
  error estimate for blocks of size 2^( 5) =       0.000452059477
  error estimate for blocks of size 2^( 6) =       0.000459390249
  error estimate for blocks of size 2^( 7) =       0.000467784676

      target function =                  N/A
              le_mean =     -16.906157874655
             les_mean =     286.154054848037
             stat err =       0.000454899814
             autocorr =       1.284291640416
              std dev =       0.567673903032
             le_variance =       0.322253660183


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690615787466e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-02, overlap shift 3.7253e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906157874636       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906190494366       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906191936871       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906200712554       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906201462119       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906200086833       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906205704574       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906208487658       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906209420011       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906211057656       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906211776014       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906212045353       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906213551191       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906213610193       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906213268738       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906213144163       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906213414089       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906213471190       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906213297256       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906213442241       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906213625579       residual = 9.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.7253e-02 is 6.270229e-03

solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906157874636       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906180033547       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906180172134       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906183250210       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906184757398       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906184369975       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906188092522       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906188070005       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906187348023       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906187523887       residual = 9.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906187732998       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906187800515       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906187834659       residual = 8.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e-01 is 2.296196e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906157874636       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906167581675       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906167423780       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906167783375       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906168843859       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906169441825       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906170077724       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906169793409       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906169710550       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906169665118       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906169699881       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e-01 is 7.772360e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.391132 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7979e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
   uu_0                 3.117223e-01 1 1  ON 0
   uu_1                 1.445804e-01 1 1  ON 1
   uu_2                 4.313612e-02 1 1  ON 2
   uu_3                -1.925644e-02 1 1  ON 3
   uu_4                -6.463497e-02 1 1  ON 4
   uu_5                -9.847701e-02 1 1  ON 5
   uu_6                -1.253907e-01 1 1  ON 6
   uu_7                -1.383692e-01 1 1  ON 7
   uu_8                -1.304732e-01 1 1  ON 8
   uu_9                -9.900437e-02 1 1  ON 9
   ud_0                 4.443905e-01 1 1  ON 10
   ud_1                 1.789925e-01 1 1  ON 11
   ud_2                 5.908781e-02 1 1  ON 12
   ud_3                -1.111042e-02 1 1  ON 13
   ud_4                -6.727595e-02 1 1  ON 14
   ud_5                -1.080303e-01 1 1  ON 15
   ud_6                -1.342307e-01 1 1  ON 16
   ud_7                -1.490674e-01 1 1  ON 17
   ud_8                -1.497078e-01 1 1  ON 18
   ud_9                -1.375877e-01 1 1  ON 19
   eO_0                -7.452694e-01 1 1  ON 20
   eO_1                -4.263494e-01 1 1  ON 21
   eO_2                -1.818286e-02 1 1  ON 22
   eO_3                 2.902903e-01 1 1  ON 23
   eO_4                 5.111097e-01 1 1  ON 24
   eO_5                 4.698014e-01 1 1  ON 25
   eO_6                 2.428863e-01 1 1  ON 26
   eO_7                -5.111221e-02 1 1  ON 27
   eO_8                -2.077585e-01 1 1  ON 28
   eO_9                -6.717738e-02 1 1  ON 29
  eH1_0                -2.453335e-01 1 1  ON 30
  eH1_1                -1.393576e-01 1 1  ON 31
  eH1_2                -9.037914e-02 1 1  ON 32
  eH1_3                -3.575648e-02 1 1  ON 33
  eH1_4                 1.310089e-02 1 1  ON 34
  eH1_5                 4.660222e-02 1 1  ON 35
  eH1_6                 1.008016e-01 1 1  ON 36
  eH1_7                 1.474303e-01 1 1  ON 37
  eH1_8                 1.604628e-01 1 1  ON 38
  eH1_9                 4.633440e-02 1 1  ON 39
  eH2_0                -2.435853e-01 1 1  ON 40
  eH2_1                -1.372125e-01 1 1  ON 41
  eH2_2                -8.800357e-02 1 1  ON 42
  eH2_3                -3.325975e-02 1 1  ON 43
  eH2_4                 1.617275e-02 1 1  ON 44
  eH2_5                 5.007124e-02 1 1  ON 45
  eH2_6                 1.050863e-01 1 1  ON 46
  eH2_7                 1.519173e-01 1 1  ON 47
  eH2_8                 1.663245e-01 1 1  ON 48
  eH2_9                 3.014868e-02 1 1  ON 49
ci_0001                 7.011591e-01 3 1  ON 50
ci_0002                 7.003505e-01 3 1  ON 51
ci_0003                -2.698156e-02 3 1  ON 52
ci_0004                -2.767765e-02 3 1  ON 53
ci_0005                -3.641459e-02 3 1  ON 54
ci_0006                -3.753489e-02 3 1  ON 55
ci_0007                -2.300929e-02 3 1  ON 56
ci_0008                -2.238240e-02 3 1  ON 57
ci_0009                -1.748137e-02 3 1  ON 58
ci_0010                -1.709616e-02 3 1  ON 59
ci_0011                -1.219137e-02 3 1  ON 60
ci_0012                -1.243610e-02 3 1  ON 61
ci_0013                 1.348231e-02 3 1  ON 62
ci_0014                 1.307617e-02 3 1  ON 63
ci_0015                 1.369305e-02 3 1  ON 64
ci_0016                 1.272900e-02 3 1  ON 65
ci_0017                 1.130458e-02 3 1  ON 66
ci_0018                 1.139734e-02 3 1  ON 67
ci_0019                 1.137381e-02 3 1  ON 68
ci_0020                 1.081207e-02 3 1  ON 69
ci_0021                -1.774249e-03 3 1  ON 70
ci_0022                -1.581088e-04 3 1  ON 71
ci_0023                -1.175072e-02 3 1  ON 72
ci_0024                -1.171941e-02 3 1  ON 73
ci_0025                -1.098645e-02 3 1  ON 74
ci_0026                -1.024153e-02 3 1  ON 75
ci_0027                -1.119441e-02 3 1  ON 76
ci_0028                -1.139606e-02 3 1  ON 77
ci_0029                -1.059307e-02 3 1  ON 78
ci_0030                -1.077033e-02 3 1  ON 79
ci_0031                 1.980358e-02 3 1  ON 80
ci_0032                 2.076803e-02 3 1  ON 81
ci_0033                 1.017035e-02 3 1  ON 82
ci_0034                 9.798426e-03 3 1  ON 83
ci_0035                 7.316216e-03 3 1  ON 84
ci_0036                 7.174642e-03 3 1  ON 85
ci_0037                -1.064432e-02 3 1  ON 86
ci_0038                -1.064254e-02 3 1  ON 87
ci_0039                -2.499093e-03 3 1  ON 88
ci_0040                -2.834046e-03 3 1  ON 89
ci_0041                 7.602068e-03 3 1  ON 90
ci_0042                 7.491811e-03 3 1  ON 91
ci_0043                -1.878251e-02 3 1  ON 92
ci_0044                -1.918136e-02 3 1  ON 93
ci_0045                 7.659410e-03 3 1  ON 94
ci_0046                 7.824124e-03 3 1  ON 95
ci_0047                -2.162972e-03 3 1  ON 96
ci_0048                -2.004108e-03 3 1  ON 97
ci_0049                -6.250388e-03 3 1  ON 98
ci_0050                -6.061334e-03 3 1  ON 99
ci_0051                -3.077997e-03 3 1  ON 100
ci_0052                -3.686686e-03 3 1  ON 101
ci_0053                -5.012399e-03 3 1  ON 102
ci_0054                -4.582264e-03 3 1  ON 103
ci_0055                 6.126795e-03 3 1  ON 104
ci_0056                 6.960646e-03 3 1  ON 105
ci_0057                 5.031903e-03 3 1  ON 106
ci_0058                 5.669347e-03 3 1  ON 107
ci_0059                -4.749881e-03 3 1  ON 108
ci_0060                -4.853078e-03 3 1  ON 109
ci_0061                -3.687495e-03 3 1  ON 110
ci_0062                -3.181165e-03 3 1  ON 111
ci_0063                -9.871773e-03 3 1  ON 112
ci_0064                -8.797944e-03 3 1  ON 113
ci_0065                -5.423987e-03 3 1  ON 114
ci_0066                -5.814161e-03 3 1  ON 115
ci_0067                -5.378084e-03 3 1  ON 116
ci_0068                -4.496863e-03 3 1  ON 117
ci_0069                 4.309272e-03 3 1  ON 118
ci_0070                 4.734061e-03 3 1  ON 119
ci_0071                 5.789970e-04 3 1  ON 120
ci_0072                 1.125452e-04 3 1  ON 121
ci_0073                 3.611957e-03 3 1  ON 122
ci_0074                 3.981952e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.968
    reference variance = 0.162308
====================================================
  Execution time = 2.1572e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2966e-01
  Total weights = 1.9516e+06
  Execution time = 1.8871e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319924759148
                                         uncertainty =       0.002043375269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319924759148
                                         uncertainty =       0.002043375269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399887664
  error estimate for blocks of size 2^( 2) =       0.000412590697
  error estimate for blocks of size 2^( 3) =       0.000425430326
  error estimate for blocks of size 2^( 4) =       0.000438790541
  error estimate for blocks of size 2^( 5) =       0.000450428640
  error estimate for blocks of size 2^( 6) =       0.000459125482
  error estimate for blocks of size 2^( 7) =       0.000463389251

      target function =                  N/A
              le_mean =     -16.905081954056
             les_mean =     286.188722672427
             stat err =       0.000452933478
             autocorr =       1.282900077566
              std dev =       0.565526557778
             le_variance =       0.319820287553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319521418651
                                         uncertainty =       0.002045265157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319521418651
                                         uncertainty =       0.002045265157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399635026
  error estimate for blocks of size 2^( 2) =       0.000412355054
  error estimate for blocks of size 2^( 3) =       0.000425189445
  error estimate for blocks of size 2^( 4) =       0.000438473096
  error estimate for blocks of size 2^( 5) =       0.000450064122
  error estimate for blocks of size 2^( 6) =       0.000458867419
  error estimate for blocks of size 2^( 7) =       0.000462988004

      target function =                  N/A
              le_mean =     -16.905072690149
             les_mean =     286.150990357429
             stat err =       0.000452598160
             autocorr =       1.282621389420
              std dev =       0.565169273956
             le_variance =       0.319416308224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318824278987
                                         uncertainty =       0.002023354850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318824278987
                                         uncertainty =       0.002023354850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399199479
  error estimate for blocks of size 2^( 2) =       0.000411940739
  error estimate for blocks of size 2^( 3) =       0.000424788968
  error estimate for blocks of size 2^( 4) =       0.000438073476
  error estimate for blocks of size 2^( 5) =       0.000449714409
  error estimate for blocks of size 2^( 6) =       0.000458465160
  error estimate for blocks of size 2^( 7) =       0.000462671077

      target function =                  N/A
              le_mean =     -16.905079319826
             les_mean =     286.114553172464
             stat err =       0.000452231030
             autocorr =       1.283337207388
              std dev =       0.564553317271
             le_variance =       0.318720448042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318758311729
                                         uncertainty =       0.001970457259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318758311729
                                         uncertainty =       0.001970457259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399157022
  error estimate for blocks of size 2^( 2) =       0.000411893650
  error estimate for blocks of size 2^( 3) =       0.000424748423
  error estimate for blocks of size 2^( 4) =       0.000438043601
  error estimate for blocks of size 2^( 5) =       0.000449716673
  error estimate for blocks of size 2^( 6) =       0.000458513973
  error estimate for blocks of size 2^( 7) =       0.000462821559

      target function =                  N/A
              le_mean =     -16.905049913512
             les_mean =     286.114009171473
             stat err =       0.000452273952
             autocorr =       1.283853894285
              std dev =       0.564493274554
             le_variance =       0.318652657017


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905081954056        initial  <--
     3.7253e-02     3.7253e-01             6.2702e-03       -16.905072690149
     1.4901e-01     1.4901e+00             2.2962e-03       -16.905079319826
     5.9605e-01     5.9605e+00             7.7724e-04       -16.905049913512

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.1169
  </log>
  <optVariables href="H2O.s029.opt.xml">
   uu_0                 3.116227e-01 1 1  ON 0
   uu_1                 1.443243e-01 1 1  ON 1
   uu_2                 4.286640e-02 1 1  ON 2
   uu_3                -1.919409e-02 1 1  ON 3
   uu_4                -6.418839e-02 1 1  ON 4
   uu_5                -9.856596e-02 1 1  ON 5
   uu_6                -1.254444e-01 1 1  ON 6
   uu_7                -1.380877e-01 1 1  ON 7
   uu_8                -1.299907e-01 1 1  ON 8
   uu_9                -9.825080e-02 1 1  ON 9
   ud_0                 4.442823e-01 1 1  ON 10
   ud_1                 1.785517e-01 1 1  ON 11
   ud_2                 5.871033e-02 1 1  ON 12
   ud_3                -1.153475e-02 1 1  ON 13
   ud_4                -6.734158e-02 1 1  ON 14
   ud_5                -1.076311e-01 1 1  ON 15
   ud_6                -1.336089e-01 1 1  ON 16
   ud_7                -1.490816e-01 1 1  ON 17
   ud_8                -1.495874e-01 1 1  ON 18
   ud_9                -1.371580e-01 1 1  ON 19
   eO_0                -7.446786e-01 1 1  ON 20
   eO_1                -4.258810e-01 1 1  ON 21
   eO_2                -1.766669e-02 1 1  ON 22
   eO_3                 2.902441e-01 1 1  ON 23
   eO_4                 5.100437e-01 1 1  ON 24
   eO_5                 4.684685e-01 1 1  ON 25
   eO_6                 2.422475e-01 1 1  ON 26
   eO_7                -5.151569e-02 1 1  ON 27
   eO_8                -2.067247e-01 1 1  ON 28
   eO_9                -6.639615e-02 1 1  ON 29
  eH1_0                -2.444397e-01 1 1  ON 30
  eH1_1                -1.382791e-01 1 1  ON 31
  eH1_2                -8.958893e-02 1 1  ON 32
  eH1_3                -3.524657e-02 1 1  ON 33
  eH1_4                 1.342037e-02 1 1  ON 34
  eH1_5                 4.678240e-02 1 1  ON 35
  eH1_6                 1.009527e-01 1 1  ON 36
  eH1_7                 1.469233e-01 1 1  ON 37
  eH1_8                 1.589693e-01 1 1  ON 38
  eH1_9                 4.479718e-02 1 1  ON 39
  eH2_0                -2.424260e-01 1 1  ON 40
  eH2_1                -1.365836e-01 1 1  ON 41
  eH2_2                -8.748564e-02 1 1  ON 42
  eH2_3                -3.278730e-02 1 1  ON 43
  eH2_4                 1.608809e-02 1 1  ON 44
  eH2_5                 4.996819e-02 1 1  ON 45
  eH2_6                 1.048993e-01 1 1  ON 46
  eH2_7                 1.516708e-01 1 1  ON 47
  eH2_8                 1.655517e-01 1 1  ON 48
  eH2_9                 2.887149e-02 1 1  ON 49
ci_0001                 7.012398e-01 3 1  ON 50
ci_0002                 7.002401e-01 3 1  ON 51
ci_0003                -2.715151e-02 3 1  ON 52
ci_0004                -2.842939e-02 3 1  ON 53
ci_0005                -3.655652e-02 3 1  ON 54
ci_0006                -3.744053e-02 3 1  ON 55
ci_0007                -2.530548e-02 3 1  ON 56
ci_0008                -2.148146e-02 3 1  ON 57
ci_0009                -1.699190e-02 3 1  ON 58
ci_0010                -1.767447e-02 3 1  ON 59
ci_0011                -1.193121e-02 3 1  ON 60
ci_0012                -1.202404e-02 3 1  ON 61
ci_0013                 1.368560e-02 3 1  ON 62
ci_0014                 1.305829e-02 3 1  ON 63
ci_0015                 1.304734e-02 3 1  ON 64
ci_0016                 1.272261e-02 3 1  ON 65
ci_0017                 1.136797e-02 3 1  ON 66
ci_0018                 1.085287e-02 3 1  ON 67
ci_0019                 1.145842e-02 3 1  ON 68
ci_0020                 1.104078e-02 3 1  ON 69
ci_0021                -1.288783e-03 3 1  ON 70
ci_0022                 3.182451e-06 3 1  ON 71
ci_0023                -1.136209e-02 3 1  ON 72
ci_0024                -1.170937e-02 3 1  ON 73
ci_0025                -1.054322e-02 3 1  ON 74
ci_0026                -1.069925e-02 3 1  ON 75
ci_0027                -1.138653e-02 3 1  ON 76
ci_0028                -1.132486e-02 3 1  ON 77
ci_0029                -1.080803e-02 3 1  ON 78
ci_0030                -1.083783e-02 3 1  ON 79
ci_0031                 1.999285e-02 3 1  ON 80
ci_0032                 2.047105e-02 3 1  ON 81
ci_0033                 9.812766e-03 3 1  ON 82
ci_0034                 9.808641e-03 3 1  ON 83
ci_0035                 6.884685e-03 3 1  ON 84
ci_0036                 7.404197e-03 3 1  ON 85
ci_0037                -1.089730e-02 3 1  ON 86
ci_0038                -1.078806e-02 3 1  ON 87
ci_0039                -2.849598e-03 3 1  ON 88
ci_0040                -2.990876e-03 3 1  ON 89
ci_0041                 7.188872e-03 3 1  ON 90
ci_0042                 7.353012e-03 3 1  ON 91
ci_0043                -1.829831e-02 3 1  ON 92
ci_0044                -1.857962e-02 3 1  ON 93
ci_0045                 8.159693e-03 3 1  ON 94
ci_0046                 7.103277e-03 3 1  ON 95
ci_0047                -1.685151e-03 3 1  ON 96
ci_0048                -2.213597e-03 3 1  ON 97
ci_0049                -6.346605e-03 3 1  ON 98
ci_0050                -5.495909e-03 3 1  ON 99
ci_0051                -3.516516e-03 3 1  ON 100
ci_0052                -3.532449e-03 3 1  ON 101
ci_0053                -5.068366e-03 3 1  ON 102
ci_0054                -4.218847e-03 3 1  ON 103
ci_0055                 6.205898e-03 3 1  ON 104
ci_0056                 6.494853e-03 3 1  ON 105
ci_0057                 4.949170e-03 3 1  ON 106
ci_0058                 6.275618e-03 3 1  ON 107
ci_0059                -4.597513e-03 3 1  ON 108
ci_0060                -5.308804e-03 3 1  ON 109
ci_0061                -3.294816e-03 3 1  ON 110
ci_0062                -2.780727e-03 3 1  ON 111
ci_0063                -9.744018e-03 3 1  ON 112
ci_0064                -8.548238e-03 3 1  ON 113
ci_0065                -5.395872e-03 3 1  ON 114
ci_0066                -5.331867e-03 3 1  ON 115
ci_0067                -5.481342e-03 3 1  ON 116
ci_0068                -4.818478e-03 3 1  ON 117
ci_0069                 4.412526e-03 3 1  ON 118
ci_0070                 4.406709e-03 3 1  ON 119
ci_0071                 8.527363e-04 3 1  ON 120
ci_0072                 6.092435e-04 3 1  ON 121
ci_0073                 4.034629e-03 3 1  ON 122
ci_0074                 4.095254e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9103e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6890e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9298
    reference variance = 0.255672
====================================================
  Execution time = 2.1442e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4260e-01
  Total weights = 1.951792635e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1899e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330206104508
                                         uncertainty =       0.009050103713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330206104508
                                         uncertainty =       0.009050103713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406299540
  error estimate for blocks of size 2^( 2) =       0.000418917512
  error estimate for blocks of size 2^( 3) =       0.000431852709
  error estimate for blocks of size 2^( 4) =       0.000443525571
  error estimate for blocks of size 2^( 5) =       0.000453639629
  error estimate for blocks of size 2^( 6) =       0.000460395669
  error estimate for blocks of size 2^( 7) =       0.000464252201

      target function =                  N/A
              le_mean =     -16.906094217631
             les_mean =     286.158619961939
             stat err =       0.000455453267
             autocorr =       1.256594004542
              std dev =       0.574594319258
             le_variance =       0.330158631723


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690609421763e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906094217632       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906104377298       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906104009898       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906103537048       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906104847101       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906105110149       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906105202467       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906104767901       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906104746204       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906105027051       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906105189649       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906105246501       residual = 5.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.7253e-01 is 1.524710e-03

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906094217632       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906097900370       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906097826797       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906097620699       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906098036756       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906098015266       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906098070259       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906098001916       residual = 8.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906097957999       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906097984928       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+00 is 5.500372e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906094217632       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906095255006       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906095239884       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906095189911       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906095280659       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906095282227       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906095302330       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906095286279       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906095275019       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906095277294       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+00 is 1.550004e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.395553 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7640e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
   uu_0                 3.116842e-01 1 1  ON 0
   uu_1                 1.443318e-01 1 1  ON 1
   uu_2                 4.281731e-02 1 1  ON 2
   uu_3                -1.917080e-02 1 1  ON 3
   uu_4                -6.419605e-02 1 1  ON 4
   uu_5                -9.851786e-02 1 1  ON 5
   uu_6                -1.253887e-01 1 1  ON 6
   uu_7                -1.381110e-01 1 1  ON 7
   uu_8                -1.300261e-01 1 1  ON 8
   uu_9                -9.838571e-02 1 1  ON 9
   ud_0                 4.443750e-01 1 1  ON 10
   ud_1                 1.786478e-01 1 1  ON 11
   ud_2                 5.884075e-02 1 1  ON 12
   ud_3                -1.145922e-02 1 1  ON 13
   ud_4                -6.734184e-02 1 1  ON 14
   ud_5                -1.076027e-01 1 1  ON 15
   ud_6                -1.336234e-01 1 1  ON 16
   ud_7                -1.491382e-01 1 1  ON 17
   ud_8                -1.496959e-01 1 1  ON 18
   ud_9                -1.373051e-01 1 1  ON 19
   eO_0                -7.447558e-01 1 1  ON 20
   eO_1                -4.260176e-01 1 1  ON 21
   eO_2                -1.766627e-02 1 1  ON 22
   eO_3                 2.902789e-01 1 1  ON 23
   eO_4                 5.101908e-01 1 1  ON 24
   eO_5                 4.686150e-01 1 1  ON 25
   eO_6                 2.423596e-01 1 1  ON 26
   eO_7                -5.147416e-02 1 1  ON 27
   eO_8                -2.068546e-01 1 1  ON 28
   eO_9                -6.651665e-02 1 1  ON 29
  eH1_0                -2.445145e-01 1 1  ON 30
  eH1_1                -1.383986e-01 1 1  ON 31
  eH1_2                -8.968613e-02 1 1  ON 32
  eH1_3                -3.529722e-02 1 1  ON 33
  eH1_4                 1.338071e-02 1 1  ON 34
  eH1_5                 4.679029e-02 1 1  ON 35
  eH1_6                 1.010005e-01 1 1  ON 36
  eH1_7                 1.469918e-01 1 1  ON 37
  eH1_8                 1.591312e-01 1 1  ON 38
  eH1_9                 4.491837e-02 1 1  ON 39
  eH2_0                -2.425278e-01 1 1  ON 40
  eH2_1                -1.365706e-01 1 1  ON 41
  eH2_2                -8.757290e-02 1 1  ON 42
  eH2_3                -3.283488e-02 1 1  ON 43
  eH2_4                 1.611567e-02 1 1  ON 44
  eH2_5                 5.001409e-02 1 1  ON 45
  eH2_6                 1.048535e-01 1 1  ON 46
  eH2_7                 1.516564e-01 1 1  ON 47
  eH2_8                 1.656354e-01 1 1  ON 48
  eH2_9                 2.900801e-02 1 1  ON 49
ci_0001                 7.012803e-01 3 1  ON 50
ci_0002                 7.002481e-01 3 1  ON 51
ci_0003                -2.719114e-02 3 1  ON 52
ci_0004                -2.825135e-02 3 1  ON 53
ci_0005                -3.656356e-02 3 1  ON 54
ci_0006                -3.725059e-02 3 1  ON 55
ci_0007                -2.516220e-02 3 1  ON 56
ci_0008                -2.141074e-02 3 1  ON 57
ci_0009                -1.721039e-02 3 1  ON 58
ci_0010                -1.768859e-02 3 1  ON 59
ci_0011                -1.183047e-02 3 1  ON 60
ci_0012                -1.200677e-02 3 1  ON 61
ci_0013                 1.366573e-02 3 1  ON 62
ci_0014                 1.306089e-02 3 1  ON 63
ci_0015                 1.308844e-02 3 1  ON 64
ci_0016                 1.278291e-02 3 1  ON 65
ci_0017                 1.139440e-02 3 1  ON 66
ci_0018                 1.087256e-02 3 1  ON 67
ci_0019                 1.152189e-02 3 1  ON 68
ci_0020                 1.094901e-02 3 1  ON 69
ci_0021                -1.318509e-03 3 1  ON 70
ci_0022                 1.779639e-05 3 1  ON 71
ci_0023                -1.131409e-02 3 1  ON 72
ci_0024                -1.161469e-02 3 1  ON 73
ci_0025                -1.045748e-02 3 1  ON 74
ci_0026                -1.073856e-02 3 1  ON 75
ci_0027                -1.131729e-02 3 1  ON 76
ci_0028                -1.136869e-02 3 1  ON 77
ci_0029                -1.064742e-02 3 1  ON 78
ci_0030                -1.077750e-02 3 1  ON 79
ci_0031                 1.985340e-02 3 1  ON 80
ci_0032                 2.044081e-02 3 1  ON 81
ci_0033                 9.728714e-03 3 1  ON 82
ci_0034                 9.613177e-03 3 1  ON 83
ci_0035                 6.742855e-03 3 1  ON 84
ci_0036                 7.350270e-03 3 1  ON 85
ci_0037                -1.099141e-02 3 1  ON 86
ci_0038                -1.070105e-02 3 1  ON 87
ci_0039                -2.814092e-03 3 1  ON 88
ci_0040                -2.883378e-03 3 1  ON 89
ci_0041                 7.087646e-03 3 1  ON 90
ci_0042                 7.261019e-03 3 1  ON 91
ci_0043                -1.830543e-02 3 1  ON 92
ci_0044                -1.859990e-02 3 1  ON 93
ci_0045                 8.090478e-03 3 1  ON 94
ci_0046                 7.106813e-03 3 1  ON 95
ci_0047                -1.630181e-03 3 1  ON 96
ci_0048                -2.070842e-03 3 1  ON 97
ci_0049                -5.796568e-03 3 1  ON 98
ci_0050                -5.597931e-03 3 1  ON 99
ci_0051                -3.480826e-03 3 1  ON 100
ci_0052                -3.586354e-03 3 1  ON 101
ci_0053                -4.754243e-03 3 1  ON 102
ci_0054                -4.374312e-03 3 1  ON 103
ci_0055                 6.285601e-03 3 1  ON 104
ci_0056                 6.746095e-03 3 1  ON 105
ci_0057                 4.814496e-03 3 1  ON 106
ci_0058                 5.969470e-03 3 1  ON 107
ci_0059                -4.712189e-03 3 1  ON 108
ci_0060                -5.211273e-03 3 1  ON 109
ci_0061                -3.339548e-03 3 1  ON 110
ci_0062                -2.670340e-03 3 1  ON 111
ci_0063                -9.594462e-03 3 1  ON 112
ci_0064                -8.564286e-03 3 1  ON 113
ci_0065                -5.272010e-03 3 1  ON 114
ci_0066                -5.301402e-03 3 1  ON 115
ci_0067                -5.477258e-03 3 1  ON 116
ci_0068                -4.787722e-03 3 1  ON 117
ci_0069                 4.151820e-03 3 1  ON 118
ci_0070                 4.464012e-03 3 1  ON 119
ci_0071                 1.076667e-03 3 1  ON 120
ci_0072                 5.484965e-04 3 1  ON 121
ci_0073                 4.044552e-03 3 1  ON 122
ci_0074                 4.114345e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9842
    reference variance = 0.315474
====================================================
  Execution time = 2.1207e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3959e-01
  Total weights = 1.9516e+06
  Execution time = 1.9161e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326304294009
                                         uncertainty =       0.003306966289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326304294009
                                         uncertainty =       0.003306966289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403892712
  error estimate for blocks of size 2^( 2) =       0.000416480441
  error estimate for blocks of size 2^( 3) =       0.000429792184
  error estimate for blocks of size 2^( 4) =       0.000441656628
  error estimate for blocks of size 2^( 5) =       0.000451655058
  error estimate for blocks of size 2^( 6) =       0.000458987111
  error estimate for blocks of size 2^( 7) =       0.000464893606

      target function =                  N/A
              le_mean =     -16.906460407186
             les_mean =     286.167911653989
             stat err =       0.000454298101
             autocorr =       1.265172688486
              std dev =       0.571190551349
             le_variance =       0.326258645950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326522976553
                                         uncertainty =       0.003442988380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326522976553
                                         uncertainty =       0.003442988380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404027816
  error estimate for blocks of size 2^( 2) =       0.000416630083
  error estimate for blocks of size 2^( 3) =       0.000429940796
  error estimate for blocks of size 2^( 4) =       0.000441805739
  error estimate for blocks of size 2^( 5) =       0.000451836344
  error estimate for blocks of size 2^( 6) =       0.000459203595
  error estimate for blocks of size 2^( 7) =       0.000465123875

      target function =                  N/A
              le_mean =     -16.906464314427
             les_mean =     286.172332229936
             stat err =       0.000454492388
             autocorr =       1.265408352834
              std dev =       0.571381616644
             le_variance =       0.326476951838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326524213332
                                         uncertainty =       0.003473674483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326524213332
                                         uncertainty =       0.003473674483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404028496
  error estimate for blocks of size 2^( 2) =       0.000416626858
  error estimate for blocks of size 2^( 3) =       0.000429937217
  error estimate for blocks of size 2^( 4) =       0.000441796201
  error estimate for blocks of size 2^( 5) =       0.000451821001
  error estimate for blocks of size 2^( 6) =       0.000459183856
  error estimate for blocks of size 2^( 7) =       0.000465096554

      target function =                  N/A
              le_mean =     -16.906459193999
             les_mean =     286.168514576716
             stat err =       0.000454474403
             autocorr =       1.265303942797
              std dev =       0.571382579309
             le_variance =       0.326478051938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326320023093
                                         uncertainty =       0.003328418041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326320023093
                                         uncertainty =       0.003328418041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403902405
  error estimate for blocks of size 2^( 2) =       0.000416491814
  error estimate for blocks of size 2^( 3) =       0.000429803845
  error estimate for blocks of size 2^( 4) =       0.000441667467
  error estimate for blocks of size 2^( 5) =       0.000451670340
  error estimate for blocks of size 2^( 6) =       0.000459007088
  error estimate for blocks of size 2^( 7) =       0.000464914665

      target function =                  N/A
              le_mean =     -16.906458617595
             les_mean =     286.167904207288
             stat err =       0.000454314890
             autocorr =       1.265205475745
              std dev =       0.571204259594
             le_variance =       0.326274306178


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906460407186        initial
     3.7253e-01     3.7253e+00             1.5247e-03       -16.906464314427  <--
     1.4901e+00     1.4901e+01             5.5004e-04       -16.906459193999
     5.9605e+00     5.9605e+01             1.5500e-04       -16.906458617595

*****************************************************************************
Applying the update for shift_i =   3.7253e-01     and shift_s =   3.7253e+00
*****************************************************************************

  Execution time = 3.0803e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
   uu_0                 3.118069e-01 1 1  ON 0
   uu_1                 1.443720e-01 1 1  ON 1
   uu_2                 4.277879e-02 1 1  ON 2
   uu_3                -1.913955e-02 1 1  ON 3
   uu_4                -6.418585e-02 1 1  ON 4
   uu_5                -9.842599e-02 1 1  ON 5
   uu_6                -1.252828e-01 1 1  ON 6
   uu_7                -1.381585e-01 1 1  ON 7
   uu_8                -1.301111e-01 1 1  ON 8
   uu_9                -9.878051e-02 1 1  ON 9
   ud_0                 4.446626e-01 1 1  ON 10
   ud_1                 1.789403e-01 1 1  ON 11
   ud_2                 5.912856e-02 1 1  ON 12
   ud_3                -1.125568e-02 1 1  ON 13
   ud_4                -6.729834e-02 1 1  ON 14
   ud_5                -1.075236e-01 1 1  ON 15
   ud_6                -1.336503e-01 1 1  ON 16
   ud_7                -1.492824e-01 1 1  ON 17
   ud_8                -1.499906e-01 1 1  ON 18
   ud_9                -1.377391e-01 1 1  ON 19
   eO_0                -7.450354e-01 1 1  ON 20
   eO_1                -4.263348e-01 1 1  ON 21
   eO_2                -1.768333e-02 1 1  ON 22
   eO_3                 2.904023e-01 1 1  ON 23
   eO_4                 5.105860e-01 1 1  ON 24
   eO_5                 4.690492e-01 1 1  ON 25
   eO_6                 2.426974e-01 1 1  ON 26
   eO_7                -5.134397e-02 1 1  ON 27
   eO_8                -2.072407e-01 1 1  ON 28
   eO_9                -6.688152e-02 1 1  ON 29
  eH1_0                -2.447674e-01 1 1  ON 30
  eH1_1                -1.386997e-01 1 1  ON 31
  eH1_2                -8.994919e-02 1 1  ON 32
  eH1_3                -3.545919e-02 1 1  ON 33
  eH1_4                 1.326099e-02 1 1  ON 34
  eH1_5                 4.678168e-02 1 1  ON 35
  eH1_6                 1.011217e-01 1 1  ON 36
  eH1_7                 1.471948e-01 1 1  ON 37
  eH1_8                 1.596206e-01 1 1  ON 38
  eH1_9                 4.528878e-02 1 1  ON 39
  eH2_0                -2.427938e-01 1 1  ON 40
  eH2_1                -1.366097e-01 1 1  ON 41
  eH2_2                -8.778222e-02 1 1  ON 42
  eH2_3                -3.295193e-02 1 1  ON 43
  eH2_4                 1.614788e-02 1 1  ON 44
  eH2_5                 5.012962e-02 1 1  ON 45
  eH2_6                 1.047335e-01 1 1  ON 46
  eH2_7                 1.516221e-01 1 1  ON 47
  eH2_8                 1.658879e-01 1 1  ON 48
  eH2_9                 2.942306e-02 1 1  ON 49
ci_0001                 7.013732e-01 3 1  ON 50
ci_0002                 7.002528e-01 3 1  ON 51
ci_0003                -2.726982e-02 3 1  ON 52
ci_0004                -2.788930e-02 3 1  ON 53
ci_0005                -3.657368e-02 3 1  ON 54
ci_0006                -3.683114e-02 3 1  ON 55
ci_0007                -2.480981e-02 3 1  ON 56
ci_0008                -2.124832e-02 3 1  ON 57
ci_0009                -1.759187e-02 3 1  ON 58
ci_0010                -1.771419e-02 3 1  ON 59
ci_0011                -1.164683e-02 3 1  ON 60
ci_0012                -1.198496e-02 3 1  ON 61
ci_0013                 1.362574e-02 3 1  ON 62
ci_0014                 1.306871e-02 3 1  ON 63
ci_0015                 1.315563e-02 3 1  ON 64
ci_0016                 1.289940e-02 3 1  ON 65
ci_0017                 1.145022e-02 3 1  ON 66
ci_0018                 1.090826e-02 3 1  ON 67
ci_0019                 1.165015e-02 3 1  ON 68
ci_0020                 1.077307e-02 3 1  ON 69
ci_0021                -1.379723e-03 3 1  ON 70
ci_0022                 4.170353e-05 3 1  ON 71
ci_0023                -1.122780e-02 3 1  ON 72
ci_0024                -1.143397e-02 3 1  ON 73
ci_0025                -1.029284e-02 3 1  ON 74
ci_0026                -1.076953e-02 3 1  ON 75
ci_0027                -1.119344e-02 3 1  ON 76
ci_0028                -1.144441e-02 3 1  ON 77
ci_0029                -1.034921e-02 3 1  ON 78
ci_0030                -1.066408e-02 3 1  ON 79
ci_0031                 1.954721e-02 3 1  ON 80
ci_0032                 2.039315e-02 3 1  ON 81
ci_0033                 9.547843e-03 3 1  ON 82
ci_0034                 9.186796e-03 3 1  ON 83
ci_0035                 6.530474e-03 3 1  ON 84
ci_0036                 7.246702e-03 3 1  ON 85
ci_0037                -1.119778e-02 3 1  ON 86
ci_0038                -1.051092e-02 3 1  ON 87
ci_0039                -2.773612e-03 3 1  ON 88
ci_0040                -2.715513e-03 3 1  ON 89
ci_0041                 6.899875e-03 3 1  ON 90
ci_0042                 7.090652e-03 3 1  ON 91
ci_0043                -1.834949e-02 3 1  ON 92
ci_0044                -1.868142e-02 3 1  ON 93
ci_0045                 7.938409e-03 3 1  ON 94
ci_0046                 7.112457e-03 3 1  ON 95
ci_0047                -1.548063e-03 3 1  ON 96
ci_0048                -1.852268e-03 3 1  ON 97
ci_0049                -4.821895e-03 3 1  ON 98
ci_0050                -5.791831e-03 3 1  ON 99
ci_0051                -3.416772e-03 3 1  ON 100
ci_0052                -3.675474e-03 3 1  ON 101
ci_0053                -4.270389e-03 3 1  ON 102
ci_0054                -4.629448e-03 3 1  ON 103
ci_0055                 6.449539e-03 3 1  ON 104
ci_0056                 7.235844e-03 3 1  ON 105
ci_0057                 4.547275e-03 3 1  ON 106
ci_0058                 5.391317e-03 3 1  ON 107
ci_0059                -4.904289e-03 3 1  ON 108
ci_0060                -5.048944e-03 3 1  ON 109
ci_0061                -3.431855e-03 3 1  ON 110
ci_0062                -2.463152e-03 3 1  ON 111
ci_0063                -9.333574e-03 3 1  ON 112
ci_0064                -8.597417e-03 3 1  ON 113
ci_0065                -5.051858e-03 3 1  ON 114
ci_0066                -5.245801e-03 3 1  ON 115
ci_0067                -5.462025e-03 3 1  ON 116
ci_0068                -4.736410e-03 3 1  ON 117
ci_0069                 3.787892e-03 3 1  ON 118
ci_0070                 4.551311e-03 3 1  ON 119
ci_0071                 1.425100e-03 3 1  ON 120
ci_0072                 4.360815e-04 3 1  ON 121
ci_0073                 4.066470e-03 3 1  ON 122
ci_0074                 4.144037e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8450e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6892e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8864
    reference variance = 0.304685
====================================================
  Execution time = 2.1397e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3616e-01
  Total weights = 1.951487093e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0695e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323118886702
                                         uncertainty =       0.001975813059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323118886702
                                         uncertainty =       0.001975813059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401951603
  error estimate for blocks of size 2^( 2) =       0.000414452864
  error estimate for blocks of size 2^( 3) =       0.000427535475
  error estimate for blocks of size 2^( 4) =       0.000440785822
  error estimate for blocks of size 2^( 5) =       0.000451922878
  error estimate for blocks of size 2^( 6) =       0.000459994178
  error estimate for blocks of size 2^( 7) =       0.000465993700

      target function =                  N/A
              le_mean =     -16.905757856201
             les_mean =     286.140806047577
             stat err =       0.000454674144
             autocorr =       1.279537403467
              std dev =       0.568445408599
             le_variance =       0.323130182558


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690575785620e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905757856190       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905773960366       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905778346050       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905778498820       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905781729254       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905781306133       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905784418753       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905783960575       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905782801957       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905783046377       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905783054477       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905782552814       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905782917240       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905783231735       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905783373342       residual = 7.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.3132e-02 is 2.567510e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905757856190       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905766278755       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905767904580       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905767805387       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905769024912       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905768903229       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905769763368       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905769854183       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905769766495       residual = 6.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905769389299       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905769145958       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.7253e-01 is 6.491770e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905757856190       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905760752549       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905761241361       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905761137035       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905761436114       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905761416983       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905761649748       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905761751170       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905761794423       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905761670035       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+00 is 2.038948e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.401143 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7477e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
   uu_0                 3.120396e-01 1 1  ON 0
   uu_1                 1.445343e-01 1 1  ON 1
   uu_2                 4.286290e-02 1 1  ON 2
   uu_3                -1.935905e-02 1 1  ON 3
   uu_4                -6.436806e-02 1 1  ON 4
   uu_5                -9.852206e-02 1 1  ON 5
   uu_6                -1.253478e-01 1 1  ON 6
   uu_7                -1.384015e-01 1 1  ON 7
   uu_8                -1.303327e-01 1 1  ON 8
   uu_9                -9.900669e-02 1 1  ON 9
   ud_0                 4.445659e-01 1 1  ON 10
   ud_1                 1.788319e-01 1 1  ON 11
   ud_2                 5.913833e-02 1 1  ON 12
   ud_3                -1.110599e-02 1 1  ON 13
   ud_4                -6.726976e-02 1 1  ON 14
   ud_5                -1.075881e-01 1 1  ON 15
   ud_6                -1.337947e-01 1 1  ON 16
   ud_7                -1.493659e-01 1 1  ON 17
   ud_8                -1.498301e-01 1 1  ON 18
   ud_9                -1.375957e-01 1 1  ON 19
   eO_0                -7.454385e-01 1 1  ON 20
   eO_1                -4.261417e-01 1 1  ON 21
   eO_2                -1.785300e-02 1 1  ON 22
   eO_3                 2.905183e-01 1 1  ON 23
   eO_4                 5.106407e-01 1 1  ON 24
   eO_5                 4.693701e-01 1 1  ON 25
   eO_6                 2.430160e-01 1 1  ON 26
   eO_7                -5.116117e-02 1 1  ON 27
   eO_8                -2.075108e-01 1 1  ON 28
   eO_9                -6.718102e-02 1 1  ON 29
  eH1_0                -2.453198e-01 1 1  ON 30
  eH1_1                -1.390367e-01 1 1  ON 31
  eH1_2                -9.018776e-02 1 1  ON 32
  eH1_3                -3.565974e-02 1 1  ON 33
  eH1_4                 1.318566e-02 1 1  ON 34
  eH1_5                 4.669109e-02 1 1  ON 35
  eH1_6                 1.010659e-01 1 1  ON 36
  eH1_7                 1.476427e-01 1 1  ON 37
  eH1_8                 1.600985e-01 1 1  ON 38
  eH1_9                 4.580615e-02 1 1  ON 39
  eH2_0                -2.434430e-01 1 1  ON 40
  eH2_1                -1.368329e-01 1 1  ON 41
  eH2_2                -8.793275e-02 1 1  ON 42
  eH2_3                -3.316266e-02 1 1  ON 43
  eH2_4                 1.585460e-02 1 1  ON 44
  eH2_5                 5.015932e-02 1 1  ON 45
  eH2_6                 1.046516e-01 1 1  ON 46
  eH2_7                 1.519576e-01 1 1  ON 47
  eH2_8                 1.664764e-01 1 1  ON 48
  eH2_9                 3.006140e-02 1 1  ON 49
ci_0001                 7.012079e-01 3 1  ON 50
ci_0002                 7.004407e-01 3 1  ON 51
ci_0003                -2.737097e-02 3 1  ON 52
ci_0004                -2.763552e-02 3 1  ON 53
ci_0005                -3.662563e-02 3 1  ON 54
ci_0006                -3.657834e-02 3 1  ON 55
ci_0007                -2.425924e-02 3 1  ON 56
ci_0008                -2.112029e-02 3 1  ON 57
ci_0009                -1.781652e-02 3 1  ON 58
ci_0010                -1.759361e-02 3 1  ON 59
ci_0011                -1.171689e-02 3 1  ON 60
ci_0012                -1.237914e-02 3 1  ON 61
ci_0013                 1.371557e-02 3 1  ON 62
ci_0014                 1.319540e-02 3 1  ON 63
ci_0015                 1.320185e-02 3 1  ON 64
ci_0016                 1.292443e-02 3 1  ON 65
ci_0017                 1.152096e-02 3 1  ON 66
ci_0018                 1.109079e-02 3 1  ON 67
ci_0019                 1.162595e-02 3 1  ON 68
ci_0020                 1.099443e-02 3 1  ON 69
ci_0021                -1.302818e-03 3 1  ON 70
ci_0022                -4.794560e-04 3 1  ON 71
ci_0023                -1.128360e-02 3 1  ON 72
ci_0024                -1.117008e-02 3 1  ON 73
ci_0025                -1.019267e-02 3 1  ON 74
ci_0026                -1.090390e-02 3 1  ON 75
ci_0027                -1.091554e-02 3 1  ON 76
ci_0028                -1.095590e-02 3 1  ON 77
ci_0029                -1.042091e-02 3 1  ON 78
ci_0030                -1.006554e-02 3 1  ON 79
ci_0031                 1.986257e-02 3 1  ON 80
ci_0032                 2.012921e-02 3 1  ON 81
ci_0033                 9.783567e-03 3 1  ON 82
ci_0034                 9.630924e-03 3 1  ON 83
ci_0035                 6.808518e-03 3 1  ON 84
ci_0036                 6.945219e-03 3 1  ON 85
ci_0037                -1.077667e-02 3 1  ON 86
ci_0038                -1.053008e-02 3 1  ON 87
ci_0039                -2.664848e-03 3 1  ON 88
ci_0040                -2.711601e-03 3 1  ON 89
ci_0041                 7.014074e-03 3 1  ON 90
ci_0042                 6.864156e-03 3 1  ON 91
ci_0043                -1.858057e-02 3 1  ON 92
ci_0044                -1.893501e-02 3 1  ON 93
ci_0045                 7.742782e-03 3 1  ON 94
ci_0046                 7.175428e-03 3 1  ON 95
ci_0047                -1.811809e-03 3 1  ON 96
ci_0048                -1.600132e-03 3 1  ON 97
ci_0049                -5.190104e-03 3 1  ON 98
ci_0050                -5.892493e-03 3 1  ON 99
ci_0051                -3.290269e-03 3 1  ON 100
ci_0052                -3.659513e-03 3 1  ON 101
ci_0053                -4.404769e-03 3 1  ON 102
ci_0054                -4.915069e-03 3 1  ON 103
ci_0055                 6.275177e-03 3 1  ON 104
ci_0056                 6.932369e-03 3 1  ON 105
ci_0057                 4.698677e-03 3 1  ON 106
ci_0058                 5.509144e-03 3 1  ON 107
ci_0059                -4.994334e-03 3 1  ON 108
ci_0060                -4.815044e-03 3 1  ON 109
ci_0061                -3.115387e-03 3 1  ON 110
ci_0062                -2.953193e-03 3 1  ON 111
ci_0063                -9.284640e-03 3 1  ON 112
ci_0064                -8.766388e-03 3 1  ON 113
ci_0065                -5.439363e-03 3 1  ON 114
ci_0066                -5.159684e-03 3 1  ON 115
ci_0067                -5.468653e-03 3 1  ON 116
ci_0068                -5.144905e-03 3 1  ON 117
ci_0069                 4.004550e-03 3 1  ON 118
ci_0070                 4.447963e-03 3 1  ON 119
ci_0071                 8.678026e-04 3 1  ON 120
ci_0072                 3.210373e-04 3 1  ON 121
ci_0073                 4.104102e-03 3 1  ON 122
ci_0074                 3.814608e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8887
    reference variance = 0.19593
====================================================
  Execution time = 2.1377e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3561e-01
  Total weights = 1.9518e+06
  Execution time = 1.8931e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00591401
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322680084509
                                         uncertainty =       0.001971530628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322680084509
                                         uncertainty =       0.001971530628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401613776
  error estimate for blocks of size 2^( 2) =       0.000414808431
  error estimate for blocks of size 2^( 3) =       0.000428155649
  error estimate for blocks of size 2^( 4) =       0.000440600511
  error estimate for blocks of size 2^( 5) =       0.000452682253
  error estimate for blocks of size 2^( 6) =       0.000461976605
  error estimate for blocks of size 2^( 7) =       0.000469874108

      target function =                  N/A
              le_mean =     -16.906175416348
             les_mean =     286.169902202977
             stat err =       0.000456283369
             autocorr =       1.290779552574
              std dev =       0.567967648781
             le_variance =       0.322587250062

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0186988
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322783944176
                                         uncertainty =       0.001983357030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322783944176
                                         uncertainty =       0.001983357030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401678586
  error estimate for blocks of size 2^( 2) =       0.000414880405
  error estimate for blocks of size 2^( 3) =       0.000428203543
  error estimate for blocks of size 2^( 4) =       0.000440648792
  error estimate for blocks of size 2^( 5) =       0.000452719132
  error estimate for blocks of size 2^( 6) =       0.000461998447
  error estimate for blocks of size 2^( 7) =       0.000469847719

      target function =                  N/A
              le_mean =     -16.906161299357
             les_mean =     286.155124602415
             stat err =       0.000456303523
             autocorr =       1.290477043040
              std dev =       0.568059304622
             le_variance =       0.322691373567

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00584562
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322804628142
                                         uncertainty =       0.001984044280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322804628142
                                         uncertainty =       0.001984044280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401691396
  error estimate for blocks of size 2^( 2) =       0.000414890360
  error estimate for blocks of size 2^( 3) =       0.000428211758
  error estimate for blocks of size 2^( 4) =       0.000440655942
  error estimate for blocks of size 2^( 5) =       0.000452727448
  error estimate for blocks of size 2^( 6) =       0.000462005637
  error estimate for blocks of size 2^( 7) =       0.000469863288

      target function =                  N/A
              le_mean =     -16.906163254595
             les_mean =     286.154505804192
             stat err =       0.000456313079
             autocorr =       1.290448790801
              std dev =       0.568077419624
             le_variance =       0.322711954687

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0332188
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322864956537
                                         uncertainty =       0.001969094578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322864956537
                                         uncertainty =       0.001969094578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401728894
  error estimate for blocks of size 2^( 2) =       0.000414926430
  error estimate for blocks of size 2^( 3) =       0.000428278857
  error estimate for blocks of size 2^( 4) =       0.000440710506
  error estimate for blocks of size 2^( 5) =       0.000452809411
  error estimate for blocks of size 2^( 6) =       0.000462068562
  error estimate for blocks of size 2^( 7) =       0.000469941489

      target function =                  N/A
              le_mean =     -16.906178229010
             les_mean =     286.625739437435
             stat err =       0.000456382492
             autocorr =       1.290600454527
              std dev =       0.568130449603
             le_variance =       0.322772207766


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906175416348        initial
     9.3132e-02     9.3132e-01             2.5675e-03       -16.906161299357
     3.7253e-01     3.7253e+00             6.4918e-04       -16.906163254595
     1.4901e+00     1.4901e+01             2.0389e-04       -16.906178229010  <--

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 3.3575e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
   uu_0                 3.118553e-01 1 1  ON 0
   uu_1                 1.444226e-01 1 1  ON 1
   uu_2                 4.281744e-02 1 1  ON 2
   uu_3                -1.922273e-02 1 1  ON 3
   uu_4                -6.423554e-02 1 1  ON 4
   uu_5                -9.844268e-02 1 1  ON 5
   uu_6                -1.252900e-01 1 1  ON 6
   uu_7                -1.382213e-01 1 1  ON 7
   uu_8                -1.301664e-01 1 1  ON 8
   uu_9                -9.883704e-02 1 1  ON 9
   ud_0                 4.446242e-01 1 1  ON 10
   ud_1                 1.788974e-01 1 1  ON 11
   ud_2                 5.912870e-02 1 1  ON 12
   ud_3                -1.119173e-02 1 1  ON 13
   ud_4                -6.729245e-02 1 1  ON 14
   ud_5                -1.075375e-01 1 1  ON 15
   ud_6                -1.336908e-01 1 1  ON 16
   ud_7                -1.492998e-01 1 1  ON 17
   ud_8                -1.499448e-01 1 1  ON 18
   ud_9                -1.377026e-01 1 1  ON 19
   eO_0                -7.451695e-01 1 1  ON 20
   eO_1                -4.262440e-01 1 1  ON 21
   eO_2                -1.774784e-02 1 1  ON 22
   eO_3                 2.904430e-01 1 1  ON 23
   eO_4                 5.105974e-01 1 1  ON 24
   eO_5                 4.691308e-01 1 1  ON 25
   eO_6                 2.427784e-01 1 1  ON 26
   eO_7                -5.129751e-02 1 1  ON 27
   eO_8                -2.073080e-01 1 1  ON 28
   eO_9                -6.695645e-02 1 1  ON 29
  eH1_0                -2.449095e-01 1 1  ON 30
  eH1_1                -1.387860e-01 1 1  ON 31
  eH1_2                -9.000978e-02 1 1  ON 32
  eH1_3                -3.550910e-02 1 1  ON 33
  eH1_4                 1.324848e-02 1 1  ON 34
  eH1_5                 4.675889e-02 1 1  ON 35
  eH1_6                 1.011057e-01 1 1  ON 36
  eH1_7                 1.473089e-01 1 1  ON 37
  eH1_8                 1.597407e-01 1 1  ON 38
  eH1_9                 4.541819e-02 1 1  ON 39
  eH2_0                -2.429672e-01 1 1  ON 40
  eH2_1                -1.366602e-01 1 1  ON 41
  eH2_2                -8.781437e-02 1 1  ON 42
  eH2_3                -3.300539e-02 1 1  ON 43
  eH2_4                 1.606962e-02 1 1  ON 44
  eH2_5                 5.014547e-02 1 1  ON 45
  eH2_6                 1.047101e-01 1 1  ON 46
  eH2_7                 1.517061e-01 1 1  ON 47
  eH2_8                 1.660354e-01 1 1  ON 48
  eH2_9                 2.958271e-02 1 1  ON 49
ci_0001                 7.013277e-01 3 1  ON 50
ci_0002                 7.003041e-01 3 1  ON 51
ci_0003                -2.730391e-02 3 1  ON 52
ci_0004                -2.780639e-02 3 1  ON 53
ci_0005                -3.659098e-02 3 1  ON 54
ci_0006                -3.675697e-02 3 1  ON 55
ci_0007                -2.465062e-02 3 1  ON 56
ci_0008                -2.121235e-02 3 1  ON 57
ci_0009                -1.767233e-02 3 1  ON 58
ci_0010                -1.766930e-02 3 1  ON 59
ci_0011                -1.167313e-02 3 1  ON 60
ci_0012                -1.211784e-02 3 1  ON 61
ci_0013                 1.365762e-02 3 1  ON 62
ci_0014                 1.310702e-02 3 1  ON 63
ci_0015                 1.317212e-02 3 1  ON 64
ci_0016                 1.290486e-02 3 1  ON 65
ci_0017                 1.147724e-02 3 1  ON 66
ci_0018                 1.097183e-02 3 1  ON 67
ci_0019                 1.164443e-02 3 1  ON 68
ci_0020                 1.084939e-02 3 1  ON 69
ci_0021                -1.354157e-03 3 1  ON 70
ci_0022                -1.081242e-04 3 1  ON 71
ci_0023                -1.124981e-02 3 1  ON 72
ci_0024                -1.134218e-02 3 1  ON 73
ci_0025                -1.025764e-02 3 1  ON 74
ci_0026                -1.081610e-02 3 1  ON 75
ci_0027                -1.110135e-02 3 1  ON 76
ci_0028                -1.127663e-02 3 1  ON 77
ci_0029                -1.037717e-02 3 1  ON 78
ci_0030                -1.046018e-02 3 1  ON 79
ci_0031                 1.964378e-02 3 1  ON 80
ci_0032                 2.031719e-02 3 1  ON 81
ci_0033                 9.620980e-03 3 1  ON 82
ci_0034                 9.320766e-03 3 1  ON 83
ci_0035                 6.626282e-03 3 1  ON 84
ci_0036                 7.148511e-03 3 1  ON 85
ci_0037                -1.106202e-02 3 1  ON 86
ci_0038                -1.051854e-02 3 1  ON 87
ci_0039                -2.730405e-03 3 1  ON 88
ci_0040                -2.712539e-03 3 1  ON 89
ci_0041                 6.940214e-03 3 1  ON 90
ci_0042                 7.014876e-03 3 1  ON 91
ci_0043                -1.841872e-02 3 1  ON 92
ci_0044                -1.875667e-02 3 1  ON 93
ci_0045                 7.877942e-03 3 1  ON 94
ci_0046                 7.130257e-03 3 1  ON 95
ci_0047                -1.651410e-03 3 1  ON 96
ci_0048                -1.753974e-03 3 1  ON 97
ci_0049                -4.949900e-03 3 1  ON 98
ci_0050                -5.826019e-03 3 1  ON 99
ci_0051                -3.368996e-03 3 1  ON 100
ci_0052                -3.668782e-03 3 1  ON 101
ci_0053                -4.324465e-03 3 1  ON 102
ci_0054                -4.737511e-03 3 1  ON 103
ci_0055                 6.392954e-03 3 1  ON 104
ci_0056                 7.139959e-03 3 1  ON 105
ci_0057                 4.597123e-03 3 1  ON 106
ci_0058                 5.429923e-03 3 1  ON 107
ci_0059                -4.937325e-03 3 1  ON 108
ci_0060                -4.959962e-03 3 1  ON 109
ci_0061                -3.327991e-03 3 1  ON 110
ci_0062                -2.629398e-03 3 1  ON 111
ci_0063                -9.315565e-03 3 1  ON 112
ci_0064                -8.659815e-03 3 1  ON 113
ci_0065                -5.190144e-03 3 1  ON 114
ci_0066                -5.214807e-03 3 1  ON 115
ci_0067                -5.467632e-03 3 1  ON 116
ci_0068                -4.894541e-03 3 1  ON 117
ci_0069                 3.873865e-03 3 1  ON 118
ci_0070                 4.511607e-03 3 1  ON 119
ci_0071                 1.236381e-03 3 1  ON 120
ci_0072                 3.959461e-04 3 1  ON 121
ci_0073                 4.080275e-03 3 1  ON 122
ci_0074                 4.014546e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.1067e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6892e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.819
    reference variance = 0.432694
====================================================
  Execution time = 2.1422e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5248e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3646e-01
  Total weights = 1.951576722e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0224e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321031767241
                                         uncertainty =       0.001991698065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321031767241
                                         uncertainty =       0.001991698065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400655463
  error estimate for blocks of size 2^( 2) =       0.000413608786
  error estimate for blocks of size 2^( 3) =       0.000427458427
  error estimate for blocks of size 2^( 4) =       0.000440401847
  error estimate for blocks of size 2^( 5) =       0.000451685492
  error estimate for blocks of size 2^( 6) =       0.000460070828
  error estimate for blocks of size 2^( 7) =       0.000465243246

      target function =                  N/A
              le_mean =     -16.905726200078
             les_mean =     286.140042510601
             stat err =       0.000454350353
             autocorr =       1.285995957585
              std dev =       0.566612389026
             le_variance =       0.321049599398


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690572620008e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905726200054       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905726697928       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905726763512       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905727604045       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905727354743       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905728768171       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905729458636       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905729624105       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905729526003       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905729264585       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905729013064       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.7253e-01 is 6.421228e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905726200054       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905726372106       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905726444815       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905726710915       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905726630976       residual = 9.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905727079293       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905727233857       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905727376005       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905727318230       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905727238933       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+00 is 1.979712e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905726200054       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905726247613       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905726272212       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905726326174       residual = 9.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905726318683       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905726430423       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905726482792       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905726525471       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905726512589       residual = 8.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+00 is 5.735077e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.410026 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7461e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
   uu_0                 3.118228e-01 1 1  ON 0
   uu_1                 1.444748e-01 1 1  ON 1
   uu_2                 4.281744e-02 1 1  ON 2
   uu_3                -1.927408e-02 1 1  ON 3
   uu_4                -6.425570e-02 1 1  ON 4
   uu_5                -9.849690e-02 1 1  ON 5
   uu_6                -1.253071e-01 1 1  ON 6
   uu_7                -1.382284e-01 1 1  ON 7
   uu_8                -1.301830e-01 1 1  ON 8
   uu_9                -9.885048e-02 1 1  ON 9
   ud_0                 4.445658e-01 1 1  ON 10
   ud_1                 1.789151e-01 1 1  ON 11
   ud_2                 5.915618e-02 1 1  ON 12
   ud_3                -1.118136e-02 1 1  ON 13
   ud_4                -6.723161e-02 1 1  ON 14
   ud_5                -1.075462e-01 1 1  ON 15
   ud_6                -1.337369e-01 1 1  ON 16
   ud_7                -1.492590e-01 1 1  ON 17
   ud_8                -1.499205e-01 1 1  ON 18
   ud_9                -1.377562e-01 1 1  ON 19
   eO_0                -7.452492e-01 1 1  ON 20
   eO_1                -4.263300e-01 1 1  ON 21
   eO_2                -1.784548e-02 1 1  ON 22
   eO_3                 2.904850e-01 1 1  ON 23
   eO_4                 5.106850e-01 1 1  ON 24
   eO_5                 4.692429e-01 1 1  ON 25
   eO_6                 2.428711e-01 1 1  ON 26
   eO_7                -5.121191e-02 1 1  ON 27
   eO_8                -2.073685e-01 1 1  ON 28
   eO_9                -6.703995e-02 1 1  ON 29
  eH1_0                -2.449998e-01 1 1  ON 30
  eH1_1                -1.388526e-01 1 1  ON 31
  eH1_2                -9.004077e-02 1 1  ON 32
  eH1_3                -3.555866e-02 1 1  ON 33
  eH1_4                 1.318497e-02 1 1  ON 34
  eH1_5                 4.667233e-02 1 1  ON 35
  eH1_6                 1.010983e-01 1 1  ON 36
  eH1_7                 1.474233e-01 1 1  ON 37
  eH1_8                 1.598909e-01 1 1  ON 38
  eH1_9                 4.552993e-02 1 1  ON 39
  eH2_0                -2.430992e-01 1 1  ON 40
  eH2_1                -1.367565e-01 1 1  ON 41
  eH2_2                -8.782712e-02 1 1  ON 42
  eH2_3                -3.304889e-02 1 1  ON 43
  eH2_4                 1.602023e-02 1 1  ON 44
  eH2_5                 5.011455e-02 1 1  ON 45
  eH2_6                 1.047539e-01 1 1  ON 46
  eH2_7                 1.517619e-01 1 1  ON 47
  eH2_8                 1.661340e-01 1 1  ON 48
  eH2_9                 2.974332e-02 1 1  ON 49
ci_0001                 7.012891e-01 3 1  ON 50
ci_0002                 7.003435e-01 3 1  ON 51
ci_0003                -2.733657e-02 3 1  ON 52
ci_0004                -2.783408e-02 3 1  ON 53
ci_0005                -3.653665e-02 3 1  ON 54
ci_0006                -3.676718e-02 3 1  ON 55
ci_0007                -2.458565e-02 3 1  ON 56
ci_0008                -2.112873e-02 3 1  ON 57
ci_0009                -1.771054e-02 3 1  ON 58
ci_0010                -1.759872e-02 3 1  ON 59
ci_0011                -1.174896e-02 3 1  ON 60
ci_0012                -1.213805e-02 3 1  ON 61
ci_0013                 1.361678e-02 3 1  ON 62
ci_0014                 1.314025e-02 3 1  ON 63
ci_0015                 1.321822e-02 3 1  ON 64
ci_0016                 1.275638e-02 3 1  ON 65
ci_0017                 1.151955e-02 3 1  ON 66
ci_0018                 1.103962e-02 3 1  ON 67
ci_0019                 1.153897e-02 3 1  ON 68
ci_0020                 1.100973e-02 3 1  ON 69
ci_0021                -1.253893e-03 3 1  ON 70
ci_0022                -2.382902e-04 3 1  ON 71
ci_0023                -1.119384e-02 3 1  ON 72
ci_0024                -1.134938e-02 3 1  ON 73
ci_0025                -1.032602e-02 3 1  ON 74
ci_0026                -1.070234e-02 3 1  ON 75
ci_0027                -1.116955e-02 3 1  ON 76
ci_0028                -1.125726e-02 3 1  ON 77
ci_0029                -1.035041e-02 3 1  ON 78
ci_0030                -1.043115e-02 3 1  ON 79
ci_0031                 1.958999e-02 3 1  ON 80
ci_0032                 2.034527e-02 3 1  ON 81
ci_0033                 9.772458e-03 3 1  ON 82
ci_0034                 9.489522e-03 3 1  ON 83
ci_0035                 6.629130e-03 3 1  ON 84
ci_0036                 7.161482e-03 3 1  ON 85
ci_0037                -1.102477e-02 3 1  ON 86
ci_0038                -1.043723e-02 3 1  ON 87
ci_0039                -2.775797e-03 3 1  ON 88
ci_0040                -2.674461e-03 3 1  ON 89
ci_0041                 6.872222e-03 3 1  ON 90
ci_0042                 7.207082e-03 3 1  ON 91
ci_0043                -1.838328e-02 3 1  ON 92
ci_0044                -1.882913e-02 3 1  ON 93
ci_0045                 7.935636e-03 3 1  ON 94
ci_0046                 7.124182e-03 3 1  ON 95
ci_0047                -1.634743e-03 3 1  ON 96
ci_0048                -1.878880e-03 3 1  ON 97
ci_0049                -5.029216e-03 3 1  ON 98
ci_0050                -5.708378e-03 3 1  ON 99
ci_0051                -3.403040e-03 3 1  ON 100
ci_0052                -3.650185e-03 3 1  ON 101
ci_0053                -4.451029e-03 3 1  ON 102
ci_0054                -4.663728e-03 3 1  ON 103
ci_0055                 6.428560e-03 3 1  ON 104
ci_0056                 7.140982e-03 3 1  ON 105
ci_0057                 4.704419e-03 3 1  ON 106
ci_0058                 5.474220e-03 3 1  ON 107
ci_0059                -4.827548e-03 3 1  ON 108
ci_0060                -4.857109e-03 3 1  ON 109
ci_0061                -3.354958e-03 3 1  ON 110
ci_0062                -2.724361e-03 3 1  ON 111
ci_0063                -9.250881e-03 3 1  ON 112
ci_0064                -8.607297e-03 3 1  ON 113
ci_0065                -5.134756e-03 3 1  ON 114
ci_0066                -5.250715e-03 3 1  ON 115
ci_0067                -5.404695e-03 3 1  ON 116
ci_0068                -4.917581e-03 3 1  ON 117
ci_0069                 4.071837e-03 3 1  ON 118
ci_0070                 4.551091e-03 3 1  ON 119
ci_0071                 1.080668e-03 3 1  ON 120
ci_0072                 3.239005e-04 3 1  ON 121
ci_0073                 4.076794e-03 3 1  ON 122
ci_0074                 4.032228e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9711
    reference variance = 0.214132
====================================================
  Execution time = 2.1002e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4539e-01
  Total weights = 1.9518e+06
  Execution time = 1.8877e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328589128961
                                         uncertainty =       0.003804739441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328589128961
                                         uncertainty =       0.003804739441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405344585
  error estimate for blocks of size 2^( 2) =       0.000418307125
  error estimate for blocks of size 2^( 3) =       0.000431835413
  error estimate for blocks of size 2^( 4) =       0.000443592583
  error estimate for blocks of size 2^( 5) =       0.000455789589
  error estimate for blocks of size 2^( 6) =       0.000462460433
  error estimate for blocks of size 2^( 7) =       0.000467086031

      target function =                  N/A
              le_mean =     -16.905550306811
             les_mean =     286.142875740653
             stat err =       0.000457232159
             autocorr =       1.272403297952
              std dev =       0.573243808867
             le_variance =       0.328608464405

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328509439743
                                         uncertainty =       0.003843414894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328509439743
                                         uncertainty =       0.003843414894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405294483
  error estimate for blocks of size 2^( 2) =       0.000418253241
  error estimate for blocks of size 2^( 3) =       0.000431782147
  error estimate for blocks of size 2^( 4) =       0.000443539329
  error estimate for blocks of size 2^( 5) =       0.000455741961
  error estimate for blocks of size 2^( 6) =       0.000462403575
  error estimate for blocks of size 2^( 7) =       0.000467000217

      target function =                  N/A
              le_mean =     -16.905551384219
             les_mean =     286.143912863927
             stat err =       0.000457171271
             autocorr =       1.272378955097
              std dev =       0.573172954838
             le_variance =       0.328527236158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328487878146
                                         uncertainty =       0.003827709640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328487878146
                                         uncertainty =       0.003827709640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405281494
  error estimate for blocks of size 2^( 2) =       0.000418242483
  error estimate for blocks of size 2^( 3) =       0.000431772273
  error estimate for blocks of size 2^( 4) =       0.000443531093
  error estimate for blocks of size 2^( 5) =       0.000455731404
  error estimate for blocks of size 2^( 6) =       0.000462399434
  error estimate for blocks of size 2^( 7) =       0.000467001903

      target function =                  N/A
              le_mean =     -16.905549783436
             les_mean =     286.145462303197
             stat err =       0.000457165958
             autocorr =       1.272430943785
              std dev =       0.573154585458
             le_variance =       0.328506178831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328567901411
                                         uncertainty =       0.003807590319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328567901411
                                         uncertainty =       0.003807590319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405331406
  error estimate for blocks of size 2^( 2) =       0.000418293817
  error estimate for blocks of size 2^( 3) =       0.000431822490
  error estimate for blocks of size 2^( 4) =       0.000443579989
  error estimate for blocks of size 2^( 5) =       0.000455777975
  error estimate for blocks of size 2^( 6) =       0.000462448663
  error estimate for blocks of size 2^( 7) =       0.000467072237

      target function =                  N/A
              le_mean =     -16.905549548503
             les_mean =     286.144828352616
             stat err =       0.000457219716
             autocorr =       1.272416782736
              std dev =       0.573225171779
             le_variance =       0.328587097561


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905550306811        initial
     3.7253e-01     3.7253e+00             6.4212e-04       -16.905551384219  <--
     1.4901e+00     1.4901e+01             1.9797e-04       -16.905549783436
     5.9605e+00     5.9605e+01             5.7351e-05       -16.905549548503

*****************************************************************************
Applying the update for shift_i =   3.7253e-01     and shift_s =   3.7253e+00
*****************************************************************************

  Execution time = 3.0554e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
   uu_0                 3.117849e-01 1 1  ON 0
   uu_1                 1.445506e-01 1 1  ON 1
   uu_2                 4.281425e-02 1 1  ON 2
   uu_3                -1.936340e-02 1 1  ON 3
   uu_4                -6.434325e-02 1 1  ON 4
   uu_5                -9.862521e-02 1 1  ON 5
   uu_6                -1.253861e-01 1 1  ON 6
   uu_7                -1.382735e-01 1 1  ON 7
   uu_8                -1.302335e-01 1 1  ON 8
   uu_9                -9.888731e-02 1 1  ON 9
   ud_0                 4.445163e-01 1 1  ON 10
   ud_1                 1.789507e-01 1 1  ON 11
   ud_2                 5.922230e-02 1 1  ON 12
   ud_3                -1.113885e-02 1 1  ON 13
   ud_4                -6.713234e-02 1 1  ON 14
   ud_5                -1.075603e-01 1 1  ON 15
   ud_6                -1.338415e-01 1 1  ON 16
   ud_7                -1.491958e-01 1 1  ON 17
   ud_8                -1.498628e-01 1 1  ON 18
   ud_9                -1.379092e-01 1 1  ON 19
   eO_0                -7.455035e-01 1 1  ON 20
   eO_1                -4.265579e-01 1 1  ON 21
   eO_2                -1.809634e-02 1 1  ON 22
   eO_3                 2.905530e-01 1 1  ON 23
   eO_4                 5.109542e-01 1 1  ON 24
   eO_5                 4.695832e-01 1 1  ON 25
   eO_6                 2.431434e-01 1 1  ON 26
   eO_7                -5.096163e-02 1 1  ON 27
   eO_8                -2.075479e-01 1 1  ON 28
   eO_9                -6.728919e-02 1 1  ON 29
  eH1_0                -2.452590e-01 1 1  ON 30
  eH1_1                -1.390391e-01 1 1  ON 31
  eH1_2                -9.016245e-02 1 1  ON 32
  eH1_3                -3.571247e-02 1 1  ON 33
  eH1_4                 1.300052e-02 1 1  ON 34
  eH1_5                 4.642270e-02 1 1  ON 35
  eH1_6                 1.010747e-01 1 1  ON 36
  eH1_7                 1.477597e-01 1 1  ON 37
  eH1_8                 1.603402e-01 1 1  ON 38
  eH1_9                 4.586651e-02 1 1  ON 39
  eH2_0                -2.434732e-01 1 1  ON 40
  eH2_1                -1.369892e-01 1 1  ON 41
  eH2_2                -8.792232e-02 1 1  ON 42
  eH2_3                -3.318205e-02 1 1  ON 43
  eH2_4                 1.587167e-02 1 1  ON 44
  eH2_5                 5.000943e-02 1 1  ON 45
  eH2_6                 1.048775e-01 1 1  ON 46
  eH2_7                 1.519305e-01 1 1  ON 47
  eH2_8                 1.664301e-01 1 1  ON 48
  eH2_9                 3.022483e-02 1 1  ON 49
ci_0001                 7.011778e-01 3 1  ON 50
ci_0002                 7.004600e-01 3 1  ON 51
ci_0003                -2.740696e-02 3 1  ON 52
ci_0004                -2.788940e-02 3 1  ON 53
ci_0005                -3.640950e-02 3 1  ON 54
ci_0006                -3.676810e-02 3 1  ON 55
ci_0007                -2.442104e-02 3 1  ON 56
ci_0008                -2.092197e-02 3 1  ON 57
ci_0009                -1.778321e-02 3 1  ON 58
ci_0010                -1.747041e-02 3 1  ON 59
ci_0011                -1.190242e-02 3 1  ON 60
ci_0012                -1.217041e-02 3 1  ON 61
ci_0013                 1.353790e-02 3 1  ON 62
ci_0014                 1.320572e-02 3 1  ON 63
ci_0015                 1.330733e-02 3 1  ON 64
ci_0016                 1.246669e-02 3 1  ON 65
ci_0017                 1.159807e-02 3 1  ON 66
ci_0018                 1.116634e-02 3 1  ON 67
ci_0019                 1.133122e-02 3 1  ON 68
ci_0020                 1.131968e-02 3 1  ON 69
ci_0021                -1.012120e-03 3 1  ON 70
ci_0022                -5.534566e-04 3 1  ON 71
ci_0023                -1.108820e-02 3 1  ON 72
ci_0024                -1.136047e-02 3 1  ON 73
ci_0025                -1.045473e-02 3 1  ON 74
ci_0026                -1.048806e-02 3 1  ON 75
ci_0027                -1.129721e-02 3 1  ON 76
ci_0028                -1.122352e-02 3 1  ON 77
ci_0029                -1.029639e-02 3 1  ON 78
ci_0030                -1.037774e-02 3 1  ON 79
ci_0031                 1.944836e-02 3 1  ON 80
ci_0032                 2.041402e-02 3 1  ON 81
ci_0033                 1.012090e-02 3 1  ON 82
ci_0034                 9.877130e-03 3 1  ON 83
ci_0035                 6.622475e-03 3 1  ON 84
ci_0036                 7.188207e-03 3 1  ON 85
ci_0037                -1.094843e-02 3 1  ON 86
ci_0038                -1.026477e-02 3 1  ON 87
ci_0039                -2.845626e-03 3 1  ON 88
ci_0040                -2.616018e-03 3 1  ON 89
ci_0041                 6.740059e-03 3 1  ON 90
ci_0042                 7.573175e-03 3 1  ON 91
ci_0043                -1.829790e-02 3 1  ON 92
ci_0044                -1.898651e-02 3 1  ON 93
ci_0045                 8.058812e-03 3 1  ON 94
ci_0046                 7.110637e-03 3 1  ON 95
ci_0047                -1.609524e-03 3 1  ON 96
ci_0048                -2.071959e-03 3 1  ON 97
ci_0049                -5.178858e-03 3 1  ON 98
ci_0050                -5.479454e-03 3 1  ON 99
ci_0051                -3.459970e-03 3 1  ON 100
ci_0052                -3.615009e-03 3 1  ON 101
ci_0053                -4.658025e-03 3 1  ON 102
ci_0054                -4.538655e-03 3 1  ON 103
ci_0055                 6.508505e-03 3 1  ON 104
ci_0056                 7.145497e-03 3 1  ON 105
ci_0057                 4.917956e-03 3 1  ON 106
ci_0058                 5.560492e-03 3 1  ON 107
ci_0059                -4.650408e-03 3 1  ON 108
ci_0060                -4.693494e-03 3 1  ON 109
ci_0061                -3.402139e-03 3 1  ON 110
ci_0062                -2.905772e-03 3 1  ON 111
ci_0063                -9.144055e-03 3 1  ON 112
ci_0064                -8.516291e-03 3 1  ON 113
ci_0065                -5.035929e-03 3 1  ON 114
ci_0066                -5.316141e-03 3 1  ON 115
ci_0067                -5.298169e-03 3 1  ON 116
ci_0068                -4.951924e-03 3 1  ON 117
ci_0069                 4.384576e-03 3 1  ON 118
ci_0070                 4.611718e-03 3 1  ON 119
ci_0071                 7.863257e-04 3 1  ON 120
ci_0072                 1.826404e-04 3 1  ON 121
ci_0073                 4.070160e-03 3 1  ON 122
ci_0074                 4.063756e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8039e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6892e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9338
    reference variance = 0.234505
====================================================
  Execution time = 2.1467e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3241e-01
  Total weights = 1.951907208e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1585e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320125949228
                                         uncertainty =       0.002074066710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320125949228
                                         uncertainty =       0.002074066710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400023265
  error estimate for blocks of size 2^( 2) =       0.000412740517
  error estimate for blocks of size 2^( 3) =       0.000425757273
  error estimate for blocks of size 2^( 4) =       0.000437694767
  error estimate for blocks of size 2^( 5) =       0.000448110833
  error estimate for blocks of size 2^( 6) =       0.000455004208
  error estimate for blocks of size 2^( 7) =       0.000458250219

      target function =                  N/A
              le_mean =     -16.906528494236
             les_mean =     286.163115973700
             stat err =       0.000449765007
             autocorr =       1.264156452585
              std dev =       0.565718326211
             le_variance =       0.320037224611


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690652849424e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906528494225       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906538775235       residual = 5.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906528656922       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906530145854       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906531536903       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906532336191       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906531398093       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906533263918       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906532131393       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906532484495       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906532852813       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906533403037       residual = 8.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906533960492       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906533871142       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906533971171       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906534202813       residual = 6.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.3132e-02 is 2.052005e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906528494225       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906533706921       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906528521181       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906528313268       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906529438177       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906529324193       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906529412044       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906529352078       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906529121130       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906529172829       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906529236114       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906529270821       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.7253e-01 is 6.005970e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906528494225       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906530248210       residual = 5.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906528471126       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906528214405       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906528509628       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906528788362       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906528753509       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906528668070       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906528645559       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906528650503       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+00 is 1.690969e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.416173 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7636e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
   uu_0                 3.119654e-01 1 1  ON 0
   uu_1                 1.446222e-01 1 1  ON 1
   uu_2                 4.292393e-02 1 1  ON 2
   uu_3                -1.933910e-02 1 1  ON 3
   uu_4                -6.439945e-02 1 1  ON 4
   uu_5                -9.862820e-02 1 1  ON 5
   uu_6                -1.254014e-01 1 1  ON 6
   uu_7                -1.383882e-01 1 1  ON 7
   uu_8                -1.303365e-01 1 1  ON 8
   uu_9                -9.919405e-02 1 1  ON 9
   ud_0                 4.448903e-01 1 1  ON 10
   ud_1                 1.793601e-01 1 1  ON 11
   ud_2                 5.930330e-02 1 1  ON 12
   ud_3                -1.107665e-02 1 1  ON 13
   ud_4                -6.709358e-02 1 1  ON 14
   ud_5                -1.075632e-01 1 1  ON 15
   ud_6                -1.338793e-01 1 1  ON 16
   ud_7                -1.492151e-01 1 1  ON 17
   ud_8                -1.504634e-01 1 1  ON 18
   ud_9                -1.382797e-01 1 1  ON 19
   eO_0                -7.460566e-01 1 1  ON 20
   eO_1                -4.267265e-01 1 1  ON 21
   eO_2                -1.794721e-02 1 1  ON 22
   eO_3                 2.909024e-01 1 1  ON 23
   eO_4                 5.114508e-01 1 1  ON 24
   eO_5                 4.697281e-01 1 1  ON 25
   eO_6                 2.435221e-01 1 1  ON 26
   eO_7                -5.081411e-02 1 1  ON 27
   eO_8                -2.080238e-01 1 1  ON 28
   eO_9                -6.769743e-02 1 1  ON 29
  eH1_0                -2.458127e-01 1 1  ON 30
  eH1_1                -1.394630e-01 1 1  ON 31
  eH1_2                -9.035040e-02 1 1  ON 32
  eH1_3                -3.588717e-02 1 1  ON 33
  eH1_4                 1.293567e-02 1 1  ON 34
  eH1_5                 4.655802e-02 1 1  ON 35
  eH1_6                 1.011690e-01 1 1  ON 36
  eH1_7                 1.480916e-01 1 1  ON 37
  eH1_8                 1.608063e-01 1 1  ON 38
  eH1_9                 4.628004e-02 1 1  ON 39
  eH2_0                -2.439971e-01 1 1  ON 40
  eH2_1                -1.371949e-01 1 1  ON 41
  eH2_2                -8.794027e-02 1 1  ON 42
  eH2_3                -3.327305e-02 1 1  ON 43
  eH2_4                 1.580104e-02 1 1  ON 44
  eH2_5                 4.986473e-02 1 1  ON 45
  eH2_6                 1.049604e-01 1 1  ON 46
  eH2_7                 1.520235e-01 1 1  ON 47
  eH2_8                 1.667978e-01 1 1  ON 48
  eH2_9                 3.073269e-02 1 1  ON 49
ci_0001                 7.010301e-01 3 1  ON 50
ci_0002                 7.006310e-01 3 1  ON 51
ci_0003                -2.726186e-02 3 1  ON 52
ci_0004                -2.751444e-02 3 1  ON 53
ci_0005                -3.653229e-02 3 1  ON 54
ci_0006                -3.676346e-02 3 1  ON 55
ci_0007                -2.428020e-02 3 1  ON 56
ci_0008                -2.115481e-02 3 1  ON 57
ci_0009                -1.781325e-02 3 1  ON 58
ci_0010                -1.770561e-02 3 1  ON 59
ci_0011                -1.162829e-02 3 1  ON 60
ci_0012                -1.211811e-02 3 1  ON 61
ci_0013                 1.333023e-02 3 1  ON 62
ci_0014                 1.308337e-02 3 1  ON 63
ci_0015                 1.319512e-02 3 1  ON 64
ci_0016                 1.258147e-02 3 1  ON 65
ci_0017                 1.141160e-02 3 1  ON 66
ci_0018                 1.082488e-02 3 1  ON 67
ci_0019                 1.103987e-02 3 1  ON 68
ci_0020                 1.132714e-02 3 1  ON 69
ci_0021                -1.537352e-03 3 1  ON 70
ci_0022                -7.742952e-04 3 1  ON 71
ci_0023                -1.095604e-02 3 1  ON 72
ci_0024                -1.146097e-02 3 1  ON 73
ci_0025                -1.092304e-02 3 1  ON 74
ci_0026                -1.034341e-02 3 1  ON 75
ci_0027                -1.143243e-02 3 1  ON 76
ci_0028                -1.093816e-02 3 1  ON 77
ci_0029                -1.054297e-02 3 1  ON 78
ci_0030                -1.006922e-02 3 1  ON 79
ci_0031                 1.955010e-02 3 1  ON 80
ci_0032                 2.022172e-02 3 1  ON 81
ci_0033                 1.004230e-02 3 1  ON 82
ci_0034                 1.036199e-02 3 1  ON 83
ci_0035                 6.508649e-03 3 1  ON 84
ci_0036                 6.966382e-03 3 1  ON 85
ci_0037                -1.089034e-02 3 1  ON 86
ci_0038                -1.004075e-02 3 1  ON 87
ci_0039                -2.740518e-03 3 1  ON 88
ci_0040                -2.688681e-03 3 1  ON 89
ci_0041                 7.045965e-03 3 1  ON 90
ci_0042                 7.503072e-03 3 1  ON 91
ci_0043                -1.868851e-02 3 1  ON 92
ci_0044                -1.919194e-02 3 1  ON 93
ci_0045                 7.918026e-03 3 1  ON 94
ci_0046                 7.321880e-03 3 1  ON 95
ci_0047                -1.693386e-03 3 1  ON 96
ci_0048                -1.998733e-03 3 1  ON 97
ci_0049                -5.194400e-03 3 1  ON 98
ci_0050                -5.620105e-03 3 1  ON 99
ci_0051                -3.508316e-03 3 1  ON 100
ci_0052                -3.286663e-03 3 1  ON 101
ci_0053                -4.668759e-03 3 1  ON 102
ci_0054                -4.448088e-03 3 1  ON 103
ci_0055                 6.402374e-03 3 1  ON 104
ci_0056                 6.773860e-03 3 1  ON 105
ci_0057                 5.005714e-03 3 1  ON 106
ci_0058                 5.336327e-03 3 1  ON 107
ci_0059                -4.658737e-03 3 1  ON 108
ci_0060                -4.824060e-03 3 1  ON 109
ci_0061                -3.535267e-03 3 1  ON 110
ci_0062                -3.198640e-03 3 1  ON 111
ci_0063                -8.958955e-03 3 1  ON 112
ci_0064                -8.468537e-03 3 1  ON 113
ci_0065                -5.040333e-03 3 1  ON 114
ci_0066                -5.061651e-03 3 1  ON 115
ci_0067                -5.252825e-03 3 1  ON 116
ci_0068                -4.858915e-03 3 1  ON 117
ci_0069                 4.631415e-03 3 1  ON 118
ci_0070                 4.548254e-03 3 1  ON 119
ci_0071                 5.833770e-04 3 1  ON 120
ci_0072                 5.474738e-04 3 1  ON 121
ci_0073                 4.173651e-03 3 1  ON 122
ci_0074                 4.129553e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9826
    reference variance = 0.332917
====================================================
  Execution time = 2.1060e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3129e-01
  Total weights = 1.9515e+06
  Execution time = 1.8907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319761494381
                                         uncertainty =       0.002286374346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319761494381
                                         uncertainty =       0.002286374346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399841071
  error estimate for blocks of size 2^( 2) =       0.000412809762
  error estimate for blocks of size 2^( 3) =       0.000426108987
  error estimate for blocks of size 2^( 4) =       0.000438541327
  error estimate for blocks of size 2^( 5) =       0.000449056573
  error estimate for blocks of size 2^( 6) =       0.000456698231
  error estimate for blocks of size 2^( 7) =       0.000458839293

      target function =                  N/A
              le_mean =     -16.906572119316
             les_mean =     286.167603685512
             stat err =       0.000450783856
             autocorr =       1.271047861883
              std dev =       0.565460665201
             le_variance =       0.319745763890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320187259383
                                         uncertainty =       0.002341635536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320187259383
                                         uncertainty =       0.002341635536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400106462
  error estimate for blocks of size 2^( 2) =       0.000413103393
  error estimate for blocks of size 2^( 3) =       0.000426403597
  error estimate for blocks of size 2^( 4) =       0.000438823702
  error estimate for blocks of size 2^( 5) =       0.000449346549
  error estimate for blocks of size 2^( 6) =       0.000456942539
  error estimate for blocks of size 2^( 7) =       0.000459052372

      target function =                  N/A
              le_mean =     -16.906565196300
             les_mean =     286.164708173545
             stat err =       0.000451041290
             autocorr =       1.270812478817
              std dev =       0.565835985121
             le_variance =       0.320170362058

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320072025194
                                         uncertainty =       0.002340949642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320072025194
                                         uncertainty =       0.002340949642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400034212
  error estimate for blocks of size 2^( 2) =       0.000413035303
  error estimate for blocks of size 2^( 3) =       0.000426342620
  error estimate for blocks of size 2^( 4) =       0.000438773851
  error estimate for blocks of size 2^( 5) =       0.000449308860
  error estimate for blocks of size 2^( 6) =       0.000456906562
  error estimate for blocks of size 2^( 7) =       0.000459014448

      target function =                  N/A
              le_mean =     -16.906564324984
             les_mean =     286.164139561083
             stat err =       0.000451000930
             autocorr =       1.271044062709
              std dev =       0.565733807742
             le_variance =       0.320054741222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319775634287
                                         uncertainty =       0.002295421610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319775634287
                                         uncertainty =       0.002295421610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399849735
  error estimate for blocks of size 2^( 2) =       0.000412825249
  error estimate for blocks of size 2^( 3) =       0.000426125976
  error estimate for blocks of size 2^( 4) =       0.000438558917
  error estimate for blocks of size 2^( 5) =       0.000449080212
  error estimate for blocks of size 2^( 6) =       0.000456710208
  error estimate for blocks of size 2^( 7) =       0.000458845885

      target function =                  N/A
              le_mean =     -16.906565705008
             les_mean =     286.170754450393
             stat err =       0.000450798805
             autocorr =       1.271077082632
              std dev =       0.565472917840
             le_variance =       0.319759620810


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906572119316        initial  <--
     9.3132e-02     9.3132e-01             2.0520e-03       -16.906565196300
     3.7253e-01     3.7253e+00             6.0060e-04       -16.906564324984
     1.4901e+00     1.4901e+01             1.6910e-04       -16.906565705008

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6039
  </log>
  <optVariables href="H2O.s033.opt.xml">
   uu_0                 3.117849e-01 1 1  ON 0
   uu_1                 1.445506e-01 1 1  ON 1
   uu_2                 4.281425e-02 1 1  ON 2
   uu_3                -1.936340e-02 1 1  ON 3
   uu_4                -6.434325e-02 1 1  ON 4
   uu_5                -9.862521e-02 1 1  ON 5
   uu_6                -1.253861e-01 1 1  ON 6
   uu_7                -1.382735e-01 1 1  ON 7
   uu_8                -1.302335e-01 1 1  ON 8
   uu_9                -9.888731e-02 1 1  ON 9
   ud_0                 4.445163e-01 1 1  ON 10
   ud_1                 1.789507e-01 1 1  ON 11
   ud_2                 5.922230e-02 1 1  ON 12
   ud_3                -1.113885e-02 1 1  ON 13
   ud_4                -6.713234e-02 1 1  ON 14
   ud_5                -1.075603e-01 1 1  ON 15
   ud_6                -1.338415e-01 1 1  ON 16
   ud_7                -1.491958e-01 1 1  ON 17
   ud_8                -1.498628e-01 1 1  ON 18
   ud_9                -1.379092e-01 1 1  ON 19
   eO_0                -7.455035e-01 1 1  ON 20
   eO_1                -4.265579e-01 1 1  ON 21
   eO_2                -1.809634e-02 1 1  ON 22
   eO_3                 2.905530e-01 1 1  ON 23
   eO_4                 5.109542e-01 1 1  ON 24
   eO_5                 4.695832e-01 1 1  ON 25
   eO_6                 2.431434e-01 1 1  ON 26
   eO_7                -5.096163e-02 1 1  ON 27
   eO_8                -2.075479e-01 1 1  ON 28
   eO_9                -6.728919e-02 1 1  ON 29
  eH1_0                -2.452590e-01 1 1  ON 30
  eH1_1                -1.390391e-01 1 1  ON 31
  eH1_2                -9.016245e-02 1 1  ON 32
  eH1_3                -3.571247e-02 1 1  ON 33
  eH1_4                 1.300052e-02 1 1  ON 34
  eH1_5                 4.642270e-02 1 1  ON 35
  eH1_6                 1.010747e-01 1 1  ON 36
  eH1_7                 1.477597e-01 1 1  ON 37
  eH1_8                 1.603402e-01 1 1  ON 38
  eH1_9                 4.586651e-02 1 1  ON 39
  eH2_0                -2.434732e-01 1 1  ON 40
  eH2_1                -1.369892e-01 1 1  ON 41
  eH2_2                -8.792232e-02 1 1  ON 42
  eH2_3                -3.318205e-02 1 1  ON 43
  eH2_4                 1.587167e-02 1 1  ON 44
  eH2_5                 5.000943e-02 1 1  ON 45
  eH2_6                 1.048775e-01 1 1  ON 46
  eH2_7                 1.519305e-01 1 1  ON 47
  eH2_8                 1.664301e-01 1 1  ON 48
  eH2_9                 3.022483e-02 1 1  ON 49
ci_0001                 7.011778e-01 3 1  ON 50
ci_0002                 7.004600e-01 3 1  ON 51
ci_0003                -2.740696e-02 3 1  ON 52
ci_0004                -2.788940e-02 3 1  ON 53
ci_0005                -3.640950e-02 3 1  ON 54
ci_0006                -3.676810e-02 3 1  ON 55
ci_0007                -2.442104e-02 3 1  ON 56
ci_0008                -2.092197e-02 3 1  ON 57
ci_0009                -1.778321e-02 3 1  ON 58
ci_0010                -1.747041e-02 3 1  ON 59
ci_0011                -1.190242e-02 3 1  ON 60
ci_0012                -1.217041e-02 3 1  ON 61
ci_0013                 1.353790e-02 3 1  ON 62
ci_0014                 1.320572e-02 3 1  ON 63
ci_0015                 1.330733e-02 3 1  ON 64
ci_0016                 1.246669e-02 3 1  ON 65
ci_0017                 1.159807e-02 3 1  ON 66
ci_0018                 1.116634e-02 3 1  ON 67
ci_0019                 1.133122e-02 3 1  ON 68
ci_0020                 1.131968e-02 3 1  ON 69
ci_0021                -1.012120e-03 3 1  ON 70
ci_0022                -5.534566e-04 3 1  ON 71
ci_0023                -1.108820e-02 3 1  ON 72
ci_0024                -1.136047e-02 3 1  ON 73
ci_0025                -1.045473e-02 3 1  ON 74
ci_0026                -1.048806e-02 3 1  ON 75
ci_0027                -1.129721e-02 3 1  ON 76
ci_0028                -1.122352e-02 3 1  ON 77
ci_0029                -1.029639e-02 3 1  ON 78
ci_0030                -1.037774e-02 3 1  ON 79
ci_0031                 1.944836e-02 3 1  ON 80
ci_0032                 2.041402e-02 3 1  ON 81
ci_0033                 1.012090e-02 3 1  ON 82
ci_0034                 9.877130e-03 3 1  ON 83
ci_0035                 6.622475e-03 3 1  ON 84
ci_0036                 7.188207e-03 3 1  ON 85
ci_0037                -1.094843e-02 3 1  ON 86
ci_0038                -1.026477e-02 3 1  ON 87
ci_0039                -2.845626e-03 3 1  ON 88
ci_0040                -2.616018e-03 3 1  ON 89
ci_0041                 6.740059e-03 3 1  ON 90
ci_0042                 7.573175e-03 3 1  ON 91
ci_0043                -1.829790e-02 3 1  ON 92
ci_0044                -1.898651e-02 3 1  ON 93
ci_0045                 8.058812e-03 3 1  ON 94
ci_0046                 7.110637e-03 3 1  ON 95
ci_0047                -1.609524e-03 3 1  ON 96
ci_0048                -2.071959e-03 3 1  ON 97
ci_0049                -5.178858e-03 3 1  ON 98
ci_0050                -5.479454e-03 3 1  ON 99
ci_0051                -3.459970e-03 3 1  ON 100
ci_0052                -3.615009e-03 3 1  ON 101
ci_0053                -4.658025e-03 3 1  ON 102
ci_0054                -4.538655e-03 3 1  ON 103
ci_0055                 6.508505e-03 3 1  ON 104
ci_0056                 7.145497e-03 3 1  ON 105
ci_0057                 4.917956e-03 3 1  ON 106
ci_0058                 5.560492e-03 3 1  ON 107
ci_0059                -4.650408e-03 3 1  ON 108
ci_0060                -4.693494e-03 3 1  ON 109
ci_0061                -3.402139e-03 3 1  ON 110
ci_0062                -2.905772e-03 3 1  ON 111
ci_0063                -9.144055e-03 3 1  ON 112
ci_0064                -8.516291e-03 3 1  ON 113
ci_0065                -5.035929e-03 3 1  ON 114
ci_0066                -5.316141e-03 3 1  ON 115
ci_0067                -5.298169e-03 3 1  ON 116
ci_0068                -4.951924e-03 3 1  ON 117
ci_0069                 4.384576e-03 3 1  ON 118
ci_0070                 4.611718e-03 3 1  ON 119
ci_0071                 7.863257e-04 3 1  ON 120
ci_0072                 1.826404e-04 3 1  ON 121
ci_0073                 4.070160e-03 3 1  ON 122
ci_0074                 4.063756e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8248e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9311
    reference variance = 0.261562
====================================================
  Execution time = 2.1387e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3191e-01
  Total weights = 1.951469395e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1199e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320465991138
                                         uncertainty =       0.001877940032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320465991138
                                         uncertainty =       0.001877940032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400313795
  error estimate for blocks of size 2^( 2) =       0.000413222819
  error estimate for blocks of size 2^( 3) =       0.000427494992
  error estimate for blocks of size 2^( 4) =       0.000440450021
  error estimate for blocks of size 2^( 5) =       0.000452472494
  error estimate for blocks of size 2^( 6) =       0.000461783549
  error estimate for blocks of size 2^( 7) =       0.000467020751

      target function =                  N/A
              le_mean =     -16.906124177801
             les_mean =     286.148946745448
             stat err =       0.000455431704
             autocorr =       1.294331160832
              std dev =       0.566129197905
             le_variance =       0.320502268720


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690612417780e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906124177787       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906124140683       residual = 8.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906124309681       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906124442226       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906124647951       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906124552129       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906124792728       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906124798524       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906124807525       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906124791230       residual = 8.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.3132e-01 is 2.842009e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906124177787       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906124167055       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906124201778       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906124208303       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906124262333       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906124233648       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906124301221       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906124284640       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906124291602       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906124293259       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.7253e+00 is 8.228033e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906124177787       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906124174994       residual = 8.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906124183005       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906124182291       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906124195510       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906124187879       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906124205847       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906124200169       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906124201918       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906124202719       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+01 is 2.143453e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.420066 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7515e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
   uu_0                 3.117952e-01 1 1  ON 0
   uu_1                 1.445405e-01 1 1  ON 1
   uu_2                 4.282780e-02 1 1  ON 2
   uu_3                -1.935909e-02 1 1  ON 3
   uu_4                -6.435218e-02 1 1  ON 4
   uu_5                -9.861798e-02 1 1  ON 5
   uu_6                -1.254234e-01 1 1  ON 6
   uu_7                -1.382701e-01 1 1  ON 7
   uu_8                -1.302465e-01 1 1  ON 8
   uu_9                -9.890396e-02 1 1  ON 9
   ud_0                 4.445416e-01 1 1  ON 10
   ud_1                 1.789600e-01 1 1  ON 11
   ud_2                 5.921993e-02 1 1  ON 12
   ud_3                -1.114920e-02 1 1  ON 13
   ud_4                -6.714514e-02 1 1  ON 14
   ud_5                -1.075464e-01 1 1  ON 15
   ud_6                -1.338624e-01 1 1  ON 16
   ud_7                -1.491846e-01 1 1  ON 17
   ud_8                -1.498574e-01 1 1  ON 18
   ud_9                -1.379203e-01 1 1  ON 19
   eO_0                -7.455555e-01 1 1  ON 20
   eO_1                -4.265873e-01 1 1  ON 21
   eO_2                -1.811336e-02 1 1  ON 22
   eO_3                 2.906003e-01 1 1  ON 23
   eO_4                 5.109836e-01 1 1  ON 24
   eO_5                 4.696212e-01 1 1  ON 25
   eO_6                 2.431713e-01 1 1  ON 26
   eO_7                -5.094067e-02 1 1  ON 27
   eO_8                -2.075726e-01 1 1  ON 28
   eO_9                -6.732343e-02 1 1  ON 29
  eH1_0                -2.453149e-01 1 1  ON 30
  eH1_1                -1.391035e-01 1 1  ON 31
  eH1_2                -9.017434e-02 1 1  ON 32
  eH1_3                -3.572899e-02 1 1  ON 33
  eH1_4                 1.302930e-02 1 1  ON 34
  eH1_5                 4.641942e-02 1 1  ON 35
  eH1_6                 1.010918e-01 1 1  ON 36
  eH1_7                 1.477863e-01 1 1  ON 37
  eH1_8                 1.603729e-01 1 1  ON 38
  eH1_9                 4.590418e-02 1 1  ON 39
  eH2_0                -2.435386e-01 1 1  ON 40
  eH2_1                -1.370199e-01 1 1  ON 41
  eH2_2                -8.790165e-02 1 1  ON 42
  eH2_3                -3.319583e-02 1 1  ON 43
  eH2_4                 1.583456e-02 1 1  ON 44
  eH2_5                 4.996581e-02 1 1  ON 45
  eH2_6                 1.049008e-01 1 1  ON 46
  eH2_7                 1.519682e-01 1 1  ON 47
  eH2_8                 1.664710e-01 1 1  ON 48
  eH2_9                 3.028699e-02 1 1  ON 49
ci_0001                 7.011764e-01 3 1  ON 50
ci_0002                 7.004674e-01 3 1  ON 51
ci_0003                -2.743953e-02 3 1  ON 52
ci_0004                -2.781153e-02 3 1  ON 53
ci_0005                -3.642873e-02 3 1  ON 54
ci_0006                -3.674851e-02 3 1  ON 55
ci_0007                -2.436501e-02 3 1  ON 56
ci_0008                -2.092775e-02 3 1  ON 57
ci_0009                -1.775418e-02 3 1  ON 58
ci_0010                -1.748455e-02 3 1  ON 59
ci_0011                -1.190768e-02 3 1  ON 60
ci_0012                -1.219554e-02 3 1  ON 61
ci_0013                 1.357773e-02 3 1  ON 62
ci_0014                 1.315707e-02 3 1  ON 63
ci_0015                 1.330860e-02 3 1  ON 64
ci_0016                 1.251642e-02 3 1  ON 65
ci_0017                 1.159106e-02 3 1  ON 66
ci_0018                 1.117955e-02 3 1  ON 67
ci_0019                 1.128497e-02 3 1  ON 68
ci_0020                 1.129088e-02 3 1  ON 69
ci_0021                -1.006618e-03 3 1  ON 70
ci_0022                -5.380675e-04 3 1  ON 71
ci_0023                -1.112226e-02 3 1  ON 72
ci_0024                -1.135088e-02 3 1  ON 73
ci_0025                -1.041770e-02 3 1  ON 74
ci_0026                -1.050005e-02 3 1  ON 75
ci_0027                -1.132698e-02 3 1  ON 76
ci_0028                -1.119705e-02 3 1  ON 77
ci_0029                -1.027338e-02 3 1  ON 78
ci_0030                -1.037229e-02 3 1  ON 79
ci_0031                 1.944936e-02 3 1  ON 80
ci_0032                 2.040413e-02 3 1  ON 81
ci_0033                 1.016476e-02 3 1  ON 82
ci_0034                 9.922807e-03 3 1  ON 83
ci_0035                 6.643968e-03 3 1  ON 84
ci_0036                 7.135312e-03 3 1  ON 85
ci_0037                -1.091779e-02 3 1  ON 86
ci_0038                -1.028461e-02 3 1  ON 87
ci_0039                -2.830543e-03 3 1  ON 88
ci_0040                -2.612996e-03 3 1  ON 89
ci_0041                 6.761297e-03 3 1  ON 90
ci_0042                 7.526173e-03 3 1  ON 91
ci_0043                -1.827980e-02 3 1  ON 92
ci_0044                -1.895859e-02 3 1  ON 93
ci_0045                 8.071620e-03 3 1  ON 94
ci_0046                 7.049716e-03 3 1  ON 95
ci_0047                -1.586690e-03 3 1  ON 96
ci_0048                -2.047189e-03 3 1  ON 97
ci_0049                -5.258329e-03 3 1  ON 98
ci_0050                -5.506583e-03 3 1  ON 99
ci_0051                -3.438969e-03 3 1  ON 100
ci_0052                -3.572062e-03 3 1  ON 101
ci_0053                -4.643736e-03 3 1  ON 102
ci_0054                -4.536390e-03 3 1  ON 103
ci_0055                 6.492730e-03 3 1  ON 104
ci_0056                 7.132633e-03 3 1  ON 105
ci_0057                 4.919739e-03 3 1  ON 106
ci_0058                 5.510682e-03 3 1  ON 107
ci_0059                -4.682263e-03 3 1  ON 108
ci_0060                -4.704442e-03 3 1  ON 109
ci_0061                -3.389655e-03 3 1  ON 110
ci_0062                -2.938674e-03 3 1  ON 111
ci_0063                -9.132626e-03 3 1  ON 112
ci_0064                -8.505002e-03 3 1  ON 113
ci_0065                -5.090725e-03 3 1  ON 114
ci_0066                -5.359289e-03 3 1  ON 115
ci_0067                -5.256143e-03 3 1  ON 116
ci_0068                -4.911912e-03 3 1  ON 117
ci_0069                 4.414143e-03 3 1  ON 118
ci_0070                 4.617214e-03 3 1  ON 119
ci_0071                 7.676238e-04 3 1  ON 120
ci_0072                 1.003601e-04 3 1  ON 121
ci_0073                 4.078490e-03 3 1  ON 122
ci_0074                 4.039198e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8766
    reference variance = 0.301791
====================================================
  Execution time = 2.1265e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3595e-01
  Total weights = 1.9515e+06
  Execution time = 1.9011e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323622465181
                                         uncertainty =       0.002640825776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323622465181
                                         uncertainty =       0.002640825776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402386243
  error estimate for blocks of size 2^( 2) =       0.000415770454
  error estimate for blocks of size 2^( 3) =       0.000428968994
  error estimate for blocks of size 2^( 4) =       0.000441592835
  error estimate for blocks of size 2^( 5) =       0.000453044957
  error estimate for blocks of size 2^( 6) =       0.000461810034
  error estimate for blocks of size 2^( 7) =       0.000468158528

      target function =                  N/A
              le_mean =     -16.905562254436
             les_mean =     286.138835455628
             stat err =       0.000456151588
             autocorr =       1.285085828073
              std dev =       0.569060082072
             le_variance =       0.323829377007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323688699930
                                         uncertainty =       0.002659973292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323688699930
                                         uncertainty =       0.002659973292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402427090
  error estimate for blocks of size 2^( 2) =       0.000415814523
  error estimate for blocks of size 2^( 3) =       0.000429012712
  error estimate for blocks of size 2^( 4) =       0.000441634285
  error estimate for blocks of size 2^( 5) =       0.000453092502
  error estimate for blocks of size 2^( 6) =       0.000461855123
  error estimate for blocks of size 2^( 7) =       0.000468196381

      target function =                  N/A
              le_mean =     -16.905562798056
             les_mean =     286.133875217256
             stat err =       0.000456194573
             autocorr =       1.285067119517
              std dev =       0.569117848893
             le_variance =       0.323895125928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323648871585
                                         uncertainty =       0.002650514312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323648871585
                                         uncertainty =       0.002650514312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402402456
  error estimate for blocks of size 2^( 2) =       0.000415788423
  error estimate for blocks of size 2^( 3) =       0.000428987068
  error estimate for blocks of size 2^( 4) =       0.000441609879
  error estimate for blocks of size 2^( 5) =       0.000453065654
  error estimate for blocks of size 2^( 6) =       0.000461829221
  error estimate for blocks of size 2^( 7) =       0.000468174405

      target function =                  N/A
              le_mean =     -16.905562168183
             les_mean =     286.133884587342
             stat err =       0.000456169790
             autocorr =       1.285084825479
              std dev =       0.569083010796
             le_variance =       0.323855473177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323624646939
                                         uncertainty =       0.002641977092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323624646939
                                         uncertainty =       0.002641977092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402387573
  error estimate for blocks of size 2^( 2) =       0.000415771379
  error estimate for blocks of size 2^( 3) =       0.000428969981
  error estimate for blocks of size 2^( 4) =       0.000441593960
  error estimate for blocks of size 2^( 5) =       0.000453045813
  error estimate for blocks of size 2^( 6) =       0.000461810405
  error estimate for blocks of size 2^( 7) =       0.000468159495

      target function =                  N/A
              le_mean =     -16.905562459771
             les_mean =     286.134128315012
             stat err =       0.000456152418
             autocorr =       1.285082007149
              std dev =       0.569061963399
             le_variance =       0.323831518187


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905562254436        initial
     9.3132e-01     9.3132e+00             2.8420e-04       -16.905562798056  <--
     3.7253e+00     3.7253e+01             8.2280e-05       -16.905562168183
     1.4901e+01     1.4901e+02             2.1435e-05       -16.905562459771

*****************************************************************************
Applying the update for shift_i =   9.3132e-01     and shift_s =   9.3132e+00
*****************************************************************************

  Execution time = 3.0853e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
   uu_0                 3.118214e-01 1 1  ON 0
   uu_1                 1.445311e-01 1 1  ON 1
   uu_2                 4.285540e-02 1 1  ON 2
   uu_3                -1.934792e-02 1 1  ON 3
   uu_4                -6.437509e-02 1 1  ON 4
   uu_5                -9.860592e-02 1 1  ON 5
   uu_6                -1.255216e-01 1 1  ON 6
   uu_7                -1.382674e-01 1 1  ON 7
   uu_8                -1.302869e-01 1 1  ON 8
   uu_9                -9.895273e-02 1 1  ON 9
   ud_0                 4.446057e-01 1 1  ON 10
   ud_1                 1.789885e-01 1 1  ON 11
   ud_2                 5.921801e-02 1 1  ON 12
   ud_3                -1.117476e-02 1 1  ON 13
   ud_4                -6.717506e-02 1 1  ON 14
   ud_5                -1.075188e-01 1 1  ON 15
   ud_6                -1.339131e-01 1 1  ON 16
   ud_7                -1.491574e-01 1 1  ON 17
   ud_8                -1.498431e-01 1 1  ON 18
   ud_9                -1.379520e-01 1 1  ON 19
   eO_0                -7.457169e-01 1 1  ON 20
   eO_1                -4.266676e-01 1 1  ON 21
   eO_2                -1.815722e-02 1 1  ON 22
   eO_3                 2.907304e-01 1 1  ON 23
   eO_4                 5.110740e-01 1 1  ON 24
   eO_5                 4.697363e-01 1 1  ON 25
   eO_6                 2.432539e-01 1 1  ON 26
   eO_7                -5.088004e-02 1 1  ON 27
   eO_8                -2.076456e-01 1 1  ON 28
   eO_9                -6.742471e-02 1 1  ON 29
  eH1_0                -2.454790e-01 1 1  ON 30
  eH1_1                -1.392766e-01 1 1  ON 31
  eH1_2                -9.021788e-02 1 1  ON 32
  eH1_3                -3.577690e-02 1 1  ON 33
  eH1_4                 1.309904e-02 1 1  ON 34
  eH1_5                 4.641313e-02 1 1  ON 35
  eH1_6                 1.011439e-01 1 1  ON 36
  eH1_7                 1.478646e-01 1 1  ON 37
  eH1_8                 1.604691e-01 1 1  ON 38
  eH1_9                 4.601571e-02 1 1  ON 39
  eH2_0                -2.437216e-01 1 1  ON 40
  eH2_1                -1.371015e-01 1 1  ON 41
  eH2_2                -8.786559e-02 1 1  ON 42
  eH2_3                -3.323627e-02 1 1  ON 43
  eH2_4                 1.572957e-02 1 1  ON 44
  eH2_5                 4.983601e-02 1 1  ON 45
  eH2_6                 1.049684e-01 1 1  ON 46
  eH2_7                 1.520804e-01 1 1  ON 47
  eH2_8                 1.665929e-01 1 1  ON 48
  eH2_9                 3.047138e-02 1 1  ON 49
ci_0001                 7.011751e-01 3 1  ON 50
ci_0002                 7.004838e-01 3 1  ON 51
ci_0003                -2.752296e-02 3 1  ON 52
ci_0004                -2.761812e-02 3 1  ON 53
ci_0005                -3.648027e-02 3 1  ON 54
ci_0006                -3.669641e-02 3 1  ON 55
ci_0007                -2.421097e-02 3 1  ON 56
ci_0008                -2.094348e-02 3 1  ON 57
ci_0009                -1.768466e-02 3 1  ON 58
ci_0010                -1.751805e-02 3 1  ON 59
ci_0011                -1.192032e-02 3 1  ON 60
ci_0012                -1.226072e-02 3 1  ON 61
ci_0013                 1.367388e-02 3 1  ON 62
ci_0014                 1.303954e-02 3 1  ON 63
ci_0015                 1.331279e-02 3 1  ON 64
ci_0016                 1.263981e-02 3 1  ON 65
ci_0017                 1.157460e-02 3 1  ON 66
ci_0018                 1.121086e-02 3 1  ON 67
ci_0019                 1.116963e-02 3 1  ON 68
ci_0020                 1.122078e-02 3 1  ON 69
ci_0021                -9.888179e-04 3 1  ON 70
ci_0022                -4.994485e-04 3 1  ON 71
ci_0023                -1.120301e-02 3 1  ON 72
ci_0024                -1.132851e-02 3 1  ON 73
ci_0025                -1.032856e-02 3 1  ON 74
ci_0026                -1.053075e-02 3 1  ON 75
ci_0027                -1.139749e-02 3 1  ON 76
ci_0028                -1.113344e-02 3 1  ON 77
ci_0029                -1.021318e-02 3 1  ON 78
ci_0030                -1.035875e-02 3 1  ON 79
ci_0031                 1.945117e-02 3 1  ON 80
ci_0032                 2.037632e-02 3 1  ON 81
ci_0033                 1.028291e-02 3 1  ON 82
ci_0034                 1.004518e-02 3 1  ON 83
ci_0035                 6.695697e-03 3 1  ON 84
ci_0036                 7.004234e-03 3 1  ON 85
ci_0037                -1.084079e-02 3 1  ON 86
ci_0038                -1.033729e-02 3 1  ON 87
ci_0039                -2.797372e-03 3 1  ON 88
ci_0040                -2.606311e-03 3 1  ON 89
ci_0041                 6.813838e-03 3 1  ON 90
ci_0042                 7.409687e-03 3 1  ON 91
ci_0043                -1.823180e-02 3 1  ON 92
ci_0044                -1.888501e-02 3 1  ON 93
ci_0045                 8.104609e-03 3 1  ON 94
ci_0046                 6.891818e-03 3 1  ON 95
ci_0047                -1.537411e-03 3 1  ON 96
ci_0048                -1.991935e-03 3 1  ON 97
ci_0049                -5.451123e-03 3 1  ON 98
ci_0050                -5.571886e-03 3 1  ON 99
ci_0051                -3.393026e-03 3 1  ON 100
ci_0052                -3.477585e-03 3 1  ON 101
ci_0053                -4.611820e-03 3 1  ON 102
ci_0054                -4.529514e-03 3 1  ON 103
ci_0055                 6.453661e-03 3 1  ON 104
ci_0056                 7.098961e-03 3 1  ON 105
ci_0057                 4.924312e-03 3 1  ON 106
ci_0058                 5.384428e-03 3 1  ON 107
ci_0059                -4.755241e-03 3 1  ON 108
ci_0060                -4.728373e-03 3 1  ON 109
ci_0061                -3.358772e-03 3 1  ON 110
ci_0062                -3.020363e-03 3 1  ON 111
ci_0063                -9.106609e-03 3 1  ON 112
ci_0064                -8.481175e-03 3 1  ON 113
ci_0065                -5.222245e-03 3 1  ON 114
ci_0066                -5.462386e-03 3 1  ON 115
ci_0067                -5.161818e-03 3 1  ON 116
ci_0068                -4.821180e-03 3 1  ON 117
ci_0069                 4.478718e-03 3 1  ON 118
ci_0070                 4.628704e-03 3 1  ON 119
ci_0071                 7.215417e-04 3 1  ON 120
ci_0072                -1.015605e-04 3 1  ON 121
ci_0073                 4.097440e-03 3 1  ON 122
ci_0074                 3.985891e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8376e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8696
    reference variance = 0.144161
====================================================
  Execution time = 2.1446e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3352e-01
  Total weights = 1.951325269e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0780e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322253702697
                                         uncertainty =       0.002160285581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322253702697
                                         uncertainty =       0.002160285581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401414468
  error estimate for blocks of size 2^( 2) =       0.000414164138
  error estimate for blocks of size 2^( 3) =       0.000427632536
  error estimate for blocks of size 2^( 4) =       0.000440295198
  error estimate for blocks of size 2^( 5) =       0.000450498170
  error estimate for blocks of size 2^( 6) =       0.000458823353
  error estimate for blocks of size 2^( 7) =       0.000463878002

      target function =                  N/A
              le_mean =     -16.906411618904
             les_mean =     286.160274007568
             stat err =       0.000453373680
             autocorr =       1.275635407743
              std dev =       0.567685785223
             le_variance =       0.322267150744


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690641161890e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-01, overlap shift 2.3283e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906411618887       residual = 9.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906419972471       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906420351111       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906421535176       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906423423564       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906422423083       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906422535291       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906422736776       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906422428126       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906422313495       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906422652856       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906422612110       residual = 8.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3283e-01 is 9.245320e-04

solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906411618887       residual = 9.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906414814389       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906414990732       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906415372777       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906416158259       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906415731404       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906415637755       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906415840254       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906415695548       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906415690773       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.3132e-01 is 3.146850e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906411618887       residual = 9.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906412539813       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906412600848       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906412705839       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906412812314       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906412935879       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906412794962       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906412846377       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906412835029       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906412818799       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.7253e+00 is 9.006962e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.424435 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7533e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
   uu_0                 3.118681e-01 1 1  ON 0
   uu_1                 1.445297e-01 1 1  ON 1
   uu_2                 4.289302e-02 1 1  ON 2
   uu_3                -1.934869e-02 1 1  ON 3
   uu_4                -6.444591e-02 1 1  ON 4
   uu_5                -9.865337e-02 1 1  ON 5
   uu_6                -1.256242e-01 1 1  ON 6
   uu_7                -1.383493e-01 1 1  ON 7
   uu_8                -1.303711e-01 1 1  ON 8
   uu_9                -9.897799e-02 1 1  ON 9
   ud_0                 4.446485e-01 1 1  ON 10
   ud_1                 1.791380e-01 1 1  ON 11
   ud_2                 5.918823e-02 1 1  ON 12
   ud_3                -1.119044e-02 1 1  ON 13
   ud_4                -6.719401e-02 1 1  ON 14
   ud_5                -1.075388e-01 1 1  ON 15
   ud_6                -1.339198e-01 1 1  ON 16
   ud_7                -1.491958e-01 1 1  ON 17
   ud_8                -1.498342e-01 1 1  ON 18
   ud_9                -1.380077e-01 1 1  ON 19
   eO_0                -7.460315e-01 1 1  ON 20
   eO_1                -4.266709e-01 1 1  ON 21
   eO_2                -1.812962e-02 1 1  ON 22
   eO_3                 2.906549e-01 1 1  ON 23
   eO_4                 5.112842e-01 1 1  ON 24
   eO_5                 4.699318e-01 1 1  ON 25
   eO_6                 2.434086e-01 1 1  ON 26
   eO_7                -5.078639e-02 1 1  ON 27
   eO_8                -2.077946e-01 1 1  ON 28
   eO_9                -6.755613e-02 1 1  ON 29
  eH1_0                -2.456837e-01 1 1  ON 30
  eH1_1                -1.393423e-01 1 1  ON 31
  eH1_2                -9.034409e-02 1 1  ON 32
  eH1_3                -3.591790e-02 1 1  ON 33
  eH1_4                 1.300645e-02 1 1  ON 34
  eH1_5                 4.632169e-02 1 1  ON 35
  eH1_6                 1.012097e-01 1 1  ON 36
  eH1_7                 1.480348e-01 1 1  ON 37
  eH1_8                 1.606940e-01 1 1  ON 38
  eH1_9                 4.624342e-02 1 1  ON 39
  eH2_0                -2.439268e-01 1 1  ON 40
  eH2_1                -1.372757e-01 1 1  ON 41
  eH2_2                -8.793355e-02 1 1  ON 42
  eH2_3                -3.325155e-02 1 1  ON 43
  eH2_4                 1.573314e-02 1 1  ON 44
  eH2_5                 4.990245e-02 1 1  ON 45
  eH2_6                 1.049548e-01 1 1  ON 46
  eH2_7                 1.521250e-01 1 1  ON 47
  eH2_8                 1.667170e-01 1 1  ON 48
  eH2_9                 3.069379e-02 1 1  ON 49
ci_0001                 7.011028e-01 3 1  ON 50
ci_0002                 7.005519e-01 3 1  ON 51
ci_0003                -2.757517e-02 3 1  ON 52
ci_0004                -2.757398e-02 3 1  ON 53
ci_0005                -3.641671e-02 3 1  ON 54
ci_0006                -3.685592e-02 3 1  ON 55
ci_0007                -2.397319e-02 3 1  ON 56
ci_0008                -2.104248e-02 3 1  ON 57
ci_0009                -1.751921e-02 3 1  ON 58
ci_0010                -1.733228e-02 3 1  ON 59
ci_0011                -1.206623e-02 3 1  ON 60
ci_0012                -1.227370e-02 3 1  ON 61
ci_0013                 1.366558e-02 3 1  ON 62
ci_0014                 1.300402e-02 3 1  ON 63
ci_0015                 1.326484e-02 3 1  ON 64
ci_0016                 1.264435e-02 3 1  ON 65
ci_0017                 1.164699e-02 3 1  ON 66
ci_0018                 1.120486e-02 3 1  ON 67
ci_0019                 1.124995e-02 3 1  ON 68
ci_0020                 1.120296e-02 3 1  ON 69
ci_0021                -1.007684e-03 3 1  ON 70
ci_0022                -6.516266e-04 3 1  ON 71
ci_0023                -1.119061e-02 3 1  ON 72
ci_0024                -1.133646e-02 3 1  ON 73
ci_0025                -1.036746e-02 3 1  ON 74
ci_0026                -1.061423e-02 3 1  ON 75
ci_0027                -1.152962e-02 3 1  ON 76
ci_0028                -1.117562e-02 3 1  ON 77
ci_0029                -1.027751e-02 3 1  ON 78
ci_0030                -1.029291e-02 3 1  ON 79
ci_0031                 1.941017e-02 3 1  ON 80
ci_0032                 2.047917e-02 3 1  ON 81
ci_0033                 1.010649e-02 3 1  ON 82
ci_0034                 9.927628e-03 3 1  ON 83
ci_0035                 6.674558e-03 3 1  ON 84
ci_0036                 6.980757e-03 3 1  ON 85
ci_0037                -1.063246e-02 3 1  ON 86
ci_0038                -1.062341e-02 3 1  ON 87
ci_0039                -2.700008e-03 3 1  ON 88
ci_0040                -2.569465e-03 3 1  ON 89
ci_0041                 6.880405e-03 3 1  ON 90
ci_0042                 7.313754e-03 3 1  ON 91
ci_0043                -1.828070e-02 3 1  ON 92
ci_0044                -1.905923e-02 3 1  ON 93
ci_0045                 8.029847e-03 3 1  ON 94
ci_0046                 6.996892e-03 3 1  ON 95
ci_0047                -1.614154e-03 3 1  ON 96
ci_0048                -1.935532e-03 3 1  ON 97
ci_0049                -5.622390e-03 3 1  ON 98
ci_0050                -5.741120e-03 3 1  ON 99
ci_0051                -3.527308e-03 3 1  ON 100
ci_0052                -3.505950e-03 3 1  ON 101
ci_0053                -4.626435e-03 3 1  ON 102
ci_0054                -4.541187e-03 3 1  ON 103
ci_0055                 6.299410e-03 3 1  ON 104
ci_0056                 7.181790e-03 3 1  ON 105
ci_0057                 5.020074e-03 3 1  ON 106
ci_0058                 5.415044e-03 3 1  ON 107
ci_0059                -4.664784e-03 3 1  ON 108
ci_0060                -4.656917e-03 3 1  ON 109
ci_0061                -3.393256e-03 3 1  ON 110
ci_0062                -3.162531e-03 3 1  ON 111
ci_0063                -9.141577e-03 3 1  ON 112
ci_0064                -8.433517e-03 3 1  ON 113
ci_0065                -5.299808e-03 3 1  ON 114
ci_0066                -5.416862e-03 3 1  ON 115
ci_0067                -5.134839e-03 3 1  ON 116
ci_0068                -4.736898e-03 3 1  ON 117
ci_0069                 4.266622e-03 3 1  ON 118
ci_0070                 4.631649e-03 3 1  ON 119
ci_0071                 6.595083e-04 3 1  ON 120
ci_0072                -3.402508e-05 3 1  ON 121
ci_0073                 4.011404e-03 3 1  ON 122
ci_0074                 4.113265e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8852
    reference variance = 0.173049
====================================================
  Execution time = 2.1128e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3839e-01
  Total weights = 1.9514e+06
  Execution time = 1.8875e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322472741178
                                         uncertainty =       0.004241414677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322472741178
                                         uncertainty =       0.004241414677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401526307
  error estimate for blocks of size 2^( 2) =       0.000414618291
  error estimate for blocks of size 2^( 3) =       0.000428115544
  error estimate for blocks of size 2^( 4) =       0.000441891433
  error estimate for blocks of size 2^( 5) =       0.000453541519
  error estimate for blocks of size 2^( 6) =       0.000464427040
  error estimate for blocks of size 2^( 7) =       0.000473706727

      target function =                  N/A
              le_mean =     -16.905636155993
             les_mean =     286.141729750903
             stat err =       0.000458391680
             autocorr =       1.303303143195
              std dev =       0.567843949587
             le_variance =       0.322446751082

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322656170243
                                         uncertainty =       0.004117849090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322656170243
                                         uncertainty =       0.004117849090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401640688
  error estimate for blocks of size 2^( 2) =       0.000414727739
  error estimate for blocks of size 2^( 3) =       0.000428218174
  error estimate for blocks of size 2^( 4) =       0.000441981731
  error estimate for blocks of size 2^( 5) =       0.000453629064
  error estimate for blocks of size 2^( 6) =       0.000464506930
  error estimate for blocks of size 2^( 7) =       0.000473794803

      target function =                  N/A
              le_mean =     -16.905659195162
             les_mean =     286.141295879992
             stat err =       0.000458478132
             autocorr =       1.303052303007
              std dev =       0.568005707470
             le_variance =       0.322630483718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322526646813
                                         uncertainty =       0.004148228028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322526646813
                                         uncertainty =       0.004148228028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401560048
  error estimate for blocks of size 2^( 2) =       0.000414648909
  error estimate for blocks of size 2^( 3) =       0.000428143119
  error estimate for blocks of size 2^( 4) =       0.000441912719
  error estimate for blocks of size 2^( 5) =       0.000453565430
  error estimate for blocks of size 2^( 6) =       0.000464450089
  error estimate for blocks of size 2^( 7) =       0.000473733109

      target function =                  N/A
              le_mean =     -16.905654563429
             les_mean =     286.141073244593
             stat err =       0.000458415337
             autocorr =       1.303218642610
              std dev =       0.567891665440
             le_variance =       0.322500943677

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322465720004
                                         uncertainty =       0.004227506930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322465720004
                                         uncertainty =       0.004227506930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401521965
  error estimate for blocks of size 2^( 2) =       0.000414613563
  error estimate for blocks of size 2^( 3) =       0.000428110908
  error estimate for blocks of size 2^( 4) =       0.000441886865
  error estimate for blocks of size 2^( 5) =       0.000453537968
  error estimate for blocks of size 2^( 6) =       0.000464422360
  error estimate for blocks of size 2^( 7) =       0.000473702702

      target function =                  N/A
              le_mean =     -16.905637932819
             les_mean =     286.139560791582
             stat err =       0.000458387473
             autocorr =       1.303307414307
              std dev =       0.567837808446
             le_variance =       0.322439776701


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905636155993        initial
     2.3283e-01     2.3283e+00             9.2453e-04       -16.905659195162  <--
     9.3132e-01     9.3132e+00             3.1469e-04       -16.905654563429
     3.7253e+00     3.7253e+01             9.0070e-05       -16.905637932819

*****************************************************************************
Applying the update for shift_i =   2.3283e-01     and shift_s =   2.3283e+00
*****************************************************************************

  Execution time = 3.0686e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
   uu_0                 3.120194e-01 1 1  ON 0
   uu_1                 1.445917e-01 1 1  ON 1
   uu_2                 4.293559e-02 1 1  ON 2
   uu_3                -1.937175e-02 1 1  ON 3
   uu_4                -6.459339e-02 1 1  ON 4
   uu_5                -9.883482e-02 1 1  ON 5
   uu_6                -1.258938e-01 1 1  ON 6
   uu_7                -1.386117e-01 1 1  ON 7
   uu_8                -1.306385e-01 1 1  ON 8
   uu_9                -9.906317e-02 1 1  ON 9
   ud_0                 4.448599e-01 1 1  ON 10
   ud_1                 1.793813e-01 1 1  ON 11
   ud_2                 5.922030e-02 1 1  ON 12
   ud_3                -1.119922e-02 1 1  ON 13
   ud_4                -6.725608e-02 1 1  ON 14
   ud_5                -1.076229e-01 1 1  ON 15
   ud_6                -1.339624e-01 1 1  ON 16
   ud_7                -1.492977e-01 1 1  ON 17
   ud_8                -1.498155e-01 1 1  ON 18
   ud_9                -1.381664e-01 1 1  ON 19
   eO_0                -7.466414e-01 1 1  ON 20
   eO_1                -4.268730e-01 1 1  ON 21
   eO_2                -1.819110e-02 1 1  ON 22
   eO_3                 2.905215e-01 1 1  ON 23
   eO_4                 5.118047e-01 1 1  ON 24
   eO_5                 4.705270e-01 1 1  ON 25
   eO_6                 2.438848e-01 1 1  ON 26
   eO_7                -5.051246e-02 1 1  ON 27
   eO_8                -2.082381e-01 1 1  ON 28
   eO_9                -6.794809e-02 1 1  ON 29
  eH1_0                -2.462442e-01 1 1  ON 30
  eH1_1                -1.396556e-01 1 1  ON 31
  eH1_2                -9.070497e-02 1 1  ON 32
  eH1_3                -3.628116e-02 1 1  ON 33
  eH1_4                 1.272567e-02 1 1  ON 34
  eH1_5                 4.605700e-02 1 1  ON 35
  eH1_6                 1.013905e-01 1 1  ON 36
  eH1_7                 1.485424e-01 1 1  ON 37
  eH1_8                 1.613675e-01 1 1  ON 38
  eH1_9                 4.692554e-02 1 1  ON 39
  eH2_0                -2.445086e-01 1 1  ON 40
  eH2_1                -1.376639e-01 1 1  ON 41
  eH2_2                -8.815461e-02 1 1  ON 42
  eH2_3                -3.334404e-02 1 1  ON 43
  eH2_4                 1.571456e-02 1 1  ON 44
  eH2_5                 5.003382e-02 1 1  ON 45
  eH2_6                 1.049222e-01 1 1  ON 46
  eH2_7                 1.522601e-01 1 1  ON 47
  eH2_8                 1.670796e-01 1 1  ON 48
  eH2_9                 3.135453e-02 1 1  ON 49
ci_0001                 7.008841e-01 3 1  ON 50
ci_0002                 7.007633e-01 3 1  ON 51
ci_0003                -2.764963e-02 3 1  ON 52
ci_0004                -2.749429e-02 3 1  ON 53
ci_0005                -3.628185e-02 3 1  ON 54
ci_0006                -3.718710e-02 3 1  ON 55
ci_0007                -2.343996e-02 3 1  ON 56
ci_0008                -2.126461e-02 3 1  ON 57
ci_0009                -1.727610e-02 3 1  ON 58
ci_0010                -1.706636e-02 3 1  ON 59
ci_0011                -1.228930e-02 3 1  ON 60
ci_0012                -1.228821e-02 3 1  ON 61
ci_0013                 1.364068e-02 3 1  ON 62
ci_0014                 1.295964e-02 3 1  ON 63
ci_0015                 1.317887e-02 3 1  ON 64
ci_0016                 1.265935e-02 3 1  ON 65
ci_0017                 1.174968e-02 3 1  ON 66
ci_0018                 1.119997e-02 3 1  ON 67
ci_0019                 1.136259e-02 3 1  ON 68
ci_0020                 1.116301e-02 3 1  ON 69
ci_0021                -1.033416e-03 3 1  ON 70
ci_0022                -9.662527e-04 3 1  ON 71
ci_0023                -1.116423e-02 3 1  ON 72
ci_0024                -1.135068e-02 3 1  ON 73
ci_0025                -1.041972e-02 3 1  ON 74
ci_0026                -1.075356e-02 3 1  ON 75
ci_0027                -1.173561e-02 3 1  ON 76
ci_0028                -1.124482e-02 3 1  ON 77
ci_0029                -1.037525e-02 3 1  ON 78
ci_0030                -1.019232e-02 3 1  ON 79
ci_0031                 1.932149e-02 3 1  ON 80
ci_0032                 2.068647e-02 3 1  ON 81
ci_0033                 9.754989e-03 3 1  ON 82
ci_0034                 9.690707e-03 3 1  ON 83
ci_0035                 6.628534e-03 3 1  ON 84
ci_0036                 6.936699e-03 3 1  ON 85
ci_0037                -1.025502e-02 3 1  ON 86
ci_0038                -1.114075e-02 3 1  ON 87
ci_0039                -2.578635e-03 3 1  ON 88
ci_0040                -2.520852e-03 3 1  ON 89
ci_0041                 6.978223e-03 3 1  ON 90
ci_0042                 7.160962e-03 3 1  ON 91
ci_0043                -1.837581e-02 3 1  ON 92
ci_0044                -1.943390e-02 3 1  ON 93
ci_0045                 7.885872e-03 3 1  ON 94
ci_0046                 7.193032e-03 3 1  ON 95
ci_0047                -1.704841e-03 3 1  ON 96
ci_0048                -1.861600e-03 3 1  ON 97
ci_0049                -5.884331e-03 3 1  ON 98
ci_0050                -6.002001e-03 3 1  ON 99
ci_0051                -3.688140e-03 3 1  ON 100
ci_0052                -3.534392e-03 3 1  ON 101
ci_0053                -4.643361e-03 3 1  ON 102
ci_0054                -4.560162e-03 3 1  ON 103
ci_0055                 6.020449e-03 3 1  ON 104
ci_0056                 7.326892e-03 3 1  ON 105
ci_0057                 5.180473e-03 3 1  ON 106
ci_0058                 5.457635e-03 3 1  ON 107
ci_0059                -4.547136e-03 3 1  ON 108
ci_0060                -4.561294e-03 3 1  ON 109
ci_0061                -3.446895e-03 3 1  ON 110
ci_0062                -3.399216e-03 3 1  ON 111
ci_0063                -9.189551e-03 3 1  ON 112
ci_0064                -8.359124e-03 3 1  ON 113
ci_0065                -5.409152e-03 3 1  ON 114
ci_0066                -5.353143e-03 3 1  ON 115
ci_0067                -5.099966e-03 3 1  ON 116
ci_0068                -4.629135e-03 3 1  ON 117
ci_0069                 3.995513e-03 3 1  ON 118
ci_0070                 4.637483e-03 3 1  ON 119
ci_0071                 5.421023e-04 3 1  ON 120
ci_0072                 6.495670e-05 3 1  ON 121
ci_0073                 3.905089e-03 3 1  ON 122
ci_0074                 4.274422e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8231e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8414
    reference variance = 0.18806
====================================================
  Execution time = 2.1449e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3384e-01
  Total weights = 1.951509697e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1356e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323119854521
                                         uncertainty =       0.002218553747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323119854521
                                         uncertainty =       0.002218553747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401913326
  error estimate for blocks of size 2^( 2) =       0.000415297207
  error estimate for blocks of size 2^( 3) =       0.000428230237
  error estimate for blocks of size 2^( 4) =       0.000440521541
  error estimate for blocks of size 2^( 5) =       0.000452609119
  error estimate for blocks of size 2^( 6) =       0.000460108561
  error estimate for blocks of size 2^( 7) =       0.000466104963

      target function =                  N/A
              le_mean =     -16.905368746310
             les_mean =     286.125332390596
             stat err =       0.000454836046
             autocorr =       1.280692713994
              std dev =       0.568391276591
             le_variance =       0.323068643305


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690536874631e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-02, overlap shift 5.8208e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905368746277       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905375903318       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905377468003       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905382362776       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905378509625       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905381446412       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905383171501       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905387299059       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905389945701       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905390768260       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905390456808       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905389991192       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905389497890       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905388404238       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905388375769       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905388571198       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905389065107       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905389171224       residual = 7.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.8208e-02 is 3.739708e-03

solving harmonic davidson linear method for identity shift 2.3283e-01, overlap shift 2.3283e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905368746277       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905373080223       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905373418922       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905375861848       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905373715223       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905374999270       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905375998711       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905377079846       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905377499396       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905377568532       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905377350282       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905377217727       residual = 7.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3283e-01 is 1.022202e-03

solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905368746277       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905370427533       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905370422346       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905371010488       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905370246585       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905370703169       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905370680305       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905371065879       residual = 8.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905371141395       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905371154957       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.3132e-01 is 3.859957e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.431504 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7596e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
   uu_0                 3.120852e-01 1 1  ON 0
   uu_1                 1.446536e-01 1 1  ON 1
   uu_2                 4.307833e-02 1 1  ON 2
   uu_3                -1.931974e-02 1 1  ON 3
   uu_4                -6.452433e-02 1 1  ON 4
   uu_5                -9.883156e-02 1 1  ON 5
   uu_6                -1.258327e-01 1 1  ON 6
   uu_7                -1.387304e-01 1 1  ON 7
   uu_8                -1.309249e-01 1 1  ON 8
   uu_9                -9.973432e-02 1 1  ON 9
   ud_0                 4.451969e-01 1 1  ON 10
   ud_1                 1.796719e-01 1 1  ON 11
   ud_2                 5.953196e-02 1 1  ON 12
   ud_3                -1.091832e-02 1 1  ON 13
   ud_4                -6.716289e-02 1 1  ON 14
   ud_5                -1.078370e-01 1 1  ON 15
   ud_6                -1.342052e-01 1 1  ON 16
   ud_7                -1.494389e-01 1 1  ON 17
   ud_8                -1.502703e-01 1 1  ON 18
   ud_9                -1.384482e-01 1 1  ON 19
   eO_0                -7.467699e-01 1 1  ON 20
   eO_1                -4.273421e-01 1 1  ON 21
   eO_2                -1.856941e-02 1 1  ON 22
   eO_3                 2.906503e-01 1 1  ON 23
   eO_4                 5.125252e-01 1 1  ON 24
   eO_5                 4.712032e-01 1 1  ON 25
   eO_6                 2.443057e-01 1 1  ON 26
   eO_7                -5.011498e-02 1 1  ON 27
   eO_8                -2.089229e-01 1 1  ON 28
   eO_9                -6.858694e-02 1 1  ON 29
  eH1_0                -2.467523e-01 1 1  ON 30
  eH1_1                -1.406778e-01 1 1  ON 31
  eH1_2                -9.119854e-02 1 1  ON 32
  eH1_3                -3.664131e-02 1 1  ON 33
  eH1_4                 1.254960e-02 1 1  ON 34
  eH1_5                 4.587465e-02 1 1  ON 35
  eH1_6                 1.018100e-01 1 1  ON 36
  eH1_7                 1.490107e-01 1 1  ON 37
  eH1_8                 1.621881e-01 1 1  ON 38
  eH1_9                 4.784550e-02 1 1  ON 39
  eH2_0                -2.451718e-01 1 1  ON 40
  eH2_1                -1.378226e-01 1 1  ON 41
  eH2_2                -8.835715e-02 1 1  ON 42
  eH2_3                -3.363762e-02 1 1  ON 43
  eH2_4                 1.553048e-02 1 1  ON 44
  eH2_5                 4.986237e-02 1 1  ON 45
  eH2_6                 1.051685e-01 1 1  ON 46
  eH2_7                 1.523867e-01 1 1  ON 47
  eH2_8                 1.676140e-01 1 1  ON 48
  eH2_9                 3.216991e-02 1 1  ON 49
ci_0001                 7.006590e-01 3 1  ON 50
ci_0002                 7.009856e-01 3 1  ON 51
ci_0003                -2.769016e-02 3 1  ON 52
ci_0004                -2.723719e-02 3 1  ON 53
ci_0005                -3.639869e-02 3 1  ON 54
ci_0006                -3.701175e-02 3 1  ON 55
ci_0007                -2.366313e-02 3 1  ON 56
ci_0008                -2.105917e-02 3 1  ON 57
ci_0009                -1.780333e-02 3 1  ON 58
ci_0010                -1.715836e-02 3 1  ON 59
ci_0011                -1.209565e-02 3 1  ON 60
ci_0012                -1.230975e-02 3 1  ON 61
ci_0013                 1.325713e-02 3 1  ON 62
ci_0014                 1.327885e-02 3 1  ON 63
ci_0015                 1.314385e-02 3 1  ON 64
ci_0016                 1.308148e-02 3 1  ON 65
ci_0017                 1.188375e-02 3 1  ON 66
ci_0018                 1.128584e-02 3 1  ON 67
ci_0019                 1.125330e-02 3 1  ON 68
ci_0020                 1.141037e-02 3 1  ON 69
ci_0021                -1.287920e-03 3 1  ON 70
ci_0022                -1.091194e-03 3 1  ON 71
ci_0023                -1.097213e-02 3 1  ON 72
ci_0024                -1.160115e-02 3 1  ON 73
ci_0025                -1.065213e-02 3 1  ON 74
ci_0026                -9.776994e-03 3 1  ON 75
ci_0027                -1.150889e-02 3 1  ON 76
ci_0028                -1.133453e-02 3 1  ON 77
ci_0029                -1.070230e-02 3 1  ON 78
ci_0030                -1.036920e-02 3 1  ON 79
ci_0031                 1.933303e-02 3 1  ON 80
ci_0032                 2.087100e-02 3 1  ON 81
ci_0033                 9.824801e-03 3 1  ON 82
ci_0034                 9.711812e-03 3 1  ON 83
ci_0035                 7.012543e-03 3 1  ON 84
ci_0036                 6.949592e-03 3 1  ON 85
ci_0037                -1.072020e-02 3 1  ON 86
ci_0038                -1.057358e-02 3 1  ON 87
ci_0039                -2.585496e-03 3 1  ON 88
ci_0040                -2.640597e-03 3 1  ON 89
ci_0041                 6.797553e-03 3 1  ON 90
ci_0042                 7.309594e-03 3 1  ON 91
ci_0043                -1.843184e-02 3 1  ON 92
ci_0044                -1.890498e-02 3 1  ON 93
ci_0045                 7.627637e-03 3 1  ON 94
ci_0046                 7.393481e-03 3 1  ON 95
ci_0047                -1.786573e-03 3 1  ON 96
ci_0048                -1.936257e-03 3 1  ON 97
ci_0049                -5.946485e-03 3 1  ON 98
ci_0050                -6.362891e-03 3 1  ON 99
ci_0051                -3.402205e-03 3 1  ON 100
ci_0052                -3.701640e-03 3 1  ON 101
ci_0053                -4.564362e-03 3 1  ON 102
ci_0054                -4.506715e-03 3 1  ON 103
ci_0055                 5.950440e-03 3 1  ON 104
ci_0056                 6.502373e-03 3 1  ON 105
ci_0057                 5.382894e-03 3 1  ON 106
ci_0058                 4.990085e-03 3 1  ON 107
ci_0059                -4.685728e-03 3 1  ON 108
ci_0060                -4.478261e-03 3 1  ON 109
ci_0061                -3.528111e-03 3 1  ON 110
ci_0062                -3.284083e-03 3 1  ON 111
ci_0063                -9.241301e-03 3 1  ON 112
ci_0064                -8.705855e-03 3 1  ON 113
ci_0065                -5.533038e-03 3 1  ON 114
ci_0066                -5.430243e-03 3 1  ON 115
ci_0067                -4.831091e-03 3 1  ON 116
ci_0068                -4.882102e-03 3 1  ON 117
ci_0069                 4.285043e-03 3 1  ON 118
ci_0070                 4.638761e-03 3 1  ON 119
ci_0071                 1.337460e-05 3 1  ON 120
ci_0072                 1.278562e-04 3 1  ON 121
ci_0073                 4.235673e-03 3 1  ON 122
ci_0074                 4.230780e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9137
    reference variance = 0.21039
====================================================
  Execution time = 2.1283e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3202e-01
  Total weights = 1.9515e+06
  Execution time = 1.8913e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326398719688
                                         uncertainty =       0.005580536720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326398719688
                                         uncertainty =       0.005580536720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403936493
  error estimate for blocks of size 2^( 2) =       0.000417073131
  error estimate for blocks of size 2^( 3) =       0.000430406964
  error estimate for blocks of size 2^( 4) =       0.000443366074
  error estimate for blocks of size 2^( 5) =       0.000454640294
  error estimate for blocks of size 2^( 6) =       0.000462495912
  error estimate for blocks of size 2^( 7) =       0.000468986677

      target function =                  N/A
              le_mean =     -16.906273654132
             les_mean =     291.447276487976
             stat err =       0.000457372239
             autocorr =       1.282074966392
              std dev =       0.571252466887
             le_variance =       0.326329380924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320773879543
                                         uncertainty =       0.002135319152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320773879543
                                         uncertainty =       0.002135319152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400444225
  error estimate for blocks of size 2^( 2) =       0.000413677038
  error estimate for blocks of size 2^( 3) =       0.000427116321
  error estimate for blocks of size 2^( 4) =       0.000439970914
  error estimate for blocks of size 2^( 5) =       0.000451296670
  error estimate for blocks of size 2^( 6) =       0.000459371007
  error estimate for blocks of size 2^( 7) =       0.000465653295

      target function =                  N/A
              le_mean =     -16.906210653089
             les_mean =     286.154437043279
             stat err =       0.000454072972
             autocorr =       1.285781676109
              std dev =       0.566313654640
             le_variance =       0.320711155431

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320663697680
                                         uncertainty =       0.002134527478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320663697680
                                         uncertainty =       0.002134527478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400375373
  error estimate for blocks of size 2^( 2) =       0.000413603785
  error estimate for blocks of size 2^( 3) =       0.000427040982
  error estimate for blocks of size 2^( 4) =       0.000439895509
  error estimate for blocks of size 2^( 5) =       0.000451223162
  error estimate for blocks of size 2^( 6) =       0.000459303766
  error estimate for blocks of size 2^( 7) =       0.000465568202

      target function =                  N/A
              le_mean =     -16.906211158380
             les_mean =     286.157521073446
             stat err =       0.000453997660
             autocorr =       1.285797321148
              std dev =       0.566216282069
             le_variance =       0.320600878080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321340597720
                                         uncertainty =       0.002139345682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321340597720
                                         uncertainty =       0.002139345682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400797891
  error estimate for blocks of size 2^( 2) =       0.000414020462
  error estimate for blocks of size 2^( 3) =       0.000427473822
  error estimate for blocks of size 2^( 4) =       0.000440335835
  error estimate for blocks of size 2^( 5) =       0.000451674011
  error estimate for blocks of size 2^( 6) =       0.000459711527
  error estimate for blocks of size 2^( 7) =       0.000466111227

      target function =                  N/A
              le_mean =     -16.906199226093
             les_mean =     286.267221822468
             stat err =       0.000454458150
             autocorr =       1.285691988330
              std dev =       0.566813812953
             le_variance =       0.321277898554


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906273654132        initial  <--
     5.8208e-02     5.8208e-01             3.7397e-03       -16.906210653089
     2.3283e-01     2.3283e+00             1.0222e-03       -16.906211158380
     9.3132e-01     9.3132e+00             3.8600e-04       -16.906199226093

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8239
  </log>
  <optVariables href="H2O.s036.opt.xml">
   uu_0                 3.120194e-01 1 1  ON 0
   uu_1                 1.445917e-01 1 1  ON 1
   uu_2                 4.293559e-02 1 1  ON 2
   uu_3                -1.937175e-02 1 1  ON 3
   uu_4                -6.459339e-02 1 1  ON 4
   uu_5                -9.883482e-02 1 1  ON 5
   uu_6                -1.258938e-01 1 1  ON 6
   uu_7                -1.386117e-01 1 1  ON 7
   uu_8                -1.306385e-01 1 1  ON 8
   uu_9                -9.906317e-02 1 1  ON 9
   ud_0                 4.448599e-01 1 1  ON 10
   ud_1                 1.793813e-01 1 1  ON 11
   ud_2                 5.922030e-02 1 1  ON 12
   ud_3                -1.119922e-02 1 1  ON 13
   ud_4                -6.725608e-02 1 1  ON 14
   ud_5                -1.076229e-01 1 1  ON 15
   ud_6                -1.339624e-01 1 1  ON 16
   ud_7                -1.492977e-01 1 1  ON 17
   ud_8                -1.498155e-01 1 1  ON 18
   ud_9                -1.381664e-01 1 1  ON 19
   eO_0                -7.466414e-01 1 1  ON 20
   eO_1                -4.268730e-01 1 1  ON 21
   eO_2                -1.819110e-02 1 1  ON 22
   eO_3                 2.905215e-01 1 1  ON 23
   eO_4                 5.118047e-01 1 1  ON 24
   eO_5                 4.705270e-01 1 1  ON 25
   eO_6                 2.438848e-01 1 1  ON 26
   eO_7                -5.051246e-02 1 1  ON 27
   eO_8                -2.082381e-01 1 1  ON 28
   eO_9                -6.794809e-02 1 1  ON 29
  eH1_0                -2.462442e-01 1 1  ON 30
  eH1_1                -1.396556e-01 1 1  ON 31
  eH1_2                -9.070497e-02 1 1  ON 32
  eH1_3                -3.628116e-02 1 1  ON 33
  eH1_4                 1.272567e-02 1 1  ON 34
  eH1_5                 4.605700e-02 1 1  ON 35
  eH1_6                 1.013905e-01 1 1  ON 36
  eH1_7                 1.485424e-01 1 1  ON 37
  eH1_8                 1.613675e-01 1 1  ON 38
  eH1_9                 4.692554e-02 1 1  ON 39
  eH2_0                -2.445086e-01 1 1  ON 40
  eH2_1                -1.376639e-01 1 1  ON 41
  eH2_2                -8.815461e-02 1 1  ON 42
  eH2_3                -3.334404e-02 1 1  ON 43
  eH2_4                 1.571456e-02 1 1  ON 44
  eH2_5                 5.003382e-02 1 1  ON 45
  eH2_6                 1.049222e-01 1 1  ON 46
  eH2_7                 1.522601e-01 1 1  ON 47
  eH2_8                 1.670796e-01 1 1  ON 48
  eH2_9                 3.135453e-02 1 1  ON 49
ci_0001                 7.008841e-01 3 1  ON 50
ci_0002                 7.007633e-01 3 1  ON 51
ci_0003                -2.764963e-02 3 1  ON 52
ci_0004                -2.749429e-02 3 1  ON 53
ci_0005                -3.628185e-02 3 1  ON 54
ci_0006                -3.718710e-02 3 1  ON 55
ci_0007                -2.343996e-02 3 1  ON 56
ci_0008                -2.126461e-02 3 1  ON 57
ci_0009                -1.727610e-02 3 1  ON 58
ci_0010                -1.706636e-02 3 1  ON 59
ci_0011                -1.228930e-02 3 1  ON 60
ci_0012                -1.228821e-02 3 1  ON 61
ci_0013                 1.364068e-02 3 1  ON 62
ci_0014                 1.295964e-02 3 1  ON 63
ci_0015                 1.317887e-02 3 1  ON 64
ci_0016                 1.265935e-02 3 1  ON 65
ci_0017                 1.174968e-02 3 1  ON 66
ci_0018                 1.119997e-02 3 1  ON 67
ci_0019                 1.136259e-02 3 1  ON 68
ci_0020                 1.116301e-02 3 1  ON 69
ci_0021                -1.033416e-03 3 1  ON 70
ci_0022                -9.662527e-04 3 1  ON 71
ci_0023                -1.116423e-02 3 1  ON 72
ci_0024                -1.135068e-02 3 1  ON 73
ci_0025                -1.041972e-02 3 1  ON 74
ci_0026                -1.075356e-02 3 1  ON 75
ci_0027                -1.173561e-02 3 1  ON 76
ci_0028                -1.124482e-02 3 1  ON 77
ci_0029                -1.037525e-02 3 1  ON 78
ci_0030                -1.019232e-02 3 1  ON 79
ci_0031                 1.932149e-02 3 1  ON 80
ci_0032                 2.068647e-02 3 1  ON 81
ci_0033                 9.754989e-03 3 1  ON 82
ci_0034                 9.690707e-03 3 1  ON 83
ci_0035                 6.628534e-03 3 1  ON 84
ci_0036                 6.936699e-03 3 1  ON 85
ci_0037                -1.025502e-02 3 1  ON 86
ci_0038                -1.114075e-02 3 1  ON 87
ci_0039                -2.578635e-03 3 1  ON 88
ci_0040                -2.520852e-03 3 1  ON 89
ci_0041                 6.978223e-03 3 1  ON 90
ci_0042                 7.160962e-03 3 1  ON 91
ci_0043                -1.837581e-02 3 1  ON 92
ci_0044                -1.943390e-02 3 1  ON 93
ci_0045                 7.885872e-03 3 1  ON 94
ci_0046                 7.193032e-03 3 1  ON 95
ci_0047                -1.704841e-03 3 1  ON 96
ci_0048                -1.861600e-03 3 1  ON 97
ci_0049                -5.884331e-03 3 1  ON 98
ci_0050                -6.002001e-03 3 1  ON 99
ci_0051                -3.688140e-03 3 1  ON 100
ci_0052                -3.534392e-03 3 1  ON 101
ci_0053                -4.643361e-03 3 1  ON 102
ci_0054                -4.560162e-03 3 1  ON 103
ci_0055                 6.020449e-03 3 1  ON 104
ci_0056                 7.326892e-03 3 1  ON 105
ci_0057                 5.180473e-03 3 1  ON 106
ci_0058                 5.457635e-03 3 1  ON 107
ci_0059                -4.547136e-03 3 1  ON 108
ci_0060                -4.561294e-03 3 1  ON 109
ci_0061                -3.446895e-03 3 1  ON 110
ci_0062                -3.399216e-03 3 1  ON 111
ci_0063                -9.189551e-03 3 1  ON 112
ci_0064                -8.359124e-03 3 1  ON 113
ci_0065                -5.409152e-03 3 1  ON 114
ci_0066                -5.353143e-03 3 1  ON 115
ci_0067                -5.099966e-03 3 1  ON 116
ci_0068                -4.629135e-03 3 1  ON 117
ci_0069                 3.995513e-03 3 1  ON 118
ci_0070                 4.637483e-03 3 1  ON 119
ci_0071                 5.421023e-04 3 1  ON 120
ci_0072                 6.495670e-05 3 1  ON 121
ci_0073                 3.905089e-03 3 1  ON 122
ci_0074                 4.274422e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8427e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.0003
    reference variance = 0.225009
====================================================
  Execution time = 2.3480e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3205e-01
  Total weights = 1.951554172e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9916e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320710446476
                                         uncertainty =       0.001992757074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320710446476
                                         uncertainty =       0.001992757074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400406504
  error estimate for blocks of size 2^( 2) =       0.000413439203
  error estimate for blocks of size 2^( 3) =       0.000426567013
  error estimate for blocks of size 2^( 4) =       0.000438313094
  error estimate for blocks of size 2^( 5) =       0.000449558926
  error estimate for blocks of size 2^( 6) =       0.000457938518
  error estimate for blocks of size 2^( 7) =       0.000463852569

      target function =                  N/A
              le_mean =     -16.906365052337
             les_mean =     286.157230406174
             stat err =       0.000452415777
             autocorr =       1.276654074414
              std dev =       0.566260308597
             le_variance =       0.320650737093


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690636505234e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906365052343       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906374060159       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906374941819       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906375710714       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906375990926       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906375931237       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906375835319       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906375986759       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906376228358       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906376304122       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906376277946       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.8208e-01 is 7.731726e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906365052343       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906367876776       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906368116712       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906368383197       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906368425241       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906368281264       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906368306385       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906368350450       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906368403691       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906368399821       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3283e+00 is 2.301751e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906365052343       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906365806372       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906365868771       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906365941992       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906365950606       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906365900876       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906365915283       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906365920826       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906365933324       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906365933842       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.3132e+00 is 6.135775e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.440736 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9488e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
   uu_0                 3.120153e-01 1 1  ON 0
   uu_1                 1.446061e-01 1 1  ON 1
   uu_2                 4.295469e-02 1 1  ON 2
   uu_3                -1.935583e-02 1 1  ON 3
   uu_4                -6.459383e-02 1 1  ON 4
   uu_5                -9.883548e-02 1 1  ON 5
   uu_6                -1.259114e-01 1 1  ON 6
   uu_7                -1.386306e-01 1 1  ON 7
   uu_8                -1.306643e-01 1 1  ON 8
   uu_9                -9.911218e-02 1 1  ON 9
   ud_0                 4.448983e-01 1 1  ON 10
   ud_1                 1.793738e-01 1 1  ON 11
   ud_2                 5.923478e-02 1 1  ON 12
   ud_3                -1.119363e-02 1 1  ON 13
   ud_4                -6.725382e-02 1 1  ON 14
   ud_5                -1.076514e-01 1 1  ON 15
   ud_6                -1.339520e-01 1 1  ON 16
   ud_7                -1.493374e-01 1 1  ON 17
   ud_8                -1.498282e-01 1 1  ON 18
   ud_9                -1.381679e-01 1 1  ON 19
   eO_0                -7.466528e-01 1 1  ON 20
   eO_1                -4.269091e-01 1 1  ON 21
   eO_2                -1.822957e-02 1 1  ON 22
   eO_3                 2.905193e-01 1 1  ON 23
   eO_4                 5.118550e-01 1 1  ON 24
   eO_5                 4.706124e-01 1 1  ON 25
   eO_6                 2.439417e-01 1 1  ON 26
   eO_7                -5.050666e-02 1 1  ON 27
   eO_8                -2.082895e-01 1 1  ON 28
   eO_9                -6.800039e-02 1 1  ON 29
  eH1_0                -2.462930e-01 1 1  ON 30
  eH1_1                -1.397718e-01 1 1  ON 31
  eH1_2                -9.075084e-02 1 1  ON 32
  eH1_3                -3.631428e-02 1 1  ON 33
  eH1_4                 1.272452e-02 1 1  ON 34
  eH1_5                 4.603460e-02 1 1  ON 35
  eH1_6                 1.014156e-01 1 1  ON 36
  eH1_7                 1.486034e-01 1 1  ON 37
  eH1_8                 1.614629e-01 1 1  ON 38
  eH1_9                 4.700592e-02 1 1  ON 39
  eH2_0                -2.445328e-01 1 1  ON 40
  eH2_1                -1.376443e-01 1 1  ON 41
  eH2_2                -8.819008e-02 1 1  ON 42
  eH2_3                -3.341777e-02 1 1  ON 43
  eH2_4                 1.569678e-02 1 1  ON 44
  eH2_5                 5.000347e-02 1 1  ON 45
  eH2_6                 1.049126e-01 1 1  ON 46
  eH2_7                 1.522966e-01 1 1  ON 47
  eH2_8                 1.671345e-01 1 1  ON 48
  eH2_9                 3.143271e-02 1 1  ON 49
ci_0001                 7.009033e-01 3 1  ON 50
ci_0002                 7.007422e-01 3 1  ON 51
ci_0003                -2.770443e-02 3 1  ON 52
ci_0004                -2.741771e-02 3 1  ON 53
ci_0005                -3.628267e-02 3 1  ON 54
ci_0006                -3.720216e-02 3 1  ON 55
ci_0007                -2.337433e-02 3 1  ON 56
ci_0008                -2.133996e-02 3 1  ON 57
ci_0009                -1.724173e-02 3 1  ON 58
ci_0010                -1.704979e-02 3 1  ON 59
ci_0011                -1.235597e-02 3 1  ON 60
ci_0012                -1.226420e-02 3 1  ON 61
ci_0013                 1.364749e-02 3 1  ON 62
ci_0014                 1.307762e-02 3 1  ON 63
ci_0015                 1.317429e-02 3 1  ON 64
ci_0016                 1.265278e-02 3 1  ON 65
ci_0017                 1.171775e-02 3 1  ON 66
ci_0018                 1.119913e-02 3 1  ON 67
ci_0019                 1.137058e-02 3 1  ON 68
ci_0020                 1.107414e-02 3 1  ON 69
ci_0021                -9.941267e-04 3 1  ON 70
ci_0022                -9.857562e-04 3 1  ON 71
ci_0023                -1.114962e-02 3 1  ON 72
ci_0024                -1.135727e-02 3 1  ON 73
ci_0025                -1.064990e-02 3 1  ON 74
ci_0026                -1.067122e-02 3 1  ON 75
ci_0027                -1.169171e-02 3 1  ON 76
ci_0028                -1.126373e-02 3 1  ON 77
ci_0029                -1.040053e-02 3 1  ON 78
ci_0030                -1.024625e-02 3 1  ON 79
ci_0031                 1.949061e-02 3 1  ON 80
ci_0032                 2.074414e-02 3 1  ON 81
ci_0033                 9.926510e-03 3 1  ON 82
ci_0034                 9.749023e-03 3 1  ON 83
ci_0035                 6.668490e-03 3 1  ON 84
ci_0036                 6.973807e-03 3 1  ON 85
ci_0037                -1.013637e-02 3 1  ON 86
ci_0038                -1.111567e-02 3 1  ON 87
ci_0039                -2.502318e-03 3 1  ON 88
ci_0040                -2.516681e-03 3 1  ON 89
ci_0041                 6.840595e-03 3 1  ON 90
ci_0042                 7.182172e-03 3 1  ON 91
ci_0043                -1.832949e-02 3 1  ON 92
ci_0044                -1.939776e-02 3 1  ON 93
ci_0045                 7.896603e-03 3 1  ON 94
ci_0046                 7.149184e-03 3 1  ON 95
ci_0047                -1.594304e-03 3 1  ON 96
ci_0048                -1.843882e-03 3 1  ON 97
ci_0049                -5.901030e-03 3 1  ON 98
ci_0050                -6.050831e-03 3 1  ON 99
ci_0051                -3.638447e-03 3 1  ON 100
ci_0052                -3.584897e-03 3 1  ON 101
ci_0053                -4.560945e-03 3 1  ON 102
ci_0054                -4.626672e-03 3 1  ON 103
ci_0055                 5.792243e-03 3 1  ON 104
ci_0056                 7.248258e-03 3 1  ON 105
ci_0057                 5.289135e-03 3 1  ON 106
ci_0058                 5.243513e-03 3 1  ON 107
ci_0059                -4.541207e-03 3 1  ON 108
ci_0060                -4.567992e-03 3 1  ON 109
ci_0061                -3.470351e-03 3 1  ON 110
ci_0062                -3.423501e-03 3 1  ON 111
ci_0063                -9.086016e-03 3 1  ON 112
ci_0064                -8.391983e-03 3 1  ON 113
ci_0065                -5.403330e-03 3 1  ON 114
ci_0066                -5.322860e-03 3 1  ON 115
ci_0067                -5.126937e-03 3 1  ON 116
ci_0068                -4.652607e-03 3 1  ON 117
ci_0069                 3.842148e-03 3 1  ON 118
ci_0070                 4.600286e-03 3 1  ON 119
ci_0071                 5.604504e-04 3 1  ON 120
ci_0072                 1.404141e-04 3 1  ON 121
ci_0073                 4.000931e-03 3 1  ON 122
ci_0074                 4.267248e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9222
    reference variance = 0.184088
====================================================
  Execution time = 2.1535e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3394e-01
  Total weights = 1.9516e+06
  Execution time = 1.8917e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321089602904
                                         uncertainty =       0.001898799822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321089602904
                                         uncertainty =       0.001898799822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400860288
  error estimate for blocks of size 2^( 2) =       0.000413705467
  error estimate for blocks of size 2^( 3) =       0.000426760448
  error estimate for blocks of size 2^( 4) =       0.000439361899
  error estimate for blocks of size 2^( 5) =       0.000448880013
  error estimate for blocks of size 2^( 6) =       0.000456783144
  error estimate for blocks of size 2^( 7) =       0.000461525529

      target function =                  N/A
              le_mean =     -16.904718567132
             les_mean =     286.108690913985
             stat err =       0.000451637646
             autocorr =       1.269387456262
              std dev =       0.566902056003
             le_variance =       0.321377941101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321220051253
                                         uncertainty =       0.001900433142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321220051253
                                         uncertainty =       0.001900433142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400937580
  error estimate for blocks of size 2^( 2) =       0.000413803274
  error estimate for blocks of size 2^( 3) =       0.000426863667
  error estimate for blocks of size 2^( 4) =       0.000439479349
  error estimate for blocks of size 2^( 5) =       0.000448982966
  error estimate for blocks of size 2^( 6) =       0.000456887816
  error estimate for blocks of size 2^( 7) =       0.000461667624

      target function =                  N/A
              le_mean =     -16.904723542044
             les_mean =     286.104673487486
             stat err =       0.000451754438
             autocorr =       1.269554432185
              std dev =       0.567011363928
             le_variance =       0.321501886824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321161073607
                                         uncertainty =       0.001899830896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321161073607
                                         uncertainty =       0.001899830896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400902755
  error estimate for blocks of size 2^( 2) =       0.000413760635
  error estimate for blocks of size 2^( 3) =       0.000426818953
  error estimate for blocks of size 2^( 4) =       0.000439430305
  error estimate for blocks of size 2^( 5) =       0.000448940195
  error estimate for blocks of size 2^( 6) =       0.000456844934
  error estimate for blocks of size 2^( 7) =       0.000461609864

      target function =                  N/A
              le_mean =     -16.904718922453
             les_mean =     286.103667496123
             stat err =       0.000451706324
             autocorr =       1.269504547803
              std dev =       0.566962113124
             le_variance =       0.321446037718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321096138690
                                         uncertainty =       0.001898923771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321096138690
                                         uncertainty =       0.001898923771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400864098
  error estimate for blocks of size 2^( 2) =       0.000413710814
  error estimate for blocks of size 2^( 3) =       0.000426766226
  error estimate for blocks of size 2^( 4) =       0.000439369129
  error estimate for blocks of size 2^( 5) =       0.000448885029
  error estimate for blocks of size 2^( 6) =       0.000456786135
  error estimate for blocks of size 2^( 7) =       0.000461532020

      target function =                  N/A
              le_mean =     -16.904718401157
             les_mean =     286.117368884238
             stat err =       0.000451643078
             autocorr =       1.269393863765
              std dev =       0.566907443730
             le_variance =       0.321384049757


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904718567132        initial
     5.8208e-01     5.8208e+00             7.7317e-04       -16.904723542044  <--
     2.3283e+00     2.3283e+01             2.3018e-04       -16.904718922453
     9.3132e+00     9.3132e+01             6.1358e-05       -16.904718401157

*****************************************************************************
Applying the update for shift_i =   5.8208e-01     and shift_s =   5.8208e+00
*****************************************************************************

  Execution time = 3.1089e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
   uu_0                 3.120152e-01 1 1  ON 0
   uu_1                 1.446516e-01 1 1  ON 1
   uu_2                 4.300661e-02 1 1  ON 2
   uu_3                -1.931109e-02 1 1  ON 3
   uu_4                -6.459018e-02 1 1  ON 4
   uu_5                -9.884829e-02 1 1  ON 5
   uu_6                -1.259643e-01 1 1  ON 6
   uu_7                -1.386881e-01 1 1  ON 7
   uu_8                -1.307405e-01 1 1  ON 8
   uu_9                -9.925875e-02 1 1  ON 9
   ud_0                 4.449704e-01 1 1  ON 10
   ud_1                 1.793816e-01 1 1  ON 11
   ud_2                 5.926923e-02 1 1  ON 12
   ud_3                -1.117348e-02 1 1  ON 13
   ud_4                -6.725135e-02 1 1  ON 14
   ud_5                -1.077140e-01 1 1  ON 15
   ud_6                -1.339431e-01 1 1  ON 16
   ud_7                -1.494370e-01 1 1  ON 17
   ud_8                -1.498623e-01 1 1  ON 18
   ud_9                -1.381737e-01 1 1  ON 19
   eO_0                -7.467078e-01 1 1  ON 20
   eO_1                -4.270096e-01 1 1  ON 21
   eO_2                -1.832597e-02 1 1  ON 22
   eO_3                 2.905111e-01 1 1  ON 23
   eO_4                 5.120044e-01 1 1  ON 24
   eO_5                 4.708632e-01 1 1  ON 25
   eO_6                 2.441138e-01 1 1  ON 26
   eO_7                -5.048667e-02 1 1  ON 27
   eO_8                -2.084442e-01 1 1  ON 28
   eO_9                -6.815772e-02 1 1  ON 29
  eH1_0                -2.464521e-01 1 1  ON 30
  eH1_1                -1.400701e-01 1 1  ON 31
  eH1_2                -9.090097e-02 1 1  ON 32
  eH1_3                -3.642120e-02 1 1  ON 33
  eH1_4                 1.270673e-02 1 1  ON 34
  eH1_5                 4.596918e-02 1 1  ON 35
  eH1_6                 1.014867e-01 1 1  ON 36
  eH1_7                 1.487854e-01 1 1  ON 37
  eH1_8                 1.617494e-01 1 1  ON 38
  eH1_9                 4.724684e-02 1 1  ON 39
  eH2_0                -2.445929e-01 1 1  ON 40
  eH2_1                -1.376397e-01 1 1  ON 41
  eH2_2                -8.829354e-02 1 1  ON 42
  eH2_3                -3.360376e-02 1 1  ON 43
  eH2_4                 1.562695e-02 1 1  ON 44
  eH2_5                 4.992573e-02 1 1  ON 45
  eH2_6                 1.048877e-01 1 1  ON 46
  eH2_7                 1.524068e-01 1 1  ON 47
  eH2_8                 1.673007e-01 1 1  ON 48
  eH2_9                 3.166764e-02 1 1  ON 49
ci_0001                 7.009623e-01 3 1  ON 50
ci_0002                 7.006756e-01 3 1  ON 51
ci_0003                -2.783495e-02 3 1  ON 52
ci_0004                -2.723558e-02 3 1  ON 53
ci_0005                -3.629127e-02 3 1  ON 54
ci_0006                -3.724331e-02 3 1  ON 55
ci_0007                -2.321832e-02 3 1  ON 56
ci_0008                -2.153733e-02 3 1  ON 57
ci_0009                -1.717189e-02 3 1  ON 58
ci_0010                -1.701191e-02 3 1  ON 59
ci_0011                -1.250488e-02 3 1  ON 60
ci_0012                -1.220911e-02 3 1  ON 61
ci_0013                 1.366044e-02 3 1  ON 62
ci_0014                 1.333765e-02 3 1  ON 63
ci_0015                 1.316325e-02 3 1  ON 64
ci_0016                 1.263694e-02 3 1  ON 65
ci_0017                 1.164735e-02 3 1  ON 66
ci_0018                 1.119618e-02 3 1  ON 67
ci_0019                 1.138839e-02 3 1  ON 68
ci_0020                 1.087600e-02 3 1  ON 69
ci_0021                -8.989646e-04 3 1  ON 70
ci_0022                -1.036274e-03 3 1  ON 71
ci_0023                -1.112104e-02 3 1  ON 72
ci_0024                -1.137193e-02 3 1  ON 73
ci_0025                -1.115848e-02 3 1  ON 74
ci_0026                -1.049066e-02 3 1  ON 75
ci_0027                -1.159765e-02 3 1  ON 76
ci_0028                -1.130538e-02 3 1  ON 77
ci_0029                -1.045832e-02 3 1  ON 78
ci_0030                -1.036454e-02 3 1  ON 79
ci_0031                 1.991271e-02 3 1  ON 80
ci_0032                 2.088853e-02 3 1  ON 81
ci_0033                 1.035688e-02 3 1  ON 82
ci_0034                 9.892963e-03 3 1  ON 83
ci_0035                 6.756016e-03 3 1  ON 84
ci_0036                 7.063378e-03 3 1  ON 85
ci_0037                -9.860085e-03 3 1  ON 86
ci_0038                -1.105799e-02 3 1  ON 87
ci_0039                -2.362057e-03 3 1  ON 88
ci_0040                -2.510219e-03 3 1  ON 89
ci_0041                 6.532326e-03 3 1  ON 90
ci_0042                 7.225635e-03 3 1  ON 91
ci_0043                -1.821226e-02 3 1  ON 92
ci_0044                -1.931151e-02 3 1  ON 93
ci_0045                 7.924436e-03 3 1  ON 94
ci_0046                 7.046552e-03 3 1  ON 95
ci_0047                -1.386680e-03 3 1  ON 96
ci_0048                -1.812297e-03 3 1  ON 97
ci_0049                -5.935581e-03 3 1  ON 98
ci_0050                -6.160031e-03 3 1  ON 99
ci_0051                -3.543848e-03 3 1  ON 100
ci_0052                -3.681659e-03 3 1  ON 101
ci_0053                -4.398175e-03 3 1  ON 102
ci_0054                -4.761354e-03 3 1  ON 103
ci_0055                 5.247276e-03 3 1  ON 104
ci_0056                 7.061376e-03 3 1  ON 105
ci_0057                 5.537028e-03 3 1  ON 106
ci_0058                 4.747930e-03 3 1  ON 107
ci_0059                -4.523807e-03 3 1  ON 108
ci_0060                -4.580132e-03 3 1  ON 109
ci_0061                -3.521078e-03 3 1  ON 110
ci_0062                -3.478045e-03 3 1  ON 111
ci_0063                -8.878008e-03 3 1  ON 112
ci_0064                -8.461330e-03 3 1  ON 113
ci_0065                -5.391460e-03 3 1  ON 114
ci_0066                -5.256288e-03 3 1  ON 115
ci_0067                -5.180443e-03 3 1  ON 116
ci_0068                -4.699919e-03 3 1  ON 117
ci_0069                 3.552416e-03 3 1  ON 118
ci_0070                 4.526922e-03 3 1  ON 119
ci_0071                 5.928358e-04 3 1  ON 120
ci_0072                 3.086793e-04 3 1  ON 121
ci_0073                 4.185011e-03 3 1  ON 122
ci_0074                 4.252202e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0600e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.0009
    reference variance = 0.312296
====================================================
  Execution time = 2.1283e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3746e-01
  Total weights = 1.951941145e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0253e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323472142002
                                         uncertainty =       0.001969597190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323472142002
                                         uncertainty =       0.001969597190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402169022
  error estimate for blocks of size 2^( 2) =       0.000414739413
  error estimate for blocks of size 2^( 3) =       0.000428023831
  error estimate for blocks of size 2^( 4) =       0.000440988521
  error estimate for blocks of size 2^( 5) =       0.000452369709
  error estimate for blocks of size 2^( 6) =       0.000459969594
  error estimate for blocks of size 2^( 7) =       0.000464954924

      target function =                  N/A
              le_mean =     -16.906395879634
             les_mean =     286.163682362199
             stat err =       0.000454570687
             autocorr =       1.277572700064
              std dev =       0.568752885785
             le_variance =       0.323479845088


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690639587963e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e-01, overlap shift 1.4552e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906395879648       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906417133917       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906414578561       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906415777297       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906418317319       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906418248053       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906419650850       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906419452719       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906420355543       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906419553214       residual = 8.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906419682246       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906419506890       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906419546420       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906419766060       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4552e-01 is 1.722934e-03

solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906395879648       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906405767218       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906404852296       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906404906363       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906405588034       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906405704351       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906406381220       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906406259830       residual = 9.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906406388336       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906406237985       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906406169301       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.8208e-01 is 5.283071e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906395879648       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906399029370       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906398794444       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906398787552       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906398954071       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906398970801       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906399211165       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906399210404       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906399213245       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906399187336       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3283e+00 is 1.664228e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.451405 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7327e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
   uu_0                 3.119162e-01 1 1  ON 0
   uu_1                 1.447282e-01 1 1  ON 1
   uu_2                 4.294763e-02 1 1  ON 2
   uu_3                -1.936527e-02 1 1  ON 3
   uu_4                -6.453042e-02 1 1  ON 4
   uu_5                -9.900156e-02 1 1  ON 5
   uu_6                -1.259592e-01 1 1  ON 6
   uu_7                -1.387029e-01 1 1  ON 7
   uu_8                -1.307925e-01 1 1  ON 8
   uu_9                -9.932187e-02 1 1  ON 9
   ud_0                 4.450655e-01 1 1  ON 10
   ud_1                 1.794700e-01 1 1  ON 11
   ud_2                 5.946425e-02 1 1  ON 12
   ud_3                -1.112473e-02 1 1  ON 13
   ud_4                -6.728720e-02 1 1  ON 14
   ud_5                -1.076679e-01 1 1  ON 15
   ud_6                -1.340251e-01 1 1  ON 16
   ud_7                -1.496753e-01 1 1  ON 17
   ud_8                -1.499630e-01 1 1  ON 18
   ud_9                -1.382149e-01 1 1  ON 19
   eO_0                -7.468335e-01 1 1  ON 20
   eO_1                -4.270462e-01 1 1  ON 21
   eO_2                -1.831740e-02 1 1  ON 22
   eO_3                 2.904231e-01 1 1  ON 23
   eO_4                 5.120238e-01 1 1  ON 24
   eO_5                 4.711702e-01 1 1  ON 25
   eO_6                 2.443296e-01 1 1  ON 26
   eO_7                -5.033356e-02 1 1  ON 27
   eO_8                -2.086651e-01 1 1  ON 28
   eO_9                -6.835824e-02 1 1  ON 29
  eH1_0                -2.469804e-01 1 1  ON 30
  eH1_1                -1.402012e-01 1 1  ON 31
  eH1_2                -9.100527e-02 1 1  ON 32
  eH1_3                -3.646228e-02 1 1  ON 33
  eH1_4                 1.257305e-02 1 1  ON 34
  eH1_5                 4.589612e-02 1 1  ON 35
  eH1_6                 1.015624e-01 1 1  ON 36
  eH1_7                 1.490959e-01 1 1  ON 37
  eH1_8                 1.620714e-01 1 1  ON 38
  eH1_9                 4.754177e-02 1 1  ON 39
  eH2_0                -2.448351e-01 1 1  ON 40
  eH2_1                -1.378464e-01 1 1  ON 41
  eH2_2                -8.838482e-02 1 1  ON 42
  eH2_3                -3.378550e-02 1 1  ON 43
  eH2_4                 1.553086e-02 1 1  ON 44
  eH2_5                 4.999249e-02 1 1  ON 45
  eH2_6                 1.049077e-01 1 1  ON 46
  eH2_7                 1.525575e-01 1 1  ON 47
  eH2_8                 1.675151e-01 1 1  ON 48
  eH2_9                 3.202104e-02 1 1  ON 49
ci_0001                 7.010418e-01 3 1  ON 50
ci_0002                 7.006141e-01 3 1  ON 51
ci_0003                -2.784540e-02 3 1  ON 52
ci_0004                -2.729898e-02 3 1  ON 53
ci_0005                -3.630409e-02 3 1  ON 54
ci_0006                -3.737346e-02 3 1  ON 55
ci_0007                -2.281034e-02 3 1  ON 56
ci_0008                -2.153836e-02 3 1  ON 57
ci_0009                -1.725652e-02 3 1  ON 58
ci_0010                -1.708786e-02 3 1  ON 59
ci_0011                -1.246924e-02 3 1  ON 60
ci_0012                -1.238138e-02 3 1  ON 61
ci_0013                 1.333240e-02 3 1  ON 62
ci_0014                 1.316855e-02 3 1  ON 63
ci_0015                 1.311711e-02 3 1  ON 64
ci_0016                 1.261729e-02 3 1  ON 65
ci_0017                 1.149093e-02 3 1  ON 66
ci_0018                 1.136677e-02 3 1  ON 67
ci_0019                 1.126111e-02 3 1  ON 68
ci_0020                 1.073647e-02 3 1  ON 69
ci_0021                -1.171555e-03 3 1  ON 70
ci_0022                -1.038260e-03 3 1  ON 71
ci_0023                -1.104704e-02 3 1  ON 72
ci_0024                -1.122144e-02 3 1  ON 73
ci_0025                -1.098103e-02 3 1  ON 74
ci_0026                -1.055542e-02 3 1  ON 75
ci_0027                -1.141422e-02 3 1  ON 76
ci_0028                -1.103721e-02 3 1  ON 77
ci_0029                -1.058369e-02 3 1  ON 78
ci_0030                -1.035558e-02 3 1  ON 79
ci_0031                 2.007667e-02 3 1  ON 80
ci_0032                 2.064636e-02 3 1  ON 81
ci_0033                 1.026490e-02 3 1  ON 82
ci_0034                 1.000887e-02 3 1  ON 83
ci_0035                 6.719638e-03 3 1  ON 84
ci_0036                 6.818509e-03 3 1  ON 85
ci_0037                -1.022339e-02 3 1  ON 86
ci_0038                -1.080518e-02 3 1  ON 87
ci_0039                -2.531730e-03 3 1  ON 88
ci_0040                -2.468016e-03 3 1  ON 89
ci_0041                 6.502721e-03 3 1  ON 90
ci_0042                 7.313484e-03 3 1  ON 91
ci_0043                -1.860150e-02 3 1  ON 92
ci_0044                -1.915150e-02 3 1  ON 93
ci_0045                 7.857895e-03 3 1  ON 94
ci_0046                 6.933053e-03 3 1  ON 95
ci_0047                -1.452430e-03 3 1  ON 96
ci_0048                -1.870874e-03 3 1  ON 97
ci_0049                -5.956796e-03 3 1  ON 98
ci_0050                -5.910455e-03 3 1  ON 99
ci_0051                -3.337801e-03 3 1  ON 100
ci_0052                -3.335323e-03 3 1  ON 101
ci_0053                -4.381770e-03 3 1  ON 102
ci_0054                -4.593185e-03 3 1  ON 103
ci_0055                 5.381988e-03 3 1  ON 104
ci_0056                 6.780274e-03 3 1  ON 105
ci_0057                 5.350942e-03 3 1  ON 106
ci_0058                 4.643132e-03 3 1  ON 107
ci_0059                -4.632263e-03 3 1  ON 108
ci_0060                -4.666697e-03 3 1  ON 109
ci_0061                -3.870340e-03 3 1  ON 110
ci_0062                -3.644603e-03 3 1  ON 111
ci_0063                -9.012911e-03 3 1  ON 112
ci_0064                -8.534030e-03 3 1  ON 113
ci_0065                -5.450822e-03 3 1  ON 114
ci_0066                -5.190977e-03 3 1  ON 115
ci_0067                -5.507129e-03 3 1  ON 116
ci_0068                -4.593247e-03 3 1  ON 117
ci_0069                 4.035213e-03 3 1  ON 118
ci_0070                 4.605710e-03 3 1  ON 119
ci_0071                 3.867302e-04 3 1  ON 120
ci_0072                 2.985142e-04 3 1  ON 121
ci_0073                 4.252619e-03 3 1  ON 122
ci_0074                 4.604689e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8769
    reference variance = 0.215397
====================================================
  Execution time = 2.1073e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3855e-01
  Total weights = 1.9516e+06
  Execution time = 1.9009e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327707793836
                                         uncertainty =       0.004258556757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327707793836
                                         uncertainty =       0.004258556757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404770223
  error estimate for blocks of size 2^( 2) =       0.000417819501
  error estimate for blocks of size 2^( 3) =       0.000430966373
  error estimate for blocks of size 2^( 4) =       0.000443610631
  error estimate for blocks of size 2^( 5) =       0.000454199398
  error estimate for blocks of size 2^( 6) =       0.000461274771
  error estimate for blocks of size 2^( 7) =       0.000463455890

      target function =                  N/A
              le_mean =     -16.906626469328
             les_mean =     291.096065775343
             stat err =       0.000455635172
             autocorr =       1.267118907230
              std dev =       0.572431539055
             le_variance =       0.327677866905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324807169900
                                         uncertainty =       0.003497497034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324807169900
                                         uncertainty =       0.003497497034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402980988
  error estimate for blocks of size 2^( 2) =       0.000416072359
  error estimate for blocks of size 2^( 3) =       0.000429250024
  error estimate for blocks of size 2^( 4) =       0.000441929250
  error estimate for blocks of size 2^( 5) =       0.000452500121
  error estimate for blocks of size 2^( 6) =       0.000459566900
  error estimate for blocks of size 2^( 7) =       0.000462649067

      target function =                  N/A
              le_mean =     -16.906674953175
             les_mean =     286.181089819605
             stat err =       0.000454161335
             autocorr =       1.270138851792
              std dev =       0.569901178239
             le_variance =       0.324787352958

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324766613307
                                         uncertainty =       0.003493768488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324766613307
                                         uncertainty =       0.003493768488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402955731
  error estimate for blocks of size 2^( 2) =       0.000416043179
  error estimate for blocks of size 2^( 3) =       0.000429221607
  error estimate for blocks of size 2^( 4) =       0.000441904417
  error estimate for blocks of size 2^( 5) =       0.000452477966
  error estimate for blocks of size 2^( 6) =       0.000459547027
  error estimate for blocks of size 2^( 7) =       0.000462628988

      target function =                  N/A
              le_mean =     -16.906671762010
             les_mean =     286.176571090910
             stat err =       0.000454139599
             autocorr =       1.270176489779
              std dev =       0.569865460499
             le_variance =       0.324746643069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324872769370
                                         uncertainty =       0.003482904997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324872769370
                                         uncertainty =       0.003482904997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403021131
  error estimate for blocks of size 2^( 2) =       0.000416094054
  error estimate for blocks of size 2^( 3) =       0.000429257071
  error estimate for blocks of size 2^( 4) =       0.000441946611
  error estimate for blocks of size 2^( 5) =       0.000452526188
  error estimate for blocks of size 2^( 6) =       0.000459601242
  error estimate for blocks of size 2^( 7) =       0.000462675899

      target function =                  N/A
              le_mean =     -16.906662289172
             les_mean =     286.173849021421
             stat err =       0.000454187485
             autocorr =       1.270032079658
              std dev =       0.569957949809
             le_variance =       0.324852064550


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906626469328        initial
     1.4552e-01     1.4552e+00             1.7229e-03       -16.906674953175  <--
     5.8208e-01     5.8208e+00             5.2831e-04       -16.906671762010
     2.3283e+00     2.3283e+01             1.6642e-04       -16.906662289172

*****************************************************************************
Applying the update for shift_i =   1.4552e-01     and shift_s =   1.4552e+00
*****************************************************************************

  Execution time = 3.0666e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
   uu_0                 3.118639e-01 1 1  ON 0
   uu_1                 1.447908e-01 1 1  ON 1
   uu_2                 4.289044e-02 1 1  ON 2
   uu_3                -1.941433e-02 1 1  ON 3
   uu_4                -6.454843e-02 1 1  ON 4
   uu_5                -9.924757e-02 1 1  ON 5
   uu_6                -1.261340e-01 1 1  ON 6
   uu_7                -1.388512e-01 1 1  ON 7
   uu_8                -1.309644e-01 1 1  ON 8
   uu_9                -9.952260e-02 1 1  ON 9
   ud_0                 4.453618e-01 1 1  ON 10
   ud_1                 1.797550e-01 1 1  ON 11
   ud_2                 5.977093e-02 1 1  ON 12
   ud_3                -1.095358e-02 1 1  ON 13
   ud_4                -6.726431e-02 1 1  ON 14
   ud_5                -1.076530e-01 1 1  ON 15
   ud_6                -1.342204e-01 1 1  ON 16
   ud_7                -1.501591e-01 1 1  ON 17
   ud_8                -1.502866e-01 1 1  ON 18
   ud_9                -1.383736e-01 1 1  ON 19
   eO_0                -7.470703e-01 1 1  ON 20
   eO_1                -4.271957e-01 1 1  ON 21
   eO_2                -1.839785e-02 1 1  ON 22
   eO_3                 2.902652e-01 1 1  ON 23
   eO_4                 5.121160e-01 1 1  ON 24
   eO_5                 4.719558e-01 1 1  ON 25
   eO_6                 2.449800e-01 1 1  ON 26
   eO_7                -4.986592e-02 1 1  ON 27
   eO_8                -2.093309e-01 1 1  ON 28
   eO_9                -6.896607e-02 1 1  ON 29
  eH1_0                -2.481750e-01 1 1  ON 30
  eH1_1                -1.406712e-01 1 1  ON 31
  eH1_2                -9.140605e-02 1 1  ON 32
  eH1_3                -3.672488e-02 1 1  ON 33
  eH1_4                 1.218364e-02 1 1  ON 34
  eH1_5                 4.569887e-02 1 1  ON 35
  eH1_6                 1.017168e-01 1 1  ON 36
  eH1_7                 1.499707e-01 1 1  ON 37
  eH1_8                 1.630378e-01 1 1  ON 38
  eH1_9                 4.843501e-02 1 1  ON 39
  eH2_0                -2.455757e-01 1 1  ON 40
  eH2_1                -1.383761e-01 1 1  ON 41
  eH2_2                -8.875985e-02 1 1  ON 42
  eH2_3                -3.416865e-02 1 1  ON 43
  eH2_4                 1.519803e-02 1 1  ON 44
  eH2_5                 5.008166e-02 1 1  ON 45
  eH2_6                 1.049745e-01 1 1  ON 46
  eH2_7                 1.530177e-01 1 1  ON 47
  eH2_8                 1.681607e-01 1 1  ON 48
  eH2_9                 3.308294e-02 1 1  ON 49
ci_0001                 7.012881e-01 3 1  ON 50
ci_0002                 7.003948e-01 3 1  ON 51
ci_0003                -2.784727e-02 3 1  ON 52
ci_0004                -2.739798e-02 3 1  ON 53
ci_0005                -3.630279e-02 3 1  ON 54
ci_0006                -3.759140e-02 3 1  ON 55
ci_0007                -2.203744e-02 3 1  ON 56
ci_0008                -2.153367e-02 3 1  ON 57
ci_0009                -1.735789e-02 3 1  ON 58
ci_0010                -1.718059e-02 3 1  ON 59
ci_0011                -1.243457e-02 3 1  ON 60
ci_0012                -1.259896e-02 3 1  ON 61
ci_0013                 1.293574e-02 3 1  ON 62
ci_0014                 1.296738e-02 3 1  ON 63
ci_0015                 1.306747e-02 3 1  ON 64
ci_0016                 1.259212e-02 3 1  ON 65
ci_0017                 1.131157e-02 3 1  ON 66
ci_0018                 1.156330e-02 3 1  ON 67
ci_0019                 1.110143e-02 3 1  ON 68
ci_0020                 1.056635e-02 3 1  ON 69
ci_0021                -1.676843e-03 3 1  ON 70
ci_0022                -1.046418e-03 3 1  ON 71
ci_0023                -1.097080e-02 3 1  ON 72
ci_0024                -1.105207e-02 3 1  ON 73
ci_0025                -1.075504e-02 3 1  ON 74
ci_0026                -1.062817e-02 3 1  ON 75
ci_0027                -1.120873e-02 3 1  ON 76
ci_0028                -1.071603e-02 3 1  ON 77
ci_0029                -1.077235e-02 3 1  ON 78
ci_0030                -1.032959e-02 3 1  ON 79
ci_0031                 2.035200e-02 3 1  ON 80
ci_0032                 2.023410e-02 3 1  ON 81
ci_0033                 1.010242e-02 3 1  ON 82
ci_0034                 1.020688e-02 3 1  ON 83
ci_0035                 6.668344e-03 3 1  ON 84
ci_0036                 6.498320e-03 3 1  ON 85
ci_0037                -1.071899e-02 3 1  ON 86
ci_0038                -1.044174e-02 3 1  ON 87
ci_0039                -2.678903e-03 3 1  ON 88
ci_0040                -2.430876e-03 3 1  ON 89
ci_0041                 6.472578e-03 3 1  ON 90
ci_0042                 7.411489e-03 3 1  ON 91
ci_0043                -1.933473e-02 3 1  ON 92
ci_0044                -1.889470e-02 3 1  ON 93
ci_0045                 7.755340e-03 3 1  ON 94
ci_0046                 6.762285e-03 3 1  ON 95
ci_0047                -1.505567e-03 3 1  ON 96
ci_0048                -1.919232e-03 3 1  ON 97
ci_0049                -5.990581e-03 3 1  ON 98
ci_0050                -5.604794e-03 3 1  ON 99
ci_0051                -3.152530e-03 3 1  ON 100
ci_0052                -3.003189e-03 3 1  ON 101
ci_0053                -4.353535e-03 3 1  ON 102
ci_0054                -4.427795e-03 3 1  ON 103
ci_0055                 5.588554e-03 3 1  ON 104
ci_0056                 6.366501e-03 3 1  ON 105
ci_0057                 5.094034e-03 3 1  ON 106
ci_0058                 4.498290e-03 3 1  ON 107
ci_0059                -4.735084e-03 3 1  ON 108
ci_0060                -4.746464e-03 3 1  ON 109
ci_0061                -4.319697e-03 3 1  ON 110
ci_0062                -3.856797e-03 3 1  ON 111
ci_0063                -9.133284e-03 3 1  ON 112
ci_0064                -8.617799e-03 3 1  ON 113
ci_0065                -5.526736e-03 3 1  ON 114
ci_0066                -5.110988e-03 3 1  ON 115
ci_0067                -5.799013e-03 3 1  ON 116
ci_0068                -4.495070e-03 3 1  ON 117
ci_0069                 4.476285e-03 3 1  ON 118
ci_0070                 4.684248e-03 3 1  ON 119
ci_0071                 1.457359e-04 3 1  ON 120
ci_0072                 2.593330e-04 3 1  ON 121
ci_0073                 4.315016e-03 3 1  ON 122
ci_0074                 4.923300e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8016e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.947
    reference variance = 0.225233
====================================================
  Execution time = 2.1337e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5202e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3629e-01
  Total weights = 1.951512408e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0635e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321971858271
                                         uncertainty =       0.002285106746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321971858271
                                         uncertainty =       0.002285106746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401358434
  error estimate for blocks of size 2^( 2) =       0.000414604775
  error estimate for blocks of size 2^( 3) =       0.000428002010
  error estimate for blocks of size 2^( 4) =       0.000440507338
  error estimate for blocks of size 2^( 5) =       0.000451914757
  error estimate for blocks of size 2^( 6) =       0.000460947190
  error estimate for blocks of size 2^( 7) =       0.000466387916

      target function =                  N/A
              le_mean =     -16.905601810748
             les_mean =     286.135662642714
             stat err =       0.000454939300
             autocorr =       1.284819511278
              std dev =       0.567606540817
             le_variance =       0.322177185178


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690560181075e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e-02, overlap shift 3.6380e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905601810753       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905596263152       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905598309048       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905597130471       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905596192449       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905597867642       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905601491307       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905606385209       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905606663869       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905605861036       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905606715230       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905607016736       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905608490203       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905608509155       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905608390122       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905608110646       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905608139434       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905608269079       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905608338072       residual = 9.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.6380e-02 is 7.071520e-03

solving harmonic davidson linear method for identity shift 1.4552e-01, overlap shift 1.4552e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905601810753       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905597893364       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905599686370       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905599682301       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905598921072       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905600241633       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905601652445       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905602940716       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905602134313       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905602085355       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905602290334       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905602409534       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905602517709       residual = 9.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4552e-01 is 1.771250e-03

solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905601810753       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905600010014       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905600818736       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905601175893       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905601187205       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905601748478       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905601709760       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905601840643       residual = 9.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905601824820       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905601799864       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905601857575       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.8208e-01 is 4.475172e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.465685 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7422e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
   uu_0                 3.117466e-01 1 1  ON 0
   uu_1                 1.447349e-01 1 1  ON 1
   uu_2                 4.305937e-02 1 1  ON 2
   uu_3                -1.916319e-02 1 1  ON 3
   uu_4                -6.454257e-02 1 1  ON 4
   uu_5                -9.933052e-02 1 1  ON 5
   uu_6                -1.264846e-01 1 1  ON 6
   uu_7                -1.389746e-01 1 1  ON 7
   uu_8                -1.311472e-01 1 1  ON 8
   uu_9                -1.002719e-01 1 1  ON 9
   ud_0                 4.453556e-01 1 1  ON 10
   ud_1                 1.799299e-01 1 1  ON 11
   ud_2                 5.987552e-02 1 1  ON 12
   ud_3                -1.077098e-02 1 1  ON 13
   ud_4                -6.720293e-02 1 1  ON 14
   ud_5                -1.077642e-01 1 1  ON 15
   ud_6                -1.341335e-01 1 1  ON 16
   ud_7                -1.497562e-01 1 1  ON 17
   ud_8                -1.506353e-01 1 1  ON 18
   ud_9                -1.385790e-01 1 1  ON 19
   eO_0                -7.471023e-01 1 1  ON 20
   eO_1                -4.276959e-01 1 1  ON 21
   eO_2                -1.909386e-02 1 1  ON 22
   eO_3                 2.902533e-01 1 1  ON 23
   eO_4                 5.129955e-01 1 1  ON 24
   eO_5                 4.728997e-01 1 1  ON 25
   eO_6                 2.454289e-01 1 1  ON 26
   eO_7                -4.920878e-02 1 1  ON 27
   eO_8                -2.099738e-01 1 1  ON 28
   eO_9                -6.984475e-02 1 1  ON 29
  eH1_0                -2.490206e-01 1 1  ON 30
  eH1_1                -1.409925e-01 1 1  ON 31
  eH1_2                -9.187005e-02 1 1  ON 32
  eH1_3                -3.738697e-02 1 1  ON 33
  eH1_4                 1.162684e-02 1 1  ON 34
  eH1_5                 4.535258e-02 1 1  ON 35
  eH1_6                 1.014843e-01 1 1  ON 36
  eH1_7                 1.507892e-01 1 1  ON 37
  eH1_8                 1.645661e-01 1 1  ON 38
  eH1_9                 4.967009e-02 1 1  ON 39
  eH2_0                -2.461096e-01 1 1  ON 40
  eH2_1                -1.390207e-01 1 1  ON 41
  eH2_2                -8.955714e-02 1 1  ON 42
  eH2_3                -3.460080e-02 1 1  ON 43
  eH2_4                 1.430580e-02 1 1  ON 44
  eH2_5                 4.961410e-02 1 1  ON 45
  eH2_6                 1.052412e-01 1 1  ON 46
  eH2_7                 1.534274e-01 1 1  ON 47
  eH2_8                 1.693283e-01 1 1  ON 48
  eH2_9                 3.485419e-02 1 1  ON 49
ci_0001                 7.014419e-01 3 1  ON 50
ci_0002                 7.000949e-01 3 1  ON 51
ci_0003                -2.781888e-02 3 1  ON 52
ci_0004                -2.749184e-02 3 1  ON 53
ci_0005                -3.666110e-02 3 1  ON 54
ci_0006                -3.710266e-02 3 1  ON 55
ci_0007                -2.252766e-02 3 1  ON 56
ci_0008                -2.153869e-02 3 1  ON 57
ci_0009                -1.785501e-02 3 1  ON 58
ci_0010                -1.751127e-02 3 1  ON 59
ci_0011                -1.220422e-02 3 1  ON 60
ci_0012                -1.234233e-02 3 1  ON 61
ci_0013                 1.300126e-02 3 1  ON 62
ci_0014                 1.317508e-02 3 1  ON 63
ci_0015                 1.363302e-02 3 1  ON 64
ci_0016                 1.350312e-02 3 1  ON 65
ci_0017                 1.098051e-02 3 1  ON 66
ci_0018                 1.192494e-02 3 1  ON 67
ci_0019                 1.136554e-02 3 1  ON 68
ci_0020                 1.154858e-02 3 1  ON 69
ci_0021                -2.108756e-03 3 1  ON 70
ci_0022                -4.907121e-04 3 1  ON 71
ci_0023                -1.110230e-02 3 1  ON 72
ci_0024                -1.090613e-02 3 1  ON 73
ci_0025                -1.175971e-02 3 1  ON 74
ci_0026                -1.107794e-02 3 1  ON 75
ci_0027                -1.166839e-02 3 1  ON 76
ci_0028                -1.083096e-02 3 1  ON 77
ci_0029                -9.938147e-03 3 1  ON 78
ci_0030                -1.127495e-02 3 1  ON 79
ci_0031                 2.037366e-02 3 1  ON 80
ci_0032                 2.130484e-02 3 1  ON 81
ci_0033                 1.035333e-02 3 1  ON 82
ci_0034                 9.795926e-03 3 1  ON 83
ci_0035                 6.436022e-03 3 1  ON 84
ci_0036                 6.888915e-03 3 1  ON 85
ci_0037                -1.058394e-02 3 1  ON 86
ci_0038                -1.119881e-02 3 1  ON 87
ci_0039                -2.527403e-03 3 1  ON 88
ci_0040                -2.769470e-03 3 1  ON 89
ci_0041                 6.630024e-03 3 1  ON 90
ci_0042                 7.336551e-03 3 1  ON 91
ci_0043                -1.946141e-02 3 1  ON 92
ci_0044                -1.898788e-02 3 1  ON 93
ci_0045                 7.483316e-03 3 1  ON 94
ci_0046                 7.404229e-03 3 1  ON 95
ci_0047                -1.543637e-03 3 1  ON 96
ci_0048                -1.862193e-03 3 1  ON 97
ci_0049                -5.341840e-03 3 1  ON 98
ci_0050                -5.923245e-03 3 1  ON 99
ci_0051                -3.617855e-03 3 1  ON 100
ci_0052                -3.392993e-03 3 1  ON 101
ci_0053                -4.473602e-03 3 1  ON 102
ci_0054                -4.327524e-03 3 1  ON 103
ci_0055                 6.385534e-03 3 1  ON 104
ci_0056                 6.300510e-03 3 1  ON 105
ci_0057                 4.732817e-03 3 1  ON 106
ci_0058                 4.831970e-03 3 1  ON 107
ci_0059                -4.598598e-03 3 1  ON 108
ci_0060                -4.623538e-03 3 1  ON 109
ci_0061                -4.540044e-03 3 1  ON 110
ci_0062                -3.761879e-03 3 1  ON 111
ci_0063                -9.156151e-03 3 1  ON 112
ci_0064                -8.238193e-03 3 1  ON 113
ci_0065                -5.041570e-03 3 1  ON 114
ci_0066                -5.118350e-03 3 1  ON 115
ci_0067                -5.305826e-03 3 1  ON 116
ci_0068                -4.970048e-03 3 1  ON 117
ci_0069                 4.618136e-03 3 1  ON 118
ci_0070                 4.551943e-03 3 1  ON 119
ci_0071                 5.549436e-04 3 1  ON 120
ci_0072                -4.247575e-04 3 1  ON 121
ci_0073                 4.248397e-03 3 1  ON 122
ci_0074                 4.068964e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8644
    reference variance = 0.167752
====================================================
  Execution time = 2.1288e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4124e-01
  Total weights = 1.9516e+06
  Execution time = 1.9000e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325318439498
                                         uncertainty =       0.003852299603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325318439498
                                         uncertainty =       0.003852299603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403321141
  error estimate for blocks of size 2^( 2) =       0.000416350532
  error estimate for blocks of size 2^( 3) =       0.000429281793
  error estimate for blocks of size 2^( 4) =       0.000442251031
  error estimate for blocks of size 2^( 5) =       0.000451915612
  error estimate for blocks of size 2^( 6) =       0.000459848246
  error estimate for blocks of size 2^( 7) =       0.000464200049

      target function =                  N/A
              le_mean =     -16.905970522975
             les_mean =     286.703830465316
             stat err =       0.000454553734
             autocorr =       1.270189406498
              std dev =       0.570382227252
             le_variance =       0.325335885165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326589299808
                                         uncertainty =       0.004189206656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326589299808
                                         uncertainty =       0.004189206656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404109494
  error estimate for blocks of size 2^( 2) =       0.000417093952
  error estimate for blocks of size 2^( 3) =       0.000429946682
  error estimate for blocks of size 2^( 4) =       0.000442830476
  error estimate for blocks of size 2^( 5) =       0.000452419593
  error estimate for blocks of size 2^( 6) =       0.000460335638
  error estimate for blocks of size 2^( 7) =       0.000464651211

      target function =                  N/A
              le_mean =     -16.905994903429
             les_mean =     286.291213338157
             stat err =       0.000455059229
             autocorr =       1.268053991790
              std dev =       0.571497127791
             le_variance =       0.326608967073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327415801477
                                         uncertainty =       0.004329426429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327415801477
                                         uncertainty =       0.004329426429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404620662
  error estimate for blocks of size 2^( 2) =       0.000417583795
  error estimate for blocks of size 2^( 3) =       0.000430419067
  error estimate for blocks of size 2^( 4) =       0.000443289931
  error estimate for blocks of size 2^( 5) =       0.000452849517
  error estimate for blocks of size 2^( 6) =       0.000460752570
  error estimate for blocks of size 2^( 7) =       0.000465069741

      target function =                  N/A
              le_mean =     -16.906035789851
             les_mean =     286.163287307446
             stat err =       0.000455490440
             autocorr =       1.267250351549
              std dev =       0.572220027278
             le_variance =       0.327435759618

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325179313672
                                         uncertainty =       0.003921612059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325179313672
                                         uncertainty =       0.003921612059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403235654
  error estimate for blocks of size 2^( 2) =       0.000416263525
  error estimate for blocks of size 2^( 3) =       0.000429187033
  error estimate for blocks of size 2^( 4) =       0.000442158221
  error estimate for blocks of size 2^( 5) =       0.000451817275
  error estimate for blocks of size 2^( 6) =       0.000459788896
  error estimate for blocks of size 2^( 7) =       0.000464161281

      target function =                  N/A
              le_mean =     -16.905979942753
             les_mean =     286.152904138924
             stat err =       0.000454481418
             autocorr =       1.270323731733
              std dev =       0.570261331391
             le_variance =       0.325197986080


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905970522975        initial
     3.6380e-02     3.6380e-01             7.0715e-03       -16.905994903429
     1.4552e-01     1.4552e+00             1.7712e-03       -16.906035789851  <--
     5.8208e-01     5.8208e+00             4.4752e-04       -16.905979942753

*****************************************************************************
Applying the update for shift_i =   1.4552e-01     and shift_s =   1.4552e+00
*****************************************************************************

  Execution time = 3.0883e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
   uu_0                 3.117466e-01 1 1  ON 0
   uu_1                 1.447349e-01 1 1  ON 1
   uu_2                 4.305937e-02 1 1  ON 2
   uu_3                -1.916319e-02 1 1  ON 3
   uu_4                -6.454257e-02 1 1  ON 4
   uu_5                -9.933052e-02 1 1  ON 5
   uu_6                -1.264846e-01 1 1  ON 6
   uu_7                -1.389746e-01 1 1  ON 7
   uu_8                -1.311472e-01 1 1  ON 8
   uu_9                -1.002719e-01 1 1  ON 9
   ud_0                 4.453556e-01 1 1  ON 10
   ud_1                 1.799299e-01 1 1  ON 11
   ud_2                 5.987552e-02 1 1  ON 12
   ud_3                -1.077098e-02 1 1  ON 13
   ud_4                -6.720293e-02 1 1  ON 14
   ud_5                -1.077642e-01 1 1  ON 15
   ud_6                -1.341335e-01 1 1  ON 16
   ud_7                -1.497562e-01 1 1  ON 17
   ud_8                -1.506353e-01 1 1  ON 18
   ud_9                -1.385790e-01 1 1  ON 19
   eO_0                -7.471023e-01 1 1  ON 20
   eO_1                -4.276959e-01 1 1  ON 21
   eO_2                -1.909386e-02 1 1  ON 22
   eO_3                 2.902533e-01 1 1  ON 23
   eO_4                 5.129955e-01 1 1  ON 24
   eO_5                 4.728997e-01 1 1  ON 25
   eO_6                 2.454289e-01 1 1  ON 26
   eO_7                -4.920878e-02 1 1  ON 27
   eO_8                -2.099738e-01 1 1  ON 28
   eO_9                -6.984475e-02 1 1  ON 29
  eH1_0                -2.490206e-01 1 1  ON 30
  eH1_1                -1.409925e-01 1 1  ON 31
  eH1_2                -9.187005e-02 1 1  ON 32
  eH1_3                -3.738697e-02 1 1  ON 33
  eH1_4                 1.162684e-02 1 1  ON 34
  eH1_5                 4.535258e-02 1 1  ON 35
  eH1_6                 1.014843e-01 1 1  ON 36
  eH1_7                 1.507892e-01 1 1  ON 37
  eH1_8                 1.645661e-01 1 1  ON 38
  eH1_9                 4.967009e-02 1 1  ON 39
  eH2_0                -2.461096e-01 1 1  ON 40
  eH2_1                -1.390207e-01 1 1  ON 41
  eH2_2                -8.955714e-02 1 1  ON 42
  eH2_3                -3.460080e-02 1 1  ON 43
  eH2_4                 1.430580e-02 1 1  ON 44
  eH2_5                 4.961410e-02 1 1  ON 45
  eH2_6                 1.052412e-01 1 1  ON 46
  eH2_7                 1.534274e-01 1 1  ON 47
  eH2_8                 1.693283e-01 1 1  ON 48
  eH2_9                 3.485419e-02 1 1  ON 49
ci_0001                 7.014419e-01 3 1  ON 50
ci_0002                 7.000949e-01 3 1  ON 51
ci_0003                -2.781888e-02 3 1  ON 52
ci_0004                -2.749184e-02 3 1  ON 53
ci_0005                -3.666110e-02 3 1  ON 54
ci_0006                -3.710266e-02 3 1  ON 55
ci_0007                -2.252766e-02 3 1  ON 56
ci_0008                -2.153869e-02 3 1  ON 57
ci_0009                -1.785501e-02 3 1  ON 58
ci_0010                -1.751127e-02 3 1  ON 59
ci_0011                -1.220422e-02 3 1  ON 60
ci_0012                -1.234233e-02 3 1  ON 61
ci_0013                 1.300126e-02 3 1  ON 62
ci_0014                 1.317508e-02 3 1  ON 63
ci_0015                 1.363302e-02 3 1  ON 64
ci_0016                 1.350312e-02 3 1  ON 65
ci_0017                 1.098051e-02 3 1  ON 66
ci_0018                 1.192494e-02 3 1  ON 67
ci_0019                 1.136554e-02 3 1  ON 68
ci_0020                 1.154858e-02 3 1  ON 69
ci_0021                -2.108756e-03 3 1  ON 70
ci_0022                -4.907121e-04 3 1  ON 71
ci_0023                -1.110230e-02 3 1  ON 72
ci_0024                -1.090613e-02 3 1  ON 73
ci_0025                -1.175971e-02 3 1  ON 74
ci_0026                -1.107794e-02 3 1  ON 75
ci_0027                -1.166839e-02 3 1  ON 76
ci_0028                -1.083096e-02 3 1  ON 77
ci_0029                -9.938147e-03 3 1  ON 78
ci_0030                -1.127495e-02 3 1  ON 79
ci_0031                 2.037366e-02 3 1  ON 80
ci_0032                 2.130484e-02 3 1  ON 81
ci_0033                 1.035333e-02 3 1  ON 82
ci_0034                 9.795926e-03 3 1  ON 83
ci_0035                 6.436022e-03 3 1  ON 84
ci_0036                 6.888915e-03 3 1  ON 85
ci_0037                -1.058394e-02 3 1  ON 86
ci_0038                -1.119881e-02 3 1  ON 87
ci_0039                -2.527403e-03 3 1  ON 88
ci_0040                -2.769470e-03 3 1  ON 89
ci_0041                 6.630024e-03 3 1  ON 90
ci_0042                 7.336551e-03 3 1  ON 91
ci_0043                -1.946141e-02 3 1  ON 92
ci_0044                -1.898788e-02 3 1  ON 93
ci_0045                 7.483316e-03 3 1  ON 94
ci_0046                 7.404229e-03 3 1  ON 95
ci_0047                -1.543637e-03 3 1  ON 96
ci_0048                -1.862193e-03 3 1  ON 97
ci_0049                -5.341840e-03 3 1  ON 98
ci_0050                -5.923245e-03 3 1  ON 99
ci_0051                -3.617855e-03 3 1  ON 100
ci_0052                -3.392993e-03 3 1  ON 101
ci_0053                -4.473602e-03 3 1  ON 102
ci_0054                -4.327524e-03 3 1  ON 103
ci_0055                 6.385534e-03 3 1  ON 104
ci_0056                 6.300510e-03 3 1  ON 105
ci_0057                 4.732817e-03 3 1  ON 106
ci_0058                 4.831970e-03 3 1  ON 107
ci_0059                -4.598598e-03 3 1  ON 108
ci_0060                -4.623538e-03 3 1  ON 109
ci_0061                -4.540044e-03 3 1  ON 110
ci_0062                -3.761879e-03 3 1  ON 111
ci_0063                -9.156151e-03 3 1  ON 112
ci_0064                -8.238193e-03 3 1  ON 113
ci_0065                -5.041570e-03 3 1  ON 114
ci_0066                -5.118350e-03 3 1  ON 115
ci_0067                -5.305826e-03 3 1  ON 116
ci_0068                -4.970048e-03 3 1  ON 117
ci_0069                 4.618136e-03 3 1  ON 118
ci_0070                 4.551943e-03 3 1  ON 119
ci_0071                 5.549436e-04 3 1  ON 120
ci_0072                -4.247575e-04 3 1  ON 121
ci_0073                 4.248397e-03 3 1  ON 122
ci_0074                 4.068964e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8329e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.9645
    reference variance = 0.213606
====================================================
  Execution time = 2.1507e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3717e-01
  Total weights = 1.951640782e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0627e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319853019977
                                         uncertainty =       0.002356874426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319853019977
                                         uncertainty =       0.002356874426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399937863
  error estimate for blocks of size 2^( 2) =       0.000412558026
  error estimate for blocks of size 2^( 3) =       0.000425586575
  error estimate for blocks of size 2^( 4) =       0.000437796686
  error estimate for blocks of size 2^( 5) =       0.000448265529
  error estimate for blocks of size 2^( 6) =       0.000455862932
  error estimate for blocks of size 2^( 7) =       0.000460586394

      target function =                  N/A
              le_mean =     -16.906672635447
             les_mean =     286.172744724478
             stat err =       0.000450627885
             autocorr =       1.269553718443
              std dev =       0.565597550240
             le_variance =       0.319900588837


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690667263545e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e-02, overlap shift 3.6380e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906672635465       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906697998184       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906696419817       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906703348948       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906708980459       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906708231329       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906714871804       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906715875062       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906717463103       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906718631903       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906718098478       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906719629601       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906718931279       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906719174693       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906718331399       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906718560780       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906718765316       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906719563338       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906719642453       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906719974764       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906720028664       residual = 7.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.6380e-02 is 5.704399e-03

solving harmonic davidson linear method for identity shift 1.4552e-01, overlap shift 1.4552e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906672635465       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906690079725       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906688759540       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906690795104       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906694499669       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906694425247       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906696147743       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906695969688       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906696606340       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906696757091       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906696657218       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906696858637       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906696534950       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906696520968       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906696481032       residual = 6.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4552e-01 is 1.458756e-03

solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906672635465       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906680392468       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906679756048       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906679937237       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906681670857       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906681524269       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906681544031       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906681607133       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906681869886       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906681877859       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906681788136       residual = 7.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.8208e-01 is 4.377643e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.475292 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7583e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
   uu_0                 3.122000e-01 1 1  ON 0
   uu_1                 1.448896e-01 1 1  ON 1
   uu_2                 4.331319e-02 1 1  ON 2
   uu_3                -1.886898e-02 1 1  ON 3
   uu_4                -6.430672e-02 1 1  ON 4
   uu_5                -9.907889e-02 1 1  ON 5
   uu_6                -1.261552e-01 1 1  ON 6
   uu_7                -1.392573e-01 1 1  ON 7
   uu_8                -1.324801e-01 1 1  ON 8
   uu_9                -1.011727e-01 1 1  ON 9
   ud_0                 4.459501e-01 1 1  ON 10
   ud_1                 1.805578e-01 1 1  ON 11
   ud_2                 6.047329e-02 1 1  ON 12
   ud_3                -1.023329e-02 1 1  ON 13
   ud_4                -6.675733e-02 1 1  ON 14
   ud_5                -1.075118e-01 1 1  ON 15
   ud_6                -1.343496e-01 1 1  ON 16
   ud_7                -1.503389e-01 1 1  ON 17
   ud_8                -1.520884e-01 1 1  ON 18
   ud_9                -1.391260e-01 1 1  ON 19
   eO_0                -7.472959e-01 1 1  ON 20
   eO_1                -4.279531e-01 1 1  ON 21
   eO_2                -1.886746e-02 1 1  ON 22
   eO_3                 2.907795e-01 1 1  ON 23
   eO_4                 5.134230e-01 1 1  ON 24
   eO_5                 4.732419e-01 1 1  ON 25
   eO_6                 2.464094e-01 1 1  ON 26
   eO_7                -4.884336e-02 1 1  ON 27
   eO_8                -2.112738e-01 1 1  ON 28
   eO_9                -7.080819e-02 1 1  ON 29
  eH1_0                -2.493115e-01 1 1  ON 30
  eH1_1                -1.414204e-01 1 1  ON 31
  eH1_2                -9.246293e-02 1 1  ON 32
  eH1_3                -3.776057e-02 1 1  ON 33
  eH1_4                 1.172642e-02 1 1  ON 34
  eH1_5                 4.547462e-02 1 1  ON 35
  eH1_6                 1.011028e-01 1 1  ON 36
  eH1_7                 1.507662e-01 1 1  ON 37
  eH1_8                 1.652828e-01 1 1  ON 38
  eH1_9                 5.081757e-02 1 1  ON 39
  eH2_0                -2.466735e-01 1 1  ON 40
  eH2_1                -1.395234e-01 1 1  ON 41
  eH2_2                -9.048987e-02 1 1  ON 42
  eH2_3                -3.523739e-02 1 1  ON 43
  eH2_4                 1.403408e-02 1 1  ON 44
  eH2_5                 4.857602e-02 1 1  ON 45
  eH2_6                 1.053366e-01 1 1  ON 46
  eH2_7                 1.545503e-01 1 1  ON 47
  eH2_8                 1.707870e-01 1 1  ON 48
  eH2_9                 3.609982e-02 1 1  ON 49
ci_0001                 7.015434e-01 3 1  ON 50
ci_0002                 7.000946e-01 3 1  ON 51
ci_0003                -2.760280e-02 3 1  ON 52
ci_0004                -2.744230e-02 3 1  ON 53
ci_0005                -3.645852e-02 3 1  ON 54
ci_0006                -3.667153e-02 3 1  ON 55
ci_0007                -2.246341e-02 3 1  ON 56
ci_0008                -2.276349e-02 3 1  ON 57
ci_0009                -1.718286e-02 3 1  ON 58
ci_0010                -1.714635e-02 3 1  ON 59
ci_0011                -1.214261e-02 3 1  ON 60
ci_0012                -1.231301e-02 3 1  ON 61
ci_0013                 1.304017e-02 3 1  ON 62
ci_0014                 1.315645e-02 3 1  ON 63
ci_0015                 1.361915e-02 3 1  ON 64
ci_0016                 1.383812e-02 3 1  ON 65
ci_0017                 1.140699e-02 3 1  ON 66
ci_0018                 1.121478e-02 3 1  ON 67
ci_0019                 1.108061e-02 3 1  ON 68
ci_0020                 1.091134e-02 3 1  ON 69
ci_0021                -2.001908e-03 3 1  ON 70
ci_0022                -9.565957e-04 3 1  ON 71
ci_0023                -1.103727e-02 3 1  ON 72
ci_0024                -1.119484e-02 3 1  ON 73
ci_0025                -1.139399e-02 3 1  ON 74
ci_0026                -1.091280e-02 3 1  ON 75
ci_0027                -1.074649e-02 3 1  ON 76
ci_0028                -1.085649e-02 3 1  ON 77
ci_0029                -1.048110e-02 3 1  ON 78
ci_0030                -1.043539e-02 3 1  ON 79
ci_0031                 2.037158e-02 3 1  ON 80
ci_0032                 2.134763e-02 3 1  ON 81
ci_0033                 1.061441e-02 3 1  ON 82
ci_0034                 1.015441e-02 3 1  ON 83
ci_0035                 6.106729e-03 3 1  ON 84
ci_0036                 7.688229e-03 3 1  ON 85
ci_0037                -1.028331e-02 3 1  ON 86
ci_0038                -1.084152e-02 3 1  ON 87
ci_0039                -2.474240e-03 3 1  ON 88
ci_0040                -2.647362e-03 3 1  ON 89
ci_0041                 6.909289e-03 3 1  ON 90
ci_0042                 6.407598e-03 3 1  ON 91
ci_0043                -1.873528e-02 3 1  ON 92
ci_0044                -1.869011e-02 3 1  ON 93
ci_0045                 7.273988e-03 3 1  ON 94
ci_0046                 7.482394e-03 3 1  ON 95
ci_0047                -1.360085e-03 3 1  ON 96
ci_0048                -1.705535e-03 3 1  ON 97
ci_0049                -5.797160e-03 3 1  ON 98
ci_0050                -5.893064e-03 3 1  ON 99
ci_0051                -3.383948e-03 3 1  ON 100
ci_0052                -3.099744e-03 3 1  ON 101
ci_0053                -4.386992e-03 3 1  ON 102
ci_0054                -4.655078e-03 3 1  ON 103
ci_0055                 5.922279e-03 3 1  ON 104
ci_0056                 6.872170e-03 3 1  ON 105
ci_0057                 4.521919e-03 3 1  ON 106
ci_0058                 4.647693e-03 3 1  ON 107
ci_0059                -4.710415e-03 3 1  ON 108
ci_0060                -4.520476e-03 3 1  ON 109
ci_0061                -3.919987e-03 3 1  ON 110
ci_0062                -3.773346e-03 3 1  ON 111
ci_0063                -9.479336e-03 3 1  ON 112
ci_0064                -8.532445e-03 3 1  ON 113
ci_0065                -5.468603e-03 3 1  ON 114
ci_0066                -5.074661e-03 3 1  ON 115
ci_0067                -5.322648e-03 3 1  ON 116
ci_0068                -4.884567e-03 3 1  ON 117
ci_0069                 5.060036e-03 3 1  ON 118
ci_0070                 4.266065e-03 3 1  ON 119
ci_0071                 8.474646e-04 3 1  ON 120
ci_0072                -5.754228e-05 3 1  ON 121
ci_0073                 4.141602e-03 3 1  ON 122
ci_0074                 4.354355e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.8633
    reference variance = 0.312763
====================================================
  Execution time = 2.1101e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2769e-01
  Total weights = 1.9516e+06
  Execution time = 1.8918e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317953800432
                                         uncertainty =       0.002038400462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317953800432
                                         uncertainty =       0.002038400462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398733856
  error estimate for blocks of size 2^( 2) =       0.000411750264
  error estimate for blocks of size 2^( 3) =       0.000425397970
  error estimate for blocks of size 2^( 4) =       0.000438278321
  error estimate for blocks of size 2^( 5) =       0.000448974774
  error estimate for blocks of size 2^( 6) =       0.000456114679
  error estimate for blocks of size 2^( 7) =       0.000460714898

      target function =                  N/A
              le_mean =     -16.905785881225
             les_mean =     286.135225406021
             stat err =       0.000451020668
             autocorr =       1.279459848057
              std dev =       0.563894827626
             le_variance =       0.317977376624

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317905782891
                                         uncertainty =       0.002038140123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317905782891
                                         uncertainty =       0.002038140123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398705043
  error estimate for blocks of size 2^( 2) =       0.000411746286
  error estimate for blocks of size 2^( 3) =       0.000425394618
  error estimate for blocks of size 2^( 4) =       0.000438274041
  error estimate for blocks of size 2^( 5) =       0.000448941585
  error estimate for blocks of size 2^( 6) =       0.000456022978
  error estimate for blocks of size 2^( 7) =       0.000460525870

      target function =                  N/A
              le_mean =     -16.905756617663
             les_mean =     286.132931765223
             stat err =       0.000450941118
             autocorr =       1.279193421699
              std dev =       0.563854079426
             le_variance =       0.317931422886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317869832717
                                         uncertainty =       0.002068957575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317869832717
                                         uncertainty =       0.002068957575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398682672
  error estimate for blocks of size 2^( 2) =       0.000411823968
  error estimate for blocks of size 2^( 3) =       0.000425489914
  error estimate for blocks of size 2^( 4) =       0.000438385349
  error estimate for blocks of size 2^( 5) =       0.000449060223
  error estimate for blocks of size 2^( 6) =       0.000456122301
  error estimate for blocks of size 2^( 7) =       0.000460614081

      target function =                  N/A
              le_mean =     -16.905772748692
             les_mean =     286.162297839254
             stat err =       0.000451045488
             autocorr =       1.279929253739
              std dev =       0.563822442168
             le_variance =       0.317895746292

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317764581799
                                         uncertainty =       0.002036447088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317764581799
                                         uncertainty =       0.002036447088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398615597
  error estimate for blocks of size 2^( 2) =       0.000411645277
  error estimate for blocks of size 2^( 3) =       0.000425302830
  error estimate for blocks of size 2^( 4) =       0.000438189437
  error estimate for blocks of size 2^( 5) =       0.000448887916
  error estimate for blocks of size 2^( 6) =       0.000456006274
  error estimate for blocks of size 2^( 7) =       0.000460567335

      target function =                  N/A
              le_mean =     -16.905766057080
             les_mean =     286.137413965744
             stat err =       0.000450912741
             autocorr =       1.279606499959
              std dev =       0.563727583570
             le_variance =       0.317788788477


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905785881225        initial  <--
     3.6380e-02     3.6380e-01             5.7044e-03       -16.905756617663
     1.4552e-01     1.4552e+00             1.4588e-03       -16.905772748692
     5.8208e-01     5.8208e+00             4.3776e-04       -16.905766057080

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6425
  </log>
  <optVariables href="H2O.s040.opt.xml">
   uu_0                 3.117466e-01 1 1  ON 0
   uu_1                 1.447349e-01 1 1  ON 1
   uu_2                 4.305937e-02 1 1  ON 2
   uu_3                -1.916319e-02 1 1  ON 3
   uu_4                -6.454257e-02 1 1  ON 4
   uu_5                -9.933052e-02 1 1  ON 5
   uu_6                -1.264846e-01 1 1  ON 6
   uu_7                -1.389746e-01 1 1  ON 7
   uu_8                -1.311472e-01 1 1  ON 8
   uu_9                -1.002719e-01 1 1  ON 9
   ud_0                 4.453556e-01 1 1  ON 10
   ud_1                 1.799299e-01 1 1  ON 11
   ud_2                 5.987552e-02 1 1  ON 12
   ud_3                -1.077098e-02 1 1  ON 13
   ud_4                -6.720293e-02 1 1  ON 14
   ud_5                -1.077642e-01 1 1  ON 15
   ud_6                -1.341335e-01 1 1  ON 16
   ud_7                -1.497562e-01 1 1  ON 17
   ud_8                -1.506353e-01 1 1  ON 18
   ud_9                -1.385790e-01 1 1  ON 19
   eO_0                -7.471023e-01 1 1  ON 20
   eO_1                -4.276959e-01 1 1  ON 21
   eO_2                -1.909386e-02 1 1  ON 22
   eO_3                 2.902533e-01 1 1  ON 23
   eO_4                 5.129955e-01 1 1  ON 24
   eO_5                 4.728997e-01 1 1  ON 25
   eO_6                 2.454289e-01 1 1  ON 26
   eO_7                -4.920878e-02 1 1  ON 27
   eO_8                -2.099738e-01 1 1  ON 28
   eO_9                -6.984475e-02 1 1  ON 29
  eH1_0                -2.490206e-01 1 1  ON 30
  eH1_1                -1.409925e-01 1 1  ON 31
  eH1_2                -9.187005e-02 1 1  ON 32
  eH1_3                -3.738697e-02 1 1  ON 33
  eH1_4                 1.162684e-02 1 1  ON 34
  eH1_5                 4.535258e-02 1 1  ON 35
  eH1_6                 1.014843e-01 1 1  ON 36
  eH1_7                 1.507892e-01 1 1  ON 37
  eH1_8                 1.645661e-01 1 1  ON 38
  eH1_9                 4.967009e-02 1 1  ON 39
  eH2_0                -2.461096e-01 1 1  ON 40
  eH2_1                -1.390207e-01 1 1  ON 41
  eH2_2                -8.955714e-02 1 1  ON 42
  eH2_3                -3.460080e-02 1 1  ON 43
  eH2_4                 1.430580e-02 1 1  ON 44
  eH2_5                 4.961410e-02 1 1  ON 45
  eH2_6                 1.052412e-01 1 1  ON 46
  eH2_7                 1.534274e-01 1 1  ON 47
  eH2_8                 1.693283e-01 1 1  ON 48
  eH2_9                 3.485419e-02 1 1  ON 49
ci_0001                 7.014419e-01 3 1  ON 50
ci_0002                 7.000949e-01 3 1  ON 51
ci_0003                -2.781888e-02 3 1  ON 52
ci_0004                -2.749184e-02 3 1  ON 53
ci_0005                -3.666110e-02 3 1  ON 54
ci_0006                -3.710266e-02 3 1  ON 55
ci_0007                -2.252766e-02 3 1  ON 56
ci_0008                -2.153869e-02 3 1  ON 57
ci_0009                -1.785501e-02 3 1  ON 58
ci_0010                -1.751127e-02 3 1  ON 59
ci_0011                -1.220422e-02 3 1  ON 60
ci_0012                -1.234233e-02 3 1  ON 61
ci_0013                 1.300126e-02 3 1  ON 62
ci_0014                 1.317508e-02 3 1  ON 63
ci_0015                 1.363302e-02 3 1  ON 64
ci_0016                 1.350312e-02 3 1  ON 65
ci_0017                 1.098051e-02 3 1  ON 66
ci_0018                 1.192494e-02 3 1  ON 67
ci_0019                 1.136554e-02 3 1  ON 68
ci_0020                 1.154858e-02 3 1  ON 69
ci_0021                -2.108756e-03 3 1  ON 70
ci_0022                -4.907121e-04 3 1  ON 71
ci_0023                -1.110230e-02 3 1  ON 72
ci_0024                -1.090613e-02 3 1  ON 73
ci_0025                -1.175971e-02 3 1  ON 74
ci_0026                -1.107794e-02 3 1  ON 75
ci_0027                -1.166839e-02 3 1  ON 76
ci_0028                -1.083096e-02 3 1  ON 77
ci_0029                -9.938147e-03 3 1  ON 78
ci_0030                -1.127495e-02 3 1  ON 79
ci_0031                 2.037366e-02 3 1  ON 80
ci_0032                 2.130484e-02 3 1  ON 81
ci_0033                 1.035333e-02 3 1  ON 82
ci_0034                 9.795926e-03 3 1  ON 83
ci_0035                 6.436022e-03 3 1  ON 84
ci_0036                 6.888915e-03 3 1  ON 85
ci_0037                -1.058394e-02 3 1  ON 86
ci_0038                -1.119881e-02 3 1  ON 87
ci_0039                -2.527403e-03 3 1  ON 88
ci_0040                -2.769470e-03 3 1  ON 89
ci_0041                 6.630024e-03 3 1  ON 90
ci_0042                 7.336551e-03 3 1  ON 91
ci_0043                -1.946141e-02 3 1  ON 92
ci_0044                -1.898788e-02 3 1  ON 93
ci_0045                 7.483316e-03 3 1  ON 94
ci_0046                 7.404229e-03 3 1  ON 95
ci_0047                -1.543637e-03 3 1  ON 96
ci_0048                -1.862193e-03 3 1  ON 97
ci_0049                -5.341840e-03 3 1  ON 98
ci_0050                -5.923245e-03 3 1  ON 99
ci_0051                -3.617855e-03 3 1  ON 100
ci_0052                -3.392993e-03 3 1  ON 101
ci_0053                -4.473602e-03 3 1  ON 102
ci_0054                -4.327524e-03 3 1  ON 103
ci_0055                 6.385534e-03 3 1  ON 104
ci_0056                 6.300510e-03 3 1  ON 105
ci_0057                 4.732817e-03 3 1  ON 106
ci_0058                 4.831970e-03 3 1  ON 107
ci_0059                -4.598598e-03 3 1  ON 108
ci_0060                -4.623538e-03 3 1  ON 109
ci_0061                -4.540044e-03 3 1  ON 110
ci_0062                -3.761879e-03 3 1  ON 111
ci_0063                -9.156151e-03 3 1  ON 112
ci_0064                -8.238193e-03 3 1  ON 113
ci_0065                -5.041570e-03 3 1  ON 114
ci_0066                -5.118350e-03 3 1  ON 115
ci_0067                -5.305826e-03 3 1  ON 116
ci_0068                -4.970048e-03 3 1  ON 117
ci_0069                 4.618136e-03 3 1  ON 118
ci_0070                 4.551943e-03 3 1  ON 119
ci_0071                 5.549436e-04 3 1  ON 120
ci_0072                -4.247575e-04 3 1  ON 121
ci_0073                 4.248397e-03 3 1  ON 122
ci_0074                 4.068964e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8233e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.8449
    reference variance = 0.208915
====================================================
  Execution time = 2.1403e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5229e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3325e-01
  Total weights = 1.951534475e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0778e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320650730005
                                         uncertainty =       0.002194308127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320650730005
                                         uncertainty =       0.002194308127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400400464
  error estimate for blocks of size 2^( 2) =       0.000413561770
  error estimate for blocks of size 2^( 3) =       0.000426546638
  error estimate for blocks of size 2^( 4) =       0.000438568111
  error estimate for blocks of size 2^( 5) =       0.000448788952
  error estimate for blocks of size 2^( 6) =       0.000456714951
  error estimate for blocks of size 2^( 7) =       0.000460506168

      target function =                  N/A
              le_mean =     -16.906184438549
             les_mean =     286.152318377531
             stat err =       0.000451144546
             autocorr =       1.269527982753
              std dev =       0.566251766480
             le_variance =       0.320641063042


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690618443855e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906184438554       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906185780834       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906186407387       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906187730661       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906186256398       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906187843993       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906188962572       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906189311865       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906189300144       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906189274072       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906188999263       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906188950571       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.6380e-01 is 5.960162e-04

solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906184438554       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906184908193       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906184822903       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906185304785       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906185530264       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906185520600       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906185813393       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906185857682       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906185872611       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906185944700       residual = 9.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4552e+00 is 1.892574e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906184438554       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906184568992       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906184523043       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906184637845       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906184752191       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906184719961       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906184787485       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906184803518       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906184809535       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906184834398       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.8208e+00 is 5.286089e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.479692 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7489e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
   uu_0                 3.118122e-01 1 1  ON 0
   uu_1                 1.447252e-01 1 1  ON 1
   uu_2                 4.307130e-02 1 1  ON 2
   uu_3                -1.917615e-02 1 1  ON 3
   uu_4                -6.452399e-02 1 1  ON 4
   uu_5                -9.934306e-02 1 1  ON 5
   uu_6                -1.264922e-01 1 1  ON 6
   uu_7                -1.390013e-01 1 1  ON 7
   uu_8                -1.312224e-01 1 1  ON 8
   uu_9                -1.003171e-01 1 1  ON 9
   ud_0                 4.455224e-01 1 1  ON 10
   ud_1                 1.799562e-01 1 1  ON 11
   ud_2                 5.988962e-02 1 1  ON 12
   ud_3                -1.072387e-02 1 1  ON 13
   ud_4                -6.715248e-02 1 1  ON 14
   ud_5                -1.077560e-01 1 1  ON 15
   ud_6                -1.342177e-01 1 1  ON 16
   ud_7                -1.498303e-01 1 1  ON 17
   ud_8                -1.506573e-01 1 1  ON 18
   ud_9                -1.386831e-01 1 1  ON 19
   eO_0                -7.471053e-01 1 1  ON 20
   eO_1                -4.276501e-01 1 1  ON 21
   eO_2                -1.916049e-02 1 1  ON 22
   eO_3                 2.902426e-01 1 1  ON 23
   eO_4                 5.129952e-01 1 1  ON 24
   eO_5                 4.730226e-01 1 1  ON 25
   eO_6                 2.455221e-01 1 1  ON 26
   eO_7                -4.915390e-02 1 1  ON 27
   eO_8                -2.100687e-01 1 1  ON 28
   eO_9                -6.996773e-02 1 1  ON 29
  eH1_0                -2.490773e-01 1 1  ON 30
  eH1_1                -1.411230e-01 1 1  ON 31
  eH1_2                -9.190407e-02 1 1  ON 32
  eH1_3                -3.742454e-02 1 1  ON 33
  eH1_4                 1.158925e-02 1 1  ON 34
  eH1_5                 4.537511e-02 1 1  ON 35
  eH1_6                 1.014749e-01 1 1  ON 36
  eH1_7                 1.508119e-01 1 1  ON 37
  eH1_8                 1.646804e-01 1 1  ON 38
  eH1_9                 4.979868e-02 1 1  ON 39
  eH2_0                -2.462403e-01 1 1  ON 40
  eH2_1                -1.390521e-01 1 1  ON 41
  eH2_2                -8.958931e-02 1 1  ON 42
  eH2_3                -3.456520e-02 1 1  ON 43
  eH2_4                 1.432322e-02 1 1  ON 44
  eH2_5                 4.944401e-02 1 1  ON 45
  eH2_6                 1.052014e-01 1 1  ON 46
  eH2_7                 1.535286e-01 1 1  ON 47
  eH2_8                 1.694690e-01 1 1  ON 48
  eH2_9                 3.497503e-02 1 1  ON 49
ci_0001                 7.014084e-01 3 1  ON 50
ci_0002                 7.001418e-01 3 1  ON 51
ci_0003                -2.783433e-02 3 1  ON 52
ci_0004                -2.748050e-02 3 1  ON 53
ci_0005                -3.672421e-02 3 1  ON 54
ci_0006                -3.702326e-02 3 1  ON 55
ci_0007                -2.244792e-02 3 1  ON 56
ci_0008                -2.142892e-02 3 1  ON 57
ci_0009                -1.770557e-02 3 1  ON 58
ci_0010                -1.751468e-02 3 1  ON 59
ci_0011                -1.212885e-02 3 1  ON 60
ci_0012                -1.239228e-02 3 1  ON 61
ci_0013                 1.307159e-02 3 1  ON 62
ci_0014                 1.311189e-02 3 1  ON 63
ci_0015                 1.351120e-02 3 1  ON 64
ci_0016                 1.341120e-02 3 1  ON 65
ci_0017                 1.106430e-02 3 1  ON 66
ci_0018                 1.173569e-02 3 1  ON 67
ci_0019                 1.130741e-02 3 1  ON 68
ci_0020                 1.150219e-02 3 1  ON 69
ci_0021                -2.094264e-03 3 1  ON 70
ci_0022                -5.884249e-04 3 1  ON 71
ci_0023                -1.122101e-02 3 1  ON 72
ci_0024                -1.088080e-02 3 1  ON 73
ci_0025                -1.160342e-02 3 1  ON 74
ci_0026                -1.113190e-02 3 1  ON 75
ci_0027                -1.160504e-02 3 1  ON 76
ci_0028                -1.088540e-02 3 1  ON 77
ci_0029                -1.011355e-02 3 1  ON 78
ci_0030                -1.128633e-02 3 1  ON 79
ci_0031                 2.037823e-02 3 1  ON 80
ci_0032                 2.130385e-02 3 1  ON 81
ci_0033                 1.028867e-02 3 1  ON 82
ci_0034                 9.792568e-03 3 1  ON 83
ci_0035                 6.545135e-03 3 1  ON 84
ci_0036                 6.854437e-03 3 1  ON 85
ci_0037                -1.060371e-02 3 1  ON 86
ci_0038                -1.109121e-02 3 1  ON 87
ci_0039                -2.550316e-03 3 1  ON 88
ci_0040                -2.744310e-03 3 1  ON 89
ci_0041                 6.692784e-03 3 1  ON 90
ci_0042                 7.316074e-03 3 1  ON 91
ci_0043                -1.942061e-02 3 1  ON 92
ci_0044                -1.908398e-02 3 1  ON 93
ci_0045                 7.465209e-03 3 1  ON 94
ci_0046                 7.479448e-03 3 1  ON 95
ci_0047                -1.652476e-03 3 1  ON 96
ci_0048                -1.905836e-03 3 1  ON 97
ci_0049                -5.372262e-03 3 1  ON 98
ci_0050                -5.913699e-03 3 1  ON 99
ci_0051                -3.596498e-03 3 1  ON 100
ci_0052                -3.345066e-03 3 1  ON 101
ci_0053                -4.552939e-03 3 1  ON 102
ci_0054                -4.370338e-03 3 1  ON 103
ci_0055                 6.423678e-03 3 1  ON 104
ci_0056                 6.307254e-03 3 1  ON 105
ci_0057                 4.828236e-03 3 1  ON 106
ci_0058                 4.852713e-03 3 1  ON 107
ci_0059                -4.730424e-03 3 1  ON 108
ci_0060                -4.551065e-03 3 1  ON 109
ci_0061                -4.631306e-03 3 1  ON 110
ci_0062                -3.874036e-03 3 1  ON 111
ci_0063                -9.015785e-03 3 1  ON 112
ci_0064                -8.271425e-03 3 1  ON 113
ci_0065                -5.194584e-03 3 1  ON 114
ci_0066                -5.133386e-03 3 1  ON 115
ci_0067                -5.142274e-03 3 1  ON 116
ci_0068                -4.875679e-03 3 1  ON 117
ci_0069                 4.677653e-03 3 1  ON 118
ci_0070                 4.543407e-03 3 1  ON 119
ci_0071                 4.810858e-04 3 1  ON 120
ci_0072                -3.692632e-04 3 1  ON 121
ci_0073                 4.327391e-03 3 1  ON 122
ci_0074                 4.051493e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.8554
    reference variance = 0.360256
====================================================
  Execution time = 2.1328e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3550e-01
  Total weights = 1.9517e+06
  Execution time = 1.8942e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320264896035
                                         uncertainty =       0.002260486031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320264896035
                                         uncertainty =       0.002260486031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400149518
  error estimate for blocks of size 2^( 2) =       0.000412882971
  error estimate for blocks of size 2^( 3) =       0.000426179507
  error estimate for blocks of size 2^( 4) =       0.000438107296
  error estimate for blocks of size 2^( 5) =       0.000447620953
  error estimate for blocks of size 2^( 6) =       0.000455245022
  error estimate for blocks of size 2^( 7) =       0.000461989925

      target function =                  N/A
              le_mean =     -16.905707062040
             les_mean =     286.138614801187
             stat err =       0.000450740799
             autocorr =       1.268846668088
              std dev =       0.565896875633
             le_variance =       0.320239273851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320637677343
                                         uncertainty =       0.002263968297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320637677343
                                         uncertainty =       0.002263968297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400381750
  error estimate for blocks of size 2^( 2) =       0.000413101766
  error estimate for blocks of size 2^( 3) =       0.000426374245
  error estimate for blocks of size 2^( 4) =       0.000438305527
  error estimate for blocks of size 2^( 5) =       0.000447815051
  error estimate for blocks of size 2^( 6) =       0.000455430105
  error estimate for blocks of size 2^( 7) =       0.000462177069

      target function =                  N/A
              le_mean =     -16.905692680563
             les_mean =     286.375285578288
             stat err =       0.000450931938
             autocorr =       1.268450270825
              std dev =       0.566225300686
             le_variance =       0.320611091137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320428689325
                                         uncertainty =       0.002260412711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320428689325
                                         uncertainty =       0.002260412711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400251680
  error estimate for blocks of size 2^( 2) =       0.000412978557
  error estimate for blocks of size 2^( 3) =       0.000426269662
  error estimate for blocks of size 2^( 4) =       0.000438200600
  error estimate for blocks of size 2^( 5) =       0.000447710640
  error estimate for blocks of size 2^( 6) =       0.000455335177
  error estimate for blocks of size 2^( 7) =       0.000462070354

      target function =                  N/A
              le_mean =     -16.905701712314
             les_mean =     286.138243428220
             stat err =       0.000450829193
             autocorr =       1.268696478159
              std dev =       0.566041353979
             le_variance =       0.320402814414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320287120558
                                         uncertainty =       0.002260402468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320287120558
                                         uncertainty =       0.002260402468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400163383
  error estimate for blocks of size 2^( 2) =       0.000412895787
  error estimate for blocks of size 2^( 3) =       0.000426191469
  error estimate for blocks of size 2^( 4) =       0.000438119597
  error estimate for blocks of size 2^( 5) =       0.000447632677
  error estimate for blocks of size 2^( 6) =       0.000455256919
  error estimate for blocks of size 2^( 7) =       0.000462000559

      target function =                  N/A
              le_mean =     -16.905705802594
             les_mean =     286.138492245302
             stat err =       0.000450752438
             autocorr =       1.268824269697
              std dev =       0.565916483183
             le_variance =       0.320261465938


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905707062040        initial  <--
     3.6380e-01     3.6380e+00             5.9602e-04       -16.905692680563
     1.4552e+00     1.4552e+01             1.8926e-04       -16.905701712314
     5.8208e+00     5.8208e+01             5.2861e-05       -16.905705802594

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8929
  </log>
  <optVariables href="H2O.s041.opt.xml">
   uu_0                 3.117466e-01 1 1  ON 0
   uu_1                 1.447349e-01 1 1  ON 1
   uu_2                 4.305937e-02 1 1  ON 2
   uu_3                -1.916319e-02 1 1  ON 3
   uu_4                -6.454257e-02 1 1  ON 4
   uu_5                -9.933052e-02 1 1  ON 5
   uu_6                -1.264846e-01 1 1  ON 6
   uu_7                -1.389746e-01 1 1  ON 7
   uu_8                -1.311472e-01 1 1  ON 8
   uu_9                -1.002719e-01 1 1  ON 9
   ud_0                 4.453556e-01 1 1  ON 10
   ud_1                 1.799299e-01 1 1  ON 11
   ud_2                 5.987552e-02 1 1  ON 12
   ud_3                -1.077098e-02 1 1  ON 13
   ud_4                -6.720293e-02 1 1  ON 14
   ud_5                -1.077642e-01 1 1  ON 15
   ud_6                -1.341335e-01 1 1  ON 16
   ud_7                -1.497562e-01 1 1  ON 17
   ud_8                -1.506353e-01 1 1  ON 18
   ud_9                -1.385790e-01 1 1  ON 19
   eO_0                -7.471023e-01 1 1  ON 20
   eO_1                -4.276959e-01 1 1  ON 21
   eO_2                -1.909386e-02 1 1  ON 22
   eO_3                 2.902533e-01 1 1  ON 23
   eO_4                 5.129955e-01 1 1  ON 24
   eO_5                 4.728997e-01 1 1  ON 25
   eO_6                 2.454289e-01 1 1  ON 26
   eO_7                -4.920878e-02 1 1  ON 27
   eO_8                -2.099738e-01 1 1  ON 28
   eO_9                -6.984475e-02 1 1  ON 29
  eH1_0                -2.490206e-01 1 1  ON 30
  eH1_1                -1.409925e-01 1 1  ON 31
  eH1_2                -9.187005e-02 1 1  ON 32
  eH1_3                -3.738697e-02 1 1  ON 33
  eH1_4                 1.162684e-02 1 1  ON 34
  eH1_5                 4.535258e-02 1 1  ON 35
  eH1_6                 1.014843e-01 1 1  ON 36
  eH1_7                 1.507892e-01 1 1  ON 37
  eH1_8                 1.645661e-01 1 1  ON 38
  eH1_9                 4.967009e-02 1 1  ON 39
  eH2_0                -2.461096e-01 1 1  ON 40
  eH2_1                -1.390207e-01 1 1  ON 41
  eH2_2                -8.955714e-02 1 1  ON 42
  eH2_3                -3.460080e-02 1 1  ON 43
  eH2_4                 1.430580e-02 1 1  ON 44
  eH2_5                 4.961410e-02 1 1  ON 45
  eH2_6                 1.052412e-01 1 1  ON 46
  eH2_7                 1.534274e-01 1 1  ON 47
  eH2_8                 1.693283e-01 1 1  ON 48
  eH2_9                 3.485419e-02 1 1  ON 49
ci_0001                 7.014419e-01 3 1  ON 50
ci_0002                 7.000949e-01 3 1  ON 51
ci_0003                -2.781888e-02 3 1  ON 52
ci_0004                -2.749184e-02 3 1  ON 53
ci_0005                -3.666110e-02 3 1  ON 54
ci_0006                -3.710266e-02 3 1  ON 55
ci_0007                -2.252766e-02 3 1  ON 56
ci_0008                -2.153869e-02 3 1  ON 57
ci_0009                -1.785501e-02 3 1  ON 58
ci_0010                -1.751127e-02 3 1  ON 59
ci_0011                -1.220422e-02 3 1  ON 60
ci_0012                -1.234233e-02 3 1  ON 61
ci_0013                 1.300126e-02 3 1  ON 62
ci_0014                 1.317508e-02 3 1  ON 63
ci_0015                 1.363302e-02 3 1  ON 64
ci_0016                 1.350312e-02 3 1  ON 65
ci_0017                 1.098051e-02 3 1  ON 66
ci_0018                 1.192494e-02 3 1  ON 67
ci_0019                 1.136554e-02 3 1  ON 68
ci_0020                 1.154858e-02 3 1  ON 69
ci_0021                -2.108756e-03 3 1  ON 70
ci_0022                -4.907121e-04 3 1  ON 71
ci_0023                -1.110230e-02 3 1  ON 72
ci_0024                -1.090613e-02 3 1  ON 73
ci_0025                -1.175971e-02 3 1  ON 74
ci_0026                -1.107794e-02 3 1  ON 75
ci_0027                -1.166839e-02 3 1  ON 76
ci_0028                -1.083096e-02 3 1  ON 77
ci_0029                -9.938147e-03 3 1  ON 78
ci_0030                -1.127495e-02 3 1  ON 79
ci_0031                 2.037366e-02 3 1  ON 80
ci_0032                 2.130484e-02 3 1  ON 81
ci_0033                 1.035333e-02 3 1  ON 82
ci_0034                 9.795926e-03 3 1  ON 83
ci_0035                 6.436022e-03 3 1  ON 84
ci_0036                 6.888915e-03 3 1  ON 85
ci_0037                -1.058394e-02 3 1  ON 86
ci_0038                -1.119881e-02 3 1  ON 87
ci_0039                -2.527403e-03 3 1  ON 88
ci_0040                -2.769470e-03 3 1  ON 89
ci_0041                 6.630024e-03 3 1  ON 90
ci_0042                 7.336551e-03 3 1  ON 91
ci_0043                -1.946141e-02 3 1  ON 92
ci_0044                -1.898788e-02 3 1  ON 93
ci_0045                 7.483316e-03 3 1  ON 94
ci_0046                 7.404229e-03 3 1  ON 95
ci_0047                -1.543637e-03 3 1  ON 96
ci_0048                -1.862193e-03 3 1  ON 97
ci_0049                -5.341840e-03 3 1  ON 98
ci_0050                -5.923245e-03 3 1  ON 99
ci_0051                -3.617855e-03 3 1  ON 100
ci_0052                -3.392993e-03 3 1  ON 101
ci_0053                -4.473602e-03 3 1  ON 102
ci_0054                -4.327524e-03 3 1  ON 103
ci_0055                 6.385534e-03 3 1  ON 104
ci_0056                 6.300510e-03 3 1  ON 105
ci_0057                 4.732817e-03 3 1  ON 106
ci_0058                 4.831970e-03 3 1  ON 107
ci_0059                -4.598598e-03 3 1  ON 108
ci_0060                -4.623538e-03 3 1  ON 109
ci_0061                -4.540044e-03 3 1  ON 110
ci_0062                -3.761879e-03 3 1  ON 111
ci_0063                -9.156151e-03 3 1  ON 112
ci_0064                -8.238193e-03 3 1  ON 113
ci_0065                -5.041570e-03 3 1  ON 114
ci_0066                -5.118350e-03 3 1  ON 115
ci_0067                -5.305826e-03 3 1  ON 116
ci_0068                -4.970048e-03 3 1  ON 117
ci_0069                 4.618136e-03 3 1  ON 118
ci_0070                 4.551943e-03 3 1  ON 119
ci_0071                 5.549436e-04 3 1  ON 120
ci_0072                -4.247575e-04 3 1  ON 121
ci_0073                 4.248397e-03 3 1  ON 122
ci_0074                 4.068964e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8389e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.8747
    reference variance = 0.260005
====================================================
  Execution time = 2.3306e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5248e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3632e-01
  Total weights = 1.951726418e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0697e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319498531848
                                         uncertainty =       0.001964245571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319498531848
                                         uncertainty =       0.001964245571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399704012
  error estimate for blocks of size 2^( 2) =       0.000412855654
  error estimate for blocks of size 2^( 3) =       0.000426222362
  error estimate for blocks of size 2^( 4) =       0.000440051456
  error estimate for blocks of size 2^( 5) =       0.000451542666
  error estimate for blocks of size 2^( 6) =       0.000458882669
  error estimate for blocks of size 2^( 7) =       0.000465921007

      target function =                  N/A
              le_mean =     -16.905177143655
             les_mean =     286.121338350621
             stat err =       0.000454099449
             autocorr =       1.290698884520
              std dev =       0.565266835215
             le_variance =       0.319526594993


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690517714366e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905177143621       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905178164388       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905178322328       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905178049379       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905178169276       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905178090594       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905178124481       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905178061917       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905178085153       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905178100729       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.6380e+00 is 1.697287e-04

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905177143621       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905177409212       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905177449985       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905177380087       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905177409939       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905177387486       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905177394063       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905177379504       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905177383574       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905177387807       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4552e+01 is 4.338996e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905177143621       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905177210702       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905177220989       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905177203430       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905177210885       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905177205046       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905177206542       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905177202983       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905177203884       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905177204960       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.8208e+01 is 1.090937e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.483648 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9384e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
   uu_0                 3.117573e-01 1 1  ON 0
   uu_1                 1.447386e-01 1 1  ON 1
   uu_2                 4.305741e-02 1 1  ON 2
   uu_3                -1.916858e-02 1 1  ON 3
   uu_4                -6.455447e-02 1 1  ON 4
   uu_5                -9.933465e-02 1 1  ON 5
   uu_6                -1.264875e-01 1 1  ON 6
   uu_7                -1.389863e-01 1 1  ON 7
   uu_8                -1.311482e-01 1 1  ON 8
   uu_9                -1.002698e-01 1 1  ON 9
   ud_0                 4.453593e-01 1 1  ON 10
   ud_1                 1.799237e-01 1 1  ON 11
   ud_2                 5.987477e-02 1 1  ON 12
   ud_3                -1.077190e-02 1 1  ON 13
   ud_4                -6.719614e-02 1 1  ON 14
   ud_5                -1.077724e-01 1 1  ON 15
   ud_6                -1.341367e-01 1 1  ON 16
   ud_7                -1.497560e-01 1 1  ON 17
   ud_8                -1.506265e-01 1 1  ON 18
   ud_9                -1.385748e-01 1 1  ON 19
   eO_0                -7.471011e-01 1 1  ON 20
   eO_1                -4.277071e-01 1 1  ON 21
   eO_2                -1.909174e-02 1 1  ON 22
   eO_3                 2.902585e-01 1 1  ON 23
   eO_4                 5.129985e-01 1 1  ON 24
   eO_5                 4.729056e-01 1 1  ON 25
   eO_6                 2.454310e-01 1 1  ON 26
   eO_7                -4.920350e-02 1 1  ON 27
   eO_8                -2.099782e-01 1 1  ON 28
   eO_9                -6.985282e-02 1 1  ON 29
  eH1_0                -2.490244e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187776e-02 1 1  ON 32
  eH1_3                -3.738886e-02 1 1  ON 33
  eH1_4                 1.161703e-02 1 1  ON 34
  eH1_5                 4.534408e-02 1 1  ON 35
  eH1_6                 1.014795e-01 1 1  ON 36
  eH1_7                 1.507992e-01 1 1  ON 37
  eH1_8                 1.645846e-01 1 1  ON 38
  eH1_9                 4.968649e-02 1 1  ON 39
  eH2_0                -2.461160e-01 1 1  ON 40
  eH2_1                -1.390223e-01 1 1  ON 41
  eH2_2                -8.956757e-02 1 1  ON 42
  eH2_3                -3.460487e-02 1 1  ON 43
  eH2_4                 1.431091e-02 1 1  ON 44
  eH2_5                 4.960631e-02 1 1  ON 45
  eH2_6                 1.052335e-01 1 1  ON 46
  eH2_7                 1.534321e-01 1 1  ON 47
  eH2_8                 1.693388e-01 1 1  ON 48
  eH2_9                 3.487027e-02 1 1  ON 49
ci_0001                 7.014485e-01 3 1  ON 50
ci_0002                 7.000892e-01 3 1  ON 51
ci_0003                -2.780814e-02 3 1  ON 52
ci_0004                -2.749638e-02 3 1  ON 53
ci_0005                -3.666548e-02 3 1  ON 54
ci_0006                -3.710098e-02 3 1  ON 55
ci_0007                -2.251440e-02 3 1  ON 56
ci_0008                -2.154657e-02 3 1  ON 57
ci_0009                -1.785378e-02 3 1  ON 58
ci_0010                -1.750750e-02 3 1  ON 59
ci_0011                -1.218568e-02 3 1  ON 60
ci_0012                -1.234907e-02 3 1  ON 61
ci_0013                 1.300548e-02 3 1  ON 62
ci_0014                 1.317717e-02 3 1  ON 63
ci_0015                 1.362350e-02 3 1  ON 64
ci_0016                 1.349628e-02 3 1  ON 65
ci_0017                 1.099786e-02 3 1  ON 66
ci_0018                 1.190650e-02 3 1  ON 67
ci_0019                 1.135413e-02 3 1  ON 68
ci_0020                 1.154266e-02 3 1  ON 69
ci_0021                -2.097761e-03 3 1  ON 70
ci_0022                -4.831231e-04 3 1  ON 71
ci_0023                -1.110129e-02 3 1  ON 72
ci_0024                -1.090353e-02 3 1  ON 73
ci_0025                -1.172842e-02 3 1  ON 74
ci_0026                -1.108435e-02 3 1  ON 75
ci_0027                -1.167725e-02 3 1  ON 76
ci_0028                -1.083601e-02 3 1  ON 77
ci_0029                -9.943239e-03 3 1  ON 78
ci_0030                -1.126513e-02 3 1  ON 79
ci_0031                 2.036500e-02 3 1  ON 80
ci_0032                 2.129801e-02 3 1  ON 81
ci_0033                 1.033932e-02 3 1  ON 82
ci_0034                 9.839316e-03 3 1  ON 83
ci_0035                 6.445356e-03 3 1  ON 84
ci_0036                 6.895554e-03 3 1  ON 85
ci_0037                -1.059036e-02 3 1  ON 86
ci_0038                -1.118388e-02 3 1  ON 87
ci_0039                -2.536918e-03 3 1  ON 88
ci_0040                -2.766456e-03 3 1  ON 89
ci_0041                 6.649690e-03 3 1  ON 90
ci_0042                 7.329633e-03 3 1  ON 91
ci_0043                -1.945450e-02 3 1  ON 92
ci_0044                -1.898930e-02 3 1  ON 93
ci_0045                 7.491429e-03 3 1  ON 94
ci_0046                 7.417669e-03 3 1  ON 95
ci_0047                -1.565407e-03 3 1  ON 96
ci_0048                -1.869290e-03 3 1  ON 97
ci_0049                -5.338796e-03 3 1  ON 98
ci_0050                -5.922563e-03 3 1  ON 99
ci_0051                -3.617623e-03 3 1  ON 100
ci_0052                -3.402254e-03 3 1  ON 101
ci_0053                -4.481812e-03 3 1  ON 102
ci_0054                -4.336761e-03 3 1  ON 103
ci_0055                 6.394444e-03 3 1  ON 104
ci_0056                 6.313046e-03 3 1  ON 105
ci_0057                 4.732200e-03 3 1  ON 106
ci_0058                 4.856173e-03 3 1  ON 107
ci_0059                -4.594526e-03 3 1  ON 108
ci_0060                -4.608683e-03 3 1  ON 109
ci_0061                -4.530369e-03 3 1  ON 110
ci_0062                -3.767708e-03 3 1  ON 111
ci_0063                -9.158133e-03 3 1  ON 112
ci_0064                -8.249155e-03 3 1  ON 113
ci_0065                -5.052154e-03 3 1  ON 114
ci_0066                -5.115722e-03 3 1  ON 115
ci_0067                -5.293529e-03 3 1  ON 116
ci_0068                -4.976689e-03 3 1  ON 117
ci_0069                 4.622603e-03 3 1  ON 118
ci_0070                 4.537689e-03 3 1  ON 119
ci_0071                 5.476408e-04 3 1  ON 120
ci_0072                -4.069182e-04 3 1  ON 121
ci_0073                 4.240135e-03 3 1  ON 122
ci_0074                 4.080714e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.9857
    reference variance = 0.922001
====================================================
  Execution time = 2.1480e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3445e-01
  Total weights = 1.9516e+06
  Execution time = 1.8982e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319581007166
                                         uncertainty =       0.002168343807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319581007166
                                         uncertainty =       0.002168343807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399797230
  error estimate for blocks of size 2^( 2) =       0.000412183043
  error estimate for blocks of size 2^( 3) =       0.000425523952
  error estimate for blocks of size 2^( 4) =       0.000438193714
  error estimate for blocks of size 2^( 5) =       0.000448514423
  error estimate for blocks of size 2^( 6) =       0.000454570177
  error estimate for blocks of size 2^( 7) =       0.000460170685

      target function =                  N/A
              le_mean =     -16.905909356895
             les_mean =     286.144267088825
             stat err =       0.000450362250
             autocorr =       1.268949669700
              std dev =       0.565398665550
             le_variance =       0.319675651006

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319548470117
                                         uncertainty =       0.002152684826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319548470117
                                         uncertainty =       0.002152684826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399777097
  error estimate for blocks of size 2^( 2) =       0.000412161100
  error estimate for blocks of size 2^( 3) =       0.000425500178
  error estimate for blocks of size 2^( 4) =       0.000438167585
  error estimate for blocks of size 2^( 5) =       0.000448490800
  error estimate for blocks of size 2^( 6) =       0.000454547468
  error estimate for blocks of size 2^( 7) =       0.000460150282

      target function =                  N/A
              le_mean =     -16.905908028833
             les_mean =     286.144167601044
             stat err =       0.000450339034
             autocorr =       1.268946646460
              std dev =       0.565370193117
             le_variance =       0.319643455265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319564325125
                                         uncertainty =       0.002160194678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319564325125
                                         uncertainty =       0.002160194678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399786910
  error estimate for blocks of size 2^( 2) =       0.000412171759
  error estimate for blocks of size 2^( 3) =       0.000425511685
  error estimate for blocks of size 2^( 4) =       0.000438180202
  error estimate for blocks of size 2^( 5) =       0.000448502233
  error estimate for blocks of size 2^( 6) =       0.000454558431
  error estimate for blocks of size 2^( 7) =       0.000460160098

      target function =                  N/A
              le_mean =     -16.905908569048
             les_mean =     286.144175591150
             stat err =       0.000450350241
             autocorr =       1.268947511410
              std dev =       0.565384069879
             le_variance =       0.319659146473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319579022171
                                         uncertainty =       0.002167304783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319579022171
                                         uncertainty =       0.002167304783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399796003
  error estimate for blocks of size 2^( 2) =       0.000412181544
  error estimate for blocks of size 2^( 3) =       0.000425522159
  error estimate for blocks of size 2^( 4) =       0.000438192085
  error estimate for blocks of size 2^( 5) =       0.000448512619
  error estimate for blocks of size 2^( 6) =       0.000454569459
  error estimate for blocks of size 2^( 7) =       0.000460168661

      target function =                  N/A
              le_mean =     -16.905909544041
             les_mean =     286.169620823916
             stat err =       0.000450360706
             autocorr =       1.268948764490
              std dev =       0.565396929488
             le_variance =       0.319673687875


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905909356895        initial
     3.6380e+00     3.6380e+01             1.6973e-04       -16.905908028833
     1.4552e+01     1.4552e+02             4.3390e-05       -16.905908569048
     5.8208e+01     5.8208e+02             1.0909e-05       -16.905909544041  <--

*****************************************************************************
Applying the update for shift_i =   5.8208e+01     and shift_s =   5.8208e+02
*****************************************************************************

  Execution time = 3.1066e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
   uu_0                 3.117493e-01 1 1  ON 0
   uu_1                 1.447358e-01 1 1  ON 1
   uu_2                 4.305887e-02 1 1  ON 2
   uu_3                -1.916454e-02 1 1  ON 3
   uu_4                -6.454559e-02 1 1  ON 4
   uu_5                -9.933154e-02 1 1  ON 5
   uu_6                -1.264853e-01 1 1  ON 6
   uu_7                -1.389775e-01 1 1  ON 7
   uu_8                -1.311475e-01 1 1  ON 8
   uu_9                -1.002714e-01 1 1  ON 9
   ud_0                 4.453566e-01 1 1  ON 10
   ud_1                 1.799283e-01 1 1  ON 11
   ud_2                 5.987534e-02 1 1  ON 12
   ud_3                -1.077123e-02 1 1  ON 13
   ud_4                -6.720119e-02 1 1  ON 14
   ud_5                -1.077663e-01 1 1  ON 15
   ud_6                -1.341343e-01 1 1  ON 16
   ud_7                -1.497561e-01 1 1  ON 17
   ud_8                -1.506331e-01 1 1  ON 18
   ud_9                -1.385779e-01 1 1  ON 19
   eO_0                -7.471020e-01 1 1  ON 20
   eO_1                -4.276987e-01 1 1  ON 21
   eO_2                -1.909332e-02 1 1  ON 22
   eO_3                 2.902546e-01 1 1  ON 23
   eO_4                 5.129962e-01 1 1  ON 24
   eO_5                 4.729012e-01 1 1  ON 25
   eO_6                 2.454295e-01 1 1  ON 26
   eO_7                -4.920746e-02 1 1  ON 27
   eO_8                -2.099749e-01 1 1  ON 28
   eO_9                -6.984677e-02 1 1  ON 29
  eH1_0                -2.490215e-01 1 1  ON 30
  eH1_1                -1.409956e-01 1 1  ON 31
  eH1_2                -9.187197e-02 1 1  ON 32
  eH1_3                -3.738743e-02 1 1  ON 33
  eH1_4                 1.162438e-02 1 1  ON 34
  eH1_5                 4.535045e-02 1 1  ON 35
  eH1_6                 1.014831e-01 1 1  ON 36
  eH1_7                 1.507917e-01 1 1  ON 37
  eH1_8                 1.645707e-01 1 1  ON 38
  eH1_9                 4.967419e-02 1 1  ON 39
  eH2_0                -2.461112e-01 1 1  ON 40
  eH2_1                -1.390211e-01 1 1  ON 41
  eH2_2                -8.955976e-02 1 1  ON 42
  eH2_3                -3.460182e-02 1 1  ON 43
  eH2_4                 1.430710e-02 1 1  ON 44
  eH2_5                 4.961214e-02 1 1  ON 45
  eH2_6                 1.052393e-01 1 1  ON 46
  eH2_7                 1.534286e-01 1 1  ON 47
  eH2_8                 1.693309e-01 1 1  ON 48
  eH2_9                 3.485821e-02 1 1  ON 49
ci_0001                 7.014436e-01 3 1  ON 50
ci_0002                 7.000934e-01 3 1  ON 51
ci_0003                -2.781616e-02 3 1  ON 52
ci_0004                -2.749299e-02 3 1  ON 53
ci_0005                -3.666221e-02 3 1  ON 54
ci_0006                -3.710224e-02 3 1  ON 55
ci_0007                -2.252433e-02 3 1  ON 56
ci_0008                -2.154067e-02 3 1  ON 57
ci_0009                -1.785470e-02 3 1  ON 58
ci_0010                -1.751032e-02 3 1  ON 59
ci_0011                -1.219953e-02 3 1  ON 60
ci_0012                -1.234403e-02 3 1  ON 61
ci_0013                 1.300233e-02 3 1  ON 62
ci_0014                 1.317561e-02 3 1  ON 63
ci_0015                 1.363061e-02 3 1  ON 64
ci_0016                 1.350139e-02 3 1  ON 65
ci_0017                 1.098490e-02 3 1  ON 66
ci_0018                 1.192028e-02 3 1  ON 67
ci_0019                 1.136265e-02 3 1  ON 68
ci_0020                 1.154708e-02 3 1  ON 69
ci_0021                -2.105989e-03 3 1  ON 70
ci_0022                -4.888067e-04 3 1  ON 71
ci_0023                -1.110204e-02 3 1  ON 72
ci_0024                -1.090547e-02 3 1  ON 73
ci_0025                -1.175180e-02 3 1  ON 74
ci_0026                -1.107956e-02 3 1  ON 75
ci_0027                -1.167063e-02 3 1  ON 76
ci_0028                -1.083224e-02 3 1  ON 77
ci_0029                -9.939431e-03 3 1  ON 78
ci_0030                -1.127247e-02 3 1  ON 79
ci_0031                 2.037148e-02 3 1  ON 80
ci_0032                 2.130313e-02 3 1  ON 81
ci_0033                 1.034981e-02 3 1  ON 82
ci_0034                 9.806835e-03 3 1  ON 83
ci_0035                 6.438377e-03 3 1  ON 84
ci_0036                 6.890596e-03 3 1  ON 85
ci_0037                -1.058556e-02 3 1  ON 86
ci_0038                -1.119505e-02 3 1  ON 87
ci_0039                -2.529825e-03 3 1  ON 88
ci_0040                -2.768704e-03 3 1  ON 89
ci_0041                 6.634993e-03 3 1  ON 90
ci_0042                 7.334803e-03 3 1  ON 91
ci_0043                -1.945967e-02 3 1  ON 92
ci_0044                -1.898824e-02 3 1  ON 93
ci_0045                 7.485360e-03 3 1  ON 94
ci_0046                 7.407614e-03 3 1  ON 95
ci_0047                -1.549175e-03 3 1  ON 96
ci_0048                -1.863999e-03 3 1  ON 97
ci_0049                -5.341073e-03 3 1  ON 98
ci_0050                -5.923074e-03 3 1  ON 99
ci_0051                -3.617795e-03 3 1  ON 100
ci_0052                -3.395346e-03 3 1  ON 101
ci_0053                -4.475685e-03 3 1  ON 102
ci_0054                -4.329864e-03 3 1  ON 103
ci_0055                 6.387775e-03 3 1  ON 104
ci_0056                 6.303671e-03 3 1  ON 105
ci_0057                 4.732661e-03 3 1  ON 106
ci_0058                 4.838082e-03 3 1  ON 107
ci_0059                -4.597561e-03 3 1  ON 108
ci_0060                -4.619766e-03 3 1  ON 109
ci_0061                -4.537602e-03 3 1  ON 110
ci_0062                -3.763357e-03 3 1  ON 111
ci_0063                -9.156654e-03 3 1  ON 112
ci_0064                -8.240974e-03 3 1  ON 113
ci_0065                -5.044251e-03 3 1  ON 114
ci_0066                -5.117683e-03 3 1  ON 115
ci_0067                -5.302701e-03 3 1  ON 116
ci_0068                -4.971734e-03 3 1  ON 117
ci_0069                 4.619272e-03 3 1  ON 118
ci_0070                 4.548319e-03 3 1  ON 119
ci_0071                 5.530958e-04 3 1  ON 120
ci_0072                -4.202523e-04 3 1  ON 121
ci_0073                 4.246296e-03 3 1  ON 122
ci_0074                 4.071952e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0457e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.7829
    reference variance = 0.356137
====================================================
  Execution time = 2.1496e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3441e-01
  Total weights = 1.951838114e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1112e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320766701682
                                         uncertainty =       0.002186016785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320766701682
                                         uncertainty =       0.002186016785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400419995
  error estimate for blocks of size 2^( 2) =       0.000412980272
  error estimate for blocks of size 2^( 3) =       0.000425854201
  error estimate for blocks of size 2^( 4) =       0.000437948449
  error estimate for blocks of size 2^( 5) =       0.000449647322
  error estimate for blocks of size 2^( 6) =       0.000456545300
  error estimate for blocks of size 2^( 7) =       0.000457457019

      target function =                  N/A
              le_mean =     -16.906039980912
             les_mean =     286.148600831065
             stat err =       0.000450399522
             autocorr =       1.265214998054
              std dev =       0.566279387175
             le_variance =       0.320672344340


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690603998091e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906039980921       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906040383668       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906040367659       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906040331835       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906040359449       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906040296100       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906040283858       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906040292184       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906040292862       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906040296499       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4552e+01 is 2.506084e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906039980921       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906040082743       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906040078606       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906040069571       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906040076448       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906040060585       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906040057189       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906040059140       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906040059312       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906040060168       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.8208e+01 is 6.340468e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906039980921       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906040006448       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906040005406       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906040003142       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906040004859       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906040000892       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906040000020       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906040000500       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906040000544       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906040000754       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3283e+02 is 1.589887e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.487545 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7615e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
   uu_0                 3.117550e-01 1 1  ON 0
   uu_1                 1.447355e-01 1 1  ON 1
   uu_2                 4.305812e-02 1 1  ON 2
   uu_3                -1.916637e-02 1 1  ON 3
   uu_4                -6.454494e-02 1 1  ON 4
   uu_5                -9.933222e-02 1 1  ON 5
   uu_6                -1.264852e-01 1 1  ON 6
   uu_7                -1.389794e-01 1 1  ON 7
   uu_8                -1.311503e-01 1 1  ON 8
   uu_9                -1.002735e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799290e-01 1 1  ON 11
   ud_2                 5.987680e-02 1 1  ON 12
   ud_3                -1.077054e-02 1 1  ON 13
   ud_4                -6.720150e-02 1 1  ON 14
   ud_5                -1.077672e-01 1 1  ON 15
   ud_6                -1.341371e-01 1 1  ON 16
   ud_7                -1.497568e-01 1 1  ON 17
   ud_8                -1.506342e-01 1 1  ON 18
   ud_9                -1.385798e-01 1 1  ON 19
   eO_0                -7.471025e-01 1 1  ON 20
   eO_1                -4.276987e-01 1 1  ON 21
   eO_2                -1.909147e-02 1 1  ON 22
   eO_3                 2.902532e-01 1 1  ON 23
   eO_4                 5.129964e-01 1 1  ON 24
   eO_5                 4.729030e-01 1 1  ON 25
   eO_6                 2.454316e-01 1 1  ON 26
   eO_7                -4.920583e-02 1 1  ON 27
   eO_8                -2.099778e-01 1 1  ON 28
   eO_9                -6.984924e-02 1 1  ON 29
  eH1_0                -2.490230e-01 1 1  ON 30
  eH1_1                -1.409978e-01 1 1  ON 31
  eH1_2                -9.187331e-02 1 1  ON 32
  eH1_3                -3.738691e-02 1 1  ON 33
  eH1_4                 1.162353e-02 1 1  ON 34
  eH1_5                 4.535125e-02 1 1  ON 35
  eH1_6                 1.014816e-01 1 1  ON 36
  eH1_7                 1.507924e-01 1 1  ON 37
  eH1_8                 1.645737e-01 1 1  ON 38
  eH1_9                 4.967667e-02 1 1  ON 39
  eH2_0                -2.461171e-01 1 1  ON 40
  eH2_1                -1.390209e-01 1 1  ON 41
  eH2_2                -8.955984e-02 1 1  ON 42
  eH2_3                -3.460420e-02 1 1  ON 43
  eH2_4                 1.430769e-02 1 1  ON 44
  eH2_5                 4.961132e-02 1 1  ON 45
  eH2_6                 1.052399e-01 1 1  ON 46
  eH2_7                 1.534291e-01 1 1  ON 47
  eH2_8                 1.693343e-01 1 1  ON 48
  eH2_9                 3.486206e-02 1 1  ON 49
ci_0001                 7.014442e-01 3 1  ON 50
ci_0002                 7.000930e-01 3 1  ON 51
ci_0003                -2.781734e-02 3 1  ON 52
ci_0004                -2.749077e-02 3 1  ON 53
ci_0005                -3.666463e-02 3 1  ON 54
ci_0006                -3.710150e-02 3 1  ON 55
ci_0007                -2.252133e-02 3 1  ON 56
ci_0008                -2.154270e-02 3 1  ON 57
ci_0009                -1.785403e-02 3 1  ON 58
ci_0010                -1.750884e-02 3 1  ON 59
ci_0011                -1.219917e-02 3 1  ON 60
ci_0012                -1.233950e-02 3 1  ON 61
ci_0013                 1.300341e-02 3 1  ON 62
ci_0014                 1.317930e-02 3 1  ON 63
ci_0015                 1.363041e-02 3 1  ON 64
ci_0016                 1.349505e-02 3 1  ON 65
ci_0017                 1.098459e-02 3 1  ON 66
ci_0018                 1.191531e-02 3 1  ON 67
ci_0019                 1.136339e-02 3 1  ON 68
ci_0020                 1.154368e-02 3 1  ON 69
ci_0021                -2.110372e-03 3 1  ON 70
ci_0022                -4.894102e-04 3 1  ON 71
ci_0023                -1.110411e-02 3 1  ON 72
ci_0024                -1.090949e-02 3 1  ON 73
ci_0025                -1.174751e-02 3 1  ON 74
ci_0026                -1.107878e-02 3 1  ON 75
ci_0027                -1.166598e-02 3 1  ON 76
ci_0028                -1.082854e-02 3 1  ON 77
ci_0029                -9.945064e-03 3 1  ON 78
ci_0030                -1.126687e-02 3 1  ON 79
ci_0031                 2.036994e-02 3 1  ON 80
ci_0032                 2.130179e-02 3 1  ON 81
ci_0033                 1.035023e-02 3 1  ON 82
ci_0034                 9.809192e-03 3 1  ON 83
ci_0035                 6.441651e-03 3 1  ON 84
ci_0036                 6.892316e-03 3 1  ON 85
ci_0037                -1.058432e-02 3 1  ON 86
ci_0038                -1.119491e-02 3 1  ON 87
ci_0039                -2.527609e-03 3 1  ON 88
ci_0040                -2.767854e-03 3 1  ON 89
ci_0041                 6.634654e-03 3 1  ON 90
ci_0042                 7.333703e-03 3 1  ON 91
ci_0043                -1.946211e-02 3 1  ON 92
ci_0044                -1.898919e-02 3 1  ON 93
ci_0045                 7.486003e-03 3 1  ON 94
ci_0046                 7.405967e-03 3 1  ON 95
ci_0047                -1.550584e-03 3 1  ON 96
ci_0048                -1.865900e-03 3 1  ON 97
ci_0049                -5.343914e-03 3 1  ON 98
ci_0050                -5.923111e-03 3 1  ON 99
ci_0051                -3.615981e-03 3 1  ON 100
ci_0052                -3.398770e-03 3 1  ON 101
ci_0053                -4.481696e-03 3 1  ON 102
ci_0054                -4.331830e-03 3 1  ON 103
ci_0055                 6.387141e-03 3 1  ON 104
ci_0056                 6.302148e-03 3 1  ON 105
ci_0057                 4.731878e-03 3 1  ON 106
ci_0058                 4.839080e-03 3 1  ON 107
ci_0059                -4.599212e-03 3 1  ON 108
ci_0060                -4.619453e-03 3 1  ON 109
ci_0061                -4.533563e-03 3 1  ON 110
ci_0062                -3.764479e-03 3 1  ON 111
ci_0063                -9.158406e-03 3 1  ON 112
ci_0064                -8.241635e-03 3 1  ON 113
ci_0065                -5.046107e-03 3 1  ON 114
ci_0066                -5.119976e-03 3 1  ON 115
ci_0067                -5.299663e-03 3 1  ON 116
ci_0068                -4.972838e-03 3 1  ON 117
ci_0069                 4.624499e-03 3 1  ON 118
ci_0070                 4.548032e-03 3 1  ON 119
ci_0071                 5.527316e-04 3 1  ON 120
ci_0072                -4.163776e-04 3 1  ON 121
ci_0073                 4.248246e-03 3 1  ON 122
ci_0074                 4.070958e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.9365
    reference variance = 0.379327
====================================================
  Execution time = 2.1177e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4038e-01
  Total weights = 1.9518e+06
  Execution time = 1.8960e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327613786643
                                         uncertainty =       0.002552934978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327613786643
                                         uncertainty =       0.002552934978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404735942
  error estimate for blocks of size 2^( 2) =       0.000417683485
  error estimate for blocks of size 2^( 3) =       0.000431364998
  error estimate for blocks of size 2^( 4) =       0.000444259821
  error estimate for blocks of size 2^( 5) =       0.000454915132
  error estimate for blocks of size 2^( 6) =       0.000462412156
  error estimate for blocks of size 2^( 7) =       0.000467210154

      target function =                  N/A
              le_mean =     -16.906126297369
             les_mean =     286.157485716398
             stat err =       0.000457199316
             autocorr =       1.276049721395
              std dev =       0.572383058861
             le_variance =       0.327622366072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327628647054
                                         uncertainty =       0.002553267267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327628647054
                                         uncertainty =       0.002553267267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404745142
  error estimate for blocks of size 2^( 2) =       0.000417692062
  error estimate for blocks of size 2^( 3) =       0.000431372782
  error estimate for blocks of size 2^( 4) =       0.000444267710
  error estimate for blocks of size 2^( 5) =       0.000454923362
  error estimate for blocks of size 2^( 6) =       0.000462420316
  error estimate for blocks of size 2^( 7) =       0.000467219838

      target function =                  N/A
              le_mean =     -16.906126230302
             les_mean =     286.157508104410
             stat err =       0.000457207807
             autocorr =       1.276039110197
              std dev =       0.572396068457
             le_variance =       0.327637259185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327621347713
                                         uncertainty =       0.002553103086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327621347713
                                         uncertainty =       0.002553103086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404740623
  error estimate for blocks of size 2^( 2) =       0.000417687847
  error estimate for blocks of size 2^( 3) =       0.000431368958
  error estimate for blocks of size 2^( 4) =       0.000444263833
  error estimate for blocks of size 2^( 5) =       0.000454919318
  error estimate for blocks of size 2^( 6) =       0.000462416306
  error estimate for blocks of size 2^( 7) =       0.000467215079

      target function =                  N/A
              le_mean =     -16.906126258469
             les_mean =     286.157495733912
             stat err =       0.000457203634
             autocorr =       1.276044311286
              std dev =       0.572389678130
             le_variance =       0.327629943630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327614732971
                                         uncertainty =       0.002552956006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327614732971
                                         uncertainty =       0.002552956006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404736528
  error estimate for blocks of size 2^( 2) =       0.000417684031
  error estimate for blocks of size 2^( 3) =       0.000431365494
  error estimate for blocks of size 2^( 4) =       0.000444260323
  error estimate for blocks of size 2^( 5) =       0.000454915655
  error estimate for blocks of size 2^( 6) =       0.000462412676
  error estimate for blocks of size 2^( 7) =       0.000467210771

      target function =                  N/A
              le_mean =     -16.906126291939
             les_mean =     286.157486868674
             stat err =       0.000457199856
             autocorr =       1.276049043800
              std dev =       0.572383887322
             le_variance =       0.327623314466


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906126297369        initial  <--
     1.4552e+01     1.4552e+02             2.5061e-05       -16.906126230302
     5.8208e+01     5.8208e+02             6.3405e-06       -16.906126258469
     2.3283e+02     2.3283e+03             1.5899e-06       -16.906126291939

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7605
  </log>
  <optVariables href="H2O.s043.opt.xml">
   uu_0                 3.117493e-01 1 1  ON 0
   uu_1                 1.447358e-01 1 1  ON 1
   uu_2                 4.305887e-02 1 1  ON 2
   uu_3                -1.916454e-02 1 1  ON 3
   uu_4                -6.454559e-02 1 1  ON 4
   uu_5                -9.933154e-02 1 1  ON 5
   uu_6                -1.264853e-01 1 1  ON 6
   uu_7                -1.389775e-01 1 1  ON 7
   uu_8                -1.311475e-01 1 1  ON 8
   uu_9                -1.002714e-01 1 1  ON 9
   ud_0                 4.453566e-01 1 1  ON 10
   ud_1                 1.799283e-01 1 1  ON 11
   ud_2                 5.987534e-02 1 1  ON 12
   ud_3                -1.077123e-02 1 1  ON 13
   ud_4                -6.720119e-02 1 1  ON 14
   ud_5                -1.077663e-01 1 1  ON 15
   ud_6                -1.341343e-01 1 1  ON 16
   ud_7                -1.497561e-01 1 1  ON 17
   ud_8                -1.506331e-01 1 1  ON 18
   ud_9                -1.385779e-01 1 1  ON 19
   eO_0                -7.471020e-01 1 1  ON 20
   eO_1                -4.276987e-01 1 1  ON 21
   eO_2                -1.909332e-02 1 1  ON 22
   eO_3                 2.902546e-01 1 1  ON 23
   eO_4                 5.129962e-01 1 1  ON 24
   eO_5                 4.729012e-01 1 1  ON 25
   eO_6                 2.454295e-01 1 1  ON 26
   eO_7                -4.920746e-02 1 1  ON 27
   eO_8                -2.099749e-01 1 1  ON 28
   eO_9                -6.984677e-02 1 1  ON 29
  eH1_0                -2.490215e-01 1 1  ON 30
  eH1_1                -1.409956e-01 1 1  ON 31
  eH1_2                -9.187197e-02 1 1  ON 32
  eH1_3                -3.738743e-02 1 1  ON 33
  eH1_4                 1.162438e-02 1 1  ON 34
  eH1_5                 4.535045e-02 1 1  ON 35
  eH1_6                 1.014831e-01 1 1  ON 36
  eH1_7                 1.507917e-01 1 1  ON 37
  eH1_8                 1.645707e-01 1 1  ON 38
  eH1_9                 4.967419e-02 1 1  ON 39
  eH2_0                -2.461112e-01 1 1  ON 40
  eH2_1                -1.390211e-01 1 1  ON 41
  eH2_2                -8.955976e-02 1 1  ON 42
  eH2_3                -3.460182e-02 1 1  ON 43
  eH2_4                 1.430710e-02 1 1  ON 44
  eH2_5                 4.961214e-02 1 1  ON 45
  eH2_6                 1.052393e-01 1 1  ON 46
  eH2_7                 1.534286e-01 1 1  ON 47
  eH2_8                 1.693309e-01 1 1  ON 48
  eH2_9                 3.485821e-02 1 1  ON 49
ci_0001                 7.014436e-01 3 1  ON 50
ci_0002                 7.000934e-01 3 1  ON 51
ci_0003                -2.781616e-02 3 1  ON 52
ci_0004                -2.749299e-02 3 1  ON 53
ci_0005                -3.666221e-02 3 1  ON 54
ci_0006                -3.710224e-02 3 1  ON 55
ci_0007                -2.252433e-02 3 1  ON 56
ci_0008                -2.154067e-02 3 1  ON 57
ci_0009                -1.785470e-02 3 1  ON 58
ci_0010                -1.751032e-02 3 1  ON 59
ci_0011                -1.219953e-02 3 1  ON 60
ci_0012                -1.234403e-02 3 1  ON 61
ci_0013                 1.300233e-02 3 1  ON 62
ci_0014                 1.317561e-02 3 1  ON 63
ci_0015                 1.363061e-02 3 1  ON 64
ci_0016                 1.350139e-02 3 1  ON 65
ci_0017                 1.098490e-02 3 1  ON 66
ci_0018                 1.192028e-02 3 1  ON 67
ci_0019                 1.136265e-02 3 1  ON 68
ci_0020                 1.154708e-02 3 1  ON 69
ci_0021                -2.105989e-03 3 1  ON 70
ci_0022                -4.888067e-04 3 1  ON 71
ci_0023                -1.110204e-02 3 1  ON 72
ci_0024                -1.090547e-02 3 1  ON 73
ci_0025                -1.175180e-02 3 1  ON 74
ci_0026                -1.107956e-02 3 1  ON 75
ci_0027                -1.167063e-02 3 1  ON 76
ci_0028                -1.083224e-02 3 1  ON 77
ci_0029                -9.939431e-03 3 1  ON 78
ci_0030                -1.127247e-02 3 1  ON 79
ci_0031                 2.037148e-02 3 1  ON 80
ci_0032                 2.130313e-02 3 1  ON 81
ci_0033                 1.034981e-02 3 1  ON 82
ci_0034                 9.806835e-03 3 1  ON 83
ci_0035                 6.438377e-03 3 1  ON 84
ci_0036                 6.890596e-03 3 1  ON 85
ci_0037                -1.058556e-02 3 1  ON 86
ci_0038                -1.119505e-02 3 1  ON 87
ci_0039                -2.529825e-03 3 1  ON 88
ci_0040                -2.768704e-03 3 1  ON 89
ci_0041                 6.634993e-03 3 1  ON 90
ci_0042                 7.334803e-03 3 1  ON 91
ci_0043                -1.945967e-02 3 1  ON 92
ci_0044                -1.898824e-02 3 1  ON 93
ci_0045                 7.485360e-03 3 1  ON 94
ci_0046                 7.407614e-03 3 1  ON 95
ci_0047                -1.549175e-03 3 1  ON 96
ci_0048                -1.863999e-03 3 1  ON 97
ci_0049                -5.341073e-03 3 1  ON 98
ci_0050                -5.923074e-03 3 1  ON 99
ci_0051                -3.617795e-03 3 1  ON 100
ci_0052                -3.395346e-03 3 1  ON 101
ci_0053                -4.475685e-03 3 1  ON 102
ci_0054                -4.329864e-03 3 1  ON 103
ci_0055                 6.387775e-03 3 1  ON 104
ci_0056                 6.303671e-03 3 1  ON 105
ci_0057                 4.732661e-03 3 1  ON 106
ci_0058                 4.838082e-03 3 1  ON 107
ci_0059                -4.597561e-03 3 1  ON 108
ci_0060                -4.619766e-03 3 1  ON 109
ci_0061                -4.537602e-03 3 1  ON 110
ci_0062                -3.763357e-03 3 1  ON 111
ci_0063                -9.156654e-03 3 1  ON 112
ci_0064                -8.240974e-03 3 1  ON 113
ci_0065                -5.044251e-03 3 1  ON 114
ci_0066                -5.117683e-03 3 1  ON 115
ci_0067                -5.302701e-03 3 1  ON 116
ci_0068                -4.971734e-03 3 1  ON 117
ci_0069                 4.619272e-03 3 1  ON 118
ci_0070                 4.548319e-03 3 1  ON 119
ci_0071                 5.530958e-04 3 1  ON 120
ci_0072                -4.202523e-04 3 1  ON 121
ci_0073                 4.246296e-03 3 1  ON 122
ci_0074                 4.071952e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8383e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.9632
    reference variance = 0.671048
====================================================
  Execution time = 2.1414e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5231e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3852e-01
  Total weights = 1.951604661e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0514e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321887198003
                                         uncertainty =       0.002882139370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321887198003
                                         uncertainty =       0.002882139370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401214336
  error estimate for blocks of size 2^( 2) =       0.000414006888
  error estimate for blocks of size 2^( 3) =       0.000426780018
  error estimate for blocks of size 2^( 4) =       0.000439125874
  error estimate for blocks of size 2^( 5) =       0.000450152967
  error estimate for blocks of size 2^( 6) =       0.000455352195
  error estimate for blocks of size 2^( 7) =       0.000460133410

      target function =                  N/A
              le_mean =     -16.906116773711
             les_mean =     286.155302594531
             stat err =       0.000451191112
             autocorr =       1.264643702254
              std dev =       0.567402755515
             le_variance =       0.321945886966


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690611677371e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906116773700       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906116811964       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906116806476       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906116802687       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906116807097       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906116806548       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906116804836       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906116803659       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906116803792       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906116804470       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4552e+02 is 3.663959e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906116773700       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906116783276       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906116781903       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906116780956       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906116782060       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906116781926       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906116781496       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906116781204       residual = 6.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906116781235       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906116781404       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.8208e+02 is 9.169729e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906116773700       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906116776094       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906116775751       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906116775514       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906116775791       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906116775757       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906116775646       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906116775570       residual = 6.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906116775583       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906116775622       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3283e+03 is 2.293048e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.491428 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7473e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
   uu_0                 3.117493e-01 1 1  ON 0
   uu_1                 1.447359e-01 1 1  ON 1
   uu_2                 4.305911e-02 1 1  ON 2
   uu_3                -1.916446e-02 1 1  ON 3
   uu_4                -6.454573e-02 1 1  ON 4
   uu_5                -9.933158e-02 1 1  ON 5
   uu_6                -1.264851e-01 1 1  ON 6
   uu_7                -1.389776e-01 1 1  ON 7
   uu_8                -1.311476e-01 1 1  ON 8
   uu_9                -1.002717e-01 1 1  ON 9
   ud_0                 4.453569e-01 1 1  ON 10
   ud_1                 1.799284e-01 1 1  ON 11
   ud_2                 5.987532e-02 1 1  ON 12
   ud_3                -1.077106e-02 1 1  ON 13
   ud_4                -6.720123e-02 1 1  ON 14
   ud_5                -1.077662e-01 1 1  ON 15
   ud_6                -1.341344e-01 1 1  ON 16
   ud_7                -1.497563e-01 1 1  ON 17
   ud_8                -1.506332e-01 1 1  ON 18
   ud_9                -1.385781e-01 1 1  ON 19
   eO_0                -7.471019e-01 1 1  ON 20
   eO_1                -4.276988e-01 1 1  ON 21
   eO_2                -1.909346e-02 1 1  ON 22
   eO_3                 2.902546e-01 1 1  ON 23
   eO_4                 5.129962e-01 1 1  ON 24
   eO_5                 4.729015e-01 1 1  ON 25
   eO_6                 2.454298e-01 1 1  ON 26
   eO_7                -4.920729e-02 1 1  ON 27
   eO_8                -2.099751e-01 1 1  ON 28
   eO_9                -6.984703e-02 1 1  ON 29
  eH1_0                -2.490216e-01 1 1  ON 30
  eH1_1                -1.409960e-01 1 1  ON 31
  eH1_2                -9.187207e-02 1 1  ON 32
  eH1_3                -3.738749e-02 1 1  ON 33
  eH1_4                 1.162426e-02 1 1  ON 34
  eH1_5                 4.535045e-02 1 1  ON 35
  eH1_6                 1.014831e-01 1 1  ON 36
  eH1_7                 1.507918e-01 1 1  ON 37
  eH1_8                 1.645710e-01 1 1  ON 38
  eH1_9                 4.967451e-02 1 1  ON 39
  eH2_0                -2.461114e-01 1 1  ON 40
  eH2_1                -1.390213e-01 1 1  ON 41
  eH2_2                -8.955967e-02 1 1  ON 42
  eH2_3                -3.460189e-02 1 1  ON 43
  eH2_4                 1.430709e-02 1 1  ON 44
  eH2_5                 4.961193e-02 1 1  ON 45
  eH2_6                 1.052393e-01 1 1  ON 46
  eH2_7                 1.534286e-01 1 1  ON 47
  eH2_8                 1.693311e-01 1 1  ON 48
  eH2_9                 3.485849e-02 1 1  ON 49
ci_0001                 7.014435e-01 3 1  ON 50
ci_0002                 7.000935e-01 3 1  ON 51
ci_0003                -2.781605e-02 3 1  ON 52
ci_0004                -2.749325e-02 3 1  ON 53
ci_0005                -3.666258e-02 3 1  ON 54
ci_0006                -3.710256e-02 3 1  ON 55
ci_0007                -2.252412e-02 3 1  ON 56
ci_0008                -2.154073e-02 3 1  ON 57
ci_0009                -1.785456e-02 3 1  ON 58
ci_0010                -1.751017e-02 3 1  ON 59
ci_0011                -1.219953e-02 3 1  ON 60
ci_0012                -1.234374e-02 3 1  ON 61
ci_0013                 1.300258e-02 3 1  ON 62
ci_0014                 1.317572e-02 3 1  ON 63
ci_0015                 1.363016e-02 3 1  ON 64
ci_0016                 1.350159e-02 3 1  ON 65
ci_0017                 1.098487e-02 3 1  ON 66
ci_0018                 1.191995e-02 3 1  ON 67
ci_0019                 1.136295e-02 3 1  ON 68
ci_0020                 1.154711e-02 3 1  ON 69
ci_0021                -2.105989e-03 3 1  ON 70
ci_0022                -4.889823e-04 3 1  ON 71
ci_0023                -1.110230e-02 3 1  ON 72
ci_0024                -1.090559e-02 3 1  ON 73
ci_0025                -1.175121e-02 3 1  ON 74
ci_0026                -1.107911e-02 3 1  ON 75
ci_0027                -1.166997e-02 3 1  ON 76
ci_0028                -1.083251e-02 3 1  ON 77
ci_0029                -9.940348e-03 3 1  ON 78
ci_0030                -1.127251e-02 3 1  ON 79
ci_0031                 2.037132e-02 3 1  ON 80
ci_0032                 2.130282e-02 3 1  ON 81
ci_0033                 1.035004e-02 3 1  ON 82
ci_0034                 9.807038e-03 3 1  ON 83
ci_0035                 6.438578e-03 3 1  ON 84
ci_0036                 6.890465e-03 3 1  ON 85
ci_0037                -1.058546e-02 3 1  ON 86
ci_0038                -1.119484e-02 3 1  ON 87
ci_0039                -2.529925e-03 3 1  ON 88
ci_0040                -2.768607e-03 3 1  ON 89
ci_0041                 6.635135e-03 3 1  ON 90
ci_0042                 7.334227e-03 3 1  ON 91
ci_0043                -1.946021e-02 3 1  ON 92
ci_0044                -1.898824e-02 3 1  ON 93
ci_0045                 7.485461e-03 3 1  ON 94
ci_0046                 7.407991e-03 3 1  ON 95
ci_0047                -1.549458e-03 3 1  ON 96
ci_0048                -1.863933e-03 3 1  ON 97
ci_0049                -5.341019e-03 3 1  ON 98
ci_0050                -5.922570e-03 3 1  ON 99
ci_0051                -3.617755e-03 3 1  ON 100
ci_0052                -3.395524e-03 3 1  ON 101
ci_0053                -4.475950e-03 3 1  ON 102
ci_0054                -4.330249e-03 3 1  ON 103
ci_0055                 6.387966e-03 3 1  ON 104
ci_0056                 6.303826e-03 3 1  ON 105
ci_0057                 4.732574e-03 3 1  ON 106
ci_0058                 4.837906e-03 3 1  ON 107
ci_0059                -4.597528e-03 3 1  ON 108
ci_0060                -4.620034e-03 3 1  ON 109
ci_0061                -4.537238e-03 3 1  ON 110
ci_0062                -3.763078e-03 3 1  ON 111
ci_0063                -9.156110e-03 3 1  ON 112
ci_0064                -8.241201e-03 3 1  ON 113
ci_0065                -5.044189e-03 3 1  ON 114
ci_0066                -5.117625e-03 3 1  ON 115
ci_0067                -5.302729e-03 3 1  ON 116
ci_0068                -4.971654e-03 3 1  ON 117
ci_0069                 4.619191e-03 3 1  ON 118
ci_0070                 4.548224e-03 3 1  ON 119
ci_0071                 5.528113e-04 3 1  ON 120
ci_0072                -4.202570e-04 3 1  ON 121
ci_0073                 4.246328e-03 3 1  ON 122
ci_0074                 4.072008e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.9088
    reference variance = 0.190036
====================================================
  Execution time = 2.1274e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3111e-01
  Total weights = 1.9515e+06
  Execution time = 1.9010e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319472944853
                                         uncertainty =       0.002195137098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319472944853
                                         uncertainty =       0.002195137098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399610914
  error estimate for blocks of size 2^( 2) =       0.000413014480
  error estimate for blocks of size 2^( 3) =       0.000426617774
  error estimate for blocks of size 2^( 4) =       0.000439500469
  error estimate for blocks of size 2^( 5) =       0.000450446226
  error estimate for blocks of size 2^( 6) =       0.000458485787
  error estimate for blocks of size 2^( 7) =       0.000463246439

      target function =                  N/A
              le_mean =     -16.906097285702
             les_mean =     286.147243429654
             stat err =       0.000452919730
             autocorr =       1.284599648115
              std dev =       0.565135173901
             le_variance =       0.319377764780

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319472278971
                                         uncertainty =       0.002195085341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319472278971
                                         uncertainty =       0.002195085341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399610497
  error estimate for blocks of size 2^( 2) =       0.000413014034
  error estimate for blocks of size 2^( 3) =       0.000426617256
  error estimate for blocks of size 2^( 4) =       0.000439499978
  error estimate for blocks of size 2^( 5) =       0.000450445734
  error estimate for blocks of size 2^( 6) =       0.000458485265
  error estimate for blocks of size 2^( 7) =       0.000463246076

      target function =                  N/A
              le_mean =     -16.906097294524
             les_mean =     286.147226957934
             stat err =       0.000452919263
             autocorr =       1.284599678548
              std dev =       0.565134584588
             le_variance =       0.319377098698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319472611778
                                         uncertainty =       0.002195111192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319472611778
                                         uncertainty =       0.002195111192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399610705
  error estimate for blocks of size 2^( 2) =       0.000413014257
  error estimate for blocks of size 2^( 3) =       0.000426617515
  error estimate for blocks of size 2^( 4) =       0.000439500224
  error estimate for blocks of size 2^( 5) =       0.000450445980
  error estimate for blocks of size 2^( 6) =       0.000458485526
  error estimate for blocks of size 2^( 7) =       0.000463246257

      target function =                  N/A
              le_mean =     -16.906097290043
             les_mean =     286.147232880914
             stat err =       0.000452919497
             autocorr =       1.284599662413
              std dev =       0.565134879126
             le_variance =       0.319377431605

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319472903186
                                         uncertainty =       0.002195133858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319472903186
                                         uncertainty =       0.002195133858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399610888
  error estimate for blocks of size 2^( 2) =       0.000413014452
  error estimate for blocks of size 2^( 3) =       0.000426617742
  error estimate for blocks of size 2^( 4) =       0.000439500439
  error estimate for blocks of size 2^( 5) =       0.000450446195
  error estimate for blocks of size 2^( 6) =       0.000458485755
  error estimate for blocks of size 2^( 7) =       0.000463246416

      target function =                  N/A
              le_mean =     -16.906097286235
             les_mean =     286.147241676589
             stat err =       0.000452919701
             autocorr =       1.284599649845
              std dev =       0.565135137025
             le_variance =       0.319377723101


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906097285702        initial
     1.4552e+02     1.4552e+03             3.6640e-06       -16.906097294524  <--
     5.8208e+02     5.8208e+03             9.1697e-07       -16.906097290043
     2.3283e+03     2.3283e+04             2.2930e-07       -16.906097286235

*****************************************************************************
Applying the update for shift_i =   1.4552e+02     and shift_s =   1.4552e+03
*****************************************************************************

  Execution time = 3.0860e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
   uu_0                 3.117492e-01 1 1  ON 0
   uu_1                 1.447361e-01 1 1  ON 1
   uu_2                 4.305982e-02 1 1  ON 2
   uu_3                -1.916424e-02 1 1  ON 3
   uu_4                -6.454616e-02 1 1  ON 4
   uu_5                -9.933168e-02 1 1  ON 5
   uu_6                -1.264846e-01 1 1  ON 6
   uu_7                -1.389779e-01 1 1  ON 7
   uu_8                -1.311481e-01 1 1  ON 8
   uu_9                -1.002725e-01 1 1  ON 9
   ud_0                 4.453580e-01 1 1  ON 10
   ud_1                 1.799287e-01 1 1  ON 11
   ud_2                 5.987525e-02 1 1  ON 12
   ud_3                -1.077058e-02 1 1  ON 13
   ud_4                -6.720135e-02 1 1  ON 14
   ud_5                -1.077659e-01 1 1  ON 15
   ud_6                -1.341347e-01 1 1  ON 16
   ud_7                -1.497567e-01 1 1  ON 17
   ud_8                -1.506334e-01 1 1  ON 18
   ud_9                -1.385786e-01 1 1  ON 19
   eO_0                -7.471015e-01 1 1  ON 20
   eO_1                -4.276991e-01 1 1  ON 21
   eO_2                -1.909391e-02 1 1  ON 22
   eO_3                 2.902545e-01 1 1  ON 23
   eO_4                 5.129962e-01 1 1  ON 24
   eO_5                 4.729023e-01 1 1  ON 25
   eO_6                 2.454307e-01 1 1  ON 26
   eO_7                -4.920677e-02 1 1  ON 27
   eO_8                -2.099759e-01 1 1  ON 28
   eO_9                -6.984782e-02 1 1  ON 29
  eH1_0                -2.490219e-01 1 1  ON 30
  eH1_1                -1.409970e-01 1 1  ON 31
  eH1_2                -9.187239e-02 1 1  ON 32
  eH1_3                -3.738768e-02 1 1  ON 33
  eH1_4                 1.162390e-02 1 1  ON 34
  eH1_5                 4.535046e-02 1 1  ON 35
  eH1_6                 1.014832e-01 1 1  ON 36
  eH1_7                 1.507920e-01 1 1  ON 37
  eH1_8                 1.645719e-01 1 1  ON 38
  eH1_9                 4.967546e-02 1 1  ON 39
  eH2_0                -2.461118e-01 1 1  ON 40
  eH2_1                -1.390220e-01 1 1  ON 41
  eH2_2                -8.955941e-02 1 1  ON 42
  eH2_3                -3.460212e-02 1 1  ON 43
  eH2_4                 1.430705e-02 1 1  ON 44
  eH2_5                 4.961129e-02 1 1  ON 45
  eH2_6                 1.052394e-01 1 1  ON 46
  eH2_7                 1.534288e-01 1 1  ON 47
  eH2_8                 1.693319e-01 1 1  ON 48
  eH2_9                 3.485931e-02 1 1  ON 49
ci_0001                 7.014432e-01 3 1  ON 50
ci_0002                 7.000937e-01 3 1  ON 51
ci_0003                -2.781569e-02 3 1  ON 52
ci_0004                -2.749404e-02 3 1  ON 53
ci_0005                -3.666370e-02 3 1  ON 54
ci_0006                -3.710352e-02 3 1  ON 55
ci_0007                -2.252348e-02 3 1  ON 56
ci_0008                -2.154091e-02 3 1  ON 57
ci_0009                -1.785415e-02 3 1  ON 58
ci_0010                -1.750972e-02 3 1  ON 59
ci_0011                -1.219951e-02 3 1  ON 60
ci_0012                -1.234288e-02 3 1  ON 61
ci_0013                 1.300331e-02 3 1  ON 62
ci_0014                 1.317606e-02 3 1  ON 63
ci_0015                 1.362881e-02 3 1  ON 64
ci_0016                 1.350219e-02 3 1  ON 65
ci_0017                 1.098478e-02 3 1  ON 66
ci_0018                 1.191897e-02 3 1  ON 67
ci_0019                 1.136385e-02 3 1  ON 68
ci_0020                 1.154719e-02 3 1  ON 69
ci_0021                -2.105988e-03 3 1  ON 70
ci_0022                -4.895086e-04 3 1  ON 71
ci_0023                -1.110307e-02 3 1  ON 72
ci_0024                -1.090594e-02 3 1  ON 73
ci_0025                -1.174943e-02 3 1  ON 74
ci_0026                -1.107778e-02 3 1  ON 75
ci_0027                -1.166799e-02 3 1  ON 76
ci_0028                -1.083333e-02 3 1  ON 77
ci_0029                -9.943095e-03 3 1  ON 78
ci_0030                -1.127264e-02 3 1  ON 79
ci_0031                 2.037085e-02 3 1  ON 80
ci_0032                 2.130191e-02 3 1  ON 81
ci_0033                 1.035074e-02 3 1  ON 82
ci_0034                 9.807646e-03 3 1  ON 83
ci_0035                 6.439181e-03 3 1  ON 84
ci_0036                 6.890073e-03 3 1  ON 85
ci_0037                -1.058517e-02 3 1  ON 86
ci_0038                -1.119420e-02 3 1  ON 87
ci_0039                -2.530223e-03 3 1  ON 88
ci_0040                -2.768317e-03 3 1  ON 89
ci_0041                 6.635562e-03 3 1  ON 90
ci_0042                 7.332502e-03 3 1  ON 91
ci_0043                -1.946183e-02 3 1  ON 92
ci_0044                -1.898822e-02 3 1  ON 93
ci_0045                 7.485766e-03 3 1  ON 94
ci_0046                 7.409123e-03 3 1  ON 95
ci_0047                -1.550303e-03 3 1  ON 96
ci_0048                -1.863734e-03 3 1  ON 97
ci_0049                -5.340858e-03 3 1  ON 98
ci_0050                -5.921061e-03 3 1  ON 99
ci_0051                -3.617634e-03 3 1  ON 100
ci_0052                -3.396058e-03 3 1  ON 101
ci_0053                -4.476743e-03 3 1  ON 102
ci_0054                -4.331399e-03 3 1  ON 103
ci_0055                 6.388539e-03 3 1  ON 104
ci_0056                 6.304293e-03 3 1  ON 105
ci_0057                 4.732313e-03 3 1  ON 106
ci_0058                 4.837377e-03 3 1  ON 107
ci_0059                -4.597430e-03 3 1  ON 108
ci_0060                -4.620834e-03 3 1  ON 109
ci_0061                -4.536146e-03 3 1  ON 110
ci_0062                -3.762243e-03 3 1  ON 111
ci_0063                -9.154480e-03 3 1  ON 112
ci_0064                -8.241883e-03 3 1  ON 113
ci_0065                -5.044003e-03 3 1  ON 114
ci_0066                -5.117453e-03 3 1  ON 115
ci_0067                -5.302813e-03 3 1  ON 116
ci_0068                -4.971414e-03 3 1  ON 117
ci_0069                 4.618947e-03 3 1  ON 118
ci_0070                 4.547938e-03 3 1  ON 119
ci_0071                 5.519591e-04 3 1  ON 120
ci_0072                -4.202712e-04 3 1  ON 121
ci_0073                 4.246424e-03 3 1  ON 122
ci_0074                 4.072174e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8340e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.8914
    reference variance = 0.332918
====================================================
  Execution time = 2.1549e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3756e-01
  Total weights = 1.951664307e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0759e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324885447363
                                         uncertainty =       0.002495501880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324885447363
                                         uncertainty =       0.002495501880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403192602
  error estimate for blocks of size 2^( 2) =       0.000415581803
  error estimate for blocks of size 2^( 3) =       0.000428589872
  error estimate for blocks of size 2^( 4) =       0.000440509802
  error estimate for blocks of size 2^( 5) =       0.000451611111
  error estimate for blocks of size 2^( 6) =       0.000458088281
  error estimate for blocks of size 2^( 7) =       0.000461253075

      target function =                  N/A
              le_mean =     -16.907092992313
             les_mean =     286.187351198816
             stat err =       0.000452865567
             autocorr =       1.261576213745
              std dev =       0.570200446127
             le_variance =       0.325128548764


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690709299231e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907092992304       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907093063552       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907093059873       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907093074191       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907093086956       residual = 9.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907093073699       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907093074183       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907093073886       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907093075797       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907093077030       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.6380e+01 is 1.948916e-05

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907092992304       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907093010201       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907093009272       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907093012886       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907093016058       residual = 9.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907093012735       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907093012839       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907093012772       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907093013253       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907093013562       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4552e+02 is 4.901619e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907092992304       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907092996784       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907092996551       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907092997457       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907092998248       residual = 9.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907092997417       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907092997441       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907092997425       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907092997546       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907092997624       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.8208e+02 is 1.227251e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.495257 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7632e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
   uu_0                 3.117504e-01 1 1  ON 0
   uu_1                 1.447369e-01 1 1  ON 1
   uu_2                 4.305966e-02 1 1  ON 2
   uu_3                -1.916412e-02 1 1  ON 3
   uu_4                -6.454625e-02 1 1  ON 4
   uu_5                -9.933123e-02 1 1  ON 5
   uu_6                -1.264840e-01 1 1  ON 6
   uu_7                -1.389793e-01 1 1  ON 7
   uu_8                -1.311495e-01 1 1  ON 8
   uu_9                -1.002734e-01 1 1  ON 9
   ud_0                 4.453584e-01 1 1  ON 10
   ud_1                 1.799287e-01 1 1  ON 11
   ud_2                 5.987566e-02 1 1  ON 12
   ud_3                -1.076920e-02 1 1  ON 13
   ud_4                -6.720100e-02 1 1  ON 14
   ud_5                -1.077657e-01 1 1  ON 15
   ud_6                -1.341347e-01 1 1  ON 16
   ud_7                -1.497573e-01 1 1  ON 17
   ud_8                -1.506342e-01 1 1  ON 18
   ud_9                -1.385797e-01 1 1  ON 19
   eO_0                -7.471025e-01 1 1  ON 20
   eO_1                -4.276986e-01 1 1  ON 21
   eO_2                -1.909401e-02 1 1  ON 22
   eO_3                 2.902544e-01 1 1  ON 23
   eO_4                 5.129967e-01 1 1  ON 24
   eO_5                 4.729034e-01 1 1  ON 25
   eO_6                 2.454320e-01 1 1  ON 26
   eO_7                -4.920676e-02 1 1  ON 27
   eO_8                -2.099771e-01 1 1  ON 28
   eO_9                -6.984884e-02 1 1  ON 29
  eH1_0                -2.490221e-01 1 1  ON 30
  eH1_1                -1.409980e-01 1 1  ON 31
  eH1_2                -9.187316e-02 1 1  ON 32
  eH1_3                -3.738776e-02 1 1  ON 33
  eH1_4                 1.162316e-02 1 1  ON 34
  eH1_5                 4.535034e-02 1 1  ON 35
  eH1_6                 1.014830e-01 1 1  ON 36
  eH1_7                 1.507929e-01 1 1  ON 37
  eH1_8                 1.645733e-01 1 1  ON 38
  eH1_9                 4.967639e-02 1 1  ON 39
  eH2_0                -2.461134e-01 1 1  ON 40
  eH2_1                -1.390217e-01 1 1  ON 41
  eH2_2                -8.955942e-02 1 1  ON 42
  eH2_3                -3.460299e-02 1 1  ON 43
  eH2_4                 1.430725e-02 1 1  ON 44
  eH2_5                 4.961075e-02 1 1  ON 45
  eH2_6                 1.052391e-01 1 1  ON 46
  eH2_7                 1.534290e-01 1 1  ON 47
  eH2_8                 1.693328e-01 1 1  ON 48
  eH2_9                 3.486072e-02 1 1  ON 49
ci_0001                 7.014434e-01 3 1  ON 50
ci_0002                 7.000938e-01 3 1  ON 51
ci_0003                -2.781372e-02 3 1  ON 52
ci_0004                -2.749417e-02 3 1  ON 53
ci_0005                -3.666320e-02 3 1  ON 54
ci_0006                -3.710453e-02 3 1  ON 55
ci_0007                -2.252357e-02 3 1  ON 56
ci_0008                -2.154143e-02 3 1  ON 57
ci_0009                -1.785440e-02 3 1  ON 58
ci_0010                -1.751052e-02 3 1  ON 59
ci_0011                -1.219972e-02 3 1  ON 60
ci_0012                -1.234245e-02 3 1  ON 61
ci_0013                 1.300306e-02 3 1  ON 62
ci_0014                 1.317636e-02 3 1  ON 63
ci_0015                 1.362886e-02 3 1  ON 64
ci_0016                 1.350225e-02 3 1  ON 65
ci_0017                 1.098544e-02 3 1  ON 66
ci_0018                 1.191548e-02 3 1  ON 67
ci_0019                 1.136378e-02 3 1  ON 68
ci_0020                 1.154701e-02 3 1  ON 69
ci_0021                -2.104719e-03 3 1  ON 70
ci_0022                -4.890971e-04 3 1  ON 71
ci_0023                -1.110212e-02 3 1  ON 72
ci_0024                -1.090602e-02 3 1  ON 73
ci_0025                -1.174786e-02 3 1  ON 74
ci_0026                -1.107694e-02 3 1  ON 75
ci_0027                -1.166631e-02 3 1  ON 76
ci_0028                -1.083594e-02 3 1  ON 77
ci_0029                -9.943092e-03 3 1  ON 78
ci_0030                -1.127108e-02 3 1  ON 79
ci_0031                 2.036990e-02 3 1  ON 80
ci_0032                 2.130227e-02 3 1  ON 81
ci_0033                 1.034909e-02 3 1  ON 82
ci_0034                 9.808824e-03 3 1  ON 83
ci_0035                 6.440116e-03 3 1  ON 84
ci_0036                 6.890248e-03 3 1  ON 85
ci_0037                -1.058488e-02 3 1  ON 86
ci_0038                -1.119437e-02 3 1  ON 87
ci_0039                -2.531297e-03 3 1  ON 88
ci_0040                -2.768894e-03 3 1  ON 89
ci_0041                 6.636420e-03 3 1  ON 90
ci_0042                 7.332475e-03 3 1  ON 91
ci_0043                -1.946225e-02 3 1  ON 92
ci_0044                -1.898775e-02 3 1  ON 93
ci_0045                 7.485212e-03 3 1  ON 94
ci_0046                 7.408861e-03 3 1  ON 95
ci_0047                -1.550555e-03 3 1  ON 96
ci_0048                -1.862420e-03 3 1  ON 97
ci_0049                -5.340673e-03 3 1  ON 98
ci_0050                -5.920670e-03 3 1  ON 99
ci_0051                -3.617485e-03 3 1  ON 100
ci_0052                -3.396850e-03 3 1  ON 101
ci_0053                -4.477217e-03 3 1  ON 102
ci_0054                -4.332297e-03 3 1  ON 103
ci_0055                 6.387509e-03 3 1  ON 104
ci_0056                 6.303976e-03 3 1  ON 105
ci_0057                 4.732526e-03 3 1  ON 106
ci_0058                 4.837233e-03 3 1  ON 107
ci_0059                -4.598910e-03 3 1  ON 108
ci_0060                -4.621244e-03 3 1  ON 109
ci_0061                -4.535303e-03 3 1  ON 110
ci_0062                -3.760569e-03 3 1  ON 111
ci_0063                -9.149578e-03 3 1  ON 112
ci_0064                -8.243542e-03 3 1  ON 113
ci_0065                -5.044089e-03 3 1  ON 114
ci_0066                -5.117983e-03 3 1  ON 115
ci_0067                -5.301839e-03 3 1  ON 116
ci_0068                -4.971152e-03 3 1  ON 117
ci_0069                 4.619412e-03 3 1  ON 118
ci_0070                 4.549075e-03 3 1  ON 119
ci_0071                 5.512209e-04 3 1  ON 120
ci_0072                -4.180696e-04 3 1  ON 121
ci_0073                 4.245911e-03 3 1  ON 122
ci_0074                 4.072033e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.924
    reference variance = 0.850645
====================================================
  Execution time = 2.1474e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2836e-01
  Total weights = 1.9517e+06
  Execution time = 1.8951e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316495661591
                                         uncertainty =       0.001802960664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316495661591
                                         uncertainty =       0.001802960664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397835669
  error estimate for blocks of size 2^( 2) =       0.000410896748
  error estimate for blocks of size 2^( 3) =       0.000423984986
  error estimate for blocks of size 2^( 4) =       0.000436447725
  error estimate for blocks of size 2^( 5) =       0.000446792075
  error estimate for blocks of size 2^( 6) =       0.000453709210
  error estimate for blocks of size 2^( 7) =       0.000456919211

      target function =                  N/A
              le_mean =     -16.906062162163
             les_mean =     286.143296467897
             stat err =       0.000448467055
             autocorr =       1.270731085471
              std dev =       0.562624598177
             le_variance =       0.316546438474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316493822755
                                         uncertainty =       0.001802889880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316493822755
                                         uncertainty =       0.001802889880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397834502
  error estimate for blocks of size 2^( 2) =       0.000410895640
  error estimate for blocks of size 2^( 3) =       0.000423983717
  error estimate for blocks of size 2^( 4) =       0.000436446464
  error estimate for blocks of size 2^( 5) =       0.000446790951
  error estimate for blocks of size 2^( 6) =       0.000453708061
  error estimate for blocks of size 2^( 7) =       0.000456918037

      target function =                  N/A
              le_mean =     -16.906061952628
             les_mean =     286.143312253947
             stat err =       0.000448465878
             autocorr =       1.270731867291
              std dev =       0.562622948692
             le_variance =       0.316544582395

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316494739429
                                         uncertainty =       0.001802925034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316494739429
                                         uncertainty =       0.001802925034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397835084
  error estimate for blocks of size 2^( 2) =       0.000410896192
  error estimate for blocks of size 2^( 3) =       0.000423984349
  error estimate for blocks of size 2^( 4) =       0.000436447092
  error estimate for blocks of size 2^( 5) =       0.000446791508
  error estimate for blocks of size 2^( 6) =       0.000453708629
  error estimate for blocks of size 2^( 7) =       0.000456918617

      target function =                  N/A
              le_mean =     -16.906062055556
             les_mean =     286.143295129275
             stat err =       0.000448466461
             autocorr =       1.270731456625
              std dev =       0.562623770972
             le_variance =       0.316545507663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316495545723
                                         uncertainty =       0.001802956198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316495545723
                                         uncertainty =       0.001802956198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397835595
  error estimate for blocks of size 2^( 2) =       0.000410896678
  error estimate for blocks of size 2^( 3) =       0.000423984906
  error estimate for blocks of size 2^( 4) =       0.000436447646
  error estimate for blocks of size 2^( 5) =       0.000446792003
  error estimate for blocks of size 2^( 6) =       0.000453709137
  error estimate for blocks of size 2^( 7) =       0.000456919136

      target function =                  N/A
              le_mean =     -16.906062148721
             les_mean =     286.143296020683
             stat err =       0.000448466981
             autocorr =       1.270731131602
              std dev =       0.562624494245
             le_variance =       0.316546321525


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906062162163        initial  <--
     3.6380e+01     3.6380e+02             1.9489e-05       -16.906061952628
     1.4552e+02     1.4552e+03             4.9016e-06       -16.906062055556
     5.8208e+02     5.8208e+03             1.2273e-06       -16.906062148721

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0156
  </log>
  <optVariables href="H2O.s045.opt.xml">
   uu_0                 3.117492e-01 1 1  ON 0
   uu_1                 1.447361e-01 1 1  ON 1
   uu_2                 4.305982e-02 1 1  ON 2
   uu_3                -1.916424e-02 1 1  ON 3
   uu_4                -6.454616e-02 1 1  ON 4
   uu_5                -9.933168e-02 1 1  ON 5
   uu_6                -1.264846e-01 1 1  ON 6
   uu_7                -1.389779e-01 1 1  ON 7
   uu_8                -1.311481e-01 1 1  ON 8
   uu_9                -1.002725e-01 1 1  ON 9
   ud_0                 4.453580e-01 1 1  ON 10
   ud_1                 1.799287e-01 1 1  ON 11
   ud_2                 5.987525e-02 1 1  ON 12
   ud_3                -1.077058e-02 1 1  ON 13
   ud_4                -6.720135e-02 1 1  ON 14
   ud_5                -1.077659e-01 1 1  ON 15
   ud_6                -1.341347e-01 1 1  ON 16
   ud_7                -1.497567e-01 1 1  ON 17
   ud_8                -1.506334e-01 1 1  ON 18
   ud_9                -1.385786e-01 1 1  ON 19
   eO_0                -7.471015e-01 1 1  ON 20
   eO_1                -4.276991e-01 1 1  ON 21
   eO_2                -1.909391e-02 1 1  ON 22
   eO_3                 2.902545e-01 1 1  ON 23
   eO_4                 5.129962e-01 1 1  ON 24
   eO_5                 4.729023e-01 1 1  ON 25
   eO_6                 2.454307e-01 1 1  ON 26
   eO_7                -4.920677e-02 1 1  ON 27
   eO_8                -2.099759e-01 1 1  ON 28
   eO_9                -6.984782e-02 1 1  ON 29
  eH1_0                -2.490219e-01 1 1  ON 30
  eH1_1                -1.409970e-01 1 1  ON 31
  eH1_2                -9.187239e-02 1 1  ON 32
  eH1_3                -3.738768e-02 1 1  ON 33
  eH1_4                 1.162390e-02 1 1  ON 34
  eH1_5                 4.535046e-02 1 1  ON 35
  eH1_6                 1.014832e-01 1 1  ON 36
  eH1_7                 1.507920e-01 1 1  ON 37
  eH1_8                 1.645719e-01 1 1  ON 38
  eH1_9                 4.967546e-02 1 1  ON 39
  eH2_0                -2.461118e-01 1 1  ON 40
  eH2_1                -1.390220e-01 1 1  ON 41
  eH2_2                -8.955941e-02 1 1  ON 42
  eH2_3                -3.460212e-02 1 1  ON 43
  eH2_4                 1.430705e-02 1 1  ON 44
  eH2_5                 4.961129e-02 1 1  ON 45
  eH2_6                 1.052394e-01 1 1  ON 46
  eH2_7                 1.534288e-01 1 1  ON 47
  eH2_8                 1.693319e-01 1 1  ON 48
  eH2_9                 3.485931e-02 1 1  ON 49
ci_0001                 7.014432e-01 3 1  ON 50
ci_0002                 7.000937e-01 3 1  ON 51
ci_0003                -2.781569e-02 3 1  ON 52
ci_0004                -2.749404e-02 3 1  ON 53
ci_0005                -3.666370e-02 3 1  ON 54
ci_0006                -3.710352e-02 3 1  ON 55
ci_0007                -2.252348e-02 3 1  ON 56
ci_0008                -2.154091e-02 3 1  ON 57
ci_0009                -1.785415e-02 3 1  ON 58
ci_0010                -1.750972e-02 3 1  ON 59
ci_0011                -1.219951e-02 3 1  ON 60
ci_0012                -1.234288e-02 3 1  ON 61
ci_0013                 1.300331e-02 3 1  ON 62
ci_0014                 1.317606e-02 3 1  ON 63
ci_0015                 1.362881e-02 3 1  ON 64
ci_0016                 1.350219e-02 3 1  ON 65
ci_0017                 1.098478e-02 3 1  ON 66
ci_0018                 1.191897e-02 3 1  ON 67
ci_0019                 1.136385e-02 3 1  ON 68
ci_0020                 1.154719e-02 3 1  ON 69
ci_0021                -2.105988e-03 3 1  ON 70
ci_0022                -4.895086e-04 3 1  ON 71
ci_0023                -1.110307e-02 3 1  ON 72
ci_0024                -1.090594e-02 3 1  ON 73
ci_0025                -1.174943e-02 3 1  ON 74
ci_0026                -1.107778e-02 3 1  ON 75
ci_0027                -1.166799e-02 3 1  ON 76
ci_0028                -1.083333e-02 3 1  ON 77
ci_0029                -9.943095e-03 3 1  ON 78
ci_0030                -1.127264e-02 3 1  ON 79
ci_0031                 2.037085e-02 3 1  ON 80
ci_0032                 2.130191e-02 3 1  ON 81
ci_0033                 1.035074e-02 3 1  ON 82
ci_0034                 9.807646e-03 3 1  ON 83
ci_0035                 6.439181e-03 3 1  ON 84
ci_0036                 6.890073e-03 3 1  ON 85
ci_0037                -1.058517e-02 3 1  ON 86
ci_0038                -1.119420e-02 3 1  ON 87
ci_0039                -2.530223e-03 3 1  ON 88
ci_0040                -2.768317e-03 3 1  ON 89
ci_0041                 6.635562e-03 3 1  ON 90
ci_0042                 7.332502e-03 3 1  ON 91
ci_0043                -1.946183e-02 3 1  ON 92
ci_0044                -1.898822e-02 3 1  ON 93
ci_0045                 7.485766e-03 3 1  ON 94
ci_0046                 7.409123e-03 3 1  ON 95
ci_0047                -1.550303e-03 3 1  ON 96
ci_0048                -1.863734e-03 3 1  ON 97
ci_0049                -5.340858e-03 3 1  ON 98
ci_0050                -5.921061e-03 3 1  ON 99
ci_0051                -3.617634e-03 3 1  ON 100
ci_0052                -3.396058e-03 3 1  ON 101
ci_0053                -4.476743e-03 3 1  ON 102
ci_0054                -4.331399e-03 3 1  ON 103
ci_0055                 6.388539e-03 3 1  ON 104
ci_0056                 6.304293e-03 3 1  ON 105
ci_0057                 4.732313e-03 3 1  ON 106
ci_0058                 4.837377e-03 3 1  ON 107
ci_0059                -4.597430e-03 3 1  ON 108
ci_0060                -4.620834e-03 3 1  ON 109
ci_0061                -4.536146e-03 3 1  ON 110
ci_0062                -3.762243e-03 3 1  ON 111
ci_0063                -9.154480e-03 3 1  ON 112
ci_0064                -8.241883e-03 3 1  ON 113
ci_0065                -5.044003e-03 3 1  ON 114
ci_0066                -5.117453e-03 3 1  ON 115
ci_0067                -5.302813e-03 3 1  ON 116
ci_0068                -4.971414e-03 3 1  ON 117
ci_0069                 4.618947e-03 3 1  ON 118
ci_0070                 4.547938e-03 3 1  ON 119
ci_0071                 5.519591e-04 3 1  ON 120
ci_0072                -4.202712e-04 3 1  ON 121
ci_0073                 4.246424e-03 3 1  ON 122
ci_0074                 4.072174e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8655e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.8629
    reference variance = 0.33439
====================================================
  Execution time = 2.1494e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5219e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3207e-01
  Total weights = 1.951524764e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0969e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320365190269
                                         uncertainty =       0.002498949411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320365190269
                                         uncertainty =       0.002498949411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400312773
  error estimate for blocks of size 2^( 2) =       0.000413717903
  error estimate for blocks of size 2^( 3) =       0.000427567713
  error estimate for blocks of size 2^( 4) =       0.000440867292
  error estimate for blocks of size 2^( 5) =       0.000452413440
  error estimate for blocks of size 2^( 6) =       0.000461962564
  error estimate for blocks of size 2^( 7) =       0.000465908382

      target function =                  N/A
              le_mean =     -16.905933497071
             les_mean =     286.142656203945
             stat err =       0.000455287920
             autocorr =       1.293520624985
              std dev =       0.566127753387
             le_variance =       0.320500633155


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690593349707e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905933497053       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905933505056       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905933504601       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905933504988       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905933504738       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905933503634       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905933504649       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905933504328       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905933504312       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905933504583       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.6380e+02 is 1.160783e-06

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905933497053       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905933499054       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905933498941       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905933499037       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905933498976       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905933498699       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905933498951       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905933498875       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905933498869       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905933498933       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4552e+03 is 2.903109e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905933497053       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905933497553       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905933497525       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905933497549       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905933497533       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905933497464       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905933497526       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905933497509       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905933497501       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905933497518       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.8208e+03 is 7.258493e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.499208 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7599e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
   uu_0                 3.117492e-01 1 1  ON 0
   uu_1                 1.447362e-01 1 1  ON 1
   uu_2                 4.305985e-02 1 1  ON 2
   uu_3                -1.916429e-02 1 1  ON 3
   uu_4                -6.454622e-02 1 1  ON 4
   uu_5                -9.933167e-02 1 1  ON 5
   uu_6                -1.264846e-01 1 1  ON 6
   uu_7                -1.389779e-01 1 1  ON 7
   uu_8                -1.311482e-01 1 1  ON 8
   uu_9                -1.002725e-01 1 1  ON 9
   ud_0                 4.453580e-01 1 1  ON 10
   ud_1                 1.799286e-01 1 1  ON 11
   ud_2                 5.987523e-02 1 1  ON 12
   ud_3                -1.077056e-02 1 1  ON 13
   ud_4                -6.720134e-02 1 1  ON 14
   ud_5                -1.077659e-01 1 1  ON 15
   ud_6                -1.341347e-01 1 1  ON 16
   ud_7                -1.497567e-01 1 1  ON 17
   ud_8                -1.506334e-01 1 1  ON 18
   ud_9                -1.385785e-01 1 1  ON 19
   eO_0                -7.471016e-01 1 1  ON 20
   eO_1                -4.276992e-01 1 1  ON 21
   eO_2                -1.909386e-02 1 1  ON 22
   eO_3                 2.902546e-01 1 1  ON 23
   eO_4                 5.129963e-01 1 1  ON 24
   eO_5                 4.729024e-01 1 1  ON 25
   eO_6                 2.454307e-01 1 1  ON 26
   eO_7                -4.920673e-02 1 1  ON 27
   eO_8                -2.099760e-01 1 1  ON 28
   eO_9                -6.984789e-02 1 1  ON 29
  eH1_0                -2.490219e-01 1 1  ON 30
  eH1_1                -1.409971e-01 1 1  ON 31
  eH1_2                -9.187255e-02 1 1  ON 32
  eH1_3                -3.738772e-02 1 1  ON 33
  eH1_4                 1.162388e-02 1 1  ON 34
  eH1_5                 4.535038e-02 1 1  ON 35
  eH1_6                 1.014832e-01 1 1  ON 36
  eH1_7                 1.507921e-01 1 1  ON 37
  eH1_8                 1.645721e-01 1 1  ON 38
  eH1_9                 4.967562e-02 1 1  ON 39
  eH2_0                -2.461119e-01 1 1  ON 40
  eH2_1                -1.390219e-01 1 1  ON 41
  eH2_2                -8.955949e-02 1 1  ON 42
  eH2_3                -3.460218e-02 1 1  ON 43
  eH2_4                 1.430709e-02 1 1  ON 44
  eH2_5                 4.961115e-02 1 1  ON 45
  eH2_6                 1.052393e-01 1 1  ON 46
  eH2_7                 1.534288e-01 1 1  ON 47
  eH2_8                 1.693320e-01 1 1  ON 48
  eH2_9                 3.485946e-02 1 1  ON 49
ci_0001                 7.014432e-01 3 1  ON 50
ci_0002                 7.000937e-01 3 1  ON 51
ci_0003                -2.781578e-02 3 1  ON 52
ci_0004                -2.749399e-02 3 1  ON 53
ci_0005                -3.666368e-02 3 1  ON 54
ci_0006                -3.710351e-02 3 1  ON 55
ci_0007                -2.252335e-02 3 1  ON 56
ci_0008                -2.154093e-02 3 1  ON 57
ci_0009                -1.785419e-02 3 1  ON 58
ci_0010                -1.750966e-02 3 1  ON 59
ci_0011                -1.219941e-02 3 1  ON 60
ci_0012                -1.234291e-02 3 1  ON 61
ci_0013                 1.300332e-02 3 1  ON 62
ci_0014                 1.317609e-02 3 1  ON 63
ci_0015                 1.362867e-02 3 1  ON 64
ci_0016                 1.350223e-02 3 1  ON 65
ci_0017                 1.098479e-02 3 1  ON 66
ci_0018                 1.191885e-02 3 1  ON 67
ci_0019                 1.136381e-02 3 1  ON 68
ci_0020                 1.154727e-02 3 1  ON 69
ci_0021                -2.105825e-03 3 1  ON 70
ci_0022                -4.893987e-04 3 1  ON 71
ci_0023                -1.110319e-02 3 1  ON 72
ci_0024                -1.090589e-02 3 1  ON 73
ci_0025                -1.174936e-02 3 1  ON 74
ci_0026                -1.107773e-02 3 1  ON 75
ci_0027                -1.166791e-02 3 1  ON 76
ci_0028                -1.083325e-02 3 1  ON 77
ci_0029                -9.943172e-03 3 1  ON 78
ci_0030                -1.127254e-02 3 1  ON 79
ci_0031                 2.037078e-02 3 1  ON 80
ci_0032                 2.130189e-02 3 1  ON 81
ci_0033                 1.035086e-02 3 1  ON 82
ci_0034                 9.807607e-03 3 1  ON 83
ci_0035                 6.439392e-03 3 1  ON 84
ci_0036                 6.890074e-03 3 1  ON 85
ci_0037                -1.058531e-02 3 1  ON 86
ci_0038                -1.119411e-02 3 1  ON 87
ci_0039                -2.530196e-03 3 1  ON 88
ci_0040                -2.768253e-03 3 1  ON 89
ci_0041                 6.635587e-03 3 1  ON 90
ci_0042                 7.332310e-03 3 1  ON 91
ci_0043                -1.946178e-02 3 1  ON 92
ci_0044                -1.898805e-02 3 1  ON 93
ci_0045                 7.485660e-03 3 1  ON 94
ci_0046                 7.409077e-03 3 1  ON 95
ci_0047                -1.550311e-03 3 1  ON 96
ci_0048                -1.863600e-03 3 1  ON 97
ci_0049                -5.340884e-03 3 1  ON 98
ci_0050                -5.921061e-03 3 1  ON 99
ci_0051                -3.617657e-03 3 1  ON 100
ci_0052                -3.396049e-03 3 1  ON 101
ci_0053                -4.476778e-03 3 1  ON 102
ci_0054                -4.331451e-03 3 1  ON 103
ci_0055                 6.388472e-03 3 1  ON 104
ci_0056                 6.304278e-03 3 1  ON 105
ci_0057                 4.732311e-03 3 1  ON 106
ci_0058                 4.837217e-03 3 1  ON 107
ci_0059                -4.597634e-03 3 1  ON 108
ci_0060                -4.620722e-03 3 1  ON 109
ci_0061                -4.535856e-03 3 1  ON 110
ci_0062                -3.762222e-03 3 1  ON 111
ci_0063                -9.154399e-03 3 1  ON 112
ci_0064                -8.242031e-03 3 1  ON 113
ci_0065                -5.044207e-03 3 1  ON 114
ci_0066                -5.117543e-03 3 1  ON 115
ci_0067                -5.302761e-03 3 1  ON 116
ci_0068                -4.971488e-03 3 1  ON 117
ci_0069                 4.618869e-03 3 1  ON 118
ci_0070                 4.547994e-03 3 1  ON 119
ci_0071                 5.519447e-04 3 1  ON 120
ci_0072                -4.202396e-04 3 1  ON 121
ci_0073                 4.246496e-03 3 1  ON 122
ci_0074                 4.072286e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.9635
    reference variance = 0.235549
====================================================
  Execution time = 2.1040e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3439e-01
  Total weights = 1.9519e+06
  Execution time = 1.8857e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321880910574
                                         uncertainty =       0.002165698694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321880910574
                                         uncertainty =       0.002165698694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401185027
  error estimate for blocks of size 2^( 2) =       0.000414082850
  error estimate for blocks of size 2^( 3) =       0.000427099653
  error estimate for blocks of size 2^( 4) =       0.000438770496
  error estimate for blocks of size 2^( 5) =       0.000448713957
  error estimate for blocks of size 2^( 6) =       0.000456223589
  error estimate for blocks of size 2^( 7) =       0.000461842923

      target function =                  N/A
              le_mean =     -16.906844882475
             les_mean =     286.175797666971
             stat err =       0.000451387741
             autocorr =       1.265931155084
              std dev =       0.567361306832
             le_variance =       0.321898852490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321880807808
                                         uncertainty =       0.002165705810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321880807808
                                         uncertainty =       0.002165705810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401184964
  error estimate for blocks of size 2^( 2) =       0.000414082776
  error estimate for blocks of size 2^( 3) =       0.000427099561
  error estimate for blocks of size 2^( 4) =       0.000438770400
  error estimate for blocks of size 2^( 5) =       0.000448713854
  error estimate for blocks of size 2^( 6) =       0.000456223460
  error estimate for blocks of size 2^( 7) =       0.000461842789

      target function =                  N/A
              le_mean =     -16.906844893168
             les_mean =     286.175797866470
             stat err =       0.000451387626
             autocorr =       1.265930907914
              std dev =       0.567361216667
             le_variance =       0.321898750178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321880859157
                                         uncertainty =       0.002165702254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321880859157
                                         uncertainty =       0.002165702254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401184996
  error estimate for blocks of size 2^( 2) =       0.000414082813
  error estimate for blocks of size 2^( 3) =       0.000427099607
  error estimate for blocks of size 2^( 4) =       0.000438770448
  error estimate for blocks of size 2^( 5) =       0.000448713906
  error estimate for blocks of size 2^( 6) =       0.000456223524
  error estimate for blocks of size 2^( 7) =       0.000461842856

      target function =                  N/A
              le_mean =     -16.906844887818
             les_mean =     286.175797761959
             stat err =       0.000451387683
             autocorr =       1.265931031385
              std dev =       0.567361261720
             le_variance =       0.321898801300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321880904143
                                         uncertainty =       0.002165699139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321880904143
                                         uncertainty =       0.002165699139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401185023
  error estimate for blocks of size 2^( 2) =       0.000414082845
  error estimate for blocks of size 2^( 3) =       0.000427099647
  error estimate for blocks of size 2^( 4) =       0.000438770490
  error estimate for blocks of size 2^( 5) =       0.000448713951
  error estimate for blocks of size 2^( 6) =       0.000456223581
  error estimate for blocks of size 2^( 7) =       0.000461842915

      target function =                  N/A
              le_mean =     -16.906844883142
             les_mean =     286.175797678303
             stat err =       0.000451387734
             autocorr =       1.265931139620
              std dev =       0.567361301189
             le_variance =       0.321898846087


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906844882475        initial
     3.6380e+02     3.6380e+03             1.1608e-06       -16.906844893168  <--
     1.4552e+03     1.4552e+04             2.9031e-07       -16.906844887818
     5.8208e+03     5.8208e+04             7.2585e-08       -16.906844883142

*****************************************************************************
Applying the update for shift_i =   3.6380e+02     and shift_s =   3.6380e+03
*****************************************************************************

  Execution time = 3.0560e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
   uu_0                 3.117492e-01 1 1  ON 0
   uu_1                 1.447364e-01 1 1  ON 1
   uu_2                 4.305993e-02 1 1  ON 2
   uu_3                -1.916443e-02 1 1  ON 3
   uu_4                -6.454639e-02 1 1  ON 4
   uu_5                -9.933163e-02 1 1  ON 5
   uu_6                -1.264848e-01 1 1  ON 6
   uu_7                -1.389782e-01 1 1  ON 7
   uu_8                -1.311483e-01 1 1  ON 8
   uu_9                -1.002726e-01 1 1  ON 9
   ud_0                 4.453580e-01 1 1  ON 10
   ud_1                 1.799286e-01 1 1  ON 11
   ud_2                 5.987515e-02 1 1  ON 12
   ud_3                -1.077052e-02 1 1  ON 13
   ud_4                -6.720131e-02 1 1  ON 14
   ud_5                -1.077659e-01 1 1  ON 15
   ud_6                -1.341349e-01 1 1  ON 16
   ud_7                -1.497569e-01 1 1  ON 17
   ud_8                -1.506334e-01 1 1  ON 18
   ud_9                -1.385784e-01 1 1  ON 19
   eO_0                -7.471017e-01 1 1  ON 20
   eO_1                -4.276997e-01 1 1  ON 21
   eO_2                -1.909373e-02 1 1  ON 22
   eO_3                 2.902549e-01 1 1  ON 23
   eO_4                 5.129964e-01 1 1  ON 24
   eO_5                 4.729026e-01 1 1  ON 25
   eO_6                 2.454308e-01 1 1  ON 26
   eO_7                -4.920660e-02 1 1  ON 27
   eO_8                -2.099762e-01 1 1  ON 28
   eO_9                -6.984810e-02 1 1  ON 29
  eH1_0                -2.490219e-01 1 1  ON 30
  eH1_1                -1.409975e-01 1 1  ON 31
  eH1_2                -9.187303e-02 1 1  ON 32
  eH1_3                -3.738786e-02 1 1  ON 33
  eH1_4                 1.162382e-02 1 1  ON 34
  eH1_5                 4.535015e-02 1 1  ON 35
  eH1_6                 1.014832e-01 1 1  ON 36
  eH1_7                 1.507923e-01 1 1  ON 37
  eH1_8                 1.645725e-01 1 1  ON 38
  eH1_9                 4.967609e-02 1 1  ON 39
  eH2_0                -2.461122e-01 1 1  ON 40
  eH2_1                -1.390216e-01 1 1  ON 41
  eH2_2                -8.955974e-02 1 1  ON 42
  eH2_3                -3.460234e-02 1 1  ON 43
  eH2_4                 1.430718e-02 1 1  ON 44
  eH2_5                 4.961073e-02 1 1  ON 45
  eH2_6                 1.052391e-01 1 1  ON 46
  eH2_7                 1.534290e-01 1 1  ON 47
  eH2_8                 1.693323e-01 1 1  ON 48
  eH2_9                 3.485991e-02 1 1  ON 49
ci_0001                 7.014433e-01 3 1  ON 50
ci_0002                 7.000937e-01 3 1  ON 51
ci_0003                -2.781605e-02 3 1  ON 52
ci_0004                -2.749383e-02 3 1  ON 53
ci_0005                -3.666361e-02 3 1  ON 54
ci_0006                -3.710348e-02 3 1  ON 55
ci_0007                -2.252296e-02 3 1  ON 56
ci_0008                -2.154099e-02 3 1  ON 57
ci_0009                -1.785431e-02 3 1  ON 58
ci_0010                -1.750948e-02 3 1  ON 59
ci_0011                -1.219910e-02 3 1  ON 60
ci_0012                -1.234300e-02 3 1  ON 61
ci_0013                 1.300335e-02 3 1  ON 62
ci_0014                 1.317617e-02 3 1  ON 63
ci_0015                 1.362827e-02 3 1  ON 64
ci_0016                 1.350233e-02 3 1  ON 65
ci_0017                 1.098480e-02 3 1  ON 66
ci_0018                 1.191846e-02 3 1  ON 67
ci_0019                 1.136369e-02 3 1  ON 68
ci_0020                 1.154749e-02 3 1  ON 69
ci_0021                -2.105335e-03 3 1  ON 70
ci_0022                -4.890690e-04 3 1  ON 71
ci_0023                -1.110353e-02 3 1  ON 72
ci_0024                -1.090573e-02 3 1  ON 73
ci_0025                -1.174916e-02 3 1  ON 74
ci_0026                -1.107758e-02 3 1  ON 75
ci_0027                -1.166768e-02 3 1  ON 76
ci_0028                -1.083302e-02 3 1  ON 77
ci_0029                -9.943403e-03 3 1  ON 78
ci_0030                -1.127223e-02 3 1  ON 79
ci_0031                 2.037055e-02 3 1  ON 80
ci_0032                 2.130184e-02 3 1  ON 81
ci_0033                 1.035119e-02 3 1  ON 82
ci_0034                 9.807491e-03 3 1  ON 83
ci_0035                 6.440024e-03 3 1  ON 84
ci_0036                 6.890076e-03 3 1  ON 85
ci_0037                -1.058575e-02 3 1  ON 86
ci_0038                -1.119384e-02 3 1  ON 87
ci_0039                -2.530118e-03 3 1  ON 88
ci_0040                -2.768061e-03 3 1  ON 89
ci_0041                 6.635663e-03 3 1  ON 90
ci_0042                 7.331733e-03 3 1  ON 91
ci_0043                -1.946161e-02 3 1  ON 92
ci_0044                -1.898751e-02 3 1  ON 93
ci_0045                 7.485343e-03 3 1  ON 94
ci_0046                 7.408939e-03 3 1  ON 95
ci_0047                -1.550332e-03 3 1  ON 96
ci_0048                -1.863198e-03 3 1  ON 97
ci_0049                -5.340961e-03 3 1  ON 98
ci_0050                -5.921062e-03 3 1  ON 99
ci_0051                -3.617725e-03 3 1  ON 100
ci_0052                -3.396021e-03 3 1  ON 101
ci_0053                -4.476883e-03 3 1  ON 102
ci_0054                -4.331604e-03 3 1  ON 103
ci_0055                 6.388272e-03 3 1  ON 104
ci_0056                 6.304231e-03 3 1  ON 105
ci_0057                 4.732307e-03 3 1  ON 106
ci_0058                 4.836739e-03 3 1  ON 107
ci_0059                -4.598246e-03 3 1  ON 108
ci_0060                -4.620386e-03 3 1  ON 109
ci_0061                -4.534985e-03 3 1  ON 110
ci_0062                -3.762157e-03 3 1  ON 111
ci_0063                -9.154157e-03 3 1  ON 112
ci_0064                -8.242474e-03 3 1  ON 113
ci_0065                -5.044819e-03 3 1  ON 114
ci_0066                -5.117813e-03 3 1  ON 115
ci_0067                -5.302604e-03 3 1  ON 116
ci_0068                -4.971708e-03 3 1  ON 117
ci_0069                 4.618634e-03 3 1  ON 118
ci_0070                 4.548164e-03 3 1  ON 119
ci_0071                 5.519015e-04 3 1  ON 120
ci_0072                -4.201450e-04 3 1  ON 121
ci_0073                 4.246711e-03 3 1  ON 122
ci_0074                 4.072621e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8166e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.8641
    reference variance = 0.264526
====================================================
  Execution time = 2.3407e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3586e-01
  Total weights = 1.951604235e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0249e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322999890123
                                         uncertainty =       0.002798719764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322999890123
                                         uncertainty =       0.002798719764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401867064
  error estimate for blocks of size 2^( 2) =       0.000414643118
  error estimate for blocks of size 2^( 3) =       0.000427630185
  error estimate for blocks of size 2^( 4) =       0.000440061874
  error estimate for blocks of size 2^( 5) =       0.000450877440
  error estimate for blocks of size 2^( 6) =       0.000457487743
  error estimate for blocks of size 2^( 7) =       0.000463961424

      target function =                  N/A
              le_mean =     -16.906249850042
             les_mean =     286.157145142929
             stat err =       0.000453097120
             autocorr =       1.271211390312
              std dev =       0.568325852314
             le_variance =       0.322994274408


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690624985004e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906249850030       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906249912224       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906249917066       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906249909274       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906249909443       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906249902472       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906249906150       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906249908770       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906249908803       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906249908584       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.0949e+01 is 4.451725e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906249850030       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906249865606       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906249866819       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906249864865       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906249864905       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906249863159       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906249864072       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906249864733       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906249864740       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906249864687       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.6380e+02 is 1.114813e-06

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906249850030       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906249853926       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906249854229       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906249853740       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906249853751       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906249853313       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906249853541       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906249853707       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906249853713       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906249853694       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4552e+03 is 2.788210e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.503047 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9440e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
   uu_0                 3.117494e-01 1 1  ON 0
   uu_1                 1.447368e-01 1 1  ON 1
   uu_2                 4.305967e-02 1 1  ON 2
   uu_3                -1.916463e-02 1 1  ON 3
   uu_4                -6.454632e-02 1 1  ON 4
   uu_5                -9.933157e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389783e-01 1 1  ON 7
   uu_8                -1.311488e-01 1 1  ON 8
   uu_9                -1.002731e-01 1 1  ON 9
   ud_0                 4.453586e-01 1 1  ON 10
   ud_1                 1.799287e-01 1 1  ON 11
   ud_2                 5.987543e-02 1 1  ON 12
   ud_3                -1.077008e-02 1 1  ON 13
   ud_4                -6.720135e-02 1 1  ON 14
   ud_5                -1.077659e-01 1 1  ON 15
   ud_6                -1.341350e-01 1 1  ON 16
   ud_7                -1.497569e-01 1 1  ON 17
   ud_8                -1.506337e-01 1 1  ON 18
   ud_9                -1.385789e-01 1 1  ON 19
   eO_0                -7.471023e-01 1 1  ON 20
   eO_1                -4.276997e-01 1 1  ON 21
   eO_2                -1.909350e-02 1 1  ON 22
   eO_3                 2.902552e-01 1 1  ON 23
   eO_4                 5.129966e-01 1 1  ON 24
   eO_5                 4.729027e-01 1 1  ON 25
   eO_6                 2.454312e-01 1 1  ON 26
   eO_7                -4.920632e-02 1 1  ON 27
   eO_8                -2.099767e-01 1 1  ON 28
   eO_9                -6.984852e-02 1 1  ON 29
  eH1_0                -2.490221e-01 1 1  ON 30
  eH1_1                -1.409981e-01 1 1  ON 31
  eH1_2                -9.187331e-02 1 1  ON 32
  eH1_3                -3.738771e-02 1 1  ON 33
  eH1_4                 1.162366e-02 1 1  ON 34
  eH1_5                 4.535014e-02 1 1  ON 35
  eH1_6                 1.014832e-01 1 1  ON 36
  eH1_7                 1.507926e-01 1 1  ON 37
  eH1_8                 1.645730e-01 1 1  ON 38
  eH1_9                 4.967652e-02 1 1  ON 39
  eH2_0                -2.461127e-01 1 1  ON 40
  eH2_1                -1.390219e-01 1 1  ON 41
  eH2_2                -8.955984e-02 1 1  ON 42
  eH2_3                -3.460219e-02 1 1  ON 43
  eH2_4                 1.430713e-02 1 1  ON 44
  eH2_5                 4.961039e-02 1 1  ON 45
  eH2_6                 1.052390e-01 1 1  ON 46
  eH2_7                 1.534292e-01 1 1  ON 47
  eH2_8                 1.693326e-01 1 1  ON 48
  eH2_9                 3.486041e-02 1 1  ON 49
ci_0001                 7.014433e-01 3 1  ON 50
ci_0002                 7.000939e-01 3 1  ON 51
ci_0003                -2.781607e-02 3 1  ON 52
ci_0004                -2.749326e-02 3 1  ON 53
ci_0005                -3.666376e-02 3 1  ON 54
ci_0006                -3.710295e-02 3 1  ON 55
ci_0007                -2.252269e-02 3 1  ON 56
ci_0008                -2.154069e-02 3 1  ON 57
ci_0009                -1.785443e-02 3 1  ON 58
ci_0010                -1.750916e-02 3 1  ON 59
ci_0011                -1.219914e-02 3 1  ON 60
ci_0012                -1.234277e-02 3 1  ON 61
ci_0013                 1.300357e-02 3 1  ON 62
ci_0014                 1.317616e-02 3 1  ON 63
ci_0015                 1.362822e-02 3 1  ON 64
ci_0016                 1.350243e-02 3 1  ON 65
ci_0017                 1.098520e-02 3 1  ON 66
ci_0018                 1.191788e-02 3 1  ON 67
ci_0019                 1.136357e-02 3 1  ON 68
ci_0020                 1.154696e-02 3 1  ON 69
ci_0021                -2.105084e-03 3 1  ON 70
ci_0022                -4.890471e-04 3 1  ON 71
ci_0023                -1.110339e-02 3 1  ON 72
ci_0024                -1.090550e-02 3 1  ON 73
ci_0025                -1.174843e-02 3 1  ON 74
ci_0026                -1.107714e-02 3 1  ON 75
ci_0027                -1.166687e-02 3 1  ON 76
ci_0028                -1.083261e-02 3 1  ON 77
ci_0029                -9.944111e-03 3 1  ON 78
ci_0030                -1.127187e-02 3 1  ON 79
ci_0031                 2.037015e-02 3 1  ON 80
ci_0032                 2.130096e-02 3 1  ON 81
ci_0033                 1.035157e-02 3 1  ON 82
ci_0034                 9.807436e-03 3 1  ON 83
ci_0035                 6.440003e-03 3 1  ON 84
ci_0036                 6.890566e-03 3 1  ON 85
ci_0037                -1.058555e-02 3 1  ON 86
ci_0038                -1.119347e-02 3 1  ON 87
ci_0039                -2.530421e-03 3 1  ON 88
ci_0040                -2.767492e-03 3 1  ON 89
ci_0041                 6.635641e-03 3 1  ON 90
ci_0042                 7.331447e-03 3 1  ON 91
ci_0043                -1.946143e-02 3 1  ON 92
ci_0044                -1.898786e-02 3 1  ON 93
ci_0045                 7.485589e-03 3 1  ON 94
ci_0046                 7.408988e-03 3 1  ON 95
ci_0047                -1.550828e-03 3 1  ON 96
ci_0048                -1.862899e-03 3 1  ON 97
ci_0049                -5.340917e-03 3 1  ON 98
ci_0050                -5.920626e-03 3 1  ON 99
ci_0051                -3.617645e-03 3 1  ON 100
ci_0052                -3.395952e-03 3 1  ON 101
ci_0053                -4.477462e-03 3 1  ON 102
ci_0054                -4.331820e-03 3 1  ON 103
ci_0055                 6.388072e-03 3 1  ON 104
ci_0056                 6.304387e-03 3 1  ON 105
ci_0057                 4.732176e-03 3 1  ON 106
ci_0058                 4.836682e-03 3 1  ON 107
ci_0059                -4.598362e-03 3 1  ON 108
ci_0060                -4.620818e-03 3 1  ON 109
ci_0061                -4.534824e-03 3 1  ON 110
ci_0062                -3.762230e-03 3 1  ON 111
ci_0063                -9.154327e-03 3 1  ON 112
ci_0064                -8.243310e-03 3 1  ON 113
ci_0065                -5.044751e-03 3 1  ON 114
ci_0066                -5.118280e-03 3 1  ON 115
ci_0067                -5.302175e-03 3 1  ON 116
ci_0068                -4.971981e-03 3 1  ON 117
ci_0069                 4.618835e-03 3 1  ON 118
ci_0070                 4.548573e-03 3 1  ON 119
ci_0071                 5.510375e-04 3 1  ON 120
ci_0072                -4.190301e-04 3 1  ON 121
ci_0073                 4.246896e-03 3 1  ON 122
ci_0074                 4.072963e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.0134
    reference variance = 0.570668
====================================================
  Execution time = 2.1358e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4082e-01
  Total weights = 1.9518e+06
  Execution time = 1.8861e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326041565679
                                         uncertainty =       0.002503290296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326041565679
                                         uncertainty =       0.002503290296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403732844
  error estimate for blocks of size 2^( 2) =       0.000416765023
  error estimate for blocks of size 2^( 3) =       0.000430351758
  error estimate for blocks of size 2^( 4) =       0.000442966582
  error estimate for blocks of size 2^( 5) =       0.000454892786
  error estimate for blocks of size 2^( 6) =       0.000463031616
  error estimate for blocks of size 2^( 7) =       0.000470248467

      target function =                  N/A
              le_mean =     -16.906229848847
             les_mean =     286.161427781295
             stat err =       0.000457784863
             autocorr =       1.285685343512
              std dev =       0.570964464219
             le_variance =       0.326000419401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326042055210
                                         uncertainty =       0.002503046886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326042055210
                                         uncertainty =       0.002503046886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403733150
  error estimate for blocks of size 2^( 2) =       0.000416765230
  error estimate for blocks of size 2^( 3) =       0.000430351932
  error estimate for blocks of size 2^( 4) =       0.000442966824
  error estimate for blocks of size 2^( 5) =       0.000454893142
  error estimate for blocks of size 2^( 6) =       0.000463032008
  error estimate for blocks of size 2^( 7) =       0.000470248550

      target function =                  N/A
              le_mean =     -16.906229891454
             les_mean =     286.161424656678
             stat err =       0.000457785131
             autocorr =       1.285684906108
              std dev =       0.570964895752
             le_variance =       0.326000912181

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326041812407
                                         uncertainty =       0.002503168403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326041812407
                                         uncertainty =       0.002503168403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403732998
  error estimate for blocks of size 2^( 2) =       0.000416765127
  error estimate for blocks of size 2^( 3) =       0.000430351846
  error estimate for blocks of size 2^( 4) =       0.000442966704
  error estimate for blocks of size 2^( 5) =       0.000454892965
  error estimate for blocks of size 2^( 6) =       0.000463031813
  error estimate for blocks of size 2^( 7) =       0.000470248509

      target function =                  N/A
              le_mean =     -16.906229870103
             les_mean =     286.161426196841
             stat err =       0.000457784998
             autocorr =       1.285685122589
              std dev =       0.570964681706
             le_variance =       0.326000667755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326041596512
                                         uncertainty =       0.002503275050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326041596512
                                         uncertainty =       0.002503275050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403732864
  error estimate for blocks of size 2^( 2) =       0.000416765036
  error estimate for blocks of size 2^( 3) =       0.000430351769
  error estimate for blocks of size 2^( 4) =       0.000442966598
  error estimate for blocks of size 2^( 5) =       0.000454892808
  error estimate for blocks of size 2^( 6) =       0.000463031641
  error estimate for blocks of size 2^( 7) =       0.000470248472

      target function =                  N/A
              le_mean =     -16.906229851494
             les_mean =     286.161427580713
             stat err =       0.000457784880
             autocorr =       1.285685315884
              std dev =       0.570964491398
             le_variance =       0.326000450437


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906229848847        initial
     9.0949e+01     9.0949e+02             4.4517e-06       -16.906229891454  <--
     3.6380e+02     3.6380e+03             1.1148e-06       -16.906229870103
     1.4552e+03     1.4552e+04             2.7882e-07       -16.906229851494

*****************************************************************************
Applying the update for shift_i =   9.0949e+01     and shift_s =   9.0949e+02
*****************************************************************************

  Execution time = 3.0897e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
   uu_0                 3.117498e-01 1 1  ON 0
   uu_1                 1.447379e-01 1 1  ON 1
   uu_2                 4.305892e-02 1 1  ON 2
   uu_3                -1.916521e-02 1 1  ON 3
   uu_4                -6.454611e-02 1 1  ON 4
   uu_5                -9.933139e-02 1 1  ON 5
   uu_6                -1.264830e-01 1 1  ON 6
   uu_7                -1.389788e-01 1 1  ON 7
   uu_8                -1.311502e-01 1 1  ON 8
   uu_9                -1.002744e-01 1 1  ON 9
   ud_0                 4.453605e-01 1 1  ON 10
   ud_1                 1.799290e-01 1 1  ON 11
   ud_2                 5.987627e-02 1 1  ON 12
   ud_3                -1.076879e-02 1 1  ON 13
   ud_4                -6.720145e-02 1 1  ON 14
   ud_5                -1.077660e-01 1 1  ON 15
   ud_6                -1.341354e-01 1 1  ON 16
   ud_7                -1.497570e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385804e-01 1 1  ON 19
   eO_0                -7.471038e-01 1 1  ON 20
   eO_1                -4.276998e-01 1 1  ON 21
   eO_2                -1.909281e-02 1 1  ON 22
   eO_3                 2.902564e-01 1 1  ON 23
   eO_4                 5.129970e-01 1 1  ON 24
   eO_5                 4.729030e-01 1 1  ON 25
   eO_6                 2.454324e-01 1 1  ON 26
   eO_7                -4.920547e-02 1 1  ON 27
   eO_8                -2.099782e-01 1 1  ON 28
   eO_9                -6.984981e-02 1 1  ON 29
  eH1_0                -2.490229e-01 1 1  ON 30
  eH1_1                -1.409999e-01 1 1  ON 31
  eH1_2                -9.187417e-02 1 1  ON 32
  eH1_3                -3.738728e-02 1 1  ON 33
  eH1_4                 1.162320e-02 1 1  ON 34
  eH1_5                 4.535012e-02 1 1  ON 35
  eH1_6                 1.014833e-01 1 1  ON 36
  eH1_7                 1.507934e-01 1 1  ON 37
  eH1_8                 1.645744e-01 1 1  ON 38
  eH1_9                 4.967781e-02 1 1  ON 39
  eH2_0                -2.461141e-01 1 1  ON 40
  eH2_1                -1.390225e-01 1 1  ON 41
  eH2_2                -8.956017e-02 1 1  ON 42
  eH2_3                -3.460176e-02 1 1  ON 43
  eH2_4                 1.430698e-02 1 1  ON 44
  eH2_5                 4.960935e-02 1 1  ON 45
  eH2_6                 1.052389e-01 1 1  ON 46
  eH2_7                 1.534299e-01 1 1  ON 47
  eH2_8                 1.693336e-01 1 1  ON 48
  eH2_9                 3.486190e-02 1 1  ON 49
ci_0001                 7.014433e-01 3 1  ON 50
ci_0002                 7.000942e-01 3 1  ON 51
ci_0003                -2.781614e-02 3 1  ON 52
ci_0004                -2.749156e-02 3 1  ON 53
ci_0005                -3.666422e-02 3 1  ON 54
ci_0006                -3.710138e-02 3 1  ON 55
ci_0007                -2.252188e-02 3 1  ON 56
ci_0008                -2.153982e-02 3 1  ON 57
ci_0009                -1.785477e-02 3 1  ON 58
ci_0010                -1.750820e-02 3 1  ON 59
ci_0011                -1.219925e-02 3 1  ON 60
ci_0012                -1.234209e-02 3 1  ON 61
ci_0013                 1.300423e-02 3 1  ON 62
ci_0014                 1.317613e-02 3 1  ON 63
ci_0015                 1.362808e-02 3 1  ON 64
ci_0016                 1.350270e-02 3 1  ON 65
ci_0017                 1.098638e-02 3 1  ON 66
ci_0018                 1.191613e-02 3 1  ON 67
ci_0019                 1.136320e-02 3 1  ON 68
ci_0020                 1.154538e-02 3 1  ON 69
ci_0021                -2.104331e-03 3 1  ON 70
ci_0022                -4.889821e-04 3 1  ON 71
ci_0023                -1.110296e-02 3 1  ON 72
ci_0024                -1.090481e-02 3 1  ON 73
ci_0025                -1.174624e-02 3 1  ON 74
ci_0026                -1.107583e-02 3 1  ON 75
ci_0027                -1.166447e-02 3 1  ON 76
ci_0028                -1.083139e-02 3 1  ON 77
ci_0029                -9.946229e-03 3 1  ON 78
ci_0030                -1.127081e-02 3 1  ON 79
ci_0031                 2.036895e-02 3 1  ON 80
ci_0032                 2.129832e-02 3 1  ON 81
ci_0033                 1.035269e-02 3 1  ON 82
ci_0034                 9.807270e-03 3 1  ON 83
ci_0035                 6.439941e-03 3 1  ON 84
ci_0036                 6.892036e-03 3 1  ON 85
ci_0037                -1.058496e-02 3 1  ON 86
ci_0038                -1.119236e-02 3 1  ON 87
ci_0039                -2.531326e-03 3 1  ON 88
ci_0040                -2.765789e-03 3 1  ON 89
ci_0041                 6.635578e-03 3 1  ON 90
ci_0042                 7.330588e-03 3 1  ON 91
ci_0043                -1.946089e-02 3 1  ON 92
ci_0044                -1.898891e-02 3 1  ON 93
ci_0045                 7.486325e-03 3 1  ON 94
ci_0046                 7.409134e-03 3 1  ON 95
ci_0047                -1.552310e-03 3 1  ON 96
ci_0048                -1.862009e-03 3 1  ON 97
ci_0049                -5.340785e-03 3 1  ON 98
ci_0050                -5.919321e-03 3 1  ON 99
ci_0051                -3.617404e-03 3 1  ON 100
ci_0052                -3.395744e-03 3 1  ON 101
ci_0053                -4.479196e-03 3 1  ON 102
ci_0054                -4.332467e-03 3 1  ON 103
ci_0055                 6.387473e-03 3 1  ON 104
ci_0056                 6.304852e-03 3 1  ON 105
ci_0057                 4.731785e-03 3 1  ON 106
ci_0058                 4.836511e-03 3 1  ON 107
ci_0059                -4.598711e-03 3 1  ON 108
ci_0060                -4.622110e-03 3 1  ON 109
ci_0061                -4.534343e-03 3 1  ON 110
ci_0062                -3.762446e-03 3 1  ON 111
ci_0063                -9.154838e-03 3 1  ON 112
ci_0064                -8.245811e-03 3 1  ON 113
ci_0065                -5.044549e-03 3 1  ON 114
ci_0066                -5.119679e-03 3 1  ON 115
ci_0067                -5.300894e-03 3 1  ON 116
ci_0068                -4.972798e-03 3 1  ON 117
ci_0069                 4.619434e-03 3 1  ON 118
ci_0070                 4.549795e-03 3 1  ON 119
ci_0071                 5.484514e-04 3 1  ON 120
ci_0072                -4.156932e-04 3 1  ON 121
ci_0073                 4.247449e-03 3 1  ON 122
ci_0074                 4.073984e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0344e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.8587
    reference variance = 0.18969
====================================================
  Execution time = 2.1487e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3531e-01
  Total weights = 1.951815694e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1874e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320327458836
                                         uncertainty =       0.001916711592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320327458836
                                         uncertainty =       0.001916711592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400218178
  error estimate for blocks of size 2^( 2) =       0.000412944942
  error estimate for blocks of size 2^( 3) =       0.000425408388
  error estimate for blocks of size 2^( 4) =       0.000437307686
  error estimate for blocks of size 2^( 5) =       0.000447314779
  error estimate for blocks of size 2^( 6) =       0.000455307101
  error estimate for blocks of size 2^( 7) =       0.000460480616

      target function =                  N/A
              le_mean =     -16.906690981445
             les_mean =     286.171509830919
             stat err =       0.000450102545
             autocorr =       1.264821729004
              std dev =       0.565993974550
             le_variance =       0.320349179227


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690669098144e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906690981443       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906691022761       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906690990885       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906690982322       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906690986624       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906690986465       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906690976705       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906690988776       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906690992725       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906690994847       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.2737e+01 is 2.653410e-05

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906690981443       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906690991840       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906690983767       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906690981534       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906690982503       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906690982363       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906690979940       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906690982955       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906690983938       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906690984496       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.0949e+01 is 6.681963e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906690981443       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906690984047       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906690982022       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906690981458       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906690981693       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906690981652       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906690981047       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906690981801       residual = 6.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906690982047       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906690982187       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.6380e+02 is 1.673546e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.506905 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7682e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
   uu_0                 3.117521e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305923e-02 1 1  ON 2
   uu_3                -1.916515e-02 1 1  ON 3
   uu_4                -6.454576e-02 1 1  ON 4
   uu_5                -9.933192e-02 1 1  ON 5
   uu_6                -1.264824e-01 1 1  ON 6
   uu_7                -1.389795e-01 1 1  ON 7
   uu_8                -1.311525e-01 1 1  ON 8
   uu_9                -1.002763e-01 1 1  ON 9
   ud_0                 4.453615e-01 1 1  ON 10
   ud_1                 1.799302e-01 1 1  ON 11
   ud_2                 5.987587e-02 1 1  ON 12
   ud_3                -1.076832e-02 1 1  ON 13
   ud_4                -6.719987e-02 1 1  ON 14
   ud_5                -1.077665e-01 1 1  ON 15
   ud_6                -1.341349e-01 1 1  ON 16
   ud_7                -1.497577e-01 1 1  ON 17
   ud_8                -1.506357e-01 1 1  ON 18
   ud_9                -1.385815e-01 1 1  ON 19
   eO_0                -7.471044e-01 1 1  ON 20
   eO_1                -4.277004e-01 1 1  ON 21
   eO_2                -1.909235e-02 1 1  ON 22
   eO_3                 2.902566e-01 1 1  ON 23
   eO_4                 5.129972e-01 1 1  ON 24
   eO_5                 4.729042e-01 1 1  ON 25
   eO_6                 2.454346e-01 1 1  ON 26
   eO_7                -4.920502e-02 1 1  ON 27
   eO_8                -2.099798e-01 1 1  ON 28
   eO_9                -6.985139e-02 1 1  ON 29
  eH1_0                -2.490221e-01 1 1  ON 30
  eH1_1                -1.410024e-01 1 1  ON 31
  eH1_2                -9.187534e-02 1 1  ON 32
  eH1_3                -3.738797e-02 1 1  ON 33
  eH1_4                 1.162296e-02 1 1  ON 34
  eH1_5                 4.534972e-02 1 1  ON 35
  eH1_6                 1.014821e-01 1 1  ON 36
  eH1_7                 1.507948e-01 1 1  ON 37
  eH1_8                 1.645768e-01 1 1  ON 38
  eH1_9                 4.967932e-02 1 1  ON 39
  eH2_0                -2.461155e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956099e-02 1 1  ON 42
  eH2_3                -3.460117e-02 1 1  ON 43
  eH2_4                 1.430696e-02 1 1  ON 44
  eH2_5                 4.960747e-02 1 1  ON 45
  eH2_6                 1.052390e-01 1 1  ON 46
  eH2_7                 1.534314e-01 1 1  ON 47
  eH2_8                 1.693351e-01 1 1  ON 48
  eH2_9                 3.486350e-02 1 1  ON 49
ci_0001                 7.014428e-01 3 1  ON 50
ci_0002                 7.000953e-01 3 1  ON 51
ci_0003                -2.781601e-02 3 1  ON 52
ci_0004                -2.749017e-02 3 1  ON 53
ci_0005                -3.666565e-02 3 1  ON 54
ci_0006                -3.710006e-02 3 1  ON 55
ci_0007                -2.252082e-02 3 1  ON 56
ci_0008                -2.153915e-02 3 1  ON 57
ci_0009                -1.785460e-02 3 1  ON 58
ci_0010                -1.750964e-02 3 1  ON 59
ci_0011                -1.219438e-02 3 1  ON 60
ci_0012                -1.234376e-02 3 1  ON 61
ci_0013                 1.300301e-02 3 1  ON 62
ci_0014                 1.317566e-02 3 1  ON 63
ci_0015                 1.362712e-02 3 1  ON 64
ci_0016                 1.350154e-02 3 1  ON 65
ci_0017                 1.098738e-02 3 1  ON 66
ci_0018                 1.191557e-02 3 1  ON 67
ci_0019                 1.136301e-02 3 1  ON 68
ci_0020                 1.154666e-02 3 1  ON 69
ci_0021                -2.103511e-03 3 1  ON 70
ci_0022                -4.895340e-04 3 1  ON 71
ci_0023                -1.110261e-02 3 1  ON 72
ci_0024                -1.090568e-02 3 1  ON 73
ci_0025                -1.173955e-02 3 1  ON 74
ci_0026                -1.107519e-02 3 1  ON 75
ci_0027                -1.166356e-02 3 1  ON 76
ci_0028                -1.083204e-02 3 1  ON 77
ci_0029                -9.949528e-03 3 1  ON 78
ci_0030                -1.126868e-02 3 1  ON 79
ci_0031                 2.036699e-02 3 1  ON 80
ci_0032                 2.129725e-02 3 1  ON 81
ci_0033                 1.035742e-02 3 1  ON 82
ci_0034                 9.805171e-03 3 1  ON 83
ci_0035                 6.437987e-03 3 1  ON 84
ci_0036                 6.890984e-03 3 1  ON 85
ci_0037                -1.058363e-02 3 1  ON 86
ci_0038                -1.119037e-02 3 1  ON 87
ci_0039                -2.533283e-03 3 1  ON 88
ci_0040                -2.765487e-03 3 1  ON 89
ci_0041                 6.637662e-03 3 1  ON 90
ci_0042                 7.330160e-03 3 1  ON 91
ci_0043                -1.945828e-02 3 1  ON 92
ci_0044                -1.898991e-02 3 1  ON 93
ci_0045                 7.483599e-03 3 1  ON 94
ci_0046                 7.409990e-03 3 1  ON 95
ci_0047                -1.554540e-03 3 1  ON 96
ci_0048                -1.861010e-03 3 1  ON 97
ci_0049                -5.344350e-03 3 1  ON 98
ci_0050                -5.921584e-03 3 1  ON 99
ci_0051                -3.617635e-03 3 1  ON 100
ci_0052                -3.395720e-03 3 1  ON 101
ci_0053                -4.479110e-03 3 1  ON 102
ci_0054                -4.330384e-03 3 1  ON 103
ci_0055                 6.385820e-03 3 1  ON 104
ci_0056                 6.303338e-03 3 1  ON 105
ci_0057                 4.730985e-03 3 1  ON 106
ci_0058                 4.837189e-03 3 1  ON 107
ci_0059                -4.599057e-03 3 1  ON 108
ci_0060                -4.621930e-03 3 1  ON 109
ci_0061                -4.533034e-03 3 1  ON 110
ci_0062                -3.764066e-03 3 1  ON 111
ci_0063                -9.154679e-03 3 1  ON 112
ci_0064                -8.246100e-03 3 1  ON 113
ci_0065                -5.044780e-03 3 1  ON 114
ci_0066                -5.118098e-03 3 1  ON 115
ci_0067                -5.299700e-03 3 1  ON 116
ci_0068                -4.974379e-03 3 1  ON 117
ci_0069                 4.619250e-03 3 1  ON 118
ci_0070                 4.550699e-03 3 1  ON 119
ci_0071                 5.485024e-04 3 1  ON 120
ci_0072                -4.158363e-04 3 1  ON 121
ci_0073                 4.246106e-03 3 1  ON 122
ci_0074                 4.073616e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.9187
    reference variance = 0.173525
====================================================
  Execution time = 2.1034e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3705e-01
  Total weights = 1.9513e+06
  Execution time = 1.8887e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324240584211
                                         uncertainty =       0.003976064581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324240584211
                                         uncertainty =       0.003976064581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402914629
  error estimate for blocks of size 2^( 2) =       0.000415660123
  error estimate for blocks of size 2^( 3) =       0.000428605460
  error estimate for blocks of size 2^( 4) =       0.000440528787
  error estimate for blocks of size 2^( 5) =       0.000451297625
  error estimate for blocks of size 2^( 6) =       0.000458607055
  error estimate for blocks of size 2^( 7) =       0.000462899050

      target function =                  N/A
              le_mean =     -16.906584128860
             les_mean =     286.169619342070
             stat err =       0.000453333129
             autocorr =       1.265927527063
              std dev =       0.569807333312
             le_variance =       0.324680397096

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324235925269
                                         uncertainty =       0.003976630895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324235925269
                                         uncertainty =       0.003976630895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402911759
  error estimate for blocks of size 2^( 2) =       0.000415657322
  error estimate for blocks of size 2^( 3) =       0.000428602843
  error estimate for blocks of size 2^( 4) =       0.000440526301
  error estimate for blocks of size 2^( 5) =       0.000451295257
  error estimate for blocks of size 2^( 6) =       0.000458604765
  error estimate for blocks of size 2^( 7) =       0.000462895907

      target function =                  N/A
              le_mean =     -16.906583978691
             les_mean =     286.169802401800
             stat err =       0.000453330557
             autocorr =       1.265931202777
              std dev =       0.569803273342
             le_variance =       0.324675770311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324238215317
                                         uncertainty =       0.003976348723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324238215317
                                         uncertainty =       0.003976348723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402913170
  error estimate for blocks of size 2^( 2) =       0.000415658698
  error estimate for blocks of size 2^( 3) =       0.000428604129
  error estimate for blocks of size 2^( 4) =       0.000440527520
  error estimate for blocks of size 2^( 5) =       0.000451296407
  error estimate for blocks of size 2^( 6) =       0.000458605871
  error estimate for blocks of size 2^( 7) =       0.000462897434

      target function =                  N/A
              le_mean =     -16.906584053794
             les_mean =     286.169653999288
             stat err =       0.000453331808
             autocorr =       1.265929319878
              std dev =       0.569805268793
             le_variance =       0.324678044344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324240285600
                                         uncertainty =       0.003976100075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324240285600
                                         uncertainty =       0.003976100075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402914445
  error estimate for blocks of size 2^( 2) =       0.000415659944
  error estimate for blocks of size 2^( 3) =       0.000428605292
  error estimate for blocks of size 2^( 4) =       0.000440528627
  error estimate for blocks of size 2^( 5) =       0.000451297470
  error estimate for blocks of size 2^( 6) =       0.000458606905
  error estimate for blocks of size 2^( 7) =       0.000462898845

      target function =                  N/A
              le_mean =     -16.906584119365
             les_mean =     286.169621636827
             stat err =       0.000453332962
             autocorr =       1.265927749102
              std dev =       0.569807073057
             le_variance =       0.324680100506


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906584128860        initial  <--
     2.2737e+01     2.2737e+02             2.6534e-05       -16.906583978691
     9.0949e+01     9.0949e+02             6.6820e-06       -16.906584053794
     3.6380e+02     3.6380e+03             1.6735e-06       -16.906584119365

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5766
  </log>
  <optVariables href="H2O.s048.opt.xml">
   uu_0                 3.117498e-01 1 1  ON 0
   uu_1                 1.447379e-01 1 1  ON 1
   uu_2                 4.305892e-02 1 1  ON 2
   uu_3                -1.916521e-02 1 1  ON 3
   uu_4                -6.454611e-02 1 1  ON 4
   uu_5                -9.933139e-02 1 1  ON 5
   uu_6                -1.264830e-01 1 1  ON 6
   uu_7                -1.389788e-01 1 1  ON 7
   uu_8                -1.311502e-01 1 1  ON 8
   uu_9                -1.002744e-01 1 1  ON 9
   ud_0                 4.453605e-01 1 1  ON 10
   ud_1                 1.799290e-01 1 1  ON 11
   ud_2                 5.987627e-02 1 1  ON 12
   ud_3                -1.076879e-02 1 1  ON 13
   ud_4                -6.720145e-02 1 1  ON 14
   ud_5                -1.077660e-01 1 1  ON 15
   ud_6                -1.341354e-01 1 1  ON 16
   ud_7                -1.497570e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385804e-01 1 1  ON 19
   eO_0                -7.471038e-01 1 1  ON 20
   eO_1                -4.276998e-01 1 1  ON 21
   eO_2                -1.909281e-02 1 1  ON 22
   eO_3                 2.902564e-01 1 1  ON 23
   eO_4                 5.129970e-01 1 1  ON 24
   eO_5                 4.729030e-01 1 1  ON 25
   eO_6                 2.454324e-01 1 1  ON 26
   eO_7                -4.920547e-02 1 1  ON 27
   eO_8                -2.099782e-01 1 1  ON 28
   eO_9                -6.984981e-02 1 1  ON 29
  eH1_0                -2.490229e-01 1 1  ON 30
  eH1_1                -1.409999e-01 1 1  ON 31
  eH1_2                -9.187417e-02 1 1  ON 32
  eH1_3                -3.738728e-02 1 1  ON 33
  eH1_4                 1.162320e-02 1 1  ON 34
  eH1_5                 4.535012e-02 1 1  ON 35
  eH1_6                 1.014833e-01 1 1  ON 36
  eH1_7                 1.507934e-01 1 1  ON 37
  eH1_8                 1.645744e-01 1 1  ON 38
  eH1_9                 4.967781e-02 1 1  ON 39
  eH2_0                -2.461141e-01 1 1  ON 40
  eH2_1                -1.390225e-01 1 1  ON 41
  eH2_2                -8.956017e-02 1 1  ON 42
  eH2_3                -3.460176e-02 1 1  ON 43
  eH2_4                 1.430698e-02 1 1  ON 44
  eH2_5                 4.960935e-02 1 1  ON 45
  eH2_6                 1.052389e-01 1 1  ON 46
  eH2_7                 1.534299e-01 1 1  ON 47
  eH2_8                 1.693336e-01 1 1  ON 48
  eH2_9                 3.486190e-02 1 1  ON 49
ci_0001                 7.014433e-01 3 1  ON 50
ci_0002                 7.000942e-01 3 1  ON 51
ci_0003                -2.781614e-02 3 1  ON 52
ci_0004                -2.749156e-02 3 1  ON 53
ci_0005                -3.666422e-02 3 1  ON 54
ci_0006                -3.710138e-02 3 1  ON 55
ci_0007                -2.252188e-02 3 1  ON 56
ci_0008                -2.153982e-02 3 1  ON 57
ci_0009                -1.785477e-02 3 1  ON 58
ci_0010                -1.750820e-02 3 1  ON 59
ci_0011                -1.219925e-02 3 1  ON 60
ci_0012                -1.234209e-02 3 1  ON 61
ci_0013                 1.300423e-02 3 1  ON 62
ci_0014                 1.317613e-02 3 1  ON 63
ci_0015                 1.362808e-02 3 1  ON 64
ci_0016                 1.350270e-02 3 1  ON 65
ci_0017                 1.098638e-02 3 1  ON 66
ci_0018                 1.191613e-02 3 1  ON 67
ci_0019                 1.136320e-02 3 1  ON 68
ci_0020                 1.154538e-02 3 1  ON 69
ci_0021                -2.104331e-03 3 1  ON 70
ci_0022                -4.889821e-04 3 1  ON 71
ci_0023                -1.110296e-02 3 1  ON 72
ci_0024                -1.090481e-02 3 1  ON 73
ci_0025                -1.174624e-02 3 1  ON 74
ci_0026                -1.107583e-02 3 1  ON 75
ci_0027                -1.166447e-02 3 1  ON 76
ci_0028                -1.083139e-02 3 1  ON 77
ci_0029                -9.946229e-03 3 1  ON 78
ci_0030                -1.127081e-02 3 1  ON 79
ci_0031                 2.036895e-02 3 1  ON 80
ci_0032                 2.129832e-02 3 1  ON 81
ci_0033                 1.035269e-02 3 1  ON 82
ci_0034                 9.807270e-03 3 1  ON 83
ci_0035                 6.439941e-03 3 1  ON 84
ci_0036                 6.892036e-03 3 1  ON 85
ci_0037                -1.058496e-02 3 1  ON 86
ci_0038                -1.119236e-02 3 1  ON 87
ci_0039                -2.531326e-03 3 1  ON 88
ci_0040                -2.765789e-03 3 1  ON 89
ci_0041                 6.635578e-03 3 1  ON 90
ci_0042                 7.330588e-03 3 1  ON 91
ci_0043                -1.946089e-02 3 1  ON 92
ci_0044                -1.898891e-02 3 1  ON 93
ci_0045                 7.486325e-03 3 1  ON 94
ci_0046                 7.409134e-03 3 1  ON 95
ci_0047                -1.552310e-03 3 1  ON 96
ci_0048                -1.862009e-03 3 1  ON 97
ci_0049                -5.340785e-03 3 1  ON 98
ci_0050                -5.919321e-03 3 1  ON 99
ci_0051                -3.617404e-03 3 1  ON 100
ci_0052                -3.395744e-03 3 1  ON 101
ci_0053                -4.479196e-03 3 1  ON 102
ci_0054                -4.332467e-03 3 1  ON 103
ci_0055                 6.387473e-03 3 1  ON 104
ci_0056                 6.304852e-03 3 1  ON 105
ci_0057                 4.731785e-03 3 1  ON 106
ci_0058                 4.836511e-03 3 1  ON 107
ci_0059                -4.598711e-03 3 1  ON 108
ci_0060                -4.622110e-03 3 1  ON 109
ci_0061                -4.534343e-03 3 1  ON 110
ci_0062                -3.762446e-03 3 1  ON 111
ci_0063                -9.154838e-03 3 1  ON 112
ci_0064                -8.245811e-03 3 1  ON 113
ci_0065                -5.044549e-03 3 1  ON 114
ci_0066                -5.119679e-03 3 1  ON 115
ci_0067                -5.300894e-03 3 1  ON 116
ci_0068                -4.972798e-03 3 1  ON 117
ci_0069                 4.619434e-03 3 1  ON 118
ci_0070                 4.549795e-03 3 1  ON 119
ci_0071                 5.484514e-04 3 1  ON 120
ci_0072                -4.156932e-04 3 1  ON 121
ci_0073                 4.247449e-03 3 1  ON 122
ci_0074                 4.073984e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8266e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.9042
    reference variance = 0.293189
====================================================
  Execution time = 2.1351e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5222e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3503e-01
  Total weights = 1.951693979e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0518e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322987257331
                                         uncertainty =       0.002207148547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322987257331
                                         uncertainty =       0.002207148547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401915907
  error estimate for blocks of size 2^( 2) =       0.000414660822
  error estimate for blocks of size 2^( 3) =       0.000427306360
  error estimate for blocks of size 2^( 4) =       0.000439572043
  error estimate for blocks of size 2^( 5) =       0.000449935030
  error estimate for blocks of size 2^( 6) =       0.000457766568
  error estimate for blocks of size 2^( 7) =       0.000464698690

      target function =                  N/A
              le_mean =     -16.906334382439
             les_mean =     286.159171592993
             stat err =       0.000452993083
             autocorr =       1.270318875904
              std dev =       0.568394926196
             le_variance =       0.323072792126


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690633438244e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906334382440       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906334401318       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906334400762       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906334401639       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906334402122       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906334402876       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906334404686       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906334406109       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906334405692       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906334405321       residual = 3.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.2737e+02 is 1.534535e-06

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906334382440       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906334387163       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906334387024       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906334387243       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906334387363       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906334387551       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906334388004       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906334388359       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906334388260       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906334388164       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.0949e+02 is 3.838726e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906334382440       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906334383621       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906334383586       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906334383641       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906334383671       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906334383716       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906334383829       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906334383920       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906334383895       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906334383877       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.6380e+03 is 9.598309e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.510831 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7411e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
   uu_0                 3.117499e-01 1 1  ON 0
   uu_1                 1.447378e-01 1 1  ON 1
   uu_2                 4.305883e-02 1 1  ON 2
   uu_3                -1.916520e-02 1 1  ON 3
   uu_4                -6.454604e-02 1 1  ON 4
   uu_5                -9.933142e-02 1 1  ON 5
   uu_6                -1.264829e-01 1 1  ON 6
   uu_7                -1.389788e-01 1 1  ON 7
   uu_8                -1.311504e-01 1 1  ON 8
   uu_9                -1.002746e-01 1 1  ON 9
   ud_0                 4.453605e-01 1 1  ON 10
   ud_1                 1.799290e-01 1 1  ON 11
   ud_2                 5.987633e-02 1 1  ON 12
   ud_3                -1.076859e-02 1 1  ON 13
   ud_4                -6.720147e-02 1 1  ON 14
   ud_5                -1.077662e-01 1 1  ON 15
   ud_6                -1.341355e-01 1 1  ON 16
   ud_7                -1.497571e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385805e-01 1 1  ON 19
   eO_0                -7.471038e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909288e-02 1 1  ON 22
   eO_3                 2.902563e-01 1 1  ON 23
   eO_4                 5.129971e-01 1 1  ON 24
   eO_5                 4.729032e-01 1 1  ON 25
   eO_6                 2.454326e-01 1 1  ON 26
   eO_7                -4.920533e-02 1 1  ON 27
   eO_8                -2.099783e-01 1 1  ON 28
   eO_9                -6.984998e-02 1 1  ON 29
  eH1_0                -2.490228e-01 1 1  ON 30
  eH1_1                -1.410001e-01 1 1  ON 31
  eH1_2                -9.187435e-02 1 1  ON 32
  eH1_3                -3.738736e-02 1 1  ON 33
  eH1_4                 1.162312e-02 1 1  ON 34
  eH1_5                 4.534995e-02 1 1  ON 35
  eH1_6                 1.014833e-01 1 1  ON 36
  eH1_7                 1.507935e-01 1 1  ON 37
  eH1_8                 1.645747e-01 1 1  ON 38
  eH1_9                 4.967810e-02 1 1  ON 39
  eH2_0                -2.461144e-01 1 1  ON 40
  eH2_1                -1.390225e-01 1 1  ON 41
  eH2_2                -8.956023e-02 1 1  ON 42
  eH2_3                -3.460177e-02 1 1  ON 43
  eH2_4                 1.430693e-02 1 1  ON 44
  eH2_5                 4.960927e-02 1 1  ON 45
  eH2_6                 1.052389e-01 1 1  ON 46
  eH2_7                 1.534299e-01 1 1  ON 47
  eH2_8                 1.693337e-01 1 1  ON 48
  eH2_9                 3.486213e-02 1 1  ON 49
ci_0001                 7.014433e-01 3 1  ON 50
ci_0002                 7.000943e-01 3 1  ON 51
ci_0003                -2.781631e-02 3 1  ON 52
ci_0004                -2.749154e-02 3 1  ON 53
ci_0005                -3.666418e-02 3 1  ON 54
ci_0006                -3.710127e-02 3 1  ON 55
ci_0007                -2.252190e-02 3 1  ON 56
ci_0008                -2.153988e-02 3 1  ON 57
ci_0009                -1.785470e-02 3 1  ON 58
ci_0010                -1.750849e-02 3 1  ON 59
ci_0011                -1.219934e-02 3 1  ON 60
ci_0012                -1.234218e-02 3 1  ON 61
ci_0013                 1.300431e-02 3 1  ON 62
ci_0014                 1.317620e-02 3 1  ON 63
ci_0015                 1.362798e-02 3 1  ON 64
ci_0016                 1.350285e-02 3 1  ON 65
ci_0017                 1.098648e-02 3 1  ON 66
ci_0018                 1.191604e-02 3 1  ON 67
ci_0019                 1.136323e-02 3 1  ON 68
ci_0020                 1.154533e-02 3 1  ON 69
ci_0021                -2.104183e-03 3 1  ON 70
ci_0022                -4.891250e-04 3 1  ON 71
ci_0023                -1.110306e-02 3 1  ON 72
ci_0024                -1.090516e-02 3 1  ON 73
ci_0025                -1.174614e-02 3 1  ON 74
ci_0026                -1.107569e-02 3 1  ON 75
ci_0027                -1.166430e-02 3 1  ON 76
ci_0028                -1.083156e-02 3 1  ON 77
ci_0029                -9.946276e-03 3 1  ON 78
ci_0030                -1.127081e-02 3 1  ON 79
ci_0031                 2.036867e-02 3 1  ON 80
ci_0032                 2.129817e-02 3 1  ON 81
ci_0033                 1.035262e-02 3 1  ON 82
ci_0034                 9.807453e-03 3 1  ON 83
ci_0035                 6.440325e-03 3 1  ON 84
ci_0036                 6.891956e-03 3 1  ON 85
ci_0037                -1.058481e-02 3 1  ON 86
ci_0038                -1.119226e-02 3 1  ON 87
ci_0039                -2.531336e-03 3 1  ON 88
ci_0040                -2.765600e-03 3 1  ON 89
ci_0041                 6.635641e-03 3 1  ON 90
ci_0042                 7.330711e-03 3 1  ON 91
ci_0043                -1.946054e-02 3 1  ON 92
ci_0044                -1.898879e-02 3 1  ON 93
ci_0045                 7.486361e-03 3 1  ON 94
ci_0046                 7.409168e-03 3 1  ON 95
ci_0047                -1.552331e-03 3 1  ON 96
ci_0048                -1.862087e-03 3 1  ON 97
ci_0049                -5.340642e-03 3 1  ON 98
ci_0050                -5.919117e-03 3 1  ON 99
ci_0051                -3.617327e-03 3 1  ON 100
ci_0052                -3.395691e-03 3 1  ON 101
ci_0053                -4.479222e-03 3 1  ON 102
ci_0054                -4.332661e-03 3 1  ON 103
ci_0055                 6.387473e-03 3 1  ON 104
ci_0056                 6.304796e-03 3 1  ON 105
ci_0057                 4.731836e-03 3 1  ON 106
ci_0058                 4.836450e-03 3 1  ON 107
ci_0059                -4.598869e-03 3 1  ON 108
ci_0060                -4.622398e-03 3 1  ON 109
ci_0061                -4.534072e-03 3 1  ON 110
ci_0062                -3.762338e-03 3 1  ON 111
ci_0063                -9.154632e-03 3 1  ON 112
ci_0064                -8.245879e-03 3 1  ON 113
ci_0065                -5.044721e-03 3 1  ON 114
ci_0066                -5.119672e-03 3 1  ON 115
ci_0067                -5.300773e-03 3 1  ON 116
ci_0068                -4.972874e-03 3 1  ON 117
ci_0069                 4.619513e-03 3 1  ON 118
ci_0070                 4.549676e-03 3 1  ON 119
ci_0071                 5.485020e-04 3 1  ON 120
ci_0072                -4.154422e-04 3 1  ON 121
ci_0073                 4.247552e-03 3 1  ON 122
ci_0074                 4.073978e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.9437
    reference variance = 0.232389
====================================================
  Execution time = 2.1232e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3368e-01
  Total weights = 1.9519e+06
  Execution time = 1.9016e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322098992266
                                         uncertainty =       0.001930921705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322098992266
                                         uncertainty =       0.001930921705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401296792
  error estimate for blocks of size 2^( 2) =       0.000414438119
  error estimate for blocks of size 2^( 3) =       0.000427880846
  error estimate for blocks of size 2^( 4) =       0.000440246024
  error estimate for blocks of size 2^( 5) =       0.000450105060
  error estimate for blocks of size 2^( 6) =       0.000458666837
  error estimate for blocks of size 2^( 7) =       0.000466948639

      target function =                  N/A
              le_mean =     -16.905416109146
             les_mean =     286.126772900474
             stat err =       0.000453991640
             autocorr =       1.279865508227
              std dev =       0.567519365669
             le_variance =       0.322078230410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322098639129
                                         uncertainty =       0.001930951207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322098639129
                                         uncertainty =       0.001930951207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401296572
  error estimate for blocks of size 2^( 2) =       0.000414437863
  error estimate for blocks of size 2^( 3) =       0.000427880562
  error estimate for blocks of size 2^( 4) =       0.000440245762
  error estimate for blocks of size 2^( 5) =       0.000450104825
  error estimate for blocks of size 2^( 6) =       0.000458666646
  error estimate for blocks of size 2^( 7) =       0.000466948428

      target function =                  N/A
              le_mean =     -16.905416115315
             les_mean =     286.126772906941
             stat err =       0.000453991415
             autocorr =       1.279865640874
              std dev =       0.567519055100
             le_variance =       0.322077877902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322098815592
                                         uncertainty =       0.001930936466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322098815592
                                         uncertainty =       0.001930936466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401296682
  error estimate for blocks of size 2^( 2) =       0.000414437991
  error estimate for blocks of size 2^( 3) =       0.000427880704
  error estimate for blocks of size 2^( 4) =       0.000440245892
  error estimate for blocks of size 2^( 5) =       0.000450104942
  error estimate for blocks of size 2^( 6) =       0.000458666741
  error estimate for blocks of size 2^( 7) =       0.000466948533

      target function =                  N/A
              le_mean =     -16.905416112218
             les_mean =     286.126772901187
             stat err =       0.000453991527
             autocorr =       1.279865574483
              std dev =       0.567519210292
             le_variance =       0.322078054050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322098970170
                                         uncertainty =       0.001930923550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322098970170
                                         uncertainty =       0.001930923550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401296778
  error estimate for blocks of size 2^( 2) =       0.000414438103
  error estimate for blocks of size 2^( 3) =       0.000427880828
  error estimate for blocks of size 2^( 4) =       0.000440246007
  error estimate for blocks of size 2^( 5) =       0.000450105045
  error estimate for blocks of size 2^( 6) =       0.000458666825
  error estimate for blocks of size 2^( 7) =       0.000466948626

      target function =                  N/A
              le_mean =     -16.905416109528
             les_mean =     286.126772900294
             stat err =       0.000453991626
             autocorr =       1.279865516505
              std dev =       0.567519346237
             le_variance =       0.322078208354


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905416109146        initial
     2.2737e+02     2.2737e+03             1.5345e-06       -16.905416115315  <--
     9.0949e+02     9.0949e+03             3.8387e-07       -16.905416112218
     3.6380e+03     3.6380e+04             9.5983e-08       -16.905416109528

*****************************************************************************
Applying the update for shift_i =   2.2737e+02     and shift_s =   2.2737e+03
*****************************************************************************

  Execution time = 3.0831e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
   uu_0                 3.117503e-01 1 1  ON 0
   uu_1                 1.447374e-01 1 1  ON 1
   uu_2                 4.305857e-02 1 1  ON 2
   uu_3                -1.916518e-02 1 1  ON 3
   uu_4                -6.454582e-02 1 1  ON 4
   uu_5                -9.933153e-02 1 1  ON 5
   uu_6                -1.264826e-01 1 1  ON 6
   uu_7                -1.389786e-01 1 1  ON 7
   uu_8                -1.311511e-01 1 1  ON 8
   uu_9                -1.002750e-01 1 1  ON 9
   ud_0                 4.453607e-01 1 1  ON 10
   ud_1                 1.799292e-01 1 1  ON 11
   ud_2                 5.987650e-02 1 1  ON 12
   ud_3                -1.076800e-02 1 1  ON 13
   ud_4                -6.720153e-02 1 1  ON 14
   ud_5                -1.077665e-01 1 1  ON 15
   ud_6                -1.341358e-01 1 1  ON 16
   ud_7                -1.497574e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385807e-01 1 1  ON 19
   eO_0                -7.471038e-01 1 1  ON 20
   eO_1                -4.277002e-01 1 1  ON 21
   eO_2                -1.909309e-02 1 1  ON 22
   eO_3                 2.902563e-01 1 1  ON 23
   eO_4                 5.129973e-01 1 1  ON 24
   eO_5                 4.729035e-01 1 1  ON 25
   eO_6                 2.454331e-01 1 1  ON 26
   eO_7                -4.920492e-02 1 1  ON 27
   eO_8                -2.099788e-01 1 1  ON 28
   eO_9                -6.985049e-02 1 1  ON 29
  eH1_0                -2.490227e-01 1 1  ON 30
  eH1_1                -1.410008e-01 1 1  ON 31
  eH1_2                -9.187491e-02 1 1  ON 32
  eH1_3                -3.738761e-02 1 1  ON 33
  eH1_4                 1.162290e-02 1 1  ON 34
  eH1_5                 4.534946e-02 1 1  ON 35
  eH1_6                 1.014831e-01 1 1  ON 36
  eH1_7                 1.507938e-01 1 1  ON 37
  eH1_8                 1.645755e-01 1 1  ON 38
  eH1_9                 4.967899e-02 1 1  ON 39
  eH2_0                -2.461150e-01 1 1  ON 40
  eH2_1                -1.390224e-01 1 1  ON 41
  eH2_2                -8.956043e-02 1 1  ON 42
  eH2_3                -3.460181e-02 1 1  ON 43
  eH2_4                 1.430678e-02 1 1  ON 44
  eH2_5                 4.960905e-02 1 1  ON 45
  eH2_6                 1.052389e-01 1 1  ON 46
  eH2_7                 1.534300e-01 1 1  ON 47
  eH2_8                 1.693343e-01 1 1  ON 48
  eH2_9                 3.486279e-02 1 1  ON 49
ci_0001                 7.014432e-01 3 1  ON 50
ci_0002                 7.000943e-01 3 1  ON 51
ci_0003                -2.781681e-02 3 1  ON 52
ci_0004                -2.749149e-02 3 1  ON 53
ci_0005                -3.666406e-02 3 1  ON 54
ci_0006                -3.710093e-02 3 1  ON 55
ci_0007                -2.252194e-02 3 1  ON 56
ci_0008                -2.154003e-02 3 1  ON 57
ci_0009                -1.785446e-02 3 1  ON 58
ci_0010                -1.750939e-02 3 1  ON 59
ci_0011                -1.219961e-02 3 1  ON 60
ci_0012                -1.234242e-02 3 1  ON 61
ci_0013                 1.300455e-02 3 1  ON 62
ci_0014                 1.317641e-02 3 1  ON 63
ci_0015                 1.362769e-02 3 1  ON 64
ci_0016                 1.350329e-02 3 1  ON 65
ci_0017                 1.098677e-02 3 1  ON 66
ci_0018                 1.191574e-02 3 1  ON 67
ci_0019                 1.136332e-02 3 1  ON 68
ci_0020                 1.154518e-02 3 1  ON 69
ci_0021                -2.103739e-03 3 1  ON 70
ci_0022                -4.895538e-04 3 1  ON 71
ci_0023                -1.110337e-02 3 1  ON 72
ci_0024                -1.090621e-02 3 1  ON 73
ci_0025                -1.174586e-02 3 1  ON 74
ci_0026                -1.107525e-02 3 1  ON 75
ci_0027                -1.166381e-02 3 1  ON 76
ci_0028                -1.083206e-02 3 1  ON 77
ci_0029                -9.946419e-03 3 1  ON 78
ci_0030                -1.127081e-02 3 1  ON 79
ci_0031                 2.036783e-02 3 1  ON 80
ci_0032                 2.129773e-02 3 1  ON 81
ci_0033                 1.035240e-02 3 1  ON 82
ci_0034                 9.808001e-03 3 1  ON 83
ci_0035                 6.441476e-03 3 1  ON 84
ci_0036                 6.891717e-03 3 1  ON 85
ci_0037                -1.058438e-02 3 1  ON 86
ci_0038                -1.119195e-02 3 1  ON 87
ci_0039                -2.531366e-03 3 1  ON 88
ci_0040                -2.765033e-03 3 1  ON 89
ci_0041                 6.635829e-03 3 1  ON 90
ci_0042                 7.331079e-03 3 1  ON 91
ci_0043                -1.945949e-02 3 1  ON 92
ci_0044                -1.898843e-02 3 1  ON 93
ci_0045                 7.486472e-03 3 1  ON 94
ci_0046                 7.409272e-03 3 1  ON 95
ci_0047                -1.552395e-03 3 1  ON 96
ci_0048                -1.862324e-03 3 1  ON 97
ci_0049                -5.340214e-03 3 1  ON 98
ci_0050                -5.918504e-03 3 1  ON 99
ci_0051                -3.617097e-03 3 1  ON 100
ci_0052                -3.395533e-03 3 1  ON 101
ci_0053                -4.479303e-03 3 1  ON 102
ci_0054                -4.333243e-03 3 1  ON 103
ci_0055                 6.387474e-03 3 1  ON 104
ci_0056                 6.304629e-03 3 1  ON 105
ci_0057                 4.731989e-03 3 1  ON 106
ci_0058                 4.836265e-03 3 1  ON 107
ci_0059                -4.599341e-03 3 1  ON 108
ci_0060                -4.623263e-03 3 1  ON 109
ci_0061                -4.533259e-03 3 1  ON 110
ci_0062                -3.762015e-03 3 1  ON 111
ci_0063                -9.154015e-03 3 1  ON 112
ci_0064                -8.246084e-03 3 1  ON 113
ci_0065                -5.045236e-03 3 1  ON 114
ci_0066                -5.119653e-03 3 1  ON 115
ci_0067                -5.300412e-03 3 1  ON 116
ci_0068                -4.973103e-03 3 1  ON 117
ci_0069                 4.619752e-03 3 1  ON 118
ci_0070                 4.549320e-03 3 1  ON 119
ci_0071                 5.486537e-04 3 1  ON 120
ci_0072                -4.146899e-04 3 1  ON 121
ci_0073                 4.247859e-03 3 1  ON 122
ci_0074                 4.073959e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8249e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.9379
    reference variance = 0.42765
====================================================
  Execution time = 2.1407e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3566e-01
  Total weights = 1.951526510e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320953433924
                                         uncertainty =       0.002164836765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320953433924
                                         uncertainty =       0.002164836765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401070471
  error estimate for blocks of size 2^( 2) =       0.000414043417
  error estimate for blocks of size 2^( 3) =       0.000427210525
  error estimate for blocks of size 2^( 4) =       0.000439975249
  error estimate for blocks of size 2^( 5) =       0.000451566404
  error estimate for blocks of size 2^( 6) =       0.000461354205
  error estimate for blocks of size 2^( 7) =       0.000467420290

      target function =                  N/A
              le_mean =     -16.905922645290
             les_mean =     286.145876167933
             stat err =       0.000455079037
             autocorr =       1.287455671855
              std dev =       0.567199299538
             le_variance =       0.321715045396


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690592264529e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905922645268       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905922744015       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905922734269       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905922749844       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905922743366       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905922739724       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905922733732       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905922728887       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905922731394       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905922733737       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.6843e+01 is 7.932762e-06

solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905922645268       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905922670025       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905922667582       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905922671491       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905922669874       residual = 9.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905922668975       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905922667481       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905922666253       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905922666873       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905922667461       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.2737e+02 is 1.988942e-06

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905922645268       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905922651461       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905922650850       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905922651828       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905922651425       residual = 9.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905922651201       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905922650826       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905922650519       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905922650672       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905922650822       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.0949e+02 is 4.975961e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.514735 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7478e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
   uu_0                 3.117512e-01 1 1  ON 0
   uu_1                 1.447379e-01 1 1  ON 1
   uu_2                 4.305874e-02 1 1  ON 2
   uu_3                -1.916589e-02 1 1  ON 3
   uu_4                -6.454620e-02 1 1  ON 4
   uu_5                -9.933129e-02 1 1  ON 5
   uu_6                -1.264825e-01 1 1  ON 6
   uu_7                -1.389789e-01 1 1  ON 7
   uu_8                -1.311516e-01 1 1  ON 8
   uu_9                -1.002757e-01 1 1  ON 9
   ud_0                 4.453613e-01 1 1  ON 10
   ud_1                 1.799293e-01 1 1  ON 11
   ud_2                 5.987651e-02 1 1  ON 12
   ud_3                -1.076742e-02 1 1  ON 13
   ud_4                -6.720137e-02 1 1  ON 14
   ud_5                -1.077660e-01 1 1  ON 15
   ud_6                -1.341357e-01 1 1  ON 16
   ud_7                -1.497584e-01 1 1  ON 17
   ud_8                -1.506351e-01 1 1  ON 18
   ud_9                -1.385810e-01 1 1  ON 19
   eO_0                -7.471040e-01 1 1  ON 20
   eO_1                -4.277005e-01 1 1  ON 21
   eO_2                -1.909302e-02 1 1  ON 22
   eO_3                 2.902566e-01 1 1  ON 23
   eO_4                 5.129976e-01 1 1  ON 24
   eO_5                 4.729040e-01 1 1  ON 25
   eO_6                 2.454337e-01 1 1  ON 26
   eO_7                -4.920475e-02 1 1  ON 27
   eO_8                -2.099794e-01 1 1  ON 28
   eO_9                -6.985113e-02 1 1  ON 29
  eH1_0                -2.490228e-01 1 1  ON 30
  eH1_1                -1.410014e-01 1 1  ON 31
  eH1_2                -9.187548e-02 1 1  ON 32
  eH1_3                -3.738753e-02 1 1  ON 33
  eH1_4                 1.162282e-02 1 1  ON 34
  eH1_5                 4.534908e-02 1 1  ON 35
  eH1_6                 1.014828e-01 1 1  ON 36
  eH1_7                 1.507942e-01 1 1  ON 37
  eH1_8                 1.645765e-01 1 1  ON 38
  eH1_9                 4.967975e-02 1 1  ON 39
  eH2_0                -2.461154e-01 1 1  ON 40
  eH2_1                -1.390230e-01 1 1  ON 41
  eH2_2                -8.956076e-02 1 1  ON 42
  eH2_3                -3.460159e-02 1 1  ON 43
  eH2_4                 1.430709e-02 1 1  ON 44
  eH2_5                 4.960835e-02 1 1  ON 45
  eH2_6                 1.052390e-01 1 1  ON 46
  eH2_7                 1.534301e-01 1 1  ON 47
  eH2_8                 1.693348e-01 1 1  ON 48
  eH2_9                 3.486354e-02 1 1  ON 49
ci_0001                 7.014430e-01 3 1  ON 50
ci_0002                 7.000946e-01 3 1  ON 51
ci_0003                -2.781714e-02 3 1  ON 52
ci_0004                -2.749122e-02 3 1  ON 53
ci_0005                -3.666496e-02 3 1  ON 54
ci_0006                -3.710159e-02 3 1  ON 55
ci_0007                -2.252184e-02 3 1  ON 56
ci_0008                -2.154048e-02 3 1  ON 57
ci_0009                -1.785363e-02 3 1  ON 58
ci_0010                -1.750846e-02 3 1  ON 59
ci_0011                -1.219962e-02 3 1  ON 60
ci_0012                -1.234308e-02 3 1  ON 61
ci_0013                 1.300437e-02 3 1  ON 62
ci_0014                 1.317600e-02 3 1  ON 63
ci_0015                 1.362683e-02 3 1  ON 64
ci_0016                 1.350197e-02 3 1  ON 65
ci_0017                 1.098856e-02 3 1  ON 66
ci_0018                 1.191583e-02 3 1  ON 67
ci_0019                 1.136256e-02 3 1  ON 68
ci_0020                 1.154465e-02 3 1  ON 69
ci_0021                -2.103056e-03 3 1  ON 70
ci_0022                -4.896619e-04 3 1  ON 71
ci_0023                -1.110258e-02 3 1  ON 72
ci_0024                -1.090629e-02 3 1  ON 73
ci_0025                -1.174477e-02 3 1  ON 74
ci_0026                -1.107327e-02 3 1  ON 75
ci_0027                -1.166290e-02 3 1  ON 76
ci_0028                -1.083259e-02 3 1  ON 77
ci_0029                -9.947687e-03 3 1  ON 78
ci_0030                -1.126946e-02 3 1  ON 79
ci_0031                 2.036819e-02 3 1  ON 80
ci_0032                 2.129699e-02 3 1  ON 81
ci_0033                 1.035330e-02 3 1  ON 82
ci_0034                 9.807068e-03 3 1  ON 83
ci_0035                 6.441520e-03 3 1  ON 84
ci_0036                 6.892404e-03 3 1  ON 85
ci_0037                -1.058332e-02 3 1  ON 86
ci_0038                -1.119171e-02 3 1  ON 87
ci_0039                -2.530797e-03 3 1  ON 88
ci_0040                -2.764986e-03 3 1  ON 89
ci_0041                 6.636992e-03 3 1  ON 90
ci_0042                 7.331468e-03 3 1  ON 91
ci_0043                -1.945927e-02 3 1  ON 92
ci_0044                -1.898857e-02 3 1  ON 93
ci_0045                 7.485066e-03 3 1  ON 94
ci_0046                 7.408994e-03 3 1  ON 95
ci_0047                -1.552131e-03 3 1  ON 96
ci_0048                -1.861676e-03 3 1  ON 97
ci_0049                -5.340492e-03 3 1  ON 98
ci_0050                -5.918373e-03 3 1  ON 99
ci_0051                -3.617348e-03 3 1  ON 100
ci_0052                -3.395471e-03 3 1  ON 101
ci_0053                -4.479871e-03 3 1  ON 102
ci_0054                -4.333981e-03 3 1  ON 103
ci_0055                 6.388023e-03 3 1  ON 104
ci_0056                 6.303711e-03 3 1  ON 105
ci_0057                 4.732883e-03 3 1  ON 106
ci_0058                 4.835458e-03 3 1  ON 107
ci_0059                -4.600709e-03 3 1  ON 108
ci_0060                -4.624324e-03 3 1  ON 109
ci_0061                -4.532644e-03 3 1  ON 110
ci_0062                -3.762054e-03 3 1  ON 111
ci_0063                -9.153423e-03 3 1  ON 112
ci_0064                -8.246820e-03 3 1  ON 113
ci_0065                -5.045596e-03 3 1  ON 114
ci_0066                -5.119144e-03 3 1  ON 115
ci_0067                -5.298880e-03 3 1  ON 116
ci_0068                -4.973095e-03 3 1  ON 117
ci_0069                 4.619759e-03 3 1  ON 118
ci_0070                 4.549127e-03 3 1  ON 119
ci_0071                 5.488805e-04 3 1  ON 120
ci_0072                -4.145422e-04 3 1  ON 121
ci_0073                 4.248591e-03 3 1  ON 122
ci_0074                 4.074213e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.9417
    reference variance = 0.276444
====================================================
  Execution time = 2.1614e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3602e-01
  Total weights = 1.9516e+06
  Execution time = 1.8976e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322869380760
                                         uncertainty =       0.002568478536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322869380760
                                         uncertainty =       0.002568478536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401814742
  error estimate for blocks of size 2^( 2) =       0.000414571764
  error estimate for blocks of size 2^( 3) =       0.000427569685
  error estimate for blocks of size 2^( 4) =       0.000439766130
  error estimate for blocks of size 2^( 5) =       0.000450832138
  error estimate for blocks of size 2^( 6) =       0.000458774813
  error estimate for blocks of size 2^( 7) =       0.000462415020

      target function =                  N/A
              le_mean =     -16.905960922933
             les_mean =     286.147531477734
             stat err =       0.000452947025
             autocorr =       1.270700181621
              std dev =       0.568251857163
             le_variance =       0.322910173170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322868324088
                                         uncertainty =       0.002568345451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322868324088
                                         uncertainty =       0.002568345451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401814083
  error estimate for blocks of size 2^( 2) =       0.000414571054
  error estimate for blocks of size 2^( 3) =       0.000427568948
  error estimate for blocks of size 2^( 4) =       0.000439765249
  error estimate for blocks of size 2^( 5) =       0.000450831260
  error estimate for blocks of size 2^( 6) =       0.000458773995
  error estimate for blocks of size 2^( 7) =       0.000462413920

      target function =                  N/A
              le_mean =     -16.905960832283
             les_mean =     286.147537472777
             stat err =       0.000452946106
             autocorr =       1.270699188826
              std dev =       0.568250925676
             le_variance =       0.322909114531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322868850781
                                         uncertainty =       0.002568411726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322868850781
                                         uncertainty =       0.002568411726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401814411
  error estimate for blocks of size 2^( 2) =       0.000414571408
  error estimate for blocks of size 2^( 3) =       0.000427569315
  error estimate for blocks of size 2^( 4) =       0.000439765688
  error estimate for blocks of size 2^( 5) =       0.000450831697
  error estimate for blocks of size 2^( 6) =       0.000458774402
  error estimate for blocks of size 2^( 7) =       0.000462414468

      target function =                  N/A
              le_mean =     -16.905960876952
             les_mean =     286.147530880354
             stat err =       0.000452946563
             autocorr =       1.270699679240
              std dev =       0.568251389946
             le_variance =       0.322909642176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322869314229
                                         uncertainty =       0.002568470171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322869314229
                                         uncertainty =       0.002568470171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401814700
  error estimate for blocks of size 2^( 2) =       0.000414571719
  error estimate for blocks of size 2^( 3) =       0.000427569638
  error estimate for blocks of size 2^( 4) =       0.000439766075
  error estimate for blocks of size 2^( 5) =       0.000450832083
  error estimate for blocks of size 2^( 6) =       0.000458774761
  error estimate for blocks of size 2^( 7) =       0.000462414951

      target function =                  N/A
              le_mean =     -16.905960917129
             les_mean =     286.147530988817
             stat err =       0.000452946967
             autocorr =       1.270700118636
              std dev =       0.568251798510
             le_variance =       0.322910106510


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905960922933        initial  <--
     5.6843e+01     5.6843e+02             7.9328e-06       -16.905960832283
     2.2737e+02     2.2737e+03             1.9889e-06       -16.905960876952
     9.0949e+02     9.0949e+03             4.9760e-07       -16.905960917129

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.2016
  </log>
  <optVariables href="H2O.s050.opt.xml">
   uu_0                 3.117503e-01 1 1  ON 0
   uu_1                 1.447374e-01 1 1  ON 1
   uu_2                 4.305857e-02 1 1  ON 2
   uu_3                -1.916518e-02 1 1  ON 3
   uu_4                -6.454582e-02 1 1  ON 4
   uu_5                -9.933153e-02 1 1  ON 5
   uu_6                -1.264826e-01 1 1  ON 6
   uu_7                -1.389786e-01 1 1  ON 7
   uu_8                -1.311511e-01 1 1  ON 8
   uu_9                -1.002750e-01 1 1  ON 9
   ud_0                 4.453607e-01 1 1  ON 10
   ud_1                 1.799292e-01 1 1  ON 11
   ud_2                 5.987650e-02 1 1  ON 12
   ud_3                -1.076800e-02 1 1  ON 13
   ud_4                -6.720153e-02 1 1  ON 14
   ud_5                -1.077665e-01 1 1  ON 15
   ud_6                -1.341358e-01 1 1  ON 16
   ud_7                -1.497574e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385807e-01 1 1  ON 19
   eO_0                -7.471038e-01 1 1  ON 20
   eO_1                -4.277002e-01 1 1  ON 21
   eO_2                -1.909309e-02 1 1  ON 22
   eO_3                 2.902563e-01 1 1  ON 23
   eO_4                 5.129973e-01 1 1  ON 24
   eO_5                 4.729035e-01 1 1  ON 25
   eO_6                 2.454331e-01 1 1  ON 26
   eO_7                -4.920492e-02 1 1  ON 27
   eO_8                -2.099788e-01 1 1  ON 28
   eO_9                -6.985049e-02 1 1  ON 29
  eH1_0                -2.490227e-01 1 1  ON 30
  eH1_1                -1.410008e-01 1 1  ON 31
  eH1_2                -9.187491e-02 1 1  ON 32
  eH1_3                -3.738761e-02 1 1  ON 33
  eH1_4                 1.162290e-02 1 1  ON 34
  eH1_5                 4.534946e-02 1 1  ON 35
  eH1_6                 1.014831e-01 1 1  ON 36
  eH1_7                 1.507938e-01 1 1  ON 37
  eH1_8                 1.645755e-01 1 1  ON 38
  eH1_9                 4.967899e-02 1 1  ON 39
  eH2_0                -2.461150e-01 1 1  ON 40
  eH2_1                -1.390224e-01 1 1  ON 41
  eH2_2                -8.956043e-02 1 1  ON 42
  eH2_3                -3.460181e-02 1 1  ON 43
  eH2_4                 1.430678e-02 1 1  ON 44
  eH2_5                 4.960905e-02 1 1  ON 45
  eH2_6                 1.052389e-01 1 1  ON 46
  eH2_7                 1.534300e-01 1 1  ON 47
  eH2_8                 1.693343e-01 1 1  ON 48
  eH2_9                 3.486279e-02 1 1  ON 49
ci_0001                 7.014432e-01 3 1  ON 50
ci_0002                 7.000943e-01 3 1  ON 51
ci_0003                -2.781681e-02 3 1  ON 52
ci_0004                -2.749149e-02 3 1  ON 53
ci_0005                -3.666406e-02 3 1  ON 54
ci_0006                -3.710093e-02 3 1  ON 55
ci_0007                -2.252194e-02 3 1  ON 56
ci_0008                -2.154003e-02 3 1  ON 57
ci_0009                -1.785446e-02 3 1  ON 58
ci_0010                -1.750939e-02 3 1  ON 59
ci_0011                -1.219961e-02 3 1  ON 60
ci_0012                -1.234242e-02 3 1  ON 61
ci_0013                 1.300455e-02 3 1  ON 62
ci_0014                 1.317641e-02 3 1  ON 63
ci_0015                 1.362769e-02 3 1  ON 64
ci_0016                 1.350329e-02 3 1  ON 65
ci_0017                 1.098677e-02 3 1  ON 66
ci_0018                 1.191574e-02 3 1  ON 67
ci_0019                 1.136332e-02 3 1  ON 68
ci_0020                 1.154518e-02 3 1  ON 69
ci_0021                -2.103739e-03 3 1  ON 70
ci_0022                -4.895538e-04 3 1  ON 71
ci_0023                -1.110337e-02 3 1  ON 72
ci_0024                -1.090621e-02 3 1  ON 73
ci_0025                -1.174586e-02 3 1  ON 74
ci_0026                -1.107525e-02 3 1  ON 75
ci_0027                -1.166381e-02 3 1  ON 76
ci_0028                -1.083206e-02 3 1  ON 77
ci_0029                -9.946419e-03 3 1  ON 78
ci_0030                -1.127081e-02 3 1  ON 79
ci_0031                 2.036783e-02 3 1  ON 80
ci_0032                 2.129773e-02 3 1  ON 81
ci_0033                 1.035240e-02 3 1  ON 82
ci_0034                 9.808001e-03 3 1  ON 83
ci_0035                 6.441476e-03 3 1  ON 84
ci_0036                 6.891717e-03 3 1  ON 85
ci_0037                -1.058438e-02 3 1  ON 86
ci_0038                -1.119195e-02 3 1  ON 87
ci_0039                -2.531366e-03 3 1  ON 88
ci_0040                -2.765033e-03 3 1  ON 89
ci_0041                 6.635829e-03 3 1  ON 90
ci_0042                 7.331079e-03 3 1  ON 91
ci_0043                -1.945949e-02 3 1  ON 92
ci_0044                -1.898843e-02 3 1  ON 93
ci_0045                 7.486472e-03 3 1  ON 94
ci_0046                 7.409272e-03 3 1  ON 95
ci_0047                -1.552395e-03 3 1  ON 96
ci_0048                -1.862324e-03 3 1  ON 97
ci_0049                -5.340214e-03 3 1  ON 98
ci_0050                -5.918504e-03 3 1  ON 99
ci_0051                -3.617097e-03 3 1  ON 100
ci_0052                -3.395533e-03 3 1  ON 101
ci_0053                -4.479303e-03 3 1  ON 102
ci_0054                -4.333243e-03 3 1  ON 103
ci_0055                 6.387474e-03 3 1  ON 104
ci_0056                 6.304629e-03 3 1  ON 105
ci_0057                 4.731989e-03 3 1  ON 106
ci_0058                 4.836265e-03 3 1  ON 107
ci_0059                -4.599341e-03 3 1  ON 108
ci_0060                -4.623263e-03 3 1  ON 109
ci_0061                -4.533259e-03 3 1  ON 110
ci_0062                -3.762015e-03 3 1  ON 111
ci_0063                -9.154015e-03 3 1  ON 112
ci_0064                -8.246084e-03 3 1  ON 113
ci_0065                -5.045236e-03 3 1  ON 114
ci_0066                -5.119653e-03 3 1  ON 115
ci_0067                -5.300412e-03 3 1  ON 116
ci_0068                -4.973103e-03 3 1  ON 117
ci_0069                 4.619752e-03 3 1  ON 118
ci_0070                 4.549320e-03 3 1  ON 119
ci_0071                 5.486537e-04 3 1  ON 120
ci_0072                -4.146899e-04 3 1  ON 121
ci_0073                 4.247859e-03 3 1  ON 122
ci_0074                 4.073959e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8687e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.9308
    reference variance = 0.212762
====================================================
  Execution time = 2.1411e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5234e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5354e-01
  Total weights = 1.951470026e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1011e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329454697185
                                         uncertainty =       0.004362298900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329454697185
                                         uncertainty =       0.004362298900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405813882
  error estimate for blocks of size 2^( 2) =       0.000418879396
  error estimate for blocks of size 2^( 3) =       0.000431894472
  error estimate for blocks of size 2^( 4) =       0.000443834595
  error estimate for blocks of size 2^( 5) =       0.000455122532
  error estimate for blocks of size 2^( 6) =       0.000464924137
  error estimate for blocks of size 2^( 7) =       0.000470997108

      target function =                  N/A
              le_mean =     -16.905554362432
             les_mean =     286.151304348229
             stat err =       0.000458719593
             autocorr =       1.277734974665
              std dev =       0.573907495586
             le_variance =       0.329369813490


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690555436243e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905554362449       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905554377826       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905554378624       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905554377528       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905554377522       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905554378646       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905554378047       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905554377783       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905554377692       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905554377768       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.6843e+02 is 6.647306e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905554362449       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905554366294       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905554366494       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905554366220       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905554366217       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905554366500       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905554366355       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905554366284       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905554366256       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905554366289       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.2737e+03 is 1.662454e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905554362449       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905554363410       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905554363460       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905554363391       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905554363400       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905554363461       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905554363420       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905554363410       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905554363401       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905554363384       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.0949e+03 is 4.156528e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.518661 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7520e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
   uu_0                 3.117503e-01 1 1  ON 0
   uu_1                 1.447374e-01 1 1  ON 1
   uu_2                 4.305856e-02 1 1  ON 2
   uu_3                -1.916519e-02 1 1  ON 3
   uu_4                -6.454582e-02 1 1  ON 4
   uu_5                -9.933151e-02 1 1  ON 5
   uu_6                -1.264826e-01 1 1  ON 6
   uu_7                -1.389787e-01 1 1  ON 7
   uu_8                -1.311511e-01 1 1  ON 8
   uu_9                -1.002750e-01 1 1  ON 9
   ud_0                 4.453607e-01 1 1  ON 10
   ud_1                 1.799293e-01 1 1  ON 11
   ud_2                 5.987653e-02 1 1  ON 12
   ud_3                -1.076797e-02 1 1  ON 13
   ud_4                -6.720153e-02 1 1  ON 14
   ud_5                -1.077665e-01 1 1  ON 15
   ud_6                -1.341359e-01 1 1  ON 16
   ud_7                -1.497574e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385807e-01 1 1  ON 19
   eO_0                -7.471038e-01 1 1  ON 20
   eO_1                -4.277002e-01 1 1  ON 21
   eO_2                -1.909308e-02 1 1  ON 22
   eO_3                 2.902563e-01 1 1  ON 23
   eO_4                 5.129973e-01 1 1  ON 24
   eO_5                 4.729036e-01 1 1  ON 25
   eO_6                 2.454332e-01 1 1  ON 26
   eO_7                -4.920490e-02 1 1  ON 27
   eO_8                -2.099789e-01 1 1  ON 28
   eO_9                -6.985055e-02 1 1  ON 29
  eH1_0                -2.490227e-01 1 1  ON 30
  eH1_1                -1.410008e-01 1 1  ON 31
  eH1_2                -9.187497e-02 1 1  ON 32
  eH1_3                -3.738763e-02 1 1  ON 33
  eH1_4                 1.162283e-02 1 1  ON 34
  eH1_5                 4.534947e-02 1 1  ON 35
  eH1_6                 1.014831e-01 1 1  ON 36
  eH1_7                 1.507939e-01 1 1  ON 37
  eH1_8                 1.645756e-01 1 1  ON 38
  eH1_9                 4.967909e-02 1 1  ON 39
  eH2_0                -2.461151e-01 1 1  ON 40
  eH2_1                -1.390224e-01 1 1  ON 41
  eH2_2                -8.956045e-02 1 1  ON 42
  eH2_3                -3.460182e-02 1 1  ON 43
  eH2_4                 1.430672e-02 1 1  ON 44
  eH2_5                 4.960903e-02 1 1  ON 45
  eH2_6                 1.052388e-01 1 1  ON 46
  eH2_7                 1.534300e-01 1 1  ON 47
  eH2_8                 1.693344e-01 1 1  ON 48
  eH2_9                 3.486288e-02 1 1  ON 49
ci_0001                 7.014433e-01 3 1  ON 50
ci_0002                 7.000943e-01 3 1  ON 51
ci_0003                -2.781675e-02 3 1  ON 52
ci_0004                -2.749141e-02 3 1  ON 53
ci_0005                -3.666409e-02 3 1  ON 54
ci_0006                -3.710079e-02 3 1  ON 55
ci_0007                -2.252187e-02 3 1  ON 56
ci_0008                -2.153999e-02 3 1  ON 57
ci_0009                -1.785448e-02 3 1  ON 58
ci_0010                -1.750941e-02 3 1  ON 59
ci_0011                -1.219958e-02 3 1  ON 60
ci_0012                -1.234244e-02 3 1  ON 61
ci_0013                 1.300453e-02 3 1  ON 62
ci_0014                 1.317647e-02 3 1  ON 63
ci_0015                 1.362761e-02 3 1  ON 64
ci_0016                 1.350329e-02 3 1  ON 65
ci_0017                 1.098676e-02 3 1  ON 66
ci_0018                 1.191562e-02 3 1  ON 67
ci_0019                 1.136333e-02 3 1  ON 68
ci_0020                 1.154513e-02 3 1  ON 69
ci_0021                -2.103673e-03 3 1  ON 70
ci_0022                -4.895692e-04 3 1  ON 71
ci_0023                -1.110343e-02 3 1  ON 72
ci_0024                -1.090634e-02 3 1  ON 73
ci_0025                -1.174579e-02 3 1  ON 74
ci_0026                -1.107521e-02 3 1  ON 75
ci_0027                -1.166382e-02 3 1  ON 76
ci_0028                -1.083214e-02 3 1  ON 77
ci_0029                -9.946371e-03 3 1  ON 78
ci_0030                -1.127083e-02 3 1  ON 79
ci_0031                 2.036778e-02 3 1  ON 80
ci_0032                 2.129763e-02 3 1  ON 81
ci_0033                 1.035247e-02 3 1  ON 82
ci_0034                 9.807932e-03 3 1  ON 83
ci_0035                 6.441580e-03 3 1  ON 84
ci_0036                 6.891706e-03 3 1  ON 85
ci_0037                -1.058445e-02 3 1  ON 86
ci_0038                -1.119197e-02 3 1  ON 87
ci_0039                -2.531360e-03 3 1  ON 88
ci_0040                -2.764993e-03 3 1  ON 89
ci_0041                 6.635722e-03 3 1  ON 90
ci_0042                 7.331022e-03 3 1  ON 91
ci_0043                -1.945945e-02 3 1  ON 92
ci_0044                -1.898854e-02 3 1  ON 93
ci_0045                 7.486592e-03 3 1  ON 94
ci_0046                 7.409286e-03 3 1  ON 95
ci_0047                -1.552481e-03 3 1  ON 96
ci_0048                -1.862424e-03 3 1  ON 97
ci_0049                -5.340327e-03 3 1  ON 98
ci_0050                -5.918566e-03 3 1  ON 99
ci_0051                -3.617025e-03 3 1  ON 100
ci_0052                -3.395511e-03 3 1  ON 101
ci_0053                -4.479325e-03 3 1  ON 102
ci_0054                -4.333208e-03 3 1  ON 103
ci_0055                 6.387432e-03 3 1  ON 104
ci_0056                 6.304720e-03 3 1  ON 105
ci_0057                 4.732025e-03 3 1  ON 106
ci_0058                 4.836192e-03 3 1  ON 107
ci_0059                -4.599372e-03 3 1  ON 108
ci_0060                -4.623275e-03 3 1  ON 109
ci_0061                -4.533351e-03 3 1  ON 110
ci_0062                -3.762143e-03 3 1  ON 111
ci_0063                -9.154082e-03 3 1  ON 112
ci_0064                -8.246250e-03 3 1  ON 113
ci_0065                -5.045305e-03 3 1  ON 114
ci_0066                -5.119658e-03 3 1  ON 115
ci_0067                -5.300387e-03 3 1  ON 116
ci_0068                -4.972986e-03 3 1  ON 117
ci_0069                 4.619797e-03 3 1  ON 118
ci_0070                 4.549432e-03 3 1  ON 119
ci_0071                 5.486051e-04 3 1  ON 120
ci_0072                -4.146071e-04 3 1  ON 121
ci_0073                 4.247810e-03 3 1  ON 122
ci_0074                 4.074050e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.8734
    reference variance = 0.149532
====================================================
  Execution time = 2.1200e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3369e-01
  Total weights = 1.9513e+06
  Execution time = 1.8871e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322681039141
                                         uncertainty =       0.002195612592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322681039141
                                         uncertainty =       0.002195612592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401652803
  error estimate for blocks of size 2^( 2) =       0.000414681702
  error estimate for blocks of size 2^( 3) =       0.000428386525
  error estimate for blocks of size 2^( 4) =       0.000441374984
  error estimate for blocks of size 2^( 5) =       0.000452758548
  error estimate for blocks of size 2^( 6) =       0.000461458012
  error estimate for blocks of size 2^( 7) =       0.000468011880

      target function =                  N/A
              le_mean =     -16.905681494139
             les_mean =     286.135756811676
             stat err =       0.000455900856
             autocorr =       1.288365869407
              std dev =       0.568022841063
             le_variance =       0.322649947969

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322680965988
                                         uncertainty =       0.002195614485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322680965988
                                         uncertainty =       0.002195614485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401652757
  error estimate for blocks of size 2^( 2) =       0.000414681661
  error estimate for blocks of size 2^( 3) =       0.000428386485
  error estimate for blocks of size 2^( 4) =       0.000441374943
  error estimate for blocks of size 2^( 5) =       0.000452758517
  error estimate for blocks of size 2^( 6) =       0.000461457981
  error estimate for blocks of size 2^( 7) =       0.000468011861

      target function =                  N/A
              le_mean =     -16.905681499070
             les_mean =     286.135752970894
             stat err =       0.000455900825
             autocorr =       1.288365991998
              std dev =       0.568022776107
             le_variance =       0.322649874177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322681002531
                                         uncertainty =       0.002195613539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322681002531
                                         uncertainty =       0.002195613539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401652780
  error estimate for blocks of size 2^( 2) =       0.000414681682
  error estimate for blocks of size 2^( 3) =       0.000428386505
  error estimate for blocks of size 2^( 4) =       0.000441374963
  error estimate for blocks of size 2^( 5) =       0.000452758532
  error estimate for blocks of size 2^( 6) =       0.000461457996
  error estimate for blocks of size 2^( 7) =       0.000468011871

      target function =                  N/A
              le_mean =     -16.905681496602
             les_mean =     286.135754754358
             stat err =       0.000455900841
             autocorr =       1.288365930733
              std dev =       0.568022808556
             le_variance =       0.322649911039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322681034562
                                         uncertainty =       0.002195612710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322681034562
                                         uncertainty =       0.002195612710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401652800
  error estimate for blocks of size 2^( 2) =       0.000414681699
  error estimate for blocks of size 2^( 3) =       0.000428386523
  error estimate for blocks of size 2^( 4) =       0.000441374981
  error estimate for blocks of size 2^( 5) =       0.000452758546
  error estimate for blocks of size 2^( 6) =       0.000461458010
  error estimate for blocks of size 2^( 7) =       0.000468011879

      target function =                  N/A
              le_mean =     -16.905681494447
             les_mean =     286.135756537967
             stat err =       0.000455900854
             autocorr =       1.288365877079
              std dev =       0.568022836997
             le_variance =       0.322649943350


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905681494139        initial
     5.6843e+02     5.6843e+03             6.6473e-07       -16.905681499070  <--
     2.2737e+03     2.2737e+04             1.6625e-07       -16.905681496602
     9.0949e+03     9.0949e+04             4.1565e-08       -16.905681494447

*****************************************************************************
Applying the update for shift_i =   5.6843e+02     and shift_s =   5.6843e+03
*****************************************************************************

  Execution time = 3.0795e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
   uu_0                 3.117504e-01 1 1  ON 0
   uu_1                 1.447374e-01 1 1  ON 1
   uu_2                 4.305853e-02 1 1  ON 2
   uu_3                -1.916521e-02 1 1  ON 3
   uu_4                -6.454582e-02 1 1  ON 4
   uu_5                -9.933147e-02 1 1  ON 5
   uu_6                -1.264827e-01 1 1  ON 6
   uu_7                -1.389788e-01 1 1  ON 7
   uu_8                -1.311512e-01 1 1  ON 8
   uu_9                -1.002751e-01 1 1  ON 9
   ud_0                 4.453608e-01 1 1  ON 10
   ud_1                 1.799293e-01 1 1  ON 11
   ud_2                 5.987661e-02 1 1  ON 12
   ud_3                -1.076791e-02 1 1  ON 13
   ud_4                -6.720153e-02 1 1  ON 14
   ud_5                -1.077666e-01 1 1  ON 15
   ud_6                -1.341361e-01 1 1  ON 16
   ud_7                -1.497574e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385807e-01 1 1  ON 19
   eO_0                -7.471040e-01 1 1  ON 20
   eO_1                -4.277001e-01 1 1  ON 21
   eO_2                -1.909306e-02 1 1  ON 22
   eO_3                 2.902564e-01 1 1  ON 23
   eO_4                 5.129973e-01 1 1  ON 24
   eO_5                 4.729039e-01 1 1  ON 25
   eO_6                 2.454333e-01 1 1  ON 26
   eO_7                -4.920484e-02 1 1  ON 27
   eO_8                -2.099791e-01 1 1  ON 28
   eO_9                -6.985072e-02 1 1  ON 29
  eH1_0                -2.490229e-01 1 1  ON 30
  eH1_1                -1.410010e-01 1 1  ON 31
  eH1_2                -9.187514e-02 1 1  ON 32
  eH1_3                -3.738770e-02 1 1  ON 33
  eH1_4                 1.162263e-02 1 1  ON 34
  eH1_5                 4.534950e-02 1 1  ON 35
  eH1_6                 1.014830e-01 1 1  ON 36
  eH1_7                 1.507940e-01 1 1  ON 37
  eH1_8                 1.645759e-01 1 1  ON 38
  eH1_9                 4.967942e-02 1 1  ON 39
  eH2_0                -2.461152e-01 1 1  ON 40
  eH2_1                -1.390225e-01 1 1  ON 41
  eH2_2                -8.956051e-02 1 1  ON 42
  eH2_3                -3.460183e-02 1 1  ON 43
  eH2_4                 1.430656e-02 1 1  ON 44
  eH2_5                 4.960897e-02 1 1  ON 45
  eH2_6                 1.052388e-01 1 1  ON 46
  eH2_7                 1.534300e-01 1 1  ON 47
  eH2_8                 1.693346e-01 1 1  ON 48
  eH2_9                 3.486316e-02 1 1  ON 49
ci_0001                 7.014435e-01 3 1  ON 50
ci_0002                 7.000942e-01 3 1  ON 51
ci_0003                -2.781658e-02 3 1  ON 52
ci_0004                -2.749117e-02 3 1  ON 53
ci_0005                -3.666418e-02 3 1  ON 54
ci_0006                -3.710036e-02 3 1  ON 55
ci_0007                -2.252164e-02 3 1  ON 56
ci_0008                -2.153985e-02 3 1  ON 57
ci_0009                -1.785454e-02 3 1  ON 58
ci_0010                -1.750948e-02 3 1  ON 59
ci_0011                -1.219948e-02 3 1  ON 60
ci_0012                -1.234251e-02 3 1  ON 61
ci_0013                 1.300447e-02 3 1  ON 62
ci_0014                 1.317665e-02 3 1  ON 63
ci_0015                 1.362738e-02 3 1  ON 64
ci_0016                 1.350330e-02 3 1  ON 65
ci_0017                 1.098673e-02 3 1  ON 66
ci_0018                 1.191525e-02 3 1  ON 67
ci_0019                 1.136335e-02 3 1  ON 68
ci_0020                 1.154497e-02 3 1  ON 69
ci_0021                -2.103477e-03 3 1  ON 70
ci_0022                -4.896157e-04 3 1  ON 71
ci_0023                -1.110360e-02 3 1  ON 72
ci_0024                -1.090672e-02 3 1  ON 73
ci_0025                -1.174558e-02 3 1  ON 74
ci_0026                -1.107509e-02 3 1  ON 75
ci_0027                -1.166387e-02 3 1  ON 76
ci_0028                -1.083239e-02 3 1  ON 77
ci_0029                -9.946229e-03 3 1  ON 78
ci_0030                -1.127086e-02 3 1  ON 79
ci_0031                 2.036764e-02 3 1  ON 80
ci_0032                 2.129732e-02 3 1  ON 81
ci_0033                 1.035271e-02 3 1  ON 82
ci_0034                 9.807728e-03 3 1  ON 83
ci_0035                 6.441892e-03 3 1  ON 84
ci_0036                 6.891675e-03 3 1  ON 85
ci_0037                -1.058465e-02 3 1  ON 86
ci_0038                -1.119202e-02 3 1  ON 87
ci_0039                -2.531343e-03 3 1  ON 88
ci_0040                -2.764875e-03 3 1  ON 89
ci_0041                 6.635399e-03 3 1  ON 90
ci_0042                 7.330851e-03 3 1  ON 91
ci_0043                -1.945934e-02 3 1  ON 92
ci_0044                -1.898887e-02 3 1  ON 93
ci_0045                 7.486952e-03 3 1  ON 94
ci_0046                 7.409330e-03 3 1  ON 95
ci_0047                -1.552741e-03 3 1  ON 96
ci_0048                -1.862724e-03 3 1  ON 97
ci_0049                -5.340664e-03 3 1  ON 98
ci_0050                -5.918750e-03 3 1  ON 99
ci_0051                -3.616812e-03 3 1  ON 100
ci_0052                -3.395445e-03 3 1  ON 101
ci_0053                -4.479390e-03 3 1  ON 102
ci_0054                -4.333102e-03 3 1  ON 103
ci_0055                 6.387307e-03 3 1  ON 104
ci_0056                 6.304992e-03 3 1  ON 105
ci_0057                 4.732136e-03 3 1  ON 106
ci_0058                 4.835973e-03 3 1  ON 107
ci_0059                -4.599463e-03 3 1  ON 108
ci_0060                -4.623312e-03 3 1  ON 109
ci_0061                -4.533626e-03 3 1  ON 110
ci_0062                -3.762527e-03 3 1  ON 111
ci_0063                -9.154280e-03 3 1  ON 112
ci_0064                -8.246749e-03 3 1  ON 113
ci_0065                -5.045513e-03 3 1  ON 114
ci_0066                -5.119672e-03 3 1  ON 115
ci_0067                -5.300311e-03 3 1  ON 116
ci_0068                -4.972637e-03 3 1  ON 117
ci_0069                 4.619933e-03 3 1  ON 118
ci_0070                 4.549769e-03 3 1  ON 119
ci_0071                 5.484594e-04 3 1  ON 120
ci_0072                -4.143588e-04 3 1  ON 121
ci_0073                 4.247662e-03 3 1  ON 122
ci_0074                 4.074326e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8322e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.9157
    reference variance = 0.208001
====================================================
  Execution time = 2.1418e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5969e-01
  Total weights = 1.951348354e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6140e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346634077944
                                         uncertainty =       0.023017368210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346634077944
                                         uncertainty =       0.023017368210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416372284
  error estimate for blocks of size 2^( 2) =       0.000428737868
  error estimate for blocks of size 2^( 3) =       0.000442019052
  error estimate for blocks of size 2^( 4) =       0.000453816836
  error estimate for blocks of size 2^( 5) =       0.000464064611
  error estimate for blocks of size 2^( 6) =       0.000471375730
  error estimate for blocks of size 2^( 7) =       0.000476489318

      target function =                  N/A
              le_mean =     -16.905926509437
             les_mean =     286.170040976518
             stat err =       0.000466436624
             autocorr =       1.254936239924
              std dev =       0.588839330626
             le_variance =       0.346731757292


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690592650944e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905926509431       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905926553587       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905926548229       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905926543831       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905926547392       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905926548916       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905926548938       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905926548820       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905926548843       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905926548989       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4211e+02 is 2.379477e-06

solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905926509431       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905926520482       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905926519141       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905926518041       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905926518930       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905926519310       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905926519318       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905926519288       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905926519294       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905926519330       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.6843e+02 is 5.954198e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905926509431       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905926512195       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905926511859       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905926511584       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905926511807       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905926511904       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905926511903       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905926511890       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905926511899       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905926511907       residual = 4.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.2737e+03 is 1.488894e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.522570 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8040e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
   uu_0                 3.117505e-01 1 1  ON 0
   uu_1                 1.447372e-01 1 1  ON 1
   uu_2                 4.305861e-02 1 1  ON 2
   uu_3                -1.916523e-02 1 1  ON 3
   uu_4                -6.454573e-02 1 1  ON 4
   uu_5                -9.933137e-02 1 1  ON 5
   uu_6                -1.264827e-01 1 1  ON 6
   uu_7                -1.389789e-01 1 1  ON 7
   uu_8                -1.311513e-01 1 1  ON 8
   uu_9                -1.002753e-01 1 1  ON 9
   ud_0                 4.453609e-01 1 1  ON 10
   ud_1                 1.799291e-01 1 1  ON 11
   ud_2                 5.987678e-02 1 1  ON 12
   ud_3                -1.076770e-02 1 1  ON 13
   ud_4                -6.720141e-02 1 1  ON 14
   ud_5                -1.077665e-01 1 1  ON 15
   ud_6                -1.341363e-01 1 1  ON 16
   ud_7                -1.497574e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385809e-01 1 1  ON 19
   eO_0                -7.471040e-01 1 1  ON 20
   eO_1                -4.277005e-01 1 1  ON 21
   eO_2                -1.909308e-02 1 1  ON 22
   eO_3                 2.902566e-01 1 1  ON 23
   eO_4                 5.129974e-01 1 1  ON 24
   eO_5                 4.729039e-01 1 1  ON 25
   eO_6                 2.454337e-01 1 1  ON 26
   eO_7                -4.920462e-02 1 1  ON 27
   eO_8                -2.099794e-01 1 1  ON 28
   eO_9                -6.985097e-02 1 1  ON 29
  eH1_0                -2.490229e-01 1 1  ON 30
  eH1_1                -1.410012e-01 1 1  ON 31
  eH1_2                -9.187536e-02 1 1  ON 32
  eH1_3                -3.738791e-02 1 1  ON 33
  eH1_4                 1.162239e-02 1 1  ON 34
  eH1_5                 4.534955e-02 1 1  ON 35
  eH1_6                 1.014831e-01 1 1  ON 36
  eH1_7                 1.507941e-01 1 1  ON 37
  eH1_8                 1.645762e-01 1 1  ON 38
  eH1_9                 4.967981e-02 1 1  ON 39
  eH2_0                -2.461152e-01 1 1  ON 40
  eH2_1                -1.390226e-01 1 1  ON 41
  eH2_2                -8.956064e-02 1 1  ON 42
  eH2_3                -3.460195e-02 1 1  ON 43
  eH2_4                 1.430634e-02 1 1  ON 44
  eH2_5                 4.960885e-02 1 1  ON 45
  eH2_6                 1.052389e-01 1 1  ON 46
  eH2_7                 1.534300e-01 1 1  ON 47
  eH2_8                 1.693348e-01 1 1  ON 48
  eH2_9                 3.486349e-02 1 1  ON 49
ci_0001                 7.014436e-01 3 1  ON 50
ci_0002                 7.000940e-01 3 1  ON 51
ci_0003                -2.781615e-02 3 1  ON 52
ci_0004                -2.749108e-02 3 1  ON 53
ci_0005                -3.666386e-02 3 1  ON 54
ci_0006                -3.710002e-02 3 1  ON 55
ci_0007                -2.252146e-02 3 1  ON 56
ci_0008                -2.154010e-02 3 1  ON 57
ci_0009                -1.785449e-02 3 1  ON 58
ci_0010                -1.750929e-02 3 1  ON 59
ci_0011                -1.219992e-02 3 1  ON 60
ci_0012                -1.234260e-02 3 1  ON 61
ci_0013                 1.300469e-02 3 1  ON 62
ci_0014                 1.317653e-02 3 1  ON 63
ci_0015                 1.362733e-02 3 1  ON 64
ci_0016                 1.350314e-02 3 1  ON 65
ci_0017                 1.098718e-02 3 1  ON 66
ci_0018                 1.191513e-02 3 1  ON 67
ci_0019                 1.136341e-02 3 1  ON 68
ci_0020                 1.154488e-02 3 1  ON 69
ci_0021                -2.103313e-03 3 1  ON 70
ci_0022                -4.891248e-04 3 1  ON 71
ci_0023                -1.110354e-02 3 1  ON 72
ci_0024                -1.090681e-02 3 1  ON 73
ci_0025                -1.174546e-02 3 1  ON 74
ci_0026                -1.107522e-02 3 1  ON 75
ci_0027                -1.166377e-02 3 1  ON 76
ci_0028                -1.083256e-02 3 1  ON 77
ci_0029                -9.946662e-03 3 1  ON 78
ci_0030                -1.127058e-02 3 1  ON 79
ci_0031                 2.036769e-02 3 1  ON 80
ci_0032                 2.129704e-02 3 1  ON 81
ci_0033                 1.035275e-02 3 1  ON 82
ci_0034                 9.807614e-03 3 1  ON 83
ci_0035                 6.442081e-03 3 1  ON 84
ci_0036                 6.891905e-03 3 1  ON 85
ci_0037                -1.058480e-02 3 1  ON 86
ci_0038                -1.119208e-02 3 1  ON 87
ci_0039                -2.531371e-03 3 1  ON 88
ci_0040                -2.764644e-03 3 1  ON 89
ci_0041                 6.635403e-03 3 1  ON 90
ci_0042                 7.330813e-03 3 1  ON 91
ci_0043                -1.945897e-02 3 1  ON 92
ci_0044                -1.898871e-02 3 1  ON 93
ci_0045                 7.487357e-03 3 1  ON 94
ci_0046                 7.409348e-03 3 1  ON 95
ci_0047                -1.552869e-03 3 1  ON 96
ci_0048                -1.862838e-03 3 1  ON 97
ci_0049                -5.340212e-03 3 1  ON 98
ci_0050                -5.918260e-03 3 1  ON 99
ci_0051                -3.617073e-03 3 1  ON 100
ci_0052                -3.395678e-03 3 1  ON 101
ci_0053                -4.479841e-03 3 1  ON 102
ci_0054                -4.333157e-03 3 1  ON 103
ci_0055                 6.387227e-03 3 1  ON 104
ci_0056                 6.305049e-03 3 1  ON 105
ci_0057                 4.732731e-03 3 1  ON 106
ci_0058                 4.836103e-03 3 1  ON 107
ci_0059                -4.599658e-03 3 1  ON 108
ci_0060                -4.623187e-03 3 1  ON 109
ci_0061                -4.533385e-03 3 1  ON 110
ci_0062                -3.762510e-03 3 1  ON 111
ci_0063                -9.154114e-03 3 1  ON 112
ci_0064                -8.247120e-03 3 1  ON 113
ci_0065                -5.045084e-03 3 1  ON 114
ci_0066                -5.119697e-03 3 1  ON 115
ci_0067                -5.300355e-03 3 1  ON 116
ci_0068                -4.973028e-03 3 1  ON 117
ci_0069                 4.619919e-03 3 1  ON 118
ci_0070                 4.549869e-03 3 1  ON 119
ci_0071                 5.483898e-04 3 1  ON 120
ci_0072                -4.139505e-04 3 1  ON 121
ci_0073                 4.247548e-03 3 1  ON 122
ci_0074                 4.074372e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.8626
    reference variance = 0.223037
====================================================
  Execution time = 2.1633e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3681e-01
  Total weights = 1.9515e+06
  Execution time = 1.8913e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323600209904
                                         uncertainty =       0.002071185490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323600209904
                                         uncertainty =       0.002071185490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402222333
  error estimate for blocks of size 2^( 2) =       0.000414879430
  error estimate for blocks of size 2^( 3) =       0.000428127269
  error estimate for blocks of size 2^( 4) =       0.000439867010
  error estimate for blocks of size 2^( 5) =       0.000450230878
  error estimate for blocks of size 2^( 6) =       0.000457678403
  error estimate for blocks of size 2^( 7) =       0.000461532768

      target function =                  N/A
              le_mean =     -16.905829459818
             les_mean =     286.143879406799
             stat err =       0.000452327265
             autocorr =       1.264658219508
              std dev =       0.568828278653
             le_variance =       0.323565610595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323600328096
                                         uncertainty =       0.002071159149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323600328096
                                         uncertainty =       0.002071159149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402222405
  error estimate for blocks of size 2^( 2) =       0.000414879448
  error estimate for blocks of size 2^( 3) =       0.000428127246
  error estimate for blocks of size 2^( 4) =       0.000439867009
  error estimate for blocks of size 2^( 5) =       0.000450230902
  error estimate for blocks of size 2^( 6) =       0.000457678476
  error estimate for blocks of size 2^( 7) =       0.000461532793

      target function =                  N/A
              le_mean =     -16.905829435027
             les_mean =     286.143876915096
             stat err =       0.000452327295
             autocorr =       1.264657934490
              std dev =       0.568828380586
             le_variance =       0.323565726560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323600269666
                                         uncertainty =       0.002071172306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323600269666
                                         uncertainty =       0.002071172306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402222370
  error estimate for blocks of size 2^( 2) =       0.000414879439
  error estimate for blocks of size 2^( 3) =       0.000428127258
  error estimate for blocks of size 2^( 4) =       0.000439867010
  error estimate for blocks of size 2^( 5) =       0.000450230891
  error estimate for blocks of size 2^( 6) =       0.000457678440
  error estimate for blocks of size 2^( 7) =       0.000461532781

      target function =                  N/A
              le_mean =     -16.905829447368
             les_mean =     286.143878144734
             stat err =       0.000452327280
             autocorr =       1.264658076340
              std dev =       0.568828330203
             le_variance =       0.323565669241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323600217373
                                         uncertainty =       0.002071183841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323600217373
                                         uncertainty =       0.002071183841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402222338
  error estimate for blocks of size 2^( 2) =       0.000414879431
  error estimate for blocks of size 2^( 3) =       0.000428127268
  error estimate for blocks of size 2^( 4) =       0.000439867010
  error estimate for blocks of size 2^( 5) =       0.000450230880
  error estimate for blocks of size 2^( 6) =       0.000457678407
  error estimate for blocks of size 2^( 7) =       0.000461532770

      target function =                  N/A
              le_mean =     -16.905829458257
             les_mean =     286.143879247229
             stat err =       0.000452327267
             autocorr =       1.264658201614
              std dev =       0.568828285095
             le_variance =       0.323565617924


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905829459818        initial  <--
     1.4211e+02     1.4211e+03             2.3795e-06       -16.905829435027
     5.6843e+02     5.6843e+03             5.9542e-07       -16.905829447368
     2.2737e+03     2.2737e+04             1.4889e-07       -16.905829458257

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.1757
  </log>
  <optVariables href="H2O.s052.opt.xml">
   uu_0                 3.117504e-01 1 1  ON 0
   uu_1                 1.447374e-01 1 1  ON 1
   uu_2                 4.305853e-02 1 1  ON 2
   uu_3                -1.916521e-02 1 1  ON 3
   uu_4                -6.454582e-02 1 1  ON 4
   uu_5                -9.933147e-02 1 1  ON 5
   uu_6                -1.264827e-01 1 1  ON 6
   uu_7                -1.389788e-01 1 1  ON 7
   uu_8                -1.311512e-01 1 1  ON 8
   uu_9                -1.002751e-01 1 1  ON 9
   ud_0                 4.453608e-01 1 1  ON 10
   ud_1                 1.799293e-01 1 1  ON 11
   ud_2                 5.987661e-02 1 1  ON 12
   ud_3                -1.076791e-02 1 1  ON 13
   ud_4                -6.720153e-02 1 1  ON 14
   ud_5                -1.077666e-01 1 1  ON 15
   ud_6                -1.341361e-01 1 1  ON 16
   ud_7                -1.497574e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385807e-01 1 1  ON 19
   eO_0                -7.471040e-01 1 1  ON 20
   eO_1                -4.277001e-01 1 1  ON 21
   eO_2                -1.909306e-02 1 1  ON 22
   eO_3                 2.902564e-01 1 1  ON 23
   eO_4                 5.129973e-01 1 1  ON 24
   eO_5                 4.729039e-01 1 1  ON 25
   eO_6                 2.454333e-01 1 1  ON 26
   eO_7                -4.920484e-02 1 1  ON 27
   eO_8                -2.099791e-01 1 1  ON 28
   eO_9                -6.985072e-02 1 1  ON 29
  eH1_0                -2.490229e-01 1 1  ON 30
  eH1_1                -1.410010e-01 1 1  ON 31
  eH1_2                -9.187514e-02 1 1  ON 32
  eH1_3                -3.738770e-02 1 1  ON 33
  eH1_4                 1.162263e-02 1 1  ON 34
  eH1_5                 4.534950e-02 1 1  ON 35
  eH1_6                 1.014830e-01 1 1  ON 36
  eH1_7                 1.507940e-01 1 1  ON 37
  eH1_8                 1.645759e-01 1 1  ON 38
  eH1_9                 4.967942e-02 1 1  ON 39
  eH2_0                -2.461152e-01 1 1  ON 40
  eH2_1                -1.390225e-01 1 1  ON 41
  eH2_2                -8.956051e-02 1 1  ON 42
  eH2_3                -3.460183e-02 1 1  ON 43
  eH2_4                 1.430656e-02 1 1  ON 44
  eH2_5                 4.960897e-02 1 1  ON 45
  eH2_6                 1.052388e-01 1 1  ON 46
  eH2_7                 1.534300e-01 1 1  ON 47
  eH2_8                 1.693346e-01 1 1  ON 48
  eH2_9                 3.486316e-02 1 1  ON 49
ci_0001                 7.014435e-01 3 1  ON 50
ci_0002                 7.000942e-01 3 1  ON 51
ci_0003                -2.781658e-02 3 1  ON 52
ci_0004                -2.749117e-02 3 1  ON 53
ci_0005                -3.666418e-02 3 1  ON 54
ci_0006                -3.710036e-02 3 1  ON 55
ci_0007                -2.252164e-02 3 1  ON 56
ci_0008                -2.153985e-02 3 1  ON 57
ci_0009                -1.785454e-02 3 1  ON 58
ci_0010                -1.750948e-02 3 1  ON 59
ci_0011                -1.219948e-02 3 1  ON 60
ci_0012                -1.234251e-02 3 1  ON 61
ci_0013                 1.300447e-02 3 1  ON 62
ci_0014                 1.317665e-02 3 1  ON 63
ci_0015                 1.362738e-02 3 1  ON 64
ci_0016                 1.350330e-02 3 1  ON 65
ci_0017                 1.098673e-02 3 1  ON 66
ci_0018                 1.191525e-02 3 1  ON 67
ci_0019                 1.136335e-02 3 1  ON 68
ci_0020                 1.154497e-02 3 1  ON 69
ci_0021                -2.103477e-03 3 1  ON 70
ci_0022                -4.896157e-04 3 1  ON 71
ci_0023                -1.110360e-02 3 1  ON 72
ci_0024                -1.090672e-02 3 1  ON 73
ci_0025                -1.174558e-02 3 1  ON 74
ci_0026                -1.107509e-02 3 1  ON 75
ci_0027                -1.166387e-02 3 1  ON 76
ci_0028                -1.083239e-02 3 1  ON 77
ci_0029                -9.946229e-03 3 1  ON 78
ci_0030                -1.127086e-02 3 1  ON 79
ci_0031                 2.036764e-02 3 1  ON 80
ci_0032                 2.129732e-02 3 1  ON 81
ci_0033                 1.035271e-02 3 1  ON 82
ci_0034                 9.807728e-03 3 1  ON 83
ci_0035                 6.441892e-03 3 1  ON 84
ci_0036                 6.891675e-03 3 1  ON 85
ci_0037                -1.058465e-02 3 1  ON 86
ci_0038                -1.119202e-02 3 1  ON 87
ci_0039                -2.531343e-03 3 1  ON 88
ci_0040                -2.764875e-03 3 1  ON 89
ci_0041                 6.635399e-03 3 1  ON 90
ci_0042                 7.330851e-03 3 1  ON 91
ci_0043                -1.945934e-02 3 1  ON 92
ci_0044                -1.898887e-02 3 1  ON 93
ci_0045                 7.486952e-03 3 1  ON 94
ci_0046                 7.409330e-03 3 1  ON 95
ci_0047                -1.552741e-03 3 1  ON 96
ci_0048                -1.862724e-03 3 1  ON 97
ci_0049                -5.340664e-03 3 1  ON 98
ci_0050                -5.918750e-03 3 1  ON 99
ci_0051                -3.616812e-03 3 1  ON 100
ci_0052                -3.395445e-03 3 1  ON 101
ci_0053                -4.479390e-03 3 1  ON 102
ci_0054                -4.333102e-03 3 1  ON 103
ci_0055                 6.387307e-03 3 1  ON 104
ci_0056                 6.304992e-03 3 1  ON 105
ci_0057                 4.732136e-03 3 1  ON 106
ci_0058                 4.835973e-03 3 1  ON 107
ci_0059                -4.599463e-03 3 1  ON 108
ci_0060                -4.623312e-03 3 1  ON 109
ci_0061                -4.533626e-03 3 1  ON 110
ci_0062                -3.762527e-03 3 1  ON 111
ci_0063                -9.154280e-03 3 1  ON 112
ci_0064                -8.246749e-03 3 1  ON 113
ci_0065                -5.045513e-03 3 1  ON 114
ci_0066                -5.119672e-03 3 1  ON 115
ci_0067                -5.300311e-03 3 1  ON 116
ci_0068                -4.972637e-03 3 1  ON 117
ci_0069                 4.619933e-03 3 1  ON 118
ci_0070                 4.549769e-03 3 1  ON 119
ci_0071                 5.484594e-04 3 1  ON 120
ci_0072                -4.143588e-04 3 1  ON 121
ci_0073                 4.247662e-03 3 1  ON 122
ci_0074                 4.074326e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9223e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.905
    reference variance = 0.356639
====================================================
  Execution time = 2.1549e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5236e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3736e-01
  Total weights = 1.951613969e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0644e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324436299298
                                         uncertainty =       0.002339197633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324436299298
                                         uncertainty =       0.002339197633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402839325
  error estimate for blocks of size 2^( 2) =       0.000415727051
  error estimate for blocks of size 2^( 3) =       0.000429040095
  error estimate for blocks of size 2^( 4) =       0.000441896110
  error estimate for blocks of size 2^( 5) =       0.000451407117
  error estimate for blocks of size 2^( 6) =       0.000457391978
  error estimate for blocks of size 2^( 7) =       0.000463243485

      target function =                  N/A
              le_mean =     -16.906082368412
             les_mean =     286.152982768928
             stat err =       0.000453484673
             autocorr =       1.267247687057
              std dev =       0.569700836388
             le_variance =       0.324559042981


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690608236841e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+03, overlap shift 1.4211e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906082368393       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906082371628       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906082371330       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906082371937       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906082371963       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906082372437       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906082372717       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906082372529       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906082372609       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906082372655       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4211e+03 is 3.433416e-07

solving harmonic davidson linear method for identity shift 5.6843e+03, overlap shift 5.6843e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906082368393       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906082369202       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906082369127       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906082369279       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906082369286       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906082369396       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906082369472       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906082369412       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906082369456       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906082369451       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.6843e+03 is 8.584708e-08

solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906082368393       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906082368595       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906082368576       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906082368615       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906082368624       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906082368674       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906082368666       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906082368680       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906082368680       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906082368692       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.2737e+04 is 2.146250e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.526415 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7621e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
   uu_0                 3.117505e-01 1 1  ON 0
   uu_1                 1.447373e-01 1 1  ON 1
   uu_2                 4.305854e-02 1 1  ON 2
   uu_3                -1.916522e-02 1 1  ON 3
   uu_4                -6.454581e-02 1 1  ON 4
   uu_5                -9.933146e-02 1 1  ON 5
   uu_6                -1.264827e-01 1 1  ON 6
   uu_7                -1.389788e-01 1 1  ON 7
   uu_8                -1.311512e-01 1 1  ON 8
   uu_9                -1.002751e-01 1 1  ON 9
   ud_0                 4.453608e-01 1 1  ON 10
   ud_1                 1.799293e-01 1 1  ON 11
   ud_2                 5.987662e-02 1 1  ON 12
   ud_3                -1.076791e-02 1 1  ON 13
   ud_4                -6.720152e-02 1 1  ON 14
   ud_5                -1.077666e-01 1 1  ON 15
   ud_6                -1.341361e-01 1 1  ON 16
   ud_7                -1.497574e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385807e-01 1 1  ON 19
   eO_0                -7.471041e-01 1 1  ON 20
   eO_1                -4.277002e-01 1 1  ON 21
   eO_2                -1.909305e-02 1 1  ON 22
   eO_3                 2.902564e-01 1 1  ON 23
   eO_4                 5.129973e-01 1 1  ON 24
   eO_5                 4.729039e-01 1 1  ON 25
   eO_6                 2.454333e-01 1 1  ON 26
   eO_7                -4.920484e-02 1 1  ON 27
   eO_8                -2.099791e-01 1 1  ON 28
   eO_9                -6.985074e-02 1 1  ON 29
  eH1_0                -2.490229e-01 1 1  ON 30
  eH1_1                -1.410010e-01 1 1  ON 31
  eH1_2                -9.187516e-02 1 1  ON 32
  eH1_3                -3.738771e-02 1 1  ON 33
  eH1_4                 1.162263e-02 1 1  ON 34
  eH1_5                 4.534951e-02 1 1  ON 35
  eH1_6                 1.014830e-01 1 1  ON 36
  eH1_7                 1.507940e-01 1 1  ON 37
  eH1_8                 1.645760e-01 1 1  ON 38
  eH1_9                 4.967944e-02 1 1  ON 39
  eH2_0                -2.461152e-01 1 1  ON 40
  eH2_1                -1.390225e-01 1 1  ON 41
  eH2_2                -8.956053e-02 1 1  ON 42
  eH2_3                -3.460184e-02 1 1  ON 43
  eH2_4                 1.430654e-02 1 1  ON 44
  eH2_5                 4.960894e-02 1 1  ON 45
  eH2_6                 1.052387e-01 1 1  ON 46
  eH2_7                 1.534301e-01 1 1  ON 47
  eH2_8                 1.693346e-01 1 1  ON 48
  eH2_9                 3.486319e-02 1 1  ON 49
ci_0001                 7.014435e-01 3 1  ON 50
ci_0002                 7.000942e-01 3 1  ON 51
ci_0003                -2.781654e-02 3 1  ON 52
ci_0004                -2.749116e-02 3 1  ON 53
ci_0005                -3.666418e-02 3 1  ON 54
ci_0006                -3.710035e-02 3 1  ON 55
ci_0007                -2.252160e-02 3 1  ON 56
ci_0008                -2.153978e-02 3 1  ON 57
ci_0009                -1.785445e-02 3 1  ON 58
ci_0010                -1.750944e-02 3 1  ON 59
ci_0011                -1.219950e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300446e-02 3 1  ON 62
ci_0014                 1.317666e-02 3 1  ON 63
ci_0015                 1.362733e-02 3 1  ON 64
ci_0016                 1.350327e-02 3 1  ON 65
ci_0017                 1.098673e-02 3 1  ON 66
ci_0018                 1.191519e-02 3 1  ON 67
ci_0019                 1.136335e-02 3 1  ON 68
ci_0020                 1.154492e-02 3 1  ON 69
ci_0021                -2.103490e-03 3 1  ON 70
ci_0022                -4.896572e-04 3 1  ON 71
ci_0023                -1.110358e-02 3 1  ON 72
ci_0024                -1.090673e-02 3 1  ON 73
ci_0025                -1.174556e-02 3 1  ON 74
ci_0026                -1.107507e-02 3 1  ON 75
ci_0027                -1.166385e-02 3 1  ON 76
ci_0028                -1.083236e-02 3 1  ON 77
ci_0029                -9.946223e-03 3 1  ON 78
ci_0030                -1.127083e-02 3 1  ON 79
ci_0031                 2.036766e-02 3 1  ON 80
ci_0032                 2.129731e-02 3 1  ON 81
ci_0033                 1.035274e-02 3 1  ON 82
ci_0034                 9.807747e-03 3 1  ON 83
ci_0035                 6.441881e-03 3 1  ON 84
ci_0036                 6.891681e-03 3 1  ON 85
ci_0037                -1.058462e-02 3 1  ON 86
ci_0038                -1.119200e-02 3 1  ON 87
ci_0039                -2.531362e-03 3 1  ON 88
ci_0040                -2.764836e-03 3 1  ON 89
ci_0041                 6.635404e-03 3 1  ON 90
ci_0042                 7.330857e-03 3 1  ON 91
ci_0043                -1.945933e-02 3 1  ON 92
ci_0044                -1.898887e-02 3 1  ON 93
ci_0045                 7.486935e-03 3 1  ON 94
ci_0046                 7.409330e-03 3 1  ON 95
ci_0047                -1.552744e-03 3 1  ON 96
ci_0048                -1.862712e-03 3 1  ON 97
ci_0049                -5.340659e-03 3 1  ON 98
ci_0050                -5.918765e-03 3 1  ON 99
ci_0051                -3.616829e-03 3 1  ON 100
ci_0052                -3.395453e-03 3 1  ON 101
ci_0053                -4.479414e-03 3 1  ON 102
ci_0054                -4.333101e-03 3 1  ON 103
ci_0055                 6.387302e-03 3 1  ON 104
ci_0056                 6.304981e-03 3 1  ON 105
ci_0057                 4.732174e-03 3 1  ON 106
ci_0058                 4.835969e-03 3 1  ON 107
ci_0059                -4.599513e-03 3 1  ON 108
ci_0060                -4.623356e-03 3 1  ON 109
ci_0061                -4.533598e-03 3 1  ON 110
ci_0062                -3.762517e-03 3 1  ON 111
ci_0063                -9.154260e-03 3 1  ON 112
ci_0064                -8.246777e-03 3 1  ON 113
ci_0065                -5.045502e-03 3 1  ON 114
ci_0066                -5.119665e-03 3 1  ON 115
ci_0067                -5.300286e-03 3 1  ON 116
ci_0068                -4.972640e-03 3 1  ON 117
ci_0069                 4.619987e-03 3 1  ON 118
ci_0070                 4.549770e-03 3 1  ON 119
ci_0071                 5.484767e-04 3 1  ON 120
ci_0072                -4.143206e-04 3 1  ON 121
ci_0073                 4.247676e-03 3 1  ON 122
ci_0074                 4.074311e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.9049
    reference variance = 0.289627
====================================================
  Execution time = 2.1536e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3644e-01
  Total weights = 1.9514e+06
  Execution time = 1.8930e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322112320188
                                         uncertainty =       0.001970740404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322112320188
                                         uncertainty =       0.001970740404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401368899
  error estimate for blocks of size 2^( 2) =       0.000414442755
  error estimate for blocks of size 2^( 3) =       0.000427866896
  error estimate for blocks of size 2^( 4) =       0.000440461013
  error estimate for blocks of size 2^( 5) =       0.000451306912
  error estimate for blocks of size 2^( 6) =       0.000460836993
  error estimate for blocks of size 2^( 7) =       0.000465985022

      target function =                  N/A
              le_mean =     -16.905840798045
             les_mean =     286.143896680176
             stat err =       0.000454647485
             autocorr =       1.283104864810
              std dev =       0.567621340615
             le_variance =       0.322193986322

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322112435208
                                         uncertainty =       0.001970754918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322112435208
                                         uncertainty =       0.001970754918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401368970
  error estimate for blocks of size 2^( 2) =       0.000414442831
  error estimate for blocks of size 2^( 3) =       0.000427866979
  error estimate for blocks of size 2^( 4) =       0.000440461095
  error estimate for blocks of size 2^( 5) =       0.000451306990
  error estimate for blocks of size 2^( 6) =       0.000460837067
  error estimate for blocks of size 2^( 7) =       0.000465985103

      target function =                  N/A
              le_mean =     -16.905840795755
             les_mean =     286.143896885174
             stat err =       0.000454647564
             autocorr =       1.283104854172
              std dev =       0.567621441249
             le_variance =       0.322194100566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322112377698
                                         uncertainty =       0.001970747661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322112377698
                                         uncertainty =       0.001970747661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401368935
  error estimate for blocks of size 2^( 2) =       0.000414442793
  error estimate for blocks of size 2^( 3) =       0.000427866938
  error estimate for blocks of size 2^( 4) =       0.000440461054
  error estimate for blocks of size 2^( 5) =       0.000451306951
  error estimate for blocks of size 2^( 6) =       0.000460837030
  error estimate for blocks of size 2^( 7) =       0.000465985063

      target function =                  N/A
              le_mean =     -16.905840796899
             les_mean =     286.143896782547
             stat err =       0.000454647524
             autocorr =       1.283104859494
              std dev =       0.567621390933
             le_variance =       0.322194043444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322112327376
                                         uncertainty =       0.001970741311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322112327376
                                         uncertainty =       0.001970741311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401368904
  error estimate for blocks of size 2^( 2) =       0.000414442759
  error estimate for blocks of size 2^( 3) =       0.000427866901
  error estimate for blocks of size 2^( 4) =       0.000440461018
  error estimate for blocks of size 2^( 5) =       0.000451306917
  error estimate for blocks of size 2^( 6) =       0.000460836997
  error estimate for blocks of size 2^( 7) =       0.000465985027

      target function =                  N/A
              le_mean =     -16.905840797901
             les_mean =     286.143896692958
             stat err =       0.000454647490
             autocorr =       1.283104864148
              std dev =       0.567621346905
             le_variance =       0.322193993462


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905840798045        initial  <--
     1.4211e+03     1.4211e+04             3.4334e-07       -16.905840795755
     5.6843e+03     5.6843e+04             8.5847e-08       -16.905840796899
     2.2737e+04     2.2737e+05             2.1463e-08       -16.905840797901

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0873
  </log>
  <optVariables href="H2O.s053.opt.xml">
   uu_0                 3.117504e-01 1 1  ON 0
   uu_1                 1.447374e-01 1 1  ON 1
   uu_2                 4.305853e-02 1 1  ON 2
   uu_3                -1.916521e-02 1 1  ON 3
   uu_4                -6.454582e-02 1 1  ON 4
   uu_5                -9.933147e-02 1 1  ON 5
   uu_6                -1.264827e-01 1 1  ON 6
   uu_7                -1.389788e-01 1 1  ON 7
   uu_8                -1.311512e-01 1 1  ON 8
   uu_9                -1.002751e-01 1 1  ON 9
   ud_0                 4.453608e-01 1 1  ON 10
   ud_1                 1.799293e-01 1 1  ON 11
   ud_2                 5.987661e-02 1 1  ON 12
   ud_3                -1.076791e-02 1 1  ON 13
   ud_4                -6.720153e-02 1 1  ON 14
   ud_5                -1.077666e-01 1 1  ON 15
   ud_6                -1.341361e-01 1 1  ON 16
   ud_7                -1.497574e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385807e-01 1 1  ON 19
   eO_0                -7.471040e-01 1 1  ON 20
   eO_1                -4.277001e-01 1 1  ON 21
   eO_2                -1.909306e-02 1 1  ON 22
   eO_3                 2.902564e-01 1 1  ON 23
   eO_4                 5.129973e-01 1 1  ON 24
   eO_5                 4.729039e-01 1 1  ON 25
   eO_6                 2.454333e-01 1 1  ON 26
   eO_7                -4.920484e-02 1 1  ON 27
   eO_8                -2.099791e-01 1 1  ON 28
   eO_9                -6.985072e-02 1 1  ON 29
  eH1_0                -2.490229e-01 1 1  ON 30
  eH1_1                -1.410010e-01 1 1  ON 31
  eH1_2                -9.187514e-02 1 1  ON 32
  eH1_3                -3.738770e-02 1 1  ON 33
  eH1_4                 1.162263e-02 1 1  ON 34
  eH1_5                 4.534950e-02 1 1  ON 35
  eH1_6                 1.014830e-01 1 1  ON 36
  eH1_7                 1.507940e-01 1 1  ON 37
  eH1_8                 1.645759e-01 1 1  ON 38
  eH1_9                 4.967942e-02 1 1  ON 39
  eH2_0                -2.461152e-01 1 1  ON 40
  eH2_1                -1.390225e-01 1 1  ON 41
  eH2_2                -8.956051e-02 1 1  ON 42
  eH2_3                -3.460183e-02 1 1  ON 43
  eH2_4                 1.430656e-02 1 1  ON 44
  eH2_5                 4.960897e-02 1 1  ON 45
  eH2_6                 1.052388e-01 1 1  ON 46
  eH2_7                 1.534300e-01 1 1  ON 47
  eH2_8                 1.693346e-01 1 1  ON 48
  eH2_9                 3.486316e-02 1 1  ON 49
ci_0001                 7.014435e-01 3 1  ON 50
ci_0002                 7.000942e-01 3 1  ON 51
ci_0003                -2.781658e-02 3 1  ON 52
ci_0004                -2.749117e-02 3 1  ON 53
ci_0005                -3.666418e-02 3 1  ON 54
ci_0006                -3.710036e-02 3 1  ON 55
ci_0007                -2.252164e-02 3 1  ON 56
ci_0008                -2.153985e-02 3 1  ON 57
ci_0009                -1.785454e-02 3 1  ON 58
ci_0010                -1.750948e-02 3 1  ON 59
ci_0011                -1.219948e-02 3 1  ON 60
ci_0012                -1.234251e-02 3 1  ON 61
ci_0013                 1.300447e-02 3 1  ON 62
ci_0014                 1.317665e-02 3 1  ON 63
ci_0015                 1.362738e-02 3 1  ON 64
ci_0016                 1.350330e-02 3 1  ON 65
ci_0017                 1.098673e-02 3 1  ON 66
ci_0018                 1.191525e-02 3 1  ON 67
ci_0019                 1.136335e-02 3 1  ON 68
ci_0020                 1.154497e-02 3 1  ON 69
ci_0021                -2.103477e-03 3 1  ON 70
ci_0022                -4.896157e-04 3 1  ON 71
ci_0023                -1.110360e-02 3 1  ON 72
ci_0024                -1.090672e-02 3 1  ON 73
ci_0025                -1.174558e-02 3 1  ON 74
ci_0026                -1.107509e-02 3 1  ON 75
ci_0027                -1.166387e-02 3 1  ON 76
ci_0028                -1.083239e-02 3 1  ON 77
ci_0029                -9.946229e-03 3 1  ON 78
ci_0030                -1.127086e-02 3 1  ON 79
ci_0031                 2.036764e-02 3 1  ON 80
ci_0032                 2.129732e-02 3 1  ON 81
ci_0033                 1.035271e-02 3 1  ON 82
ci_0034                 9.807728e-03 3 1  ON 83
ci_0035                 6.441892e-03 3 1  ON 84
ci_0036                 6.891675e-03 3 1  ON 85
ci_0037                -1.058465e-02 3 1  ON 86
ci_0038                -1.119202e-02 3 1  ON 87
ci_0039                -2.531343e-03 3 1  ON 88
ci_0040                -2.764875e-03 3 1  ON 89
ci_0041                 6.635399e-03 3 1  ON 90
ci_0042                 7.330851e-03 3 1  ON 91
ci_0043                -1.945934e-02 3 1  ON 92
ci_0044                -1.898887e-02 3 1  ON 93
ci_0045                 7.486952e-03 3 1  ON 94
ci_0046                 7.409330e-03 3 1  ON 95
ci_0047                -1.552741e-03 3 1  ON 96
ci_0048                -1.862724e-03 3 1  ON 97
ci_0049                -5.340664e-03 3 1  ON 98
ci_0050                -5.918750e-03 3 1  ON 99
ci_0051                -3.616812e-03 3 1  ON 100
ci_0052                -3.395445e-03 3 1  ON 101
ci_0053                -4.479390e-03 3 1  ON 102
ci_0054                -4.333102e-03 3 1  ON 103
ci_0055                 6.387307e-03 3 1  ON 104
ci_0056                 6.304992e-03 3 1  ON 105
ci_0057                 4.732136e-03 3 1  ON 106
ci_0058                 4.835973e-03 3 1  ON 107
ci_0059                -4.599463e-03 3 1  ON 108
ci_0060                -4.623312e-03 3 1  ON 109
ci_0061                -4.533626e-03 3 1  ON 110
ci_0062                -3.762527e-03 3 1  ON 111
ci_0063                -9.154280e-03 3 1  ON 112
ci_0064                -8.246749e-03 3 1  ON 113
ci_0065                -5.045513e-03 3 1  ON 114
ci_0066                -5.119672e-03 3 1  ON 115
ci_0067                -5.300311e-03 3 1  ON 116
ci_0068                -4.972637e-03 3 1  ON 117
ci_0069                 4.619933e-03 3 1  ON 118
ci_0070                 4.549769e-03 3 1  ON 119
ci_0071                 5.484594e-04 3 1  ON 120
ci_0072                -4.143588e-04 3 1  ON 121
ci_0073                 4.247662e-03 3 1  ON 122
ci_0074                 4.074326e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8715e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.8998
    reference variance = 0.478962
====================================================
  Execution time = 2.1447e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5234e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3963e-01
  Total weights = 1.951686124e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0247e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326697070577
                                         uncertainty =       0.002935349075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326697070577
                                         uncertainty =       0.002935349075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404162914
  error estimate for blocks of size 2^( 2) =       0.000417057668
  error estimate for blocks of size 2^( 3) =       0.000430457047
  error estimate for blocks of size 2^( 4) =       0.000442977884
  error estimate for blocks of size 2^( 5) =       0.000454926165
  error estimate for blocks of size 2^( 6) =       0.000464350961
  error estimate for blocks of size 2^( 7) =       0.000471625305

      target function =                  N/A
              le_mean =     -16.905601526942
             les_mean =     286.138995288925
             stat err =       0.000458470079
             autocorr =       1.286794140546
              std dev =       0.571572674542
             le_variance =       0.326695322283


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690560152694e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+04, overlap shift 1.4211e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905601526921       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905601527254       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905601527283       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905601527232       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905601527192       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905601527192       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905601527180       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905601527190       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905601527223       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905601527209       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4211e+04 is 2.825810e-08

solving harmonic davidson linear method for identity shift 5.6843e+04, overlap shift 5.6843e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905601526921       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905601527004       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905601527012       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905601526999       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905601526999       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905601526991       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905601526982       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905601526953       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905601527098       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905601527124       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.6843e+04 is 7.064596e-09

solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905601526921       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905601526942       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905601526944       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905601526941       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905601526938       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905601526938       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905601526883       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905601527000       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905601526853       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905601526894       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.2737e+05 is 1.766153e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.530297 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7479e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
   uu_0                 3.117504e-01 1 1  ON 0
   uu_1                 1.447374e-01 1 1  ON 1
   uu_2                 4.305853e-02 1 1  ON 2
   uu_3                -1.916521e-02 1 1  ON 3
   uu_4                -6.454582e-02 1 1  ON 4
   uu_5                -9.933147e-02 1 1  ON 5
   uu_6                -1.264827e-01 1 1  ON 6
   uu_7                -1.389788e-01 1 1  ON 7
   uu_8                -1.311512e-01 1 1  ON 8
   uu_9                -1.002751e-01 1 1  ON 9
   ud_0                 4.453608e-01 1 1  ON 10
   ud_1                 1.799293e-01 1 1  ON 11
   ud_2                 5.987661e-02 1 1  ON 12
   ud_3                -1.076791e-02 1 1  ON 13
   ud_4                -6.720153e-02 1 1  ON 14
   ud_5                -1.077666e-01 1 1  ON 15
   ud_6                -1.341361e-01 1 1  ON 16
   ud_7                -1.497574e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385807e-01 1 1  ON 19
   eO_0                -7.471040e-01 1 1  ON 20
   eO_1                -4.277001e-01 1 1  ON 21
   eO_2                -1.909306e-02 1 1  ON 22
   eO_3                 2.902564e-01 1 1  ON 23
   eO_4                 5.129973e-01 1 1  ON 24
   eO_5                 4.729039e-01 1 1  ON 25
   eO_6                 2.454333e-01 1 1  ON 26
   eO_7                -4.920484e-02 1 1  ON 27
   eO_8                -2.099791e-01 1 1  ON 28
   eO_9                -6.985072e-02 1 1  ON 29
  eH1_0                -2.490229e-01 1 1  ON 30
  eH1_1                -1.410010e-01 1 1  ON 31
  eH1_2                -9.187514e-02 1 1  ON 32
  eH1_3                -3.738770e-02 1 1  ON 33
  eH1_4                 1.162263e-02 1 1  ON 34
  eH1_5                 4.534950e-02 1 1  ON 35
  eH1_6                 1.014830e-01 1 1  ON 36
  eH1_7                 1.507940e-01 1 1  ON 37
  eH1_8                 1.645759e-01 1 1  ON 38
  eH1_9                 4.967942e-02 1 1  ON 39
  eH2_0                -2.461152e-01 1 1  ON 40
  eH2_1                -1.390225e-01 1 1  ON 41
  eH2_2                -8.956052e-02 1 1  ON 42
  eH2_3                -3.460183e-02 1 1  ON 43
  eH2_4                 1.430656e-02 1 1  ON 44
  eH2_5                 4.960897e-02 1 1  ON 45
  eH2_6                 1.052388e-01 1 1  ON 46
  eH2_7                 1.534300e-01 1 1  ON 47
  eH2_8                 1.693346e-01 1 1  ON 48
  eH2_9                 3.486316e-02 1 1  ON 49
ci_0001                 7.014435e-01 3 1  ON 50
ci_0002                 7.000942e-01 3 1  ON 51
ci_0003                -2.781658e-02 3 1  ON 52
ci_0004                -2.749117e-02 3 1  ON 53
ci_0005                -3.666418e-02 3 1  ON 54
ci_0006                -3.710036e-02 3 1  ON 55
ci_0007                -2.252164e-02 3 1  ON 56
ci_0008                -2.153985e-02 3 1  ON 57
ci_0009                -1.785453e-02 3 1  ON 58
ci_0010                -1.750948e-02 3 1  ON 59
ci_0011                -1.219949e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300447e-02 3 1  ON 62
ci_0014                 1.317665e-02 3 1  ON 63
ci_0015                 1.362739e-02 3 1  ON 64
ci_0016                 1.350329e-02 3 1  ON 65
ci_0017                 1.098673e-02 3 1  ON 66
ci_0018                 1.191525e-02 3 1  ON 67
ci_0019                 1.136335e-02 3 1  ON 68
ci_0020                 1.154497e-02 3 1  ON 69
ci_0021                -2.103479e-03 3 1  ON 70
ci_0022                -4.896196e-04 3 1  ON 71
ci_0023                -1.110360e-02 3 1  ON 72
ci_0024                -1.090672e-02 3 1  ON 73
ci_0025                -1.174557e-02 3 1  ON 74
ci_0026                -1.107509e-02 3 1  ON 75
ci_0027                -1.166387e-02 3 1  ON 76
ci_0028                -1.083238e-02 3 1  ON 77
ci_0029                -9.946227e-03 3 1  ON 78
ci_0030                -1.127086e-02 3 1  ON 79
ci_0031                 2.036765e-02 3 1  ON 80
ci_0032                 2.129732e-02 3 1  ON 81
ci_0033                 1.035271e-02 3 1  ON 82
ci_0034                 9.807728e-03 3 1  ON 83
ci_0035                 6.441894e-03 3 1  ON 84
ci_0036                 6.891677e-03 3 1  ON 85
ci_0037                -1.058465e-02 3 1  ON 86
ci_0038                -1.119201e-02 3 1  ON 87
ci_0039                -2.531341e-03 3 1  ON 88
ci_0040                -2.764876e-03 3 1  ON 89
ci_0041                 6.635399e-03 3 1  ON 90
ci_0042                 7.330848e-03 3 1  ON 91
ci_0043                -1.945934e-02 3 1  ON 92
ci_0044                -1.898887e-02 3 1  ON 93
ci_0045                 7.486950e-03 3 1  ON 94
ci_0046                 7.409332e-03 3 1  ON 95
ci_0047                -1.552742e-03 3 1  ON 96
ci_0048                -1.862723e-03 3 1  ON 97
ci_0049                -5.340666e-03 3 1  ON 98
ci_0050                -5.918750e-03 3 1  ON 99
ci_0051                -3.616813e-03 3 1  ON 100
ci_0052                -3.395443e-03 3 1  ON 101
ci_0053                -4.479389e-03 3 1  ON 102
ci_0054                -4.333104e-03 3 1  ON 103
ci_0055                 6.387308e-03 3 1  ON 104
ci_0056                 6.304995e-03 3 1  ON 105
ci_0057                 4.732140e-03 3 1  ON 106
ci_0058                 4.835974e-03 3 1  ON 107
ci_0059                -4.599460e-03 3 1  ON 108
ci_0060                -4.623315e-03 3 1  ON 109
ci_0061                -4.533619e-03 3 1  ON 110
ci_0062                -3.762527e-03 3 1  ON 111
ci_0063                -9.154276e-03 3 1  ON 112
ci_0064                -8.246747e-03 3 1  ON 113
ci_0065                -5.045515e-03 3 1  ON 114
ci_0066                -5.119669e-03 3 1  ON 115
ci_0067                -5.300307e-03 3 1  ON 116
ci_0068                -4.972640e-03 3 1  ON 117
ci_0069                 4.619933e-03 3 1  ON 118
ci_0070                 4.549768e-03 3 1  ON 119
ci_0071                 5.484556e-04 3 1  ON 120
ci_0072                -4.143546e-04 3 1  ON 121
ci_0073                 4.247659e-03 3 1  ON 122
ci_0074                 4.074325e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.8641
    reference variance = 0.157703
====================================================
  Execution time = 2.1161e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3329e-01
  Total weights = 1.9517e+06
  Execution time = 1.8881e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322419105722
                                         uncertainty =       0.002045187227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322419105722
                                         uncertainty =       0.002045187227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401488716
  error estimate for blocks of size 2^( 2) =       0.000414314456
  error estimate for blocks of size 2^( 3) =       0.000427275239
  error estimate for blocks of size 2^( 4) =       0.000440270337
  error estimate for blocks of size 2^( 5) =       0.000450470551
  error estimate for blocks of size 2^( 6) =       0.000459914134
  error estimate for blocks of size 2^( 7) =       0.000464956726

      target function =                  N/A
              le_mean =     -16.906844420518
             les_mean =     286.174681017372
             stat err =       0.000453902937
             autocorr =       1.278142564283
              std dev =       0.567790787405
             le_variance =       0.322386378262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322419113373
                                         uncertainty =       0.002045186527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322419113373
                                         uncertainty =       0.002045186527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401488721
  error estimate for blocks of size 2^( 2) =       0.000414314461
  error estimate for blocks of size 2^( 3) =       0.000427275244
  error estimate for blocks of size 2^( 4) =       0.000440270342
  error estimate for blocks of size 2^( 5) =       0.000450470556
  error estimate for blocks of size 2^( 6) =       0.000459914139
  error estimate for blocks of size 2^( 7) =       0.000464956731

      target function =                  N/A
              le_mean =     -16.906844420671
             les_mean =     286.174680984856
             stat err =       0.000453902942
             autocorr =       1.278142563396
              std dev =       0.567790794074
             le_variance =       0.322386385835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322419109548
                                         uncertainty =       0.002045186877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322419109548
                                         uncertainty =       0.002045186877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401488718
  error estimate for blocks of size 2^( 2) =       0.000414314458
  error estimate for blocks of size 2^( 3) =       0.000427275242
  error estimate for blocks of size 2^( 4) =       0.000440270340
  error estimate for blocks of size 2^( 5) =       0.000450470553
  error estimate for blocks of size 2^( 6) =       0.000459914137
  error estimate for blocks of size 2^( 7) =       0.000464956728

      target function =                  N/A
              le_mean =     -16.906844420595
             les_mean =     286.174681001039
             stat err =       0.000453902939
             autocorr =       1.278142563835
              std dev =       0.567790790739
             le_variance =       0.322386382048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322419106201
                                         uncertainty =       0.002045187183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322419106201
                                         uncertainty =       0.002045187183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401488716
  error estimate for blocks of size 2^( 2) =       0.000414314456
  error estimate for blocks of size 2^( 3) =       0.000427275239
  error estimate for blocks of size 2^( 4) =       0.000440270338
  error estimate for blocks of size 2^( 5) =       0.000450470551
  error estimate for blocks of size 2^( 6) =       0.000459914134
  error estimate for blocks of size 2^( 7) =       0.000464956726

      target function =                  N/A
              le_mean =     -16.906844420528
             les_mean =     286.174681015322
             stat err =       0.000453902937
             autocorr =       1.278142564228
              std dev =       0.567790787821
             le_variance =       0.322386378735


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906844420518        initial
     1.4211e+04     1.4211e+05             2.8258e-08       -16.906844420671  <--
     5.6843e+04     5.6843e+05             7.0646e-09       -16.906844420595
     2.2737e+05     2.2737e+06             1.7662e-09       -16.906844420528

*****************************************************************************
Applying the update for shift_i =   1.4211e+04     and shift_s =   1.4211e+05
*****************************************************************************

  Execution time = 3.0713e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
   uu_0                 3.117505e-01 1 1  ON 0
   uu_1                 1.447374e-01 1 1  ON 1
   uu_2                 4.305853e-02 1 1  ON 2
   uu_3                -1.916522e-02 1 1  ON 3
   uu_4                -6.454582e-02 1 1  ON 4
   uu_5                -9.933147e-02 1 1  ON 5
   uu_6                -1.264827e-01 1 1  ON 6
   uu_7                -1.389788e-01 1 1  ON 7
   uu_8                -1.311512e-01 1 1  ON 8
   uu_9                -1.002751e-01 1 1  ON 9
   ud_0                 4.453608e-01 1 1  ON 10
   ud_1                 1.799293e-01 1 1  ON 11
   ud_2                 5.987661e-02 1 1  ON 12
   ud_3                -1.076791e-02 1 1  ON 13
   ud_4                -6.720153e-02 1 1  ON 14
   ud_5                -1.077666e-01 1 1  ON 15
   ud_6                -1.341361e-01 1 1  ON 16
   ud_7                -1.497574e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385807e-01 1 1  ON 19
   eO_0                -7.471040e-01 1 1  ON 20
   eO_1                -4.277001e-01 1 1  ON 21
   eO_2                -1.909305e-02 1 1  ON 22
   eO_3                 2.902564e-01 1 1  ON 23
   eO_4                 5.129973e-01 1 1  ON 24
   eO_5                 4.729039e-01 1 1  ON 25
   eO_6                 2.454333e-01 1 1  ON 26
   eO_7                -4.920484e-02 1 1  ON 27
   eO_8                -2.099791e-01 1 1  ON 28
   eO_9                -6.985072e-02 1 1  ON 29
  eH1_0                -2.490229e-01 1 1  ON 30
  eH1_1                -1.410010e-01 1 1  ON 31
  eH1_2                -9.187515e-02 1 1  ON 32
  eH1_3                -3.738769e-02 1 1  ON 33
  eH1_4                 1.162262e-02 1 1  ON 34
  eH1_5                 4.534949e-02 1 1  ON 35
  eH1_6                 1.014830e-01 1 1  ON 36
  eH1_7                 1.507940e-01 1 1  ON 37
  eH1_8                 1.645760e-01 1 1  ON 38
  eH1_9                 4.967943e-02 1 1  ON 39
  eH2_0                -2.461152e-01 1 1  ON 40
  eH2_1                -1.390225e-01 1 1  ON 41
  eH2_2                -8.956052e-02 1 1  ON 42
  eH2_3                -3.460184e-02 1 1  ON 43
  eH2_4                 1.430656e-02 1 1  ON 44
  eH2_5                 4.960896e-02 1 1  ON 45
  eH2_6                 1.052388e-01 1 1  ON 46
  eH2_7                 1.534300e-01 1 1  ON 47
  eH2_8                 1.693346e-01 1 1  ON 48
  eH2_9                 3.486317e-02 1 1  ON 49
ci_0001                 7.014435e-01 3 1  ON 50
ci_0002                 7.000942e-01 3 1  ON 51
ci_0003                -2.781658e-02 3 1  ON 52
ci_0004                -2.749117e-02 3 1  ON 53
ci_0005                -3.666418e-02 3 1  ON 54
ci_0006                -3.710037e-02 3 1  ON 55
ci_0007                -2.252163e-02 3 1  ON 56
ci_0008                -2.153984e-02 3 1  ON 57
ci_0009                -1.785452e-02 3 1  ON 58
ci_0010                -1.750947e-02 3 1  ON 59
ci_0011                -1.219950e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300448e-02 3 1  ON 62
ci_0014                 1.317666e-02 3 1  ON 63
ci_0015                 1.362739e-02 3 1  ON 64
ci_0016                 1.350328e-02 3 1  ON 65
ci_0017                 1.098672e-02 3 1  ON 66
ci_0018                 1.191524e-02 3 1  ON 67
ci_0019                 1.136336e-02 3 1  ON 68
ci_0020                 1.154497e-02 3 1  ON 69
ci_0021                -2.103486e-03 3 1  ON 70
ci_0022                -4.896311e-04 3 1  ON 71
ci_0023                -1.110360e-02 3 1  ON 72
ci_0024                -1.090672e-02 3 1  ON 73
ci_0025                -1.174556e-02 3 1  ON 74
ci_0026                -1.107509e-02 3 1  ON 75
ci_0027                -1.166387e-02 3 1  ON 76
ci_0028                -1.083237e-02 3 1  ON 77
ci_0029                -9.946221e-03 3 1  ON 78
ci_0030                -1.127085e-02 3 1  ON 79
ci_0031                 2.036766e-02 3 1  ON 80
ci_0032                 2.129731e-02 3 1  ON 81
ci_0033                 1.035270e-02 3 1  ON 82
ci_0034                 9.807730e-03 3 1  ON 83
ci_0035                 6.441899e-03 3 1  ON 84
ci_0036                 6.891684e-03 3 1  ON 85
ci_0037                -1.058463e-02 3 1  ON 86
ci_0038                -1.119201e-02 3 1  ON 87
ci_0039                -2.531333e-03 3 1  ON 88
ci_0040                -2.764879e-03 3 1  ON 89
ci_0041                 6.635400e-03 3 1  ON 90
ci_0042                 7.330839e-03 3 1  ON 91
ci_0043                -1.945935e-02 3 1  ON 92
ci_0044                -1.898888e-02 3 1  ON 93
ci_0045                 7.486942e-03 3 1  ON 94
ci_0046                 7.409336e-03 3 1  ON 95
ci_0047                -1.552747e-03 3 1  ON 96
ci_0048                -1.862719e-03 3 1  ON 97
ci_0049                -5.340671e-03 3 1  ON 98
ci_0050                -5.918750e-03 3 1  ON 99
ci_0051                -3.616818e-03 3 1  ON 100
ci_0052                -3.395436e-03 3 1  ON 101
ci_0053                -4.479385e-03 3 1  ON 102
ci_0054                -4.333110e-03 3 1  ON 103
ci_0055                 6.387308e-03 3 1  ON 104
ci_0056                 6.305002e-03 3 1  ON 105
ci_0057                 4.732152e-03 3 1  ON 106
ci_0058                 4.835978e-03 3 1  ON 107
ci_0059                -4.599452e-03 3 1  ON 108
ci_0060                -4.623327e-03 3 1  ON 109
ci_0061                -4.533598e-03 3 1  ON 110
ci_0062                -3.762525e-03 3 1  ON 111
ci_0063                -9.154262e-03 3 1  ON 112
ci_0064                -8.246743e-03 3 1  ON 113
ci_0065                -5.045520e-03 3 1  ON 114
ci_0066                -5.119659e-03 3 1  ON 115
ci_0067                -5.300296e-03 3 1  ON 116
ci_0068                -4.972651e-03 3 1  ON 117
ci_0069                 4.619932e-03 3 1  ON 118
ci_0070                 4.549767e-03 3 1  ON 119
ci_0071                 5.484445e-04 3 1  ON 120
ci_0072                -4.143417e-04 3 1  ON 121
ci_0073                 4.247651e-03 3 1  ON 122
ci_0074                 4.074324e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8199e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.8842
    reference variance = 0.217532
====================================================
  Execution time = 2.1551e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3725e-01
  Total weights = 1.951576737e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0685e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322942981505
                                         uncertainty =       0.001983373642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322942981505
                                         uncertainty =       0.001983373642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401858402
  error estimate for blocks of size 2^( 2) =       0.000414569330
  error estimate for blocks of size 2^( 3) =       0.000428167918
  error estimate for blocks of size 2^( 4) =       0.000440498931
  error estimate for blocks of size 2^( 5) =       0.000450828778
  error estimate for blocks of size 2^( 6) =       0.000459757047
  error estimate for blocks of size 2^( 7) =       0.000466063740

      target function =                  N/A
              le_mean =     -16.906370644123
             les_mean =     286.162622880827
             stat err =       0.000454287124
             autocorr =       1.277952611885
              std dev =       0.568313601797
             le_variance =       0.322980349988


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690637064412e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+03, overlap shift 3.5527e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906370644101       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906370645992       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906370645887       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906370645953       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906370646033       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906370646006       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906370646061       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906370646066       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906370646075       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906370646076       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.5527e+03 is 1.402902e-07

solving harmonic davidson linear method for identity shift 1.4211e+04, overlap shift 1.4211e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906370644101       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906370644574       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906370644548       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906370644573       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906370644586       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906370644577       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906370644590       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906370644579       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906370644591       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906370644603       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4211e+04 is 3.507432e-08

solving harmonic davidson linear method for identity shift 5.6843e+04, overlap shift 5.6843e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906370644101       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906370644220       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906370644213       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906370644217       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906370644250       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906370644240       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906370643992       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906370644318       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906370644481       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906370644314       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.6843e+04 is 8.768691e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.534157 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7627e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
   uu_0                 3.117505e-01 1 1  ON 0
   uu_1                 1.447374e-01 1 1  ON 1
   uu_2                 4.305853e-02 1 1  ON 2
   uu_3                -1.916522e-02 1 1  ON 3
   uu_4                -6.454583e-02 1 1  ON 4
   uu_5                -9.933147e-02 1 1  ON 5
   uu_6                -1.264827e-01 1 1  ON 6
   uu_7                -1.389788e-01 1 1  ON 7
   uu_8                -1.311512e-01 1 1  ON 8
   uu_9                -1.002751e-01 1 1  ON 9
   ud_0                 4.453608e-01 1 1  ON 10
   ud_1                 1.799293e-01 1 1  ON 11
   ud_2                 5.987660e-02 1 1  ON 12
   ud_3                -1.076791e-02 1 1  ON 13
   ud_4                -6.720152e-02 1 1  ON 14
   ud_5                -1.077666e-01 1 1  ON 15
   ud_6                -1.341361e-01 1 1  ON 16
   ud_7                -1.497574e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385807e-01 1 1  ON 19
   eO_0                -7.471040e-01 1 1  ON 20
   eO_1                -4.277001e-01 1 1  ON 21
   eO_2                -1.909306e-02 1 1  ON 22
   eO_3                 2.902564e-01 1 1  ON 23
   eO_4                 5.129973e-01 1 1  ON 24
   eO_5                 4.729039e-01 1 1  ON 25
   eO_6                 2.454333e-01 1 1  ON 26
   eO_7                -4.920483e-02 1 1  ON 27
   eO_8                -2.099791e-01 1 1  ON 28
   eO_9                -6.985073e-02 1 1  ON 29
  eH1_0                -2.490229e-01 1 1  ON 30
  eH1_1                -1.410010e-01 1 1  ON 31
  eH1_2                -9.187515e-02 1 1  ON 32
  eH1_3                -3.738768e-02 1 1  ON 33
  eH1_4                 1.162263e-02 1 1  ON 34
  eH1_5                 4.534949e-02 1 1  ON 35
  eH1_6                 1.014830e-01 1 1  ON 36
  eH1_7                 1.507940e-01 1 1  ON 37
  eH1_8                 1.645760e-01 1 1  ON 38
  eH1_9                 4.967944e-02 1 1  ON 39
  eH2_0                -2.461152e-01 1 1  ON 40
  eH2_1                -1.390225e-01 1 1  ON 41
  eH2_2                -8.956052e-02 1 1  ON 42
  eH2_3                -3.460183e-02 1 1  ON 43
  eH2_4                 1.430656e-02 1 1  ON 44
  eH2_5                 4.960895e-02 1 1  ON 45
  eH2_6                 1.052388e-01 1 1  ON 46
  eH2_7                 1.534301e-01 1 1  ON 47
  eH2_8                 1.693346e-01 1 1  ON 48
  eH2_9                 3.486319e-02 1 1  ON 49
ci_0001                 7.014435e-01 3 1  ON 50
ci_0002                 7.000942e-01 3 1  ON 51
ci_0003                -2.781660e-02 3 1  ON 52
ci_0004                -2.749116e-02 3 1  ON 53
ci_0005                -3.666417e-02 3 1  ON 54
ci_0006                -3.710036e-02 3 1  ON 55
ci_0007                -2.252164e-02 3 1  ON 56
ci_0008                -2.153984e-02 3 1  ON 57
ci_0009                -1.785451e-02 3 1  ON 58
ci_0010                -1.750946e-02 3 1  ON 59
ci_0011                -1.219950e-02 3 1  ON 60
ci_0012                -1.234251e-02 3 1  ON 61
ci_0013                 1.300448e-02 3 1  ON 62
ci_0014                 1.317664e-02 3 1  ON 63
ci_0015                 1.362738e-02 3 1  ON 64
ci_0016                 1.350329e-02 3 1  ON 65
ci_0017                 1.098672e-02 3 1  ON 66
ci_0018                 1.191521e-02 3 1  ON 67
ci_0019                 1.136336e-02 3 1  ON 68
ci_0020                 1.154497e-02 3 1  ON 69
ci_0021                -2.103476e-03 3 1  ON 70
ci_0022                -4.896336e-04 3 1  ON 71
ci_0023                -1.110360e-02 3 1  ON 72
ci_0024                -1.090672e-02 3 1  ON 73
ci_0025                -1.174553e-02 3 1  ON 74
ci_0026                -1.107508e-02 3 1  ON 75
ci_0027                -1.166387e-02 3 1  ON 76
ci_0028                -1.083237e-02 3 1  ON 77
ci_0029                -9.946239e-03 3 1  ON 78
ci_0030                -1.127083e-02 3 1  ON 79
ci_0031                 2.036764e-02 3 1  ON 80
ci_0032                 2.129729e-02 3 1  ON 81
ci_0033                 1.035270e-02 3 1  ON 82
ci_0034                 9.807739e-03 3 1  ON 83
ci_0035                 6.441907e-03 3 1  ON 84
ci_0036                 6.891689e-03 3 1  ON 85
ci_0037                -1.058462e-02 3 1  ON 86
ci_0038                -1.119202e-02 3 1  ON 87
ci_0039                -2.531341e-03 3 1  ON 88
ci_0040                -2.764873e-03 3 1  ON 89
ci_0041                 6.635422e-03 3 1  ON 90
ci_0042                 7.330826e-03 3 1  ON 91
ci_0043                -1.945936e-02 3 1  ON 92
ci_0044                -1.898887e-02 3 1  ON 93
ci_0045                 7.486939e-03 3 1  ON 94
ci_0046                 7.409342e-03 3 1  ON 95
ci_0047                -1.552756e-03 3 1  ON 96
ci_0048                -1.862720e-03 3 1  ON 97
ci_0049                -5.340682e-03 3 1  ON 98
ci_0050                -5.918720e-03 3 1  ON 99
ci_0051                -3.616811e-03 3 1  ON 100
ci_0052                -3.395443e-03 3 1  ON 101
ci_0053                -4.479390e-03 3 1  ON 102
ci_0054                -4.333124e-03 3 1  ON 103
ci_0055                 6.387301e-03 3 1  ON 104
ci_0056                 6.304994e-03 3 1  ON 105
ci_0057                 4.732153e-03 3 1  ON 106
ci_0058                 4.835992e-03 3 1  ON 107
ci_0059                -4.599452e-03 3 1  ON 108
ci_0060                -4.623357e-03 3 1  ON 109
ci_0061                -4.533575e-03 3 1  ON 110
ci_0062                -3.762537e-03 3 1  ON 111
ci_0063                -9.154249e-03 3 1  ON 112
ci_0064                -8.246746e-03 3 1  ON 113
ci_0065                -5.045539e-03 3 1  ON 114
ci_0066                -5.119672e-03 3 1  ON 115
ci_0067                -5.300280e-03 3 1  ON 116
ci_0068                -4.972642e-03 3 1  ON 117
ci_0069                 4.619928e-03 3 1  ON 118
ci_0070                 4.549751e-03 3 1  ON 119
ci_0071                 5.484304e-04 3 1  ON 120
ci_0072                -4.143340e-04 3 1  ON 121
ci_0073                 4.247656e-03 3 1  ON 122
ci_0074                 4.074343e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.8954
    reference variance = 0.19908
====================================================
  Execution time = 2.1276e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3792e-01
  Total weights = 1.9518e+06
  Execution time = 1.9037e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324924395450
                                         uncertainty =       0.003617254843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324924395450
                                         uncertainty =       0.003617254843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403100819
  error estimate for blocks of size 2^( 2) =       0.000415970427
  error estimate for blocks of size 2^( 3) =       0.000429270517
  error estimate for blocks of size 2^( 4) =       0.000440972492
  error estimate for blocks of size 2^( 5) =       0.000451570465
  error estimate for blocks of size 2^( 6) =       0.000458013822
  error estimate for blocks of size 2^( 7) =       0.000463404574

      target function =                  N/A
              le_mean =     -16.906698758008
             les_mean =     286.174386445092
             stat err =       0.000453490338
             autocorr =       1.265635701592
              std dev =       0.570070644643
             le_variance =       0.324980539884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324924306474
                                         uncertainty =       0.003617214357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324924306474
                                         uncertainty =       0.003617214357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403100763
  error estimate for blocks of size 2^( 2) =       0.000415970372
  error estimate for blocks of size 2^( 3) =       0.000429270463
  error estimate for blocks of size 2^( 4) =       0.000440972437
  error estimate for blocks of size 2^( 5) =       0.000451570408
  error estimate for blocks of size 2^( 6) =       0.000458013767
  error estimate for blocks of size 2^( 7) =       0.000463404509

      target function =                  N/A
              le_mean =     -16.906698756937
             les_mean =     286.174386262191
             stat err =       0.000453490280
             autocorr =       1.265635727163
              std dev =       0.570070566158
             le_variance =       0.324980450400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324924350960
                                         uncertainty =       0.003617234599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324924350960
                                         uncertainty =       0.003617234599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403100791
  error estimate for blocks of size 2^( 2) =       0.000415970399
  error estimate for blocks of size 2^( 3) =       0.000429270490
  error estimate for blocks of size 2^( 4) =       0.000440972465
  error estimate for blocks of size 2^( 5) =       0.000451570436
  error estimate for blocks of size 2^( 6) =       0.000458013794
  error estimate for blocks of size 2^( 7) =       0.000463404542

      target function =                  N/A
              le_mean =     -16.906698757472
             les_mean =     286.174386353094
             stat err =       0.000453490309
             autocorr =       1.265635714380
              std dev =       0.570070605399
             le_variance =       0.324980495140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324924389889
                                         uncertainty =       0.003617252313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324924389889
                                         uncertainty =       0.003617252313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403100815
  error estimate for blocks of size 2^( 2) =       0.000415970424
  error estimate for blocks of size 2^( 3) =       0.000429270514
  error estimate for blocks of size 2^( 4) =       0.000440972488
  error estimate for blocks of size 2^( 5) =       0.000451570461
  error estimate for blocks of size 2^( 6) =       0.000458013818
  error estimate for blocks of size 2^( 7) =       0.000463404570

      target function =                  N/A
              le_mean =     -16.906698757941
             les_mean =     286.174386433531
             stat err =       0.000453490335
             autocorr =       1.265635703196
              std dev =       0.570070639738
             le_variance =       0.324980534291


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906698758008        initial  <--
     3.5527e+03     3.5527e+04             1.4029e-07       -16.906698756937
     1.4211e+04     1.4211e+05             3.5074e-08       -16.906698757472
     5.6843e+04     5.6843e+05             8.7687e-09       -16.906698757941

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8863
  </log>
  <optVariables href="H2O.s055.opt.xml">
   uu_0                 3.117505e-01 1 1  ON 0
   uu_1                 1.447374e-01 1 1  ON 1
   uu_2                 4.305853e-02 1 1  ON 2
   uu_3                -1.916522e-02 1 1  ON 3
   uu_4                -6.454582e-02 1 1  ON 4
   uu_5                -9.933147e-02 1 1  ON 5
   uu_6                -1.264827e-01 1 1  ON 6
   uu_7                -1.389788e-01 1 1  ON 7
   uu_8                -1.311512e-01 1 1  ON 8
   uu_9                -1.002751e-01 1 1  ON 9
   ud_0                 4.453608e-01 1 1  ON 10
   ud_1                 1.799293e-01 1 1  ON 11
   ud_2                 5.987661e-02 1 1  ON 12
   ud_3                -1.076791e-02 1 1  ON 13
   ud_4                -6.720153e-02 1 1  ON 14
   ud_5                -1.077666e-01 1 1  ON 15
   ud_6                -1.341361e-01 1 1  ON 16
   ud_7                -1.497574e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385807e-01 1 1  ON 19
   eO_0                -7.471040e-01 1 1  ON 20
   eO_1                -4.277001e-01 1 1  ON 21
   eO_2                -1.909305e-02 1 1  ON 22
   eO_3                 2.902564e-01 1 1  ON 23
   eO_4                 5.129973e-01 1 1  ON 24
   eO_5                 4.729039e-01 1 1  ON 25
   eO_6                 2.454333e-01 1 1  ON 26
   eO_7                -4.920484e-02 1 1  ON 27
   eO_8                -2.099791e-01 1 1  ON 28
   eO_9                -6.985072e-02 1 1  ON 29
  eH1_0                -2.490229e-01 1 1  ON 30
  eH1_1                -1.410010e-01 1 1  ON 31
  eH1_2                -9.187515e-02 1 1  ON 32
  eH1_3                -3.738769e-02 1 1  ON 33
  eH1_4                 1.162262e-02 1 1  ON 34
  eH1_5                 4.534949e-02 1 1  ON 35
  eH1_6                 1.014830e-01 1 1  ON 36
  eH1_7                 1.507940e-01 1 1  ON 37
  eH1_8                 1.645760e-01 1 1  ON 38
  eH1_9                 4.967943e-02 1 1  ON 39
  eH2_0                -2.461152e-01 1 1  ON 40
  eH2_1                -1.390225e-01 1 1  ON 41
  eH2_2                -8.956052e-02 1 1  ON 42
  eH2_3                -3.460184e-02 1 1  ON 43
  eH2_4                 1.430656e-02 1 1  ON 44
  eH2_5                 4.960896e-02 1 1  ON 45
  eH2_6                 1.052388e-01 1 1  ON 46
  eH2_7                 1.534300e-01 1 1  ON 47
  eH2_8                 1.693346e-01 1 1  ON 48
  eH2_9                 3.486317e-02 1 1  ON 49
ci_0001                 7.014435e-01 3 1  ON 50
ci_0002                 7.000942e-01 3 1  ON 51
ci_0003                -2.781658e-02 3 1  ON 52
ci_0004                -2.749117e-02 3 1  ON 53
ci_0005                -3.666418e-02 3 1  ON 54
ci_0006                -3.710037e-02 3 1  ON 55
ci_0007                -2.252163e-02 3 1  ON 56
ci_0008                -2.153984e-02 3 1  ON 57
ci_0009                -1.785452e-02 3 1  ON 58
ci_0010                -1.750947e-02 3 1  ON 59
ci_0011                -1.219950e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300448e-02 3 1  ON 62
ci_0014                 1.317666e-02 3 1  ON 63
ci_0015                 1.362739e-02 3 1  ON 64
ci_0016                 1.350328e-02 3 1  ON 65
ci_0017                 1.098672e-02 3 1  ON 66
ci_0018                 1.191524e-02 3 1  ON 67
ci_0019                 1.136336e-02 3 1  ON 68
ci_0020                 1.154497e-02 3 1  ON 69
ci_0021                -2.103486e-03 3 1  ON 70
ci_0022                -4.896311e-04 3 1  ON 71
ci_0023                -1.110360e-02 3 1  ON 72
ci_0024                -1.090672e-02 3 1  ON 73
ci_0025                -1.174556e-02 3 1  ON 74
ci_0026                -1.107509e-02 3 1  ON 75
ci_0027                -1.166387e-02 3 1  ON 76
ci_0028                -1.083237e-02 3 1  ON 77
ci_0029                -9.946221e-03 3 1  ON 78
ci_0030                -1.127085e-02 3 1  ON 79
ci_0031                 2.036766e-02 3 1  ON 80
ci_0032                 2.129731e-02 3 1  ON 81
ci_0033                 1.035270e-02 3 1  ON 82
ci_0034                 9.807730e-03 3 1  ON 83
ci_0035                 6.441899e-03 3 1  ON 84
ci_0036                 6.891684e-03 3 1  ON 85
ci_0037                -1.058463e-02 3 1  ON 86
ci_0038                -1.119201e-02 3 1  ON 87
ci_0039                -2.531333e-03 3 1  ON 88
ci_0040                -2.764879e-03 3 1  ON 89
ci_0041                 6.635400e-03 3 1  ON 90
ci_0042                 7.330839e-03 3 1  ON 91
ci_0043                -1.945935e-02 3 1  ON 92
ci_0044                -1.898888e-02 3 1  ON 93
ci_0045                 7.486942e-03 3 1  ON 94
ci_0046                 7.409336e-03 3 1  ON 95
ci_0047                -1.552747e-03 3 1  ON 96
ci_0048                -1.862719e-03 3 1  ON 97
ci_0049                -5.340671e-03 3 1  ON 98
ci_0050                -5.918750e-03 3 1  ON 99
ci_0051                -3.616818e-03 3 1  ON 100
ci_0052                -3.395436e-03 3 1  ON 101
ci_0053                -4.479385e-03 3 1  ON 102
ci_0054                -4.333110e-03 3 1  ON 103
ci_0055                 6.387308e-03 3 1  ON 104
ci_0056                 6.305002e-03 3 1  ON 105
ci_0057                 4.732152e-03 3 1  ON 106
ci_0058                 4.835978e-03 3 1  ON 107
ci_0059                -4.599452e-03 3 1  ON 108
ci_0060                -4.623327e-03 3 1  ON 109
ci_0061                -4.533598e-03 3 1  ON 110
ci_0062                -3.762525e-03 3 1  ON 111
ci_0063                -9.154262e-03 3 1  ON 112
ci_0064                -8.246743e-03 3 1  ON 113
ci_0065                -5.045520e-03 3 1  ON 114
ci_0066                -5.119659e-03 3 1  ON 115
ci_0067                -5.300296e-03 3 1  ON 116
ci_0068                -4.972651e-03 3 1  ON 117
ci_0069                 4.619932e-03 3 1  ON 118
ci_0070                 4.549767e-03 3 1  ON 119
ci_0071                 5.484445e-04 3 1  ON 120
ci_0072                -4.143417e-04 3 1  ON 121
ci_0073                 4.247651e-03 3 1  ON 122
ci_0074                 4.074324e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8524e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.8438
    reference variance = 0.498311
====================================================
  Execution time = 2.1645e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3573e-01
  Total weights = 1.951486483e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1940e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324149509209
                                         uncertainty =       0.002107126123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324149509209
                                         uncertainty =       0.002107126123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402560116
  error estimate for blocks of size 2^( 2) =       0.000415006164
  error estimate for blocks of size 2^( 3) =       0.000428229623
  error estimate for blocks of size 2^( 4) =       0.000440662219
  error estimate for blocks of size 2^( 5) =       0.000452415076
  error estimate for blocks of size 2^( 6) =       0.000461239070
  error estimate for blocks of size 2^( 7) =       0.000468018582

      target function =                  N/A
              le_mean =     -16.906786582619
             les_mean =     286.175162733184
             stat err =       0.000455583737
             autocorr =       1.280781175571
              std dev =       0.569305975450
             le_variance =       0.324109293683


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690678658262e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+04, overlap shift 3.5527e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906786582610       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906786582734       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906786582731       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906786582728       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906786582749       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906786582746       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906786582732       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906786582742       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906786582684       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906786582702       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.5527e+04 is 1.040807e-08

solving harmonic davidson linear method for identity shift 1.4211e+05, overlap shift 1.4211e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906786582610       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906786582641       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906786582641       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906786582644       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906786582625       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906786582643       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906786582312       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906786582281       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906786582593       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906786582353       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4211e+05 is 2.602035e-09

solving harmonic davidson linear method for identity shift 5.6843e+05, overlap shift 5.6843e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906786582610       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906786582618       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906786582618       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906786582620       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906786582316       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906786582580       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906786582610       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906786582921       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906786583193       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906786582428       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.6843e+05 is 6.505099e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.538077 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7847e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
   uu_0                 3.117505e-01 1 1  ON 0
   uu_1                 1.447374e-01 1 1  ON 1
   uu_2                 4.305853e-02 1 1  ON 2
   uu_3                -1.916522e-02 1 1  ON 3
   uu_4                -6.454582e-02 1 1  ON 4
   uu_5                -9.933147e-02 1 1  ON 5
   uu_6                -1.264827e-01 1 1  ON 6
   uu_7                -1.389788e-01 1 1  ON 7
   uu_8                -1.311512e-01 1 1  ON 8
   uu_9                -1.002751e-01 1 1  ON 9
   ud_0                 4.453608e-01 1 1  ON 10
   ud_1                 1.799293e-01 1 1  ON 11
   ud_2                 5.987661e-02 1 1  ON 12
   ud_3                -1.076791e-02 1 1  ON 13
   ud_4                -6.720153e-02 1 1  ON 14
   ud_5                -1.077666e-01 1 1  ON 15
   ud_6                -1.341361e-01 1 1  ON 16
   ud_7                -1.497574e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385807e-01 1 1  ON 19
   eO_0                -7.471040e-01 1 1  ON 20
   eO_1                -4.277001e-01 1 1  ON 21
   eO_2                -1.909305e-02 1 1  ON 22
   eO_3                 2.902564e-01 1 1  ON 23
   eO_4                 5.129973e-01 1 1  ON 24
   eO_5                 4.729039e-01 1 1  ON 25
   eO_6                 2.454333e-01 1 1  ON 26
   eO_7                -4.920484e-02 1 1  ON 27
   eO_8                -2.099791e-01 1 1  ON 28
   eO_9                -6.985072e-02 1 1  ON 29
  eH1_0                -2.490229e-01 1 1  ON 30
  eH1_1                -1.410010e-01 1 1  ON 31
  eH1_2                -9.187515e-02 1 1  ON 32
  eH1_3                -3.738769e-02 1 1  ON 33
  eH1_4                 1.162262e-02 1 1  ON 34
  eH1_5                 4.534949e-02 1 1  ON 35
  eH1_6                 1.014830e-01 1 1  ON 36
  eH1_7                 1.507940e-01 1 1  ON 37
  eH1_8                 1.645760e-01 1 1  ON 38
  eH1_9                 4.967943e-02 1 1  ON 39
  eH2_0                -2.461152e-01 1 1  ON 40
  eH2_1                -1.390225e-01 1 1  ON 41
  eH2_2                -8.956052e-02 1 1  ON 42
  eH2_3                -3.460184e-02 1 1  ON 43
  eH2_4                 1.430656e-02 1 1  ON 44
  eH2_5                 4.960896e-02 1 1  ON 45
  eH2_6                 1.052388e-01 1 1  ON 46
  eH2_7                 1.534300e-01 1 1  ON 47
  eH2_8                 1.693346e-01 1 1  ON 48
  eH2_9                 3.486317e-02 1 1  ON 49
ci_0001                 7.014435e-01 3 1  ON 50
ci_0002                 7.000942e-01 3 1  ON 51
ci_0003                -2.781658e-02 3 1  ON 52
ci_0004                -2.749117e-02 3 1  ON 53
ci_0005                -3.666418e-02 3 1  ON 54
ci_0006                -3.710037e-02 3 1  ON 55
ci_0007                -2.252162e-02 3 1  ON 56
ci_0008                -2.153984e-02 3 1  ON 57
ci_0009                -1.785452e-02 3 1  ON 58
ci_0010                -1.750947e-02 3 1  ON 59
ci_0011                -1.219950e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300448e-02 3 1  ON 62
ci_0014                 1.317666e-02 3 1  ON 63
ci_0015                 1.362739e-02 3 1  ON 64
ci_0016                 1.350328e-02 3 1  ON 65
ci_0017                 1.098672e-02 3 1  ON 66
ci_0018                 1.191524e-02 3 1  ON 67
ci_0019                 1.136336e-02 3 1  ON 68
ci_0020                 1.154497e-02 3 1  ON 69
ci_0021                -2.103487e-03 3 1  ON 70
ci_0022                -4.896310e-04 3 1  ON 71
ci_0023                -1.110360e-02 3 1  ON 72
ci_0024                -1.090672e-02 3 1  ON 73
ci_0025                -1.174556e-02 3 1  ON 74
ci_0026                -1.107509e-02 3 1  ON 75
ci_0027                -1.166387e-02 3 1  ON 76
ci_0028                -1.083237e-02 3 1  ON 77
ci_0029                -9.946221e-03 3 1  ON 78
ci_0030                -1.127085e-02 3 1  ON 79
ci_0031                 2.036766e-02 3 1  ON 80
ci_0032                 2.129731e-02 3 1  ON 81
ci_0033                 1.035271e-02 3 1  ON 82
ci_0034                 9.807732e-03 3 1  ON 83
ci_0035                 6.441900e-03 3 1  ON 84
ci_0036                 6.891683e-03 3 1  ON 85
ci_0037                -1.058463e-02 3 1  ON 86
ci_0038                -1.119201e-02 3 1  ON 87
ci_0039                -2.531333e-03 3 1  ON 88
ci_0040                -2.764878e-03 3 1  ON 89
ci_0041                 6.635400e-03 3 1  ON 90
ci_0042                 7.330837e-03 3 1  ON 91
ci_0043                -1.945935e-02 3 1  ON 92
ci_0044                -1.898888e-02 3 1  ON 93
ci_0045                 7.486942e-03 3 1  ON 94
ci_0046                 7.409337e-03 3 1  ON 95
ci_0047                -1.552746e-03 3 1  ON 96
ci_0048                -1.862719e-03 3 1  ON 97
ci_0049                -5.340671e-03 3 1  ON 98
ci_0050                -5.918750e-03 3 1  ON 99
ci_0051                -3.616817e-03 3 1  ON 100
ci_0052                -3.395437e-03 3 1  ON 101
ci_0053                -4.479385e-03 3 1  ON 102
ci_0054                -4.333111e-03 3 1  ON 103
ci_0055                 6.387308e-03 3 1  ON 104
ci_0056                 6.305001e-03 3 1  ON 105
ci_0057                 4.732152e-03 3 1  ON 106
ci_0058                 4.835975e-03 3 1  ON 107
ci_0059                -4.599454e-03 3 1  ON 108
ci_0060                -4.623327e-03 3 1  ON 109
ci_0061                -4.533597e-03 3 1  ON 110
ci_0062                -3.762524e-03 3 1  ON 111
ci_0063                -9.154262e-03 3 1  ON 112
ci_0064                -8.246745e-03 3 1  ON 113
ci_0065                -5.045522e-03 3 1  ON 114
ci_0066                -5.119660e-03 3 1  ON 115
ci_0067                -5.300295e-03 3 1  ON 116
ci_0068                -4.972650e-03 3 1  ON 117
ci_0069                 4.619932e-03 3 1  ON 118
ci_0070                 4.549766e-03 3 1  ON 119
ci_0071                 5.484448e-04 3 1  ON 120
ci_0072                -4.143412e-04 3 1  ON 121
ci_0073                 4.247650e-03 3 1  ON 122
ci_0074                 4.074325e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.9326
    reference variance = 0.290051
====================================================
  Execution time = 2.1615e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3834e-01
  Total weights = 1.9514e+06
  Execution time = 1.8941e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322871497841
                                         uncertainty =       0.002535822149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322871497841
                                         uncertainty =       0.002535822149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402082109
  error estimate for blocks of size 2^( 2) =       0.000415106997
  error estimate for blocks of size 2^( 3) =       0.000428823808
  error estimate for blocks of size 2^( 4) =       0.000441512294
  error estimate for blocks of size 2^( 5) =       0.000451962286
  error estimate for blocks of size 2^( 6) =       0.000459970171
  error estimate for blocks of size 2^( 7) =       0.000465377691

      target function =                  N/A
              le_mean =     -16.906051974678
             les_mean =     286.152932396118
             stat err =       0.000454705610
             autocorr =       1.278883923072
              std dev =       0.568629971360
             le_variance =       0.323340044329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322871496922
                                         uncertainty =       0.002535822337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322871496922
                                         uncertainty =       0.002535822337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402082108
  error estimate for blocks of size 2^( 2) =       0.000415106996
  error estimate for blocks of size 2^( 3) =       0.000428823807
  error estimate for blocks of size 2^( 4) =       0.000441512293
  error estimate for blocks of size 2^( 5) =       0.000451962285
  error estimate for blocks of size 2^( 6) =       0.000459970171
  error estimate for blocks of size 2^( 7) =       0.000465377690

      target function =                  N/A
              le_mean =     -16.906051974661
             les_mean =     286.152932381763
             stat err =       0.000454705610
             autocorr =       1.278883921635
              std dev =       0.568629970549
             le_variance =       0.323340043407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322871497382
                                         uncertainty =       0.002535822243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322871497382
                                         uncertainty =       0.002535822243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402082108
  error estimate for blocks of size 2^( 2) =       0.000415106997
  error estimate for blocks of size 2^( 3) =       0.000428823807
  error estimate for blocks of size 2^( 4) =       0.000441512293
  error estimate for blocks of size 2^( 5) =       0.000451962285
  error estimate for blocks of size 2^( 6) =       0.000459970171
  error estimate for blocks of size 2^( 7) =       0.000465377690

      target function =                  N/A
              le_mean =     -16.906051974669
             les_mean =     286.152932388940
             stat err =       0.000454705610
             autocorr =       1.278883922350
              std dev =       0.568629970955
             le_variance =       0.323340043868

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322871497784
                                         uncertainty =       0.002535822161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322871497784
                                         uncertainty =       0.002535822161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402082109
  error estimate for blocks of size 2^( 2) =       0.000415106997
  error estimate for blocks of size 2^( 3) =       0.000428823808
  error estimate for blocks of size 2^( 4) =       0.000441512294
  error estimate for blocks of size 2^( 5) =       0.000451962286
  error estimate for blocks of size 2^( 6) =       0.000459970171
  error estimate for blocks of size 2^( 7) =       0.000465377691

      target function =                  N/A
              le_mean =     -16.906051974677
             les_mean =     286.152932395221
             stat err =       0.000454705610
             autocorr =       1.278883922978
              std dev =       0.568629971310
             le_variance =       0.323340044272


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906051974678        initial  <--
     3.5527e+04     3.5527e+05             1.0408e-08       -16.906051974661
     1.4211e+05     1.4211e+06             2.6020e-09       -16.906051974669
     5.6843e+05     5.6843e+06             6.5051e-10       -16.906051974677

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.1731
  </log>
  <optVariables href="H2O.s056.opt.xml">
   uu_0                 3.117505e-01 1 1  ON 0
   uu_1                 1.447374e-01 1 1  ON 1
   uu_2                 4.305853e-02 1 1  ON 2
   uu_3                -1.916522e-02 1 1  ON 3
   uu_4                -6.454582e-02 1 1  ON 4
   uu_5                -9.933147e-02 1 1  ON 5
   uu_6                -1.264827e-01 1 1  ON 6
   uu_7                -1.389788e-01 1 1  ON 7
   uu_8                -1.311512e-01 1 1  ON 8
   uu_9                -1.002751e-01 1 1  ON 9
   ud_0                 4.453608e-01 1 1  ON 10
   ud_1                 1.799293e-01 1 1  ON 11
   ud_2                 5.987661e-02 1 1  ON 12
   ud_3                -1.076791e-02 1 1  ON 13
   ud_4                -6.720153e-02 1 1  ON 14
   ud_5                -1.077666e-01 1 1  ON 15
   ud_6                -1.341361e-01 1 1  ON 16
   ud_7                -1.497574e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385807e-01 1 1  ON 19
   eO_0                -7.471040e-01 1 1  ON 20
   eO_1                -4.277001e-01 1 1  ON 21
   eO_2                -1.909305e-02 1 1  ON 22
   eO_3                 2.902564e-01 1 1  ON 23
   eO_4                 5.129973e-01 1 1  ON 24
   eO_5                 4.729039e-01 1 1  ON 25
   eO_6                 2.454333e-01 1 1  ON 26
   eO_7                -4.920484e-02 1 1  ON 27
   eO_8                -2.099791e-01 1 1  ON 28
   eO_9                -6.985072e-02 1 1  ON 29
  eH1_0                -2.490229e-01 1 1  ON 30
  eH1_1                -1.410010e-01 1 1  ON 31
  eH1_2                -9.187515e-02 1 1  ON 32
  eH1_3                -3.738769e-02 1 1  ON 33
  eH1_4                 1.162262e-02 1 1  ON 34
  eH1_5                 4.534949e-02 1 1  ON 35
  eH1_6                 1.014830e-01 1 1  ON 36
  eH1_7                 1.507940e-01 1 1  ON 37
  eH1_8                 1.645760e-01 1 1  ON 38
  eH1_9                 4.967943e-02 1 1  ON 39
  eH2_0                -2.461152e-01 1 1  ON 40
  eH2_1                -1.390225e-01 1 1  ON 41
  eH2_2                -8.956052e-02 1 1  ON 42
  eH2_3                -3.460184e-02 1 1  ON 43
  eH2_4                 1.430656e-02 1 1  ON 44
  eH2_5                 4.960896e-02 1 1  ON 45
  eH2_6                 1.052388e-01 1 1  ON 46
  eH2_7                 1.534300e-01 1 1  ON 47
  eH2_8                 1.693346e-01 1 1  ON 48
  eH2_9                 3.486317e-02 1 1  ON 49
ci_0001                 7.014435e-01 3 1  ON 50
ci_0002                 7.000942e-01 3 1  ON 51
ci_0003                -2.781658e-02 3 1  ON 52
ci_0004                -2.749117e-02 3 1  ON 53
ci_0005                -3.666418e-02 3 1  ON 54
ci_0006                -3.710037e-02 3 1  ON 55
ci_0007                -2.252163e-02 3 1  ON 56
ci_0008                -2.153984e-02 3 1  ON 57
ci_0009                -1.785452e-02 3 1  ON 58
ci_0010                -1.750947e-02 3 1  ON 59
ci_0011                -1.219950e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300448e-02 3 1  ON 62
ci_0014                 1.317666e-02 3 1  ON 63
ci_0015                 1.362739e-02 3 1  ON 64
ci_0016                 1.350328e-02 3 1  ON 65
ci_0017                 1.098672e-02 3 1  ON 66
ci_0018                 1.191524e-02 3 1  ON 67
ci_0019                 1.136336e-02 3 1  ON 68
ci_0020                 1.154497e-02 3 1  ON 69
ci_0021                -2.103486e-03 3 1  ON 70
ci_0022                -4.896311e-04 3 1  ON 71
ci_0023                -1.110360e-02 3 1  ON 72
ci_0024                -1.090672e-02 3 1  ON 73
ci_0025                -1.174556e-02 3 1  ON 74
ci_0026                -1.107509e-02 3 1  ON 75
ci_0027                -1.166387e-02 3 1  ON 76
ci_0028                -1.083237e-02 3 1  ON 77
ci_0029                -9.946221e-03 3 1  ON 78
ci_0030                -1.127085e-02 3 1  ON 79
ci_0031                 2.036766e-02 3 1  ON 80
ci_0032                 2.129731e-02 3 1  ON 81
ci_0033                 1.035270e-02 3 1  ON 82
ci_0034                 9.807730e-03 3 1  ON 83
ci_0035                 6.441899e-03 3 1  ON 84
ci_0036                 6.891684e-03 3 1  ON 85
ci_0037                -1.058463e-02 3 1  ON 86
ci_0038                -1.119201e-02 3 1  ON 87
ci_0039                -2.531333e-03 3 1  ON 88
ci_0040                -2.764879e-03 3 1  ON 89
ci_0041                 6.635400e-03 3 1  ON 90
ci_0042                 7.330839e-03 3 1  ON 91
ci_0043                -1.945935e-02 3 1  ON 92
ci_0044                -1.898888e-02 3 1  ON 93
ci_0045                 7.486942e-03 3 1  ON 94
ci_0046                 7.409336e-03 3 1  ON 95
ci_0047                -1.552747e-03 3 1  ON 96
ci_0048                -1.862719e-03 3 1  ON 97
ci_0049                -5.340671e-03 3 1  ON 98
ci_0050                -5.918750e-03 3 1  ON 99
ci_0051                -3.616818e-03 3 1  ON 100
ci_0052                -3.395436e-03 3 1  ON 101
ci_0053                -4.479385e-03 3 1  ON 102
ci_0054                -4.333110e-03 3 1  ON 103
ci_0055                 6.387308e-03 3 1  ON 104
ci_0056                 6.305002e-03 3 1  ON 105
ci_0057                 4.732152e-03 3 1  ON 106
ci_0058                 4.835978e-03 3 1  ON 107
ci_0059                -4.599452e-03 3 1  ON 108
ci_0060                -4.623327e-03 3 1  ON 109
ci_0061                -4.533598e-03 3 1  ON 110
ci_0062                -3.762525e-03 3 1  ON 111
ci_0063                -9.154262e-03 3 1  ON 112
ci_0064                -8.246743e-03 3 1  ON 113
ci_0065                -5.045520e-03 3 1  ON 114
ci_0066                -5.119659e-03 3 1  ON 115
ci_0067                -5.300296e-03 3 1  ON 116
ci_0068                -4.972651e-03 3 1  ON 117
ci_0069                 4.619932e-03 3 1  ON 118
ci_0070                 4.549767e-03 3 1  ON 119
ci_0071                 5.484445e-04 3 1  ON 120
ci_0072                -4.143417e-04 3 1  ON 121
ci_0073                 4.247651e-03 3 1  ON 122
ci_0074                 4.074324e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9028e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.9157
    reference variance = 0.308141
====================================================
  Execution time = 2.1364e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3434e-01
  Total weights = 1.951477584e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0457e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322953014945
                                         uncertainty =       0.002719495517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322953014945
                                         uncertainty =       0.002719495517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401795526
  error estimate for blocks of size 2^( 2) =       0.000414466420
  error estimate for blocks of size 2^( 3) =       0.000427542520
  error estimate for blocks of size 2^( 4) =       0.000440084836
  error estimate for blocks of size 2^( 5) =       0.000450707542
  error estimate for blocks of size 2^( 6) =       0.000458412846
  error estimate for blocks of size 2^( 7) =       0.000463004039

      target function =                  N/A
              le_mean =     -16.906141208104
             les_mean =     286.151947878867
             stat err =       0.000453052316
             autocorr =       1.271412615412
              std dev =       0.568224681992
             le_variance =       0.322879289225


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690614120810e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+05, overlap shift 3.5527e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906141208107       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906141208118       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906141208118       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906141208201       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906141208132       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906141208118       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906141208014       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906141207921       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906141208103       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906141208471       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.5527e+05 is 1.656165e-09

solving harmonic davidson linear method for identity shift 1.4211e+06, overlap shift 1.4211e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906141208107       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906141208110       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906141208110       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906141208110       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906141208110       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906141208414       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906141208736       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906141207845       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906141208570       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906141208554       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4211e+06 is 4.140414e-10

solving harmonic davidson linear method for identity shift 5.6843e+06, overlap shift 5.6843e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906141208107       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906141208108       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906141208108       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906141209310       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906141207443       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906141209846       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906141208169       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906141207524       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906141201779       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906141207524       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.6843e+06 is 1.035105e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.541898 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7418e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
   uu_0                 3.117505e-01 1 1  ON 0
   uu_1                 1.447374e-01 1 1  ON 1
   uu_2                 4.305853e-02 1 1  ON 2
   uu_3                -1.916522e-02 1 1  ON 3
   uu_4                -6.454582e-02 1 1  ON 4
   uu_5                -9.933147e-02 1 1  ON 5
   uu_6                -1.264827e-01 1 1  ON 6
   uu_7                -1.389788e-01 1 1  ON 7
   uu_8                -1.311512e-01 1 1  ON 8
   uu_9                -1.002751e-01 1 1  ON 9
   ud_0                 4.453608e-01 1 1  ON 10
   ud_1                 1.799293e-01 1 1  ON 11
   ud_2                 5.987661e-02 1 1  ON 12
   ud_3                -1.076791e-02 1 1  ON 13
   ud_4                -6.720153e-02 1 1  ON 14
   ud_5                -1.077666e-01 1 1  ON 15
   ud_6                -1.341361e-01 1 1  ON 16
   ud_7                -1.497574e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385807e-01 1 1  ON 19
   eO_0                -7.471040e-01 1 1  ON 20
   eO_1                -4.277001e-01 1 1  ON 21
   eO_2                -1.909305e-02 1 1  ON 22
   eO_3                 2.902564e-01 1 1  ON 23
   eO_4                 5.129973e-01 1 1  ON 24
   eO_5                 4.729039e-01 1 1  ON 25
   eO_6                 2.454333e-01 1 1  ON 26
   eO_7                -4.920484e-02 1 1  ON 27
   eO_8                -2.099791e-01 1 1  ON 28
   eO_9                -6.985072e-02 1 1  ON 29
  eH1_0                -2.490229e-01 1 1  ON 30
  eH1_1                -1.410010e-01 1 1  ON 31
  eH1_2                -9.187515e-02 1 1  ON 32
  eH1_3                -3.738769e-02 1 1  ON 33
  eH1_4                 1.162262e-02 1 1  ON 34
  eH1_5                 4.534949e-02 1 1  ON 35
  eH1_6                 1.014830e-01 1 1  ON 36
  eH1_7                 1.507940e-01 1 1  ON 37
  eH1_8                 1.645760e-01 1 1  ON 38
  eH1_9                 4.967943e-02 1 1  ON 39
  eH2_0                -2.461152e-01 1 1  ON 40
  eH2_1                -1.390225e-01 1 1  ON 41
  eH2_2                -8.956052e-02 1 1  ON 42
  eH2_3                -3.460184e-02 1 1  ON 43
  eH2_4                 1.430656e-02 1 1  ON 44
  eH2_5                 4.960896e-02 1 1  ON 45
  eH2_6                 1.052388e-01 1 1  ON 46
  eH2_7                 1.534300e-01 1 1  ON 47
  eH2_8                 1.693346e-01 1 1  ON 48
  eH2_9                 3.486317e-02 1 1  ON 49
ci_0001                 7.014435e-01 3 1  ON 50
ci_0002                 7.000942e-01 3 1  ON 51
ci_0003                -2.781658e-02 3 1  ON 52
ci_0004                -2.749117e-02 3 1  ON 53
ci_0005                -3.666418e-02 3 1  ON 54
ci_0006                -3.710037e-02 3 1  ON 55
ci_0007                -2.252163e-02 3 1  ON 56
ci_0008                -2.153984e-02 3 1  ON 57
ci_0009                -1.785452e-02 3 1  ON 58
ci_0010                -1.750947e-02 3 1  ON 59
ci_0011                -1.219950e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300448e-02 3 1  ON 62
ci_0014                 1.317666e-02 3 1  ON 63
ci_0015                 1.362739e-02 3 1  ON 64
ci_0016                 1.350328e-02 3 1  ON 65
ci_0017                 1.098672e-02 3 1  ON 66
ci_0018                 1.191524e-02 3 1  ON 67
ci_0019                 1.136336e-02 3 1  ON 68
ci_0020                 1.154497e-02 3 1  ON 69
ci_0021                -2.103486e-03 3 1  ON 70
ci_0022                -4.896311e-04 3 1  ON 71
ci_0023                -1.110360e-02 3 1  ON 72
ci_0024                -1.090672e-02 3 1  ON 73
ci_0025                -1.174556e-02 3 1  ON 74
ci_0026                -1.107509e-02 3 1  ON 75
ci_0027                -1.166387e-02 3 1  ON 76
ci_0028                -1.083237e-02 3 1  ON 77
ci_0029                -9.946221e-03 3 1  ON 78
ci_0030                -1.127085e-02 3 1  ON 79
ci_0031                 2.036766e-02 3 1  ON 80
ci_0032                 2.129731e-02 3 1  ON 81
ci_0033                 1.035270e-02 3 1  ON 82
ci_0034                 9.807730e-03 3 1  ON 83
ci_0035                 6.441899e-03 3 1  ON 84
ci_0036                 6.891684e-03 3 1  ON 85
ci_0037                -1.058463e-02 3 1  ON 86
ci_0038                -1.119201e-02 3 1  ON 87
ci_0039                -2.531333e-03 3 1  ON 88
ci_0040                -2.764879e-03 3 1  ON 89
ci_0041                 6.635400e-03 3 1  ON 90
ci_0042                 7.330839e-03 3 1  ON 91
ci_0043                -1.945935e-02 3 1  ON 92
ci_0044                -1.898888e-02 3 1  ON 93
ci_0045                 7.486942e-03 3 1  ON 94
ci_0046                 7.409336e-03 3 1  ON 95
ci_0047                -1.552747e-03 3 1  ON 96
ci_0048                -1.862719e-03 3 1  ON 97
ci_0049                -5.340671e-03 3 1  ON 98
ci_0050                -5.918750e-03 3 1  ON 99
ci_0051                -3.616818e-03 3 1  ON 100
ci_0052                -3.395436e-03 3 1  ON 101
ci_0053                -4.479385e-03 3 1  ON 102
ci_0054                -4.333110e-03 3 1  ON 103
ci_0055                 6.387308e-03 3 1  ON 104
ci_0056                 6.305002e-03 3 1  ON 105
ci_0057                 4.732152e-03 3 1  ON 106
ci_0058                 4.835978e-03 3 1  ON 107
ci_0059                -4.599452e-03 3 1  ON 108
ci_0060                -4.623327e-03 3 1  ON 109
ci_0061                -4.533598e-03 3 1  ON 110
ci_0062                -3.762525e-03 3 1  ON 111
ci_0063                -9.154261e-03 3 1  ON 112
ci_0064                -8.246743e-03 3 1  ON 113
ci_0065                -5.045520e-03 3 1  ON 114
ci_0066                -5.119659e-03 3 1  ON 115
ci_0067                -5.300296e-03 3 1  ON 116
ci_0068                -4.972651e-03 3 1  ON 117
ci_0069                 4.619932e-03 3 1  ON 118
ci_0070                 4.549767e-03 3 1  ON 119
ci_0071                 5.484445e-04 3 1  ON 120
ci_0072                -4.143415e-04 3 1  ON 121
ci_0073                 4.247651e-03 3 1  ON 122
ci_0074                 4.074324e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.8461
    reference variance = 0.235611
====================================================
  Execution time = 2.3175e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2999e-01
  Total weights = 1.9519e+06
  Execution time = 1.8950e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318874671163
                                         uncertainty =       0.002031679413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318874671163
                                         uncertainty =       0.002031679413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399254720
  error estimate for blocks of size 2^( 2) =       0.000412338329
  error estimate for blocks of size 2^( 3) =       0.000425617499
  error estimate for blocks of size 2^( 4) =       0.000437746798
  error estimate for blocks of size 2^( 5) =       0.000447837406
  error estimate for blocks of size 2^( 6) =       0.000453602586
  error estimate for blocks of size 2^( 7) =       0.000456744052

      target function =                  N/A
              le_mean =     -16.906263779555
             les_mean =     286.151744393292
             stat err =       0.000448982710
             autocorr =       1.264617292278
              std dev =       0.564631440254
             le_variance =       0.318808663323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318874671174
                                         uncertainty =       0.002031679418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318874671174
                                         uncertainty =       0.002031679418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399254720
  error estimate for blocks of size 2^( 2) =       0.000412338329
  error estimate for blocks of size 2^( 3) =       0.000425617499
  error estimate for blocks of size 2^( 4) =       0.000437746798
  error estimate for blocks of size 2^( 5) =       0.000447837406
  error estimate for blocks of size 2^( 6) =       0.000453602586
  error estimate for blocks of size 2^( 7) =       0.000456744052

      target function =                  N/A
              le_mean =     -16.906263779556
             les_mean =     286.151744408897
             stat err =       0.000448982710
             autocorr =       1.264617291752
              std dev =       0.564631440264
             le_variance =       0.318808663334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318874671168
                                         uncertainty =       0.002031679416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318874671168
                                         uncertainty =       0.002031679416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399254720
  error estimate for blocks of size 2^( 2) =       0.000412338329
  error estimate for blocks of size 2^( 3) =       0.000425617499
  error estimate for blocks of size 2^( 4) =       0.000437746798
  error estimate for blocks of size 2^( 5) =       0.000447837406
  error estimate for blocks of size 2^( 6) =       0.000453602586
  error estimate for blocks of size 2^( 7) =       0.000456744052

      target function =                  N/A
              le_mean =     -16.906263779555
             les_mean =     286.151744401094
             stat err =       0.000448982710
             autocorr =       1.264617292013
              std dev =       0.564631440259
             le_variance =       0.318808663329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318874671163
                                         uncertainty =       0.002031679414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318874671163
                                         uncertainty =       0.002031679414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399254720
  error estimate for blocks of size 2^( 2) =       0.000412338329
  error estimate for blocks of size 2^( 3) =       0.000425617499
  error estimate for blocks of size 2^( 4) =       0.000437746798
  error estimate for blocks of size 2^( 5) =       0.000447837406
  error estimate for blocks of size 2^( 6) =       0.000453602586
  error estimate for blocks of size 2^( 7) =       0.000456744052

      target function =                  N/A
              le_mean =     -16.906263779555
             les_mean =     286.151744394267
             stat err =       0.000448982710
             autocorr =       1.264617292244
              std dev =       0.564631440254
             le_variance =       0.318808663324


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906263779555        initial
     3.5527e+05     3.5527e+06             1.6562e-09       -16.906263779556  <--
     1.4211e+06     1.4211e+07             4.1404e-10       -16.906263779555
     5.6843e+06     5.6843e+07             1.0351e-10       -16.906263779555

*****************************************************************************
Applying the update for shift_i =   3.5527e+05     and shift_s =   3.5527e+06
*****************************************************************************

  Execution time = 3.2749e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
   uu_0                 3.117505e-01 1 1  ON 0
   uu_1                 1.447374e-01 1 1  ON 1
   uu_2                 4.305853e-02 1 1  ON 2
   uu_3                -1.916522e-02 1 1  ON 3
   uu_4                -6.454582e-02 1 1  ON 4
   uu_5                -9.933147e-02 1 1  ON 5
   uu_6                -1.264827e-01 1 1  ON 6
   uu_7                -1.389788e-01 1 1  ON 7
   uu_8                -1.311512e-01 1 1  ON 8
   uu_9                -1.002751e-01 1 1  ON 9
   ud_0                 4.453608e-01 1 1  ON 10
   ud_1                 1.799293e-01 1 1  ON 11
   ud_2                 5.987661e-02 1 1  ON 12
   ud_3                -1.076791e-02 1 1  ON 13
   ud_4                -6.720153e-02 1 1  ON 14
   ud_5                -1.077666e-01 1 1  ON 15
   ud_6                -1.341361e-01 1 1  ON 16
   ud_7                -1.497574e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385807e-01 1 1  ON 19
   eO_0                -7.471040e-01 1 1  ON 20
   eO_1                -4.277001e-01 1 1  ON 21
   eO_2                -1.909305e-02 1 1  ON 22
   eO_3                 2.902564e-01 1 1  ON 23
   eO_4                 5.129973e-01 1 1  ON 24
   eO_5                 4.729039e-01 1 1  ON 25
   eO_6                 2.454333e-01 1 1  ON 26
   eO_7                -4.920484e-02 1 1  ON 27
   eO_8                -2.099791e-01 1 1  ON 28
   eO_9                -6.985072e-02 1 1  ON 29
  eH1_0                -2.490229e-01 1 1  ON 30
  eH1_1                -1.410010e-01 1 1  ON 31
  eH1_2                -9.187515e-02 1 1  ON 32
  eH1_3                -3.738769e-02 1 1  ON 33
  eH1_4                 1.162262e-02 1 1  ON 34
  eH1_5                 4.534949e-02 1 1  ON 35
  eH1_6                 1.014830e-01 1 1  ON 36
  eH1_7                 1.507940e-01 1 1  ON 37
  eH1_8                 1.645760e-01 1 1  ON 38
  eH1_9                 4.967943e-02 1 1  ON 39
  eH2_0                -2.461152e-01 1 1  ON 40
  eH2_1                -1.390225e-01 1 1  ON 41
  eH2_2                -8.956052e-02 1 1  ON 42
  eH2_3                -3.460184e-02 1 1  ON 43
  eH2_4                 1.430656e-02 1 1  ON 44
  eH2_5                 4.960896e-02 1 1  ON 45
  eH2_6                 1.052388e-01 1 1  ON 46
  eH2_7                 1.534300e-01 1 1  ON 47
  eH2_8                 1.693346e-01 1 1  ON 48
  eH2_9                 3.486317e-02 1 1  ON 49
ci_0001                 7.014435e-01 3 1  ON 50
ci_0002                 7.000942e-01 3 1  ON 51
ci_0003                -2.781658e-02 3 1  ON 52
ci_0004                -2.749117e-02 3 1  ON 53
ci_0005                -3.666418e-02 3 1  ON 54
ci_0006                -3.710037e-02 3 1  ON 55
ci_0007                -2.252163e-02 3 1  ON 56
ci_0008                -2.153984e-02 3 1  ON 57
ci_0009                -1.785452e-02 3 1  ON 58
ci_0010                -1.750947e-02 3 1  ON 59
ci_0011                -1.219950e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300448e-02 3 1  ON 62
ci_0014                 1.317666e-02 3 1  ON 63
ci_0015                 1.362739e-02 3 1  ON 64
ci_0016                 1.350328e-02 3 1  ON 65
ci_0017                 1.098672e-02 3 1  ON 66
ci_0018                 1.191524e-02 3 1  ON 67
ci_0019                 1.136336e-02 3 1  ON 68
ci_0020                 1.154497e-02 3 1  ON 69
ci_0021                -2.103486e-03 3 1  ON 70
ci_0022                -4.896312e-04 3 1  ON 71
ci_0023                -1.110360e-02 3 1  ON 72
ci_0024                -1.090672e-02 3 1  ON 73
ci_0025                -1.174556e-02 3 1  ON 74
ci_0026                -1.107509e-02 3 1  ON 75
ci_0027                -1.166387e-02 3 1  ON 76
ci_0028                -1.083237e-02 3 1  ON 77
ci_0029                -9.946221e-03 3 1  ON 78
ci_0030                -1.127085e-02 3 1  ON 79
ci_0031                 2.036766e-02 3 1  ON 80
ci_0032                 2.129731e-02 3 1  ON 81
ci_0033                 1.035270e-02 3 1  ON 82
ci_0034                 9.807730e-03 3 1  ON 83
ci_0035                 6.441899e-03 3 1  ON 84
ci_0036                 6.891684e-03 3 1  ON 85
ci_0037                -1.058463e-02 3 1  ON 86
ci_0038                -1.119201e-02 3 1  ON 87
ci_0039                -2.531333e-03 3 1  ON 88
ci_0040                -2.764878e-03 3 1  ON 89
ci_0041                 6.635400e-03 3 1  ON 90
ci_0042                 7.330838e-03 3 1  ON 91
ci_0043                -1.945935e-02 3 1  ON 92
ci_0044                -1.898888e-02 3 1  ON 93
ci_0045                 7.486942e-03 3 1  ON 94
ci_0046                 7.409335e-03 3 1  ON 95
ci_0047                -1.552747e-03 3 1  ON 96
ci_0048                -1.862719e-03 3 1  ON 97
ci_0049                -5.340671e-03 3 1  ON 98
ci_0050                -5.918750e-03 3 1  ON 99
ci_0051                -3.616818e-03 3 1  ON 100
ci_0052                -3.395437e-03 3 1  ON 101
ci_0053                -4.479386e-03 3 1  ON 102
ci_0054                -4.333110e-03 3 1  ON 103
ci_0055                 6.387308e-03 3 1  ON 104
ci_0056                 6.305002e-03 3 1  ON 105
ci_0057                 4.732152e-03 3 1  ON 106
ci_0058                 4.835978e-03 3 1  ON 107
ci_0059                -4.599452e-03 3 1  ON 108
ci_0060                -4.623326e-03 3 1  ON 109
ci_0061                -4.533598e-03 3 1  ON 110
ci_0062                -3.762525e-03 3 1  ON 111
ci_0063                -9.154261e-03 3 1  ON 112
ci_0064                -8.246745e-03 3 1  ON 113
ci_0065                -5.045520e-03 3 1  ON 114
ci_0066                -5.119658e-03 3 1  ON 115
ci_0067                -5.300296e-03 3 1  ON 116
ci_0068                -4.972650e-03 3 1  ON 117
ci_0069                 4.619932e-03 3 1  ON 118
ci_0070                 4.549768e-03 3 1  ON 119
ci_0071                 5.484445e-04 3 1  ON 120
ci_0072                -4.143411e-04 3 1  ON 121
ci_0073                 4.247651e-03 3 1  ON 122
ci_0074                 4.074324e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0174e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.9919
    reference variance = 0.311291
====================================================
  Execution time = 2.1522e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4272e-01
  Total weights = 1.951777399e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1190e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328178870178
                                         uncertainty =       0.005749874100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328178870178
                                         uncertainty =       0.005749874100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405043406
  error estimate for blocks of size 2^( 2) =       0.000418958578
  error estimate for blocks of size 2^( 3) =       0.000432234883
  error estimate for blocks of size 2^( 4) =       0.000445281236
  error estimate for blocks of size 2^( 5) =       0.000456555918
  error estimate for blocks of size 2^( 6) =       0.000463789785
  error estimate for blocks of size 2^( 7) =       0.000467431880

      target function =                  N/A
              le_mean =     -16.906141112996
             les_mean =     286.160322674974
             stat err =       0.000458264705
             autocorr =       1.280058110763
              std dev =       0.572817878209
             le_variance =       0.328120321596


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690614111300e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+04, overlap shift 8.8818e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906141112993       residual = 7.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906141112920       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906141112910       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906141112911       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906141112955       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906141112947       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906141112895       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906141112940       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906141112996       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906141113140       residual = 7.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.8818e+04 is 1.782541e-08

solving harmonic davidson linear method for identity shift 3.5527e+05, overlap shift 3.5527e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906141112993       residual = 7.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906141112975       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906141112973       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906141112973       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906141112957       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906141112049       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906141109413       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906141112913       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906141112890       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906141112605       residual = 7.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.5527e+05 is 4.456360e-09

solving harmonic davidson linear method for identity shift 1.4211e+06, overlap shift 1.4211e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906141112993       residual = 7.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906141112989       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906141112988       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906141112988       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906141111721       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906141113262       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906141112474       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906141113874       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906141111825       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906141111176       residual = 7.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4211e+06 is 1.114091e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.545734 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7649e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
   uu_0                 3.117505e-01 1 1  ON 0
   uu_1                 1.447374e-01 1 1  ON 1
   uu_2                 4.305853e-02 1 1  ON 2
   uu_3                -1.916522e-02 1 1  ON 3
   uu_4                -6.454582e-02 1 1  ON 4
   uu_5                -9.933147e-02 1 1  ON 5
   uu_6                -1.264827e-01 1 1  ON 6
   uu_7                -1.389788e-01 1 1  ON 7
   uu_8                -1.311512e-01 1 1  ON 8
   uu_9                -1.002751e-01 1 1  ON 9
   ud_0                 4.453608e-01 1 1  ON 10
   ud_1                 1.799293e-01 1 1  ON 11
   ud_2                 5.987661e-02 1 1  ON 12
   ud_3                -1.076791e-02 1 1  ON 13
   ud_4                -6.720153e-02 1 1  ON 14
   ud_5                -1.077666e-01 1 1  ON 15
   ud_6                -1.341361e-01 1 1  ON 16
   ud_7                -1.497574e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385807e-01 1 1  ON 19
   eO_0                -7.471040e-01 1 1  ON 20
   eO_1                -4.277001e-01 1 1  ON 21
   eO_2                -1.909305e-02 1 1  ON 22
   eO_3                 2.902564e-01 1 1  ON 23
   eO_4                 5.129973e-01 1 1  ON 24
   eO_5                 4.729039e-01 1 1  ON 25
   eO_6                 2.454333e-01 1 1  ON 26
   eO_7                -4.920484e-02 1 1  ON 27
   eO_8                -2.099791e-01 1 1  ON 28
   eO_9                -6.985072e-02 1 1  ON 29
  eH1_0                -2.490229e-01 1 1  ON 30
  eH1_1                -1.410010e-01 1 1  ON 31
  eH1_2                -9.187515e-02 1 1  ON 32
  eH1_3                -3.738769e-02 1 1  ON 33
  eH1_4                 1.162262e-02 1 1  ON 34
  eH1_5                 4.534949e-02 1 1  ON 35
  eH1_6                 1.014830e-01 1 1  ON 36
  eH1_7                 1.507940e-01 1 1  ON 37
  eH1_8                 1.645760e-01 1 1  ON 38
  eH1_9                 4.967943e-02 1 1  ON 39
  eH2_0                -2.461152e-01 1 1  ON 40
  eH2_1                -1.390225e-01 1 1  ON 41
  eH2_2                -8.956052e-02 1 1  ON 42
  eH2_3                -3.460184e-02 1 1  ON 43
  eH2_4                 1.430656e-02 1 1  ON 44
  eH2_5                 4.960896e-02 1 1  ON 45
  eH2_6                 1.052388e-01 1 1  ON 46
  eH2_7                 1.534300e-01 1 1  ON 47
  eH2_8                 1.693346e-01 1 1  ON 48
  eH2_9                 3.486317e-02 1 1  ON 49
ci_0001                 7.014435e-01 3 1  ON 50
ci_0002                 7.000942e-01 3 1  ON 51
ci_0003                -2.781658e-02 3 1  ON 52
ci_0004                -2.749117e-02 3 1  ON 53
ci_0005                -3.666418e-02 3 1  ON 54
ci_0006                -3.710036e-02 3 1  ON 55
ci_0007                -2.252163e-02 3 1  ON 56
ci_0008                -2.153984e-02 3 1  ON 57
ci_0009                -1.785452e-02 3 1  ON 58
ci_0010                -1.750947e-02 3 1  ON 59
ci_0011                -1.219950e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300448e-02 3 1  ON 62
ci_0014                 1.317666e-02 3 1  ON 63
ci_0015                 1.362739e-02 3 1  ON 64
ci_0016                 1.350328e-02 3 1  ON 65
ci_0017                 1.098672e-02 3 1  ON 66
ci_0018                 1.191524e-02 3 1  ON 67
ci_0019                 1.136336e-02 3 1  ON 68
ci_0020                 1.154497e-02 3 1  ON 69
ci_0021                -2.103486e-03 3 1  ON 70
ci_0022                -4.896316e-04 3 1  ON 71
ci_0023                -1.110360e-02 3 1  ON 72
ci_0024                -1.090672e-02 3 1  ON 73
ci_0025                -1.174555e-02 3 1  ON 74
ci_0026                -1.107509e-02 3 1  ON 75
ci_0027                -1.166387e-02 3 1  ON 76
ci_0028                -1.083237e-02 3 1  ON 77
ci_0029                -9.946222e-03 3 1  ON 78
ci_0030                -1.127085e-02 3 1  ON 79
ci_0031                 2.036766e-02 3 1  ON 80
ci_0032                 2.129731e-02 3 1  ON 81
ci_0033                 1.035270e-02 3 1  ON 82
ci_0034                 9.807730e-03 3 1  ON 83
ci_0035                 6.441900e-03 3 1  ON 84
ci_0036                 6.891684e-03 3 1  ON 85
ci_0037                -1.058463e-02 3 1  ON 86
ci_0038                -1.119201e-02 3 1  ON 87
ci_0039                -2.531332e-03 3 1  ON 88
ci_0040                -2.764878e-03 3 1  ON 89
ci_0041                 6.635400e-03 3 1  ON 90
ci_0042                 7.330838e-03 3 1  ON 91
ci_0043                -1.945935e-02 3 1  ON 92
ci_0044                -1.898888e-02 3 1  ON 93
ci_0045                 7.486942e-03 3 1  ON 94
ci_0046                 7.409336e-03 3 1  ON 95
ci_0047                -1.552749e-03 3 1  ON 96
ci_0048                -1.862719e-03 3 1  ON 97
ci_0049                -5.340673e-03 3 1  ON 98
ci_0050                -5.918755e-03 3 1  ON 99
ci_0051                -3.616817e-03 3 1  ON 100
ci_0052                -3.395437e-03 3 1  ON 101
ci_0053                -4.479386e-03 3 1  ON 102
ci_0054                -4.333110e-03 3 1  ON 103
ci_0055                 6.387310e-03 3 1  ON 104
ci_0056                 6.305002e-03 3 1  ON 105
ci_0057                 4.732153e-03 3 1  ON 106
ci_0058                 4.835977e-03 3 1  ON 107
ci_0059                -4.599452e-03 3 1  ON 108
ci_0060                -4.623326e-03 3 1  ON 109
ci_0061                -4.533598e-03 3 1  ON 110
ci_0062                -3.762525e-03 3 1  ON 111
ci_0063                -9.154260e-03 3 1  ON 112
ci_0064                -8.246744e-03 3 1  ON 113
ci_0065                -5.045520e-03 3 1  ON 114
ci_0066                -5.119659e-03 3 1  ON 115
ci_0067                -5.300296e-03 3 1  ON 116
ci_0068                -4.972650e-03 3 1  ON 117
ci_0069                 4.619932e-03 3 1  ON 118
ci_0070                 4.549767e-03 3 1  ON 119
ci_0071                 5.484422e-04 3 1  ON 120
ci_0072                -4.143405e-04 3 1  ON 121
ci_0073                 4.247651e-03 3 1  ON 122
ci_0074                 4.074323e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.9047
    reference variance = 0.631174
====================================================
  Execution time = 2.1530e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3927e-01
  Total weights = 1.9515e+06
  Execution time = 1.8944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322138492629
                                         uncertainty =       0.002624949914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322138492629
                                         uncertainty =       0.002624949914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401348261
  error estimate for blocks of size 2^( 2) =       0.000414266755
  error estimate for blocks of size 2^( 3) =       0.000427935240
  error estimate for blocks of size 2^( 4) =       0.000440524806
  error estimate for blocks of size 2^( 5) =       0.000452340605
  error estimate for blocks of size 2^( 6) =       0.000461167069
  error estimate for blocks of size 2^( 7) =       0.000467803523

      target function =                  N/A
              le_mean =     -16.906573138847
             les_mean =     286.171484067834
             stat err =       0.000455459001
             autocorr =       1.287821903401
              std dev =       0.567592153600
             le_variance =       0.322160852829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322138491766
                                         uncertainty =       0.002624948403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322138491766
                                         uncertainty =       0.002624948403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401348260
  error estimate for blocks of size 2^( 2) =       0.000414266755
  error estimate for blocks of size 2^( 3) =       0.000427935239
  error estimate for blocks of size 2^( 4) =       0.000440524805
  error estimate for blocks of size 2^( 5) =       0.000452340604
  error estimate for blocks of size 2^( 6) =       0.000461167068
  error estimate for blocks of size 2^( 7) =       0.000467803522

      target function =                  N/A
              le_mean =     -16.906573138902
             les_mean =     286.171484105606
             stat err =       0.000455459000
             autocorr =       1.287821901381
              std dev =       0.567592152842
             le_variance =       0.322160851968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322138492198
                                         uncertainty =       0.002624949158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322138492198
                                         uncertainty =       0.002624949158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401348260
  error estimate for blocks of size 2^( 2) =       0.000414266755
  error estimate for blocks of size 2^( 3) =       0.000427935239
  error estimate for blocks of size 2^( 4) =       0.000440524805
  error estimate for blocks of size 2^( 5) =       0.000452340605
  error estimate for blocks of size 2^( 6) =       0.000461167069
  error estimate for blocks of size 2^( 7) =       0.000467803522

      target function =                  N/A
              le_mean =     -16.906573138875
             les_mean =     286.171484086720
             stat err =       0.000455459000
             autocorr =       1.287821902391
              std dev =       0.567592153221
             le_variance =       0.322160852398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322138492575
                                         uncertainty =       0.002624949819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322138492575
                                         uncertainty =       0.002624949819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401348261
  error estimate for blocks of size 2^( 2) =       0.000414266755
  error estimate for blocks of size 2^( 3) =       0.000427935240
  error estimate for blocks of size 2^( 4) =       0.000440524806
  error estimate for blocks of size 2^( 5) =       0.000452340605
  error estimate for blocks of size 2^( 6) =       0.000461167069
  error estimate for blocks of size 2^( 7) =       0.000467803523

      target function =                  N/A
              le_mean =     -16.906573138851
             les_mean =     286.171484070195
             stat err =       0.000455459001
             autocorr =       1.287821903275
              std dev =       0.567592153553
             le_variance =       0.322160852775


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906573138847        initial
     8.8818e+04     8.8818e+05             1.7825e-08       -16.906573138902  <--
     3.5527e+05     3.5527e+06             4.4564e-09       -16.906573138875
     1.4211e+06     1.4211e+07             1.1141e-09       -16.906573138851

*****************************************************************************
Applying the update for shift_i =   8.8818e+04     and shift_s =   8.8818e+05
*****************************************************************************

  Execution time = 3.1094e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
   uu_0                 3.117505e-01 1 1  ON 0
   uu_1                 1.447374e-01 1 1  ON 1
   uu_2                 4.305853e-02 1 1  ON 2
   uu_3                -1.916522e-02 1 1  ON 3
   uu_4                -6.454582e-02 1 1  ON 4
   uu_5                -9.933147e-02 1 1  ON 5
   uu_6                -1.264827e-01 1 1  ON 6
   uu_7                -1.389788e-01 1 1  ON 7
   uu_8                -1.311512e-01 1 1  ON 8
   uu_9                -1.002751e-01 1 1  ON 9
   ud_0                 4.453608e-01 1 1  ON 10
   ud_1                 1.799293e-01 1 1  ON 11
   ud_2                 5.987661e-02 1 1  ON 12
   ud_3                -1.076791e-02 1 1  ON 13
   ud_4                -6.720153e-02 1 1  ON 14
   ud_5                -1.077666e-01 1 1  ON 15
   ud_6                -1.341361e-01 1 1  ON 16
   ud_7                -1.497574e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385807e-01 1 1  ON 19
   eO_0                -7.471040e-01 1 1  ON 20
   eO_1                -4.277001e-01 1 1  ON 21
   eO_2                -1.909305e-02 1 1  ON 22
   eO_3                 2.902564e-01 1 1  ON 23
   eO_4                 5.129973e-01 1 1  ON 24
   eO_5                 4.729039e-01 1 1  ON 25
   eO_6                 2.454333e-01 1 1  ON 26
   eO_7                -4.920484e-02 1 1  ON 27
   eO_8                -2.099791e-01 1 1  ON 28
   eO_9                -6.985073e-02 1 1  ON 29
  eH1_0                -2.490229e-01 1 1  ON 30
  eH1_1                -1.410010e-01 1 1  ON 31
  eH1_2                -9.187515e-02 1 1  ON 32
  eH1_3                -3.738769e-02 1 1  ON 33
  eH1_4                 1.162262e-02 1 1  ON 34
  eH1_5                 4.534949e-02 1 1  ON 35
  eH1_6                 1.014830e-01 1 1  ON 36
  eH1_7                 1.507940e-01 1 1  ON 37
  eH1_8                 1.645760e-01 1 1  ON 38
  eH1_9                 4.967943e-02 1 1  ON 39
  eH2_0                -2.461152e-01 1 1  ON 40
  eH2_1                -1.390225e-01 1 1  ON 41
  eH2_2                -8.956052e-02 1 1  ON 42
  eH2_3                -3.460184e-02 1 1  ON 43
  eH2_4                 1.430656e-02 1 1  ON 44
  eH2_5                 4.960896e-02 1 1  ON 45
  eH2_6                 1.052388e-01 1 1  ON 46
  eH2_7                 1.534300e-01 1 1  ON 47
  eH2_8                 1.693346e-01 1 1  ON 48
  eH2_9                 3.486317e-02 1 1  ON 49
ci_0001                 7.014435e-01 3 1  ON 50
ci_0002                 7.000942e-01 3 1  ON 51
ci_0003                -2.781658e-02 3 1  ON 52
ci_0004                -2.749117e-02 3 1  ON 53
ci_0005                -3.666418e-02 3 1  ON 54
ci_0006                -3.710036e-02 3 1  ON 55
ci_0007                -2.252162e-02 3 1  ON 56
ci_0008                -2.153984e-02 3 1  ON 57
ci_0009                -1.785451e-02 3 1  ON 58
ci_0010                -1.750947e-02 3 1  ON 59
ci_0011                -1.219950e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300448e-02 3 1  ON 62
ci_0014                 1.317666e-02 3 1  ON 63
ci_0015                 1.362739e-02 3 1  ON 64
ci_0016                 1.350328e-02 3 1  ON 65
ci_0017                 1.098672e-02 3 1  ON 66
ci_0018                 1.191524e-02 3 1  ON 67
ci_0019                 1.136336e-02 3 1  ON 68
ci_0020                 1.154497e-02 3 1  ON 69
ci_0021                -2.103487e-03 3 1  ON 70
ci_0022                -4.896330e-04 3 1  ON 71
ci_0023                -1.110360e-02 3 1  ON 72
ci_0024                -1.090672e-02 3 1  ON 73
ci_0025                -1.174555e-02 3 1  ON 74
ci_0026                -1.107509e-02 3 1  ON 75
ci_0027                -1.166387e-02 3 1  ON 76
ci_0028                -1.083237e-02 3 1  ON 77
ci_0029                -9.946226e-03 3 1  ON 78
ci_0030                -1.127085e-02 3 1  ON 79
ci_0031                 2.036766e-02 3 1  ON 80
ci_0032                 2.129731e-02 3 1  ON 81
ci_0033                 1.035270e-02 3 1  ON 82
ci_0034                 9.807730e-03 3 1  ON 83
ci_0035                 6.441904e-03 3 1  ON 84
ci_0036                 6.891686e-03 3 1  ON 85
ci_0037                -1.058463e-02 3 1  ON 86
ci_0038                -1.119201e-02 3 1  ON 87
ci_0039                -2.531330e-03 3 1  ON 88
ci_0040                -2.764877e-03 3 1  ON 89
ci_0041                 6.635400e-03 3 1  ON 90
ci_0042                 7.330838e-03 3 1  ON 91
ci_0043                -1.945935e-02 3 1  ON 92
ci_0044                -1.898888e-02 3 1  ON 93
ci_0045                 7.486941e-03 3 1  ON 94
ci_0046                 7.409337e-03 3 1  ON 95
ci_0047                -1.552754e-03 3 1  ON 96
ci_0048                -1.862719e-03 3 1  ON 97
ci_0049                -5.340677e-03 3 1  ON 98
ci_0050                -5.918768e-03 3 1  ON 99
ci_0051                -3.616815e-03 3 1  ON 100
ci_0052                -3.395438e-03 3 1  ON 101
ci_0053                -4.479387e-03 3 1  ON 102
ci_0054                -4.333111e-03 3 1  ON 103
ci_0055                 6.387314e-03 3 1  ON 104
ci_0056                 6.305003e-03 3 1  ON 105
ci_0057                 4.732154e-03 3 1  ON 106
ci_0058                 4.835976e-03 3 1  ON 107
ci_0059                -4.599452e-03 3 1  ON 108
ci_0060                -4.623326e-03 3 1  ON 109
ci_0061                -4.533598e-03 3 1  ON 110
ci_0062                -3.762525e-03 3 1  ON 111
ci_0063                -9.154257e-03 3 1  ON 112
ci_0064                -8.246744e-03 3 1  ON 113
ci_0065                -5.045520e-03 3 1  ON 114
ci_0066                -5.119659e-03 3 1  ON 115
ci_0067                -5.300297e-03 3 1  ON 116
ci_0068                -4.972649e-03 3 1  ON 117
ci_0069                 4.619932e-03 3 1  ON 118
ci_0070                 4.549766e-03 3 1  ON 119
ci_0071                 5.484356e-04 3 1  ON 120
ci_0072                -4.143387e-04 3 1  ON 121
ci_0073                 4.247652e-03 3 1  ON 122
ci_0074                 4.074323e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8751e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.9137
    reference variance = 0.208949
====================================================
  Execution time = 2.1761e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5235e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3622e-01
  Total weights = 1.951712116e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0916e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323609344573
                                         uncertainty =       0.002515473721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323609344573
                                         uncertainty =       0.002515473721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402244262
  error estimate for blocks of size 2^( 2) =       0.000414731186
  error estimate for blocks of size 2^( 3) =       0.000427328934
  error estimate for blocks of size 2^( 4) =       0.000439847179
  error estimate for blocks of size 2^( 5) =       0.000449322366
  error estimate for blocks of size 2^( 6) =       0.000457454924
  error estimate for blocks of size 2^( 7) =       0.000461447779

      target function =                  N/A
              le_mean =     -16.905088089329
             les_mean =     286.118218907392
             stat err =       0.000452018062
             autocorr =       1.262792120570
              std dev =       0.568859290396
             le_variance =       0.323600892270


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690508808933e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+04, overlap shift 2.2204e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905088089293       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905088089652       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905088089629       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905088089660       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905088089670       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905088089685       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905088089838       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905088089614       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905088089631       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905088089654       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.2204e+04 is 1.794991e-08

solving harmonic davidson linear method for identity shift 8.8818e+04, overlap shift 8.8818e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905088089293       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905088089383       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905088089377       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905088089384       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905088089345       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905088089349       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905088089350       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905088089247       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905088089393       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905088089182       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.8818e+04 is 4.487525e-09

solving harmonic davidson linear method for identity shift 3.5527e+05, overlap shift 3.5527e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905088089293       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905088089316       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905088089314       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905088089210       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905088089317       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905088089317       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905088089218       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905088089341       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905088089364       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905088089261       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.5527e+05 is 1.121884e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.549621 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7861e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
   uu_0                 3.117505e-01 1 1  ON 0
   uu_1                 1.447374e-01 1 1  ON 1
   uu_2                 4.305853e-02 1 1  ON 2
   uu_3                -1.916522e-02 1 1  ON 3
   uu_4                -6.454582e-02 1 1  ON 4
   uu_5                -9.933147e-02 1 1  ON 5
   uu_6                -1.264827e-01 1 1  ON 6
   uu_7                -1.389788e-01 1 1  ON 7
   uu_8                -1.311512e-01 1 1  ON 8
   uu_9                -1.002751e-01 1 1  ON 9
   ud_0                 4.453608e-01 1 1  ON 10
   ud_1                 1.799293e-01 1 1  ON 11
   ud_2                 5.987661e-02 1 1  ON 12
   ud_3                -1.076791e-02 1 1  ON 13
   ud_4                -6.720153e-02 1 1  ON 14
   ud_5                -1.077666e-01 1 1  ON 15
   ud_6                -1.341361e-01 1 1  ON 16
   ud_7                -1.497574e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385807e-01 1 1  ON 19
   eO_0                -7.471040e-01 1 1  ON 20
   eO_1                -4.277001e-01 1 1  ON 21
   eO_2                -1.909305e-02 1 1  ON 22
   eO_3                 2.902564e-01 1 1  ON 23
   eO_4                 5.129973e-01 1 1  ON 24
   eO_5                 4.729039e-01 1 1  ON 25
   eO_6                 2.454333e-01 1 1  ON 26
   eO_7                -4.920484e-02 1 1  ON 27
   eO_8                -2.099791e-01 1 1  ON 28
   eO_9                -6.985073e-02 1 1  ON 29
  eH1_0                -2.490229e-01 1 1  ON 30
  eH1_1                -1.410010e-01 1 1  ON 31
  eH1_2                -9.187515e-02 1 1  ON 32
  eH1_3                -3.738769e-02 1 1  ON 33
  eH1_4                 1.162262e-02 1 1  ON 34
  eH1_5                 4.534949e-02 1 1  ON 35
  eH1_6                 1.014830e-01 1 1  ON 36
  eH1_7                 1.507940e-01 1 1  ON 37
  eH1_8                 1.645760e-01 1 1  ON 38
  eH1_9                 4.967943e-02 1 1  ON 39
  eH2_0                -2.461152e-01 1 1  ON 40
  eH2_1                -1.390225e-01 1 1  ON 41
  eH2_2                -8.956052e-02 1 1  ON 42
  eH2_3                -3.460184e-02 1 1  ON 43
  eH2_4                 1.430656e-02 1 1  ON 44
  eH2_5                 4.960896e-02 1 1  ON 45
  eH2_6                 1.052388e-01 1 1  ON 46
  eH2_7                 1.534300e-01 1 1  ON 47
  eH2_8                 1.693346e-01 1 1  ON 48
  eH2_9                 3.486318e-02 1 1  ON 49
ci_0001                 7.014435e-01 3 1  ON 50
ci_0002                 7.000942e-01 3 1  ON 51
ci_0003                -2.781658e-02 3 1  ON 52
ci_0004                -2.749117e-02 3 1  ON 53
ci_0005                -3.666418e-02 3 1  ON 54
ci_0006                -3.710036e-02 3 1  ON 55
ci_0007                -2.252162e-02 3 1  ON 56
ci_0008                -2.153984e-02 3 1  ON 57
ci_0009                -1.785451e-02 3 1  ON 58
ci_0010                -1.750947e-02 3 1  ON 59
ci_0011                -1.219950e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300448e-02 3 1  ON 62
ci_0014                 1.317666e-02 3 1  ON 63
ci_0015                 1.362739e-02 3 1  ON 64
ci_0016                 1.350328e-02 3 1  ON 65
ci_0017                 1.098672e-02 3 1  ON 66
ci_0018                 1.191524e-02 3 1  ON 67
ci_0019                 1.136336e-02 3 1  ON 68
ci_0020                 1.154497e-02 3 1  ON 69
ci_0021                -2.103486e-03 3 1  ON 70
ci_0022                -4.896334e-04 3 1  ON 71
ci_0023                -1.110361e-02 3 1  ON 72
ci_0024                -1.090672e-02 3 1  ON 73
ci_0025                -1.174555e-02 3 1  ON 74
ci_0026                -1.107509e-02 3 1  ON 75
ci_0027                -1.166387e-02 3 1  ON 76
ci_0028                -1.083238e-02 3 1  ON 77
ci_0029                -9.946226e-03 3 1  ON 78
ci_0030                -1.127085e-02 3 1  ON 79
ci_0031                 2.036766e-02 3 1  ON 80
ci_0032                 2.129730e-02 3 1  ON 81
ci_0033                 1.035270e-02 3 1  ON 82
ci_0034                 9.807732e-03 3 1  ON 83
ci_0035                 6.441906e-03 3 1  ON 84
ci_0036                 6.891685e-03 3 1  ON 85
ci_0037                -1.058463e-02 3 1  ON 86
ci_0038                -1.119201e-02 3 1  ON 87
ci_0039                -2.531329e-03 3 1  ON 88
ci_0040                -2.764876e-03 3 1  ON 89
ci_0041                 6.635401e-03 3 1  ON 90
ci_0042                 7.330836e-03 3 1  ON 91
ci_0043                -1.945935e-02 3 1  ON 92
ci_0044                -1.898888e-02 3 1  ON 93
ci_0045                 7.486941e-03 3 1  ON 94
ci_0046                 7.409338e-03 3 1  ON 95
ci_0047                -1.552755e-03 3 1  ON 96
ci_0048                -1.862717e-03 3 1  ON 97
ci_0049                -5.340676e-03 3 1  ON 98
ci_0050                -5.918769e-03 3 1  ON 99
ci_0051                -3.616815e-03 3 1  ON 100
ci_0052                -3.395435e-03 3 1  ON 101
ci_0053                -4.479392e-03 3 1  ON 102
ci_0054                -4.333111e-03 3 1  ON 103
ci_0055                 6.387311e-03 3 1  ON 104
ci_0056                 6.305005e-03 3 1  ON 105
ci_0057                 4.732154e-03 3 1  ON 106
ci_0058                 4.835973e-03 3 1  ON 107
ci_0059                -4.599450e-03 3 1  ON 108
ci_0060                -4.623325e-03 3 1  ON 109
ci_0061                -4.533595e-03 3 1  ON 110
ci_0062                -3.762525e-03 3 1  ON 111
ci_0063                -9.154255e-03 3 1  ON 112
ci_0064                -8.246744e-03 3 1  ON 113
ci_0065                -5.045522e-03 3 1  ON 114
ci_0066                -5.119658e-03 3 1  ON 115
ci_0067                -5.300296e-03 3 1  ON 116
ci_0068                -4.972648e-03 3 1  ON 117
ci_0069                 4.619934e-03 3 1  ON 118
ci_0070                 4.549765e-03 3 1  ON 119
ci_0071                 5.484323e-04 3 1  ON 120
ci_0072                -4.143384e-04 3 1  ON 121
ci_0073                 4.247650e-03 3 1  ON 122
ci_0074                 4.074325e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.8889
    reference variance = 0.195564
====================================================
  Execution time = 2.1187e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3823e-01
  Total weights = 1.9518e+06
  Execution time = 1.8914e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322665031516
                                         uncertainty =       0.002097609199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322665031516
                                         uncertainty =       0.002097609199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401688653
  error estimate for blocks of size 2^( 2) =       0.000414054302
  error estimate for blocks of size 2^( 3) =       0.000426914824
  error estimate for blocks of size 2^( 4) =       0.000438718119
  error estimate for blocks of size 2^( 5) =       0.000450394135
  error estimate for blocks of size 2^( 6) =       0.000457264693
  error estimate for blocks of size 2^( 7) =       0.000460134919

      target function =                  N/A
              le_mean =     -16.906233339310
             les_mean =     286.158957989295
             stat err =       0.000451627966
             autocorr =       1.264103190186
              std dev =       0.568073540392
             le_variance =       0.322707547293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322665031105
                                         uncertainty =       0.002097609224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322665031105
                                         uncertainty =       0.002097609224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401688652
  error estimate for blocks of size 2^( 2) =       0.000414054302
  error estimate for blocks of size 2^( 3) =       0.000426914824
  error estimate for blocks of size 2^( 4) =       0.000438718119
  error estimate for blocks of size 2^( 5) =       0.000450394135
  error estimate for blocks of size 2^( 6) =       0.000457264693
  error estimate for blocks of size 2^( 7) =       0.000460134919

      target function =                  N/A
              le_mean =     -16.906233339512
             les_mean =     286.158957970267
             stat err =       0.000451627966
             autocorr =       1.264103191017
              std dev =       0.568073540058
             le_variance =       0.322707546914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322665031310
                                         uncertainty =       0.002097609212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322665031310
                                         uncertainty =       0.002097609212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401688653
  error estimate for blocks of size 2^( 2) =       0.000414054302
  error estimate for blocks of size 2^( 3) =       0.000426914824
  error estimate for blocks of size 2^( 4) =       0.000438718119
  error estimate for blocks of size 2^( 5) =       0.000450394135
  error estimate for blocks of size 2^( 6) =       0.000457264693
  error estimate for blocks of size 2^( 7) =       0.000460134919

      target function =                  N/A
              le_mean =     -16.906233339411
             les_mean =     286.158957979780
             stat err =       0.000451627966
             autocorr =       1.264103190599
              std dev =       0.568073540225
             le_variance =       0.322707547104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322665031490
                                         uncertainty =       0.002097609200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322665031490
                                         uncertainty =       0.002097609200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401688653
  error estimate for blocks of size 2^( 2) =       0.000414054302
  error estimate for blocks of size 2^( 3) =       0.000426914824
  error estimate for blocks of size 2^( 4) =       0.000438718119
  error estimate for blocks of size 2^( 5) =       0.000450394135
  error estimate for blocks of size 2^( 6) =       0.000457264693
  error estimate for blocks of size 2^( 7) =       0.000460134919

      target function =                  N/A
              le_mean =     -16.906233339322
             les_mean =     286.158957988106
             stat err =       0.000451627966
             autocorr =       1.264103190240
              std dev =       0.568073540371
             le_variance =       0.322707547270


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906233339310        initial
     2.2204e+04     2.2204e+05             1.7950e-08       -16.906233339512  <--
     8.8818e+04     8.8818e+05             4.4875e-09       -16.906233339411
     3.5527e+05     3.5527e+06             1.1219e-09       -16.906233339322

*****************************************************************************
Applying the update for shift_i =   2.2204e+04     and shift_s =   2.2204e+05
*****************************************************************************

  Execution time = 3.0733e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
   uu_0                 3.117505e-01 1 1  ON 0
   uu_1                 1.447374e-01 1 1  ON 1
   uu_2                 4.305854e-02 1 1  ON 2
   uu_3                -1.916522e-02 1 1  ON 3
   uu_4                -6.454582e-02 1 1  ON 4
   uu_5                -9.933147e-02 1 1  ON 5
   uu_6                -1.264827e-01 1 1  ON 6
   uu_7                -1.389788e-01 1 1  ON 7
   uu_8                -1.311512e-01 1 1  ON 8
   uu_9                -1.002751e-01 1 1  ON 9
   ud_0                 4.453608e-01 1 1  ON 10
   ud_1                 1.799293e-01 1 1  ON 11
   ud_2                 5.987661e-02 1 1  ON 12
   ud_3                -1.076791e-02 1 1  ON 13
   ud_4                -6.720153e-02 1 1  ON 14
   ud_5                -1.077666e-01 1 1  ON 15
   ud_6                -1.341361e-01 1 1  ON 16
   ud_7                -1.497574e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385807e-01 1 1  ON 19
   eO_0                -7.471040e-01 1 1  ON 20
   eO_1                -4.277001e-01 1 1  ON 21
   eO_2                -1.909305e-02 1 1  ON 22
   eO_3                 2.902564e-01 1 1  ON 23
   eO_4                 5.129973e-01 1 1  ON 24
   eO_5                 4.729039e-01 1 1  ON 25
   eO_6                 2.454333e-01 1 1  ON 26
   eO_7                -4.920483e-02 1 1  ON 27
   eO_8                -2.099791e-01 1 1  ON 28
   eO_9                -6.985073e-02 1 1  ON 29
  eH1_0                -2.490229e-01 1 1  ON 30
  eH1_1                -1.410010e-01 1 1  ON 31
  eH1_2                -9.187515e-02 1 1  ON 32
  eH1_3                -3.738769e-02 1 1  ON 33
  eH1_4                 1.162262e-02 1 1  ON 34
  eH1_5                 4.534950e-02 1 1  ON 35
  eH1_6                 1.014830e-01 1 1  ON 36
  eH1_7                 1.507940e-01 1 1  ON 37
  eH1_8                 1.645760e-01 1 1  ON 38
  eH1_9                 4.967944e-02 1 1  ON 39
  eH2_0                -2.461152e-01 1 1  ON 40
  eH2_1                -1.390225e-01 1 1  ON 41
  eH2_2                -8.956052e-02 1 1  ON 42
  eH2_3                -3.460184e-02 1 1  ON 43
  eH2_4                 1.430656e-02 1 1  ON 44
  eH2_5                 4.960896e-02 1 1  ON 45
  eH2_6                 1.052388e-01 1 1  ON 46
  eH2_7                 1.534300e-01 1 1  ON 47
  eH2_8                 1.693346e-01 1 1  ON 48
  eH2_9                 3.486318e-02 1 1  ON 49
ci_0001                 7.014435e-01 3 1  ON 50
ci_0002                 7.000942e-01 3 1  ON 51
ci_0003                -2.781658e-02 3 1  ON 52
ci_0004                -2.749117e-02 3 1  ON 53
ci_0005                -3.666418e-02 3 1  ON 54
ci_0006                -3.710036e-02 3 1  ON 55
ci_0007                -2.252162e-02 3 1  ON 56
ci_0008                -2.153985e-02 3 1  ON 57
ci_0009                -1.785451e-02 3 1  ON 58
ci_0010                -1.750947e-02 3 1  ON 59
ci_0011                -1.219950e-02 3 1  ON 60
ci_0012                -1.234249e-02 3 1  ON 61
ci_0013                 1.300448e-02 3 1  ON 62
ci_0014                 1.317666e-02 3 1  ON 63
ci_0015                 1.362739e-02 3 1  ON 64
ci_0016                 1.350327e-02 3 1  ON 65
ci_0017                 1.098672e-02 3 1  ON 66
ci_0018                 1.191523e-02 3 1  ON 67
ci_0019                 1.136336e-02 3 1  ON 68
ci_0020                 1.154496e-02 3 1  ON 69
ci_0021                -2.103482e-03 3 1  ON 70
ci_0022                -4.896346e-04 3 1  ON 71
ci_0023                -1.110361e-02 3 1  ON 72
ci_0024                -1.090672e-02 3 1  ON 73
ci_0025                -1.174554e-02 3 1  ON 74
ci_0026                -1.107509e-02 3 1  ON 75
ci_0027                -1.166387e-02 3 1  ON 76
ci_0028                -1.083238e-02 3 1  ON 77
ci_0029                -9.946225e-03 3 1  ON 78
ci_0030                -1.127085e-02 3 1  ON 79
ci_0031                 2.036766e-02 3 1  ON 80
ci_0032                 2.129730e-02 3 1  ON 81
ci_0033                 1.035271e-02 3 1  ON 82
ci_0034                 9.807739e-03 3 1  ON 83
ci_0035                 6.441914e-03 3 1  ON 84
ci_0036                 6.891682e-03 3 1  ON 85
ci_0037                -1.058463e-02 3 1  ON 86
ci_0038                -1.119200e-02 3 1  ON 87
ci_0039                -2.531326e-03 3 1  ON 88
ci_0040                -2.764874e-03 3 1  ON 89
ci_0041                 6.635404e-03 3 1  ON 90
ci_0042                 7.330830e-03 3 1  ON 91
ci_0043                -1.945935e-02 3 1  ON 92
ci_0044                -1.898888e-02 3 1  ON 93
ci_0045                 7.486940e-03 3 1  ON 94
ci_0046                 7.409342e-03 3 1  ON 95
ci_0047                -1.552758e-03 3 1  ON 96
ci_0048                -1.862712e-03 3 1  ON 97
ci_0049                -5.340675e-03 3 1  ON 98
ci_0050                -5.918770e-03 3 1  ON 99
ci_0051                -3.616813e-03 3 1  ON 100
ci_0052                -3.395426e-03 3 1  ON 101
ci_0053                -4.479405e-03 3 1  ON 102
ci_0054                -4.333112e-03 3 1  ON 103
ci_0055                 6.387302e-03 3 1  ON 104
ci_0056                 6.305010e-03 3 1  ON 105
ci_0057                 4.732155e-03 3 1  ON 106
ci_0058                 4.835967e-03 3 1  ON 107
ci_0059                -4.599447e-03 3 1  ON 108
ci_0060                -4.623323e-03 3 1  ON 109
ci_0061                -4.533585e-03 3 1  ON 110
ci_0062                -3.762526e-03 3 1  ON 111
ci_0063                -9.154249e-03 3 1  ON 112
ci_0064                -8.246744e-03 3 1  ON 113
ci_0065                -5.045527e-03 3 1  ON 114
ci_0066                -5.119655e-03 3 1  ON 115
ci_0067                -5.300293e-03 3 1  ON 116
ci_0068                -4.972647e-03 3 1  ON 117
ci_0069                 4.619940e-03 3 1  ON 118
ci_0070                 4.549761e-03 3 1  ON 119
ci_0071                 5.484225e-04 3 1  ON 120
ci_0072                -4.143377e-04 3 1  ON 121
ci_0073                 4.247644e-03 3 1  ON 122
ci_0074                 4.074332e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8600e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -16.9364
    reference variance = 0.212379
====================================================
  Execution time = 2.1874e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3529e-01
  Total weights = 1.951509010e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0457e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322403557022
                                         uncertainty =       0.002344029439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322403557022
                                         uncertainty =       0.002344029439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401584253
  error estimate for blocks of size 2^( 2) =       0.000414569213
  error estimate for blocks of size 2^( 3) =       0.000428475855
  error estimate for blocks of size 2^( 4) =       0.000441726913
  error estimate for blocks of size 2^( 5) =       0.000452489152
  error estimate for blocks of size 2^( 6) =       0.000462540493
  error estimate for blocks of size 2^( 7) =       0.000467109703

      target function =                  N/A
              le_mean =     -16.905850896381
             les_mean =     286.143082186586
             stat err =       0.000455966565
             autocorr =       1.289177293633
              std dev =       0.567925896700
             le_variance =       0.322539824142


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690585089638e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+03, overlap shift 5.5511e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905850896376       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905850897408       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905850897280       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905850897305       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905850897304       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905850897339       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905850897289       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905850897260       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905850897271       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905850897273       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.5511e+03 is 7.031868e-08

solving harmonic davidson linear method for identity shift 2.2204e+04, overlap shift 2.2204e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905850896376       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905850896634       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905850896602       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905850896613       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905850896608       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905850896620       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905850896601       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905850896588       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905850896568       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905850896616       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.2204e+04 is 1.758013e-08

solving harmonic davidson linear method for identity shift 8.8818e+04, overlap shift 8.8818e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905850896376       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905850896441       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905850896433       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905850896428       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905850896435       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905850896434       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905850896482       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905850896415       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905850896377       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905850896331       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.8818e+04 is 4.395061e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.553545 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7927e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
   uu_0                 3.117505e-01 1 1  ON 0
   uu_1                 1.447374e-01 1 1  ON 1
   uu_2                 4.305854e-02 1 1  ON 2
   uu_3                -1.916522e-02 1 1  ON 3
   uu_4                -6.454582e-02 1 1  ON 4
   uu_5                -9.933147e-02 1 1  ON 5
   uu_6                -1.264827e-01 1 1  ON 6
   uu_7                -1.389788e-01 1 1  ON 7
   uu_8                -1.311512e-01 1 1  ON 8
   uu_9                -1.002751e-01 1 1  ON 9
   ud_0                 4.453608e-01 1 1  ON 10
   ud_1                 1.799293e-01 1 1  ON 11
   ud_2                 5.987661e-02 1 1  ON 12
   ud_3                -1.076791e-02 1 1  ON 13
   ud_4                -6.720153e-02 1 1  ON 14
   ud_5                -1.077666e-01 1 1  ON 15
   ud_6                -1.341361e-01 1 1  ON 16
   ud_7                -1.497574e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385807e-01 1 1  ON 19
   eO_0                -7.471040e-01 1 1  ON 20
   eO_1                -4.277002e-01 1 1  ON 21
   eO_2                -1.909306e-02 1 1  ON 22
   eO_3                 2.902564e-01 1 1  ON 23
   eO_4                 5.129973e-01 1 1  ON 24
   eO_5                 4.729039e-01 1 1  ON 25
   eO_6                 2.454333e-01 1 1  ON 26
   eO_7                -4.920483e-02 1 1  ON 27
   eO_8                -2.099791e-01 1 1  ON 28
   eO_9                -6.985074e-02 1 1  ON 29
  eH1_0                -2.490229e-01 1 1  ON 30
  eH1_1                -1.410010e-01 1 1  ON 31
  eH1_2                -9.187515e-02 1 1  ON 32
  eH1_3                -3.738769e-02 1 1  ON 33
  eH1_4                 1.162262e-02 1 1  ON 34
  eH1_5                 4.534949e-02 1 1  ON 35
  eH1_6                 1.014830e-01 1 1  ON 36
  eH1_7                 1.507940e-01 1 1  ON 37
  eH1_8                 1.645760e-01 1 1  ON 38
  eH1_9                 4.967945e-02 1 1  ON 39
  eH2_0                -2.461152e-01 1 1  ON 40
  eH2_1                -1.390225e-01 1 1  ON 41
  eH2_2                -8.956052e-02 1 1  ON 42
  eH2_3                -3.460184e-02 1 1  ON 43
  eH2_4                 1.430656e-02 1 1  ON 44
  eH2_5                 4.960896e-02 1 1  ON 45
  eH2_6                 1.052388e-01 1 1  ON 46
  eH2_7                 1.534300e-01 1 1  ON 47
  eH2_8                 1.693346e-01 1 1  ON 48
  eH2_9                 3.486319e-02 1 1  ON 49
ci_0001                 7.014435e-01 3 1  ON 50
ci_0002                 7.000942e-01 3 1  ON 51
ci_0003                -2.781658e-02 3 1  ON 52
ci_0004                -2.749117e-02 3 1  ON 53
ci_0005                -3.666418e-02 3 1  ON 54
ci_0006                -3.710036e-02 3 1  ON 55
ci_0007                -2.252162e-02 3 1  ON 56
ci_0008                -2.153985e-02 3 1  ON 57
ci_0009                -1.785450e-02 3 1  ON 58
ci_0010                -1.750948e-02 3 1  ON 59
ci_0011                -1.219949e-02 3 1  ON 60
ci_0012                -1.234248e-02 3 1  ON 61
ci_0013                 1.300448e-02 3 1  ON 62
ci_0014                 1.317666e-02 3 1  ON 63
ci_0015                 1.362739e-02 3 1  ON 64
ci_0016                 1.350327e-02 3 1  ON 65
ci_0017                 1.098672e-02 3 1  ON 66
ci_0018                 1.191522e-02 3 1  ON 67
ci_0019                 1.136336e-02 3 1  ON 68
ci_0020                 1.154497e-02 3 1  ON 69
ci_0021                -2.103480e-03 3 1  ON 70
ci_0022                -4.896332e-04 3 1  ON 71
ci_0023                -1.110362e-02 3 1  ON 72
ci_0024                -1.090672e-02 3 1  ON 73
ci_0025                -1.174553e-02 3 1  ON 74
ci_0026                -1.107508e-02 3 1  ON 75
ci_0027                -1.166386e-02 3 1  ON 76
ci_0028                -1.083238e-02 3 1  ON 77
ci_0029                -9.946243e-03 3 1  ON 78
ci_0030                -1.127084e-02 3 1  ON 79
ci_0031                 2.036766e-02 3 1  ON 80
ci_0032                 2.129730e-02 3 1  ON 81
ci_0033                 1.035270e-02 3 1  ON 82
ci_0034                 9.807728e-03 3 1  ON 83
ci_0035                 6.441920e-03 3 1  ON 84
ci_0036                 6.891689e-03 3 1  ON 85
ci_0037                -1.058463e-02 3 1  ON 86
ci_0038                -1.119199e-02 3 1  ON 87
ci_0039                -2.531327e-03 3 1  ON 88
ci_0040                -2.764877e-03 3 1  ON 89
ci_0041                 6.635404e-03 3 1  ON 90
ci_0042                 7.330831e-03 3 1  ON 91
ci_0043                -1.945935e-02 3 1  ON 92
ci_0044                -1.898889e-02 3 1  ON 93
ci_0045                 7.486945e-03 3 1  ON 94
ci_0046                 7.409339e-03 3 1  ON 95
ci_0047                -1.552762e-03 3 1  ON 96
ci_0048                -1.862713e-03 3 1  ON 97
ci_0049                -5.340675e-03 3 1  ON 98
ci_0050                -5.918773e-03 3 1  ON 99
ci_0051                -3.616810e-03 3 1  ON 100
ci_0052                -3.395426e-03 3 1  ON 101
ci_0053                -4.479405e-03 3 1  ON 102
ci_0054                -4.333119e-03 3 1  ON 103
ci_0055                 6.387310e-03 3 1  ON 104
ci_0056                 6.305007e-03 3 1  ON 105
ci_0057                 4.732152e-03 3 1  ON 106
ci_0058                 4.835971e-03 3 1  ON 107
ci_0059                -4.599445e-03 3 1  ON 108
ci_0060                -4.623324e-03 3 1  ON 109
ci_0061                -4.533568e-03 3 1  ON 110
ci_0062                -3.762522e-03 3 1  ON 111
ci_0063                -9.154239e-03 3 1  ON 112
ci_0064                -8.246752e-03 3 1  ON 113
ci_0065                -5.045522e-03 3 1  ON 114
ci_0066                -5.119659e-03 3 1  ON 115
ci_0067                -5.300295e-03 3 1  ON 116
ci_0068                -4.972647e-03 3 1  ON 117
ci_0069                 4.619944e-03 3 1  ON 118
ci_0070                 4.549754e-03 3 1  ON 119
ci_0071                 5.484242e-04 3 1  ON 120
ci_0072                -4.143337e-04 3 1  ON 121
ci_0073                 4.247638e-03 3 1  ON 122
ci_0074                 4.074330e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -16.9426
    reference variance = 0.228884
====================================================
  Execution time = 2.1371e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3096e-01
  Total weights = 1.9516e+06
  Execution time = 1.8851e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320214111302
                                         uncertainty =       0.001724414694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320214111302
                                         uncertainty =       0.001724414694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400121126
  error estimate for blocks of size 2^( 2) =       0.000413290029
  error estimate for blocks of size 2^( 3) =       0.000427355647
  error estimate for blocks of size 2^( 4) =       0.000441162871
  error estimate for blocks of size 2^( 5) =       0.000453225345
  error estimate for blocks of size 2^( 6) =       0.000460028425
  error estimate for blocks of size 2^( 7) =       0.000464061910

      target function =                  N/A
              le_mean =     -16.906138266462
             les_mean =     286.148467003062
             stat err =       0.000454619638
             autocorr =       1.290961877761
              std dev =       0.565856723670
             le_variance =       0.320193831723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320214106433
                                         uncertainty =       0.001724413354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320214106433
                                         uncertainty =       0.001724413354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400121123
  error estimate for blocks of size 2^( 2) =       0.000413290025
  error estimate for blocks of size 2^( 3) =       0.000427355644
  error estimate for blocks of size 2^( 4) =       0.000441162867
  error estimate for blocks of size 2^( 5) =       0.000453225340
  error estimate for blocks of size 2^( 6) =       0.000460028420
  error estimate for blocks of size 2^( 7) =       0.000464061905

      target function =                  N/A
              le_mean =     -16.906138266824
             les_mean =     286.148467022853
             stat err =       0.000454619633
             autocorr =       1.290961870439
              std dev =       0.565856719399
             le_variance =       0.320193826889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320214108867
                                         uncertainty =       0.001724414024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320214108867
                                         uncertainty =       0.001724414024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400121125
  error estimate for blocks of size 2^( 2) =       0.000413290027
  error estimate for blocks of size 2^( 3) =       0.000427355646
  error estimate for blocks of size 2^( 4) =       0.000441162869
  error estimate for blocks of size 2^( 5) =       0.000453225342
  error estimate for blocks of size 2^( 6) =       0.000460028423
  error estimate for blocks of size 2^( 7) =       0.000464061908

      target function =                  N/A
              le_mean =     -16.906138266643
             les_mean =     286.148467012941
             stat err =       0.000454619635
             autocorr =       1.290961874106
              std dev =       0.565856721535
             le_variance =       0.320193829306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320214110998
                                         uncertainty =       0.001724414611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320214110998
                                         uncertainty =       0.001724414611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400121126
  error estimate for blocks of size 2^( 2) =       0.000413290029
  error estimate for blocks of size 2^( 3) =       0.000427355647
  error estimate for blocks of size 2^( 4) =       0.000441162871
  error estimate for blocks of size 2^( 5) =       0.000453225345
  error estimate for blocks of size 2^( 6) =       0.000460028425
  error estimate for blocks of size 2^( 7) =       0.000464061910

      target function =                  N/A
              le_mean =     -16.906138266484
             les_mean =     286.148467004295
             stat err =       0.000454619638
             autocorr =       1.290961877306
              std dev =       0.565856723403
             le_variance =       0.320193831421


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906138266462        initial
     5.5511e+03     5.5511e+04             7.0319e-08       -16.906138266824  <--
     2.2204e+04     2.2204e+05             1.7580e-08       -16.906138266643
     8.8818e+04     8.8818e+05             4.3951e-09       -16.906138266484

*****************************************************************************
Applying the update for shift_i =   5.5511e+03     and shift_s =   5.5511e+04
*****************************************************************************

  Execution time = 3.0923e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
   uu_0                 3.117505e-01 1 1  ON 0
   uu_1                 1.447374e-01 1 1  ON 1
   uu_2                 4.305856e-02 1 1  ON 2
   uu_3                -1.916522e-02 1 1  ON 3
   uu_4                -6.454583e-02 1 1  ON 4
   uu_5                -9.933148e-02 1 1  ON 5
   uu_6                -1.264827e-01 1 1  ON 6
   uu_7                -1.389789e-01 1 1  ON 7
   uu_8                -1.311512e-01 1 1  ON 8
   uu_9                -1.002751e-01 1 1  ON 9
   ud_0                 4.453608e-01 1 1  ON 10
   ud_1                 1.799293e-01 1 1  ON 11
   ud_2                 5.987660e-02 1 1  ON 12
   ud_3                -1.076791e-02 1 1  ON 13
   ud_4                -6.720153e-02 1 1  ON 14
   ud_5                -1.077666e-01 1 1  ON 15
   ud_6                -1.341361e-01 1 1  ON 16
   ud_7                -1.497574e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385807e-01 1 1  ON 19
   eO_0                -7.471040e-01 1 1  ON 20
   eO_1                -4.277002e-01 1 1  ON 21
   eO_2                -1.909308e-02 1 1  ON 22
   eO_3                 2.902564e-01 1 1  ON 23
   eO_4                 5.129973e-01 1 1  ON 24
   eO_5                 4.729039e-01 1 1  ON 25
   eO_6                 2.454333e-01 1 1  ON 26
   eO_7                -4.920482e-02 1 1  ON 27
   eO_8                -2.099791e-01 1 1  ON 28
   eO_9                -6.985075e-02 1 1  ON 29
  eH1_0                -2.490229e-01 1 1  ON 30
  eH1_1                -1.410011e-01 1 1  ON 31
  eH1_2                -9.187517e-02 1 1  ON 32
  eH1_3                -3.738769e-02 1 1  ON 33
  eH1_4                 1.162261e-02 1 1  ON 34
  eH1_5                 4.534948e-02 1 1  ON 35
  eH1_6                 1.014830e-01 1 1  ON 36
  eH1_7                 1.507940e-01 1 1  ON 37
  eH1_8                 1.645760e-01 1 1  ON 38
  eH1_9                 4.967948e-02 1 1  ON 39
  eH2_0                -2.461152e-01 1 1  ON 40
  eH2_1                -1.390225e-01 1 1  ON 41
  eH2_2                -8.956054e-02 1 1  ON 42
  eH2_3                -3.460186e-02 1 1  ON 43
  eH2_4                 1.430655e-02 1 1  ON 44
  eH2_5                 4.960896e-02 1 1  ON 45
  eH2_6                 1.052388e-01 1 1  ON 46
  eH2_7                 1.534300e-01 1 1  ON 47
  eH2_8                 1.693346e-01 1 1  ON 48
  eH2_9                 3.486322e-02 1 1  ON 49
ci_0001                 7.014435e-01 3 1  ON 50
ci_0002                 7.000942e-01 3 1  ON 51
ci_0003                -2.781659e-02 3 1  ON 52
ci_0004                -2.749115e-02 3 1  ON 53
ci_0005                -3.666419e-02 3 1  ON 54
ci_0006                -3.710034e-02 3 1  ON 55
ci_0007                -2.252162e-02 3 1  ON 56
ci_0008                -2.153987e-02 3 1  ON 57
ci_0009                -1.785446e-02 3 1  ON 58
ci_0010                -1.750951e-02 3 1  ON 59
ci_0011                -1.219948e-02 3 1  ON 60
ci_0012                -1.234245e-02 3 1  ON 61
ci_0013                 1.300447e-02 3 1  ON 62
ci_0014                 1.317668e-02 3 1  ON 63
ci_0015                 1.362739e-02 3 1  ON 64
ci_0016                 1.350324e-02 3 1  ON 65
ci_0017                 1.098672e-02 3 1  ON 66
ci_0018                 1.191519e-02 3 1  ON 67
ci_0019                 1.136336e-02 3 1  ON 68
ci_0020                 1.154497e-02 3 1  ON 69
ci_0021                -2.103472e-03 3 1  ON 70
ci_0022                -4.896290e-04 3 1  ON 71
ci_0023                -1.110363e-02 3 1  ON 72
ci_0024                -1.090672e-02 3 1  ON 73
ci_0025                -1.174551e-02 3 1  ON 74
ci_0026                -1.107507e-02 3 1  ON 75
ci_0027                -1.166385e-02 3 1  ON 76
ci_0028                -1.083238e-02 3 1  ON 77
ci_0029                -9.946296e-03 3 1  ON 78
ci_0030                -1.127082e-02 3 1  ON 79
ci_0031                 2.036768e-02 3 1  ON 80
ci_0032                 2.129731e-02 3 1  ON 81
ci_0033                 1.035270e-02 3 1  ON 82
ci_0034                 9.807694e-03 3 1  ON 83
ci_0035                 6.441940e-03 3 1  ON 84
ci_0036                 6.891713e-03 3 1  ON 85
ci_0037                -1.058462e-02 3 1  ON 86
ci_0038                -1.119197e-02 3 1  ON 87
ci_0039                -2.531329e-03 3 1  ON 88
ci_0040                -2.764888e-03 3 1  ON 89
ci_0041                 6.635403e-03 3 1  ON 90
ci_0042                 7.330833e-03 3 1  ON 91
ci_0043                -1.945934e-02 3 1  ON 92
ci_0044                -1.898889e-02 3 1  ON 93
ci_0045                 7.486961e-03 3 1  ON 94
ci_0046                 7.409330e-03 3 1  ON 95
ci_0047                -1.552773e-03 3 1  ON 96
ci_0048                -1.862715e-03 3 1  ON 97
ci_0049                -5.340675e-03 3 1  ON 98
ci_0050                -5.918784e-03 3 1  ON 99
ci_0051                -3.616801e-03 3 1  ON 100
ci_0052                -3.395425e-03 3 1  ON 101
ci_0053                -4.479406e-03 3 1  ON 102
ci_0054                -4.333138e-03 3 1  ON 103
ci_0055                 6.387333e-03 3 1  ON 104
ci_0056                 6.304996e-03 3 1  ON 105
ci_0057                 4.732145e-03 3 1  ON 106
ci_0058                 4.835986e-03 3 1  ON 107
ci_0059                -4.599439e-03 3 1  ON 108
ci_0060                -4.623328e-03 3 1  ON 109
ci_0061                -4.533518e-03 3 1  ON 110
ci_0062                -3.762510e-03 3 1  ON 111
ci_0063                -9.154208e-03 3 1  ON 112
ci_0064                -8.246775e-03 3 1  ON 113
ci_0065                -5.045507e-03 3 1  ON 114
ci_0066                -5.119670e-03 3 1  ON 115
ci_0067                -5.300300e-03 3 1  ON 116
ci_0068                -4.972646e-03 3 1  ON 117
ci_0069                 4.619955e-03 3 1  ON 118
ci_0070                 4.549732e-03 3 1  ON 119
ci_0071                 5.484292e-04 3 1  ON 120
ci_0072                -4.143216e-04 3 1  ON 121
ci_0073                 4.247619e-03 3 1  ON 122
ci_0074                 4.074326e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8858e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -16.9177
    reference variance = 0.21886
====================================================
  Execution time = 2.1584e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3700e-01
  Total weights = 1.951722005e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0803e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324582312613
                                         uncertainty =       0.002537449955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324582312613
                                         uncertainty =       0.002537449955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402831361
  error estimate for blocks of size 2^( 2) =       0.000415385710
  error estimate for blocks of size 2^( 3) =       0.000428614709
  error estimate for blocks of size 2^( 4) =       0.000440434700
  error estimate for blocks of size 2^( 5) =       0.000451494899
  error estimate for blocks of size 2^( 6) =       0.000459051000
  error estimate for blocks of size 2^( 7) =       0.000463731907

      target function =                  N/A
              le_mean =     -16.905975525511
             les_mean =     286.149006251381
             stat err =       0.000453678126
             autocorr =       1.268379264330
              std dev =       0.569689574307
             le_variance =       0.324546211074


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690597552551e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+03, overlap shift 1.3878e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905975525531       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905975530445       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905975530744       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905975530873       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905975530932       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905975531549       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905975531789       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905975531849       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905975531751       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905975531748       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3878e+03 is 3.020293e-07

solving harmonic davidson linear method for identity shift 5.5511e+03, overlap shift 5.5511e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905975525531       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905975526760       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905975526834       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905975526867       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905975526880       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905975527034       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905975527089       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905975527107       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905975527074       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905975527097       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.5511e+03 is 7.551560e-08

solving harmonic davidson linear method for identity shift 2.2204e+04, overlap shift 2.2204e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905975525531       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905975525838       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905975525857       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905975525865       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905975525869       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905975525905       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905975525935       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905975525913       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905975525927       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905975525897       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.2204e+04 is 1.887942e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.557417 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7672e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
   uu_0                 3.117505e-01 1 1  ON 0
   uu_1                 1.447374e-01 1 1  ON 1
   uu_2                 4.305856e-02 1 1  ON 2
   uu_3                -1.916522e-02 1 1  ON 3
   uu_4                -6.454582e-02 1 1  ON 4
   uu_5                -9.933148e-02 1 1  ON 5
   uu_6                -1.264827e-01 1 1  ON 6
   uu_7                -1.389789e-01 1 1  ON 7
   uu_8                -1.311512e-01 1 1  ON 8
   uu_9                -1.002751e-01 1 1  ON 9
   ud_0                 4.453608e-01 1 1  ON 10
   ud_1                 1.799293e-01 1 1  ON 11
   ud_2                 5.987662e-02 1 1  ON 12
   ud_3                -1.076791e-02 1 1  ON 13
   ud_4                -6.720153e-02 1 1  ON 14
   ud_5                -1.077666e-01 1 1  ON 15
   ud_6                -1.341361e-01 1 1  ON 16
   ud_7                -1.497574e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385807e-01 1 1  ON 19
   eO_0                -7.471040e-01 1 1  ON 20
   eO_1                -4.277002e-01 1 1  ON 21
   eO_2                -1.909308e-02 1 1  ON 22
   eO_3                 2.902564e-01 1 1  ON 23
   eO_4                 5.129973e-01 1 1  ON 24
   eO_5                 4.729039e-01 1 1  ON 25
   eO_6                 2.454334e-01 1 1  ON 26
   eO_7                -4.920481e-02 1 1  ON 27
   eO_8                -2.099791e-01 1 1  ON 28
   eO_9                -6.985078e-02 1 1  ON 29
  eH1_0                -2.490229e-01 1 1  ON 30
  eH1_1                -1.410011e-01 1 1  ON 31
  eH1_2                -9.187519e-02 1 1  ON 32
  eH1_3                -3.738771e-02 1 1  ON 33
  eH1_4                 1.162262e-02 1 1  ON 34
  eH1_5                 4.534948e-02 1 1  ON 35
  eH1_6                 1.014830e-01 1 1  ON 36
  eH1_7                 1.507940e-01 1 1  ON 37
  eH1_8                 1.645760e-01 1 1  ON 38
  eH1_9                 4.967952e-02 1 1  ON 39
  eH2_0                -2.461152e-01 1 1  ON 40
  eH2_1                -1.390226e-01 1 1  ON 41
  eH2_2                -8.956056e-02 1 1  ON 42
  eH2_3                -3.460189e-02 1 1  ON 43
  eH2_4                 1.430656e-02 1 1  ON 44
  eH2_5                 4.960895e-02 1 1  ON 45
  eH2_6                 1.052388e-01 1 1  ON 46
  eH2_7                 1.534301e-01 1 1  ON 47
  eH2_8                 1.693346e-01 1 1  ON 48
  eH2_9                 3.486325e-02 1 1  ON 49
ci_0001                 7.014435e-01 3 1  ON 50
ci_0002                 7.000942e-01 3 1  ON 51
ci_0003                -2.781657e-02 3 1  ON 52
ci_0004                -2.749111e-02 3 1  ON 53
ci_0005                -3.666417e-02 3 1  ON 54
ci_0006                -3.710029e-02 3 1  ON 55
ci_0007                -2.252158e-02 3 1  ON 56
ci_0008                -2.153989e-02 3 1  ON 57
ci_0009                -1.785447e-02 3 1  ON 58
ci_0010                -1.750953e-02 3 1  ON 59
ci_0011                -1.219949e-02 3 1  ON 60
ci_0012                -1.234242e-02 3 1  ON 61
ci_0013                 1.300449e-02 3 1  ON 62
ci_0014                 1.317670e-02 3 1  ON 63
ci_0015                 1.362737e-02 3 1  ON 64
ci_0016                 1.350324e-02 3 1  ON 65
ci_0017                 1.098671e-02 3 1  ON 66
ci_0018                 1.191515e-02 3 1  ON 67
ci_0019                 1.136339e-02 3 1  ON 68
ci_0020                 1.154490e-02 3 1  ON 69
ci_0021                -2.103460e-03 3 1  ON 70
ci_0022                -4.896367e-04 3 1  ON 71
ci_0023                -1.110363e-02 3 1  ON 72
ci_0024                -1.090677e-02 3 1  ON 73
ci_0025                -1.174549e-02 3 1  ON 74
ci_0026                -1.107505e-02 3 1  ON 75
ci_0027                -1.166387e-02 3 1  ON 76
ci_0028                -1.083240e-02 3 1  ON 77
ci_0029                -9.946352e-03 3 1  ON 78
ci_0030                -1.127080e-02 3 1  ON 79
ci_0031                 2.036768e-02 3 1  ON 80
ci_0032                 2.129728e-02 3 1  ON 81
ci_0033                 1.035268e-02 3 1  ON 82
ci_0034                 9.807747e-03 3 1  ON 83
ci_0035                 6.442015e-03 3 1  ON 84
ci_0036                 6.891732e-03 3 1  ON 85
ci_0037                -1.058464e-02 3 1  ON 86
ci_0038                -1.119191e-02 3 1  ON 87
ci_0039                -2.531368e-03 3 1  ON 88
ci_0040                -2.764859e-03 3 1  ON 89
ci_0041                 6.635406e-03 3 1  ON 90
ci_0042                 7.330796e-03 3 1  ON 91
ci_0043                -1.945934e-02 3 1  ON 92
ci_0044                -1.898887e-02 3 1  ON 93
ci_0045                 7.486962e-03 3 1  ON 94
ci_0046                 7.409324e-03 3 1  ON 95
ci_0047                -1.552790e-03 3 1  ON 96
ci_0048                -1.862729e-03 3 1  ON 97
ci_0049                -5.340711e-03 3 1  ON 98
ci_0050                -5.918807e-03 3 1  ON 99
ci_0051                -3.616774e-03 3 1  ON 100
ci_0052                -3.395413e-03 3 1  ON 101
ci_0053                -4.479441e-03 3 1  ON 102
ci_0054                -4.333150e-03 3 1  ON 103
ci_0055                 6.387335e-03 3 1  ON 104
ci_0056                 6.304994e-03 3 1  ON 105
ci_0057                 4.732157e-03 3 1  ON 106
ci_0058                 4.835983e-03 3 1  ON 107
ci_0059                -4.599397e-03 3 1  ON 108
ci_0060                -4.623343e-03 3 1  ON 109
ci_0061                -4.533489e-03 3 1  ON 110
ci_0062                -3.762565e-03 3 1  ON 111
ci_0063                -9.154162e-03 3 1  ON 112
ci_0064                -8.246804e-03 3 1  ON 113
ci_0065                -5.045536e-03 3 1  ON 114
ci_0066                -5.119690e-03 3 1  ON 115
ci_0067                -5.300289e-03 3 1  ON 116
ci_0068                -4.972691e-03 3 1  ON 117
ci_0069                 4.619961e-03 3 1  ON 118
ci_0070                 4.549728e-03 3 1  ON 119
ci_0071                 5.483996e-04 3 1  ON 120
ci_0072                -4.142669e-04 3 1  ON 121
ci_0073                 4.247656e-03 3 1  ON 122
ci_0074                 4.074299e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -16.8698
    reference variance = 0.370466
====================================================
  Execution time = 2.1796e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3413e-01
  Total weights = 1.9517e+06
  Execution time = 1.8962e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321792496572
                                         uncertainty =       0.001964750077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321792496572
                                         uncertainty =       0.001964750077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401083978
  error estimate for blocks of size 2^( 2) =       0.000414379935
  error estimate for blocks of size 2^( 3) =       0.000428336345
  error estimate for blocks of size 2^( 4) =       0.000441114486
  error estimate for blocks of size 2^( 5) =       0.000453948373
  error estimate for blocks of size 2^( 6) =       0.000463753495
  error estimate for blocks of size 2^( 7) =       0.000468078998

      target function =                  N/A
              le_mean =     -16.905510298966
             les_mean =     286.130405637620
             stat err =       0.000456723838
             autocorr =       1.296691698399
              std dev =       0.567218401968
             le_variance =       0.321736715531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321792590092
                                         uncertainty =       0.001964757457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321792590092
                                         uncertainty =       0.001964757457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401084037
  error estimate for blocks of size 2^( 2) =       0.000414379990
  error estimate for blocks of size 2^( 3) =       0.000428336398
  error estimate for blocks of size 2^( 4) =       0.000441114536
  error estimate for blocks of size 2^( 5) =       0.000453948421
  error estimate for blocks of size 2^( 6) =       0.000463753548
  error estimate for blocks of size 2^( 7) =       0.000468079052

      target function =                  N/A
              le_mean =     -16.905510299716
             les_mean =     286.130400689171
             stat err =       0.000456723889
             autocorr =       1.296691609375
              std dev =       0.567218484903
             le_variance =       0.321736809616

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321792543338
                                         uncertainty =       0.001964753767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321792543338
                                         uncertainty =       0.001964753767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401084008
  error estimate for blocks of size 2^( 2) =       0.000414379962
  error estimate for blocks of size 2^( 3) =       0.000428336372
  error estimate for blocks of size 2^( 4) =       0.000441114511
  error estimate for blocks of size 2^( 5) =       0.000453948397
  error estimate for blocks of size 2^( 6) =       0.000463753521
  error estimate for blocks of size 2^( 7) =       0.000468079025

      target function =                  N/A
              le_mean =     -16.905510299342
             les_mean =     286.130403111086
             stat err =       0.000456723863
             autocorr =       1.296691653905
              std dev =       0.567218443441
             le_variance =       0.321736762579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321792502417
                                         uncertainty =       0.001964750538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321792502417
                                         uncertainty =       0.001964750538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401083982
  error estimate for blocks of size 2^( 2) =       0.000414379938
  error estimate for blocks of size 2^( 3) =       0.000428336348
  error estimate for blocks of size 2^( 4) =       0.000441114489
  error estimate for blocks of size 2^( 5) =       0.000453948376
  error estimate for blocks of size 2^( 6) =       0.000463753498
  error estimate for blocks of size 2^( 7) =       0.000468079001

      target function =                  N/A
              le_mean =     -16.905510299013
             les_mean =     286.130405315905
             stat err =       0.000456723841
             autocorr =       1.296691692839
              std dev =       0.567218407152
             le_variance =       0.321736721412


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905510298966        initial
     1.3878e+03     1.3878e+04             3.0203e-07       -16.905510299716  <--
     5.5511e+03     5.5511e+04             7.5516e-08       -16.905510299342
     2.2204e+04     2.2204e+05             1.8879e-08       -16.905510299013

*****************************************************************************
Applying the update for shift_i =   1.3878e+03     and shift_s =   1.3878e+04
*****************************************************************************

  Execution time = 3.1374e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
   uu_0                 3.117505e-01 1 1  ON 0
   uu_1                 1.447373e-01 1 1  ON 1
   uu_2                 4.305856e-02 1 1  ON 2
   uu_3                -1.916524e-02 1 1  ON 3
   uu_4                -6.454577e-02 1 1  ON 4
   uu_5                -9.933149e-02 1 1  ON 5
   uu_6                -1.264827e-01 1 1  ON 6
   uu_7                -1.389789e-01 1 1  ON 7
   uu_8                -1.311513e-01 1 1  ON 8
   uu_9                -1.002752e-01 1 1  ON 9
   ud_0                 4.453610e-01 1 1  ON 10
   ud_1                 1.799293e-01 1 1  ON 11
   ud_2                 5.987666e-02 1 1  ON 12
   ud_3                -1.076790e-02 1 1  ON 13
   ud_4                -6.720152e-02 1 1  ON 14
   ud_5                -1.077666e-01 1 1  ON 15
   ud_6                -1.341361e-01 1 1  ON 16
   ud_7                -1.497574e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385808e-01 1 1  ON 19
   eO_0                -7.471041e-01 1 1  ON 20
   eO_1                -4.277002e-01 1 1  ON 21
   eO_2                -1.909308e-02 1 1  ON 22
   eO_3                 2.902564e-01 1 1  ON 23
   eO_4                 5.129973e-01 1 1  ON 24
   eO_5                 4.729040e-01 1 1  ON 25
   eO_6                 2.454335e-01 1 1  ON 26
   eO_7                -4.920477e-02 1 1  ON 27
   eO_8                -2.099792e-01 1 1  ON 28
   eO_9                -6.985085e-02 1 1  ON 29
  eH1_0                -2.490229e-01 1 1  ON 30
  eH1_1                -1.410013e-01 1 1  ON 31
  eH1_2                -9.187526e-02 1 1  ON 32
  eH1_3                -3.738776e-02 1 1  ON 33
  eH1_4                 1.162266e-02 1 1  ON 34
  eH1_5                 4.534947e-02 1 1  ON 35
  eH1_6                 1.014830e-01 1 1  ON 36
  eH1_7                 1.507941e-01 1 1  ON 37
  eH1_8                 1.645761e-01 1 1  ON 38
  eH1_9                 4.967963e-02 1 1  ON 39
  eH2_0                -2.461153e-01 1 1  ON 40
  eH2_1                -1.390227e-01 1 1  ON 41
  eH2_2                -8.956061e-02 1 1  ON 42
  eH2_3                -3.460198e-02 1 1  ON 43
  eH2_4                 1.430659e-02 1 1  ON 44
  eH2_5                 4.960892e-02 1 1  ON 45
  eH2_6                 1.052388e-01 1 1  ON 46
  eH2_7                 1.534301e-01 1 1  ON 47
  eH2_8                 1.693347e-01 1 1  ON 48
  eH2_9                 3.486334e-02 1 1  ON 49
ci_0001                 7.014435e-01 3 1  ON 50
ci_0002                 7.000941e-01 3 1  ON 51
ci_0003                -2.781653e-02 3 1  ON 52
ci_0004                -2.749098e-02 3 1  ON 53
ci_0005                -3.666410e-02 3 1  ON 54
ci_0006                -3.710015e-02 3 1  ON 55
ci_0007                -2.252146e-02 3 1  ON 56
ci_0008                -2.153995e-02 3 1  ON 57
ci_0009                -1.785448e-02 3 1  ON 58
ci_0010                -1.750960e-02 3 1  ON 59
ci_0011                -1.219952e-02 3 1  ON 60
ci_0012                -1.234231e-02 3 1  ON 61
ci_0013                 1.300454e-02 3 1  ON 62
ci_0014                 1.317676e-02 3 1  ON 63
ci_0015                 1.362731e-02 3 1  ON 64
ci_0016                 1.350321e-02 3 1  ON 65
ci_0017                 1.098668e-02 3 1  ON 66
ci_0018                 1.191502e-02 3 1  ON 67
ci_0019                 1.136348e-02 3 1  ON 68
ci_0020                 1.154469e-02 3 1  ON 69
ci_0021                -2.103423e-03 3 1  ON 70
ci_0022                -4.896599e-04 3 1  ON 71
ci_0023                -1.110361e-02 3 1  ON 72
ci_0024                -1.090691e-02 3 1  ON 73
ci_0025                -1.174545e-02 3 1  ON 74
ci_0026                -1.107498e-02 3 1  ON 75
ci_0027                -1.166392e-02 3 1  ON 76
ci_0028                -1.083246e-02 3 1  ON 77
ci_0029                -9.946522e-03 3 1  ON 78
ci_0030                -1.127074e-02 3 1  ON 79
ci_0031                 2.036771e-02 3 1  ON 80
ci_0032                 2.129719e-02 3 1  ON 81
ci_0033                 1.035264e-02 3 1  ON 82
ci_0034                 9.807904e-03 3 1  ON 83
ci_0035                 6.442242e-03 3 1  ON 84
ci_0036                 6.891788e-03 3 1  ON 85
ci_0037                -1.058468e-02 3 1  ON 86
ci_0038                -1.119172e-02 3 1  ON 87
ci_0039                -2.531483e-03 3 1  ON 88
ci_0040                -2.764774e-03 3 1  ON 89
ci_0041                 6.635417e-03 3 1  ON 90
ci_0042                 7.330684e-03 3 1  ON 91
ci_0043                -1.945935e-02 3 1  ON 92
ci_0044                -1.898882e-02 3 1  ON 93
ci_0045                 7.486967e-03 3 1  ON 94
ci_0046                 7.409307e-03 3 1  ON 95
ci_0047                -1.552841e-03 3 1  ON 96
ci_0048                -1.862771e-03 3 1  ON 97
ci_0049                -5.340817e-03 3 1  ON 98
ci_0050                -5.918874e-03 3 1  ON 99
ci_0051                -3.616692e-03 3 1  ON 100
ci_0052                -3.395378e-03 3 1  ON 101
ci_0053                -4.479544e-03 3 1  ON 102
ci_0054                -4.333186e-03 3 1  ON 103
ci_0055                 6.387342e-03 3 1  ON 104
ci_0056                 6.304986e-03 3 1  ON 105
ci_0057                 4.732193e-03 3 1  ON 106
ci_0058                 4.835973e-03 3 1  ON 107
ci_0059                -4.599272e-03 3 1  ON 108
ci_0060                -4.623386e-03 3 1  ON 109
ci_0061                -4.533403e-03 3 1  ON 110
ci_0062                -3.762729e-03 3 1  ON 111
ci_0063                -9.154022e-03 3 1  ON 112
ci_0064                -8.246892e-03 3 1  ON 113
ci_0065                -5.045625e-03 3 1  ON 114
ci_0066                -5.119749e-03 3 1  ON 115
ci_0067                -5.300254e-03 3 1  ON 116
ci_0068                -4.972826e-03 3 1  ON 117
ci_0069                 4.619979e-03 3 1  ON 118
ci_0070                 4.549715e-03 3 1  ON 119
ci_0071                 5.483107e-04 3 1  ON 120
ci_0072                -4.141029e-04 3 1  ON 121
ci_0073                 4.247769e-03 3 1  ON 122
ci_0074                 4.074218e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9053e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -16.8392
    reference variance = 0.199247
====================================================
  Execution time = 2.1542e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3477e-01
  Total weights = 1.951822955e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1152e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322994662818
                                         uncertainty =       0.002197463600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322994662818
                                         uncertainty =       0.002197463600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401907758
  error estimate for blocks of size 2^( 2) =       0.000414925444
  error estimate for blocks of size 2^( 3) =       0.000428379524
  error estimate for blocks of size 2^( 4) =       0.000440888439
  error estimate for blocks of size 2^( 5) =       0.000451277798
  error estimate for blocks of size 2^( 6) =       0.000458759831
  error estimate for blocks of size 2^( 7) =       0.000462683927

      target function =                  N/A
              le_mean =     -16.906632992221
             les_mean =     286.169006566748
             stat err =       0.000453402499
             autocorr =       1.272667750934
              std dev =       0.568383402429
             le_variance =       0.323059692156


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690663299222e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+02, overlap shift 3.4694e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906632992201       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906633011011       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906633009931       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906633010022       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906633011780       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906633011413       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906633011615       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906633010321       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906633010857       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906633011245       residual = 6.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.4694e+02 is 2.695810e-06

solving harmonic davidson linear method for identity shift 1.3878e+03, overlap shift 1.3878e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906632992201       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906632996906       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906632996636       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906632996659       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906632997099       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906632997008       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906632997058       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906632996733       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906632996868       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906632996962       residual = 6.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3878e+03 is 6.742611e-07

solving harmonic davidson linear method for identity shift 5.5511e+03, overlap shift 5.5511e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906632992201       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906632993377       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906632993310       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906632993316       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906632993426       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906632993403       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906632993418       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906632993323       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906632993380       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906632993433       residual = 6.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.5511e+03 is 1.685846e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.561220 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7665e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
   uu_0                 3.117506e-01 1 1  ON 0
   uu_1                 1.447374e-01 1 1  ON 1
   uu_2                 4.305861e-02 1 1  ON 2
   uu_3                -1.916527e-02 1 1  ON 3
   uu_4                -6.454582e-02 1 1  ON 4
   uu_5                -9.933144e-02 1 1  ON 5
   uu_6                -1.264827e-01 1 1  ON 6
   uu_7                -1.389791e-01 1 1  ON 7
   uu_8                -1.311514e-01 1 1  ON 8
   uu_9                -1.002752e-01 1 1  ON 9
   ud_0                 4.453610e-01 1 1  ON 10
   ud_1                 1.799293e-01 1 1  ON 11
   ud_2                 5.987666e-02 1 1  ON 12
   ud_3                -1.076778e-02 1 1  ON 13
   ud_4                -6.720148e-02 1 1  ON 14
   ud_5                -1.077665e-01 1 1  ON 15
   ud_6                -1.341362e-01 1 1  ON 16
   ud_7                -1.497575e-01 1 1  ON 17
   ud_8                -1.506349e-01 1 1  ON 18
   ud_9                -1.385808e-01 1 1  ON 19
   eO_0                -7.471042e-01 1 1  ON 20
   eO_1                -4.277001e-01 1 1  ON 21
   eO_2                -1.909308e-02 1 1  ON 22
   eO_3                 2.902564e-01 1 1  ON 23
   eO_4                 5.129974e-01 1 1  ON 24
   eO_5                 4.729041e-01 1 1  ON 25
   eO_6                 2.454336e-01 1 1  ON 26
   eO_7                -4.920475e-02 1 1  ON 27
   eO_8                -2.099793e-01 1 1  ON 28
   eO_9                -6.985096e-02 1 1  ON 29
  eH1_0                -2.490230e-01 1 1  ON 30
  eH1_1                -1.410014e-01 1 1  ON 31
  eH1_2                -9.187531e-02 1 1  ON 32
  eH1_3                -3.738777e-02 1 1  ON 33
  eH1_4                 1.162263e-02 1 1  ON 34
  eH1_5                 4.534951e-02 1 1  ON 35
  eH1_6                 1.014830e-01 1 1  ON 36
  eH1_7                 1.507941e-01 1 1  ON 37
  eH1_8                 1.645762e-01 1 1  ON 38
  eH1_9                 4.967972e-02 1 1  ON 39
  eH2_0                -2.461153e-01 1 1  ON 40
  eH2_1                -1.390227e-01 1 1  ON 41
  eH2_2                -8.956069e-02 1 1  ON 42
  eH2_3                -3.460202e-02 1 1  ON 43
  eH2_4                 1.430654e-02 1 1  ON 44
  eH2_5                 4.960878e-02 1 1  ON 45
  eH2_6                 1.052388e-01 1 1  ON 46
  eH2_7                 1.534302e-01 1 1  ON 47
  eH2_8                 1.693348e-01 1 1  ON 48
  eH2_9                 3.486350e-02 1 1  ON 49
ci_0001                 7.014435e-01 3 1  ON 50
ci_0002                 7.000942e-01 3 1  ON 51
ci_0003                -2.781656e-02 3 1  ON 52
ci_0004                -2.749119e-02 3 1  ON 53
ci_0005                -3.666425e-02 3 1  ON 54
ci_0006                -3.710009e-02 3 1  ON 55
ci_0007                -2.252147e-02 3 1  ON 56
ci_0008                -2.153996e-02 3 1  ON 57
ci_0009                -1.785444e-02 3 1  ON 58
ci_0010                -1.750931e-02 3 1  ON 59
ci_0011                -1.219950e-02 3 1  ON 60
ci_0012                -1.234225e-02 3 1  ON 61
ci_0013                 1.300460e-02 3 1  ON 62
ci_0014                 1.317686e-02 3 1  ON 63
ci_0015                 1.362734e-02 3 1  ON 64
ci_0016                 1.350303e-02 3 1  ON 65
ci_0017                 1.098670e-02 3 1  ON 66
ci_0018                 1.191486e-02 3 1  ON 67
ci_0019                 1.136341e-02 3 1  ON 68
ci_0020                 1.154451e-02 3 1  ON 69
ci_0021                -2.103396e-03 3 1  ON 70
ci_0022                -4.894156e-04 3 1  ON 71
ci_0023                -1.110356e-02 3 1  ON 72
ci_0024                -1.090698e-02 3 1  ON 73
ci_0025                -1.174518e-02 3 1  ON 74
ci_0026                -1.107505e-02 3 1  ON 75
ci_0027                -1.166392e-02 3 1  ON 76
ci_0028                -1.083234e-02 3 1  ON 77
ci_0029                -9.946671e-03 3 1  ON 78
ci_0030                -1.127007e-02 3 1  ON 79
ci_0031                 2.036773e-02 3 1  ON 80
ci_0032                 2.129708e-02 3 1  ON 81
ci_0033                 1.035265e-02 3 1  ON 82
ci_0034                 9.807976e-03 3 1  ON 83
ci_0035                 6.442277e-03 3 1  ON 84
ci_0036                 6.891685e-03 3 1  ON 85
ci_0037                -1.058459e-02 3 1  ON 86
ci_0038                -1.119180e-02 3 1  ON 87
ci_0039                -2.531395e-03 3 1  ON 88
ci_0040                -2.764721e-03 3 1  ON 89
ci_0041                 6.635547e-03 3 1  ON 90
ci_0042                 7.330738e-03 3 1  ON 91
ci_0043                -1.945936e-02 3 1  ON 92
ci_0044                -1.898888e-02 3 1  ON 93
ci_0045                 7.487072e-03 3 1  ON 94
ci_0046                 7.409450e-03 3 1  ON 95
ci_0047                -1.552888e-03 3 1  ON 96
ci_0048                -1.862774e-03 3 1  ON 97
ci_0049                -5.340856e-03 3 1  ON 98
ci_0050                -5.918769e-03 3 1  ON 99
ci_0051                -3.616718e-03 3 1  ON 100
ci_0052                -3.395172e-03 3 1  ON 101
ci_0053                -4.479560e-03 3 1  ON 102
ci_0054                -4.333128e-03 3 1  ON 103
ci_0055                 6.387435e-03 3 1  ON 104
ci_0056                 6.305025e-03 3 1  ON 105
ci_0057                 4.732235e-03 3 1  ON 106
ci_0058                 4.836197e-03 3 1  ON 107
ci_0059                -4.599399e-03 3 1  ON 108
ci_0060                -4.623550e-03 3 1  ON 109
ci_0061                -4.533278e-03 3 1  ON 110
ci_0062                -3.762695e-03 3 1  ON 111
ci_0063                -9.154109e-03 3 1  ON 112
ci_0064                -8.246838e-03 3 1  ON 113
ci_0065                -5.045641e-03 3 1  ON 114
ci_0066                -5.119635e-03 3 1  ON 115
ci_0067                -5.300225e-03 3 1  ON 116
ci_0068                -4.972846e-03 3 1  ON 117
ci_0069                 4.620014e-03 3 1  ON 118
ci_0070                 4.549389e-03 3 1  ON 119
ci_0071                 5.481860e-04 3 1  ON 120
ci_0072                -4.140816e-04 3 1  ON 121
ci_0073                 4.247757e-03 3 1  ON 122
ci_0074                 4.074151e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -16.9268
    reference variance = 0.194136
====================================================
  Execution time = 2.3321e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4155e-01
  Total weights = 1.9515e+06
  Execution time = 1.9005e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328600100852
                                         uncertainty =       0.002993737798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328600100852
                                         uncertainty =       0.002993737798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405299343
  error estimate for blocks of size 2^( 2) =       0.000418330893
  error estimate for blocks of size 2^( 3) =       0.000431076500
  error estimate for blocks of size 2^( 4) =       0.000443407770
  error estimate for blocks of size 2^( 5) =       0.000454321890
  error estimate for blocks of size 2^( 6) =       0.000461361531
  error estimate for blocks of size 2^( 7) =       0.000466116274

      target function =                  N/A
              le_mean =     -16.906408632402
             les_mean =     286.168203353578
             stat err =       0.000456301866
             autocorr =       1.267513780710
              std dev =       0.573179827975
             le_variance =       0.328535115197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328600194486
                                         uncertainty =       0.002993811390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328600194486
                                         uncertainty =       0.002993811390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405299399
  error estimate for blocks of size 2^( 2) =       0.000418330942
  error estimate for blocks of size 2^( 3) =       0.000431076523
  error estimate for blocks of size 2^( 4) =       0.000443407780
  error estimate for blocks of size 2^( 5) =       0.000454321899
  error estimate for blocks of size 2^( 6) =       0.000461361524
  error estimate for blocks of size 2^( 7) =       0.000466116273

      target function =                  N/A
              le_mean =     -16.906408636307
             les_mean =     286.168202054932
             stat err =       0.000456301869
             autocorr =       1.267513449294
              std dev =       0.573179906975
             le_variance =       0.328535205759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328600147616
                                         uncertainty =       0.002993774604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328600147616
                                         uncertainty =       0.002993774604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405299371
  error estimate for blocks of size 2^( 2) =       0.000418330917
  error estimate for blocks of size 2^( 3) =       0.000431076511
  error estimate for blocks of size 2^( 4) =       0.000443407775
  error estimate for blocks of size 2^( 5) =       0.000454321895
  error estimate for blocks of size 2^( 6) =       0.000461361527
  error estimate for blocks of size 2^( 7) =       0.000466116274

      target function =                  N/A
              le_mean =     -16.906408634345
             les_mean =     286.168202691367
             stat err =       0.000456301868
             autocorr =       1.267513614975
              std dev =       0.573179867428
             le_variance =       0.328535160425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328600106689
                                         uncertainty =       0.002993742399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328600106689
                                         uncertainty =       0.002993742399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405299347
  error estimate for blocks of size 2^( 2) =       0.000418330896
  error estimate for blocks of size 2^( 3) =       0.000431076501
  error estimate for blocks of size 2^( 4) =       0.000443407770
  error estimate for blocks of size 2^( 5) =       0.000454321891
  error estimate for blocks of size 2^( 6) =       0.000461361530
  error estimate for blocks of size 2^( 7) =       0.000466116274

      target function =                  N/A
              le_mean =     -16.906408632643
             les_mean =     286.168203269379
             stat err =       0.000456301866
             autocorr =       1.267513760005
              std dev =       0.573179832898
             le_variance =       0.328535120842


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906408632402        initial
     3.4694e+02     3.4694e+03             2.6958e-06       -16.906408636307  <--
     1.3878e+03     1.3878e+04             6.7426e-07       -16.906408634345
     5.5511e+03     5.5511e+04             1.6858e-07       -16.906408632643

*****************************************************************************
Applying the update for shift_i =   3.4694e+02     and shift_s =   3.4694e+03
*****************************************************************************

  Execution time = 3.3006e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
   uu_0                 3.117508e-01 1 1  ON 0
   uu_1                 1.447378e-01 1 1  ON 1
   uu_2                 4.305877e-02 1 1  ON 2
   uu_3                -1.916538e-02 1 1  ON 3
   uu_4                -6.454597e-02 1 1  ON 4
   uu_5                -9.933130e-02 1 1  ON 5
   uu_6                -1.264825e-01 1 1  ON 6
   uu_7                -1.389795e-01 1 1  ON 7
   uu_8                -1.311517e-01 1 1  ON 8
   uu_9                -1.002755e-01 1 1  ON 9
   ud_0                 4.453611e-01 1 1  ON 10
   ud_1                 1.799292e-01 1 1  ON 11
   ud_2                 5.987667e-02 1 1  ON 12
   ud_3                -1.076741e-02 1 1  ON 13
   ud_4                -6.720135e-02 1 1  ON 14
   ud_5                -1.077663e-01 1 1  ON 15
   ud_6                -1.341363e-01 1 1  ON 16
   ud_7                -1.497578e-01 1 1  ON 17
   ud_8                -1.506350e-01 1 1  ON 18
   ud_9                -1.385811e-01 1 1  ON 19
   eO_0                -7.471046e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909310e-02 1 1  ON 22
   eO_3                 2.902565e-01 1 1  ON 23
   eO_4                 5.129975e-01 1 1  ON 24
   eO_5                 4.729043e-01 1 1  ON 25
   eO_6                 2.454341e-01 1 1  ON 26
   eO_7                -4.920469e-02 1 1  ON 27
   eO_8                -2.099797e-01 1 1  ON 28
   eO_9                -6.985129e-02 1 1  ON 29
  eH1_0                -2.490233e-01 1 1  ON 30
  eH1_1                -1.410017e-01 1 1  ON 31
  eH1_2                -9.187548e-02 1 1  ON 32
  eH1_3                -3.738779e-02 1 1  ON 33
  eH1_4                 1.162255e-02 1 1  ON 34
  eH1_5                 4.534962e-02 1 1  ON 35
  eH1_6                 1.014831e-01 1 1  ON 36
  eH1_7                 1.507943e-01 1 1  ON 37
  eH1_8                 1.645764e-01 1 1  ON 38
  eH1_9                 4.967999e-02 1 1  ON 39
  eH2_0                -2.461154e-01 1 1  ON 40
  eH2_1                -1.390226e-01 1 1  ON 41
  eH2_2                -8.956091e-02 1 1  ON 42
  eH2_3                -3.460215e-02 1 1  ON 43
  eH2_4                 1.430639e-02 1 1  ON 44
  eH2_5                 4.960835e-02 1 1  ON 45
  eH2_6                 1.052388e-01 1 1  ON 46
  eH2_7                 1.534303e-01 1 1  ON 47
  eH2_8                 1.693352e-01 1 1  ON 48
  eH2_9                 3.486396e-02 1 1  ON 49
ci_0001                 7.014434e-01 3 1  ON 50
ci_0002                 7.000944e-01 3 1  ON 51
ci_0003                -2.781663e-02 3 1  ON 52
ci_0004                -2.749184e-02 3 1  ON 53
ci_0005                -3.666467e-02 3 1  ON 54
ci_0006                -3.709991e-02 3 1  ON 55
ci_0007                -2.252150e-02 3 1  ON 56
ci_0008                -2.153999e-02 3 1  ON 57
ci_0009                -1.785431e-02 3 1  ON 58
ci_0010                -1.750845e-02 3 1  ON 59
ci_0011                -1.219945e-02 3 1  ON 60
ci_0012                -1.234205e-02 3 1  ON 61
ci_0013                 1.300476e-02 3 1  ON 62
ci_0014                 1.317717e-02 3 1  ON 63
ci_0015                 1.362741e-02 3 1  ON 64
ci_0016                 1.350249e-02 3 1  ON 65
ci_0017                 1.098675e-02 3 1  ON 66
ci_0018                 1.191439e-02 3 1  ON 67
ci_0019                 1.136321e-02 3 1  ON 68
ci_0020                 1.154394e-02 3 1  ON 69
ci_0021                -2.103315e-03 3 1  ON 70
ci_0022                -4.886827e-04 3 1  ON 71
ci_0023                -1.110340e-02 3 1  ON 72
ci_0024                -1.090718e-02 3 1  ON 73
ci_0025                -1.174438e-02 3 1  ON 74
ci_0026                -1.107525e-02 3 1  ON 75
ci_0027                -1.166394e-02 3 1  ON 76
ci_0028                -1.083200e-02 3 1  ON 77
ci_0029                -9.947120e-03 3 1  ON 78
ci_0030                -1.126805e-02 3 1  ON 79
ci_0031                 2.036777e-02 3 1  ON 80
ci_0032                 2.129675e-02 3 1  ON 81
ci_0033                 1.035268e-02 3 1  ON 82
ci_0034                 9.808192e-03 3 1  ON 83
ci_0035                 6.442380e-03 3 1  ON 84
ci_0036                 6.891379e-03 3 1  ON 85
ci_0037                -1.058434e-02 3 1  ON 86
ci_0038                -1.119204e-02 3 1  ON 87
ci_0039                -2.531130e-03 3 1  ON 88
ci_0040                -2.764563e-03 3 1  ON 89
ci_0041                 6.635937e-03 3 1  ON 90
ci_0042                 7.330902e-03 3 1  ON 91
ci_0043                -1.945941e-02 3 1  ON 92
ci_0044                -1.898905e-02 3 1  ON 93
ci_0045                 7.487389e-03 3 1  ON 94
ci_0046                 7.409877e-03 3 1  ON 95
ci_0047                -1.553031e-03 3 1  ON 96
ci_0048                -1.862781e-03 3 1  ON 97
ci_0049                -5.340973e-03 3 1  ON 98
ci_0050                -5.918452e-03 3 1  ON 99
ci_0051                -3.616793e-03 3 1  ON 100
ci_0052                -3.394556e-03 3 1  ON 101
ci_0053                -4.479609e-03 3 1  ON 102
ci_0054                -4.332952e-03 3 1  ON 103
ci_0055                 6.387713e-03 3 1  ON 104
ci_0056                 6.305140e-03 3 1  ON 105
ci_0057                 4.732358e-03 3 1  ON 106
ci_0058                 4.836870e-03 3 1  ON 107
ci_0059                -4.599781e-03 3 1  ON 108
ci_0060                -4.624038e-03 3 1  ON 109
ci_0061                -4.532902e-03 3 1  ON 110
ci_0062                -3.762594e-03 3 1  ON 111
ci_0063                -9.154369e-03 3 1  ON 112
ci_0064                -8.246676e-03 3 1  ON 113
ci_0065                -5.045692e-03 3 1  ON 114
ci_0066                -5.119295e-03 3 1  ON 115
ci_0067                -5.300139e-03 3 1  ON 116
ci_0068                -4.972906e-03 3 1  ON 117
ci_0069                 4.620118e-03 3 1  ON 118
ci_0070                 4.548413e-03 3 1  ON 119
ci_0071                 5.478120e-04 3 1  ON 120
ci_0072                -4.140181e-04 3 1  ON 121
ci_0073                 4.247720e-03 3 1  ON 122
ci_0074                 4.073951e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0677e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -16.9252
    reference variance = 0.199901
====================================================
  Execution time = 2.1532e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3200e-01
  Total weights = 1.951420565e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0157e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320868926981
                                         uncertainty =       0.001718495330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320868926981
                                         uncertainty =       0.001718495330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400521979
  error estimate for blocks of size 2^( 2) =       0.000413468710
  error estimate for blocks of size 2^( 3) =       0.000427320896
  error estimate for blocks of size 2^( 4) =       0.000440400601
  error estimate for blocks of size 2^( 5) =       0.000452467908
  error estimate for blocks of size 2^( 6) =       0.000462215774
  error estimate for blocks of size 2^( 7) =       0.000466894046

      target function =                  N/A
              le_mean =     -16.905611419588
             les_mean =     286.131695109166
             stat err =       0.000455494583
             autocorr =       1.293343022956
              std dev =       0.566423615254
             le_variance =       0.320835711917


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690561141959e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+01, overlap shift 8.6736e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905611419568       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905611453243       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905611453644       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905611463419       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905611462247       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905611468299       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905611470426       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905611469495       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905611468957       residual = 9.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.6736e+01 is 3.763492e-06

solving harmonic davidson linear method for identity shift 3.4694e+02, overlap shift 3.4694e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905611419568       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905611428002       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905611428105       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905611430557       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905611430267       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905611431784       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905611432317       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905611432087       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905611431951       residual = 9.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.4694e+02 is 9.424013e-07

solving harmonic davidson linear method for identity shift 1.3878e+03, overlap shift 1.3878e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905611419568       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905611421678       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905611421704       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905611422317       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905611422244       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905611422623       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905611422758       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905611422696       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905611422669       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3878e+03 is 2.356960e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.564608 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7555e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
   uu_0                 3.117510e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305856e-02 1 1  ON 2
   uu_3                -1.916550e-02 1 1  ON 3
   uu_4                -6.454603e-02 1 1  ON 4
   uu_5                -9.933096e-02 1 1  ON 5
   uu_6                -1.264829e-01 1 1  ON 6
   uu_7                -1.389797e-01 1 1  ON 7
   uu_8                -1.311517e-01 1 1  ON 8
   uu_9                -1.002757e-01 1 1  ON 9
   ud_0                 4.453613e-01 1 1  ON 10
   ud_1                 1.799291e-01 1 1  ON 11
   ud_2                 5.987689e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720137e-02 1 1  ON 14
   ud_5                -1.077665e-01 1 1  ON 15
   ud_6                -1.341365e-01 1 1  ON 16
   ud_7                -1.497579e-01 1 1  ON 17
   ud_8                -1.506348e-01 1 1  ON 18
   ud_9                -1.385811e-01 1 1  ON 19
   eO_0                -7.471052e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909315e-02 1 1  ON 22
   eO_3                 2.902567e-01 1 1  ON 23
   eO_4                 5.129978e-01 1 1  ON 24
   eO_5                 4.729048e-01 1 1  ON 25
   eO_6                 2.454343e-01 1 1  ON 26
   eO_7                -4.920455e-02 1 1  ON 27
   eO_8                -2.099799e-01 1 1  ON 28
   eO_9                -6.985162e-02 1 1  ON 29
  eH1_0                -2.490236e-01 1 1  ON 30
  eH1_1                -1.410023e-01 1 1  ON 31
  eH1_2                -9.187564e-02 1 1  ON 32
  eH1_3                -3.738815e-02 1 1  ON 33
  eH1_4                 1.162225e-02 1 1  ON 34
  eH1_5                 4.534950e-02 1 1  ON 35
  eH1_6                 1.014833e-01 1 1  ON 36
  eH1_7                 1.507948e-01 1 1  ON 37
  eH1_8                 1.645770e-01 1 1  ON 38
  eH1_9                 4.968049e-02 1 1  ON 39
  eH2_0                -2.461161e-01 1 1  ON 40
  eH2_1                -1.390228e-01 1 1  ON 41
  eH2_2                -8.956096e-02 1 1  ON 42
  eH2_3                -3.460243e-02 1 1  ON 43
  eH2_4                 1.430641e-02 1 1  ON 44
  eH2_5                 4.960815e-02 1 1  ON 45
  eH2_6                 1.052387e-01 1 1  ON 46
  eH2_7                 1.534303e-01 1 1  ON 47
  eH2_8                 1.693357e-01 1 1  ON 48
  eH2_9                 3.486467e-02 1 1  ON 49
ci_0001                 7.014437e-01 3 1  ON 50
ci_0002                 7.000942e-01 3 1  ON 51
ci_0003                -2.781637e-02 3 1  ON 52
ci_0004                -2.749166e-02 3 1  ON 53
ci_0005                -3.666451e-02 3 1  ON 54
ci_0006                -3.709987e-02 3 1  ON 55
ci_0007                -2.252096e-02 3 1  ON 56
ci_0008                -2.153995e-02 3 1  ON 57
ci_0009                -1.785386e-02 3 1  ON 58
ci_0010                -1.750756e-02 3 1  ON 59
ci_0011                -1.219920e-02 3 1  ON 60
ci_0012                -1.234240e-02 3 1  ON 61
ci_0013                 1.300497e-02 3 1  ON 62
ci_0014                 1.317761e-02 3 1  ON 63
ci_0015                 1.362711e-02 3 1  ON 64
ci_0016                 1.350209e-02 3 1  ON 65
ci_0017                 1.098696e-02 3 1  ON 66
ci_0018                 1.191428e-02 3 1  ON 67
ci_0019                 1.136357e-02 3 1  ON 68
ci_0020                 1.154349e-02 3 1  ON 69
ci_0021                -2.103072e-03 3 1  ON 70
ci_0022                -4.891307e-04 3 1  ON 71
ci_0023                -1.110316e-02 3 1  ON 72
ci_0024                -1.090705e-02 3 1  ON 73
ci_0025                -1.174428e-02 3 1  ON 74
ci_0026                -1.107515e-02 3 1  ON 75
ci_0027                -1.166306e-02 3 1  ON 76
ci_0028                -1.083149e-02 3 1  ON 77
ci_0029                -9.947367e-03 3 1  ON 78
ci_0030                -1.126788e-02 3 1  ON 79
ci_0031                 2.036740e-02 3 1  ON 80
ci_0032                 2.129613e-02 3 1  ON 81
ci_0033                 1.035313e-02 3 1  ON 82
ci_0034                 9.808578e-03 3 1  ON 83
ci_0035                 6.442474e-03 3 1  ON 84
ci_0036                 6.891534e-03 3 1  ON 85
ci_0037                -1.058411e-02 3 1  ON 86
ci_0038                -1.119138e-02 3 1  ON 87
ci_0039                -2.531256e-03 3 1  ON 88
ci_0040                -2.764740e-03 3 1  ON 89
ci_0041                 6.636486e-03 3 1  ON 90
ci_0042                 7.330766e-03 3 1  ON 91
ci_0043                -1.945920e-02 3 1  ON 92
ci_0044                -1.898920e-02 3 1  ON 93
ci_0045                 7.487439e-03 3 1  ON 94
ci_0046                 7.409756e-03 3 1  ON 95
ci_0047                -1.552989e-03 3 1  ON 96
ci_0048                -1.862752e-03 3 1  ON 97
ci_0049                -5.341823e-03 3 1  ON 98
ci_0050                -5.918401e-03 3 1  ON 99
ci_0051                -3.616451e-03 3 1  ON 100
ci_0052                -3.394435e-03 3 1  ON 101
ci_0053                -4.480470e-03 3 1  ON 102
ci_0054                -4.333270e-03 3 1  ON 103
ci_0055                 6.387444e-03 3 1  ON 104
ci_0056                 6.305012e-03 3 1  ON 105
ci_0057                 4.731862e-03 3 1  ON 106
ci_0058                 4.837812e-03 3 1  ON 107
ci_0059                -4.600085e-03 3 1  ON 108
ci_0060                -4.623597e-03 3 1  ON 109
ci_0061                -4.532683e-03 3 1  ON 110
ci_0062                -3.763067e-03 3 1  ON 111
ci_0063                -9.153702e-03 3 1  ON 112
ci_0064                -8.247568e-03 3 1  ON 113
ci_0065                -5.045531e-03 3 1  ON 114
ci_0066                -5.119152e-03 3 1  ON 115
ci_0067                -5.300136e-03 3 1  ON 116
ci_0068                -4.972585e-03 3 1  ON 117
ci_0069                 4.620314e-03 3 1  ON 118
ci_0070                 4.548152e-03 3 1  ON 119
ci_0071                 5.473710e-04 3 1  ON 120
ci_0072                -4.138257e-04 3 1  ON 121
ci_0073                 4.247629e-03 3 1  ON 122
ci_0074                 4.073871e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -16.9098
    reference variance = 0.2622
====================================================
  Execution time = 2.1505e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3776e-01
  Total weights = 1.9516e+06
  Execution time = 1.8901e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322796868710
                                         uncertainty =       0.002167745853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322796868710
                                         uncertainty =       0.002167745853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401669712
  error estimate for blocks of size 2^( 2) =       0.000414460513
  error estimate for blocks of size 2^( 3) =       0.000427523761
  error estimate for blocks of size 2^( 4) =       0.000439484246
  error estimate for blocks of size 2^( 5) =       0.000449485907
  error estimate for blocks of size 2^( 6) =       0.000456721180
  error estimate for blocks of size 2^( 7) =       0.000458693729

      target function =                  N/A
              le_mean =     -16.905551649407
             les_mean =     286.135435261659
             stat err =       0.000451096266
             autocorr =       1.261247428900
              std dev =       0.568046754159
             le_variance =       0.322677114911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322797563256
                                         uncertainty =       0.002167810526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322797563256
                                         uncertainty =       0.002167810526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401670143
  error estimate for blocks of size 2^( 2) =       0.000414461040
  error estimate for blocks of size 2^( 3) =       0.000427524325
  error estimate for blocks of size 2^( 4) =       0.000439484822
  error estimate for blocks of size 2^( 5) =       0.000449486540
  error estimate for blocks of size 2^( 6) =       0.000456722010
  error estimate for blocks of size 2^( 7) =       0.000458694505

      target function =                  N/A
              le_mean =     -16.905551691493
             les_mean =     286.135433691859
             stat err =       0.000451096969
             autocorr =       1.261248655623
              std dev =       0.568047364149
             le_variance =       0.322677807916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322797214870
                                         uncertainty =       0.002167778233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322797214870
                                         uncertainty =       0.002167778233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401669927
  error estimate for blocks of size 2^( 2) =       0.000414460776
  error estimate for blocks of size 2^( 3) =       0.000427524043
  error estimate for blocks of size 2^( 4) =       0.000439484534
  error estimate for blocks of size 2^( 5) =       0.000449486223
  error estimate for blocks of size 2^( 6) =       0.000456721595
  error estimate for blocks of size 2^( 7) =       0.000458694117

      target function =                  N/A
              le_mean =     -16.905551670417
             les_mean =     286.135434239163
             stat err =       0.000451096617
             autocorr =       1.261248045437
              std dev =       0.568047058174
             le_variance =       0.322677460301

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322796911868
                                         uncertainty =       0.002167749901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322796911868
                                         uncertainty =       0.002167749901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401669739
  error estimate for blocks of size 2^( 2) =       0.000414460546
  error estimate for blocks of size 2^( 3) =       0.000427523796
  error estimate for blocks of size 2^( 4) =       0.000439484282
  error estimate for blocks of size 2^( 5) =       0.000449485947
  error estimate for blocks of size 2^( 6) =       0.000456721232
  error estimate for blocks of size 2^( 7) =       0.000458693777

      target function =                  N/A
              le_mean =     -16.905551652024
             les_mean =     286.135435106398
             stat err =       0.000451096309
             autocorr =       1.261247506120
              std dev =       0.568046792062
             le_variance =       0.322677157972


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905551649407        initial
     8.6736e+01     8.6736e+02             3.7635e-06       -16.905551691493  <--
     3.4694e+02     3.4694e+03             9.4240e-07       -16.905551670417
     1.3878e+03     1.3878e+04             2.3570e-07       -16.905551652024

*****************************************************************************
Applying the update for shift_i =   8.6736e+01     and shift_s =   8.6736e+02
*****************************************************************************

  Execution time = 3.1105e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
   uu_0                 3.117517e-01 1 1  ON 0
   uu_1                 1.447375e-01 1 1  ON 1
   uu_2                 4.305793e-02 1 1  ON 2
   uu_3                -1.916583e-02 1 1  ON 3
   uu_4                -6.454623e-02 1 1  ON 4
   uu_5                -9.932994e-02 1 1  ON 5
   uu_6                -1.264841e-01 1 1  ON 6
   uu_7                -1.389802e-01 1 1  ON 7
   uu_8                -1.311516e-01 1 1  ON 8
   uu_9                -1.002761e-01 1 1  ON 9
   ud_0                 4.453619e-01 1 1  ON 10
   ud_1                 1.799291e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076775e-02 1 1  ON 13
   ud_4                -6.720143e-02 1 1  ON 14
   ud_5                -1.077669e-01 1 1  ON 15
   ud_6                -1.341371e-01 1 1  ON 16
   ud_7                -1.497582e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385812e-01 1 1  ON 19
   eO_0                -7.471072e-01 1 1  ON 20
   eO_1                -4.277001e-01 1 1  ON 21
   eO_2                -1.909333e-02 1 1  ON 22
   eO_3                 2.902574e-01 1 1  ON 23
   eO_4                 5.129987e-01 1 1  ON 24
   eO_5                 4.729062e-01 1 1  ON 25
   eO_6                 2.454349e-01 1 1  ON 26
   eO_7                -4.920415e-02 1 1  ON 27
   eO_8                -2.099806e-01 1 1  ON 28
   eO_9                -6.985261e-02 1 1  ON 29
  eH1_0                -2.490243e-01 1 1  ON 30
  eH1_1                -1.410039e-01 1 1  ON 31
  eH1_2                -9.187611e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162133e-02 1 1  ON 34
  eH1_5                 4.534912e-02 1 1  ON 35
  eH1_6                 1.014838e-01 1 1  ON 36
  eH1_7                 1.507964e-01 1 1  ON 37
  eH1_8                 1.645788e-01 1 1  ON 38
  eH1_9                 4.968197e-02 1 1  ON 39
  eH2_0                -2.461182e-01 1 1  ON 40
  eH2_1                -1.390231e-01 1 1  ON 41
  eH2_2                -8.956111e-02 1 1  ON 42
  eH2_3                -3.460328e-02 1 1  ON 43
  eH2_4                 1.430646e-02 1 1  ON 44
  eH2_5                 4.960753e-02 1 1  ON 45
  eH2_6                 1.052385e-01 1 1  ON 46
  eH2_7                 1.534305e-01 1 1  ON 47
  eH2_8                 1.693373e-01 1 1  ON 48
  eH2_9                 3.486678e-02 1 1  ON 49
ci_0001                 7.014447e-01 3 1  ON 50
ci_0002                 7.000936e-01 3 1  ON 51
ci_0003                -2.781559e-02 3 1  ON 52
ci_0004                -2.749111e-02 3 1  ON 53
ci_0005                -3.666402e-02 3 1  ON 54
ci_0006                -3.709973e-02 3 1  ON 55
ci_0007                -2.251934e-02 3 1  ON 56
ci_0008                -2.153984e-02 3 1  ON 57
ci_0009                -1.785254e-02 3 1  ON 58
ci_0010                -1.750490e-02 3 1  ON 59
ci_0011                -1.219843e-02 3 1  ON 60
ci_0012                -1.234343e-02 3 1  ON 61
ci_0013                 1.300559e-02 3 1  ON 62
ci_0014                 1.317893e-02 3 1  ON 63
ci_0015                 1.362621e-02 3 1  ON 64
ci_0016                 1.350088e-02 3 1  ON 65
ci_0017                 1.098759e-02 3 1  ON 66
ci_0018                 1.191394e-02 3 1  ON 67
ci_0019                 1.136465e-02 3 1  ON 68
ci_0020                 1.154212e-02 3 1  ON 69
ci_0021                -2.102344e-03 3 1  ON 70
ci_0022                -4.904733e-04 3 1  ON 71
ci_0023                -1.110241e-02 3 1  ON 72
ci_0024                -1.090666e-02 3 1  ON 73
ci_0025                -1.174397e-02 3 1  ON 74
ci_0026                -1.107486e-02 3 1  ON 75
ci_0027                -1.166043e-02 3 1  ON 76
ci_0028                -1.082997e-02 3 1  ON 77
ci_0029                -9.948108e-03 3 1  ON 78
ci_0030                -1.126738e-02 3 1  ON 79
ci_0031                 2.036630e-02 3 1  ON 80
ci_0032                 2.129427e-02 3 1  ON 81
ci_0033                 1.035447e-02 3 1  ON 82
ci_0034                 9.809737e-03 3 1  ON 83
ci_0035                 6.442754e-03 3 1  ON 84
ci_0036                 6.891998e-03 3 1  ON 85
ci_0037                -1.058341e-02 3 1  ON 86
ci_0038                -1.118940e-02 3 1  ON 87
ci_0039                -2.531630e-03 3 1  ON 88
ci_0040                -2.765270e-03 3 1  ON 89
ci_0041                 6.638130e-03 3 1  ON 90
ci_0042                 7.330360e-03 3 1  ON 91
ci_0043                -1.945857e-02 3 1  ON 92
ci_0044                -1.898964e-02 3 1  ON 93
ci_0045                 7.487589e-03 3 1  ON 94
ci_0046                 7.409396e-03 3 1  ON 95
ci_0047                -1.552864e-03 3 1  ON 96
ci_0048                -1.862664e-03 3 1  ON 97
ci_0049                -5.344368e-03 3 1  ON 98
ci_0050                -5.918247e-03 3 1  ON 99
ci_0051                -3.615429e-03 3 1  ON 100
ci_0052                -3.394074e-03 3 1  ON 101
ci_0053                -4.483045e-03 3 1  ON 102
ci_0054                -4.334220e-03 3 1  ON 103
ci_0055                 6.386636e-03 3 1  ON 104
ci_0056                 6.304628e-03 3 1  ON 105
ci_0057                 4.730378e-03 3 1  ON 106
ci_0058                 4.840633e-03 3 1  ON 107
ci_0059                -4.600994e-03 3 1  ON 108
ci_0060                -4.622278e-03 3 1  ON 109
ci_0061                -4.532026e-03 3 1  ON 110
ci_0062                -3.764484e-03 3 1  ON 111
ci_0063                -9.151709e-03 3 1  ON 112
ci_0064                -8.250236e-03 3 1  ON 113
ci_0065                -5.045049e-03 3 1  ON 114
ci_0066                -5.118722e-03 3 1  ON 115
ci_0067                -5.300127e-03 3 1  ON 116
ci_0068                -4.971627e-03 3 1  ON 117
ci_0069                 4.620899e-03 3 1  ON 118
ci_0070                 4.547373e-03 3 1  ON 119
ci_0071                 5.460520e-04 3 1  ON 120
ci_0072                -4.132504e-04 3 1  ON 121
ci_0073                 4.247356e-03 3 1  ON 122
ci_0074                 4.073630e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8668e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -16.8417
    reference variance = 0.383619
====================================================
  Execution time = 2.1388e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3238e-01
  Total weights = 1.951452514e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1204e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321708714735
                                         uncertainty =       0.002232662778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321708714735
                                         uncertainty =       0.002232662778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401073879
  error estimate for blocks of size 2^( 2) =       0.000413699357
  error estimate for blocks of size 2^( 3) =       0.000427026730
  error estimate for blocks of size 2^( 4) =       0.000440150402
  error estimate for blocks of size 2^( 5) =       0.000451743609
  error estimate for blocks of size 2^( 6) =       0.000461009746
  error estimate for blocks of size 2^( 7) =       0.000467541366

      target function =                  N/A
              le_mean =     -16.905864536670
             les_mean =     286.140640084653
             stat err =       0.000455111281
             autocorr =       1.287616237721
              std dev =       0.567204118787
             le_variance =       0.321720512369


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690586453667e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+01, overlap shift 2.1684e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905864536669       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905864956422       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905864947526       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905864916508       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905864893856       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905864888206       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905864886824       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905864884149       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905864882419       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905864883525       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.1684e+01 is 1.622002e-05

solving harmonic davidson linear method for identity shift 8.6736e+01, overlap shift 8.6736e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905864536669       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905864642443       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905864640241       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905864632508       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905864626808       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905864625308       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905864624907       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905864624233       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905864623750       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905864623999       residual = 3.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.6736e+01 is 4.102150e-06

solving harmonic davidson linear method for identity shift 3.4694e+02, overlap shift 3.4694e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905864536669       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905864563165       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905864562616       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905864560684       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905864559257       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905864558877       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905864558773       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905864558604       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905864558480       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905864558540       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.4694e+02 is 1.028530e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.568543 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7517e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
   uu_0                 3.117548e-01 1 1  ON 0
   uu_1                 1.447359e-01 1 1  ON 1
   uu_2                 4.305809e-02 1 1  ON 2
   uu_3                -1.916693e-02 1 1  ON 3
   uu_4                -6.454591e-02 1 1  ON 4
   uu_5                -9.932988e-02 1 1  ON 5
   uu_6                -1.264846e-01 1 1  ON 6
   uu_7                -1.389813e-01 1 1  ON 7
   uu_8                -1.311529e-01 1 1  ON 8
   uu_9                -1.002768e-01 1 1  ON 9
   ud_0                 4.453640e-01 1 1  ON 10
   ud_1                 1.799289e-01 1 1  ON 11
   ud_2                 5.987788e-02 1 1  ON 12
   ud_3                -1.076731e-02 1 1  ON 13
   ud_4                -6.720138e-02 1 1  ON 14
   ud_5                -1.077682e-01 1 1  ON 15
   ud_6                -1.341389e-01 1 1  ON 16
   ud_7                -1.497580e-01 1 1  ON 17
   ud_8                -1.506336e-01 1 1  ON 18
   ud_9                -1.385812e-01 1 1  ON 19
   eO_0                -7.471083e-01 1 1  ON 20
   eO_1                -4.277005e-01 1 1  ON 21
   eO_2                -1.909349e-02 1 1  ON 22
   eO_3                 2.902580e-01 1 1  ON 23
   eO_4                 5.129998e-01 1 1  ON 24
   eO_5                 4.729073e-01 1 1  ON 25
   eO_6                 2.454364e-01 1 1  ON 26
   eO_7                -4.920366e-02 1 1  ON 27
   eO_8                -2.099822e-01 1 1  ON 28
   eO_9                -6.985390e-02 1 1  ON 29
  eH1_0                -2.490251e-01 1 1  ON 30
  eH1_1                -1.410037e-01 1 1  ON 31
  eH1_2                -9.187843e-02 1 1  ON 32
  eH1_3                -3.738975e-02 1 1  ON 33
  eH1_4                 1.161998e-02 1 1  ON 34
  eH1_5                 4.534887e-02 1 1  ON 35
  eH1_6                 1.014829e-01 1 1  ON 36
  eH1_7                 1.507977e-01 1 1  ON 37
  eH1_8                 1.645814e-01 1 1  ON 38
  eH1_9                 4.968400e-02 1 1  ON 39
  eH2_0                -2.461197e-01 1 1  ON 40
  eH2_1                -1.390252e-01 1 1  ON 41
  eH2_2                -8.956060e-02 1 1  ON 42
  eH2_3                -3.460537e-02 1 1  ON 43
  eH2_4                 1.430631e-02 1 1  ON 44
  eH2_5                 4.960655e-02 1 1  ON 45
  eH2_6                 1.052395e-01 1 1  ON 46
  eH2_7                 1.534312e-01 1 1  ON 47
  eH2_8                 1.693391e-01 1 1  ON 48
  eH2_9                 3.486926e-02 1 1  ON 49
ci_0001                 7.014443e-01 3 1  ON 50
ci_0002                 7.000944e-01 3 1  ON 51
ci_0003                -2.781596e-02 3 1  ON 52
ci_0004                -2.748938e-02 3 1  ON 53
ci_0005                -3.666098e-02 3 1  ON 54
ci_0006                -3.709820e-02 3 1  ON 55
ci_0007                -2.251789e-02 3 1  ON 56
ci_0008                -2.154049e-02 3 1  ON 57
ci_0009                -1.785033e-02 3 1  ON 58
ci_0010                -1.750522e-02 3 1  ON 59
ci_0011                -1.220043e-02 3 1  ON 60
ci_0012                -1.234480e-02 3 1  ON 61
ci_0013                 1.300544e-02 3 1  ON 62
ci_0014                 1.318026e-02 3 1  ON 63
ci_0015                 1.362675e-02 3 1  ON 64
ci_0016                 1.349795e-02 3 1  ON 65
ci_0017                 1.098853e-02 3 1  ON 66
ci_0018                 1.191240e-02 3 1  ON 67
ci_0019                 1.136355e-02 3 1  ON 68
ci_0020                 1.154334e-02 3 1  ON 69
ci_0021                -2.100240e-03 3 1  ON 70
ci_0022                -4.913693e-04 3 1  ON 71
ci_0023                -1.110245e-02 3 1  ON 72
ci_0024                -1.090772e-02 3 1  ON 73
ci_0025                -1.174035e-02 3 1  ON 74
ci_0026                -1.107383e-02 3 1  ON 75
ci_0027                -1.165851e-02 3 1  ON 76
ci_0028                -1.083007e-02 3 1  ON 77
ci_0029                -9.950288e-03 3 1  ON 78
ci_0030                -1.126619e-02 3 1  ON 79
ci_0031                 2.036773e-02 3 1  ON 80
ci_0032                 2.129484e-02 3 1  ON 81
ci_0033                 1.035640e-02 3 1  ON 82
ci_0034                 9.809833e-03 3 1  ON 83
ci_0035                 6.443834e-03 3 1  ON 84
ci_0036                 6.891099e-03 3 1  ON 85
ci_0037                -1.058361e-02 3 1  ON 86
ci_0038                -1.119010e-02 3 1  ON 87
ci_0039                -2.532100e-03 3 1  ON 88
ci_0040                -2.764551e-03 3 1  ON 89
ci_0041                 6.638108e-03 3 1  ON 90
ci_0042                 7.328028e-03 3 1  ON 91
ci_0043                -1.945629e-02 3 1  ON 92
ci_0044                -1.898857e-02 3 1  ON 93
ci_0045                 7.487941e-03 3 1  ON 94
ci_0046                 7.408598e-03 3 1  ON 95
ci_0047                -1.553133e-03 3 1  ON 96
ci_0048                -1.858562e-03 3 1  ON 97
ci_0049                -5.346225e-03 3 1  ON 98
ci_0050                -5.916674e-03 3 1  ON 99
ci_0051                -3.613197e-03 3 1  ON 100
ci_0052                -3.393671e-03 3 1  ON 101
ci_0053                -4.483559e-03 3 1  ON 102
ci_0054                -4.335248e-03 3 1  ON 103
ci_0055                 6.386873e-03 3 1  ON 104
ci_0056                 6.306641e-03 3 1  ON 105
ci_0057                 4.730385e-03 3 1  ON 106
ci_0058                 4.838731e-03 3 1  ON 107
ci_0059                -4.597799e-03 3 1  ON 108
ci_0060                -4.625559e-03 3 1  ON 109
ci_0061                -4.532232e-03 3 1  ON 110
ci_0062                -3.765168e-03 3 1  ON 111
ci_0063                -9.152380e-03 3 1  ON 112
ci_0064                -8.249212e-03 3 1  ON 113
ci_0065                -5.046209e-03 3 1  ON 114
ci_0066                -5.121392e-03 3 1  ON 115
ci_0067                -5.297965e-03 3 1  ON 116
ci_0068                -4.970417e-03 3 1  ON 117
ci_0069                 4.619861e-03 3 1  ON 118
ci_0070                 4.547133e-03 3 1  ON 119
ci_0071                 5.438519e-04 3 1  ON 120
ci_0072                -4.129782e-04 3 1  ON 121
ci_0073                 4.248672e-03 3 1  ON 122
ci_0074                 4.076085e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -16.8536
    reference variance = 0.334525
====================================================
  Execution time = 2.1269e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3992e-01
  Total weights = 1.9519e+06
  Execution time = 1.8949e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323237760847
                                         uncertainty =       0.002879293674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323237760847
                                         uncertainty =       0.002879293674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401992185
  error estimate for blocks of size 2^( 2) =       0.000414887200
  error estimate for blocks of size 2^( 3) =       0.000428121831
  error estimate for blocks of size 2^( 4) =       0.000440509642
  error estimate for blocks of size 2^( 5) =       0.000450560498
  error estimate for blocks of size 2^( 6) =       0.000458008628
  error estimate for blocks of size 2^( 7) =       0.000462393183

      target function =                  N/A
              le_mean =     -16.905940731891
             les_mean =     286.150749885109
             stat err =       0.000452867988
             autocorr =       1.269135593644
              std dev =       0.568502800102
             le_variance =       0.323195433724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323245218859
                                         uncertainty =       0.002883871697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323245218859
                                         uncertainty =       0.002883871697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401996811
  error estimate for blocks of size 2^( 2) =       0.000414891581
  error estimate for blocks of size 2^( 3) =       0.000428126019
  error estimate for blocks of size 2^( 4) =       0.000440513234
  error estimate for blocks of size 2^( 5) =       0.000450563707
  error estimate for blocks of size 2^( 6) =       0.000458012172
  error estimate for blocks of size 2^( 7) =       0.000462396467

      target function =                  N/A
              le_mean =     -16.905940676385
             les_mean =     286.150754351752
             stat err =       0.000452871395
             autocorr =       1.269125483939
              std dev =       0.568509341688
             le_variance =       0.323202871586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323241500235
                                         uncertainty =       0.002881593726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323241500235
                                         uncertainty =       0.002881593726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401994504
  error estimate for blocks of size 2^( 2) =       0.000414889397
  error estimate for blocks of size 2^( 3) =       0.000428123931
  error estimate for blocks of size 2^( 4) =       0.000440511442
  error estimate for blocks of size 2^( 5) =       0.000450562105
  error estimate for blocks of size 2^( 6) =       0.000458010406
  error estimate for blocks of size 2^( 7) =       0.000462394829

      target function =                  N/A
              le_mean =     -16.905940702426
             les_mean =     286.150751669491
             stat err =       0.000452869695
             autocorr =       1.269130520939
              std dev =       0.568506080021
             le_variance =       0.323199163021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323238227007
                                         uncertainty =       0.002879581238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323238227007
                                         uncertainty =       0.002879581238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401992474
  error estimate for blocks of size 2^( 2) =       0.000414887474
  error estimate for blocks of size 2^( 3) =       0.000428122092
  error estimate for blocks of size 2^( 4) =       0.000440509866
  error estimate for blocks of size 2^( 5) =       0.000450560698
  error estimate for blocks of size 2^( 6) =       0.000458008850
  error estimate for blocks of size 2^( 7) =       0.000462393388

      target function =                  N/A
              le_mean =     -16.905940728029
             les_mean =     286.150750055037
             stat err =       0.000452868200
             autocorr =       1.269134959964
              std dev =       0.568503208982
             le_variance =       0.323195898623


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905940731891        initial  <--
     2.1684e+01     2.1684e+02             1.6220e-05       -16.905940676385
     8.6736e+01     8.6736e+02             4.1021e-06       -16.905940702426
     3.4694e+02     3.4694e+03             1.0285e-06       -16.905940728029

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8568
  </log>
  <optVariables href="H2O.s064.opt.xml">
   uu_0                 3.117517e-01 1 1  ON 0
   uu_1                 1.447375e-01 1 1  ON 1
   uu_2                 4.305793e-02 1 1  ON 2
   uu_3                -1.916583e-02 1 1  ON 3
   uu_4                -6.454623e-02 1 1  ON 4
   uu_5                -9.932994e-02 1 1  ON 5
   uu_6                -1.264841e-01 1 1  ON 6
   uu_7                -1.389802e-01 1 1  ON 7
   uu_8                -1.311516e-01 1 1  ON 8
   uu_9                -1.002761e-01 1 1  ON 9
   ud_0                 4.453619e-01 1 1  ON 10
   ud_1                 1.799291e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076775e-02 1 1  ON 13
   ud_4                -6.720143e-02 1 1  ON 14
   ud_5                -1.077669e-01 1 1  ON 15
   ud_6                -1.341371e-01 1 1  ON 16
   ud_7                -1.497582e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385812e-01 1 1  ON 19
   eO_0                -7.471072e-01 1 1  ON 20
   eO_1                -4.277001e-01 1 1  ON 21
   eO_2                -1.909333e-02 1 1  ON 22
   eO_3                 2.902574e-01 1 1  ON 23
   eO_4                 5.129987e-01 1 1  ON 24
   eO_5                 4.729062e-01 1 1  ON 25
   eO_6                 2.454349e-01 1 1  ON 26
   eO_7                -4.920415e-02 1 1  ON 27
   eO_8                -2.099806e-01 1 1  ON 28
   eO_9                -6.985261e-02 1 1  ON 29
  eH1_0                -2.490243e-01 1 1  ON 30
  eH1_1                -1.410039e-01 1 1  ON 31
  eH1_2                -9.187611e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162133e-02 1 1  ON 34
  eH1_5                 4.534912e-02 1 1  ON 35
  eH1_6                 1.014838e-01 1 1  ON 36
  eH1_7                 1.507964e-01 1 1  ON 37
  eH1_8                 1.645788e-01 1 1  ON 38
  eH1_9                 4.968197e-02 1 1  ON 39
  eH2_0                -2.461182e-01 1 1  ON 40
  eH2_1                -1.390231e-01 1 1  ON 41
  eH2_2                -8.956111e-02 1 1  ON 42
  eH2_3                -3.460328e-02 1 1  ON 43
  eH2_4                 1.430646e-02 1 1  ON 44
  eH2_5                 4.960753e-02 1 1  ON 45
  eH2_6                 1.052385e-01 1 1  ON 46
  eH2_7                 1.534305e-01 1 1  ON 47
  eH2_8                 1.693373e-01 1 1  ON 48
  eH2_9                 3.486678e-02 1 1  ON 49
ci_0001                 7.014447e-01 3 1  ON 50
ci_0002                 7.000936e-01 3 1  ON 51
ci_0003                -2.781559e-02 3 1  ON 52
ci_0004                -2.749111e-02 3 1  ON 53
ci_0005                -3.666402e-02 3 1  ON 54
ci_0006                -3.709973e-02 3 1  ON 55
ci_0007                -2.251934e-02 3 1  ON 56
ci_0008                -2.153984e-02 3 1  ON 57
ci_0009                -1.785254e-02 3 1  ON 58
ci_0010                -1.750490e-02 3 1  ON 59
ci_0011                -1.219843e-02 3 1  ON 60
ci_0012                -1.234343e-02 3 1  ON 61
ci_0013                 1.300559e-02 3 1  ON 62
ci_0014                 1.317893e-02 3 1  ON 63
ci_0015                 1.362621e-02 3 1  ON 64
ci_0016                 1.350088e-02 3 1  ON 65
ci_0017                 1.098759e-02 3 1  ON 66
ci_0018                 1.191394e-02 3 1  ON 67
ci_0019                 1.136465e-02 3 1  ON 68
ci_0020                 1.154212e-02 3 1  ON 69
ci_0021                -2.102344e-03 3 1  ON 70
ci_0022                -4.904733e-04 3 1  ON 71
ci_0023                -1.110241e-02 3 1  ON 72
ci_0024                -1.090666e-02 3 1  ON 73
ci_0025                -1.174397e-02 3 1  ON 74
ci_0026                -1.107486e-02 3 1  ON 75
ci_0027                -1.166043e-02 3 1  ON 76
ci_0028                -1.082997e-02 3 1  ON 77
ci_0029                -9.948108e-03 3 1  ON 78
ci_0030                -1.126738e-02 3 1  ON 79
ci_0031                 2.036630e-02 3 1  ON 80
ci_0032                 2.129427e-02 3 1  ON 81
ci_0033                 1.035447e-02 3 1  ON 82
ci_0034                 9.809737e-03 3 1  ON 83
ci_0035                 6.442754e-03 3 1  ON 84
ci_0036                 6.891998e-03 3 1  ON 85
ci_0037                -1.058341e-02 3 1  ON 86
ci_0038                -1.118940e-02 3 1  ON 87
ci_0039                -2.531630e-03 3 1  ON 88
ci_0040                -2.765270e-03 3 1  ON 89
ci_0041                 6.638130e-03 3 1  ON 90
ci_0042                 7.330360e-03 3 1  ON 91
ci_0043                -1.945857e-02 3 1  ON 92
ci_0044                -1.898964e-02 3 1  ON 93
ci_0045                 7.487589e-03 3 1  ON 94
ci_0046                 7.409396e-03 3 1  ON 95
ci_0047                -1.552864e-03 3 1  ON 96
ci_0048                -1.862664e-03 3 1  ON 97
ci_0049                -5.344368e-03 3 1  ON 98
ci_0050                -5.918247e-03 3 1  ON 99
ci_0051                -3.615429e-03 3 1  ON 100
ci_0052                -3.394074e-03 3 1  ON 101
ci_0053                -4.483045e-03 3 1  ON 102
ci_0054                -4.334220e-03 3 1  ON 103
ci_0055                 6.386636e-03 3 1  ON 104
ci_0056                 6.304628e-03 3 1  ON 105
ci_0057                 4.730378e-03 3 1  ON 106
ci_0058                 4.840633e-03 3 1  ON 107
ci_0059                -4.600994e-03 3 1  ON 108
ci_0060                -4.622278e-03 3 1  ON 109
ci_0061                -4.532026e-03 3 1  ON 110
ci_0062                -3.764484e-03 3 1  ON 111
ci_0063                -9.151709e-03 3 1  ON 112
ci_0064                -8.250236e-03 3 1  ON 113
ci_0065                -5.045049e-03 3 1  ON 114
ci_0066                -5.118722e-03 3 1  ON 115
ci_0067                -5.300127e-03 3 1  ON 116
ci_0068                -4.971627e-03 3 1  ON 117
ci_0069                 4.620899e-03 3 1  ON 118
ci_0070                 4.547373e-03 3 1  ON 119
ci_0071                 5.460520e-04 3 1  ON 120
ci_0072                -4.132504e-04 3 1  ON 121
ci_0073                 4.247356e-03 3 1  ON 122
ci_0074                 4.073630e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8380e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -16.9502
    reference variance = 0.170639
====================================================
  Execution time = 2.1404e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5249e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3882e-01
  Total weights = 1.951783913e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1181e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327582914316
                                         uncertainty =       0.002319598409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327582914316
                                         uncertainty =       0.002319598409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404662727
  error estimate for blocks of size 2^( 2) =       0.000417462618
  error estimate for blocks of size 2^( 3) =       0.000430911384
  error estimate for blocks of size 2^( 4) =       0.000443638592
  error estimate for blocks of size 2^( 5) =       0.000455290342
  error estimate for blocks of size 2^( 6) =       0.000465742853
  error estimate for blocks of size 2^( 7) =       0.000473051615

      target function =                  N/A
              le_mean =     -16.905926044794
             les_mean =     286.149157918029
             stat err =       0.000459430851
             autocorr =       1.289002921086
              std dev =       0.572279516555
             le_variance =       0.327503845068


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690592604479e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+02, overlap shift 2.1684e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905926044780       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905926050898       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905926046366       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905926047480       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905926044569       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905926045590       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905926045634       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905926046298       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905926046079       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905926046671       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.1684e+02 is 1.405667e-06

solving harmonic davidson linear method for identity shift 8.6736e+02, overlap shift 8.6736e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905926044780       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905926046311       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905926045177       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905926045455       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905926044727       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905926044983       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905926044995       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905926045158       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905926045105       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905926045252       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.6736e+02 is 3.518193e-07

solving harmonic davidson linear method for identity shift 3.4694e+03, overlap shift 3.4694e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905926044780       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905926045163       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905926044880       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905926044949       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905926044769       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905926044834       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905926044837       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905926044873       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905926044858       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905926044904       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.4694e+03 is 8.798003e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.572453 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7530e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
   uu_0                 3.117520e-01 1 1  ON 0
   uu_1                 1.447375e-01 1 1  ON 1
   uu_2                 4.305787e-02 1 1  ON 2
   uu_3                -1.916585e-02 1 1  ON 3
   uu_4                -6.454640e-02 1 1  ON 4
   uu_5                -9.932995e-02 1 1  ON 5
   uu_6                -1.264842e-01 1 1  ON 6
   uu_7                -1.389804e-01 1 1  ON 7
   uu_8                -1.311517e-01 1 1  ON 8
   uu_9                -1.002762e-01 1 1  ON 9
   ud_0                 4.453619e-01 1 1  ON 10
   ud_1                 1.799292e-01 1 1  ON 11
   ud_2                 5.987752e-02 1 1  ON 12
   ud_3                -1.076769e-02 1 1  ON 13
   ud_4                -6.720133e-02 1 1  ON 14
   ud_5                -1.077670e-01 1 1  ON 15
   ud_6                -1.341371e-01 1 1  ON 16
   ud_7                -1.497583e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385812e-01 1 1  ON 19
   eO_0                -7.471073e-01 1 1  ON 20
   eO_1                -4.277000e-01 1 1  ON 21
   eO_2                -1.909334e-02 1 1  ON 22
   eO_3                 2.902574e-01 1 1  ON 23
   eO_4                 5.129988e-01 1 1  ON 24
   eO_5                 4.729065e-01 1 1  ON 25
   eO_6                 2.454350e-01 1 1  ON 26
   eO_7                -4.920410e-02 1 1  ON 27
   eO_8                -2.099807e-01 1 1  ON 28
   eO_9                -6.985277e-02 1 1  ON 29
  eH1_0                -2.490244e-01 1 1  ON 30
  eH1_1                -1.410041e-01 1 1  ON 31
  eH1_2                -9.187634e-02 1 1  ON 32
  eH1_3                -3.738921e-02 1 1  ON 33
  eH1_4                 1.162139e-02 1 1  ON 34
  eH1_5                 4.534901e-02 1 1  ON 35
  eH1_6                 1.014839e-01 1 1  ON 36
  eH1_7                 1.507965e-01 1 1  ON 37
  eH1_8                 1.645790e-01 1 1  ON 38
  eH1_9                 4.968216e-02 1 1  ON 39
  eH2_0                -2.461184e-01 1 1  ON 40
  eH2_1                -1.390232e-01 1 1  ON 41
  eH2_2                -8.956120e-02 1 1  ON 42
  eH2_3                -3.460348e-02 1 1  ON 43
  eH2_4                 1.430640e-02 1 1  ON 44
  eH2_5                 4.960749e-02 1 1  ON 45
  eH2_6                 1.052385e-01 1 1  ON 46
  eH2_7                 1.534306e-01 1 1  ON 47
  eH2_8                 1.693375e-01 1 1  ON 48
  eH2_9                 3.486709e-02 1 1  ON 49
ci_0001                 7.014448e-01 3 1  ON 50
ci_0002                 7.000935e-01 3 1  ON 51
ci_0003                -2.781567e-02 3 1  ON 52
ci_0004                -2.749101e-02 3 1  ON 53
ci_0005                -3.666416e-02 3 1  ON 54
ci_0006                -3.709987e-02 3 1  ON 55
ci_0007                -2.251916e-02 3 1  ON 56
ci_0008                -2.154000e-02 3 1  ON 57
ci_0009                -1.785248e-02 3 1  ON 58
ci_0010                -1.750463e-02 3 1  ON 59
ci_0011                -1.219820e-02 3 1  ON 60
ci_0012                -1.234320e-02 3 1  ON 61
ci_0013                 1.300574e-02 3 1  ON 62
ci_0014                 1.317882e-02 3 1  ON 63
ci_0015                 1.362592e-02 3 1  ON 64
ci_0016                 1.350066e-02 3 1  ON 65
ci_0017                 1.098794e-02 3 1  ON 66
ci_0018                 1.191378e-02 3 1  ON 67
ci_0019                 1.136457e-02 3 1  ON 68
ci_0020                 1.154228e-02 3 1  ON 69
ci_0021                -2.102385e-03 3 1  ON 70
ci_0022                -4.907064e-04 3 1  ON 71
ci_0023                -1.110240e-02 3 1  ON 72
ci_0024                -1.090661e-02 3 1  ON 73
ci_0025                -1.174391e-02 3 1  ON 74
ci_0026                -1.107500e-02 3 1  ON 75
ci_0027                -1.166027e-02 3 1  ON 76
ci_0028                -1.082996e-02 3 1  ON 77
ci_0029                -9.948227e-03 3 1  ON 78
ci_0030                -1.126723e-02 3 1  ON 79
ci_0031                 2.036648e-02 3 1  ON 80
ci_0032                 2.129428e-02 3 1  ON 81
ci_0033                 1.035430e-02 3 1  ON 82
ci_0034                 9.809921e-03 3 1  ON 83
ci_0035                 6.442443e-03 3 1  ON 84
ci_0036                 6.892206e-03 3 1  ON 85
ci_0037                -1.058322e-02 3 1  ON 86
ci_0038                -1.118927e-02 3 1  ON 87
ci_0039                -2.531692e-03 3 1  ON 88
ci_0040                -2.765349e-03 3 1  ON 89
ci_0041                 6.638128e-03 3 1  ON 90
ci_0042                 7.330596e-03 3 1  ON 91
ci_0043                -1.945855e-02 3 1  ON 92
ci_0044                -1.898972e-02 3 1  ON 93
ci_0045                 7.487484e-03 3 1  ON 94
ci_0046                 7.409389e-03 3 1  ON 95
ci_0047                -1.553073e-03 3 1  ON 96
ci_0048                -1.862625e-03 3 1  ON 97
ci_0049                -5.344504e-03 3 1  ON 98
ci_0050                -5.918184e-03 3 1  ON 99
ci_0051                -3.615353e-03 3 1  ON 100
ci_0052                -3.394221e-03 3 1  ON 101
ci_0053                -4.483163e-03 3 1  ON 102
ci_0054                -4.334395e-03 3 1  ON 103
ci_0055                 6.386953e-03 3 1  ON 104
ci_0056                 6.304748e-03 3 1  ON 105
ci_0057                 4.730454e-03 3 1  ON 106
ci_0058                 4.840375e-03 3 1  ON 107
ci_0059                -4.600891e-03 3 1  ON 108
ci_0060                -4.622425e-03 3 1  ON 109
ci_0061                -4.531933e-03 3 1  ON 110
ci_0062                -3.764593e-03 3 1  ON 111
ci_0063                -9.151437e-03 3 1  ON 112
ci_0064                -8.250107e-03 3 1  ON 113
ci_0065                -5.044866e-03 3 1  ON 114
ci_0066                -5.119022e-03 3 1  ON 115
ci_0067                -5.299775e-03 3 1  ON 116
ci_0068                -4.971484e-03 3 1  ON 117
ci_0069                 4.620790e-03 3 1  ON 118
ci_0070                 4.547308e-03 3 1  ON 119
ci_0071                 5.461111e-04 3 1  ON 120
ci_0072                -4.130901e-04 3 1  ON 121
ci_0073                 4.247391e-03 3 1  ON 122
ci_0074                 4.073943e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -16.9713
    reference variance = 0.222398
====================================================
  Execution time = 2.0842e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3469e-01
  Total weights = 1.9518e+06
  Execution time = 1.8862e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321246974564
                                         uncertainty =       0.002105234248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321246974564
                                         uncertainty =       0.002105234248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400769468
  error estimate for blocks of size 2^( 2) =       0.000413929582
  error estimate for blocks of size 2^( 3) =       0.000427568425
  error estimate for blocks of size 2^( 4) =       0.000440529745
  error estimate for blocks of size 2^( 5) =       0.000452105504
  error estimate for blocks of size 2^( 6) =       0.000462262372
  error estimate for blocks of size 2^( 7) =       0.000471663717

      target function =                  N/A
              le_mean =     -16.905735244426
             les_mean =     286.138578147953
             stat err =       0.000456640335
             autocorr =       1.298252848900
              std dev =       0.566773616326
             le_variance =       0.321232332164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321247713543
                                         uncertainty =       0.002105258946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321247713543
                                         uncertainty =       0.002105258946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400769927
  error estimate for blocks of size 2^( 2) =       0.000413930059
  error estimate for blocks of size 2^( 3) =       0.000427568898
  error estimate for blocks of size 2^( 4) =       0.000440530196
  error estimate for blocks of size 2^( 5) =       0.000452105920
  error estimate for blocks of size 2^( 6) =       0.000462262807
  error estimate for blocks of size 2^( 7) =       0.000471664068

      target function =                  N/A
              le_mean =     -16.905735258827
             les_mean =     286.138581382580
             stat err =       0.000456640748
             autocorr =       1.298252219566
              std dev =       0.566774266342
             le_variance =       0.321233068987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321247343963
                                         uncertainty =       0.002105246591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321247343963
                                         uncertainty =       0.002105246591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400769697
  error estimate for blocks of size 2^( 2) =       0.000413929821
  error estimate for blocks of size 2^( 3) =       0.000427568661
  error estimate for blocks of size 2^( 4) =       0.000440529970
  error estimate for blocks of size 2^( 5) =       0.000452105712
  error estimate for blocks of size 2^( 6) =       0.000462262589
  error estimate for blocks of size 2^( 7) =       0.000471663893

      target function =                  N/A
              le_mean =     -16.905735251624
             les_mean =     286.138579713905
             stat err =       0.000456640541
             autocorr =       1.298252534540
              std dev =       0.566773941254
             le_variance =       0.321232700485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321247020716
                                         uncertainty =       0.002105235789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321247020716
                                         uncertainty =       0.002105235789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400769496
  error estimate for blocks of size 2^( 2) =       0.000413929612
  error estimate for blocks of size 2^( 3) =       0.000427568454
  error estimate for blocks of size 2^( 4) =       0.000440529773
  error estimate for blocks of size 2^( 5) =       0.000452105530
  error estimate for blocks of size 2^( 6) =       0.000462262399
  error estimate for blocks of size 2^( 7) =       0.000471663739

      target function =                  N/A
              le_mean =     -16.905735245325
             les_mean =     286.138578338424
             stat err =       0.000456640360
             autocorr =       1.298252809643
              std dev =       0.566773656922
             le_variance =       0.321232378180


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905735244426        initial
     2.1684e+02     2.1684e+03             1.4057e-06       -16.905735258827  <--
     8.6736e+02     8.6736e+03             3.5182e-07       -16.905735251624
     3.4694e+03     3.4694e+04             8.7980e-08       -16.905735245325

*****************************************************************************
Applying the update for shift_i =   2.1684e+02     and shift_s =   2.1684e+03
*****************************************************************************

  Execution time = 3.0424e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305768e-02 1 1  ON 2
   uu_3                -1.916589e-02 1 1  ON 3
   uu_4                -6.454691e-02 1 1  ON 4
   uu_5                -9.932999e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311519e-01 1 1  ON 8
   uu_9                -1.002763e-01 1 1  ON 9
   ud_0                 4.453620e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987750e-02 1 1  ON 12
   ud_3                -1.076753e-02 1 1  ON 13
   ud_4                -6.720103e-02 1 1  ON 14
   ud_5                -1.077672e-01 1 1  ON 15
   ud_6                -1.341373e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471077e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909337e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729071e-01 1 1  ON 25
   eO_6                 2.454353e-01 1 1  ON 26
   eO_7                -4.920393e-02 1 1  ON 27
   eO_8                -2.099811e-01 1 1  ON 28
   eO_9                -6.985324e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410048e-01 1 1  ON 31
  eH1_2                -9.187703e-02 1 1  ON 32
  eH1_3                -3.738920e-02 1 1  ON 33
  eH1_4                 1.162157e-02 1 1  ON 34
  eH1_5                 4.534868e-02 1 1  ON 35
  eH1_6                 1.014843e-01 1 1  ON 36
  eH1_7                 1.507968e-01 1 1  ON 37
  eH1_8                 1.645795e-01 1 1  ON 38
  eH1_9                 4.968271e-02 1 1  ON 39
  eH2_0                -2.461191e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956147e-02 1 1  ON 42
  eH2_3                -3.460409e-02 1 1  ON 43
  eH2_4                 1.430622e-02 1 1  ON 44
  eH2_5                 4.960737e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534308e-01 1 1  ON 47
  eH2_8                 1.693382e-01 1 1  ON 48
  eH2_9                 3.486801e-02 1 1  ON 49
ci_0001                 7.014450e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781591e-02 3 1  ON 52
ci_0004                -2.749070e-02 3 1  ON 53
ci_0005                -3.666459e-02 3 1  ON 54
ci_0006                -3.710027e-02 3 1  ON 55
ci_0007                -2.251861e-02 3 1  ON 56
ci_0008                -2.154048e-02 3 1  ON 57
ci_0009                -1.785229e-02 3 1  ON 58
ci_0010                -1.750383e-02 3 1  ON 59
ci_0011                -1.219752e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300618e-02 3 1  ON 62
ci_0014                 1.317849e-02 3 1  ON 63
ci_0015                 1.362505e-02 3 1  ON 64
ci_0016                 1.349999e-02 3 1  ON 65
ci_0017                 1.098898e-02 3 1  ON 66
ci_0018                 1.191330e-02 3 1  ON 67
ci_0019                 1.136435e-02 3 1  ON 68
ci_0020                 1.154279e-02 3 1  ON 69
ci_0021                -2.102505e-03 3 1  ON 70
ci_0022                -4.914056e-04 3 1  ON 71
ci_0023                -1.110236e-02 3 1  ON 72
ci_0024                -1.090646e-02 3 1  ON 73
ci_0025                -1.174372e-02 3 1  ON 74
ci_0026                -1.107543e-02 3 1  ON 75
ci_0027                -1.165980e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948583e-03 3 1  ON 78
ci_0030                -1.126677e-02 3 1  ON 79
ci_0031                 2.036701e-02 3 1  ON 80
ci_0032                 2.129432e-02 3 1  ON 81
ci_0033                 1.035379e-02 3 1  ON 82
ci_0034                 9.810473e-03 3 1  ON 83
ci_0035                 6.441510e-03 3 1  ON 84
ci_0036                 6.892829e-03 3 1  ON 85
ci_0037                -1.058267e-02 3 1  ON 86
ci_0038                -1.118887e-02 3 1  ON 87
ci_0039                -2.531878e-03 3 1  ON 88
ci_0040                -2.765588e-03 3 1  ON 89
ci_0041                 6.638124e-03 3 1  ON 90
ci_0042                 7.331305e-03 3 1  ON 91
ci_0043                -1.945851e-02 3 1  ON 92
ci_0044                -1.898994e-02 3 1  ON 93
ci_0045                 7.487167e-03 3 1  ON 94
ci_0046                 7.409368e-03 3 1  ON 95
ci_0047                -1.553698e-03 3 1  ON 96
ci_0048                -1.862506e-03 3 1  ON 97
ci_0049                -5.344909e-03 3 1  ON 98
ci_0050                -5.917993e-03 3 1  ON 99
ci_0051                -3.615126e-03 3 1  ON 100
ci_0052                -3.394661e-03 3 1  ON 101
ci_0053                -4.483515e-03 3 1  ON 102
ci_0054                -4.334918e-03 3 1  ON 103
ci_0055                 6.387902e-03 3 1  ON 104
ci_0056                 6.305105e-03 3 1  ON 105
ci_0057                 4.730682e-03 3 1  ON 106
ci_0058                 4.839600e-03 3 1  ON 107
ci_0059                -4.600581e-03 3 1  ON 108
ci_0060                -4.622865e-03 3 1  ON 109
ci_0061                -4.531653e-03 3 1  ON 110
ci_0062                -3.764918e-03 3 1  ON 111
ci_0063                -9.150623e-03 3 1  ON 112
ci_0064                -8.249719e-03 3 1  ON 113
ci_0065                -5.044320e-03 3 1  ON 114
ci_0066                -5.119921e-03 3 1  ON 115
ci_0067                -5.298721e-03 3 1  ON 116
ci_0068                -4.971055e-03 3 1  ON 117
ci_0069                 4.620462e-03 3 1  ON 118
ci_0070                 4.547114e-03 3 1  ON 119
ci_0071                 5.462880e-04 3 1  ON 120
ci_0072                -4.126098e-04 3 1  ON 121
ci_0073                 4.247494e-03 3 1  ON 122
ci_0074                 4.074879e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7960e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -16.9135
    reference variance = 0.276379
====================================================
  Execution time = 2.1222e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3267e-01
  Total weights = 1.951537352e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0250e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321810584273
                                         uncertainty =       0.002003950553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321810584273
                                         uncertainty =       0.002003950553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401112334
  error estimate for blocks of size 2^( 2) =       0.000414340139
  error estimate for blocks of size 2^( 3) =       0.000427495859
  error estimate for blocks of size 2^( 4) =       0.000439446929
  error estimate for blocks of size 2^( 5) =       0.000450098613
  error estimate for blocks of size 2^( 6) =       0.000458717028
  error estimate for blocks of size 2^( 7) =       0.000463767513

      target function =                  N/A
              le_mean =     -16.905517053785
             les_mean =     286.129179391267
             stat err =       0.000453007521
             autocorr =       1.275495091764
              std dev =       0.567258502422
             le_variance =       0.321782208570


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690551705379e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+01, overlap shift 5.4210e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905517053760       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905517003675       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905517000950       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905517001187       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905517003995       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905517000835       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905517001654       residual = 9.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905516999026       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905516999441       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905517000744       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.4210e+01 is 6.289942e-06

solving harmonic davidson linear method for identity shift 2.1684e+02, overlap shift 2.1684e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905517053760       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905517041202       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905517040505       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905517040502       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905517041194       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905517040425       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905517040647       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905517039976       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905517040081       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905517040411       residual = 3.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.1684e+02 is 1.579676e-06

solving harmonic davidson linear method for identity shift 8.6736e+02, overlap shift 8.6736e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905517053760       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905517050619       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905517050443       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905517050439       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905517050611       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905517050420       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905517050476       residual = 9.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905517050305       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905517050335       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905517050416       residual = 3.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.6736e+02 is 3.953713e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.576502 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7256e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
   uu_0                 3.117542e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305763e-02 1 1  ON 2
   uu_3                -1.916620e-02 1 1  ON 3
   uu_4                -6.454710e-02 1 1  ON 4
   uu_5                -9.933007e-02 1 1  ON 5
   uu_6                -1.264848e-01 1 1  ON 6
   uu_7                -1.389819e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453628e-01 1 1  ON 10
   ud_1                 1.799294e-01 1 1  ON 11
   ud_2                 5.987757e-02 1 1  ON 12
   ud_3                -1.076761e-02 1 1  ON 13
   ud_4                -6.720078e-02 1 1  ON 14
   ud_5                -1.077673e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497590e-01 1 1  ON 17
   ud_8                -1.506342e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471081e-01 1 1  ON 20
   eO_1                -4.277002e-01 1 1  ON 21
   eO_2                -1.909308e-02 1 1  ON 22
   eO_3                 2.902574e-01 1 1  ON 23
   eO_4                 5.129992e-01 1 1  ON 24
   eO_5                 4.729075e-01 1 1  ON 25
   eO_6                 2.454359e-01 1 1  ON 26
   eO_7                -4.920398e-02 1 1  ON 27
   eO_8                -2.099815e-01 1 1  ON 28
   eO_9                -6.985366e-02 1 1  ON 29
  eH1_0                -2.490248e-01 1 1  ON 30
  eH1_1                -1.410056e-01 1 1  ON 31
  eH1_2                -9.187791e-02 1 1  ON 32
  eH1_3                -3.738949e-02 1 1  ON 33
  eH1_4                 1.162139e-02 1 1  ON 34
  eH1_5                 4.534891e-02 1 1  ON 35
  eH1_6                 1.014841e-01 1 1  ON 36
  eH1_7                 1.507970e-01 1 1  ON 37
  eH1_8                 1.645805e-01 1 1  ON 38
  eH1_9                 4.968371e-02 1 1  ON 39
  eH2_0                -2.461195e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956164e-02 1 1  ON 42
  eH2_3                -3.460448e-02 1 1  ON 43
  eH2_4                 1.430597e-02 1 1  ON 44
  eH2_5                 4.960682e-02 1 1  ON 45
  eH2_6                 1.052383e-01 1 1  ON 46
  eH2_7                 1.534312e-01 1 1  ON 47
  eH2_8                 1.693390e-01 1 1  ON 48
  eH2_9                 3.486879e-02 1 1  ON 49
ci_0001                 7.014449e-01 3 1  ON 50
ci_0002                 7.000936e-01 3 1  ON 51
ci_0003                -2.781578e-02 3 1  ON 52
ci_0004                -2.749052e-02 3 1  ON 53
ci_0005                -3.666431e-02 3 1  ON 54
ci_0006                -3.709993e-02 3 1  ON 55
ci_0007                -2.251785e-02 3 1  ON 56
ci_0008                -2.154204e-02 3 1  ON 57
ci_0009                -1.785205e-02 3 1  ON 58
ci_0010                -1.750405e-02 3 1  ON 59
ci_0011                -1.219711e-02 3 1  ON 60
ci_0012                -1.234264e-02 3 1  ON 61
ci_0013                 1.300635e-02 3 1  ON 62
ci_0014                 1.317771e-02 3 1  ON 63
ci_0015                 1.362355e-02 3 1  ON 64
ci_0016                 1.349940e-02 3 1  ON 65
ci_0017                 1.098891e-02 3 1  ON 66
ci_0018                 1.191298e-02 3 1  ON 67
ci_0019                 1.136368e-02 3 1  ON 68
ci_0020                 1.154231e-02 3 1  ON 69
ci_0021                -2.101527e-03 3 1  ON 70
ci_0022                -4.912527e-04 3 1  ON 71
ci_0023                -1.110232e-02 3 1  ON 72
ci_0024                -1.090662e-02 3 1  ON 73
ci_0025                -1.174350e-02 3 1  ON 74
ci_0026                -1.107529e-02 3 1  ON 75
ci_0027                -1.165928e-02 3 1  ON 76
ci_0028                -1.083021e-02 3 1  ON 77
ci_0029                -9.949092e-03 3 1  ON 78
ci_0030                -1.126562e-02 3 1  ON 79
ci_0031                 2.036692e-02 3 1  ON 80
ci_0032                 2.129399e-02 3 1  ON 81
ci_0033                 1.035496e-02 3 1  ON 82
ci_0034                 9.809061e-03 3 1  ON 83
ci_0035                 6.441287e-03 3 1  ON 84
ci_0036                 6.893375e-03 3 1  ON 85
ci_0037                -1.058309e-02 3 1  ON 86
ci_0038                -1.118839e-02 3 1  ON 87
ci_0039                -2.531415e-03 3 1  ON 88
ci_0040                -2.765013e-03 3 1  ON 89
ci_0041                 6.638194e-03 3 1  ON 90
ci_0042                 7.331003e-03 3 1  ON 91
ci_0043                -1.945825e-02 3 1  ON 92
ci_0044                -1.899003e-02 3 1  ON 93
ci_0045                 7.486926e-03 3 1  ON 94
ci_0046                 7.409436e-03 3 1  ON 95
ci_0047                -1.554362e-03 3 1  ON 96
ci_0048                -1.861912e-03 3 1  ON 97
ci_0049                -5.345083e-03 3 1  ON 98
ci_0050                -5.917679e-03 3 1  ON 99
ci_0051                -3.614510e-03 3 1  ON 100
ci_0052                -3.395383e-03 3 1  ON 101
ci_0053                -4.484296e-03 3 1  ON 102
ci_0054                -4.335431e-03 3 1  ON 103
ci_0055                 6.388145e-03 3 1  ON 104
ci_0056                 6.304651e-03 3 1  ON 105
ci_0057                 4.731291e-03 3 1  ON 106
ci_0058                 4.839963e-03 3 1  ON 107
ci_0059                -4.600731e-03 3 1  ON 108
ci_0060                -4.623948e-03 3 1  ON 109
ci_0061                -4.530630e-03 3 1  ON 110
ci_0062                -3.764879e-03 3 1  ON 111
ci_0063                -9.149973e-03 3 1  ON 112
ci_0064                -8.249523e-03 3 1  ON 113
ci_0065                -5.043754e-03 3 1  ON 114
ci_0066                -5.120263e-03 3 1  ON 115
ci_0067                -5.297867e-03 3 1  ON 116
ci_0068                -4.969476e-03 3 1  ON 117
ci_0069                 4.620313e-03 3 1  ON 118
ci_0070                 4.546806e-03 3 1  ON 119
ci_0071                 5.467070e-04 3 1  ON 120
ci_0072                -4.125904e-04 3 1  ON 121
ci_0073                 4.248005e-03 3 1  ON 122
ci_0074                 4.075296e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -16.9331
    reference variance = 0.520883
====================================================
  Execution time = 2.1233e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3426e-01
  Total weights = 1.9517e+06
  Execution time = 1.8929e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322295755127
                                         uncertainty =       0.002779360509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322295755127
                                         uncertainty =       0.002779360509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401446198
  error estimate for blocks of size 2^( 2) =       0.000414477241
  error estimate for blocks of size 2^( 3) =       0.000427865577
  error estimate for blocks of size 2^( 4) =       0.000440439068
  error estimate for blocks of size 2^( 5) =       0.000453082985
  error estimate for blocks of size 2^( 6) =       0.000461013372
  error estimate for blocks of size 2^( 7) =       0.000466250964

      target function =                  N/A
              le_mean =     -16.905450580189
             les_mean =     286.128516504878
             stat err =       0.000455196597
             autocorr =       1.285710872423
              std dev =       0.567730657309
             le_variance =       0.322318099248

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322299000503
                                         uncertainty =       0.002779445022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322299000503
                                         uncertainty =       0.002779445022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401448213
  error estimate for blocks of size 2^( 2) =       0.000414479217
  error estimate for blocks of size 2^( 3) =       0.000427867609
  error estimate for blocks of size 2^( 4) =       0.000440440969
  error estimate for blocks of size 2^( 5) =       0.000453084806
  error estimate for blocks of size 2^( 6) =       0.000461015243
  error estimate for blocks of size 2^( 7) =       0.000466252827

      target function =                  N/A
              le_mean =     -16.905450579594
             les_mean =     286.128546714759
             stat err =       0.000455198461
             autocorr =       1.285708492568
              std dev =       0.567733507508
             le_variance =       0.322321335547

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322297383679
                                         uncertainty =       0.002779403028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322297383679
                                         uncertainty =       0.002779403028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401447209
  error estimate for blocks of size 2^( 2) =       0.000414478233
  error estimate for blocks of size 2^( 3) =       0.000427866597
  error estimate for blocks of size 2^( 4) =       0.000440440023
  error estimate for blocks of size 2^( 5) =       0.000453083899
  error estimate for blocks of size 2^( 6) =       0.000461014311
  error estimate for blocks of size 2^( 7) =       0.000466251900

      target function =                  N/A
              le_mean =     -16.905450579594
             les_mean =     286.128529959953
             stat err =       0.000455197533
             autocorr =       1.285709679794
              std dev =       0.567732087560
             le_variance =       0.322319723245

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322295958725
                                         uncertainty =       0.002779365829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322295958725
                                         uncertainty =       0.002779365829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401446324
  error estimate for blocks of size 2^( 2) =       0.000414477365
  error estimate for blocks of size 2^( 3) =       0.000427865705
  error estimate for blocks of size 2^( 4) =       0.000440439188
  error estimate for blocks of size 2^( 5) =       0.000453083099
  error estimate for blocks of size 2^( 6) =       0.000461013489
  error estimate for blocks of size 2^( 7) =       0.000466251081

      target function =                  N/A
              le_mean =     -16.905450580085
             les_mean =     286.128518017986
             stat err =       0.000455196714
             autocorr =       1.285710723423
              std dev =       0.567730836116
             le_variance =       0.322318302277


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905450580189        initial  <--
     5.4210e+01     5.4210e+02             6.2899e-06       -16.905450579594
     2.1684e+02     2.1684e+03             1.5797e-06       -16.905450579594
     8.6736e+02     8.6736e+03             3.9537e-07       -16.905450580085

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8192
  </log>
  <optVariables href="H2O.s066.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305768e-02 1 1  ON 2
   uu_3                -1.916589e-02 1 1  ON 3
   uu_4                -6.454691e-02 1 1  ON 4
   uu_5                -9.932999e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311519e-01 1 1  ON 8
   uu_9                -1.002763e-01 1 1  ON 9
   ud_0                 4.453620e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987750e-02 1 1  ON 12
   ud_3                -1.076753e-02 1 1  ON 13
   ud_4                -6.720103e-02 1 1  ON 14
   ud_5                -1.077672e-01 1 1  ON 15
   ud_6                -1.341373e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471077e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909337e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729071e-01 1 1  ON 25
   eO_6                 2.454353e-01 1 1  ON 26
   eO_7                -4.920393e-02 1 1  ON 27
   eO_8                -2.099811e-01 1 1  ON 28
   eO_9                -6.985324e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410048e-01 1 1  ON 31
  eH1_2                -9.187703e-02 1 1  ON 32
  eH1_3                -3.738920e-02 1 1  ON 33
  eH1_4                 1.162157e-02 1 1  ON 34
  eH1_5                 4.534868e-02 1 1  ON 35
  eH1_6                 1.014843e-01 1 1  ON 36
  eH1_7                 1.507968e-01 1 1  ON 37
  eH1_8                 1.645795e-01 1 1  ON 38
  eH1_9                 4.968271e-02 1 1  ON 39
  eH2_0                -2.461191e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956147e-02 1 1  ON 42
  eH2_3                -3.460409e-02 1 1  ON 43
  eH2_4                 1.430622e-02 1 1  ON 44
  eH2_5                 4.960737e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534308e-01 1 1  ON 47
  eH2_8                 1.693382e-01 1 1  ON 48
  eH2_9                 3.486801e-02 1 1  ON 49
ci_0001                 7.014450e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781591e-02 3 1  ON 52
ci_0004                -2.749070e-02 3 1  ON 53
ci_0005                -3.666459e-02 3 1  ON 54
ci_0006                -3.710027e-02 3 1  ON 55
ci_0007                -2.251861e-02 3 1  ON 56
ci_0008                -2.154048e-02 3 1  ON 57
ci_0009                -1.785229e-02 3 1  ON 58
ci_0010                -1.750383e-02 3 1  ON 59
ci_0011                -1.219752e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300618e-02 3 1  ON 62
ci_0014                 1.317849e-02 3 1  ON 63
ci_0015                 1.362505e-02 3 1  ON 64
ci_0016                 1.349999e-02 3 1  ON 65
ci_0017                 1.098898e-02 3 1  ON 66
ci_0018                 1.191330e-02 3 1  ON 67
ci_0019                 1.136435e-02 3 1  ON 68
ci_0020                 1.154279e-02 3 1  ON 69
ci_0021                -2.102505e-03 3 1  ON 70
ci_0022                -4.914056e-04 3 1  ON 71
ci_0023                -1.110236e-02 3 1  ON 72
ci_0024                -1.090646e-02 3 1  ON 73
ci_0025                -1.174372e-02 3 1  ON 74
ci_0026                -1.107543e-02 3 1  ON 75
ci_0027                -1.165980e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948583e-03 3 1  ON 78
ci_0030                -1.126677e-02 3 1  ON 79
ci_0031                 2.036701e-02 3 1  ON 80
ci_0032                 2.129432e-02 3 1  ON 81
ci_0033                 1.035379e-02 3 1  ON 82
ci_0034                 9.810473e-03 3 1  ON 83
ci_0035                 6.441510e-03 3 1  ON 84
ci_0036                 6.892829e-03 3 1  ON 85
ci_0037                -1.058267e-02 3 1  ON 86
ci_0038                -1.118887e-02 3 1  ON 87
ci_0039                -2.531878e-03 3 1  ON 88
ci_0040                -2.765588e-03 3 1  ON 89
ci_0041                 6.638124e-03 3 1  ON 90
ci_0042                 7.331305e-03 3 1  ON 91
ci_0043                -1.945851e-02 3 1  ON 92
ci_0044                -1.898994e-02 3 1  ON 93
ci_0045                 7.487167e-03 3 1  ON 94
ci_0046                 7.409368e-03 3 1  ON 95
ci_0047                -1.553698e-03 3 1  ON 96
ci_0048                -1.862506e-03 3 1  ON 97
ci_0049                -5.344909e-03 3 1  ON 98
ci_0050                -5.917993e-03 3 1  ON 99
ci_0051                -3.615126e-03 3 1  ON 100
ci_0052                -3.394661e-03 3 1  ON 101
ci_0053                -4.483515e-03 3 1  ON 102
ci_0054                -4.334918e-03 3 1  ON 103
ci_0055                 6.387902e-03 3 1  ON 104
ci_0056                 6.305105e-03 3 1  ON 105
ci_0057                 4.730682e-03 3 1  ON 106
ci_0058                 4.839600e-03 3 1  ON 107
ci_0059                -4.600581e-03 3 1  ON 108
ci_0060                -4.622865e-03 3 1  ON 109
ci_0061                -4.531653e-03 3 1  ON 110
ci_0062                -3.764918e-03 3 1  ON 111
ci_0063                -9.150623e-03 3 1  ON 112
ci_0064                -8.249719e-03 3 1  ON 113
ci_0065                -5.044320e-03 3 1  ON 114
ci_0066                -5.119921e-03 3 1  ON 115
ci_0067                -5.298721e-03 3 1  ON 116
ci_0068                -4.971055e-03 3 1  ON 117
ci_0069                 4.620462e-03 3 1  ON 118
ci_0070                 4.547114e-03 3 1  ON 119
ci_0071                 5.462880e-04 3 1  ON 120
ci_0072                -4.126098e-04 3 1  ON 121
ci_0073                 4.247494e-03 3 1  ON 122
ci_0074                 4.074879e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8081e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -16.9476
    reference variance = 0.225025
====================================================
  Execution time = 2.1220e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5225e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3433e-01
  Total weights = 1.951392727e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0614e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319194191214
                                         uncertainty =       0.002013801653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319194191214
                                         uncertainty =       0.002013801653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399514052
  error estimate for blocks of size 2^( 2) =       0.000412545994
  error estimate for blocks of size 2^( 3) =       0.000426089527
  error estimate for blocks of size 2^( 4) =       0.000438769409
  error estimate for blocks of size 2^( 5) =       0.000450239856
  error estimate for blocks of size 2^( 6) =       0.000457820939
  error estimate for blocks of size 2^( 7) =       0.000463576600

      target function =                  N/A
              le_mean =     -16.906604656821
             les_mean =     286.167612918892
             stat err =       0.000452601701
             autocorr =       1.283418349313
              std dev =       0.564998190984
             le_variance =       0.319222955815


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690660465682e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+02, overlap shift 5.4210e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906604656810       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906604666523       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906604669062       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906604668063       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906604669025       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906604667849       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906604668218       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906604668149       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906604668239       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906604668457       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.4210e+02 is 8.446273e-07

solving harmonic davidson linear method for identity shift 2.1684e+03, overlap shift 2.1684e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906604656810       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906604659239       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906604659874       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906604659624       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906604659864       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906604659571       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906604659660       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906604659643       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906604659671       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906604659719       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.1684e+03 is 2.112187e-07

solving harmonic davidson linear method for identity shift 8.6736e+03, overlap shift 8.6736e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906604656810       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906604657417       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906604657576       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906604657522       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906604657572       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906604657502       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906604657524       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906604657527       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906604657517       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906604657554       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.6736e+03 is 5.280856e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.580446 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7290e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
   uu_0                 3.117532e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305766e-02 1 1  ON 2
   uu_3                -1.916589e-02 1 1  ON 3
   uu_4                -6.454692e-02 1 1  ON 4
   uu_5                -9.933000e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389810e-01 1 1  ON 7
   uu_8                -1.311519e-01 1 1  ON 8
   uu_9                -1.002763e-01 1 1  ON 9
   ud_0                 4.453620e-01 1 1  ON 10
   ud_1                 1.799296e-01 1 1  ON 11
   ud_2                 5.987749e-02 1 1  ON 12
   ud_3                -1.076750e-02 1 1  ON 13
   ud_4                -6.720100e-02 1 1  ON 14
   ud_5                -1.077672e-01 1 1  ON 15
   ud_6                -1.341373e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909329e-02 1 1  ON 22
   eO_3                 2.902572e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920393e-02 1 1  ON 27
   eO_8                -2.099811e-01 1 1  ON 28
   eO_9                -6.985329e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410048e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738921e-02 1 1  ON 33
  eH1_4                 1.162152e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968280e-02 1 1  ON 39
  eH2_0                -2.461191e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956151e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430615e-02 1 1  ON 44
  eH2_5                 4.960737e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693382e-01 1 1  ON 48
  eH2_9                 3.486809e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781582e-02 3 1  ON 52
ci_0004                -2.749069e-02 3 1  ON 53
ci_0005                -3.666454e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251850e-02 3 1  ON 56
ci_0008                -2.154043e-02 3 1  ON 57
ci_0009                -1.785219e-02 3 1  ON 58
ci_0010                -1.750397e-02 3 1  ON 59
ci_0011                -1.219759e-02 3 1  ON 60
ci_0012                -1.234231e-02 3 1  ON 61
ci_0013                 1.300625e-02 3 1  ON 62
ci_0014                 1.317856e-02 3 1  ON 63
ci_0015                 1.362493e-02 3 1  ON 64
ci_0016                 1.349997e-02 3 1  ON 65
ci_0017                 1.098908e-02 3 1  ON 66
ci_0018                 1.191319e-02 3 1  ON 67
ci_0019                 1.136436e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102485e-03 3 1  ON 70
ci_0022                -4.914016e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090653e-02 3 1  ON 73
ci_0025                -1.174362e-02 3 1  ON 74
ci_0026                -1.107533e-02 3 1  ON 75
ci_0027                -1.165969e-02 3 1  ON 76
ci_0028                -1.082995e-02 3 1  ON 77
ci_0029                -9.948794e-03 3 1  ON 78
ci_0030                -1.126664e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129423e-02 3 1  ON 81
ci_0033                 1.035376e-02 3 1  ON 82
ci_0034                 9.810422e-03 3 1  ON 83
ci_0035                 6.441553e-03 3 1  ON 84
ci_0036                 6.892808e-03 3 1  ON 85
ci_0037                -1.058261e-02 3 1  ON 86
ci_0038                -1.118887e-02 3 1  ON 87
ci_0039                -2.531958e-03 3 1  ON 88
ci_0040                -2.765599e-03 3 1  ON 89
ci_0041                 6.638205e-03 3 1  ON 90
ci_0042                 7.331267e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898989e-02 3 1  ON 93
ci_0045                 7.487170e-03 3 1  ON 94
ci_0046                 7.409340e-03 3 1  ON 95
ci_0047                -1.553839e-03 3 1  ON 96
ci_0048                -1.862592e-03 3 1  ON 97
ci_0049                -5.344893e-03 3 1  ON 98
ci_0050                -5.918061e-03 3 1  ON 99
ci_0051                -3.615104e-03 3 1  ON 100
ci_0052                -3.394655e-03 3 1  ON 101
ci_0053                -4.483533e-03 3 1  ON 102
ci_0054                -4.334996e-03 3 1  ON 103
ci_0055                 6.387927e-03 3 1  ON 104
ci_0056                 6.305135e-03 3 1  ON 105
ci_0057                 4.730646e-03 3 1  ON 106
ci_0058                 4.839610e-03 3 1  ON 107
ci_0059                -4.600605e-03 3 1  ON 108
ci_0060                -4.622871e-03 3 1  ON 109
ci_0061                -4.531547e-03 3 1  ON 110
ci_0062                -3.764969e-03 3 1  ON 111
ci_0063                -9.150582e-03 3 1  ON 112
ci_0064                -8.249804e-03 3 1  ON 113
ci_0065                -5.044335e-03 3 1  ON 114
ci_0066                -5.119968e-03 3 1  ON 115
ci_0067                -5.298553e-03 3 1  ON 116
ci_0068                -4.971081e-03 3 1  ON 117
ci_0069                 4.620515e-03 3 1  ON 118
ci_0070                 4.546991e-03 3 1  ON 119
ci_0071                 5.463056e-04 3 1  ON 120
ci_0072                -4.125141e-04 3 1  ON 121
ci_0073                 4.247531e-03 3 1  ON 122
ci_0074                 4.074930e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -16.8902
    reference variance = 0.201398
====================================================
  Execution time = 2.3288e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3937e-01
  Total weights = 1.9514e+06
  Execution time = 1.8849e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326754794199
                                         uncertainty =       0.003263210310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326754794199
                                         uncertainty =       0.003263210310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404219648
  error estimate for blocks of size 2^( 2) =       0.000416993149
  error estimate for blocks of size 2^( 3) =       0.000430167661
  error estimate for blocks of size 2^( 4) =       0.000443199130
  error estimate for blocks of size 2^( 5) =       0.000453335645
  error estimate for blocks of size 2^( 6) =       0.000460555709
  error estimate for blocks of size 2^( 7) =       0.000466087626

      target function =                  N/A
              le_mean =     -16.905674851157
             les_mean =     286.141209877863
             stat err =       0.000455794527
             autocorr =       1.271461967946
              std dev =       0.571652908250
             le_variance =       0.326787047511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326754905756
                                         uncertainty =       0.003263303666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326754905756
                                         uncertainty =       0.003263303666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404219716
  error estimate for blocks of size 2^( 2) =       0.000416993210
  error estimate for blocks of size 2^( 3) =       0.000430167711
  error estimate for blocks of size 2^( 4) =       0.000443199170
  error estimate for blocks of size 2^( 5) =       0.000453335680
  error estimate for blocks of size 2^( 6) =       0.000460555760
  error estimate for blocks of size 2^( 7) =       0.000466087639

      target function =                  N/A
              le_mean =     -16.905674844669
             les_mean =     286.141209719322
             stat err =       0.000455794562
             autocorr =       1.271461733629
              std dev =       0.571653004737
             le_variance =       0.326787157824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326754849939
                                         uncertainty =       0.003263256996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326754849939
                                         uncertainty =       0.003263256996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404219682
  error estimate for blocks of size 2^( 2) =       0.000416993180
  error estimate for blocks of size 2^( 3) =       0.000430167686
  error estimate for blocks of size 2^( 4) =       0.000443199150
  error estimate for blocks of size 2^( 5) =       0.000453335662
  error estimate for blocks of size 2^( 6) =       0.000460555735
  error estimate for blocks of size 2^( 7) =       0.000466087632

      target function =                  N/A
              le_mean =     -16.905674847908
             les_mean =     286.141209797644
             stat err =       0.000455794545
             autocorr =       1.271461850783
              std dev =       0.571652956460
             le_variance =       0.326787102630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326754801162
                                         uncertainty =       0.003263216146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326754801162
                                         uncertainty =       0.003263216146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404219652
  error estimate for blocks of size 2^( 2) =       0.000416993153
  error estimate for blocks of size 2^( 3) =       0.000430167664
  error estimate for blocks of size 2^( 4) =       0.000443199132
  error estimate for blocks of size 2^( 5) =       0.000453335648
  error estimate for blocks of size 2^( 6) =       0.000460555712
  error estimate for blocks of size 2^( 7) =       0.000466087627

      target function =                  N/A
              le_mean =     -16.905674850750
             les_mean =     286.141209867739
             stat err =       0.000455794530
             autocorr =       1.271461953300
              std dev =       0.571652914273
             le_variance =       0.326787054397


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905674851157        initial  <--
     5.4210e+02     5.4210e+03             8.4463e-07       -16.905674844669
     2.1684e+03     2.1684e+04             2.1122e-07       -16.905674847908
     8.6736e+03     8.6736e+04             5.2809e-08       -16.905674850750

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.8558
  </log>
  <optVariables href="H2O.s067.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305768e-02 1 1  ON 2
   uu_3                -1.916589e-02 1 1  ON 3
   uu_4                -6.454691e-02 1 1  ON 4
   uu_5                -9.932999e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311519e-01 1 1  ON 8
   uu_9                -1.002763e-01 1 1  ON 9
   ud_0                 4.453620e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987750e-02 1 1  ON 12
   ud_3                -1.076753e-02 1 1  ON 13
   ud_4                -6.720103e-02 1 1  ON 14
   ud_5                -1.077672e-01 1 1  ON 15
   ud_6                -1.341373e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471077e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909337e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729071e-01 1 1  ON 25
   eO_6                 2.454353e-01 1 1  ON 26
   eO_7                -4.920393e-02 1 1  ON 27
   eO_8                -2.099811e-01 1 1  ON 28
   eO_9                -6.985324e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410048e-01 1 1  ON 31
  eH1_2                -9.187703e-02 1 1  ON 32
  eH1_3                -3.738920e-02 1 1  ON 33
  eH1_4                 1.162157e-02 1 1  ON 34
  eH1_5                 4.534868e-02 1 1  ON 35
  eH1_6                 1.014843e-01 1 1  ON 36
  eH1_7                 1.507968e-01 1 1  ON 37
  eH1_8                 1.645795e-01 1 1  ON 38
  eH1_9                 4.968271e-02 1 1  ON 39
  eH2_0                -2.461191e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956147e-02 1 1  ON 42
  eH2_3                -3.460409e-02 1 1  ON 43
  eH2_4                 1.430622e-02 1 1  ON 44
  eH2_5                 4.960737e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534308e-01 1 1  ON 47
  eH2_8                 1.693382e-01 1 1  ON 48
  eH2_9                 3.486801e-02 1 1  ON 49
ci_0001                 7.014450e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781591e-02 3 1  ON 52
ci_0004                -2.749070e-02 3 1  ON 53
ci_0005                -3.666459e-02 3 1  ON 54
ci_0006                -3.710027e-02 3 1  ON 55
ci_0007                -2.251861e-02 3 1  ON 56
ci_0008                -2.154048e-02 3 1  ON 57
ci_0009                -1.785229e-02 3 1  ON 58
ci_0010                -1.750383e-02 3 1  ON 59
ci_0011                -1.219752e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300618e-02 3 1  ON 62
ci_0014                 1.317849e-02 3 1  ON 63
ci_0015                 1.362505e-02 3 1  ON 64
ci_0016                 1.349999e-02 3 1  ON 65
ci_0017                 1.098898e-02 3 1  ON 66
ci_0018                 1.191330e-02 3 1  ON 67
ci_0019                 1.136435e-02 3 1  ON 68
ci_0020                 1.154279e-02 3 1  ON 69
ci_0021                -2.102505e-03 3 1  ON 70
ci_0022                -4.914056e-04 3 1  ON 71
ci_0023                -1.110236e-02 3 1  ON 72
ci_0024                -1.090646e-02 3 1  ON 73
ci_0025                -1.174372e-02 3 1  ON 74
ci_0026                -1.107543e-02 3 1  ON 75
ci_0027                -1.165980e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948583e-03 3 1  ON 78
ci_0030                -1.126677e-02 3 1  ON 79
ci_0031                 2.036701e-02 3 1  ON 80
ci_0032                 2.129432e-02 3 1  ON 81
ci_0033                 1.035379e-02 3 1  ON 82
ci_0034                 9.810473e-03 3 1  ON 83
ci_0035                 6.441510e-03 3 1  ON 84
ci_0036                 6.892829e-03 3 1  ON 85
ci_0037                -1.058267e-02 3 1  ON 86
ci_0038                -1.118887e-02 3 1  ON 87
ci_0039                -2.531878e-03 3 1  ON 88
ci_0040                -2.765588e-03 3 1  ON 89
ci_0041                 6.638124e-03 3 1  ON 90
ci_0042                 7.331305e-03 3 1  ON 91
ci_0043                -1.945851e-02 3 1  ON 92
ci_0044                -1.898994e-02 3 1  ON 93
ci_0045                 7.487167e-03 3 1  ON 94
ci_0046                 7.409368e-03 3 1  ON 95
ci_0047                -1.553698e-03 3 1  ON 96
ci_0048                -1.862506e-03 3 1  ON 97
ci_0049                -5.344909e-03 3 1  ON 98
ci_0050                -5.917993e-03 3 1  ON 99
ci_0051                -3.615126e-03 3 1  ON 100
ci_0052                -3.394661e-03 3 1  ON 101
ci_0053                -4.483515e-03 3 1  ON 102
ci_0054                -4.334918e-03 3 1  ON 103
ci_0055                 6.387902e-03 3 1  ON 104
ci_0056                 6.305105e-03 3 1  ON 105
ci_0057                 4.730682e-03 3 1  ON 106
ci_0058                 4.839600e-03 3 1  ON 107
ci_0059                -4.600581e-03 3 1  ON 108
ci_0060                -4.622865e-03 3 1  ON 109
ci_0061                -4.531653e-03 3 1  ON 110
ci_0062                -3.764918e-03 3 1  ON 111
ci_0063                -9.150623e-03 3 1  ON 112
ci_0064                -8.249719e-03 3 1  ON 113
ci_0065                -5.044320e-03 3 1  ON 114
ci_0066                -5.119921e-03 3 1  ON 115
ci_0067                -5.298721e-03 3 1  ON 116
ci_0068                -4.971055e-03 3 1  ON 117
ci_0069                 4.620462e-03 3 1  ON 118
ci_0070                 4.547114e-03 3 1  ON 119
ci_0071                 5.462880e-04 3 1  ON 120
ci_0072                -4.126098e-04 3 1  ON 121
ci_0073                 4.247494e-03 3 1  ON 122
ci_0074                 4.074879e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0152e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -16.8897
    reference variance = 0.42291
====================================================
  Execution time = 2.1353e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3252e-01
  Total weights = 1.951713947e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0646e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321314799661
                                         uncertainty =       0.001838340318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321314799661
                                         uncertainty =       0.001838340318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400806668
  error estimate for blocks of size 2^( 2) =       0.000413735980
  error estimate for blocks of size 2^( 3) =       0.000426752359
  error estimate for blocks of size 2^( 4) =       0.000439554194
  error estimate for blocks of size 2^( 5) =       0.000450451094
  error estimate for blocks of size 2^( 6) =       0.000458635076
  error estimate for blocks of size 2^( 7) =       0.000463506013

      target function =                  N/A
              le_mean =     -16.905828331342
             les_mean =     286.139546806347
             stat err =       0.000453036594
             autocorr =       1.277605260323
              std dev =       0.566826225902
             le_variance =       0.321291970370


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690582833134e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+03, overlap shift 5.4210e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905828331337       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905828334034       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905828334025       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905828334138       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905828334192       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905828334091       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905828334084       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905828334083       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905828334113       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905828334136       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.4210e+03 is 7.000900e-08

solving harmonic davidson linear method for identity shift 2.1684e+04, overlap shift 2.1684e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905828331337       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905828332011       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905828332009       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905828332037       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905828332051       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905828332026       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905828331984       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905828332045       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905828332059       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905828331992       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.1684e+04 is 1.750279e-08

solving harmonic davidson linear method for identity shift 8.6736e+04, overlap shift 8.6736e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905828331337       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905828331506       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905828331505       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905828331512       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905828331512       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905828331506       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905828331587       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905828331531       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905828331700       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905828331860       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.6736e+04 is 4.375731e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.584346 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7426e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305768e-02 1 1  ON 2
   uu_3                -1.916589e-02 1 1  ON 3
   uu_4                -6.454690e-02 1 1  ON 4
   uu_5                -9.932999e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311519e-01 1 1  ON 8
   uu_9                -1.002763e-01 1 1  ON 9
   ud_0                 4.453620e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987750e-02 1 1  ON 12
   ud_3                -1.076752e-02 1 1  ON 13
   ud_4                -6.720103e-02 1 1  ON 14
   ud_5                -1.077672e-01 1 1  ON 15
   ud_6                -1.341373e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471077e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909338e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729071e-01 1 1  ON 25
   eO_6                 2.454353e-01 1 1  ON 26
   eO_7                -4.920393e-02 1 1  ON 27
   eO_8                -2.099811e-01 1 1  ON 28
   eO_9                -6.985325e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410048e-01 1 1  ON 31
  eH1_2                -9.187704e-02 1 1  ON 32
  eH1_3                -3.738920e-02 1 1  ON 33
  eH1_4                 1.162157e-02 1 1  ON 34
  eH1_5                 4.534868e-02 1 1  ON 35
  eH1_6                 1.014843e-01 1 1  ON 36
  eH1_7                 1.507968e-01 1 1  ON 37
  eH1_8                 1.645795e-01 1 1  ON 38
  eH1_9                 4.968272e-02 1 1  ON 39
  eH2_0                -2.461191e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956148e-02 1 1  ON 42
  eH2_3                -3.460408e-02 1 1  ON 43
  eH2_4                 1.430621e-02 1 1  ON 44
  eH2_5                 4.960736e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534308e-01 1 1  ON 47
  eH2_8                 1.693382e-01 1 1  ON 48
  eH2_9                 3.486802e-02 1 1  ON 49
ci_0001                 7.014450e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781592e-02 3 1  ON 52
ci_0004                -2.749069e-02 3 1  ON 53
ci_0005                -3.666459e-02 3 1  ON 54
ci_0006                -3.710027e-02 3 1  ON 55
ci_0007                -2.251861e-02 3 1  ON 56
ci_0008                -2.154049e-02 3 1  ON 57
ci_0009                -1.785229e-02 3 1  ON 58
ci_0010                -1.750383e-02 3 1  ON 59
ci_0011                -1.219752e-02 3 1  ON 60
ci_0012                -1.234249e-02 3 1  ON 61
ci_0013                 1.300617e-02 3 1  ON 62
ci_0014                 1.317849e-02 3 1  ON 63
ci_0015                 1.362504e-02 3 1  ON 64
ci_0016                 1.349998e-02 3 1  ON 65
ci_0017                 1.098899e-02 3 1  ON 66
ci_0018                 1.191330e-02 3 1  ON 67
ci_0019                 1.136435e-02 3 1  ON 68
ci_0020                 1.154279e-02 3 1  ON 69
ci_0021                -2.102505e-03 3 1  ON 70
ci_0022                -4.914100e-04 3 1  ON 71
ci_0023                -1.110237e-02 3 1  ON 72
ci_0024                -1.090647e-02 3 1  ON 73
ci_0025                -1.174370e-02 3 1  ON 74
ci_0026                -1.107543e-02 3 1  ON 75
ci_0027                -1.165980e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948590e-03 3 1  ON 78
ci_0030                -1.126677e-02 3 1  ON 79
ci_0031                 2.036701e-02 3 1  ON 80
ci_0032                 2.129432e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810479e-03 3 1  ON 83
ci_0035                 6.441514e-03 3 1  ON 84
ci_0036                 6.892832e-03 3 1  ON 85
ci_0037                -1.058267e-02 3 1  ON 86
ci_0038                -1.118887e-02 3 1  ON 87
ci_0039                -2.531885e-03 3 1  ON 88
ci_0040                -2.765590e-03 3 1  ON 89
ci_0041                 6.638125e-03 3 1  ON 90
ci_0042                 7.331295e-03 3 1  ON 91
ci_0043                -1.945850e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487162e-03 3 1  ON 94
ci_0046                 7.409371e-03 3 1  ON 95
ci_0047                -1.553700e-03 3 1  ON 96
ci_0048                -1.862502e-03 3 1  ON 97
ci_0049                -5.344912e-03 3 1  ON 98
ci_0050                -5.917989e-03 3 1  ON 99
ci_0051                -3.615127e-03 3 1  ON 100
ci_0052                -3.394658e-03 3 1  ON 101
ci_0053                -4.483524e-03 3 1  ON 102
ci_0054                -4.334918e-03 3 1  ON 103
ci_0055                 6.387907e-03 3 1  ON 104
ci_0056                 6.305107e-03 3 1  ON 105
ci_0057                 4.730685e-03 3 1  ON 106
ci_0058                 4.839594e-03 3 1  ON 107
ci_0059                -4.600576e-03 3 1  ON 108
ci_0060                -4.622876e-03 3 1  ON 109
ci_0061                -4.531649e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150620e-03 3 1  ON 112
ci_0064                -8.249732e-03 3 1  ON 113
ci_0065                -5.044323e-03 3 1  ON 114
ci_0066                -5.119927e-03 3 1  ON 115
ci_0067                -5.298704e-03 3 1  ON 116
ci_0068                -4.971055e-03 3 1  ON 117
ci_0069                 4.620455e-03 3 1  ON 118
ci_0070                 4.547103e-03 3 1  ON 119
ci_0071                 5.462922e-04 3 1  ON 120
ci_0072                -4.125996e-04 3 1  ON 121
ci_0073                 4.247495e-03 3 1  ON 122
ci_0074                 4.074889e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -16.8405
    reference variance = 1.10269
====================================================
  Execution time = 2.1541e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3441e-01
  Total weights = 1.9517e+06
  Execution time = 1.8902e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322951750270
                                         uncertainty =       0.001961579483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322951750270
                                         uncertainty =       0.001961579483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401867596
  error estimate for blocks of size 2^( 2) =       0.000414622700
  error estimate for blocks of size 2^( 3) =       0.000428342307
  error estimate for blocks of size 2^( 4) =       0.000441505594
  error estimate for blocks of size 2^( 5) =       0.000451914938
  error estimate for blocks of size 2^( 6) =       0.000459712088
  error estimate for blocks of size 2^( 7) =       0.000464387441

      target function =                  N/A
              le_mean =     -16.906148918246
             les_mean =     286.152282634724
             stat err =       0.000454380015
             autocorr =       1.278416790652
              std dev =       0.568326604648
             le_variance =       0.322995129550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322951730996
                                         uncertainty =       0.001961580894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322951730996
                                         uncertainty =       0.001961580894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401867584
  error estimate for blocks of size 2^( 2) =       0.000414622688
  error estimate for blocks of size 2^( 3) =       0.000428342295
  error estimate for blocks of size 2^( 4) =       0.000441505581
  error estimate for blocks of size 2^( 5) =       0.000451914926
  error estimate for blocks of size 2^( 6) =       0.000459712076
  error estimate for blocks of size 2^( 7) =       0.000464387430

      target function =                  N/A
              le_mean =     -16.906148918951
             les_mean =     286.152282552223
             stat err =       0.000454380003
             autocorr =       1.278416797942
              std dev =       0.568326587696
             le_variance =       0.322995110282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322951740632
                                         uncertainty =       0.001961580188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322951740632
                                         uncertainty =       0.001961580188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401867590
  error estimate for blocks of size 2^( 2) =       0.000414622694
  error estimate for blocks of size 2^( 3) =       0.000428342301
  error estimate for blocks of size 2^( 4) =       0.000441505587
  error estimate for blocks of size 2^( 5) =       0.000451914932
  error estimate for blocks of size 2^( 6) =       0.000459712082
  error estimate for blocks of size 2^( 7) =       0.000464387436

      target function =                  N/A
              le_mean =     -16.906148918599
             les_mean =     286.152282592968
             stat err =       0.000454380009
             autocorr =       1.278416794293
              std dev =       0.568326596171
             le_variance =       0.322995119916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322951749065
                                         uncertainty =       0.001961579571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322951749065
                                         uncertainty =       0.001961579571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401867595
  error estimate for blocks of size 2^( 2) =       0.000414622699
  error estimate for blocks of size 2^( 3) =       0.000428342306
  error estimate for blocks of size 2^( 4) =       0.000441505593
  error estimate for blocks of size 2^( 5) =       0.000451914938
  error estimate for blocks of size 2^( 6) =       0.000459712088
  error estimate for blocks of size 2^( 7) =       0.000464387441

      target function =                  N/A
              le_mean =     -16.906148918290
             les_mean =     286.152282629449
             stat err =       0.000454380015
             autocorr =       1.278416791106
              std dev =       0.568326603588
             le_variance =       0.322995128346


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906148918246        initial
     5.4210e+03     5.4210e+04             7.0009e-08       -16.906148918951  <--
     2.1684e+04     2.1684e+05             1.7503e-08       -16.906148918599
     8.6736e+04     8.6736e+05             4.3757e-09       -16.906148918290

*****************************************************************************
Applying the update for shift_i =   5.4210e+03     and shift_s =   5.4210e+04
*****************************************************************************

  Execution time = 3.1067e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305769e-02 1 1  ON 2
   uu_3                -1.916588e-02 1 1  ON 3
   uu_4                -6.454689e-02 1 1  ON 4
   uu_5                -9.932999e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311519e-01 1 1  ON 8
   uu_9                -1.002763e-01 1 1  ON 9
   ud_0                 4.453620e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987751e-02 1 1  ON 12
   ud_3                -1.076751e-02 1 1  ON 13
   ud_4                -6.720103e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471077e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909339e-02 1 1  ON 22
   eO_3                 2.902572e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729071e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920392e-02 1 1  ON 27
   eO_8                -2.099811e-01 1 1  ON 28
   eO_9                -6.985327e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410048e-01 1 1  ON 31
  eH1_2                -9.187705e-02 1 1  ON 32
  eH1_3                -3.738921e-02 1 1  ON 33
  eH1_4                 1.162157e-02 1 1  ON 34
  eH1_5                 4.534869e-02 1 1  ON 35
  eH1_6                 1.014843e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645795e-01 1 1  ON 38
  eH1_9                 4.968274e-02 1 1  ON 39
  eH2_0                -2.461191e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956150e-02 1 1  ON 42
  eH2_3                -3.460407e-02 1 1  ON 43
  eH2_4                 1.430621e-02 1 1  ON 44
  eH2_5                 4.960735e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693382e-01 1 1  ON 48
  eH2_9                 3.486805e-02 1 1  ON 49
ci_0001                 7.014450e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781593e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666457e-02 3 1  ON 54
ci_0006                -3.710026e-02 3 1  ON 55
ci_0007                -2.251860e-02 3 1  ON 56
ci_0008                -2.154050e-02 3 1  ON 57
ci_0009                -1.785227e-02 3 1  ON 58
ci_0010                -1.750384e-02 3 1  ON 59
ci_0011                -1.219753e-02 3 1  ON 60
ci_0012                -1.234247e-02 3 1  ON 61
ci_0013                 1.300617e-02 3 1  ON 62
ci_0014                 1.317852e-02 3 1  ON 63
ci_0015                 1.362502e-02 3 1  ON 64
ci_0016                 1.349997e-02 3 1  ON 65
ci_0017                 1.098900e-02 3 1  ON 66
ci_0018                 1.191329e-02 3 1  ON 67
ci_0019                 1.136435e-02 3 1  ON 68
ci_0020                 1.154278e-02 3 1  ON 69
ci_0021                -2.102506e-03 3 1  ON 70
ci_0022                -4.914232e-04 3 1  ON 71
ci_0023                -1.110237e-02 3 1  ON 72
ci_0024                -1.090648e-02 3 1  ON 73
ci_0025                -1.174365e-02 3 1  ON 74
ci_0026                -1.107544e-02 3 1  ON 75
ci_0027                -1.165980e-02 3 1  ON 76
ci_0028                -1.082993e-02 3 1  ON 77
ci_0029                -9.948613e-03 3 1  ON 78
ci_0030                -1.126675e-02 3 1  ON 79
ci_0031                 2.036701e-02 3 1  ON 80
ci_0032                 2.129431e-02 3 1  ON 81
ci_0033                 1.035375e-02 3 1  ON 82
ci_0034                 9.810497e-03 3 1  ON 83
ci_0035                 6.441525e-03 3 1  ON 84
ci_0036                 6.892840e-03 3 1  ON 85
ci_0037                -1.058266e-02 3 1  ON 86
ci_0038                -1.118887e-02 3 1  ON 87
ci_0039                -2.531905e-03 3 1  ON 88
ci_0040                -2.765594e-03 3 1  ON 89
ci_0041                 6.638129e-03 3 1  ON 90
ci_0042                 7.331264e-03 3 1  ON 91
ci_0043                -1.945848e-02 3 1  ON 92
ci_0044                -1.898992e-02 3 1  ON 93
ci_0045                 7.487146e-03 3 1  ON 94
ci_0046                 7.409379e-03 3 1  ON 95
ci_0047                -1.553704e-03 3 1  ON 96
ci_0048                -1.862492e-03 3 1  ON 97
ci_0049                -5.344920e-03 3 1  ON 98
ci_0050                -5.917976e-03 3 1  ON 99
ci_0051                -3.615132e-03 3 1  ON 100
ci_0052                -3.394651e-03 3 1  ON 101
ci_0053                -4.483548e-03 3 1  ON 102
ci_0054                -4.334918e-03 3 1  ON 103
ci_0055                 6.387920e-03 3 1  ON 104
ci_0056                 6.305112e-03 3 1  ON 105
ci_0057                 4.730694e-03 3 1  ON 106
ci_0058                 4.839578e-03 3 1  ON 107
ci_0059                -4.600560e-03 3 1  ON 108
ci_0060                -4.622907e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764899e-03 3 1  ON 111
ci_0063                -9.150611e-03 3 1  ON 112
ci_0064                -8.249771e-03 3 1  ON 113
ci_0065                -5.044333e-03 3 1  ON 114
ci_0066                -5.119946e-03 3 1  ON 115
ci_0067                -5.298652e-03 3 1  ON 116
ci_0068                -4.971053e-03 3 1  ON 117
ci_0069                 4.620433e-03 3 1  ON 118
ci_0070                 4.547071e-03 3 1  ON 119
ci_0071                 5.463048e-04 3 1  ON 120
ci_0072                -4.125691e-04 3 1  ON 121
ci_0073                 4.247496e-03 3 1  ON 122
ci_0074                 4.074919e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8499e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -16.9274
    reference variance = 0.234792
====================================================
  Execution time = 2.1228e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5243e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3473e-01
  Total weights = 1.951720898e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0777e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321740663323
                                         uncertainty =       0.002125407714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321740663323
                                         uncertainty =       0.002125407714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401114032
  error estimate for blocks of size 2^( 2) =       0.000414306048
  error estimate for blocks of size 2^( 3) =       0.000427962808
  error estimate for blocks of size 2^( 4) =       0.000439822199
  error estimate for blocks of size 2^( 5) =       0.000451756922
  error estimate for blocks of size 2^( 6) =       0.000460812036
  error estimate for blocks of size 2^( 7) =       0.000464931312

      target function =                  N/A
              le_mean =     -16.905906025558
             les_mean =     286.144392461684
             stat err =       0.000454330617
             autocorr =       1.282945770843
              std dev =       0.567260904318
             le_variance =       0.321784933567


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690590602556e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+03, overlap shift 1.3553e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905906025580       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905906026642       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905906026234       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905906026174       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905906026778       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905906026632       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905906026698       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905906026579       residual = 4.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905906026589       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905906026632       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3553e+03 is 4.418378e-07

solving harmonic davidson linear method for identity shift 5.4210e+03, overlap shift 5.4210e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905906025580       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905906025846       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905906025744       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905906025729       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905906025880       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905906025842       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905906025861       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905906025840       residual = 4.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905906025831       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905906025849       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.4210e+03 is 1.104771e-07

solving harmonic davidson linear method for identity shift 2.1684e+04, overlap shift 2.1684e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905906025580       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905906025647       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905906025621       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905906025617       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905906025653       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905906025647       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905906025636       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905906025637       residual = 4.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905906025647       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905906025716       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.1684e+04 is 2.762038e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.588257 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7316e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305770e-02 1 1  ON 2
   uu_3                -1.916590e-02 1 1  ON 3
   uu_4                -6.454689e-02 1 1  ON 4
   uu_5                -9.932999e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311519e-01 1 1  ON 8
   uu_9                -1.002763e-01 1 1  ON 9
   ud_0                 4.453620e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987751e-02 1 1  ON 12
   ud_3                -1.076751e-02 1 1  ON 13
   ud_4                -6.720104e-02 1 1  ON 14
   ud_5                -1.077672e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909339e-02 1 1  ON 22
   eO_3                 2.902572e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920391e-02 1 1  ON 27
   eO_8                -2.099811e-01 1 1  ON 28
   eO_9                -6.985329e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410048e-01 1 1  ON 31
  eH1_2                -9.187706e-02 1 1  ON 32
  eH1_3                -3.738921e-02 1 1  ON 33
  eH1_4                 1.162157e-02 1 1  ON 34
  eH1_5                 4.534868e-02 1 1  ON 35
  eH1_6                 1.014843e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968278e-02 1 1  ON 39
  eH2_0                -2.461191e-01 1 1  ON 40
  eH2_1                -1.390234e-01 1 1  ON 41
  eH2_2                -8.956150e-02 1 1  ON 42
  eH2_3                -3.460408e-02 1 1  ON 43
  eH2_4                 1.430623e-02 1 1  ON 44
  eH2_5                 4.960733e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693382e-01 1 1  ON 48
  eH2_9                 3.486807e-02 1 1  ON 49
ci_0001                 7.014450e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781590e-02 3 1  ON 52
ci_0004                -2.749068e-02 3 1  ON 53
ci_0005                -3.666454e-02 3 1  ON 54
ci_0006                -3.710026e-02 3 1  ON 55
ci_0007                -2.251868e-02 3 1  ON 56
ci_0008                -2.154050e-02 3 1  ON 57
ci_0009                -1.785229e-02 3 1  ON 58
ci_0010                -1.750384e-02 3 1  ON 59
ci_0011                -1.219753e-02 3 1  ON 60
ci_0012                -1.234246e-02 3 1  ON 61
ci_0013                 1.300617e-02 3 1  ON 62
ci_0014                 1.317852e-02 3 1  ON 63
ci_0015                 1.362500e-02 3 1  ON 64
ci_0016                 1.349994e-02 3 1  ON 65
ci_0017                 1.098901e-02 3 1  ON 66
ci_0018                 1.191324e-02 3 1  ON 67
ci_0019                 1.136435e-02 3 1  ON 68
ci_0020                 1.154276e-02 3 1  ON 69
ci_0021                -2.102502e-03 3 1  ON 70
ci_0022                -4.914538e-04 3 1  ON 71
ci_0023                -1.110241e-02 3 1  ON 72
ci_0024                -1.090646e-02 3 1  ON 73
ci_0025                -1.174363e-02 3 1  ON 74
ci_0026                -1.107543e-02 3 1  ON 75
ci_0027                -1.165979e-02 3 1  ON 76
ci_0028                -1.082991e-02 3 1  ON 77
ci_0029                -9.948682e-03 3 1  ON 78
ci_0030                -1.126677e-02 3 1  ON 79
ci_0031                 2.036701e-02 3 1  ON 80
ci_0032                 2.129432e-02 3 1  ON 81
ci_0033                 1.035377e-02 3 1  ON 82
ci_0034                 9.810462e-03 3 1  ON 83
ci_0035                 6.441546e-03 3 1  ON 84
ci_0036                 6.892800e-03 3 1  ON 85
ci_0037                -1.058265e-02 3 1  ON 86
ci_0038                -1.118886e-02 3 1  ON 87
ci_0039                -2.531876e-03 3 1  ON 88
ci_0040                -2.765580e-03 3 1  ON 89
ci_0041                 6.638150e-03 3 1  ON 90
ci_0042                 7.331228e-03 3 1  ON 91
ci_0043                -1.945847e-02 3 1  ON 92
ci_0044                -1.898995e-02 3 1  ON 93
ci_0045                 7.487111e-03 3 1  ON 94
ci_0046                 7.409402e-03 3 1  ON 95
ci_0047                -1.553713e-03 3 1  ON 96
ci_0048                -1.862483e-03 3 1  ON 97
ci_0049                -5.344934e-03 3 1  ON 98
ci_0050                -5.917937e-03 3 1  ON 99
ci_0051                -3.615131e-03 3 1  ON 100
ci_0052                -3.394675e-03 3 1  ON 101
ci_0053                -4.483578e-03 3 1  ON 102
ci_0054                -4.334897e-03 3 1  ON 103
ci_0055                 6.387918e-03 3 1  ON 104
ci_0056                 6.305114e-03 3 1  ON 105
ci_0057                 4.730643e-03 3 1  ON 106
ci_0058                 4.839511e-03 3 1  ON 107
ci_0059                -4.600590e-03 3 1  ON 108
ci_0060                -4.622947e-03 3 1  ON 109
ci_0061                -4.531631e-03 3 1  ON 110
ci_0062                -3.764900e-03 3 1  ON 111
ci_0063                -9.150573e-03 3 1  ON 112
ci_0064                -8.249881e-03 3 1  ON 113
ci_0065                -5.044377e-03 3 1  ON 114
ci_0066                -5.119939e-03 3 1  ON 115
ci_0067                -5.298653e-03 3 1  ON 116
ci_0068                -4.971043e-03 3 1  ON 117
ci_0069                 4.620455e-03 3 1  ON 118
ci_0070                 4.547089e-03 3 1  ON 119
ci_0071                 5.462853e-04 3 1  ON 120
ci_0072                -4.125877e-04 3 1  ON 121
ci_0073                 4.247470e-03 3 1  ON 122
ci_0074                 4.074937e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -16.8812
    reference variance = 0.173757
====================================================
  Execution time = 2.1073e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4061e-01
  Total weights = 1.9517e+06
  Execution time = 1.8965e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320096728289
                                         uncertainty =       0.001931418548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320096728289
                                         uncertainty =       0.001931418548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400156766
  error estimate for blocks of size 2^( 2) =       0.000412880756
  error estimate for blocks of size 2^( 3) =       0.000425959876
  error estimate for blocks of size 2^( 4) =       0.000438327452
  error estimate for blocks of size 2^( 5) =       0.000447858112
  error estimate for blocks of size 2^( 6) =       0.000454508762
  error estimate for blocks of size 2^( 7) =       0.000457781483

      target function =                  N/A
              le_mean =     -16.906309090099
             les_mean =     286.163899749205
             stat err =       0.000449618952
             autocorr =       1.262492739170
              std dev =       0.565907125818
             le_variance =       0.320250875052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320096906012
                                         uncertainty =       0.001931425526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320096906012
                                         uncertainty =       0.001931425526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400156877
  error estimate for blocks of size 2^( 2) =       0.000412880852
  error estimate for blocks of size 2^( 3) =       0.000425959964
  error estimate for blocks of size 2^( 4) =       0.000438327529
  error estimate for blocks of size 2^( 5) =       0.000447858185
  error estimate for blocks of size 2^( 6) =       0.000454508814
  error estimate for blocks of size 2^( 7) =       0.000457781545

      target function =                  N/A
              le_mean =     -16.906309089522
             les_mean =     286.163905095846
             stat err =       0.000449619018
             autocorr =       1.262492411017
              std dev =       0.565907282431
             le_variance =       0.320251052309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320096817160
                                         uncertainty =       0.001931422036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320096817160
                                         uncertainty =       0.001931422036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400156822
  error estimate for blocks of size 2^( 2) =       0.000412880804
  error estimate for blocks of size 2^( 3) =       0.000425959920
  error estimate for blocks of size 2^( 4) =       0.000438327491
  error estimate for blocks of size 2^( 5) =       0.000447858149
  error estimate for blocks of size 2^( 6) =       0.000454508788
  error estimate for blocks of size 2^( 7) =       0.000457781514

      target function =                  N/A
              le_mean =     -16.906309089809
             les_mean =     286.163902413956
             stat err =       0.000449618985
             autocorr =       1.262492575129
              std dev =       0.565907204133
             le_variance =       0.320250963690

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320096739398
                                         uncertainty =       0.001931418984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320096739398
                                         uncertainty =       0.001931418984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400156773
  error estimate for blocks of size 2^( 2) =       0.000412880762
  error estimate for blocks of size 2^( 3) =       0.000425959882
  error estimate for blocks of size 2^( 4) =       0.000438327457
  error estimate for blocks of size 2^( 5) =       0.000447858117
  error estimate for blocks of size 2^( 6) =       0.000454508765
  error estimate for blocks of size 2^( 7) =       0.000457781487

      target function =                  N/A
              le_mean =     -16.906309090062
             les_mean =     286.163900081341
             stat err =       0.000449618956
             autocorr =       1.262492718671
              std dev =       0.565907135607
             le_variance =       0.320250886131


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906309090099        initial  <--
     1.3553e+03     1.3553e+04             4.4184e-07       -16.906309089522
     5.4210e+03     5.4210e+04             1.1048e-07       -16.906309089809
     2.1684e+04     2.1684e+05             2.7620e-08       -16.906309090062

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6243
  </log>
  <optVariables href="H2O.s069.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305769e-02 1 1  ON 2
   uu_3                -1.916588e-02 1 1  ON 3
   uu_4                -6.454689e-02 1 1  ON 4
   uu_5                -9.932999e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311519e-01 1 1  ON 8
   uu_9                -1.002763e-01 1 1  ON 9
   ud_0                 4.453620e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987751e-02 1 1  ON 12
   ud_3                -1.076751e-02 1 1  ON 13
   ud_4                -6.720103e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471077e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909339e-02 1 1  ON 22
   eO_3                 2.902572e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729071e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920392e-02 1 1  ON 27
   eO_8                -2.099811e-01 1 1  ON 28
   eO_9                -6.985327e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410048e-01 1 1  ON 31
  eH1_2                -9.187705e-02 1 1  ON 32
  eH1_3                -3.738921e-02 1 1  ON 33
  eH1_4                 1.162157e-02 1 1  ON 34
  eH1_5                 4.534869e-02 1 1  ON 35
  eH1_6                 1.014843e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645795e-01 1 1  ON 38
  eH1_9                 4.968274e-02 1 1  ON 39
  eH2_0                -2.461191e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956150e-02 1 1  ON 42
  eH2_3                -3.460407e-02 1 1  ON 43
  eH2_4                 1.430621e-02 1 1  ON 44
  eH2_5                 4.960735e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693382e-01 1 1  ON 48
  eH2_9                 3.486805e-02 1 1  ON 49
ci_0001                 7.014450e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781593e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666457e-02 3 1  ON 54
ci_0006                -3.710026e-02 3 1  ON 55
ci_0007                -2.251860e-02 3 1  ON 56
ci_0008                -2.154050e-02 3 1  ON 57
ci_0009                -1.785227e-02 3 1  ON 58
ci_0010                -1.750384e-02 3 1  ON 59
ci_0011                -1.219753e-02 3 1  ON 60
ci_0012                -1.234247e-02 3 1  ON 61
ci_0013                 1.300617e-02 3 1  ON 62
ci_0014                 1.317852e-02 3 1  ON 63
ci_0015                 1.362502e-02 3 1  ON 64
ci_0016                 1.349997e-02 3 1  ON 65
ci_0017                 1.098900e-02 3 1  ON 66
ci_0018                 1.191329e-02 3 1  ON 67
ci_0019                 1.136435e-02 3 1  ON 68
ci_0020                 1.154278e-02 3 1  ON 69
ci_0021                -2.102506e-03 3 1  ON 70
ci_0022                -4.914232e-04 3 1  ON 71
ci_0023                -1.110237e-02 3 1  ON 72
ci_0024                -1.090648e-02 3 1  ON 73
ci_0025                -1.174365e-02 3 1  ON 74
ci_0026                -1.107544e-02 3 1  ON 75
ci_0027                -1.165980e-02 3 1  ON 76
ci_0028                -1.082993e-02 3 1  ON 77
ci_0029                -9.948613e-03 3 1  ON 78
ci_0030                -1.126675e-02 3 1  ON 79
ci_0031                 2.036701e-02 3 1  ON 80
ci_0032                 2.129431e-02 3 1  ON 81
ci_0033                 1.035375e-02 3 1  ON 82
ci_0034                 9.810497e-03 3 1  ON 83
ci_0035                 6.441525e-03 3 1  ON 84
ci_0036                 6.892840e-03 3 1  ON 85
ci_0037                -1.058266e-02 3 1  ON 86
ci_0038                -1.118887e-02 3 1  ON 87
ci_0039                -2.531905e-03 3 1  ON 88
ci_0040                -2.765594e-03 3 1  ON 89
ci_0041                 6.638129e-03 3 1  ON 90
ci_0042                 7.331264e-03 3 1  ON 91
ci_0043                -1.945848e-02 3 1  ON 92
ci_0044                -1.898992e-02 3 1  ON 93
ci_0045                 7.487146e-03 3 1  ON 94
ci_0046                 7.409379e-03 3 1  ON 95
ci_0047                -1.553704e-03 3 1  ON 96
ci_0048                -1.862492e-03 3 1  ON 97
ci_0049                -5.344920e-03 3 1  ON 98
ci_0050                -5.917976e-03 3 1  ON 99
ci_0051                -3.615132e-03 3 1  ON 100
ci_0052                -3.394651e-03 3 1  ON 101
ci_0053                -4.483548e-03 3 1  ON 102
ci_0054                -4.334918e-03 3 1  ON 103
ci_0055                 6.387920e-03 3 1  ON 104
ci_0056                 6.305112e-03 3 1  ON 105
ci_0057                 4.730694e-03 3 1  ON 106
ci_0058                 4.839578e-03 3 1  ON 107
ci_0059                -4.600560e-03 3 1  ON 108
ci_0060                -4.622907e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764899e-03 3 1  ON 111
ci_0063                -9.150611e-03 3 1  ON 112
ci_0064                -8.249771e-03 3 1  ON 113
ci_0065                -5.044333e-03 3 1  ON 114
ci_0066                -5.119946e-03 3 1  ON 115
ci_0067                -5.298652e-03 3 1  ON 116
ci_0068                -4.971053e-03 3 1  ON 117
ci_0069                 4.620433e-03 3 1  ON 118
ci_0070                 4.547071e-03 3 1  ON 119
ci_0071                 5.463048e-04 3 1  ON 120
ci_0072                -4.125691e-04 3 1  ON 121
ci_0073                 4.247496e-03 3 1  ON 122
ci_0074                 4.074919e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7946e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -16.9927
    reference variance = 0.259951
====================================================
  Execution time = 2.1542e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3737e-01
  Total weights = 1.951647426e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0200e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322082249291
                                         uncertainty =       0.002275602324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322082249291
                                         uncertainty =       0.002275602324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401285692
  error estimate for blocks of size 2^( 2) =       0.000414088363
  error estimate for blocks of size 2^( 3) =       0.000427399695
  error estimate for blocks of size 2^( 4) =       0.000440163596
  error estimate for blocks of size 2^( 5) =       0.000453146365
  error estimate for blocks of size 2^( 6) =       0.000462414338
  error estimate for blocks of size 2^( 7) =       0.000467382310

      target function =                  N/A
              le_mean =     -16.906082114977
             les_mean =     286.152977638752
             stat err =       0.000455776652
             autocorr =       1.290021057103
              std dev =       0.567503667330
             le_variance =       0.322060412433


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690608211498e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+04, overlap shift 1.3553e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906082114965       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906082115136       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906082115203       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906082115223       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906082115256       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906082115274       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906082115185       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906082115186       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906082115233       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906082115303       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3553e+04 is 3.044480e-08

solving harmonic davidson linear method for identity shift 5.4210e+04, overlap shift 5.4210e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906082114965       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906082115008       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906082115025       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906082115030       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906082115051       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906082115112       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906082115050       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906082115039       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906082115013       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906082115109       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.4210e+04 is 7.611301e-09

solving harmonic davidson linear method for identity shift 2.1684e+05, overlap shift 2.1684e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906082114965       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906082114976       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906082114980       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906082114964       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906082114971       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906082115101       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906082115252       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906082114913       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906082114889       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906082114995       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.1684e+05 is 1.902831e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.592150 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7570e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305769e-02 1 1  ON 2
   uu_3                -1.916588e-02 1 1  ON 3
   uu_4                -6.454689e-02 1 1  ON 4
   uu_5                -9.932999e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311519e-01 1 1  ON 8
   uu_9                -1.002763e-01 1 1  ON 9
   ud_0                 4.453620e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987751e-02 1 1  ON 12
   ud_3                -1.076751e-02 1 1  ON 13
   ud_4                -6.720103e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471077e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909339e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729071e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920392e-02 1 1  ON 27
   eO_8                -2.099811e-01 1 1  ON 28
   eO_9                -6.985328e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410048e-01 1 1  ON 31
  eH1_2                -9.187706e-02 1 1  ON 32
  eH1_3                -3.738921e-02 1 1  ON 33
  eH1_4                 1.162156e-02 1 1  ON 34
  eH1_5                 4.534869e-02 1 1  ON 35
  eH1_6                 1.014843e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645795e-01 1 1  ON 38
  eH1_9                 4.968274e-02 1 1  ON 39
  eH2_0                -2.461191e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956150e-02 1 1  ON 42
  eH2_3                -3.460407e-02 1 1  ON 43
  eH2_4                 1.430621e-02 1 1  ON 44
  eH2_5                 4.960734e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693382e-01 1 1  ON 48
  eH2_9                 3.486805e-02 1 1  ON 49
ci_0001                 7.014450e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781593e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666457e-02 3 1  ON 54
ci_0006                -3.710026e-02 3 1  ON 55
ci_0007                -2.251860e-02 3 1  ON 56
ci_0008                -2.154050e-02 3 1  ON 57
ci_0009                -1.785226e-02 3 1  ON 58
ci_0010                -1.750384e-02 3 1  ON 59
ci_0011                -1.219753e-02 3 1  ON 60
ci_0012                -1.234247e-02 3 1  ON 61
ci_0013                 1.300617e-02 3 1  ON 62
ci_0014                 1.317851e-02 3 1  ON 63
ci_0015                 1.362501e-02 3 1  ON 64
ci_0016                 1.349997e-02 3 1  ON 65
ci_0017                 1.098901e-02 3 1  ON 66
ci_0018                 1.191328e-02 3 1  ON 67
ci_0019                 1.136435e-02 3 1  ON 68
ci_0020                 1.154278e-02 3 1  ON 69
ci_0021                -2.102505e-03 3 1  ON 70
ci_0022                -4.914209e-04 3 1  ON 71
ci_0023                -1.110237e-02 3 1  ON 72
ci_0024                -1.090648e-02 3 1  ON 73
ci_0025                -1.174364e-02 3 1  ON 74
ci_0026                -1.107543e-02 3 1  ON 75
ci_0027                -1.165980e-02 3 1  ON 76
ci_0028                -1.082993e-02 3 1  ON 77
ci_0029                -9.948616e-03 3 1  ON 78
ci_0030                -1.126675e-02 3 1  ON 79
ci_0031                 2.036701e-02 3 1  ON 80
ci_0032                 2.129431e-02 3 1  ON 81
ci_0033                 1.035375e-02 3 1  ON 82
ci_0034                 9.810499e-03 3 1  ON 83
ci_0035                 6.441523e-03 3 1  ON 84
ci_0036                 6.892842e-03 3 1  ON 85
ci_0037                -1.058266e-02 3 1  ON 86
ci_0038                -1.118887e-02 3 1  ON 87
ci_0039                -2.531908e-03 3 1  ON 88
ci_0040                -2.765589e-03 3 1  ON 89
ci_0041                 6.638132e-03 3 1  ON 90
ci_0042                 7.331267e-03 3 1  ON 91
ci_0043                -1.945848e-02 3 1  ON 92
ci_0044                -1.898992e-02 3 1  ON 93
ci_0045                 7.487145e-03 3 1  ON 94
ci_0046                 7.409382e-03 3 1  ON 95
ci_0047                -1.553709e-03 3 1  ON 96
ci_0048                -1.862495e-03 3 1  ON 97
ci_0049                -5.344920e-03 3 1  ON 98
ci_0050                -5.917972e-03 3 1  ON 99
ci_0051                -3.615129e-03 3 1  ON 100
ci_0052                -3.394651e-03 3 1  ON 101
ci_0053                -4.483556e-03 3 1  ON 102
ci_0054                -4.334922e-03 3 1  ON 103
ci_0055                 6.387920e-03 3 1  ON 104
ci_0056                 6.305109e-03 3 1  ON 105
ci_0057                 4.730700e-03 3 1  ON 106
ci_0058                 4.839580e-03 3 1  ON 107
ci_0059                -4.600561e-03 3 1  ON 108
ci_0060                -4.622906e-03 3 1  ON 109
ci_0061                -4.531640e-03 3 1  ON 110
ci_0062                -3.764895e-03 3 1  ON 111
ci_0063                -9.150606e-03 3 1  ON 112
ci_0064                -8.249770e-03 3 1  ON 113
ci_0065                -5.044335e-03 3 1  ON 114
ci_0066                -5.119946e-03 3 1  ON 115
ci_0067                -5.298646e-03 3 1  ON 116
ci_0068                -4.971055e-03 3 1  ON 117
ci_0069                 4.620434e-03 3 1  ON 118
ci_0070                 4.547068e-03 3 1  ON 119
ci_0071                 5.463033e-04 3 1  ON 120
ci_0072                -4.125657e-04 3 1  ON 121
ci_0073                 4.247495e-03 3 1  ON 122
ci_0074                 4.074918e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -16.948
    reference variance = 0.211591
====================================================
  Execution time = 2.1192e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4053e-01
  Total weights = 1.9518e+06
  Execution time = 1.8569e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327124080624
                                         uncertainty =       0.003449796544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327124080624
                                         uncertainty =       0.003449796544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404453487
  error estimate for blocks of size 2^( 2) =       0.000417875476
  error estimate for blocks of size 2^( 3) =       0.000431456254
  error estimate for blocks of size 2^( 4) =       0.000443937040
  error estimate for blocks of size 2^( 5) =       0.000455508256
  error estimate for blocks of size 2^( 6) =       0.000463461684
  error estimate for blocks of size 2^( 7) =       0.000469527689

      target function =                  N/A
              le_mean =     -16.905818306731
             les_mean =     286.147222933764
             stat err =       0.000458108667
             autocorr =       1.282920808855
              std dev =       0.571983606701
             le_variance =       0.327165246335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327124032877
                                         uncertainty =       0.003449761263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327124032877
                                         uncertainty =       0.003449761263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404453458
  error estimate for blocks of size 2^( 2) =       0.000417875446
  error estimate for blocks of size 2^( 3) =       0.000431456225
  error estimate for blocks of size 2^( 4) =       0.000443937012
  error estimate for blocks of size 2^( 5) =       0.000455508229
  error estimate for blocks of size 2^( 6) =       0.000463461656
  error estimate for blocks of size 2^( 7) =       0.000469527660

      target function =                  N/A
              le_mean =     -16.905818307057
             les_mean =     286.147222857291
             stat err =       0.000458108639
             autocorr =       1.282920838106
              std dev =       0.571983565047
             le_variance =       0.327165198684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327124056750
                                         uncertainty =       0.003449778903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327124056750
                                         uncertainty =       0.003449778903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404453472
  error estimate for blocks of size 2^( 2) =       0.000417875461
  error estimate for blocks of size 2^( 3) =       0.000431456240
  error estimate for blocks of size 2^( 4) =       0.000443937026
  error estimate for blocks of size 2^( 5) =       0.000455508242
  error estimate for blocks of size 2^( 6) =       0.000463461670
  error estimate for blocks of size 2^( 7) =       0.000469527675

      target function =                  N/A
              le_mean =     -16.905818306894
             les_mean =     286.147222895501
             stat err =       0.000458108653
             autocorr =       1.282920823481
              std dev =       0.571983585874
             le_variance =       0.327165222509

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327124077640
                                         uncertainty =       0.003449794339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327124077640
                                         uncertainty =       0.003449794339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404453485
  error estimate for blocks of size 2^( 2) =       0.000417875474
  error estimate for blocks of size 2^( 3) =       0.000431456252
  error estimate for blocks of size 2^( 4) =       0.000443937038
  error estimate for blocks of size 2^( 5) =       0.000455508254
  error estimate for blocks of size 2^( 6) =       0.000463461683
  error estimate for blocks of size 2^( 7) =       0.000469527687

      target function =                  N/A
              le_mean =     -16.905818306751
             les_mean =     286.147222928978
             stat err =       0.000458108666
             autocorr =       1.282920810673
              std dev =       0.571983604098
             le_variance =       0.327165243357


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905818306731        initial
     1.3553e+04     1.3553e+05             3.0445e-08       -16.905818307057  <--
     5.4210e+04     5.4210e+05             7.6113e-09       -16.905818306894
     2.1684e+05     2.1684e+06             1.9028e-09       -16.905818306751

*****************************************************************************
Applying the update for shift_i =   1.3553e+04     and shift_s =   1.3553e+05
*****************************************************************************

  Execution time = 3.0723e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305770e-02 1 1  ON 2
   uu_3                -1.916588e-02 1 1  ON 3
   uu_4                -6.454690e-02 1 1  ON 4
   uu_5                -9.932999e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311519e-01 1 1  ON 8
   uu_9                -1.002763e-01 1 1  ON 9
   ud_0                 4.453620e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987751e-02 1 1  ON 12
   ud_3                -1.076750e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909339e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729071e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920391e-02 1 1  ON 27
   eO_8                -2.099811e-01 1 1  ON 28
   eO_9                -6.985328e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410048e-01 1 1  ON 31
  eH1_2                -9.187707e-02 1 1  ON 32
  eH1_3                -3.738921e-02 1 1  ON 33
  eH1_4                 1.162156e-02 1 1  ON 34
  eH1_5                 4.534869e-02 1 1  ON 35
  eH1_6                 1.014843e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645795e-01 1 1  ON 38
  eH1_9                 4.968276e-02 1 1  ON 39
  eH2_0                -2.461191e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956150e-02 1 1  ON 42
  eH2_3                -3.460407e-02 1 1  ON 43
  eH2_4                 1.430621e-02 1 1  ON 44
  eH2_5                 4.960734e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693382e-01 1 1  ON 48
  eH2_9                 3.486806e-02 1 1  ON 49
ci_0001                 7.014450e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781593e-02 3 1  ON 52
ci_0004                -2.749065e-02 3 1  ON 53
ci_0005                -3.666457e-02 3 1  ON 54
ci_0006                -3.710027e-02 3 1  ON 55
ci_0007                -2.251861e-02 3 1  ON 56
ci_0008                -2.154050e-02 3 1  ON 57
ci_0009                -1.785225e-02 3 1  ON 58
ci_0010                -1.750383e-02 3 1  ON 59
ci_0011                -1.219754e-02 3 1  ON 60
ci_0012                -1.234247e-02 3 1  ON 61
ci_0013                 1.300617e-02 3 1  ON 62
ci_0014                 1.317850e-02 3 1  ON 63
ci_0015                 1.362500e-02 3 1  ON 64
ci_0016                 1.349996e-02 3 1  ON 65
ci_0017                 1.098903e-02 3 1  ON 66
ci_0018                 1.191326e-02 3 1  ON 67
ci_0019                 1.136436e-02 3 1  ON 68
ci_0020                 1.154278e-02 3 1  ON 69
ci_0021                -2.102503e-03 3 1  ON 70
ci_0022                -4.914140e-04 3 1  ON 71
ci_0023                -1.110237e-02 3 1  ON 72
ci_0024                -1.090647e-02 3 1  ON 73
ci_0025                -1.174363e-02 3 1  ON 74
ci_0026                -1.107543e-02 3 1  ON 75
ci_0027                -1.165979e-02 3 1  ON 76
ci_0028                -1.082993e-02 3 1  ON 77
ci_0029                -9.948626e-03 3 1  ON 78
ci_0030                -1.126674e-02 3 1  ON 79
ci_0031                 2.036701e-02 3 1  ON 80
ci_0032                 2.129431e-02 3 1  ON 81
ci_0033                 1.035376e-02 3 1  ON 82
ci_0034                 9.810507e-03 3 1  ON 83
ci_0035                 6.441517e-03 3 1  ON 84
ci_0036                 6.892849e-03 3 1  ON 85
ci_0037                -1.058266e-02 3 1  ON 86
ci_0038                -1.118887e-02 3 1  ON 87
ci_0039                -2.531917e-03 3 1  ON 88
ci_0040                -2.765574e-03 3 1  ON 89
ci_0041                 6.638142e-03 3 1  ON 90
ci_0042                 7.331276e-03 3 1  ON 91
ci_0043                -1.945848e-02 3 1  ON 92
ci_0044                -1.898992e-02 3 1  ON 93
ci_0045                 7.487141e-03 3 1  ON 94
ci_0046                 7.409393e-03 3 1  ON 95
ci_0047                -1.553723e-03 3 1  ON 96
ci_0048                -1.862505e-03 3 1  ON 97
ci_0049                -5.344921e-03 3 1  ON 98
ci_0050                -5.917960e-03 3 1  ON 99
ci_0051                -3.615119e-03 3 1  ON 100
ci_0052                -3.394650e-03 3 1  ON 101
ci_0053                -4.483578e-03 3 1  ON 102
ci_0054                -4.334934e-03 3 1  ON 103
ci_0055                 6.387921e-03 3 1  ON 104
ci_0056                 6.305102e-03 3 1  ON 105
ci_0057                 4.730715e-03 3 1  ON 106
ci_0058                 4.839588e-03 3 1  ON 107
ci_0059                -4.600564e-03 3 1  ON 108
ci_0060                -4.622903e-03 3 1  ON 109
ci_0061                -4.531651e-03 3 1  ON 110
ci_0062                -3.764884e-03 3 1  ON 111
ci_0063                -9.150590e-03 3 1  ON 112
ci_0064                -8.249768e-03 3 1  ON 113
ci_0065                -5.044343e-03 3 1  ON 114
ci_0066                -5.119943e-03 3 1  ON 115
ci_0067                -5.298628e-03 3 1  ON 116
ci_0068                -4.971060e-03 3 1  ON 117
ci_0069                 4.620436e-03 3 1  ON 118
ci_0070                 4.547062e-03 3 1  ON 119
ci_0071                 5.462989e-04 3 1  ON 120
ci_0072                -4.125554e-04 3 1  ON 121
ci_0073                 4.247494e-03 3 1  ON 122
ci_0074                 4.074912e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8300e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -16.8471
    reference variance = 0.201894
====================================================
  Execution time = 2.1335e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5220e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3508e-01
  Total weights = 1.951808488e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0848e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319522619977
                                         uncertainty =       0.002212768172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319522619977
                                         uncertainty =       0.002212768172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399726948
  error estimate for blocks of size 2^( 2) =       0.000412503512
  error estimate for blocks of size 2^( 3) =       0.000425332012
  error estimate for blocks of size 2^( 4) =       0.000437692846
  error estimate for blocks of size 2^( 5) =       0.000447447848
  error estimate for blocks of size 2^( 6) =       0.000454787993
  error estimate for blocks of size 2^( 7) =       0.000458055304

      target function =                  N/A
              le_mean =     -16.905995032441
             les_mean =     286.147746816557
             stat err =       0.000449495998
             autocorr =       1.264517379934
              std dev =       0.565299271143
             le_variance =       0.319563265954


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690599503244e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e+03, overlap shift 3.3881e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905995032434       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905995033633       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905995033564       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905995033681       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905995033862       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905995033871       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905995033970       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905995033911       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905995033874       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3881e+03 is 1.279394e-07

solving harmonic davidson linear method for identity shift 1.3553e+04, overlap shift 1.3553e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905995032434       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905995032734       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905995032716       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905995032746       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905995032791       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905995032793       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905995032818       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905995032791       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905995032827       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3553e+04 is 3.198694e-08

solving harmonic davidson linear method for identity shift 5.4210e+04, overlap shift 5.4210e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905995032434       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905995032509       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905995032505       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905995032512       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905995032523       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905995032500       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905995032563       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905995032544       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905995032601       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.4210e+04 is 7.996867e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.595532 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7427e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305770e-02 1 1  ON 2
   uu_3                -1.916588e-02 1 1  ON 3
   uu_4                -6.454690e-02 1 1  ON 4
   uu_5                -9.932999e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311519e-01 1 1  ON 8
   uu_9                -1.002763e-01 1 1  ON 9
   ud_0                 4.453620e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987751e-02 1 1  ON 12
   ud_3                -1.076750e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909339e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729071e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920391e-02 1 1  ON 27
   eO_8                -2.099811e-01 1 1  ON 28
   eO_9                -6.985329e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410048e-01 1 1  ON 31
  eH1_2                -9.187707e-02 1 1  ON 32
  eH1_3                -3.738921e-02 1 1  ON 33
  eH1_4                 1.162156e-02 1 1  ON 34
  eH1_5                 4.534868e-02 1 1  ON 35
  eH1_6                 1.014843e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645795e-01 1 1  ON 38
  eH1_9                 4.968277e-02 1 1  ON 39
  eH2_0                -2.461191e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956151e-02 1 1  ON 42
  eH2_3                -3.460408e-02 1 1  ON 43
  eH2_4                 1.430621e-02 1 1  ON 44
  eH2_5                 4.960732e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693382e-01 1 1  ON 48
  eH2_9                 3.486807e-02 1 1  ON 49
ci_0001                 7.014450e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781592e-02 3 1  ON 52
ci_0004                -2.749065e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710025e-02 3 1  ON 55
ci_0007                -2.251861e-02 3 1  ON 56
ci_0008                -2.154051e-02 3 1  ON 57
ci_0009                -1.785222e-02 3 1  ON 58
ci_0010                -1.750383e-02 3 1  ON 59
ci_0011                -1.219754e-02 3 1  ON 60
ci_0012                -1.234248e-02 3 1  ON 61
ci_0013                 1.300618e-02 3 1  ON 62
ci_0014                 1.317849e-02 3 1  ON 63
ci_0015                 1.362500e-02 3 1  ON 64
ci_0016                 1.349994e-02 3 1  ON 65
ci_0017                 1.098903e-02 3 1  ON 66
ci_0018                 1.191326e-02 3 1  ON 67
ci_0019                 1.136436e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102498e-03 3 1  ON 70
ci_0022                -4.914085e-04 3 1  ON 71
ci_0023                -1.110237e-02 3 1  ON 72
ci_0024                -1.090648e-02 3 1  ON 73
ci_0025                -1.174362e-02 3 1  ON 74
ci_0026                -1.107542e-02 3 1  ON 75
ci_0027                -1.165979e-02 3 1  ON 76
ci_0028                -1.082993e-02 3 1  ON 77
ci_0029                -9.948650e-03 3 1  ON 78
ci_0030                -1.126672e-02 3 1  ON 79
ci_0031                 2.036702e-02 3 1  ON 80
ci_0032                 2.129430e-02 3 1  ON 81
ci_0033                 1.035376e-02 3 1  ON 82
ci_0034                 9.810518e-03 3 1  ON 83
ci_0035                 6.441529e-03 3 1  ON 84
ci_0036                 6.892855e-03 3 1  ON 85
ci_0037                -1.058265e-02 3 1  ON 86
ci_0038                -1.118888e-02 3 1  ON 87
ci_0039                -2.531920e-03 3 1  ON 88
ci_0040                -2.765581e-03 3 1  ON 89
ci_0041                 6.638149e-03 3 1  ON 90
ci_0042                 7.331268e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898992e-02 3 1  ON 93
ci_0045                 7.487140e-03 3 1  ON 94
ci_0046                 7.409388e-03 3 1  ON 95
ci_0047                -1.553737e-03 3 1  ON 96
ci_0048                -1.862491e-03 3 1  ON 97
ci_0049                -5.344923e-03 3 1  ON 98
ci_0050                -5.917962e-03 3 1  ON 99
ci_0051                -3.615102e-03 3 1  ON 100
ci_0052                -3.394653e-03 3 1  ON 101
ci_0053                -4.483588e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387906e-03 3 1  ON 104
ci_0056                 6.305093e-03 3 1  ON 105
ci_0057                 4.730729e-03 3 1  ON 106
ci_0058                 4.839608e-03 3 1  ON 107
ci_0059                -4.600582e-03 3 1  ON 108
ci_0060                -4.622902e-03 3 1  ON 109
ci_0061                -4.531650e-03 3 1  ON 110
ci_0062                -3.764893e-03 3 1  ON 111
ci_0063                -9.150558e-03 3 1  ON 112
ci_0064                -8.249778e-03 3 1  ON 113
ci_0065                -5.044334e-03 3 1  ON 114
ci_0066                -5.119961e-03 3 1  ON 115
ci_0067                -5.298610e-03 3 1  ON 116
ci_0068                -4.971054e-03 3 1  ON 117
ci_0069                 4.620443e-03 3 1  ON 118
ci_0070                 4.547057e-03 3 1  ON 119
ci_0071                 5.462970e-04 3 1  ON 120
ci_0072                -4.125356e-04 3 1  ON 121
ci_0073                 4.247487e-03 3 1  ON 122
ci_0074                 4.074920e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -16.8988
    reference variance = 0.312411
====================================================
  Execution time = 2.1382e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3872e-01
  Total weights = 1.9514e+06
  Execution time = 1.8573e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324862760682
                                         uncertainty =       0.002873906360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324862760682
                                         uncertainty =       0.002873906360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403093550
  error estimate for blocks of size 2^( 2) =       0.000415917519
  error estimate for blocks of size 2^( 3) =       0.000429103118
  error estimate for blocks of size 2^( 4) =       0.000441268846
  error estimate for blocks of size 2^( 5) =       0.000452511392
  error estimate for blocks of size 2^( 6) =       0.000461472914
  error estimate for blocks of size 2^( 7) =       0.000468969201

      target function =                  N/A
              le_mean =     -16.906053161452
             les_mean =     286.153350270637
             stat err =       0.000456055588
             autocorr =       1.280040958787
              std dev =       0.570060364743
             le_variance =       0.324968819451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324862779352
                                         uncertainty =       0.002873921938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324862779352
                                         uncertainty =       0.002873921938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403093561
  error estimate for blocks of size 2^( 2) =       0.000415917531
  error estimate for blocks of size 2^( 3) =       0.000429103130
  error estimate for blocks of size 2^( 4) =       0.000441268858
  error estimate for blocks of size 2^( 5) =       0.000452511404
  error estimate for blocks of size 2^( 6) =       0.000461472930
  error estimate for blocks of size 2^( 7) =       0.000468969214

      target function =                  N/A
              le_mean =     -16.906053163042
             les_mean =     286.153350298511
             stat err =       0.000456055602
             autocorr =       1.280040961538
              std dev =       0.570060380798
             le_variance =       0.324968837755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324862770017
                                         uncertainty =       0.002873914149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324862770017
                                         uncertainty =       0.002873914149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403093555
  error estimate for blocks of size 2^( 2) =       0.000415917525
  error estimate for blocks of size 2^( 3) =       0.000429103124
  error estimate for blocks of size 2^( 4) =       0.000441268852
  error estimate for blocks of size 2^( 5) =       0.000452511398
  error estimate for blocks of size 2^( 6) =       0.000461472922
  error estimate for blocks of size 2^( 7) =       0.000468969208

      target function =                  N/A
              le_mean =     -16.906053162247
             les_mean =     286.153350284454
             stat err =       0.000456055595
             autocorr =       1.280040960161
              std dev =       0.570060372770
             le_variance =       0.324968828603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324862761849
                                         uncertainty =       0.002873907333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324862761849
                                         uncertainty =       0.002873907333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403093550
  error estimate for blocks of size 2^( 2) =       0.000415917519
  error estimate for blocks of size 2^( 3) =       0.000429103119
  error estimate for blocks of size 2^( 4) =       0.000441268846
  error estimate for blocks of size 2^( 5) =       0.000452511393
  error estimate for blocks of size 2^( 6) =       0.000461472915
  error estimate for blocks of size 2^( 7) =       0.000468969202

      target function =                  N/A
              le_mean =     -16.906053161552
             les_mean =     286.153350272351
             stat err =       0.000456055589
             autocorr =       1.280040958950
              std dev =       0.570060365746
             le_variance =       0.324968820594


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906053161452        initial
     3.3881e+03     3.3881e+04             1.2794e-07       -16.906053163042  <--
     1.3553e+04     1.3553e+05             3.1987e-08       -16.906053162247
     5.4210e+04     5.4210e+05             7.9969e-09       -16.906053161552

*****************************************************************************
Applying the update for shift_i =   3.3881e+03     and shift_s =   3.3881e+04
*****************************************************************************

  Execution time = 3.0925e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453620e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920389e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985332e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410048e-01 1 1  ON 31
  eH1_2                -9.187709e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968281e-02 1 1  ON 39
  eH2_0                -2.461191e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956154e-02 1 1  ON 42
  eH2_3                -3.460409e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960728e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486811e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781589e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251858e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785214e-02 3 1  ON 58
ci_0010                -1.750382e-02 3 1  ON 59
ci_0011                -1.219755e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317848e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349987e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191323e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102482e-03 3 1  ON 70
ci_0022                -4.913918e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090652e-02 3 1  ON 73
ci_0025                -1.174357e-02 3 1  ON 74
ci_0026                -1.107541e-02 3 1  ON 75
ci_0027                -1.165978e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948723e-03 3 1  ON 78
ci_0030                -1.126669e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129427e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810552e-03 3 1  ON 83
ci_0035                 6.441563e-03 3 1  ON 84
ci_0036                 6.892875e-03 3 1  ON 85
ci_0037                -1.058261e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531927e-03 3 1  ON 88
ci_0040                -2.765601e-03 3 1  ON 89
ci_0041                 6.638168e-03 3 1  ON 90
ci_0042                 7.331246e-03 3 1  ON 91
ci_0043                -1.945850e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487135e-03 3 1  ON 94
ci_0046                 7.409373e-03 3 1  ON 95
ci_0047                -1.553778e-03 3 1  ON 96
ci_0048                -1.862448e-03 3 1  ON 97
ci_0049                -5.344929e-03 3 1  ON 98
ci_0050                -5.917971e-03 3 1  ON 99
ci_0051                -3.615050e-03 3 1  ON 100
ci_0052                -3.394664e-03 3 1  ON 101
ci_0053                -4.483617e-03 3 1  ON 102
ci_0054                -4.334923e-03 3 1  ON 103
ci_0055                 6.387861e-03 3 1  ON 104
ci_0056                 6.305068e-03 3 1  ON 105
ci_0057                 4.730769e-03 3 1  ON 106
ci_0058                 4.839668e-03 3 1  ON 107
ci_0059                -4.600634e-03 3 1  ON 108
ci_0060                -4.622900e-03 3 1  ON 109
ci_0061                -4.531646e-03 3 1  ON 110
ci_0062                -3.764922e-03 3 1  ON 111
ci_0063                -9.150462e-03 3 1  ON 112
ci_0064                -8.249810e-03 3 1  ON 113
ci_0065                -5.044308e-03 3 1  ON 114
ci_0066                -5.120013e-03 3 1  ON 115
ci_0067                -5.298557e-03 3 1  ON 116
ci_0068                -4.971038e-03 3 1  ON 117
ci_0069                 4.620464e-03 3 1  ON 118
ci_0070                 4.547043e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124761e-04 3 1  ON 121
ci_0073                 4.247467e-03 3 1  ON 122
ci_0074                 4.074943e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8358e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -16.9775
    reference variance = 0.234838
====================================================
  Execution time = 2.1526e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5243e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3299e-01
  Total weights = 1.951865038e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1160e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321284657874
                                         uncertainty =       0.002343809160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321284657874
                                         uncertainty =       0.002343809160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400748909
  error estimate for blocks of size 2^( 2) =       0.000413644772
  error estimate for blocks of size 2^( 3) =       0.000426296045
  error estimate for blocks of size 2^( 4) =       0.000438972740
  error estimate for blocks of size 2^( 5) =       0.000449585752
  error estimate for blocks of size 2^( 6) =       0.000455339560
  error estimate for blocks of size 2^( 7) =       0.000457737774

      target function =                  N/A
              le_mean =     -16.906498045987
             les_mean =     286.162668955628
             stat err =       0.000450408956
             autocorr =       1.263191921154
              std dev =       0.566744541580
             le_variance =       0.321199375410


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690649804599e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+02, overlap shift 8.4703e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906498045975       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906498058862       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906498059054       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906498059300       residual = 8.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906498059836       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906498059599       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906498059556       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906498059322       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906498059356       residual = 8.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.4703e+02 is 3.932330e-07

solving harmonic davidson linear method for identity shift 3.3881e+03, overlap shift 3.3881e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906498045975       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906498049198       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906498049246       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906498049306       residual = 8.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906498049442       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906498049382       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906498049367       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906498049313       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906498049310       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3881e+03 is 9.832997e-08

solving harmonic davidson linear method for identity shift 1.3553e+04, overlap shift 1.3553e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906498045975       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906498046781       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906498046793       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906498046806       residual = 8.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906498046842       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906498046827       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906498046830       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906498046812       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906498046816       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3553e+04 is 2.458385e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.598882 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7649e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
   uu_0                 3.117532e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305773e-02 1 1  ON 2
   uu_3                -1.916586e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932999e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389810e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385814e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276998e-01 1 1  ON 21
   eO_2                -1.909340e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454355e-01 1 1  ON 26
   eO_7                -4.920387e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985337e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187712e-02 1 1  ON 32
  eH1_3                -3.738923e-02 1 1  ON 33
  eH1_4                 1.162154e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968286e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956154e-02 1 1  ON 42
  eH2_3                -3.460409e-02 1 1  ON 43
  eH2_4                 1.430619e-02 1 1  ON 44
  eH2_5                 4.960725e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486816e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781584e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666455e-02 3 1  ON 54
ci_0006                -3.710025e-02 3 1  ON 55
ci_0007                -2.251861e-02 3 1  ON 56
ci_0008                -2.154056e-02 3 1  ON 57
ci_0009                -1.785209e-02 3 1  ON 58
ci_0010                -1.750379e-02 3 1  ON 59
ci_0011                -1.219752e-02 3 1  ON 60
ci_0012                -1.234247e-02 3 1  ON 61
ci_0013                 1.300618e-02 3 1  ON 62
ci_0014                 1.317846e-02 3 1  ON 63
ci_0015                 1.362494e-02 3 1  ON 64
ci_0016                 1.349979e-02 3 1  ON 65
ci_0017                 1.098908e-02 3 1  ON 66
ci_0018                 1.191318e-02 3 1  ON 67
ci_0019                 1.136435e-02 3 1  ON 68
ci_0020                 1.154273e-02 3 1  ON 69
ci_0021                -2.102475e-03 3 1  ON 70
ci_0022                -4.913685e-04 3 1  ON 71
ci_0023                -1.110243e-02 3 1  ON 72
ci_0024                -1.090652e-02 3 1  ON 73
ci_0025                -1.174352e-02 3 1  ON 74
ci_0026                -1.107532e-02 3 1  ON 75
ci_0027                -1.165976e-02 3 1  ON 76
ci_0028                -1.082993e-02 3 1  ON 77
ci_0029                -9.948741e-03 3 1  ON 78
ci_0030                -1.126665e-02 3 1  ON 79
ci_0031                 2.036703e-02 3 1  ON 80
ci_0032                 2.129421e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810574e-03 3 1  ON 83
ci_0035                 6.441582e-03 3 1  ON 84
ci_0036                 6.892911e-03 3 1  ON 85
ci_0037                -1.058263e-02 3 1  ON 86
ci_0038                -1.118887e-02 3 1  ON 87
ci_0039                -2.531898e-03 3 1  ON 88
ci_0040                -2.765616e-03 3 1  ON 89
ci_0041                 6.638182e-03 3 1  ON 90
ci_0042                 7.331194e-03 3 1  ON 91
ci_0043                -1.945852e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487045e-03 3 1  ON 94
ci_0046                 7.409418e-03 3 1  ON 95
ci_0047                -1.553793e-03 3 1  ON 96
ci_0048                -1.862493e-03 3 1  ON 97
ci_0049                -5.344907e-03 3 1  ON 98
ci_0050                -5.917907e-03 3 1  ON 99
ci_0051                -3.615011e-03 3 1  ON 100
ci_0052                -3.394669e-03 3 1  ON 101
ci_0053                -4.483654e-03 3 1  ON 102
ci_0054                -4.334904e-03 3 1  ON 103
ci_0055                 6.387816e-03 3 1  ON 104
ci_0056                 6.305030e-03 3 1  ON 105
ci_0057                 4.730826e-03 3 1  ON 106
ci_0058                 4.839602e-03 3 1  ON 107
ci_0059                -4.600676e-03 3 1  ON 108
ci_0060                -4.622933e-03 3 1  ON 109
ci_0061                -4.531590e-03 3 1  ON 110
ci_0062                -3.764881e-03 3 1  ON 111
ci_0063                -9.150425e-03 3 1  ON 112
ci_0064                -8.249794e-03 3 1  ON 113
ci_0065                -5.044406e-03 3 1  ON 114
ci_0066                -5.119962e-03 3 1  ON 115
ci_0067                -5.298525e-03 3 1  ON 116
ci_0068                -4.971073e-03 3 1  ON 117
ci_0069                 4.620418e-03 3 1  ON 118
ci_0070                 4.547074e-03 3 1  ON 119
ci_0071                 5.462774e-04 3 1  ON 120
ci_0072                -4.124400e-04 3 1  ON 121
ci_0073                 4.247444e-03 3 1  ON 122
ci_0074                 4.074952e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -16.9379
    reference variance = 0.234458
====================================================
  Execution time = 2.3818e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3487e-01
  Total weights = 1.9519e+06
  Execution time = 1.8617e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321233920959
                                         uncertainty =       0.002526876764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321233920959
                                         uncertainty =       0.002526876764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400734836
  error estimate for blocks of size 2^( 2) =       0.000413666442
  error estimate for blocks of size 2^( 3) =       0.000427185717
  error estimate for blocks of size 2^( 4) =       0.000439798437
  error estimate for blocks of size 2^( 5) =       0.000451580920
  error estimate for blocks of size 2^( 6) =       0.000460074463
  error estimate for blocks of size 2^( 7) =       0.000466596192

      target function =                  N/A
              le_mean =     -16.905518195956
             les_mean =     286.131416172273
             stat err =       0.000454512503
             autocorr =       1.286404275901
              std dev =       0.566724639358
             le_variance =       0.321176816855

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321233712452
                                         uncertainty =       0.002526883990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321233712452
                                         uncertainty =       0.002526883990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400734706
  error estimate for blocks of size 2^( 2) =       0.000413666317
  error estimate for blocks of size 2^( 3) =       0.000427185605
  error estimate for blocks of size 2^( 4) =       0.000439798329
  error estimate for blocks of size 2^( 5) =       0.000451580825
  error estimate for blocks of size 2^( 6) =       0.000460074380
  error estimate for blocks of size 2^( 7) =       0.000466596091

      target function =                  N/A
              le_mean =     -16.905518195898
             les_mean =     286.131416058945
             stat err =       0.000454512406
             autocorr =       1.286404562377
              std dev =       0.566724455834
             le_variance =       0.321176608841

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321233816670
                                         uncertainty =       0.002526880376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321233816670
                                         uncertainty =       0.002526880376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400734771
  error estimate for blocks of size 2^( 2) =       0.000413666380
  error estimate for blocks of size 2^( 3) =       0.000427185661
  error estimate for blocks of size 2^( 4) =       0.000439798383
  error estimate for blocks of size 2^( 5) =       0.000451580873
  error estimate for blocks of size 2^( 6) =       0.000460074422
  error estimate for blocks of size 2^( 7) =       0.000466596141

      target function =                  N/A
              le_mean =     -16.905518195926
             les_mean =     286.131416115353
             stat err =       0.000454512455
             autocorr =       1.286404419185
              std dev =       0.566724547565
             le_variance =       0.321176712813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321233907921
                                         uncertainty =       0.002526877215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321233907921
                                         uncertainty =       0.002526877215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400734827
  error estimate for blocks of size 2^( 2) =       0.000413666435
  error estimate for blocks of size 2^( 3) =       0.000427185710
  error estimate for blocks of size 2^( 4) =       0.000439798430
  error estimate for blocks of size 2^( 5) =       0.000451580914
  error estimate for blocks of size 2^( 6) =       0.000460074458
  error estimate for blocks of size 2^( 7) =       0.000466596185

      target function =                  N/A
              le_mean =     -16.905518195952
             les_mean =     286.131416165131
             stat err =       0.000454512497
             autocorr =       1.286404293807
              std dev =       0.566724627882
             le_variance =       0.321176803848


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905518195956        initial  <--
     8.4703e+02     8.4703e+03             3.9323e-07       -16.905518195898
     3.3881e+03     3.3881e+04             9.8330e-08       -16.905518195926
     1.3553e+04     1.3553e+05             2.4584e-08       -16.905518195952

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.3208
  </log>
  <optVariables href="H2O.s072.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453620e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920389e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985332e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410048e-01 1 1  ON 31
  eH1_2                -9.187709e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968281e-02 1 1  ON 39
  eH2_0                -2.461191e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956154e-02 1 1  ON 42
  eH2_3                -3.460409e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960728e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486811e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781589e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251858e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785214e-02 3 1  ON 58
ci_0010                -1.750382e-02 3 1  ON 59
ci_0011                -1.219755e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317848e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349987e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191323e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102482e-03 3 1  ON 70
ci_0022                -4.913918e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090652e-02 3 1  ON 73
ci_0025                -1.174357e-02 3 1  ON 74
ci_0026                -1.107541e-02 3 1  ON 75
ci_0027                -1.165978e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948723e-03 3 1  ON 78
ci_0030                -1.126669e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129427e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810552e-03 3 1  ON 83
ci_0035                 6.441563e-03 3 1  ON 84
ci_0036                 6.892875e-03 3 1  ON 85
ci_0037                -1.058261e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531927e-03 3 1  ON 88
ci_0040                -2.765601e-03 3 1  ON 89
ci_0041                 6.638168e-03 3 1  ON 90
ci_0042                 7.331246e-03 3 1  ON 91
ci_0043                -1.945850e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487135e-03 3 1  ON 94
ci_0046                 7.409373e-03 3 1  ON 95
ci_0047                -1.553778e-03 3 1  ON 96
ci_0048                -1.862448e-03 3 1  ON 97
ci_0049                -5.344929e-03 3 1  ON 98
ci_0050                -5.917971e-03 3 1  ON 99
ci_0051                -3.615050e-03 3 1  ON 100
ci_0052                -3.394664e-03 3 1  ON 101
ci_0053                -4.483617e-03 3 1  ON 102
ci_0054                -4.334923e-03 3 1  ON 103
ci_0055                 6.387861e-03 3 1  ON 104
ci_0056                 6.305068e-03 3 1  ON 105
ci_0057                 4.730769e-03 3 1  ON 106
ci_0058                 4.839668e-03 3 1  ON 107
ci_0059                -4.600634e-03 3 1  ON 108
ci_0060                -4.622900e-03 3 1  ON 109
ci_0061                -4.531646e-03 3 1  ON 110
ci_0062                -3.764922e-03 3 1  ON 111
ci_0063                -9.150462e-03 3 1  ON 112
ci_0064                -8.249810e-03 3 1  ON 113
ci_0065                -5.044308e-03 3 1  ON 114
ci_0066                -5.120013e-03 3 1  ON 115
ci_0067                -5.298557e-03 3 1  ON 116
ci_0068                -4.971038e-03 3 1  ON 117
ci_0069                 4.620464e-03 3 1  ON 118
ci_0070                 4.547043e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124761e-04 3 1  ON 121
ci_0073                 4.247467e-03 3 1  ON 122
ci_0074                 4.074943e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0976e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -16.9488
    reference variance = 0.23034
====================================================
  Execution time = 2.1146e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5238e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3317e-01
  Total weights = 1.951812268e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1806e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321399856787
                                         uncertainty =       0.002364156485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321399856787
                                         uncertainty =       0.002364156485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400912956
  error estimate for blocks of size 2^( 2) =       0.000413990089
  error estimate for blocks of size 2^( 3) =       0.000427106129
  error estimate for blocks of size 2^( 4) =       0.000439895067
  error estimate for blocks of size 2^( 5) =       0.000450999800
  error estimate for blocks of size 2^( 6) =       0.000457997896
  error estimate for blocks of size 2^( 7) =       0.000465117028

      target function =                  N/A
              le_mean =     -16.905950241942
             les_mean =     286.144324946855
             stat err =       0.000453502448
             autocorr =       1.279555383581
              std dev =       0.566976539831
             le_variance =       0.321462396719


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690595024194e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+03, overlap shift 8.4703e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905950241936       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905950242424       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905950242367       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905950242399       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905950242356       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905950242384       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905950242390       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905950242377       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905950242400       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905950242393       residual = 2.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.4703e+03 is 4.737781e-08

solving harmonic davidson linear method for identity shift 3.3881e+04, overlap shift 3.3881e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905950241936       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905950242058       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905950242044       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905950242052       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905950242049       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905950242049       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905950242035       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905950242044       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905950242185       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905950242012       residual = 2.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3881e+04 is 1.184468e-08

solving harmonic davidson linear method for identity shift 1.3553e+05, overlap shift 1.3553e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905950241936       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905950241967       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905950241963       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905950241965       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905950241939       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905950241946       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905950241991       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905950241985       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905950241751       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905950241572       residual = 2.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3553e+05 is 2.961185e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.602794 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7335e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453620e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920389e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985332e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410048e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968282e-02 1 1  ON 39
  eH2_0                -2.461191e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956154e-02 1 1  ON 42
  eH2_3                -3.460409e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960728e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486812e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781588e-02 3 1  ON 52
ci_0004                -2.749067e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251858e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785214e-02 3 1  ON 58
ci_0010                -1.750382e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317849e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349987e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191323e-02 3 1  ON 67
ci_0019                 1.136438e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102480e-03 3 1  ON 70
ci_0022                -4.913951e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090652e-02 3 1  ON 73
ci_0025                -1.174356e-02 3 1  ON 74
ci_0026                -1.107541e-02 3 1  ON 75
ci_0027                -1.165978e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948725e-03 3 1  ON 78
ci_0030                -1.126668e-02 3 1  ON 79
ci_0031                 2.036706e-02 3 1  ON 80
ci_0032                 2.129428e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810554e-03 3 1  ON 83
ci_0035                 6.441567e-03 3 1  ON 84
ci_0036                 6.892880e-03 3 1  ON 85
ci_0037                -1.058261e-02 3 1  ON 86
ci_0038                -1.118890e-02 3 1  ON 87
ci_0039                -2.531933e-03 3 1  ON 88
ci_0040                -2.765600e-03 3 1  ON 89
ci_0041                 6.638166e-03 3 1  ON 90
ci_0042                 7.331238e-03 3 1  ON 91
ci_0043                -1.945850e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487141e-03 3 1  ON 94
ci_0046                 7.409376e-03 3 1  ON 95
ci_0047                -1.553782e-03 3 1  ON 96
ci_0048                -1.862443e-03 3 1  ON 97
ci_0049                -5.344941e-03 3 1  ON 98
ci_0050                -5.917972e-03 3 1  ON 99
ci_0051                -3.615052e-03 3 1  ON 100
ci_0052                -3.394664e-03 3 1  ON 101
ci_0053                -4.483618e-03 3 1  ON 102
ci_0054                -4.334926e-03 3 1  ON 103
ci_0055                 6.387857e-03 3 1  ON 104
ci_0056                 6.305065e-03 3 1  ON 105
ci_0057                 4.730768e-03 3 1  ON 106
ci_0058                 4.839669e-03 3 1  ON 107
ci_0059                -4.600635e-03 3 1  ON 108
ci_0060                -4.622892e-03 3 1  ON 109
ci_0061                -4.531642e-03 3 1  ON 110
ci_0062                -3.764924e-03 3 1  ON 111
ci_0063                -9.150463e-03 3 1  ON 112
ci_0064                -8.249811e-03 3 1  ON 113
ci_0065                -5.044308e-03 3 1  ON 114
ci_0066                -5.120018e-03 3 1  ON 115
ci_0067                -5.298555e-03 3 1  ON 116
ci_0068                -4.971048e-03 3 1  ON 117
ci_0069                 4.620458e-03 3 1  ON 118
ci_0070                 4.547042e-03 3 1  ON 119
ci_0071                 5.462919e-04 3 1  ON 120
ci_0072                -4.124715e-04 3 1  ON 121
ci_0073                 4.247466e-03 3 1  ON 122
ci_0074                 4.074945e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -16.8267
    reference variance = 0.289493
====================================================
  Execution time = 2.1174e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3404e-01
  Total weights = 1.9515e+06
  Execution time = 1.8651e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320587958878
                                         uncertainty =       0.002143491470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320587958878
                                         uncertainty =       0.002143491470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400340821
  error estimate for blocks of size 2^( 2) =       0.000413111022
  error estimate for blocks of size 2^( 3) =       0.000426595573
  error estimate for blocks of size 2^( 4) =       0.000439404517
  error estimate for blocks of size 2^( 5) =       0.000450856155
  error estimate for blocks of size 2^( 6) =       0.000459307058
  error estimate for blocks of size 2^( 7) =       0.000464362518

      target function =                  N/A
              le_mean =     -16.906413490359
             les_mean =     286.160860381286
             stat err =       0.000453482562
             autocorr =       1.283102738163
              std dev =       0.566167418798
             le_variance =       0.320545546109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320587963194
                                         uncertainty =       0.002143491929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320587963194
                                         uncertainty =       0.002143491929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400340824
  error estimate for blocks of size 2^( 2) =       0.000413111023
  error estimate for blocks of size 2^( 3) =       0.000426595574
  error estimate for blocks of size 2^( 4) =       0.000439404518
  error estimate for blocks of size 2^( 5) =       0.000450856155
  error estimate for blocks of size 2^( 6) =       0.000459307056
  error estimate for blocks of size 2^( 7) =       0.000464362516

      target function =                  N/A
              le_mean =     -16.906413490075
             les_mean =     286.160860401484
             stat err =       0.000453482561
             autocorr =       1.283102716785
              std dev =       0.566167422574
             le_variance =       0.320545550384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320587961036
                                         uncertainty =       0.002143491699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320587961036
                                         uncertainty =       0.002143491699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400340822
  error estimate for blocks of size 2^( 2) =       0.000413111022
  error estimate for blocks of size 2^( 3) =       0.000426595573
  error estimate for blocks of size 2^( 4) =       0.000439404517
  error estimate for blocks of size 2^( 5) =       0.000450856155
  error estimate for blocks of size 2^( 6) =       0.000459307057
  error estimate for blocks of size 2^( 7) =       0.000464362517

      target function =                  N/A
              le_mean =     -16.906413490217
             les_mean =     286.160860391378
             stat err =       0.000453482562
             autocorr =       1.283102727479
              std dev =       0.566167420686
             le_variance =       0.320545548246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320587959148
                                         uncertainty =       0.002143491498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320587959148
                                         uncertainty =       0.002143491498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400340821
  error estimate for blocks of size 2^( 2) =       0.000413111022
  error estimate for blocks of size 2^( 3) =       0.000426595573
  error estimate for blocks of size 2^( 4) =       0.000439404517
  error estimate for blocks of size 2^( 5) =       0.000450856155
  error estimate for blocks of size 2^( 6) =       0.000459307057
  error estimate for blocks of size 2^( 7) =       0.000464362518

      target function =                  N/A
              le_mean =     -16.906413490341
             les_mean =     286.160860382547
             stat err =       0.000453482562
             autocorr =       1.283102736832
              std dev =       0.566167419034
             le_variance =       0.320545546376


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906413490359        initial  <--
     8.4703e+03     8.4703e+04             4.7378e-08       -16.906413490075
     3.3881e+04     3.3881e+05             1.1845e-08       -16.906413490217
     1.3553e+05     1.3553e+06             2.9612e-09       -16.906413490341

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7948
  </log>
  <optVariables href="H2O.s073.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453620e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920389e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985332e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410048e-01 1 1  ON 31
  eH1_2                -9.187709e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968281e-02 1 1  ON 39
  eH2_0                -2.461191e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956154e-02 1 1  ON 42
  eH2_3                -3.460409e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960728e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486811e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781589e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251858e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785214e-02 3 1  ON 58
ci_0010                -1.750382e-02 3 1  ON 59
ci_0011                -1.219755e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317848e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349987e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191323e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102482e-03 3 1  ON 70
ci_0022                -4.913918e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090652e-02 3 1  ON 73
ci_0025                -1.174357e-02 3 1  ON 74
ci_0026                -1.107541e-02 3 1  ON 75
ci_0027                -1.165978e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948723e-03 3 1  ON 78
ci_0030                -1.126669e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129427e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810552e-03 3 1  ON 83
ci_0035                 6.441563e-03 3 1  ON 84
ci_0036                 6.892875e-03 3 1  ON 85
ci_0037                -1.058261e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531927e-03 3 1  ON 88
ci_0040                -2.765601e-03 3 1  ON 89
ci_0041                 6.638168e-03 3 1  ON 90
ci_0042                 7.331246e-03 3 1  ON 91
ci_0043                -1.945850e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487135e-03 3 1  ON 94
ci_0046                 7.409373e-03 3 1  ON 95
ci_0047                -1.553778e-03 3 1  ON 96
ci_0048                -1.862448e-03 3 1  ON 97
ci_0049                -5.344929e-03 3 1  ON 98
ci_0050                -5.917971e-03 3 1  ON 99
ci_0051                -3.615050e-03 3 1  ON 100
ci_0052                -3.394664e-03 3 1  ON 101
ci_0053                -4.483617e-03 3 1  ON 102
ci_0054                -4.334923e-03 3 1  ON 103
ci_0055                 6.387861e-03 3 1  ON 104
ci_0056                 6.305068e-03 3 1  ON 105
ci_0057                 4.730769e-03 3 1  ON 106
ci_0058                 4.839668e-03 3 1  ON 107
ci_0059                -4.600634e-03 3 1  ON 108
ci_0060                -4.622900e-03 3 1  ON 109
ci_0061                -4.531646e-03 3 1  ON 110
ci_0062                -3.764922e-03 3 1  ON 111
ci_0063                -9.150462e-03 3 1  ON 112
ci_0064                -8.249810e-03 3 1  ON 113
ci_0065                -5.044308e-03 3 1  ON 114
ci_0066                -5.120013e-03 3 1  ON 115
ci_0067                -5.298557e-03 3 1  ON 116
ci_0068                -4.971038e-03 3 1  ON 117
ci_0069                 4.620464e-03 3 1  ON 118
ci_0070                 4.547043e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124761e-04 3 1  ON 121
ci_0073                 4.247467e-03 3 1  ON 122
ci_0074                 4.074943e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8136e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -16.8047
    reference variance = 0.220499
====================================================
  Execution time = 2.1521e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3691e-01
  Total weights = 1.951484521e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0892e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325132106432
                                         uncertainty =       0.001999525158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325132106432
                                         uncertainty =       0.001999525158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403114765
  error estimate for blocks of size 2^( 2) =       0.000415926121
  error estimate for blocks of size 2^( 3) =       0.000429284825
  error estimate for blocks of size 2^( 4) =       0.000441314678
  error estimate for blocks of size 2^( 5) =       0.000450238657
  error estimate for blocks of size 2^( 6) =       0.000455605260
  error estimate for blocks of size 2^( 7) =       0.000458234367

      target function =                  N/A
              le_mean =     -16.906305558833
             les_mean =     286.160076814767
             stat err =       0.000451348240
             autocorr =       1.253620529674
              std dev =       0.570090368479
             le_variance =       0.325003028233


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690630555883e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+04, overlap shift 8.4703e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906305558824       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906305558934       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906305558937       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906305558944       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906305558947       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906305558908       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906305558941       residual = 8.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906305558999       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906305559194       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906305559294       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.4703e+04 is 4.981346e-09

solving harmonic davidson linear method for identity shift 3.3881e+05, overlap shift 3.3881e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906305558824       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906305558852       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906305558852       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906305558854       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906305558858       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906305558822       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906305558956       residual = 8.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906305558852       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906305558853       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906305559195       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3881e+05 is 1.245339e-09

solving harmonic davidson linear method for identity shift 1.3553e+06, overlap shift 1.3553e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906305558824       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906305558831       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906305558831       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906305558820       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906305560074       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906305559336       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906305558195       residual = 8.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906305558829       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906305558543       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906305559265       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3553e+06 is 3.113348e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.606681 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7618e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453620e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920389e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985332e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410048e-01 1 1  ON 31
  eH1_2                -9.187709e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968281e-02 1 1  ON 39
  eH2_0                -2.461191e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956154e-02 1 1  ON 42
  eH2_3                -3.460409e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960728e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486811e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781589e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251858e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785214e-02 3 1  ON 58
ci_0010                -1.750382e-02 3 1  ON 59
ci_0011                -1.219755e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317848e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349987e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191323e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102482e-03 3 1  ON 70
ci_0022                -4.913920e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090652e-02 3 1  ON 73
ci_0025                -1.174357e-02 3 1  ON 74
ci_0026                -1.107541e-02 3 1  ON 75
ci_0027                -1.165978e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126669e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129427e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810552e-03 3 1  ON 83
ci_0035                 6.441563e-03 3 1  ON 84
ci_0036                 6.892874e-03 3 1  ON 85
ci_0037                -1.058261e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531927e-03 3 1  ON 88
ci_0040                -2.765600e-03 3 1  ON 89
ci_0041                 6.638169e-03 3 1  ON 90
ci_0042                 7.331246e-03 3 1  ON 91
ci_0043                -1.945850e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487135e-03 3 1  ON 94
ci_0046                 7.409372e-03 3 1  ON 95
ci_0047                -1.553778e-03 3 1  ON 96
ci_0048                -1.862448e-03 3 1  ON 97
ci_0049                -5.344930e-03 3 1  ON 98
ci_0050                -5.917971e-03 3 1  ON 99
ci_0051                -3.615050e-03 3 1  ON 100
ci_0052                -3.394664e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334924e-03 3 1  ON 103
ci_0055                 6.387861e-03 3 1  ON 104
ci_0056                 6.305069e-03 3 1  ON 105
ci_0057                 4.730769e-03 3 1  ON 106
ci_0058                 4.839668e-03 3 1  ON 107
ci_0059                -4.600634e-03 3 1  ON 108
ci_0060                -4.622900e-03 3 1  ON 109
ci_0061                -4.531645e-03 3 1  ON 110
ci_0062                -3.764922e-03 3 1  ON 111
ci_0063                -9.150462e-03 3 1  ON 112
ci_0064                -8.249810e-03 3 1  ON 113
ci_0065                -5.044308e-03 3 1  ON 114
ci_0066                -5.120013e-03 3 1  ON 115
ci_0067                -5.298557e-03 3 1  ON 116
ci_0068                -4.971038e-03 3 1  ON 117
ci_0069                 4.620464e-03 3 1  ON 118
ci_0070                 4.547043e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124755e-04 3 1  ON 121
ci_0073                 4.247466e-03 3 1  ON 122
ci_0074                 4.074943e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -16.8806
    reference variance = 0.204171
====================================================
  Execution time = 2.1351e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4296e-01
  Total weights = 1.9513e+06
  Execution time = 1.8685e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322172488084
                                         uncertainty =       0.001655902340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322172488084
                                         uncertainty =       0.001655902340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401348895
  error estimate for blocks of size 2^( 2) =       0.000413910071
  error estimate for blocks of size 2^( 3) =       0.000427048967
  error estimate for blocks of size 2^( 4) =       0.000439130706
  error estimate for blocks of size 2^( 5) =       0.000448761398
  error estimate for blocks of size 2^( 6) =       0.000454246945
  error estimate for blocks of size 2^( 7) =       0.000459181980

      target function =                  N/A
              le_mean =     -16.906533159306
             les_mean =     286.173821465950
             stat err =       0.000450330257
             autocorr =       1.258977912540
              std dev =       0.567593051080
             le_variance =       0.322161871634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322172490259
                                         uncertainty =       0.001655902318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322172490259
                                         uncertainty =       0.001655902318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401348897
  error estimate for blocks of size 2^( 2) =       0.000413910072
  error estimate for blocks of size 2^( 3) =       0.000427048968
  error estimate for blocks of size 2^( 4) =       0.000439130707
  error estimate for blocks of size 2^( 5) =       0.000448761399
  error estimate for blocks of size 2^( 6) =       0.000454246946
  error estimate for blocks of size 2^( 7) =       0.000459181981

      target function =                  N/A
              le_mean =     -16.906533159385
             les_mean =     286.173821401044
             stat err =       0.000450330258
             autocorr =       1.258977911448
              std dev =       0.567593052971
             le_variance =       0.322161873781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322172489172
                                         uncertainty =       0.001655902329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322172489172
                                         uncertainty =       0.001655902329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401348896
  error estimate for blocks of size 2^( 2) =       0.000413910072
  error estimate for blocks of size 2^( 3) =       0.000427048968
  error estimate for blocks of size 2^( 4) =       0.000439130706
  error estimate for blocks of size 2^( 5) =       0.000448761398
  error estimate for blocks of size 2^( 6) =       0.000454246945
  error estimate for blocks of size 2^( 7) =       0.000459181981

      target function =                  N/A
              le_mean =     -16.906533159346
             les_mean =     286.173821433393
             stat err =       0.000450330258
             autocorr =       1.258977911990
              std dev =       0.567593052025
             le_variance =       0.322161872707

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322172488220
                                         uncertainty =       0.001655902339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322172488220
                                         uncertainty =       0.001655902339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401348895
  error estimate for blocks of size 2^( 2) =       0.000413910071
  error estimate for blocks of size 2^( 3) =       0.000427048967
  error estimate for blocks of size 2^( 4) =       0.000439130706
  error estimate for blocks of size 2^( 5) =       0.000448761398
  error estimate for blocks of size 2^( 6) =       0.000454246945
  error estimate for blocks of size 2^( 7) =       0.000459181980

      target function =                  N/A
              le_mean =     -16.906533159311
             les_mean =     286.173821461869
             stat err =       0.000450330257
             autocorr =       1.258977912465
              std dev =       0.567593051198
             le_variance =       0.322161871768


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906533159306        initial
     8.4703e+04     8.4703e+05             4.9813e-09       -16.906533159385  <--
     3.3881e+05     3.3881e+06             1.2453e-09       -16.906533159346
     1.3553e+06     1.3553e+07             3.1133e-10       -16.906533159311

*****************************************************************************
Applying the update for shift_i =   8.4703e+04     and shift_s =   8.4703e+05
*****************************************************************************

  Execution time = 3.0867e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453620e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920389e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985332e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410048e-01 1 1  ON 31
  eH1_2                -9.187709e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968282e-02 1 1  ON 39
  eH2_0                -2.461191e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956154e-02 1 1  ON 42
  eH2_3                -3.460409e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486812e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781589e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666455e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251858e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785214e-02 3 1  ON 58
ci_0010                -1.750382e-02 3 1  ON 59
ci_0011                -1.219755e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317848e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349987e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191323e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102481e-03 3 1  ON 70
ci_0022                -4.913927e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090652e-02 3 1  ON 73
ci_0025                -1.174357e-02 3 1  ON 74
ci_0026                -1.107541e-02 3 1  ON 75
ci_0027                -1.165978e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948727e-03 3 1  ON 78
ci_0030                -1.126668e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129427e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810553e-03 3 1  ON 83
ci_0035                 6.441565e-03 3 1  ON 84
ci_0036                 6.892874e-03 3 1  ON 85
ci_0037                -1.058261e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531928e-03 3 1  ON 88
ci_0040                -2.765598e-03 3 1  ON 89
ci_0041                 6.638171e-03 3 1  ON 90
ci_0042                 7.331246e-03 3 1  ON 91
ci_0043                -1.945850e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487135e-03 3 1  ON 94
ci_0046                 7.409370e-03 3 1  ON 95
ci_0047                -1.553780e-03 3 1  ON 96
ci_0048                -1.862447e-03 3 1  ON 97
ci_0049                -5.344934e-03 3 1  ON 98
ci_0050                -5.917970e-03 3 1  ON 99
ci_0051                -3.615050e-03 3 1  ON 100
ci_0052                -3.394664e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334928e-03 3 1  ON 103
ci_0055                 6.387859e-03 3 1  ON 104
ci_0056                 6.305070e-03 3 1  ON 105
ci_0057                 4.730770e-03 3 1  ON 106
ci_0058                 4.839669e-03 3 1  ON 107
ci_0059                -4.600634e-03 3 1  ON 108
ci_0060                -4.622902e-03 3 1  ON 109
ci_0061                -4.531644e-03 3 1  ON 110
ci_0062                -3.764921e-03 3 1  ON 111
ci_0063                -9.150460e-03 3 1  ON 112
ci_0064                -8.249811e-03 3 1  ON 113
ci_0065                -5.044309e-03 3 1  ON 114
ci_0066                -5.120013e-03 3 1  ON 115
ci_0067                -5.298555e-03 3 1  ON 116
ci_0068                -4.971037e-03 3 1  ON 117
ci_0069                 4.620463e-03 3 1  ON 118
ci_0070                 4.547041e-03 3 1  ON 119
ci_0071                 5.462914e-04 3 1  ON 120
ci_0072                -4.124737e-04 3 1  ON 121
ci_0073                 4.247466e-03 3 1  ON 122
ci_0074                 4.074943e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8492e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -16.9172
    reference variance = 0.230444
====================================================
  Execution time = 2.1434e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3890e-01
  Total weights = 1.951763658e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1017e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324637801080
                                         uncertainty =       0.002777206108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324637801080
                                         uncertainty =       0.002777206108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402862447
  error estimate for blocks of size 2^( 2) =       0.000415848201
  error estimate for blocks of size 2^( 3) =       0.000429606139
  error estimate for blocks of size 2^( 4) =       0.000442638850
  error estimate for blocks of size 2^( 5) =       0.000454995536
  error estimate for blocks of size 2^( 6) =       0.000464351573
  error estimate for blocks of size 2^( 7) =       0.000470974045

      target function =                  N/A
              le_mean =     -16.905829435150
             les_mean =     286.145973326185
             stat err =       0.000458240001
             autocorr =       1.293815718168
              std dev =       0.569733535665
             le_variance =       0.324596301662


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690582943515e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e+04, overlap shift 2.1176e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905829435147       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905829435330       residual = 7.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905829435283       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905829435319       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905829435322       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905829435358       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905829435338       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905829435346       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905829435260       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905829435286       residual = 2.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.1176e+04 is 1.904642e-08

solving harmonic davidson linear method for identity shift 8.4703e+04, overlap shift 8.4703e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905829435147       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905829435193       residual = 7.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905829435181       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905829435190       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905829435209       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905829435152       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905829435232       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905829435368       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905829435276       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905829435392       residual = 2.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.4703e+04 is 4.761618e-09

solving harmonic davidson linear method for identity shift 3.3881e+05, overlap shift 3.3881e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905829435147       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905829435159       residual = 7.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905829435156       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905829435158       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905829435160       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905829435212       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905829435169       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905829435154       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905829435696       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905829435123       residual = 2.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3881e+05 is 1.190405e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.610603 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7543e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453620e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920389e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985332e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410048e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968282e-02 1 1  ON 39
  eH2_0                -2.461191e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956154e-02 1 1  ON 42
  eH2_3                -3.460409e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486812e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781589e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251858e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785213e-02 3 1  ON 58
ci_0010                -1.750381e-02 3 1  ON 59
ci_0011                -1.219755e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317848e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349987e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191323e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102482e-03 3 1  ON 70
ci_0022                -4.913933e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090652e-02 3 1  ON 73
ci_0025                -1.174356e-02 3 1  ON 74
ci_0026                -1.107541e-02 3 1  ON 75
ci_0027                -1.165978e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948727e-03 3 1  ON 78
ci_0030                -1.126668e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129427e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810557e-03 3 1  ON 83
ci_0035                 6.441567e-03 3 1  ON 84
ci_0036                 6.892873e-03 3 1  ON 85
ci_0037                -1.058261e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531932e-03 3 1  ON 88
ci_0040                -2.765597e-03 3 1  ON 89
ci_0041                 6.638174e-03 3 1  ON 90
ci_0042                 7.331246e-03 3 1  ON 91
ci_0043                -1.945850e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487137e-03 3 1  ON 94
ci_0046                 7.409370e-03 3 1  ON 95
ci_0047                -1.553778e-03 3 1  ON 96
ci_0048                -1.862449e-03 3 1  ON 97
ci_0049                -5.344932e-03 3 1  ON 98
ci_0050                -5.917969e-03 3 1  ON 99
ci_0051                -3.615054e-03 3 1  ON 100
ci_0052                -3.394663e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334928e-03 3 1  ON 103
ci_0055                 6.387858e-03 3 1  ON 104
ci_0056                 6.305070e-03 3 1  ON 105
ci_0057                 4.730770e-03 3 1  ON 106
ci_0058                 4.839670e-03 3 1  ON 107
ci_0059                -4.600636e-03 3 1  ON 108
ci_0060                -4.622903e-03 3 1  ON 109
ci_0061                -4.531643e-03 3 1  ON 110
ci_0062                -3.764919e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249811e-03 3 1  ON 113
ci_0065                -5.044310e-03 3 1  ON 114
ci_0066                -5.120009e-03 3 1  ON 115
ci_0067                -5.298553e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620464e-03 3 1  ON 118
ci_0070                 4.547041e-03 3 1  ON 119
ci_0071                 5.462908e-04 3 1  ON 120
ci_0072                -4.124733e-04 3 1  ON 121
ci_0073                 4.247465e-03 3 1  ON 122
ci_0074                 4.074945e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -16.9216
    reference variance = 0.192012
====================================================
  Execution time = 2.1251e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3622e-01
  Total weights = 1.9518e+06
  Execution time = 1.8596e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323286857880
                                         uncertainty =       0.002090898620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323286857880
                                         uncertainty =       0.002090898620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402019655
  error estimate for blocks of size 2^( 2) =       0.000415414254
  error estimate for blocks of size 2^( 3) =       0.000428685455
  error estimate for blocks of size 2^( 4) =       0.000440466362
  error estimate for blocks of size 2^( 5) =       0.000449328345
  error estimate for blocks of size 2^( 6) =       0.000458053085
  error estimate for blocks of size 2^( 7) =       0.000460861580

      target function =                  N/A
              le_mean =     -16.906218526226
             les_mean =     286.156447109967
             stat err =       0.000452177343
             autocorr =       1.265094658835
              std dev =       0.568541648319
             le_variance =       0.323239605873

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323286860821
                                         uncertainty =       0.002090898861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323286860821
                                         uncertainty =       0.002090898861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402019657
  error estimate for blocks of size 2^( 2) =       0.000415414256
  error estimate for blocks of size 2^( 3) =       0.000428685457
  error estimate for blocks of size 2^( 4) =       0.000440466363
  error estimate for blocks of size 2^( 5) =       0.000449328346
  error estimate for blocks of size 2^( 6) =       0.000458053087
  error estimate for blocks of size 2^( 7) =       0.000460861582

      target function =                  N/A
              le_mean =     -16.906218526531
             les_mean =     286.156447064444
             stat err =       0.000452177345
             autocorr =       1.265094656460
              std dev =       0.568541650931
             le_variance =       0.323239608844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323286859351
                                         uncertainty =       0.002090898740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323286859351
                                         uncertainty =       0.002090898740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402019656
  error estimate for blocks of size 2^( 2) =       0.000415414255
  error estimate for blocks of size 2^( 3) =       0.000428685456
  error estimate for blocks of size 2^( 4) =       0.000440466362
  error estimate for blocks of size 2^( 5) =       0.000449328346
  error estimate for blocks of size 2^( 6) =       0.000458053086
  error estimate for blocks of size 2^( 7) =       0.000460861581

      target function =                  N/A
              le_mean =     -16.906218526379
             les_mean =     286.156447086784
             stat err =       0.000452177344
             autocorr =       1.265094657646
              std dev =       0.568541649625
             le_variance =       0.323239607359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323286858064
                                         uncertainty =       0.002090898635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323286858064
                                         uncertainty =       0.002090898635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402019655
  error estimate for blocks of size 2^( 2) =       0.000415414254
  error estimate for blocks of size 2^( 3) =       0.000428685455
  error estimate for blocks of size 2^( 4) =       0.000440466362
  error estimate for blocks of size 2^( 5) =       0.000449328345
  error estimate for blocks of size 2^( 6) =       0.000458053086
  error estimate for blocks of size 2^( 7) =       0.000460861580

      target function =                  N/A
              le_mean =     -16.906218526245
             les_mean =     286.156447107022
             stat err =       0.000452177343
             autocorr =       1.265094658682
              std dev =       0.568541648482
             le_variance =       0.323239606059


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906218526226        initial
     2.1176e+04     2.1176e+05             1.9046e-08       -16.906218526531  <--
     8.4703e+04     8.4703e+05             4.7616e-09       -16.906218526379
     3.3881e+05     3.3881e+06             1.1904e-09       -16.906218526245

*****************************************************************************
Applying the update for shift_i =   2.1176e+04     and shift_s =   2.1176e+05
*****************************************************************************

  Execution time = 3.0712e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453620e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781588e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251856e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785213e-02 3 1  ON 58
ci_0010                -1.750381e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102484e-03 3 1  ON 70
ci_0022                -4.913953e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174356e-02 3 1  ON 74
ci_0026                -1.107540e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948726e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129427e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441573e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531943e-03 3 1  ON 88
ci_0040                -2.765596e-03 3 1  ON 89
ci_0041                 6.638180e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487141e-03 3 1  ON 94
ci_0046                 7.409370e-03 3 1  ON 95
ci_0047                -1.553772e-03 3 1  ON 96
ci_0048                -1.862453e-03 3 1  ON 97
ci_0049                -5.344925e-03 3 1  ON 98
ci_0050                -5.917966e-03 3 1  ON 99
ci_0051                -3.615065e-03 3 1  ON 100
ci_0052                -3.394660e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334928e-03 3 1  ON 103
ci_0055                 6.387855e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730772e-03 3 1  ON 106
ci_0058                 4.839673e-03 3 1  ON 107
ci_0059                -4.600644e-03 3 1  ON 108
ci_0060                -4.622907e-03 3 1  ON 109
ci_0061                -4.531640e-03 3 1  ON 110
ci_0062                -3.764912e-03 3 1  ON 111
ci_0063                -9.150455e-03 3 1  ON 112
ci_0064                -8.249810e-03 3 1  ON 113
ci_0065                -5.044312e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298548e-03 3 1  ON 116
ci_0068                -4.971034e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547041e-03 3 1  ON 119
ci_0071                 5.462890e-04 3 1  ON 120
ci_0072                -4.124722e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074951e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8261e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -16.9615
    reference variance = 0.210615
====================================================
  Execution time = 2.1183e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3128e-01
  Total weights = 1.952015551e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0262e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320118510367
                                         uncertainty =       0.002307555356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320118510367
                                         uncertainty =       0.002307555356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400091221
  error estimate for blocks of size 2^( 2) =       0.000412813466
  error estimate for blocks of size 2^( 3) =       0.000425513284
  error estimate for blocks of size 2^( 4) =       0.000436689475
  error estimate for blocks of size 2^( 5) =       0.000446140541
  error estimate for blocks of size 2^( 6) =       0.000454927292
  error estimate for blocks of size 2^( 7) =       0.000456990426

      target function =                  N/A
              le_mean =     -16.906688783998
             les_mean =     286.167409564552
             stat err =       0.000448686933
             autocorr =       1.257676077784
              std dev =       0.565814431086
             le_variance =       0.320145970425


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690668878400e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.2940e+03, overlap shift 5.2940e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906688783992       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906688785201       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906688785015       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906688785059       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906688785132       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906688785170       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906688785152       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906688785153       residual = 5.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906688785147       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906688785168       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.2940e+03 is 6.049184e-08

solving harmonic davidson linear method for identity shift 2.1176e+04, overlap shift 2.1176e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906688783992       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906688784294       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906688784248       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906688784263       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906688784277       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906688784284       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906688784283       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906688784267       residual = 5.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906688784263       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906688784228       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.1176e+04 is 1.512342e-08

solving harmonic davidson linear method for identity shift 8.4703e+04, overlap shift 8.4703e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906688783992       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906688784067       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906688784056       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906688784058       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906688784063       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906688784066       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906688784088       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906688784072       residual = 5.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906688784037       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906688783980       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.4703e+04 is 3.780884e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.614511 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7218e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385814e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960726e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486814e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781588e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666455e-02 3 1  ON 54
ci_0006                -3.710018e-02 3 1  ON 55
ci_0007                -2.251856e-02 3 1  ON 56
ci_0008                -2.154055e-02 3 1  ON 57
ci_0009                -1.785213e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362497e-02 3 1  ON 64
ci_0016                 1.349987e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191321e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154276e-02 3 1  ON 69
ci_0021                -2.102484e-03 3 1  ON 70
ci_0022                -4.913999e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090650e-02 3 1  ON 73
ci_0025                -1.174354e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948738e-03 3 1  ON 78
ci_0030                -1.126666e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035379e-02 3 1  ON 82
ci_0034                 9.810574e-03 3 1  ON 83
ci_0035                 6.441576e-03 3 1  ON 84
ci_0036                 6.892865e-03 3 1  ON 85
ci_0037                -1.058261e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531944e-03 3 1  ON 88
ci_0040                -2.765591e-03 3 1  ON 89
ci_0041                 6.638185e-03 3 1  ON 90
ci_0042                 7.331246e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898994e-02 3 1  ON 93
ci_0045                 7.487139e-03 3 1  ON 94
ci_0046                 7.409377e-03 3 1  ON 95
ci_0047                -1.553784e-03 3 1  ON 96
ci_0048                -1.862455e-03 3 1  ON 97
ci_0049                -5.344933e-03 3 1  ON 98
ci_0050                -5.917961e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394665e-03 3 1  ON 101
ci_0053                -4.483619e-03 3 1  ON 102
ci_0054                -4.334930e-03 3 1  ON 103
ci_0055                 6.387850e-03 3 1  ON 104
ci_0056                 6.305074e-03 3 1  ON 105
ci_0057                 4.730779e-03 3 1  ON 106
ci_0058                 4.839666e-03 3 1  ON 107
ci_0059                -4.600644e-03 3 1  ON 108
ci_0060                -4.622909e-03 3 1  ON 109
ci_0061                -4.531634e-03 3 1  ON 110
ci_0062                -3.764914e-03 3 1  ON 111
ci_0063                -9.150458e-03 3 1  ON 112
ci_0064                -8.249824e-03 3 1  ON 113
ci_0065                -5.044317e-03 3 1  ON 114
ci_0066                -5.120002e-03 3 1  ON 115
ci_0067                -5.298551e-03 3 1  ON 116
ci_0068                -4.971028e-03 3 1  ON 117
ci_0069                 4.620459e-03 3 1  ON 118
ci_0070                 4.547035e-03 3 1  ON 119
ci_0071                 5.462927e-04 3 1  ON 120
ci_0072                -4.124607e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074958e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.0284
    reference variance = 0.38413
====================================================
  Execution time = 2.1248e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3882e-01
  Total weights = 1.9517e+06
  Execution time = 1.8768e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326729199389
                                         uncertainty =       0.003418104779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326729199389
                                         uncertainty =       0.003418104779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404151875
  error estimate for blocks of size 2^( 2) =       0.000416807046
  error estimate for blocks of size 2^( 3) =       0.000429890122
  error estimate for blocks of size 2^( 4) =       0.000441385861
  error estimate for blocks of size 2^( 5) =       0.000450571011
  error estimate for blocks of size 2^( 6) =       0.000457543612
  error estimate for blocks of size 2^( 7) =       0.000464705294

      target function =                  N/A
              le_mean =     -16.906266927581
             les_mean =     286.160684328062
             stat err =       0.000453551445
             autocorr =       1.259400651775
              std dev =       0.571557062525
             le_variance =       0.326677475722

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326729165648
                                         uncertainty =       0.003418106190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326729165648
                                         uncertainty =       0.003418106190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404151854
  error estimate for blocks of size 2^( 2) =       0.000416807024
  error estimate for blocks of size 2^( 3) =       0.000429890101
  error estimate for blocks of size 2^( 4) =       0.000441385838
  error estimate for blocks of size 2^( 5) =       0.000450570991
  error estimate for blocks of size 2^( 6) =       0.000457543592
  error estimate for blocks of size 2^( 7) =       0.000464705275

      target function =                  N/A
              le_mean =     -16.906266927453
             les_mean =     286.160684328148
             stat err =       0.000453551424
             autocorr =       1.259400667740
              std dev =       0.571557033025
             le_variance =       0.326677442000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326729182518
                                         uncertainty =       0.003418105484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326729182518
                                         uncertainty =       0.003418105484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404151864
  error estimate for blocks of size 2^( 2) =       0.000416807035
  error estimate for blocks of size 2^( 3) =       0.000429890112
  error estimate for blocks of size 2^( 4) =       0.000441385850
  error estimate for blocks of size 2^( 5) =       0.000450571001
  error estimate for blocks of size 2^( 6) =       0.000457543602
  error estimate for blocks of size 2^( 7) =       0.000464705285

      target function =                  N/A
              le_mean =     -16.906266927517
             les_mean =     286.160684328092
             stat err =       0.000453551434
             autocorr =       1.259400659755
              std dev =       0.571557047775
             le_variance =       0.326677458861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326729197280
                                         uncertainty =       0.003418104867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326729197280
                                         uncertainty =       0.003418104867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404151873
  error estimate for blocks of size 2^( 2) =       0.000416807044
  error estimate for blocks of size 2^( 3) =       0.000429890121
  error estimate for blocks of size 2^( 4) =       0.000441385859
  error estimate for blocks of size 2^( 5) =       0.000450571009
  error estimate for blocks of size 2^( 6) =       0.000457543611
  error estimate for blocks of size 2^( 7) =       0.000464705293

      target function =                  N/A
              le_mean =     -16.906266927573
             les_mean =     286.160684328065
             stat err =       0.000453551443
             autocorr =       1.259400652772
              std dev =       0.571557060681
             le_variance =       0.326677473615


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906266927581        initial  <--
     5.2940e+03     5.2940e+04             6.0492e-08       -16.906266927453
     2.1176e+04     2.1176e+05             1.5123e-08       -16.906266927517
     8.4703e+04     8.4703e+05             3.7809e-09       -16.906266927573

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8078
  </log>
  <optVariables href="H2O.s076.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453620e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781588e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251856e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785213e-02 3 1  ON 58
ci_0010                -1.750381e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102484e-03 3 1  ON 70
ci_0022                -4.913953e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174356e-02 3 1  ON 74
ci_0026                -1.107540e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948726e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129427e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441573e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531943e-03 3 1  ON 88
ci_0040                -2.765596e-03 3 1  ON 89
ci_0041                 6.638180e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487141e-03 3 1  ON 94
ci_0046                 7.409370e-03 3 1  ON 95
ci_0047                -1.553772e-03 3 1  ON 96
ci_0048                -1.862453e-03 3 1  ON 97
ci_0049                -5.344925e-03 3 1  ON 98
ci_0050                -5.917966e-03 3 1  ON 99
ci_0051                -3.615065e-03 3 1  ON 100
ci_0052                -3.394660e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334928e-03 3 1  ON 103
ci_0055                 6.387855e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730772e-03 3 1  ON 106
ci_0058                 4.839673e-03 3 1  ON 107
ci_0059                -4.600644e-03 3 1  ON 108
ci_0060                -4.622907e-03 3 1  ON 109
ci_0061                -4.531640e-03 3 1  ON 110
ci_0062                -3.764912e-03 3 1  ON 111
ci_0063                -9.150455e-03 3 1  ON 112
ci_0064                -8.249810e-03 3 1  ON 113
ci_0065                -5.044312e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298548e-03 3 1  ON 116
ci_0068                -4.971034e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547041e-03 3 1  ON 119
ci_0071                 5.462890e-04 3 1  ON 120
ci_0072                -4.124722e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074951e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8031e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -16.8814
    reference variance = 0.181507
====================================================
  Execution time = 2.1168e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3526e-01
  Total weights = 1.951382974e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1806e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322975186762
                                         uncertainty =       0.002337533917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322975186762
                                         uncertainty =       0.002337533917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401890269
  error estimate for blocks of size 2^( 2) =       0.000414637732
  error estimate for blocks of size 2^( 3) =       0.000428412866
  error estimate for blocks of size 2^( 4) =       0.000441099008
  error estimate for blocks of size 2^( 5) =       0.000450937882
  error estimate for blocks of size 2^( 6) =       0.000460050228
  error estimate for blocks of size 2^( 7) =       0.000465657290

      target function =                  N/A
              le_mean =     -16.905340753725
             les_mean =     286.125808565195
             stat err =       0.000454436102
             autocorr =       1.278588138809
              std dev =       0.568358668443
             le_variance =       0.323031575995


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690534075372e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.2940e+04, overlap shift 5.2940e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905340753681       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905340753717       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905340753735       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905340753737       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905340753699       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905340753750       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905340753694       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905340753663       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905340753654       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905340753651       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.2940e+04 is 6.255187e-09

solving harmonic davidson linear method for identity shift 2.1176e+05, overlap shift 2.1176e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905340753681       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905340753690       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905340753695       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905340753659       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905340753668       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905340753656       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905340753622       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905340753719       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905340753680       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905340753712       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.1176e+05 is 1.563802e-09

solving harmonic davidson linear method for identity shift 8.4703e+05, overlap shift 8.4703e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905340753681       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905340753683       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905340753685       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905340753684       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905340753584       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905340754112       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905340753947       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905340753473       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905340753481       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905340754278       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.4703e+05 is 3.909506e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.618410 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7357e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453620e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251856e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785213e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102484e-03 3 1  ON 70
ci_0022                -4.913959e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107540e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948725e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129427e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441573e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531943e-03 3 1  ON 88
ci_0040                -2.765596e-03 3 1  ON 89
ci_0041                 6.638181e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487141e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553772e-03 3 1  ON 96
ci_0048                -1.862453e-03 3 1  ON 97
ci_0049                -5.344926e-03 3 1  ON 98
ci_0050                -5.917966e-03 3 1  ON 99
ci_0051                -3.615064e-03 3 1  ON 100
ci_0052                -3.394660e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334929e-03 3 1  ON 103
ci_0055                 6.387854e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730772e-03 3 1  ON 106
ci_0058                 4.839674e-03 3 1  ON 107
ci_0059                -4.600645e-03 3 1  ON 108
ci_0060                -4.622908e-03 3 1  ON 109
ci_0061                -4.531639e-03 3 1  ON 110
ci_0062                -3.764912e-03 3 1  ON 111
ci_0063                -9.150456e-03 3 1  ON 112
ci_0064                -8.249810e-03 3 1  ON 113
ci_0065                -5.044313e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298548e-03 3 1  ON 116
ci_0068                -4.971035e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547041e-03 3 1  ON 119
ci_0071                 5.462896e-04 3 1  ON 120
ci_0072                -4.124721e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074951e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -16.8726
    reference variance = 0.215251
====================================================
  Execution time = 2.1228e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3681e-01
  Total weights = 1.9519e+06
  Execution time = 1.8558e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323219397428
                                         uncertainty =       0.002599114722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323219397428
                                         uncertainty =       0.002599114722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401976595
  error estimate for blocks of size 2^( 2) =       0.000414891587
  error estimate for blocks of size 2^( 3) =       0.000428190916
  error estimate for blocks of size 2^( 4) =       0.000440194248
  error estimate for blocks of size 2^( 5) =       0.000451379067
  error estimate for blocks of size 2^( 6) =       0.000458870217
  error estimate for blocks of size 2^( 7) =       0.000464464446

      target function =                  N/A
              le_mean =     -16.905368426460
             les_mean =     286.128295404051
             stat err =       0.000453726995
             autocorr =       1.274053611813
              std dev =       0.568480751897
             le_variance =       0.323170365277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323219400656
                                         uncertainty =       0.002599114911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323219400656
                                         uncertainty =       0.002599114911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401976597
  error estimate for blocks of size 2^( 2) =       0.000414891589
  error estimate for blocks of size 2^( 3) =       0.000428190917
  error estimate for blocks of size 2^( 4) =       0.000440194250
  error estimate for blocks of size 2^( 5) =       0.000451379069
  error estimate for blocks of size 2^( 6) =       0.000458870219
  error estimate for blocks of size 2^( 7) =       0.000464464447

      target function =                  N/A
              le_mean =     -16.905368426522
             les_mean =     286.128295417958
             stat err =       0.000453726996
             autocorr =       1.274053608163
              std dev =       0.568480754734
             le_variance =       0.323170368503

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323219399042
                                         uncertainty =       0.002599114816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323219399042
                                         uncertainty =       0.002599114816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401976596
  error estimate for blocks of size 2^( 2) =       0.000414891588
  error estimate for blocks of size 2^( 3) =       0.000428190916
  error estimate for blocks of size 2^( 4) =       0.000440194249
  error estimate for blocks of size 2^( 5) =       0.000451379068
  error estimate for blocks of size 2^( 6) =       0.000458870218
  error estimate for blocks of size 2^( 7) =       0.000464464447

      target function =                  N/A
              le_mean =     -16.905368426491
             les_mean =     286.128295411004
             stat err =       0.000453726995
             autocorr =       1.274053609984
              std dev =       0.568480753315
             le_variance =       0.323170366890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323219397629
                                         uncertainty =       0.002599114734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323219397629
                                         uncertainty =       0.002599114734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401976595
  error estimate for blocks of size 2^( 2) =       0.000414891587
  error estimate for blocks of size 2^( 3) =       0.000428190916
  error estimate for blocks of size 2^( 4) =       0.000440194248
  error estimate for blocks of size 2^( 5) =       0.000451379067
  error estimate for blocks of size 2^( 6) =       0.000458870217
  error estimate for blocks of size 2^( 7) =       0.000464464446

      target function =                  N/A
              le_mean =     -16.905368426464
             les_mean =     286.128295404920
             stat err =       0.000453726995
             autocorr =       1.274053611596
              std dev =       0.568480752074
             le_variance =       0.323170365478


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905368426460        initial
     5.2940e+04     5.2940e+05             6.2552e-09       -16.905368426522  <--
     2.1176e+05     2.1176e+06             1.5638e-09       -16.905368426491
     8.4703e+05     8.4703e+06             3.9095e-10       -16.905368426464

*****************************************************************************
Applying the update for shift_i =   5.2940e+04     and shift_s =   5.2940e+05
*****************************************************************************

  Execution time = 3.4364e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913976e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948723e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862452e-03 3 1  ON 97
ci_0049                -5.344928e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394660e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730772e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462914e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.1727e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -16.8815
    reference variance = 0.260148
====================================================
  Execution time = 2.1401e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3496e-01
  Total weights = 1.951722769e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0387e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322169295370
                                         uncertainty =       0.003964329833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322169295370
                                         uncertainty =       0.003964329833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401352299
  error estimate for blocks of size 2^( 2) =       0.000414223285
  error estimate for blocks of size 2^( 3) =       0.000427222726
  error estimate for blocks of size 2^( 4) =       0.000439219870
  error estimate for blocks of size 2^( 5) =       0.000448713650
  error estimate for blocks of size 2^( 6) =       0.000456024682
  error estimate for blocks of size 2^( 7) =       0.000462070514

      target function =                  N/A
              le_mean =     -16.906294266146
             les_mean =     286.157749872605
             stat err =       0.000451507179
             autocorr =       1.265545631853
              std dev =       0.567597865045
             le_variance =       0.322167336404


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690629426615e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3235e+04, overlap shift 1.3235e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906294266156       residual = 7.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906294266336       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906294266547       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906294266605       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906294266679       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906294266695       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906294266693       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906294266674       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906294266618       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906294266638       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906294266655       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3235e+04 is 3.497973e-08

solving harmonic davidson linear method for identity shift 5.2940e+04, overlap shift 5.2940e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906294266156       residual = 7.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906294266201       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906294266254       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906294266267       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906294266248       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906294266278       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906294266261       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906294266256       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906294266362       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906294266156       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906294266337       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.2940e+04 is 8.745049e-09

solving harmonic davidson linear method for identity shift 2.1176e+05, overlap shift 2.1176e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906294266156       residual = 7.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906294266167       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906294266181       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906294266164       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906294266257       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906294266091       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906294266199       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906294266025       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906294266219       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906294265700       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906294266368       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.1176e+05 is 2.186270e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.622914 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7448e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932997e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385814e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486814e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749065e-02 3 1  ON 53
ci_0005                -3.666455e-02 3 1  ON 54
ci_0006                -3.710018e-02 3 1  ON 55
ci_0007                -2.251856e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750381e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234249e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349987e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191321e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154276e-02 3 1  ON 69
ci_0021                -2.102487e-03 3 1  ON 70
ci_0022                -4.913972e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165976e-02 3 1  ON 76
ci_0028                -1.082995e-02 3 1  ON 77
ci_0029                -9.948727e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129427e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810572e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892868e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118888e-02 3 1  ON 87
ci_0039                -2.531947e-03 3 1  ON 88
ci_0040                -2.765593e-03 3 1  ON 89
ci_0041                 6.638186e-03 3 1  ON 90
ci_0042                 7.331239e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487141e-03 3 1  ON 94
ci_0046                 7.409368e-03 3 1  ON 95
ci_0047                -1.553776e-03 3 1  ON 96
ci_0048                -1.862456e-03 3 1  ON 97
ci_0049                -5.344931e-03 3 1  ON 98
ci_0050                -5.917966e-03 3 1  ON 99
ci_0051                -3.615062e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334933e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305076e-03 3 1  ON 105
ci_0057                 4.730765e-03 3 1  ON 106
ci_0058                 4.839683e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622908e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150451e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.120004e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971032e-03 3 1  ON 117
ci_0069                 4.620466e-03 3 1  ON 118
ci_0070                 4.547042e-03 3 1  ON 119
ci_0071                 5.462928e-04 3 1  ON 120
ci_0072                -4.124684e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074960e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -16.875
    reference variance = 0.300674
====================================================
  Execution time = 2.1213e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3605e-01
  Total weights = 1.9518e+06
  Execution time = 1.8627e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322761344847
                                         uncertainty =       0.002509747976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322761344847
                                         uncertainty =       0.002509747976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401689177
  error estimate for blocks of size 2^( 2) =       0.000414338117
  error estimate for blocks of size 2^( 3) =       0.000427259334
  error estimate for blocks of size 2^( 4) =       0.000439729619
  error estimate for blocks of size 2^( 5) =       0.000450893098
  error estimate for blocks of size 2^( 6) =       0.000459297931
  error estimate for blocks of size 2^( 7) =       0.000464024282

      target function =                  N/A
              le_mean =     -16.905260168230
             les_mean =     286.123872808619
             stat err =       0.000453486232
             autocorr =       1.274523807165
              std dev =       0.568074282299
             le_variance =       0.322708390210

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322761338904
                                         uncertainty =       0.002509748255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322761338904
                                         uncertainty =       0.002509748255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401689174
  error estimate for blocks of size 2^( 2) =       0.000414338113
  error estimate for blocks of size 2^( 3) =       0.000427259330
  error estimate for blocks of size 2^( 4) =       0.000439729616
  error estimate for blocks of size 2^( 5) =       0.000450893094
  error estimate for blocks of size 2^( 6) =       0.000459297927
  error estimate for blocks of size 2^( 7) =       0.000464024278

      target function =                  N/A
              le_mean =     -16.905260168188
             les_mean =     286.123872681496
             stat err =       0.000453486229
             autocorr =       1.274523809752
              std dev =       0.568074277049
             le_variance =       0.322708384245

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322761341875
                                         uncertainty =       0.002509748115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322761341875
                                         uncertainty =       0.002509748115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401689175
  error estimate for blocks of size 2^( 2) =       0.000414338115
  error estimate for blocks of size 2^( 3) =       0.000427259332
  error estimate for blocks of size 2^( 4) =       0.000439729618
  error estimate for blocks of size 2^( 5) =       0.000450893096
  error estimate for blocks of size 2^( 6) =       0.000459297929
  error estimate for blocks of size 2^( 7) =       0.000464024280

      target function =                  N/A
              le_mean =     -16.905260168209
             les_mean =     286.123872744972
             stat err =       0.000453486231
             autocorr =       1.274523808459
              std dev =       0.568074279674
             le_variance =       0.322708387227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322761344475
                                         uncertainty =       0.002509747993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322761344475
                                         uncertainty =       0.002509747993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401689177
  error estimate for blocks of size 2^( 2) =       0.000414338117
  error estimate for blocks of size 2^( 3) =       0.000427259334
  error estimate for blocks of size 2^( 4) =       0.000439729619
  error estimate for blocks of size 2^( 5) =       0.000450893097
  error estimate for blocks of size 2^( 6) =       0.000459297931
  error estimate for blocks of size 2^( 7) =       0.000464024281

      target function =                  N/A
              le_mean =     -16.905260168228
             les_mean =     286.123872800654
             stat err =       0.000453486232
             autocorr =       1.274523807330
              std dev =       0.568074281971
             le_variance =       0.322708389837


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905260168230        initial  <--
     1.3235e+04     1.3235e+05             3.4980e-08       -16.905260168188
     5.2940e+04     5.2940e+05             8.7450e-09       -16.905260168209
     2.1176e+05     2.1176e+06             2.1863e-09       -16.905260168228

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7313
  </log>
  <optVariables href="H2O.s078.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913976e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948723e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862452e-03 3 1  ON 97
ci_0049                -5.344928e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394660e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730772e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462914e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8186e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -16.8526
    reference variance = 0.236709
====================================================
  Execution time = 2.1205e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5236e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3129e-01
  Total weights = 1.951605172e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0934e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319528165730
                                         uncertainty =       0.001964179455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319528165730
                                         uncertainty =       0.001964179455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399667525
  error estimate for blocks of size 2^( 2) =       0.000412493747
  error estimate for blocks of size 2^( 3) =       0.000425519792
  error estimate for blocks of size 2^( 4) =       0.000437815886
  error estimate for blocks of size 2^( 5) =       0.000448370813
  error estimate for blocks of size 2^( 6) =       0.000455028945
  error estimate for blocks of size 2^( 7) =       0.000460968807

      target function =                  N/A
              le_mean =     -16.905809874817
             les_mean =     286.137701488843
             stat err =       0.000450546113
             autocorr =       1.270810433970
              std dev =       0.565215234236
             le_variance =       0.319468261013


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690580987482e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3235e+05, overlap shift 1.3235e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905809874833       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905809874871       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905809874861       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905809874879       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905809874863       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905809876247       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905809874880       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905809874819       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905809874392       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905809875294       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3235e+05 is 2.131677e-09

solving harmonic davidson linear method for identity shift 5.2940e+05, overlap shift 5.2940e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905809874833       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905809874843       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905809874840       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905809874841       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905809874826       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905809874842       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905809874847       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905809875270       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905809874691       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905809875722       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.2940e+05 is 5.329195e-10

solving harmonic davidson linear method for identity shift 2.1176e+06, overlap shift 2.1176e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905809874833       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905809874836       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905809874835       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905809874835       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905809874976       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905809877000       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905809877655       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905809870268       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905809871769       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905809863630       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.1176e+06 is 1.332300e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.626805 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7306e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349987e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913976e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129427e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810567e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862452e-03 3 1  ON 97
ci_0049                -5.344928e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730772e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150458e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462914e-04 3 1  ON 120
ci_0072                -4.124715e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -16.8939
    reference variance = 0.527578
====================================================
  Execution time = 2.1176e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3740e-01
  Total weights = 1.9516e+06
  Execution time = 1.8598e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323782619191
                                         uncertainty =       0.002604043976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323782619191
                                         uncertainty =       0.002604043976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402368419
  error estimate for blocks of size 2^( 2) =       0.000415404635
  error estimate for blocks of size 2^( 3) =       0.000428559432
  error estimate for blocks of size 2^( 4) =       0.000441068990
  error estimate for blocks of size 2^( 5) =       0.000451784869
  error estimate for blocks of size 2^( 6) =       0.000458977755
  error estimate for blocks of size 2^( 7) =       0.000462383256

      target function =                  N/A
              le_mean =     -16.906295290535
             les_mean =     286.160216623956
             stat err =       0.000453553717
             autocorr =       1.270602447487
              std dev =       0.569034875925
             le_variance =       0.323800690019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323782619945
                                         uncertainty =       0.002604043893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323782619945
                                         uncertainty =       0.002604043893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402368420
  error estimate for blocks of size 2^( 2) =       0.000415404636
  error estimate for blocks of size 2^( 3) =       0.000428559433
  error estimate for blocks of size 2^( 4) =       0.000441068990
  error estimate for blocks of size 2^( 5) =       0.000451784869
  error estimate for blocks of size 2^( 6) =       0.000458977756
  error estimate for blocks of size 2^( 7) =       0.000462383256

      target function =                  N/A
              le_mean =     -16.906295290510
             les_mean =     286.160216621831
             stat err =       0.000453553718
             autocorr =       1.270602445957
              std dev =       0.569034876589
             le_variance =       0.323800690774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323782619568
                                         uncertainty =       0.002604043935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323782619568
                                         uncertainty =       0.002604043935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402368420
  error estimate for blocks of size 2^( 2) =       0.000415404636
  error estimate for blocks of size 2^( 3) =       0.000428559432
  error estimate for blocks of size 2^( 4) =       0.000441068990
  error estimate for blocks of size 2^( 5) =       0.000451784869
  error estimate for blocks of size 2^( 6) =       0.000458977756
  error estimate for blocks of size 2^( 7) =       0.000462383256

      target function =                  N/A
              le_mean =     -16.906295290523
             les_mean =     286.160216622894
             stat err =       0.000453553718
             autocorr =       1.270602446724
              std dev =       0.569034876257
             le_variance =       0.323800690397

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323782619238
                                         uncertainty =       0.002604043971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323782619238
                                         uncertainty =       0.002604043971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402368420
  error estimate for blocks of size 2^( 2) =       0.000415404635
  error estimate for blocks of size 2^( 3) =       0.000428559432
  error estimate for blocks of size 2^( 4) =       0.000441068990
  error estimate for blocks of size 2^( 5) =       0.000451784869
  error estimate for blocks of size 2^( 6) =       0.000458977755
  error estimate for blocks of size 2^( 7) =       0.000462383256

      target function =                  N/A
              le_mean =     -16.906295290533
             les_mean =     286.160216623823
             stat err =       0.000453553717
             autocorr =       1.270602447393
              std dev =       0.569034875967
             le_variance =       0.323800690066


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906295290535        initial  <--
     1.3235e+05     1.3235e+06             2.1317e-09       -16.906295290510
     5.2940e+05     5.2940e+06             5.3292e-10       -16.906295290523
     2.1176e+06     2.1176e+07             1.3323e-10       -16.906295290533

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7192
  </log>
  <optVariables href="H2O.s079.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913976e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948723e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862452e-03 3 1  ON 97
ci_0049                -5.344928e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394660e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730772e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462914e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8031e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -16.9733
    reference variance = 0.516176
====================================================
  Execution time = 2.1340e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3686e-01
  Total weights = 1.951711954e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0215e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324013572392
                                         uncertainty =       0.002243941663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324013572392
                                         uncertainty =       0.002243941663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402499828
  error estimate for blocks of size 2^( 2) =       0.000415864915
  error estimate for blocks of size 2^( 3) =       0.000429295667
  error estimate for blocks of size 2^( 4) =       0.000442311102
  error estimate for blocks of size 2^( 5) =       0.000454554047
  error estimate for blocks of size 2^( 6) =       0.000464409965
  error estimate for blocks of size 2^( 7) =       0.000469636044

      target function =                  N/A
              le_mean =     -16.905886837845
             les_mean =     286.145865542799
             stat err =       0.000457727789
             autocorr =       1.293252008776
              std dev =       0.569220715683
             le_variance =       0.324012223163


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690588683784e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3235e+06, overlap shift 1.3235e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905886837817       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905886837820       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905886837820       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905886837725       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905886837820       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905886838339       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905886837160       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905886838125       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905886837355       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905886836658       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3235e+06 is 3.069684e-10

solving harmonic davidson linear method for identity shift 5.2940e+06, overlap shift 5.2940e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905886837817       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905886837818       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905886837818       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905886839890       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905886837818       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905886838674       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905886833332       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905886830536       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905886839363       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905886845417       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.2940e+06 is 7.674217e-11

solving harmonic davidson linear method for identity shift 2.1176e+07, overlap shift 2.1176e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905886837817       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905886837817       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905886837817       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905886839290       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905886837817       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905886835087       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905886833594       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905886839746       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905886807033       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905886808580       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.1176e+07 is 1.918549e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.630751 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7369e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948723e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862452e-03 3 1  ON 97
ci_0049                -5.344928e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394660e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462914e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -16.956
    reference variance = 0.261349
====================================================
  Execution time = 2.1290e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3102e-01
  Total weights = 1.9518e+06
  Execution time = 1.8639e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319293426356
                                         uncertainty =       0.001811234242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319293426356
                                         uncertainty =       0.001811234242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399566909
  error estimate for blocks of size 2^( 2) =       0.000412162065
  error estimate for blocks of size 2^( 3) =       0.000424901698
  error estimate for blocks of size 2^( 4) =       0.000437453114
  error estimate for blocks of size 2^( 5) =       0.000447366534
  error estimate for blocks of size 2^( 6) =       0.000454140113
  error estimate for blocks of size 2^( 7) =       0.000458791458

      target function =                  N/A
              le_mean =     -16.906487024418
             les_mean =     286.160319655699
             stat err =       0.000449437804
             autocorr =       1.265202879820
              std dev =       0.565072942258
             le_variance =       0.319307430072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319293426335
                                         uncertainty =       0.001811234241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319293426335
                                         uncertainty =       0.001811234241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399566909
  error estimate for blocks of size 2^( 2) =       0.000412162065
  error estimate for blocks of size 2^( 3) =       0.000424901698
  error estimate for blocks of size 2^( 4) =       0.000437453114
  error estimate for blocks of size 2^( 5) =       0.000447366534
  error estimate for blocks of size 2^( 6) =       0.000454140113
  error estimate for blocks of size 2^( 7) =       0.000458791458

      target function =                  N/A
              le_mean =     -16.906487024419
             les_mean =     286.160319655380
             stat err =       0.000449437804
             autocorr =       1.265202879984
              std dev =       0.565072942239
             le_variance =       0.319307430051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319293426345
                                         uncertainty =       0.001811234241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319293426345
                                         uncertainty =       0.001811234241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399566909
  error estimate for blocks of size 2^( 2) =       0.000412162065
  error estimate for blocks of size 2^( 3) =       0.000424901698
  error estimate for blocks of size 2^( 4) =       0.000437453114
  error estimate for blocks of size 2^( 5) =       0.000447366534
  error estimate for blocks of size 2^( 6) =       0.000454140113
  error estimate for blocks of size 2^( 7) =       0.000458791458

      target function =                  N/A
              le_mean =     -16.906487024419
             les_mean =     286.160319655539
             stat err =       0.000449437804
             autocorr =       1.265202879895
              std dev =       0.565072942249
             le_variance =       0.319307430061

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319293426354
                                         uncertainty =       0.001811234242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319293426354
                                         uncertainty =       0.001811234242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399566909
  error estimate for blocks of size 2^( 2) =       0.000412162065
  error estimate for blocks of size 2^( 3) =       0.000424901698
  error estimate for blocks of size 2^( 4) =       0.000437453114
  error estimate for blocks of size 2^( 5) =       0.000447366534
  error estimate for blocks of size 2^( 6) =       0.000454140113
  error estimate for blocks of size 2^( 7) =       0.000458791458

      target function =                  N/A
              le_mean =     -16.906487024418
             les_mean =     286.160319655679
             stat err =       0.000449437804
             autocorr =       1.265202879828
              std dev =       0.565072942257
             le_variance =       0.319307430070


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906487024418        initial
     1.3235e+06     1.3235e+07             3.0697e-10       -16.906487024419  <--
     5.2940e+06     5.2940e+07             7.6742e-11       -16.906487024419
     2.1176e+07     2.1176e+08             1.9185e-11       -16.906487024418

*****************************************************************************
Applying the update for shift_i =   1.3235e+06     and shift_s =   1.3235e+07
*****************************************************************************

  Execution time = 3.0804e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8179e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -16.9731
    reference variance = 0.342828
====================================================
  Execution time = 2.1564e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3856e-01
  Total weights = 1.951601303e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1430e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324192093962
                                         uncertainty =       0.002424286151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324192093962
                                         uncertainty =       0.002424286151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402601352
  error estimate for blocks of size 2^( 2) =       0.000414920682
  error estimate for blocks of size 2^( 3) =       0.000427556945
  error estimate for blocks of size 2^( 4) =       0.000438952420
  error estimate for blocks of size 2^( 5) =       0.000449001594
  error estimate for blocks of size 2^( 6) =       0.000456569032
  error estimate for blocks of size 2^( 7) =       0.000460476736

      target function =                  N/A
              le_mean =     -16.906501412942
             les_mean =     286.168346966412
             stat err =       0.000451249946
             autocorr =       1.256272543655
              std dev =       0.569364291705
             le_variance =       0.324175696669


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690650141294e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3087e+05, overlap shift 3.3087e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906501412954       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906501412964       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906501412965       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906501412966       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906501413000       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906501412910       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906501412988       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906501412730       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906501412956       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906501413503       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3087e+05 is 1.284096e-09

solving harmonic davidson linear method for identity shift 1.3235e+06, overlap shift 1.3235e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906501412954       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906501412956       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906501412957       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906501413159       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906501413352       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906501415316       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906501411802       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906501412371       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906501413065       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906501411469       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3235e+06 is 3.210242e-10

solving harmonic davidson linear method for identity shift 5.2940e+06, overlap shift 5.2940e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906501412954       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906501412955       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906501412955       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906501413066       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906501407143       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906501413180       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906501406582       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906501413829       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906501412397       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906501422747       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.2940e+06 is 8.025607e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.634637 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7715e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349987e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102485e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150458e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462916e-04 3 1  ON 120
ci_0072                -4.124718e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -16.8832
    reference variance = 0.241507
====================================================
  Execution time = 2.1120e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3863e-01
  Total weights = 1.9519e+06
  Execution time = 1.8558e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322496169863
                                         uncertainty =       0.001983624585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322496169863
                                         uncertainty =       0.001983624585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401557624
  error estimate for blocks of size 2^( 2) =       0.000414590378
  error estimate for blocks of size 2^( 3) =       0.000428388569
  error estimate for blocks of size 2^( 4) =       0.000441007351
  error estimate for blocks of size 2^( 5) =       0.000452752214
  error estimate for blocks of size 2^( 6) =       0.000462483213
  error estimate for blocks of size 2^( 7) =       0.000469511024

      target function =                  N/A
              le_mean =     -16.905829142880
             les_mean =     286.145693647046
             stat err =       0.000456438450
             autocorr =       1.292018383146
              std dev =       0.567888237857
             le_variance =       0.322497050696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322496169486
                                         uncertainty =       0.001983624590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322496169486
                                         uncertainty =       0.001983624590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401557624
  error estimate for blocks of size 2^( 2) =       0.000414590377
  error estimate for blocks of size 2^( 3) =       0.000428388569
  error estimate for blocks of size 2^( 4) =       0.000441007351
  error estimate for blocks of size 2^( 5) =       0.000452752214
  error estimate for blocks of size 2^( 6) =       0.000462483213
  error estimate for blocks of size 2^( 7) =       0.000469511023

      target function =                  N/A
              le_mean =     -16.905829142876
             les_mean =     286.145693638139
             stat err =       0.000456438450
             autocorr =       1.292018383198
              std dev =       0.567888237525
             le_variance =       0.322497050319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322496169674
                                         uncertainty =       0.001983624587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322496169674
                                         uncertainty =       0.001983624587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401557624
  error estimate for blocks of size 2^( 2) =       0.000414590378
  error estimate for blocks of size 2^( 3) =       0.000428388569
  error estimate for blocks of size 2^( 4) =       0.000441007351
  error estimate for blocks of size 2^( 5) =       0.000452752214
  error estimate for blocks of size 2^( 6) =       0.000462483213
  error estimate for blocks of size 2^( 7) =       0.000469511023

      target function =                  N/A
              le_mean =     -16.905829142878
             les_mean =     286.145693642591
             stat err =       0.000456438450
             autocorr =       1.292018383178
              std dev =       0.567888237691
             le_variance =       0.322497050508

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322496169839
                                         uncertainty =       0.001983624585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322496169839
                                         uncertainty =       0.001983624585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401557624
  error estimate for blocks of size 2^( 2) =       0.000414590378
  error estimate for blocks of size 2^( 3) =       0.000428388569
  error estimate for blocks of size 2^( 4) =       0.000441007351
  error estimate for blocks of size 2^( 5) =       0.000452752214
  error estimate for blocks of size 2^( 6) =       0.000462483213
  error estimate for blocks of size 2^( 7) =       0.000469511024

      target function =                  N/A
              le_mean =     -16.905829142880
             les_mean =     286.145693646489
             stat err =       0.000456438450
             autocorr =       1.292018383153
              std dev =       0.567888237836
             le_variance =       0.322497050673


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905829142880        initial  <--
     3.3087e+05     3.3087e+06             1.2841e-09       -16.905829142876
     1.3235e+06     1.3235e+07             3.2102e-10       -16.905829142878
     5.2940e+06     5.2940e+07             8.0256e-11       -16.905829142880

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6323
  </log>
  <optVariables href="H2O.s081.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8353e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.0645
    reference variance = 0.551236
====================================================
  Execution time = 2.1239e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3680e-01
  Total weights = 1.951707755e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0521e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323833457791
                                         uncertainty =       0.002188823427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323833457791
                                         uncertainty =       0.002188823427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402414235
  error estimate for blocks of size 2^( 2) =       0.000415917667
  error estimate for blocks of size 2^( 3) =       0.000430026483
  error estimate for blocks of size 2^( 4) =       0.000442804892
  error estimate for blocks of size 2^( 5) =       0.000453872956
  error estimate for blocks of size 2^( 6) =       0.000464278653
  error estimate for blocks of size 2^( 7) =       0.000470764296

      target function =                  N/A
              le_mean =     -16.905987697215
             les_mean =     286.149218344546
             stat err =       0.000457930199
             autocorr =       1.294946720934
              std dev =       0.569099668480
             le_variance =       0.323874432664


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690598769722e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3087e+06, overlap shift 3.3087e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905987697191       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905987697191       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905987697191       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905987697123       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905987699413       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905987667153       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905987695784       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905987699605       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905987691824       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905987706033       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3087e+06 is 1.348685e-10

solving harmonic davidson linear method for identity shift 1.3235e+07, overlap shift 1.3235e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905987697191       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905987697191       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905987697191       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905987698377       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905987696704       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905987690706       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905987682925       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905987695466       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905987696681       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905987693155       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3235e+07 is 3.371710e-11

solving harmonic davidson linear method for identity shift 5.2940e+07, overlap shift 5.2940e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905987697191       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905987697191       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905987697191       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905987700961       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905987704337       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905987684853       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905987698241       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905987642172       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905987730412       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905987703324       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.2940e+07 is 8.429276e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.638584 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7300e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344928e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150458e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124719e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -16.9688
    reference variance = 0.227216
====================================================
  Execution time = 2.1212e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3847e-01
  Total weights = 1.9515e+06
  Execution time = 1.8667e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325589201148
                                         uncertainty =       0.002485170953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325589201148
                                         uncertainty =       0.002485170953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403447630
  error estimate for blocks of size 2^( 2) =       0.000415859205
  error estimate for blocks of size 2^( 3) =       0.000428633452
  error estimate for blocks of size 2^( 4) =       0.000441064365
  error estimate for blocks of size 2^( 5) =       0.000451752258
  error estimate for blocks of size 2^( 6) =       0.000459025558
  error estimate for blocks of size 2^( 7) =       0.000464515178

      target function =                  N/A
              le_mean =     -16.906391019781
             les_mean =     286.164524444780
             stat err =       0.000454089340
             autocorr =       1.266800645228
              std dev =       0.570561109641
             le_variance =       0.325539979834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325589201132
                                         uncertainty =       0.002485170946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325589201132
                                         uncertainty =       0.002485170946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403447630
  error estimate for blocks of size 2^( 2) =       0.000415859205
  error estimate for blocks of size 2^( 3) =       0.000428633452
  error estimate for blocks of size 2^( 4) =       0.000441064365
  error estimate for blocks of size 2^( 5) =       0.000451752258
  error estimate for blocks of size 2^( 6) =       0.000459025558
  error estimate for blocks of size 2^( 7) =       0.000464515178

      target function =                  N/A
              le_mean =     -16.906391019780
             les_mean =     286.164524444739
             stat err =       0.000454089339
             autocorr =       1.266800645200
              std dev =       0.570561109627
             le_variance =       0.325539979819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325589201140
                                         uncertainty =       0.002485170950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325589201140
                                         uncertainty =       0.002485170950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403447630
  error estimate for blocks of size 2^( 2) =       0.000415859205
  error estimate for blocks of size 2^( 3) =       0.000428633452
  error estimate for blocks of size 2^( 4) =       0.000441064365
  error estimate for blocks of size 2^( 5) =       0.000451752258
  error estimate for blocks of size 2^( 6) =       0.000459025558
  error estimate for blocks of size 2^( 7) =       0.000464515178

      target function =                  N/A
              le_mean =     -16.906391019780
             les_mean =     286.164524444760
             stat err =       0.000454089339
             autocorr =       1.266800645220
              std dev =       0.570561109634
             le_variance =       0.325539979827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325589201147
                                         uncertainty =       0.002485170953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325589201147
                                         uncertainty =       0.002485170953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403447630
  error estimate for blocks of size 2^( 2) =       0.000415859205
  error estimate for blocks of size 2^( 3) =       0.000428633452
  error estimate for blocks of size 2^( 4) =       0.000441064365
  error estimate for blocks of size 2^( 5) =       0.000451752258
  error estimate for blocks of size 2^( 6) =       0.000459025558
  error estimate for blocks of size 2^( 7) =       0.000464515178

      target function =                  N/A
              le_mean =     -16.906391019781
             les_mean =     286.164524444777
             stat err =       0.000454089340
             autocorr =       1.266800645221
              std dev =       0.570561109640
             le_variance =       0.325539979834


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906391019781        initial  <--
     3.3087e+06     3.3087e+07             1.3487e-10       -16.906391019780
     1.3235e+07     1.3235e+08             3.3717e-11       -16.906391019780
     5.2940e+07     5.2940e+08             8.4293e-12       -16.906391019781

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 34.2945
  </log>
  <optVariables href="H2O.s082.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.1600e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -16.9649
    reference variance = 0.293308
====================================================
  Execution time = 2.1414e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5233e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4251e-01
  Total weights = 1.951543844e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0610e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327012992245
                                         uncertainty =       0.002497234067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327012992245
                                         uncertainty =       0.002497234067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404404089
  error estimate for blocks of size 2^( 2) =       0.000417442704
  error estimate for blocks of size 2^( 3) =       0.000430413273
  error estimate for blocks of size 2^( 4) =       0.000443157037
  error estimate for blocks of size 2^( 5) =       0.000454938838
  error estimate for blocks of size 2^( 6) =       0.000463865443
  error estimate for blocks of size 2^( 7) =       0.000467727941

      target function =                  N/A
              le_mean =     -16.906245944318
             les_mean =     286.163661182389
             stat err =       0.000457422315
             autocorr =       1.279391966471
              std dev =       0.571913746653
             le_variance =       0.327085333611


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690624594432e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3087e+07, overlap shift 3.3087e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906245944322       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906245944322       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906245944322       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906245944322       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906245940620       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906245934466       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906245965412       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906245962298       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906245959061       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906245936487       residual = 6.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3087e+07 is 1.299268e-11

solving harmonic davidson linear method for identity shift 1.3235e+08, overlap shift 1.3235e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906245944322       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906245944322       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906245944322       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906245888341       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906245944322       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906245914502       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906245877164       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906245838198       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906246077235       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906246023456       residual = 6.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3235e+08 is 3.248135e-12

solving harmonic davidson linear method for identity shift 5.2940e+08, overlap shift 5.2940e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906245944322       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906245944322       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906245944322       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906245984838       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906245944322       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906246077628       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906246344849       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906246021352       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906245843488       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906246323528       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.2940e+08 is 8.120326e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.642425 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7483e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -16.913
    reference variance = 0.316416
====================================================
  Execution time = 2.0995e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3947e-01
  Total weights = 1.9518e+06
  Execution time = 1.8659e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326463204668
                                         uncertainty =       0.003242930032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326463204668
                                         uncertainty =       0.003242930032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403987719
  error estimate for blocks of size 2^( 2) =       0.000417220715
  error estimate for blocks of size 2^( 3) =       0.000431678872
  error estimate for blocks of size 2^( 4) =       0.000444423147
  error estimate for blocks of size 2^( 5) =       0.000456519644
  error estimate for blocks of size 2^( 6) =       0.000467915039
  error estimate for blocks of size 2^( 7) =       0.000476484345

      target function =                  N/A
              le_mean =     -16.905701019570
             les_mean =     286.142194879900
             stat err =       0.000461335544
             autocorr =       1.304059795604
              std dev =       0.571324911485
             le_variance =       0.326412154484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326463204661
                                         uncertainty =       0.003242930034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326463204661
                                         uncertainty =       0.003242930034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403987719
  error estimate for blocks of size 2^( 2) =       0.000417220715
  error estimate for blocks of size 2^( 3) =       0.000431678872
  error estimate for blocks of size 2^( 4) =       0.000444423147
  error estimate for blocks of size 2^( 5) =       0.000456519644
  error estimate for blocks of size 2^( 6) =       0.000467915039
  error estimate for blocks of size 2^( 7) =       0.000476484345

      target function =                  N/A
              le_mean =     -16.905701019570
             les_mean =     286.142194879809
             stat err =       0.000461335544
             autocorr =       1.304059795615
              std dev =       0.571324911479
             le_variance =       0.326412154477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326463204665
                                         uncertainty =       0.003242930033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326463204665
                                         uncertainty =       0.003242930033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403987719
  error estimate for blocks of size 2^( 2) =       0.000417220715
  error estimate for blocks of size 2^( 3) =       0.000431678872
  error estimate for blocks of size 2^( 4) =       0.000444423147
  error estimate for blocks of size 2^( 5) =       0.000456519644
  error estimate for blocks of size 2^( 6) =       0.000467915039
  error estimate for blocks of size 2^( 7) =       0.000476484345

      target function =                  N/A
              le_mean =     -16.905701019570
             les_mean =     286.142194879854
             stat err =       0.000461335544
             autocorr =       1.304059795615
              std dev =       0.571324911482
             le_variance =       0.326412154480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326463204668
                                         uncertainty =       0.003242930032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326463204668
                                         uncertainty =       0.003242930032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403987719
  error estimate for blocks of size 2^( 2) =       0.000417220715
  error estimate for blocks of size 2^( 3) =       0.000431678872
  error estimate for blocks of size 2^( 4) =       0.000444423147
  error estimate for blocks of size 2^( 5) =       0.000456519644
  error estimate for blocks of size 2^( 6) =       0.000467915039
  error estimate for blocks of size 2^( 7) =       0.000476484345

      target function =                  N/A
              le_mean =     -16.905701019570
             les_mean =     286.142194879894
             stat err =       0.000461335544
             autocorr =       1.304059795611
              std dev =       0.571324911485
             le_variance =       0.326412154483


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905701019570        initial  <--
     3.3087e+07     3.3087e+08             1.2993e-11       -16.905701019570
     1.3235e+08     1.3235e+09             3.2481e-12       -16.905701019570
     5.2940e+08     5.2940e+09             8.1203e-13       -16.905701019570

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5238
  </log>
  <optVariables href="H2O.s083.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8013e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -16.9158
    reference variance = 0.190567
====================================================
  Execution time = 2.1332e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3680e-01
  Total weights = 1.951706346e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0576e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323243281255
                                         uncertainty =       0.002326648258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323243281255
                                         uncertainty =       0.002326648258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402000402
  error estimate for blocks of size 2^( 2) =       0.000415329192
  error estimate for blocks of size 2^( 3) =       0.000428255153
  error estimate for blocks of size 2^( 4) =       0.000439802630
  error estimate for blocks of size 2^( 5) =       0.000450703145
  error estimate for blocks of size 2^( 6) =       0.000456918949
  error estimate for blocks of size 2^( 7) =       0.000463215117

      target function =                  N/A
              le_mean =     -16.906345539250
             les_mean =     286.161318392680
             stat err =       0.000452659960
             autocorr =       1.267918055412
              std dev =       0.568514421031
             le_variance =       0.323208646920


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690634553925e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3087e+08, overlap shift 3.3087e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906345539245       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906345539245       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906345539245       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906345711301       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906345176039       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906345568124       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906345596634       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906345423148       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906345553813       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906345564646       residual = 5.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3087e+08 is 1.642457e-12

solving harmonic davidson linear method for identity shift 1.3235e+09, overlap shift 1.3235e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906345539245       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906345539245       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906345539245       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906345539245       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906345539245       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906345925524       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906345524824       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906345092597       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906347360425       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906344940367       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3235e+09 is 4.106464e-13

solving harmonic davidson linear method for identity shift 5.2940e+09, overlap shift 5.2940e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906345539245       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906345539245       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906345539245       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906345391541       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906344451038       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906339367896       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906345721829       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906348839052       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906342320170       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906345547738       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.2940e+09 is 1.026359e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.646312 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7398e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -16.8531
    reference variance = 0.227755
====================================================
  Execution time = 2.1494e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3093e-01
  Total weights = 1.9520e+06
  Execution time = 1.8531e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319004198387
                                         uncertainty =       0.001804855506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319004198387
                                         uncertainty =       0.001804855506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399404480
  error estimate for blocks of size 2^( 2) =       0.000412450122
  error estimate for blocks of size 2^( 3) =       0.000425737771
  error estimate for blocks of size 2^( 4) =       0.000438207073
  error estimate for blocks of size 2^( 5) =       0.000448742938
  error estimate for blocks of size 2^( 6) =       0.000457512499
  error estimate for blocks of size 2^( 7) =       0.000464108098

      target function =                  N/A
              le_mean =     -16.906901185365
             les_mean =     286.174238855717
             stat err =       0.000452142652
             autocorr =       1.281519121963
              std dev =       0.564843232575
             le_variance =       0.319047877385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319004198386
                                         uncertainty =       0.001804855506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319004198386
                                         uncertainty =       0.001804855506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399404480
  error estimate for blocks of size 2^( 2) =       0.000412450122
  error estimate for blocks of size 2^( 3) =       0.000425737771
  error estimate for blocks of size 2^( 4) =       0.000438207073
  error estimate for blocks of size 2^( 5) =       0.000448742938
  error estimate for blocks of size 2^( 6) =       0.000457512499
  error estimate for blocks of size 2^( 7) =       0.000464108098

      target function =                  N/A
              le_mean =     -16.906901185365
             les_mean =     286.174238855714
             stat err =       0.000452142652
             autocorr =       1.281519121965
              std dev =       0.564843232574
             le_variance =       0.319047877384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319004198386
                                         uncertainty =       0.001804855506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319004198386
                                         uncertainty =       0.001804855506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399404480
  error estimate for blocks of size 2^( 2) =       0.000412450122
  error estimate for blocks of size 2^( 3) =       0.000425737771
  error estimate for blocks of size 2^( 4) =       0.000438207073
  error estimate for blocks of size 2^( 5) =       0.000448742938
  error estimate for blocks of size 2^( 6) =       0.000457512499
  error estimate for blocks of size 2^( 7) =       0.000464108098

      target function =                  N/A
              le_mean =     -16.906901185365
             les_mean =     286.174238855716
             stat err =       0.000452142652
             autocorr =       1.281519121964
              std dev =       0.564843232574
             le_variance =       0.319047877385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319004198387
                                         uncertainty =       0.001804855506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319004198387
                                         uncertainty =       0.001804855506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399404480
  error estimate for blocks of size 2^( 2) =       0.000412450122
  error estimate for blocks of size 2^( 3) =       0.000425737771
  error estimate for blocks of size 2^( 4) =       0.000438207073
  error estimate for blocks of size 2^( 5) =       0.000448742938
  error estimate for blocks of size 2^( 6) =       0.000457512499
  error estimate for blocks of size 2^( 7) =       0.000464108098

      target function =                  N/A
              le_mean =     -16.906901185365
             les_mean =     286.174238855717
             stat err =       0.000452142652
             autocorr =       1.281519121965
              std dev =       0.564843232575
             le_variance =       0.319047877385


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906901185365        initial  <--
     3.3087e+08     3.3087e+09             1.6425e-12       -16.906901185365
     1.3235e+09     1.3235e+10             4.1065e-13       -16.906901185365
     5.2940e+09     5.2940e+10             1.0264e-13       -16.906901185365

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0179
  </log>
  <optVariables href="H2O.s084.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8422e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -16.8473
    reference variance = 0.301118
====================================================
  Execution time = 2.1449e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3602e-01
  Total weights = 1.951259097e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0424e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322176861552
                                         uncertainty =       0.002243630790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322176861552
                                         uncertainty =       0.002243630790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401362630
  error estimate for blocks of size 2^( 2) =       0.000414233243
  error estimate for blocks of size 2^( 3) =       0.000427036788
  error estimate for blocks of size 2^( 4) =       0.000439892531
  error estimate for blocks of size 2^( 5) =       0.000451401938
  error estimate for blocks of size 2^( 6) =       0.000458952991
  error estimate for blocks of size 2^( 7) =       0.000464753451

      target function =                  N/A
              le_mean =     -16.906656208159
             les_mean =     286.171046990573
             stat err =       0.000453750228
             autocorr =       1.278085312404
              std dev =       0.567612475008
             le_variance =       0.322183921784


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690665620816e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3087e+09, overlap shift 3.3087e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906656208164       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906656208164       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906656208164       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906656208164       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906657990152       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906656414472       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906657310206       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906657899696       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906653517380       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906654934771       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3087e+09 is 1.262940e-13

solving harmonic davidson linear method for identity shift 1.3235e+10, overlap shift 1.3235e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906656208164       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906656208164       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906656208164       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906656208164       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906657975742       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906656208164       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906649545296       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906666949829       residual = 8.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906657055839       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906647134008       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906673478895       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906575742940       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906752141905       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906609128790       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906637478269       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906862815149       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906519171103       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906676238419       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906289796599       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906702466569       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906851008692       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.907045540062       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906303985697       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.905845748257       residual = 9.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.906602098119       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.906402731804       residual = 9.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.907452172171       residual = 8.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.906704769067       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.908048493654       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.908537980491       residual = 4.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.905889960162       residual = 7.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.907189076032       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.907324609268       residual = 5.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.905601573853       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.906548813653       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.906924367659       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.907938596851       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.906823903685       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.906311184993       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.908498436055       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.908233329707       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.907214073178       residual = 5.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -16.907756500629       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.907763670440       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.907749719420       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.906179317002       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.907145148088       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -16.907341941998       residual = 6.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.905081271674       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.904685963065       residual = 5.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.906632119018       residual = 7.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.905618436510       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.905894164835       residual = 8.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -16.906540652028       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -16.905641537740       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -16.906814676645       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -16.906015098891       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -16.906707924471       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -16.907671466103       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   energy =     -16.908841887134       residual = 7.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   energy =     -16.907826912523       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   energy =     -16.904585441112       residual = 5.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   energy =     -16.904910848932       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   energy =     -16.906298366420       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   energy =     -16.905958990394       residual = 7.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   energy =     -16.906675805161       residual = 1.14e-05           smallest_sin_value = 9.99e-01
davidson iteration   66:   krylov dim =  67   energy =     -16.908931702382       residual = 6.60e-04           smallest_sin_value = 9.98e-01
davidson iteration   67:   krylov dim =  68   energy =     -16.905038841974       residual = 3.32e-04           smallest_sin_value = 9.97e-01
davidson iteration   68:   krylov dim =  69   energy =     -16.906538323684       residual = 1.46e-05           smallest_sin_value = 9.91e-01
davidson iteration   69:   krylov dim =  70   energy =     -16.906931454454       residual = 1.17e-05           smallest_sin_value = 9.90e-01
davidson iteration   70 stopping due to small subspace S singular value of 9.76e-01
davidson solver did not converge after         70 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3235e+10 is 3.156531e-14

solving harmonic davidson linear method for identity shift 5.2940e+10, overlap shift 5.2940e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906656208164       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906656208164       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906656208164       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906656208164       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906646882512       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906655584401       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906727319397       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906752825135       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906664107027       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906640961441       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906712688276       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906904323362       residual = 8.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906811354472       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906330525263       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905640985661       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.907255325596       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906985785794       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.907797910010       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.907861244174       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.907899228326       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.907248216168       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.901536691228       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905556853651       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.904386581099       residual = 6.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.908567069611       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.905590991477       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.907876418008       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.901076570429       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.906053407379       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.905811587491       residual = 9.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.912245405710       residual = 4.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.896071992245       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.906884726491       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.911615369615       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.897673454877       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.908320375577       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.907259517982       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.898542653446       residual = 8.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.910734027956       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.899423633989       residual = 7.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.915920496807       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.901975783919       residual = 2.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -16.906579501925       residual = 7.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.904988350715       residual = 9.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.903082138340       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.906732027376       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.908944612230       residual = 7.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -16.913357694534       residual = 5.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.911575370608       residual = 3.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.904063912658       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.903277345513       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.906229338768       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.906214854648       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -16.904361599161       residual = 5.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -16.909928434249       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -16.903335910814       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -16.917164775397       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -16.903950362573       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -16.900297063961       residual = 4.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   energy =     -16.898835438537       residual = 7.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   energy =     -16.906116519098       residual = 2.39e-04           smallest_sin_value = 9.99e-01
davidson iteration   61:   krylov dim =  62   energy =     -16.907702421181       residual = 5.50e-04           smallest_sin_value = 9.99e-01
davidson iteration   62:   krylov dim =  63   energy =     -16.903519809081       residual = 1.46e-03           smallest_sin_value = 9.98e-01
davidson iteration   63:   krylov dim =  64   energy =     -16.911849119753       residual = 3.99e-03           smallest_sin_value = 9.94e-01
davidson iteration   64:   krylov dim =  65   energy =     -16.907966163710       residual = 2.94e-04           smallest_sin_value = 9.94e-01
davidson iteration   65 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         65 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.2940e+10 is 7.863772e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.920481 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7770e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -16.9088
    reference variance = 0.162184
====================================================
  Execution time = 2.1210e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3790e-01
  Total weights = 1.9517e+06
  Execution time = 1.8861e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324758626960
                                         uncertainty =       0.002029515180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324758626960
                                         uncertainty =       0.002029515180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402955186
  error estimate for blocks of size 2^( 2) =       0.000416275780
  error estimate for blocks of size 2^( 3) =       0.000429914205
  error estimate for blocks of size 2^( 4) =       0.000443348794
  error estimate for blocks of size 2^( 5) =       0.000455144024
  error estimate for blocks of size 2^( 6) =       0.000463931351
  error estimate for blocks of size 2^( 7) =       0.000470491717

      target function =                  N/A
              le_mean =     -16.905966393306
             les_mean =     286.149598649391
             stat err =       0.000458228971
             autocorr =       1.293157996184
              std dev =       0.569864688576
             le_variance =       0.324745763286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324758626960
                                         uncertainty =       0.002029515180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324758626960
                                         uncertainty =       0.002029515180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402955186
  error estimate for blocks of size 2^( 2) =       0.000416275780
  error estimate for blocks of size 2^( 3) =       0.000429914205
  error estimate for blocks of size 2^( 4) =       0.000443348794
  error estimate for blocks of size 2^( 5) =       0.000455144024
  error estimate for blocks of size 2^( 6) =       0.000463931351
  error estimate for blocks of size 2^( 7) =       0.000470491717

      target function =                  N/A
              le_mean =     -16.905966393306
             les_mean =     286.149598649391
             stat err =       0.000458228971
             autocorr =       1.293157996183
              std dev =       0.569864688576
             le_variance =       0.324745763286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324758626960
                                         uncertainty =       0.002029515180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324758626960
                                         uncertainty =       0.002029515180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402955186
  error estimate for blocks of size 2^( 2) =       0.000416275780
  error estimate for blocks of size 2^( 3) =       0.000429914205
  error estimate for blocks of size 2^( 4) =       0.000443348794
  error estimate for blocks of size 2^( 5) =       0.000455144024
  error estimate for blocks of size 2^( 6) =       0.000463931351
  error estimate for blocks of size 2^( 7) =       0.000470491717

      target function =                  N/A
              le_mean =     -16.905966393306
             les_mean =     286.149598649391
             stat err =       0.000458228971
             autocorr =       1.293157996187
              std dev =       0.569864688576
             le_variance =       0.324745763286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324758626960
                                         uncertainty =       0.002029515180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324758626960
                                         uncertainty =       0.002029515180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402955186
  error estimate for blocks of size 2^( 2) =       0.000416275780
  error estimate for blocks of size 2^( 3) =       0.000429914205
  error estimate for blocks of size 2^( 4) =       0.000443348794
  error estimate for blocks of size 2^( 5) =       0.000455144024
  error estimate for blocks of size 2^( 6) =       0.000463931351
  error estimate for blocks of size 2^( 7) =       0.000470491717

      target function =                  N/A
              le_mean =     -16.905966393306
             les_mean =     286.149598649391
             stat err =       0.000458228971
             autocorr =       1.293157996186
              std dev =       0.569864688576
             le_variance =       0.324745763286


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905966393306        initial
     3.3087e+09     3.3087e+10             1.2629e-13       -16.905966393306  <--
     1.3235e+10     1.3235e+11             3.1565e-14       -16.905966393306
     5.2940e+10     5.2940e+11             7.8638e-15       -16.905966393306

*****************************************************************************
Applying the update for shift_i =   3.3087e+09     and shift_s =   3.3087e+10
*****************************************************************************

  Execution time = 3.0749e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8525e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -16.9953
    reference variance = 1.63607
====================================================
  Execution time = 2.1175e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3551e-01
  Total weights = 1.951827860e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0349e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319544450245
                                         uncertainty =       0.002291323462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319544450245
                                         uncertainty =       0.002291323462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399749226
  error estimate for blocks of size 2^( 2) =       0.000412580304
  error estimate for blocks of size 2^( 3) =       0.000425813332
  error estimate for blocks of size 2^( 4) =       0.000438347014
  error estimate for blocks of size 2^( 5) =       0.000450027206
  error estimate for blocks of size 2^( 6) =       0.000457237123
  error estimate for blocks of size 2^( 7) =       0.000462821020

      target function =                  N/A
              le_mean =     -16.906150526838
             les_mean =     286.153438634073
             stat err =       0.000452108091
             autocorr =       1.279114123183
              std dev =       0.565330777499
             le_variance =       0.319598887987


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690615052684e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+08, overlap shift 8.2718e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906150526820       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906150526820       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906150526820       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906150526820       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906151262137       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906150618528       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906150530516       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906151189877       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906151120466       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906150224574       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.2718e+08 is 4.184831e-13

solving harmonic davidson linear method for identity shift 3.3087e+09, overlap shift 3.3087e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906150526820       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906150526820       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906150526820       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906150526820       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906149725906       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906150725675       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906150969995       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906152895112       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906148833890       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906156293761       residual = 8.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3087e+09 is 1.045988e-13

solving harmonic davidson linear method for identity shift 1.3235e+10, overlap shift 1.3235e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906150526820       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906150526820       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906150526820       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906137875051       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906152020826       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906147659820       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906151015435       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906158872080       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906140648561       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906149412272       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3235e+10 is 2.621181e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.924452 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7218e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -16.9326
    reference variance = 0.27735
====================================================
  Execution time = 2.1167e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3209e-01
  Total weights = 1.9521e+06
  Execution time = 1.8657e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320867145218
                                         uncertainty =       0.001982006060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320867145218
                                         uncertainty =       0.001982006060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400558312
  error estimate for blocks of size 2^( 2) =       0.000413434714
  error estimate for blocks of size 2^( 3) =       0.000426530931
  error estimate for blocks of size 2^( 4) =       0.000438649209
  error estimate for blocks of size 2^( 5) =       0.000449141555
  error estimate for blocks of size 2^( 6) =       0.000456041126
  error estimate for blocks of size 2^( 7) =       0.000461342317

      target function =                  N/A
              le_mean =     -16.906025466537
             les_mean =     286.145789276111
             stat err =       0.000451293552
             autocorr =       1.269365703126
              std dev =       0.566474997501
             le_variance =       0.320893922794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320867145218
                                         uncertainty =       0.001982006060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320867145218
                                         uncertainty =       0.001982006060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400558312
  error estimate for blocks of size 2^( 2) =       0.000413434714
  error estimate for blocks of size 2^( 3) =       0.000426530931
  error estimate for blocks of size 2^( 4) =       0.000438649209
  error estimate for blocks of size 2^( 5) =       0.000449141555
  error estimate for blocks of size 2^( 6) =       0.000456041126
  error estimate for blocks of size 2^( 7) =       0.000461342317

      target function =                  N/A
              le_mean =     -16.906025466537
             les_mean =     286.145789276111
             stat err =       0.000451293552
             autocorr =       1.269365703131
              std dev =       0.566474997501
             le_variance =       0.320893922794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320867145218
                                         uncertainty =       0.001982006060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320867145218
                                         uncertainty =       0.001982006060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400558312
  error estimate for blocks of size 2^( 2) =       0.000413434714
  error estimate for blocks of size 2^( 3) =       0.000426530931
  error estimate for blocks of size 2^( 4) =       0.000438649209
  error estimate for blocks of size 2^( 5) =       0.000449141555
  error estimate for blocks of size 2^( 6) =       0.000456041126
  error estimate for blocks of size 2^( 7) =       0.000461342317

      target function =                  N/A
              le_mean =     -16.906025466537
             les_mean =     286.145789276111
             stat err =       0.000451293552
             autocorr =       1.269365703132
              std dev =       0.566474997501
             le_variance =       0.320893922794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320867145218
                                         uncertainty =       0.001982006060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320867145218
                                         uncertainty =       0.001982006060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400558312
  error estimate for blocks of size 2^( 2) =       0.000413434714
  error estimate for blocks of size 2^( 3) =       0.000426530931
  error estimate for blocks of size 2^( 4) =       0.000438649209
  error estimate for blocks of size 2^( 5) =       0.000449141555
  error estimate for blocks of size 2^( 6) =       0.000456041126
  error estimate for blocks of size 2^( 7) =       0.000461342317

      target function =                  N/A
              le_mean =     -16.906025466537
             les_mean =     286.145789276111
             stat err =       0.000451293552
             autocorr =       1.269365703131
              std dev =       0.566474997501
             le_variance =       0.320893922794


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906025466537        initial  <--
     8.2718e+08     8.2718e+09             4.1848e-13       -16.906025466537
     3.3087e+09     3.3087e+10             1.0460e-13       -16.906025466537
     1.3235e+10     1.3235e+11             2.6212e-14       -16.906025466537

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6983
  </log>
  <optVariables href="H2O.s086.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7922e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -16.939
    reference variance = 0.317955
====================================================
  Execution time = 2.1429e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5240e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4132e-01
  Total weights = 1.951879688e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0581e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328712650103
                                         uncertainty =       0.007203255075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328712650103
                                         uncertainty =       0.007203255075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405402826
  error estimate for blocks of size 2^( 2) =       0.000418622199
  error estimate for blocks of size 2^( 3) =       0.000432164630
  error estimate for blocks of size 2^( 4) =       0.000444308276
  error estimate for blocks of size 2^( 5) =       0.000455301919
  error estimate for blocks of size 2^( 6) =       0.000462689078
  error estimate for blocks of size 2^( 7) =       0.000467243657

      target function =                  N/A
              le_mean =     -16.905600015300
             les_mean =     286.140627197981
             stat err =       0.000457385733
             autocorr =       1.272892371850
              std dev =       0.573326174223
             le_variance =       0.328702902049


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690560001530e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+09, overlap shift 8.2718e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905600015277       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905600015277       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905600015277       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905600336046       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905600015277       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905600021988       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905607065424       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905600579507       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905594636402       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905599219205       residual = 4.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.2718e+09 is 4.505354e-14

solving harmonic davidson linear method for identity shift 3.3087e+10, overlap shift 3.3087e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905600015277       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905600015277       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905600015277       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905614291737       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905592324113       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905609743993       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905613518002       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905682649229       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905862298509       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905228653624       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905632484398       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905452325123       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905292280682       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905524075283       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905196887598       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905743882494       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905836043178       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905041399206       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905294590789       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.907485361251       residual = 4.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906170637441       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.904327796123       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.904681610047       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.908335162240       residual = 9.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.910347758502       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.906448214973       residual = 9.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.905827785169       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.905383891444       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.905870266649       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.907188305543       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.906176154992       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.906337793402       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.904284938570       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.909828355303       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.910272389924       residual = 2.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.898954962707       residual = 5.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.894195294177       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.902843264581       residual = 9.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.901615063229       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.906389986085       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.903545495936       residual = 5.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.907084877075       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -16.904561789977       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.905480133589       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.905210786676       residual = 8.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.895980782107       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.900340476679       residual = 3.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -16.904086035934       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.902162278161       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.912331493329       residual = 6.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.906090905053       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.904209252282       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.895104134734       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -16.909479749641       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -16.908091142360       residual = 9.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -16.900331505612       residual = 3.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -16.903610496379       residual = 9.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -16.906695325351       residual = 2.96e-04           smallest_sin_value = 9.99e-01
davidson iteration   58:   krylov dim =  59   energy =     -16.902382086886       residual = 1.38e-03           smallest_sin_value = 9.98e-01
davidson iteration   59:   krylov dim =  60   energy =     -16.902137371565       residual = 1.58e-03           smallest_sin_value = 9.97e-01
davidson iteration   60 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         60 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3087e+10 is 1.133504e-14

solving harmonic davidson linear method for identity shift 1.3235e+11, overlap shift 1.3235e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905600015277       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905600015277       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905600015277       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905604244903       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905613070930       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905600015276       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905599712478       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905602295077       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905543237101       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905601843268       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905598377686       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905428751317       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905527445089       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904920911531       residual = 6.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905584319907       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906795160756       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.904798744433       residual = 7.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.904367451254       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.908084012831       residual = 8.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.903762423684       residual = 4.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.899295003361       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.910698008444       residual = 3.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.904499086466       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.902706720408       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.916977835421       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.905782619825       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.909092832722       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.891047337026       residual = 2.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.910851053049       residual = 4.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.895409035669       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.897664865984       residual = 8.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.910488300376       residual = 3.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.912399580789       residual = 7.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.917669352843       residual = 2.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.900965050068       residual = 2.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.916501478276       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.897167535771       residual = 9.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.903393307686       residual = 9.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.909519468896       residual = 3.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.903696588710       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.906041967602       residual = 2.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.898752881633       residual = 6.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -16.895786769279       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.901556812445       residual = 3.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.903140318411       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.881995854617       residual = 7.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.903208001488       residual = 6.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -16.899598977935       residual = 7.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.900909167335       residual = 4.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.907143552864       residual = 7.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.899572022362       residual = 7.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.912903565629       residual = 7.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.909592256037       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -16.930430034532       residual = 9.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -16.908856516955       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -16.944481377241       residual = 2.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -16.915116863194       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -16.917190761468       residual = 2.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -16.891320763857       residual = 3.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   energy =     -16.895701853747       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   energy =     -16.905422319878       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   energy =     -16.895553088803       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   energy =     -16.925103354634       residual = 5.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   energy =     -16.889375250726       residual = 3.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   energy =     -16.912188939754       residual = 6.88e-03           smallest_sin_value = 9.98e-01
davidson iteration   65:   krylov dim =  66   energy =     -16.889355225411       residual = 3.36e-02           smallest_sin_value = 9.98e-01
davidson iteration   66:   krylov dim =  67   energy =     -16.884372904020       residual = 5.38e-02           smallest_sin_value = 9.96e-01
davidson iteration   67:   krylov dim =  68   energy =     -16.922719792881       residual = 4.55e-02           smallest_sin_value = 9.93e-01
davidson iteration   68:   krylov dim =  69   energy =     -16.941814268805       residual = 1.64e-01           smallest_sin_value = 9.91e-01
davidson iteration   69 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         69 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3235e+11 is 2.812169e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.144276 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7711e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -16.8553
    reference variance = 0.440086
====================================================
  Execution time = 2.1205e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4234e-01
  Total weights = 1.9515e+06
  Execution time = 1.8619e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328221773476
                                         uncertainty =       0.007416922119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328221773476
                                         uncertainty =       0.007416922119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405142227
  error estimate for blocks of size 2^( 2) =       0.000417713724
  error estimate for blocks of size 2^( 3) =       0.000431110242
  error estimate for blocks of size 2^( 4) =       0.000442691759
  error estimate for blocks of size 2^( 5) =       0.000453148173
  error estimate for blocks of size 2^( 6) =       0.000460448239
  error estimate for blocks of size 2^( 7) =       0.000463641319

      target function =                  N/A
              le_mean =     -16.906928246908
             les_mean =     286.186561484279
             stat err =       0.000454982373
             autocorr =       1.261171417224
              std dev =       0.572957632710
             le_variance =       0.328280448880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328221773476
                                         uncertainty =       0.007416922119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328221773476
                                         uncertainty =       0.007416922119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405142227
  error estimate for blocks of size 2^( 2) =       0.000417713724
  error estimate for blocks of size 2^( 3) =       0.000431110242
  error estimate for blocks of size 2^( 4) =       0.000442691759
  error estimate for blocks of size 2^( 5) =       0.000453148173
  error estimate for blocks of size 2^( 6) =       0.000460448239
  error estimate for blocks of size 2^( 7) =       0.000463641319

      target function =                  N/A
              le_mean =     -16.906928246908
             les_mean =     286.186561484279
             stat err =       0.000454982373
             autocorr =       1.261171417224
              std dev =       0.572957632710
             le_variance =       0.328280448880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328221773476
                                         uncertainty =       0.007416922119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328221773476
                                         uncertainty =       0.007416922119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405142227
  error estimate for blocks of size 2^( 2) =       0.000417713724
  error estimate for blocks of size 2^( 3) =       0.000431110242
  error estimate for blocks of size 2^( 4) =       0.000442691759
  error estimate for blocks of size 2^( 5) =       0.000453148173
  error estimate for blocks of size 2^( 6) =       0.000460448239
  error estimate for blocks of size 2^( 7) =       0.000463641319

      target function =                  N/A
              le_mean =     -16.906928246908
             les_mean =     286.186561484279
             stat err =       0.000454982373
             autocorr =       1.261171417224
              std dev =       0.572957632710
             le_variance =       0.328280448880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328221773476
                                         uncertainty =       0.007416922119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328221773476
                                         uncertainty =       0.007416922119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405142227
  error estimate for blocks of size 2^( 2) =       0.000417713724
  error estimate for blocks of size 2^( 3) =       0.000431110242
  error estimate for blocks of size 2^( 4) =       0.000442691759
  error estimate for blocks of size 2^( 5) =       0.000453148173
  error estimate for blocks of size 2^( 6) =       0.000460448239
  error estimate for blocks of size 2^( 7) =       0.000463641319

      target function =                  N/A
              le_mean =     -16.906928246908
             les_mean =     286.186561484279
             stat err =       0.000454982373
             autocorr =       1.261171417224
              std dev =       0.572957632710
             le_variance =       0.328280448880


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906928246908        initial
     8.2718e+09     8.2718e+10             4.5054e-14       -16.906928246908  <--
     3.3087e+10     3.3087e+11             1.1335e-14       -16.906928246908
     1.3235e+11     1.3235e+12             2.8122e-15       -16.906928246908

*****************************************************************************
Applying the update for shift_i =   8.2718e+09     and shift_s =   8.2718e+10
*****************************************************************************

  Execution time = 3.0742e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8459e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -16.9285
    reference variance = 0.170239
====================================================
  Execution time = 2.3323e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5221e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3939e-01
  Total weights = 1.951351940e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1238e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323144399397
                                         uncertainty =       0.002006439116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323144399397
                                         uncertainty =       0.002006439116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401920145
  error estimate for blocks of size 2^( 2) =       0.000414961516
  error estimate for blocks of size 2^( 3) =       0.000427970062
  error estimate for blocks of size 2^( 4) =       0.000440361650
  error estimate for blocks of size 2^( 5) =       0.000451144422
  error estimate for blocks of size 2^( 6) =       0.000459118023
  error estimate for blocks of size 2^( 7) =       0.000466645673

      target function =                  N/A
              le_mean =     -16.906552258889
             les_mean =     286.170904109762
             stat err =       0.000454317442
             autocorr =       1.277730532183
              std dev =       0.568400919392
             le_variance =       0.323079605166


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690655225889e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0680e+09, overlap shift 2.0680e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906552258898       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906552258898       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906552258898       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906552696301       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906551484461       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906552242212       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906551332613       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906551487325       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906552649386       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.0680e+09 is 2.521760e-13

solving harmonic davidson linear method for identity shift 8.2718e+09, overlap shift 8.2718e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906552258898       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906552258898       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906552258898       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906552258898       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906550546345       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906549503764       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906556213513       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906556802848       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906540170192       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906548412144       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.2718e+09 is 6.305064e-14

solving harmonic davidson linear method for identity shift 3.3087e+10, overlap shift 3.3087e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906552258898       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906552258898       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906552258898       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906530619281       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906547524518       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906531564663       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906550201607       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906550845391       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906560924113       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906582382334       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906550568566       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906500571274       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906631855649       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906729433729       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906183594450       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906260528996       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906289527506       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906078866559       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906703321565       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906253099909       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905397881135       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.908345808761       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906232508673       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.907748630832       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.907408219135       residual = 9.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.903933596516       residual = 9.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.906129947131       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.908055708312       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.904151285235       residual = 7.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.906429732402       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.908392124901       residual = 4.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.907454127558       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.908371952888       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.907909269200       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.905349068052       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.906440788543       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.896850804473       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.908625040029       residual = 5.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.904211418877       residual = 6.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.913890744331       residual = 7.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.909406125469       residual = 9.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.899871980344       residual = 5.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -16.900015050066       residual = 5.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.899022313470       residual = 7.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.911255942443       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.908528624241       residual = 6.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.912134450876       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -16.902839442485       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.907513107427       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.905021405878       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.909672981392       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.904007630153       residual = 7.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.909637238678       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -16.907364238765       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -16.906267661948       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -16.907511430737       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -16.907072323189       residual = 8.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -16.908754183777       residual = 8.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -16.907027694639       residual = 8.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   energy =     -16.906489343587       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   energy =     -16.904674705448       residual = 4.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   energy =     -16.904457193768       residual = 5.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   energy =     -16.906990751732       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   energy =     -16.908803058239       residual = 6.37e-04           smallest_sin_value = 9.99e-01
davidson iteration   64:   krylov dim =  65   energy =     -16.899019156217       residual = 8.03e-03           smallest_sin_value = 9.98e-01
davidson iteration   65:   krylov dim =  66   energy =     -16.907213063601       residual = 1.48e-04           smallest_sin_value = 9.98e-01
davidson iteration   66:   krylov dim =  67   energy =     -16.906765687763       residual = 1.63e-04           smallest_sin_value = 9.95e-01
davidson iteration   67:   krylov dim =  68   energy =     -16.913840022955       residual = 6.34e-03           smallest_sin_value = 9.94e-01
davidson iteration   68 stopping due to small subspace S singular value of 9.69e-01
davidson solver did not converge after         68 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3087e+10 is 1.577483e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.273928 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9581e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -16.9156
    reference variance = 0.196112
====================================================
  Execution time = 2.1268e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3281e-01
  Total weights = 1.9516e+06
  Execution time = 1.8576e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321100453498
                                         uncertainty =       0.001846538432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321100453498
                                         uncertainty =       0.001846538432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400700983
  error estimate for blocks of size 2^( 2) =       0.000413483141
  error estimate for blocks of size 2^( 3) =       0.000426587393
  error estimate for blocks of size 2^( 4) =       0.000438913680
  error estimate for blocks of size 2^( 5) =       0.000449968254
  error estimate for blocks of size 2^( 6) =       0.000457679218
  error estimate for blocks of size 2^( 7) =       0.000463894924

      target function =                  N/A
              le_mean =     -16.906288537676
             les_mean =     286.155402052125
             stat err =       0.000452614019
             autocorr =       1.275895739090
              std dev =       0.566676764621
             le_variance =       0.321122555562

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321100453498
                                         uncertainty =       0.001846538432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321100453498
                                         uncertainty =       0.001846538432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400700983
  error estimate for blocks of size 2^( 2) =       0.000413483141
  error estimate for blocks of size 2^( 3) =       0.000426587393
  error estimate for blocks of size 2^( 4) =       0.000438913680
  error estimate for blocks of size 2^( 5) =       0.000449968254
  error estimate for blocks of size 2^( 6) =       0.000457679218
  error estimate for blocks of size 2^( 7) =       0.000463894924

      target function =                  N/A
              le_mean =     -16.906288537676
             les_mean =     286.155402052125
             stat err =       0.000452614019
             autocorr =       1.275895739090
              std dev =       0.566676764621
             le_variance =       0.321122555562

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321100453498
                                         uncertainty =       0.001846538432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321100453498
                                         uncertainty =       0.001846538432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400700983
  error estimate for blocks of size 2^( 2) =       0.000413483141
  error estimate for blocks of size 2^( 3) =       0.000426587393
  error estimate for blocks of size 2^( 4) =       0.000438913680
  error estimate for blocks of size 2^( 5) =       0.000449968254
  error estimate for blocks of size 2^( 6) =       0.000457679218
  error estimate for blocks of size 2^( 7) =       0.000463894924

      target function =                  N/A
              le_mean =     -16.906288537676
             les_mean =     286.155402052125
             stat err =       0.000452614019
             autocorr =       1.275895739095
              std dev =       0.566676764621
             le_variance =       0.321122555562

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321100453498
                                         uncertainty =       0.001846538432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321100453498
                                         uncertainty =       0.001846538432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400700983
  error estimate for blocks of size 2^( 2) =       0.000413483141
  error estimate for blocks of size 2^( 3) =       0.000426587393
  error estimate for blocks of size 2^( 4) =       0.000438913680
  error estimate for blocks of size 2^( 5) =       0.000449968254
  error estimate for blocks of size 2^( 6) =       0.000457679218
  error estimate for blocks of size 2^( 7) =       0.000463894924

      target function =                  N/A
              le_mean =     -16.906288537676
             les_mean =     286.155402052125
             stat err =       0.000452614019
             autocorr =       1.275895739089
              std dev =       0.566676764621
             le_variance =       0.321122555562


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906288537676        initial  <--
     2.0680e+09     2.0680e+10             2.5218e-13       -16.906288537676
     8.2718e+09     8.2718e+10             6.3051e-14       -16.906288537676
     3.3087e+10     3.3087e+11             1.5775e-14       -16.906288537676

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7737
  </log>
  <optVariables href="H2O.s088.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0360e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -16.785
    reference variance = 1.69008
====================================================
  Execution time = 2.1212e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2921e-01
  Total weights = 1.951205407e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1406e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319187557691
                                         uncertainty =       0.002174935285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319187557691
                                         uncertainty =       0.002174935285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399534337
  error estimate for blocks of size 2^( 2) =       0.000412520923
  error estimate for blocks of size 2^( 3) =       0.000425945086
  error estimate for blocks of size 2^( 4) =       0.000438433510
  error estimate for blocks of size 2^( 5) =       0.000449844592
  error estimate for blocks of size 2^( 6) =       0.000457993632
  error estimate for blocks of size 2^( 7) =       0.000464546611

      target function =                  N/A
              le_mean =     -16.905645816267
             les_mean =     286.130074070112
             stat err =       0.000452704586
             autocorr =       1.283871531631
              std dev =       0.565026878058
             le_variance =       0.319255372928


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690564581627e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0680e+10, overlap shift 2.0680e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905645816281       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905645816281       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905645816281       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905645816281       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905651968845       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905644473103       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905613280916       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905647888015       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905701951090       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905640545326       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905543606051       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905604358755       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905547319920       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905641147840       residual = 7.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.0680e+10 is 1.375689e-14

solving harmonic davidson linear method for identity shift 8.2718e+10, overlap shift 8.2718e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905645816281       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905645816281       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905645816281       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905642060580       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905668564650       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905645816281       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905614075900       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905622823309       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905545568990       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905738932898       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905842927616       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905596999209       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905526026962       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905610730942       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905481750905       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905474507095       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.907857463457       residual = 6.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.903613558165       residual = 5.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905586001218       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.903681098992       residual = 5.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906064196853       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905205169194       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.904229348106       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.908663994312       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.905343104952       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.904105684363       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.903440705859       residual = 6.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.907283083370       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.901581429154       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.905438874362       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.906435858404       residual = 8.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.903032280090       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.906029612830       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.906620616870       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.902419957087       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.905000426385       residual = 7.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.905156503869       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.907346466595       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.906548681745       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.893892739989       residual = 1.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.918941501454       residual = 2.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.905606932828       residual = 6.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -16.912436825185       residual = 6.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.905219968907       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.909895390300       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.919820113914       residual = 2.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.910861095418       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -16.899105230359       residual = 6.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.915258097601       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.902220513873       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.913311975435       residual = 8.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.899696707209       residual = 5.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.903072346716       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -16.910102144898       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -16.907898826141       residual = 7.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -16.905885729586       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -16.897934374666       residual = 8.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -16.899841473445       residual = 5.03e-03           smallest_sin_value = 9.99e-01
davidson iteration   58:   krylov dim =  59   energy =     -16.917226077755       residual = 1.91e-02           smallest_sin_value = 9.98e-01
davidson iteration   59:   krylov dim =  60   energy =     -16.900548880365       residual = 3.44e-03           smallest_sin_value = 9.95e-01
davidson iteration   60:   krylov dim =  61   energy =     -16.908834236732       residual = 2.05e-03           smallest_sin_value = 9.94e-01
davidson iteration   61:   krylov dim =  62   energy =     -16.901479505212       residual = 2.34e-03           smallest_sin_value = 9.93e-01
davidson iteration   62:   krylov dim =  63   energy =     -16.909621305809       residual = 2.40e-03           smallest_sin_value = 9.90e-01
davidson iteration   63 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after         63 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.2718e+10 is 3.476501e-15

solving harmonic davidson linear method for identity shift 3.3087e+11, overlap shift 3.3087e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905645816281       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905645816281       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905645816281       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905665633827       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905500210043       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905809631700       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904943543401       residual = 6.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905426969326       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905571867509       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906099318544       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.903912824555       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904634078368       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906071673019       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906143853717       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910192544436       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.916962602041       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910066811857       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.896862687292       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.912692869141       residual = 7.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.904130866624       residual = 5.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.891662361189       residual = 2.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.903795256119       residual = 6.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.914423730137       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.895270162809       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.858333005950       residual = 3.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.886220209788       residual = 5.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.858550534809       residual = 3.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.884746691938       residual = 5.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.866758463638       residual = 2.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.918043088372       residual = 2.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.918691763703       residual = 2.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.907411943423       residual = 4.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.911572386323       residual = 4.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.909127366187       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.889947479046       residual = 3.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.888055070312       residual = 4.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.887180999730       residual = 5.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.901395088805       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.915685356774       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.923427571530       residual = 5.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.899390391679       residual = 7.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.898947604541       residual = 7.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -16.961199281291       residual = 4.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.898093554804       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.878997349495       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.863728872253       residual = 2.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.845202288983       residual = 6.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -16.955695705900       residual = 3.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.926733958735       residual = 6.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.905101719550       residual = 3.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.872066467280       residual = 1.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.907919706143       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.884390656545       residual = 7.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -16.884008227125       residual = 7.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -16.883210838269       residual = 8.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -16.923729283855       residual = 3.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -16.926872329884       residual = 5.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -16.866515049257       residual = 2.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -16.895738943983       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   energy =     -16.918689119755       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   energy =     -16.914797089779       residual = 4.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   energy =     -16.954299361929       residual = 3.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   energy =     -16.859279376724       residual = 2.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   energy =     -16.891178872986       residual = 2.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   energy =     -16.957275630800       residual = 4.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   energy =     -16.880117989932       residual = 1.11e-01           smallest_sin_value = 9.99e-01
davidson iteration   66:   krylov dim =  67   energy =     -16.886799350530       residual = 1.06e-01           smallest_sin_value = 9.99e-01
davidson iteration   67:   krylov dim =  68   energy =     -16.898226270500       residual = 8.11e-02           smallest_sin_value = 9.99e-01
davidson iteration   68:   krylov dim =  69   energy =     -16.769686689435       residual = 2.26e+00           smallest_sin_value = 9.99e-01
davidson iteration   69:   krylov dim =  70   energy =     -16.791166310041       residual = 1.64e+00           smallest_sin_value = 9.99e-01
davidson iteration   70:   krylov dim =  71   energy =     -16.723299416281       residual = 4.30e+00           smallest_sin_value = 9.93e-01
davidson iteration   71:   krylov dim =  72   energy =     -16.868189879813       residual = 2.17e-01           smallest_sin_value = 9.92e-01
davidson iteration   72:   krylov dim =  73   energy =     -16.721942572132       residual = 4.59e+00           smallest_sin_value = 9.92e-01
davidson iteration   73:   krylov dim =  74   energy =     -17.039192039466       residual = 2.20e+00           smallest_sin_value = 9.91e-01
davidson iteration   74:   krylov dim =  75   energy =     -16.709546983033       residual = 5.29e+00           smallest_sin_value = 9.91e-01
davidson iteration   75 stopping due to small subspace S singular value of 9.63e-01
davidson solver did not converge after         75 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3087e+11 is 8.669578e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.546696 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7629e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -16.9438
    reference variance = 0.23685
====================================================
  Execution time = 2.1010e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2996e-01
  Total weights = 1.9516e+06
  Execution time = 1.8636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320240504164
                                         uncertainty =       0.002120461125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320240504164
                                         uncertainty =       0.002120461125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400128667
  error estimate for blocks of size 2^( 2) =       0.000412888434
  error estimate for blocks of size 2^( 3) =       0.000425965897
  error estimate for blocks of size 2^( 4) =       0.000438881524
  error estimate for blocks of size 2^( 5) =       0.000448925089
  error estimate for blocks of size 2^( 6) =       0.000456255854
  error estimate for blocks of size 2^( 7) =       0.000459632083

      target function =                  N/A
              le_mean =     -16.905642152770
             les_mean =     286.130696993194
             stat err =       0.000450923637
             autocorr =       1.270008620607
              std dev =       0.565867387465
             le_variance =       0.320205900197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320240504164
                                         uncertainty =       0.002120461125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320240504164
                                         uncertainty =       0.002120461125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400128667
  error estimate for blocks of size 2^( 2) =       0.000412888434
  error estimate for blocks of size 2^( 3) =       0.000425965897
  error estimate for blocks of size 2^( 4) =       0.000438881524
  error estimate for blocks of size 2^( 5) =       0.000448925089
  error estimate for blocks of size 2^( 6) =       0.000456255854
  error estimate for blocks of size 2^( 7) =       0.000459632083

      target function =                  N/A
              le_mean =     -16.905642152770
             les_mean =     286.130696993193
             stat err =       0.000450923637
             autocorr =       1.270008620614
              std dev =       0.565867387465
             le_variance =       0.320205900197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320240504164
                                         uncertainty =       0.002120461125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320240504164
                                         uncertainty =       0.002120461125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400128667
  error estimate for blocks of size 2^( 2) =       0.000412888434
  error estimate for blocks of size 2^( 3) =       0.000425965897
  error estimate for blocks of size 2^( 4) =       0.000438881524
  error estimate for blocks of size 2^( 5) =       0.000448925089
  error estimate for blocks of size 2^( 6) =       0.000456255854
  error estimate for blocks of size 2^( 7) =       0.000459632083

      target function =                  N/A
              le_mean =     -16.905642152770
             les_mean =     286.130696993193
             stat err =       0.000450923637
             autocorr =       1.270008620614
              std dev =       0.565867387465
             le_variance =       0.320205900197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320240504164
                                         uncertainty =       0.002120461125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320240504164
                                         uncertainty =       0.002120461125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400128667
  error estimate for blocks of size 2^( 2) =       0.000412888434
  error estimate for blocks of size 2^( 3) =       0.000425965897
  error estimate for blocks of size 2^( 4) =       0.000438881524
  error estimate for blocks of size 2^( 5) =       0.000448925089
  error estimate for blocks of size 2^( 6) =       0.000456255854
  error estimate for blocks of size 2^( 7) =       0.000459632083

      target function =                  N/A
              le_mean =     -16.905642152770
             les_mean =     286.130696993194
             stat err =       0.000450923637
             autocorr =       1.270008620608
              std dev =       0.565867387465
             le_variance =       0.320205900197


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905642152770        initial  <--
     2.0680e+10     2.0680e+11             1.3757e-14       -16.905642152770
     8.2718e+10     8.2718e+11             3.4765e-15       -16.905642152770
     3.3087e+11     3.3087e+12             8.6696e-16       -16.905642152770

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4875
  </log>
  <optVariables href="H2O.s089.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8123e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -16.9275
    reference variance = 0.150504
====================================================
  Execution time = 2.1344e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3402e-01
  Total weights = 1.952031735e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1099e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322700078330
                                         uncertainty =       0.002306774043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322700078330
                                         uncertainty =       0.002306774043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401759194
  error estimate for blocks of size 2^( 2) =       0.000414321888
  error estimate for blocks of size 2^( 3) =       0.000427469723
  error estimate for blocks of size 2^( 4) =       0.000440548672
  error estimate for blocks of size 2^( 5) =       0.000452120485
  error estimate for blocks of size 2^( 6) =       0.000460165720
  error estimate for blocks of size 2^( 7) =       0.000465309679

      target function =                  N/A
              le_mean =     -16.906109932887
             les_mean =     286.150577252976
             stat err =       0.000454536139
             autocorr =       1.279985908539
              std dev =       0.568173301013
             le_variance =       0.322820899984


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690610993289e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0680e+11, overlap shift 2.0680e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906109932881       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906109932881       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906109932881       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906109932881       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906108955761       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906160430016       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906032090480       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906076207387       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906125519709       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905645989837       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.907115632143       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904116927617       residual = 5.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906585231261       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906329485688       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909622626614       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905361641781       residual = 9.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909247580118       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905336258603       residual = 9.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905750172661       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.908417374710       residual = 7.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.909277453408       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.912783270386       residual = 6.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.911507908419       residual = 3.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.904311511888       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.912609414898       residual = 5.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.906976984278       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.905519653240       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.903347585276       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.897447202273       residual = 9.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.904046997916       residual = 6.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.911201294459       residual = 3.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.909805881536       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.882702077816       residual = 7.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.868328456775       residual = 1.82e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.895926530559       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.917678354632       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.907216589321       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.887307882369       residual = 5.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.922131021538       residual = 3.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.915660787836       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.902712029973       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.905302315556       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -16.915182503439       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.895646773665       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.905622737948       residual = 8.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.887747430026       residual = 4.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.943755338209       residual = 1.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -16.888731646556       residual = 4.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.908578922465       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.855072710081       residual = 3.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.878066005710       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.925434356087       residual = 4.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.845419531736       residual = 4.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -16.919186937106       residual = 2.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -16.910702875826       residual = 3.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -16.918259521874       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -16.901559077286       residual = 3.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -16.889018638507       residual = 4.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -16.923431249548       residual = 4.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   energy =     -16.902640366145       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   energy =     -16.902192079086       residual = 9.90e-03           smallest_sin_value = 9.99e-01
davidson iteration   61:   krylov dim =  62   energy =     -16.918463059644       residual = 2.16e-02           smallest_sin_value = 9.99e-01
davidson iteration   62:   krylov dim =  63   energy =     -16.911976541729       residual = 5.65e-03           smallest_sin_value = 9.98e-01
davidson iteration   63:   krylov dim =  64   energy =     -16.903617622886       residual = 7.89e-03           smallest_sin_value = 9.97e-01
davidson iteration   64:   krylov dim =  65   energy =     -16.915152198337       residual = 1.33e-02           smallest_sin_value = 9.96e-01
davidson iteration   65 stopping due to small subspace S singular value of 9.76e-01
davidson solver did not converge after         65 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.0680e+11 is 2.360906e-15

solving harmonic davidson linear method for identity shift 8.2718e+11, overlap shift 8.2718e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906109932881       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906109932881       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906109932881       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906109932881       residual = 8.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906117035727       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910011961884       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906016240950       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904146830089       residual = 5.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905021533914       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907042199528       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.897681047542       residual = 9.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909011260280       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.893359510724       residual = 2.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910935729139       residual = 3.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.896477153437       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.896907046540       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909232589206       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.898696327307       residual = 9.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.960586340353       residual = 3.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.913745780476       residual = 8.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.884251019031       residual = 6.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.930921519705       residual = 8.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.896275137277       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.874425840690       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.926302763944       residual = 5.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.904265740321       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.885305507107       residual = 6.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.896292130576       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.901992015447       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.863206376744       residual = 2.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.874816637854       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.885449413789       residual = 6.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.883841701463       residual = 6.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.919877992378       residual = 2.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.884020976928       residual = 8.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.942271787149       residual = 1.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.923447158712       residual = 6.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.930044252895       residual = 9.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.957106816497       residual = 3.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.898067434414       residual = 2.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.925415706601       residual = 6.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.918195404599       residual = 4.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -16.850011759475       residual = 4.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.916651202421       residual = 4.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.920344478420       residual = 8.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.950345967299       residual = 2.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.927697783586       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -16.934029883901       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.864739506929       residual = 2.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.910512062315       residual = 5.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.851313431869       residual = 4.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.958000890564       residual = 3.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.897134674849       residual = 1.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -16.552977029226       residual = 1.47e+01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -16.805300743014       residual = 1.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -16.932629821928       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -16.860687554777       residual = 3.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -16.906565224353       residual = 3.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -16.944130638853       residual = 3.00e-01           smallest_sin_value = 9.99e-01
davidson iteration   59:   krylov dim =  60   energy =     -16.771200304460       residual = 2.47e+00           smallest_sin_value = 9.99e-01
davidson iteration   60:   krylov dim =  61   energy =     -16.866622758138       residual = 2.60e-01           smallest_sin_value = 9.98e-01
davidson iteration   61:   krylov dim =  62   energy =     -17.001280660150       residual = 1.41e+00           smallest_sin_value = 9.94e-01
davidson iteration   62:   krylov dim =  63   energy =     -16.874637756411       residual = 3.19e-01           smallest_sin_value = 9.92e-01
davidson iteration   63 stopping due to small subspace S singular value of 9.70e-01
davidson solver did not converge after         63 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.2718e+11 is 5.508577e-16

solving harmonic davidson linear method for identity shift 3.3087e+12, overlap shift 3.3087e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906109932881       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906109932881       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906109932881       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906109932881       residual = 9.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905231756012       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908445057996       residual = 8.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.919029345478       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907720617737       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.864147816978       residual = 2.35e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.890152347187       residual = 3.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.930213055025       residual = 7.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.855055325230       residual = 3.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.978677575448       residual = 6.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.849102974644       residual = 4.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.978326554308       residual = 7.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.736128916171       residual = 3.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.908345528056       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.766483909538       residual = 2.62e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.914534452406       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.895746528237       residual = 2.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.823933260342       residual = 9.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.120675665295       residual = 5.87e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.921987824095       residual = 6.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.910179046789       residual = 6.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.569290029533       residual = 5.86e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.878249862668       residual = 1.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.879919074137       residual = 2.96e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.002875528802       residual = 1.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.031016895189       residual = 2.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.766012923815       residual = 2.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.310554837866       residual = 2.12e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.947674921066       residual = 2.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.399885384971       residual = 3.27e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.434239592177       residual = 3.01e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.942000675638       residual = 2.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.809598275618       residual = 1.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.062232117734       residual = 3.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.509545898754       residual = 2.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.850185582781       residual = 6.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.017724166914       residual = 1.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.193108525721       residual = 1.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.907778514396       residual = 5.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -16.259690398236       residual = 5.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.086752568716       residual = 4.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.778270237757       residual = 3.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.298176128804       residual = 2.01e+01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.161013578405       residual = 9.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.011226944495       residual = 2.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.939064546055       residual = 6.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.941190718682       residual = 3.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.837679342939       residual = 8.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.969456245582       residual = 2.20e+00           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   energy =     -17.042367223041       residual = 2.84e+00           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   energy =     -17.111089718465       residual = 5.90e+00           smallest_sin_value = 9.99e-01
davidson iteration   54:   krylov dim =  55   energy =     -16.960115136586       residual = 1.57e+00           smallest_sin_value = 9.99e-01
davidson iteration   55:   krylov dim =  56   energy =     -16.692374386083       residual = 6.51e+00           smallest_sin_value = 9.99e-01
davidson iteration   56:   krylov dim =  57   energy =     -16.784433252042       residual = 4.38e+00           smallest_sin_value = 9.98e-01
davidson iteration   57:   krylov dim =  58   energy =     -16.950814129379       residual = 1.77e+00           smallest_sin_value = 9.96e-01
davidson iteration   58:   krylov dim =  59   energy =     -16.475498321479       residual = 2.71e+01           smallest_sin_value = 9.94e-01
davidson iteration   59 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         59 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3087e+12 is 1.377144e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.827828 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7739e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -16.93
    reference variance = 0.518788
====================================================
  Execution time = 2.0953e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4337e-01
  Total weights = 1.9517e+06
  Execution time = 1.8759e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327731287224
                                         uncertainty =       0.005069183008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327731287224
                                         uncertainty =       0.005069183008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404816984
  error estimate for blocks of size 2^( 2) =       0.000417135202
  error estimate for blocks of size 2^( 3) =       0.000429978471
  error estimate for blocks of size 2^( 4) =       0.000442252008
  error estimate for blocks of size 2^( 5) =       0.000450905362
  error estimate for blocks of size 2^( 6) =       0.000457773590
  error estimate for blocks of size 2^( 7) =       0.000459242796

      target function =                  N/A
              le_mean =     -16.905390427470
             les_mean =     286.135595230410
             stat err =       0.000452543439
             autocorr =       1.249692306221
              std dev =       0.572497668687
             le_variance =       0.327753580652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327731287224
                                         uncertainty =       0.005069183008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327731287224
                                         uncertainty =       0.005069183008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404816984
  error estimate for blocks of size 2^( 2) =       0.000417135202
  error estimate for blocks of size 2^( 3) =       0.000429978471
  error estimate for blocks of size 2^( 4) =       0.000442252008
  error estimate for blocks of size 2^( 5) =       0.000450905362
  error estimate for blocks of size 2^( 6) =       0.000457773590
  error estimate for blocks of size 2^( 7) =       0.000459242796

      target function =                  N/A
              le_mean =     -16.905390427470
             les_mean =     286.135595230410
             stat err =       0.000452543439
             autocorr =       1.249692306219
              std dev =       0.572497668687
             le_variance =       0.327753580652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327731287224
                                         uncertainty =       0.005069183008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327731287224
                                         uncertainty =       0.005069183008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404816984
  error estimate for blocks of size 2^( 2) =       0.000417135202
  error estimate for blocks of size 2^( 3) =       0.000429978471
  error estimate for blocks of size 2^( 4) =       0.000442252008
  error estimate for blocks of size 2^( 5) =       0.000450905362
  error estimate for blocks of size 2^( 6) =       0.000457773590
  error estimate for blocks of size 2^( 7) =       0.000459242796

      target function =                  N/A
              le_mean =     -16.905390427470
             les_mean =     286.135595230410
             stat err =       0.000452543439
             autocorr =       1.249692306221
              std dev =       0.572497668687
             le_variance =       0.327753580652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327731287224
                                         uncertainty =       0.005069183008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327731287224
                                         uncertainty =       0.005069183008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404816984
  error estimate for blocks of size 2^( 2) =       0.000417135202
  error estimate for blocks of size 2^( 3) =       0.000429978471
  error estimate for blocks of size 2^( 4) =       0.000442252008
  error estimate for blocks of size 2^( 5) =       0.000450905362
  error estimate for blocks of size 2^( 6) =       0.000457773590
  error estimate for blocks of size 2^( 7) =       0.000459242796

      target function =                  N/A
              le_mean =     -16.905390427470
             les_mean =     286.135595230410
             stat err =       0.000452543439
             autocorr =       1.249692306222
              std dev =       0.572497668687
             le_variance =       0.327753580652


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905390427470        initial  <--
     2.0680e+11     2.0680e+12             2.3609e-15       -16.905390427470
     8.2718e+11     8.2718e+12             5.5086e-16       -16.905390427470
     3.3087e+12     3.3087e+13             1.3771e-16       -16.905390427470

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5074
  </log>
  <optVariables href="H2O.s090.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8253e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -16.9376
    reference variance = 0.223355
====================================================
  Execution time = 2.1768e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3764e-01
  Total weights = 1.951754292e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0817e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324839150784
                                         uncertainty =       0.002411082190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324839150784
                                         uncertainty =       0.002411082190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403067303
  error estimate for blocks of size 2^( 2) =       0.000416016891
  error estimate for blocks of size 2^( 3) =       0.000428798846
  error estimate for blocks of size 2^( 4) =       0.000440277862
  error estimate for blocks of size 2^( 5) =       0.000450196147
  error estimate for blocks of size 2^( 6) =       0.000458479624
  error estimate for blocks of size 2^( 7) =       0.000461655655

      target function =                  N/A
              le_mean =     -16.906572825222
             les_mean =     286.169849472003
             stat err =       0.000452652322
             autocorr =       1.261172129964
              std dev =       0.570023247152
             le_variance =       0.324926502294


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690657282522e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0680e+12, overlap shift 2.0680e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906572825228       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906572825228       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906572825228       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906630052995       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908188557972       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906481888980       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907437462135       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.919542655984       residual = 2.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906977730010       residual = 6.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.899505227318       residual = 7.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.919944800213       residual = 2.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.928528435215       residual = 6.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.847438266930       residual = 4.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.927233415490       residual = 5.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.873906844882       residual = 1.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.884431798669       residual = 6.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.943933036639       residual = 1.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.935269615801       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.993816405894       residual = 1.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.886755400719       residual = 4.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.008148640975       residual = 1.68e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.045082482340       residual = 2.79e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.972210302074       residual = 7.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.115769083886       residual = 5.87e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.162323744175       residual = 9.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.924940823434       residual = 1.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.816066499209       residual = 1.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.932787886479       residual = 1.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.918483378879       residual = 5.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.031930925739       residual = 2.43e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.842520156809       residual = 5.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.076378305555       residual = 4.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.109725881389       residual = 6.91e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.972424430441       residual = 8.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.087691758846       residual = 5.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.824044364927       residual = 7.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.895354335221       residual = 2.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.991015974004       residual = 1.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.845244602285       residual = 1.00e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.771933852645       residual = 1.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.850949237330       residual = 1.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.676519339815       residual = 5.68e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.189926068854       residual = 1.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.971698111197       residual = 7.96e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.789985213230       residual = 1.91e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.652819393230       residual = 8.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.937083183133       residual = 2.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -16.765149253529       residual = 2.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.832468177448       residual = 1.91e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.757119905635       residual = 3.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.690681857897       residual = 5.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.678377372876       residual = 8.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.818830017535       residual = 1.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -16.725291164507       residual = 4.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -16.920824034855       residual = 1.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -16.857316280642       residual = 4.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -17.269960153786       residual = 1.98e+01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -16.883030763985       residual = 2.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -16.745190993708       residual = 3.56e+00           smallest_sin_value = 9.99e-01
davidson iteration   59:   krylov dim =  60   energy =     -16.701774199523       residual = 5.76e+00           smallest_sin_value = 9.99e-01
davidson iteration   60:   krylov dim =  61   energy =     -16.511196700594       residual = 2.23e+01           smallest_sin_value = 9.99e-01
davidson iteration   61:   krylov dim =  62   energy =     -17.008992507441       residual = 1.27e+00           smallest_sin_value = 9.99e-01
davidson iteration   62:   krylov dim =  63   energy =     -17.041960722701       residual = 2.92e+00           smallest_sin_value = 9.98e-01
davidson iteration   63:   krylov dim =  64   energy =     -16.707098676414       residual = 4.93e+00           smallest_sin_value = 9.95e-01
davidson iteration   64:   krylov dim =  65   energy =     -16.962977162316       residual = 6.85e-01           smallest_sin_value = 9.93e-01
davidson iteration   65 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         65 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.0680e+12 is 1.878112e-16

solving harmonic davidson linear method for identity shift 8.2718e+12, overlap shift 8.2718e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906572825228       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906572825228       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906572825228       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906572825228       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.900860390929       residual = 5.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909343504448       residual = 4.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.927418542279       residual = 5.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908932740339       residual = 6.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908286113420       residual = 7.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.790723033139       residual = 1.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.870650841140       residual = 1.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909941121116       residual = 5.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.882875645572       residual = 1.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.026074387946       residual = 2.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.832405705964       residual = 7.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.000546504642       residual = 1.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.800476041546       residual = 1.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.941014355411       residual = 1.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.915712792019       residual = 5.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.888621180228       residual = 2.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.007801132861       residual = 1.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905974675532       residual = 3.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.729946471547       residual = 5.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.357696749202       residual = 3.77e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.733775005023       residual = 3.73e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -15.626234918884       residual = 2.15e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.560438695285       residual = 1.60e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.529700730449       residual = 4.91e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.250816369680       residual = 1.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.702404880436       residual = 7.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -18.180547338235       residual = 2.38e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.496561686862       residual = 2.37e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.521905825640       residual = 2.92e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.627903149608       residual = 7.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.351439890890       residual = 3.00e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.769574459117       residual = 5.87e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -18.408694849547       residual = 3.31e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.113551412123       residual = 3.00e+01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -15.691563299166       residual = 1.87e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.909814505882       residual = 1.45e+02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.534570752984       residual = 4.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.891675770029       residual = 1.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -20.195914097716       residual = 1.39e+03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -19.303229205898       residual = 8.10e+02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -18.572434265688       residual = 4.15e+02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -18.897634817243       residual = 5.68e+02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.106298965245       residual = 2.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -15.849087423770       residual = 1.58e+02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -15.395457341606       residual = 3.23e+02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -18.247496247926       residual = 2.57e+02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -15.614317814940       residual = 2.37e+02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -17.314882647290       residual = 2.62e+01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -18.448812927537       residual = 2.94e+02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.338730282758       residual = 2.98e+01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -13.364345079789       residual = 1.71e+03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -14.365462597698       residual = 8.77e+02           smallest_sin_value = 9.99e-01
davidson iteration   56:   krylov dim =  57   energy =     -16.574676267958       residual = 3.08e+01           smallest_sin_value = 9.98e-01
davidson iteration   57:   krylov dim =  58   energy =     -17.746870954707       residual = 1.05e+02           smallest_sin_value = 9.96e-01
davidson iteration   58 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         58 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.2718e+12 is 4.687452e-17

solving harmonic davidson linear method for identity shift 3.3087e+13, overlap shift 3.3087e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906572825228       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906572825228       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906572825228       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3087e+13 is 1.031811e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.013164 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8039e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -16.9143
    reference variance = 0.237383
====================================================
  Execution time = 2.1191e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4419e-01
  Total weights = 1.9518e+06
  Execution time = 1.8760e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323379194741
                                         uncertainty =       0.004003422405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323379194741
                                         uncertainty =       0.004003422405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402063377
  error estimate for blocks of size 2^( 2) =       0.000414574602
  error estimate for blocks of size 2^( 3) =       0.000427956874
  error estimate for blocks of size 2^( 4) =       0.000440307112
  error estimate for blocks of size 2^( 5) =       0.000450044444
  error estimate for blocks of size 2^( 6) =       0.000457973164
  error estimate for blocks of size 2^( 7) =       0.000463954216

      target function =                  N/A
              le_mean =     -16.905554991031
             les_mean =     286.141982972366
             stat err =       0.000453069734
             autocorr =       1.269816806008
              std dev =       0.568603480831
             le_variance =       0.323309918413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323379194741
                                         uncertainty =       0.004003422405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323379194741
                                         uncertainty =       0.004003422405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402063377
  error estimate for blocks of size 2^( 2) =       0.000414574602
  error estimate for blocks of size 2^( 3) =       0.000427956874
  error estimate for blocks of size 2^( 4) =       0.000440307112
  error estimate for blocks of size 2^( 5) =       0.000450044444
  error estimate for blocks of size 2^( 6) =       0.000457973164
  error estimate for blocks of size 2^( 7) =       0.000463954216

      target function =                  N/A
              le_mean =     -16.905554991031
             les_mean =     286.141982972366
             stat err =       0.000453069734
             autocorr =       1.269816806007
              std dev =       0.568603480831
             le_variance =       0.323309918413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323379194741
                                         uncertainty =       0.004003422405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323379194741
                                         uncertainty =       0.004003422405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402063377
  error estimate for blocks of size 2^( 2) =       0.000414574602
  error estimate for blocks of size 2^( 3) =       0.000427956874
  error estimate for blocks of size 2^( 4) =       0.000440307112
  error estimate for blocks of size 2^( 5) =       0.000450044444
  error estimate for blocks of size 2^( 6) =       0.000457973164
  error estimate for blocks of size 2^( 7) =       0.000463954216

      target function =                  N/A
              le_mean =     -16.905554991031
             les_mean =     286.141982972366
             stat err =       0.000453069734
             autocorr =       1.269816806008
              std dev =       0.568603480831
             le_variance =       0.323309918413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323379194741
                                         uncertainty =       0.004003422405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323379194741
                                         uncertainty =       0.004003422405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402063377
  error estimate for blocks of size 2^( 2) =       0.000414574602
  error estimate for blocks of size 2^( 3) =       0.000427956874
  error estimate for blocks of size 2^( 4) =       0.000440307112
  error estimate for blocks of size 2^( 5) =       0.000450044444
  error estimate for blocks of size 2^( 6) =       0.000457973164
  error estimate for blocks of size 2^( 7) =       0.000463954216

      target function =                  N/A
              le_mean =     -16.905554991031
             les_mean =     286.141982972366
             stat err =       0.000453069734
             autocorr =       1.269816806007
              std dev =       0.568603480831
             le_variance =       0.323309918413


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905554991031        initial
     2.0680e+12     2.0680e+13             1.8781e-16       -16.905554991031
     8.2718e+12     8.2718e+13             4.6875e-17       -16.905554991031
     3.3087e+13     3.3087e+14             1.0318e-17       -16.905554991031  <--

*****************************************************************************
Applying the update for shift_i =   3.3087e+13     and shift_s =   3.3087e+14
*****************************************************************************

  Execution time = 3.0756e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8801e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.0131
    reference variance = 0.242223
====================================================
  Execution time = 2.1482e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5248e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3280e-01
  Total weights = 1.951953594e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0620e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319219904728
                                         uncertainty =       0.001853418166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319219904728
                                         uncertainty =       0.001853418166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399549553
  error estimate for blocks of size 2^( 2) =       0.000412666739
  error estimate for blocks of size 2^( 3) =       0.000425978097
  error estimate for blocks of size 2^( 4) =       0.000438136210
  error estimate for blocks of size 2^( 5) =       0.000448124764
  error estimate for blocks of size 2^( 6) =       0.000455766143
  error estimate for blocks of size 2^( 7) =       0.000460707408

      target function =                  N/A
              le_mean =     -16.905744419224
             les_mean =     286.136997812447
             stat err =       0.000450683631
             autocorr =       1.272337335876
              std dev =       0.565048396699
             le_variance =       0.319279690612


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574441922e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+12, overlap shift 8.2718e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905744419223       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905744419223       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.2718e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.3087e+13, overlap shift 3.3087e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905744419223       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905744419223       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3087e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.3235e+14, overlap shift 1.3235e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905744419223       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905744419223       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3235e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.014315 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7549e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -16.8811
    reference variance = 0.291885
====================================================
  Execution time = 2.1352e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3337e-01
  Total weights = 1.9517e+06
  Execution time = 1.8780e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319469100689
                                         uncertainty =       0.002071886345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319469100689
                                         uncertainty =       0.002071886345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399687372
  error estimate for blocks of size 2^( 2) =       0.000412478190
  error estimate for blocks of size 2^( 3) =       0.000425653411
  error estimate for blocks of size 2^( 4) =       0.000438328885
  error estimate for blocks of size 2^( 5) =       0.000448221001
  error estimate for blocks of size 2^( 6) =       0.000456724972
  error estimate for blocks of size 2^( 7) =       0.000461773348

      target function =                  N/A
              le_mean =     -16.905600227768
             les_mean =     286.132690088374
             stat err =       0.000451262051
             autocorr =       1.274725788534
              std dev =       0.565243302656
             le_variance =       0.319499991197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319469100689
                                         uncertainty =       0.002071886345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319469100689
                                         uncertainty =       0.002071886345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399687372
  error estimate for blocks of size 2^( 2) =       0.000412478190
  error estimate for blocks of size 2^( 3) =       0.000425653411
  error estimate for blocks of size 2^( 4) =       0.000438328885
  error estimate for blocks of size 2^( 5) =       0.000448221001
  error estimate for blocks of size 2^( 6) =       0.000456724972
  error estimate for blocks of size 2^( 7) =       0.000461773348

      target function =                  N/A
              le_mean =     -16.905600227768
             les_mean =     286.132690088374
             stat err =       0.000451262051
             autocorr =       1.274725788534
              std dev =       0.565243302656
             le_variance =       0.319499991197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319469100689
                                         uncertainty =       0.002071886345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319469100689
                                         uncertainty =       0.002071886345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399687372
  error estimate for blocks of size 2^( 2) =       0.000412478190
  error estimate for blocks of size 2^( 3) =       0.000425653411
  error estimate for blocks of size 2^( 4) =       0.000438328885
  error estimate for blocks of size 2^( 5) =       0.000448221001
  error estimate for blocks of size 2^( 6) =       0.000456724972
  error estimate for blocks of size 2^( 7) =       0.000461773348

      target function =                  N/A
              le_mean =     -16.905600227768
             les_mean =     286.132690088374
             stat err =       0.000451262051
             autocorr =       1.274725788534
              std dev =       0.565243302656
             le_variance =       0.319499991197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319469100689
                                         uncertainty =       0.002071886345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319469100689
                                         uncertainty =       0.002071886345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399687372
  error estimate for blocks of size 2^( 2) =       0.000412478190
  error estimate for blocks of size 2^( 3) =       0.000425653411
  error estimate for blocks of size 2^( 4) =       0.000438328885
  error estimate for blocks of size 2^( 5) =       0.000448221001
  error estimate for blocks of size 2^( 6) =       0.000456724972
  error estimate for blocks of size 2^( 7) =       0.000461773348

      target function =                  N/A
              le_mean =     -16.905600227768
             les_mean =     286.132690088374
             stat err =       0.000451262051
             autocorr =       1.274725788534
              std dev =       0.565243302656
             le_variance =       0.319499991197


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905600227768        initial  <--
     8.2718e+12     8.2718e+13             0.0000e+00       -16.905600227768
     3.3087e+13     3.3087e+14             0.0000e+00       -16.905600227768
     1.3235e+14     1.3235e+15             0.0000e+00       -16.905600227768

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8939
  </log>
  <optVariables href="H2O.s092.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8449e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -16.8771
    reference variance = 0.271071
====================================================
  Execution time = 2.3420e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2816e-01
  Total weights = 1.952079139e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9829e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318011093909
                                         uncertainty =       0.001880652469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318011093909
                                         uncertainty =       0.001880652469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398779577
  error estimate for blocks of size 2^( 2) =       0.000411913682
  error estimate for blocks of size 2^( 3) =       0.000425226159
  error estimate for blocks of size 2^( 4) =       0.000437447741
  error estimate for blocks of size 2^( 5) =       0.000447909383
  error estimate for blocks of size 2^( 6) =       0.000456897736
  error estimate for blocks of size 2^( 7) =       0.000461461433

      target function =                  N/A
              le_mean =     -16.906093819456
             les_mean =     286.144169250228
             stat err =       0.000450929073
             autocorr =       1.278646976973
              std dev =       0.563959486667
             le_variance =       0.318050302602


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690609381946e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+13, overlap shift 8.2718e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906093819439       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906093819439       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906093819439       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.949138796828       residual = 4.29e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.782652657296       residual = 2.31e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.505552775056       residual = 4.69e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.845268402372       residual = 6.38e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.559412825695       residual = 1.48e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.301672040087       residual = 4.84e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.811165476317       residual = 1.13e+02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.608643965234       residual = 1.18e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.691133272272       residual = 6.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.490770769200       residual = 4.46e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -13.713062340463       residual = 1.31e+03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -19.080082598409       residual = 6.71e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -18.826935058388       residual = 5.10e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.329835767165       residual = 9.27e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.631443428927       residual = 6.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.726344950027       residual = 2.74e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -14.114437935665       residual = 1.02e+03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.666550232808       residual = 1.54e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -15.673573432534       residual = 1.96e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.632212681411       residual = 1.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -14.472571434070       residual = 9.13e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -15.064617327317       residual = 4.16e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.855375483999       residual = 1.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -14.040984924047       residual = 1.27e+03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -13.177489716012       residual = 1.74e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -21.818335639599       residual = 2.86e+03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -19.956304871868       residual = 1.15e+03           smallest_sin_value = 1.00e+00
davidson iteration   30 stopping due to too large eigenvalue change
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.2718e+13 is 5.147482e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.3087e+14, overlap shift 3.3087e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906093819439       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906093819439       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906093819439       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.840582646719       residual = 1.10e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906093819448       residual = 2.98e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.623656342086       residual = 1.20e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.762411008240       residual = 9.58e+01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.988749270409       residual = 5.24e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.099362460063       residual = 1.62e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.160862836884       residual = 7.41e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.288492651534       residual = 2.64e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -15.932209351080       residual = 1.36e+02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -15.876335468427       residual = 1.56e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -18.897738338656       residual = 5.44e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.407973573155       residual = 1.33e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.840466984658       residual = 7.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -19.011300825830       residual = 7.36e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -20.129422144239       residual = 1.31e+03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =      -9.526940791549       residual = 7.20e+03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -25.021282295926       residual = 9.43e+03           smallest_sin_value = 1.00e+00
davidson iteration   20 stopping due to too large eigenvalue change
davidson solver did not converge after         20 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3087e+14 is 1.286871e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.3235e+15, overlap shift 1.3235e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906093819439       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906093819439       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906093819439       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -15.897548463969       residual = 1.14e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906093819443       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.487962295987       residual = 4.50e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -18.818975743972       residual = 7.46e+02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -13.410482233880       residual = 1.78e+03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -20.684954086727       residual = 1.52e+03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.957933666364       residual = 2.13e+02           smallest_sin_value = 1.00e+00
davidson iteration   10 stopping due to too large eigenvalue change
davidson solver did not converge after         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3235e+15 is 3.315761e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.034378 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9427e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -16.9253
    reference variance = 0.31453
====================================================
  Execution time = 2.0941e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3715e-01
  Total weights = 1.9516e+06
  Execution time = 1.8746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322863051558
                                         uncertainty =       0.003425564676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322863051558
                                         uncertainty =       0.003425564676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401842340
  error estimate for blocks of size 2^( 2) =       0.000414918713
  error estimate for blocks of size 2^( 3) =       0.000427738805
  error estimate for blocks of size 2^( 4) =       0.000439733808
  error estimate for blocks of size 2^( 5) =       0.000450043631
  error estimate for blocks of size 2^( 6) =       0.000457218726
  error estimate for blocks of size 2^( 7) =       0.000460913847

      target function =                  N/A
              le_mean =     -16.907019861434
             les_mean =     286.184466741932
             stat err =       0.000451977503
             autocorr =       1.265092407284
              std dev =       0.568290886853
             le_variance =       0.322954532080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322863051558
                                         uncertainty =       0.003425564676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322863051558
                                         uncertainty =       0.003425564676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401842340
  error estimate for blocks of size 2^( 2) =       0.000414918713
  error estimate for blocks of size 2^( 3) =       0.000427738805
  error estimate for blocks of size 2^( 4) =       0.000439733808
  error estimate for blocks of size 2^( 5) =       0.000450043631
  error estimate for blocks of size 2^( 6) =       0.000457218726
  error estimate for blocks of size 2^( 7) =       0.000460913847

      target function =                  N/A
              le_mean =     -16.907019861434
             les_mean =     286.184466741932
             stat err =       0.000451977503
             autocorr =       1.265092407285
              std dev =       0.568290886853
             le_variance =       0.322954532080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322863051558
                                         uncertainty =       0.003425564676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322863051558
                                         uncertainty =       0.003425564676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401842340
  error estimate for blocks of size 2^( 2) =       0.000414918713
  error estimate for blocks of size 2^( 3) =       0.000427738805
  error estimate for blocks of size 2^( 4) =       0.000439733808
  error estimate for blocks of size 2^( 5) =       0.000450043631
  error estimate for blocks of size 2^( 6) =       0.000457218726
  error estimate for blocks of size 2^( 7) =       0.000460913847

      target function =                  N/A
              le_mean =     -16.907019861434
             les_mean =     286.184466741932
             stat err =       0.000451977503
             autocorr =       1.265092407283
              std dev =       0.568290886853
             le_variance =       0.322954532080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322863051558
                                         uncertainty =       0.003425564676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322863051558
                                         uncertainty =       0.003425564676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401842340
  error estimate for blocks of size 2^( 2) =       0.000414918713
  error estimate for blocks of size 2^( 3) =       0.000427738805
  error estimate for blocks of size 2^( 4) =       0.000439733808
  error estimate for blocks of size 2^( 5) =       0.000450043631
  error estimate for blocks of size 2^( 6) =       0.000457218726
  error estimate for blocks of size 2^( 7) =       0.000460913847

      target function =                  N/A
              le_mean =     -16.907019861434
             les_mean =     286.184466741932
             stat err =       0.000451977503
             autocorr =       1.265092407284
              std dev =       0.568290886853
             le_variance =       0.322954532080


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907019861434        initial  <--
     8.2718e+13     8.2718e+14             5.1475e-18       -16.907019861434
     3.3087e+14     3.3087e+15             1.2869e-18       -16.907019861434
     1.3235e+15     1.3235e+16             3.3158e-19       -16.907019861434

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4543
  </log>
  <optVariables href="H2O.s093.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9892e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -16.848
    reference variance = 0.20812
====================================================
  Execution time = 2.1060e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5219e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3178e-01
  Total weights = 1.951803887e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0735e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320331998533
                                         uncertainty =       0.001945833148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320331998533
                                         uncertainty =       0.001945833148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400271067
  error estimate for blocks of size 2^( 2) =       0.000413389575
  error estimate for blocks of size 2^( 3) =       0.000426459889
  error estimate for blocks of size 2^( 4) =       0.000438566681
  error estimate for blocks of size 2^( 5) =       0.000449826549
  error estimate for blocks of size 2^( 6) =       0.000456510082
  error estimate for blocks of size 2^( 7) =       0.000462057051

      target function =                  N/A
              le_mean =     -16.906608091933
             les_mean =     286.165179715034
             stat err =       0.000451740091
             autocorr =       1.273705054035
              std dev =       0.566068771287
             le_variance =       0.320433853826


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690660809193e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+14, overlap shift 8.2718e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906608091919       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906608091919       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.50e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.2718e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.3087e+15, overlap shift 3.3087e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906608091919       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906608091919       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.50e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3087e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.3235e+16, overlap shift 1.3235e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906608091919       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906608091919       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.50e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3235e+16 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.035491 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7139e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -16.8743
    reference variance = 0.590407
====================================================
  Execution time = 2.1291e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3342e-01
  Total weights = 1.9521e+06
  Execution time = 1.8705e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320494239889
                                         uncertainty =       0.002025760553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320494239889
                                         uncertainty =       0.002025760553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400318804
  error estimate for blocks of size 2^( 2) =       0.000413498463
  error estimate for blocks of size 2^( 3) =       0.000427021913
  error estimate for blocks of size 2^( 4) =       0.000439359304
  error estimate for blocks of size 2^( 5) =       0.000451239245
  error estimate for blocks of size 2^( 6) =       0.000458866331
  error estimate for blocks of size 2^( 7) =       0.000463199813

      target function =                  N/A
              le_mean =     -16.905418349727
             les_mean =     286.126586995276
             stat err =       0.000453166173
             autocorr =       1.281453900979
              std dev =       0.566136282190
             le_variance =       0.320510290012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320494239889
                                         uncertainty =       0.002025760553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320494239889
                                         uncertainty =       0.002025760553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400318804
  error estimate for blocks of size 2^( 2) =       0.000413498463
  error estimate for blocks of size 2^( 3) =       0.000427021913
  error estimate for blocks of size 2^( 4) =       0.000439359304
  error estimate for blocks of size 2^( 5) =       0.000451239245
  error estimate for blocks of size 2^( 6) =       0.000458866331
  error estimate for blocks of size 2^( 7) =       0.000463199813

      target function =                  N/A
              le_mean =     -16.905418349727
             les_mean =     286.126586995276
             stat err =       0.000453166173
             autocorr =       1.281453900979
              std dev =       0.566136282190
             le_variance =       0.320510290012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320494239889
                                         uncertainty =       0.002025760553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320494239889
                                         uncertainty =       0.002025760553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400318804
  error estimate for blocks of size 2^( 2) =       0.000413498463
  error estimate for blocks of size 2^( 3) =       0.000427021913
  error estimate for blocks of size 2^( 4) =       0.000439359304
  error estimate for blocks of size 2^( 5) =       0.000451239245
  error estimate for blocks of size 2^( 6) =       0.000458866331
  error estimate for blocks of size 2^( 7) =       0.000463199813

      target function =                  N/A
              le_mean =     -16.905418349727
             les_mean =     286.126586995276
             stat err =       0.000453166173
             autocorr =       1.281453900979
              std dev =       0.566136282190
             le_variance =       0.320510290012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320494239889
                                         uncertainty =       0.002025760553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320494239889
                                         uncertainty =       0.002025760553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400318804
  error estimate for blocks of size 2^( 2) =       0.000413498463
  error estimate for blocks of size 2^( 3) =       0.000427021913
  error estimate for blocks of size 2^( 4) =       0.000439359304
  error estimate for blocks of size 2^( 5) =       0.000451239245
  error estimate for blocks of size 2^( 6) =       0.000458866331
  error estimate for blocks of size 2^( 7) =       0.000463199813

      target function =                  N/A
              le_mean =     -16.905418349727
             les_mean =     286.126586995276
             stat err =       0.000453166173
             autocorr =       1.281453900979
              std dev =       0.566136282190
             le_variance =       0.320510290012


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905418349727        initial  <--
     8.2718e+14     8.2718e+15             0.0000e+00       -16.905418349727
     3.3087e+15     3.3087e+16             0.0000e+00       -16.905418349727
     1.3235e+16     1.3235e+17             0.0000e+00       -16.905418349727

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8033
  </log>
  <optVariables href="H2O.s094.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7948e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -16.9421
    reference variance = 0.27432
====================================================
  Execution time = 2.1404e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5242e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3371e-01
  Total weights = 1.951959890e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0403e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323124445011
                                         uncertainty =       0.002226471123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323124445011
                                         uncertainty =       0.002226471123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401908415
  error estimate for blocks of size 2^( 2) =       0.000414561803
  error estimate for blocks of size 2^( 3) =       0.000426991866
  error estimate for blocks of size 2^( 4) =       0.000438907347
  error estimate for blocks of size 2^( 5) =       0.000448933470
  error estimate for blocks of size 2^( 6) =       0.000456371578
  error estimate for blocks of size 2^( 7) =       0.000460606905

      target function =                  N/A
              le_mean =     -16.907350386808
             les_mean =     286.192211171060
             stat err =       0.000451204825
             autocorr =       1.260356113538
              std dev =       0.568384330621
             le_variance =       0.323060747296


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690735038681e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+15, overlap shift 8.2718e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907350386816       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907350386816       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.68e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.2718e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.3087e+16, overlap shift 3.3087e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907350386816       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907350386816       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3087e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.3235e+17, overlap shift 1.3235e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907350386816       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907350386816       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3235e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.036640 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7449e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -16.778
    reference variance = 0.180987
====================================================
  Execution time = 2.1154e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3387e-01
  Total weights = 1.9513e+06
  Execution time = 1.8788e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320768550963
                                         uncertainty =       0.002194845350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320768550963
                                         uncertainty =       0.002194845350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400542547
  error estimate for blocks of size 2^( 2) =       0.000413251108
  error estimate for blocks of size 2^( 3) =       0.000426332549
  error estimate for blocks of size 2^( 4) =       0.000438387444
  error estimate for blocks of size 2^( 5) =       0.000448326364
  error estimate for blocks of size 2^( 6) =       0.000455543476
  error estimate for blocks of size 2^( 7) =       0.000456464939

      target function =                  N/A
              le_mean =     -16.905720796354
             les_mean =     286.137261533266
             stat err =       0.000449680556
             autocorr =       1.260407292367
              std dev =       0.566452702727
             le_variance =       0.320868664426

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320768550963
                                         uncertainty =       0.002194845350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320768550963
                                         uncertainty =       0.002194845350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400542547
  error estimate for blocks of size 2^( 2) =       0.000413251108
  error estimate for blocks of size 2^( 3) =       0.000426332549
  error estimate for blocks of size 2^( 4) =       0.000438387444
  error estimate for blocks of size 2^( 5) =       0.000448326364
  error estimate for blocks of size 2^( 6) =       0.000455543476
  error estimate for blocks of size 2^( 7) =       0.000456464939

      target function =                  N/A
              le_mean =     -16.905720796354
             les_mean =     286.137261533266
             stat err =       0.000449680556
             autocorr =       1.260407292367
              std dev =       0.566452702727
             le_variance =       0.320868664426

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320768550963
                                         uncertainty =       0.002194845350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320768550963
                                         uncertainty =       0.002194845350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400542547
  error estimate for blocks of size 2^( 2) =       0.000413251108
  error estimate for blocks of size 2^( 3) =       0.000426332549
  error estimate for blocks of size 2^( 4) =       0.000438387444
  error estimate for blocks of size 2^( 5) =       0.000448326364
  error estimate for blocks of size 2^( 6) =       0.000455543476
  error estimate for blocks of size 2^( 7) =       0.000456464939

      target function =                  N/A
              le_mean =     -16.905720796354
             les_mean =     286.137261533266
             stat err =       0.000449680556
             autocorr =       1.260407292367
              std dev =       0.566452702727
             le_variance =       0.320868664426

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320768550963
                                         uncertainty =       0.002194845350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320768550963
                                         uncertainty =       0.002194845350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400542547
  error estimate for blocks of size 2^( 2) =       0.000413251108
  error estimate for blocks of size 2^( 3) =       0.000426332549
  error estimate for blocks of size 2^( 4) =       0.000438387444
  error estimate for blocks of size 2^( 5) =       0.000448326364
  error estimate for blocks of size 2^( 6) =       0.000455543476
  error estimate for blocks of size 2^( 7) =       0.000456464939

      target function =                  N/A
              le_mean =     -16.905720796354
             les_mean =     286.137261533266
             stat err =       0.000449680556
             autocorr =       1.260407292367
              std dev =       0.566452702727
             le_variance =       0.320868664426


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905720796354        initial  <--
     8.2718e+15     8.2718e+16             0.0000e+00       -16.905720796354
     3.3087e+16     3.3087e+17             0.0000e+00       -16.905720796354
     1.3235e+17     1.3235e+18             0.0000e+00       -16.905720796354

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6772
  </log>
  <optVariables href="H2O.s095.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8132e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -16.9046
    reference variance = 0.209376
====================================================
  Execution time = 2.1209e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3635e-01
  Total weights = 1.951928865e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1262e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324084032626
                                         uncertainty =       0.002414145436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324084032626
                                         uncertainty =       0.002414145436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402527262
  error estimate for blocks of size 2^( 2) =       0.000414958576
  error estimate for blocks of size 2^( 3) =       0.000427801114
  error estimate for blocks of size 2^( 4) =       0.000440526791
  error estimate for blocks of size 2^( 5) =       0.000450924432
  error estimate for blocks of size 2^( 6) =       0.000457598321
  error estimate for blocks of size 2^( 7) =       0.000462353347

      target function =                  N/A
              le_mean =     -16.905901425919
             les_mean =     286.145849206162
             stat err =       0.000452850723
             autocorr =       1.265667219538
              std dev =       0.569259513005
             le_variance =       0.324056393146


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690590142592e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+16, overlap shift 8.2718e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905901425930       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905901425930       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905901425930       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.2718e+16 is 4.774447e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.3087e+17, overlap shift 3.3087e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905901425930       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905901425930       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905901425930       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3087e+17 is 1.193612e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.3235e+18, overlap shift 1.3235e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905901425930       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905901425930       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905901425930       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3235e+18 is 2.984029e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.038066 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7341e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -16.9046
    reference variance = 0.320058
====================================================
  Execution time = 2.1028e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3496e-01
  Total weights = 1.9518e+06
  Execution time = 1.8815e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322574377240
                                         uncertainty =       0.002213127603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322574377240
                                         uncertainty =       0.002213127603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401596405
  error estimate for blocks of size 2^( 2) =       0.000414304849
  error estimate for blocks of size 2^( 3) =       0.000427489374
  error estimate for blocks of size 2^( 4) =       0.000439632010
  error estimate for blocks of size 2^( 5) =       0.000449328654
  error estimate for blocks of size 2^( 6) =       0.000455694983
  error estimate for blocks of size 2^( 7) =       0.000460731860

      target function =                  N/A
              le_mean =     -16.906071584260
             les_mean =     286.150213805613
             stat err =       0.000451346877
             autocorr =       1.263110226050
              std dev =       0.567943082000
             le_variance =       0.322559344392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322574377240
                                         uncertainty =       0.002213127603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322574377240
                                         uncertainty =       0.002213127603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401596405
  error estimate for blocks of size 2^( 2) =       0.000414304849
  error estimate for blocks of size 2^( 3) =       0.000427489374
  error estimate for blocks of size 2^( 4) =       0.000439632010
  error estimate for blocks of size 2^( 5) =       0.000449328654
  error estimate for blocks of size 2^( 6) =       0.000455694983
  error estimate for blocks of size 2^( 7) =       0.000460731860

      target function =                  N/A
              le_mean =     -16.906071584260
             les_mean =     286.150213805613
             stat err =       0.000451346877
             autocorr =       1.263110226050
              std dev =       0.567943082000
             le_variance =       0.322559344392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322574377240
                                         uncertainty =       0.002213127603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322574377240
                                         uncertainty =       0.002213127603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401596405
  error estimate for blocks of size 2^( 2) =       0.000414304849
  error estimate for blocks of size 2^( 3) =       0.000427489374
  error estimate for blocks of size 2^( 4) =       0.000439632010
  error estimate for blocks of size 2^( 5) =       0.000449328654
  error estimate for blocks of size 2^( 6) =       0.000455694983
  error estimate for blocks of size 2^( 7) =       0.000460731860

      target function =                  N/A
              le_mean =     -16.906071584260
             les_mean =     286.150213805613
             stat err =       0.000451346877
             autocorr =       1.263110226050
              std dev =       0.567943082000
             le_variance =       0.322559344392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322574377240
                                         uncertainty =       0.002213127603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322574377240
                                         uncertainty =       0.002213127603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401596405
  error estimate for blocks of size 2^( 2) =       0.000414304849
  error estimate for blocks of size 2^( 3) =       0.000427489374
  error estimate for blocks of size 2^( 4) =       0.000439632010
  error estimate for blocks of size 2^( 5) =       0.000449328654
  error estimate for blocks of size 2^( 6) =       0.000455694983
  error estimate for blocks of size 2^( 7) =       0.000460731860

      target function =                  N/A
              le_mean =     -16.906071584260
             les_mean =     286.150213805613
             stat err =       0.000451346877
             autocorr =       1.263110226050
              std dev =       0.567943082000
             le_variance =       0.322559344392


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906071584260        initial  <--
     8.2718e+16     8.2718e+17             4.7744e-21       -16.906071584260
     3.3087e+17     3.3087e+18             1.1936e-21       -16.906071584260
     1.3235e+18     1.3235e+19             2.9840e-22       -16.906071584260

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5484
  </log>
  <optVariables href="H2O.s096.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7895e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -16.9021
    reference variance = 0.176811
====================================================
  Execution time = 2.1259e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5220e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3873e-01
  Total weights = 1.951581335e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0283e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325027440136
                                         uncertainty =       0.003468034516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325027440136
                                         uncertainty =       0.003468034516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403158979
  error estimate for blocks of size 2^( 2) =       0.000416377668
  error estimate for blocks of size 2^( 3) =       0.000430172715
  error estimate for blocks of size 2^( 4) =       0.000443004724
  error estimate for blocks of size 2^( 5) =       0.000454982125
  error estimate for blocks of size 2^( 6) =       0.000465232517
  error estimate for blocks of size 2^( 7) =       0.000470764359

      target function =                  N/A
              le_mean =     -16.905259719805
             les_mean =     286.126536085009
             stat err =       0.000458495931
             autocorr =       1.293356647806
              std dev =       0.570152895442
             le_variance =       0.325074324181


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690525971981e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+17, overlap shift 8.2718e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905259719808       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905259719808       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.2718e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.3087e+18, overlap shift 3.3087e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905259719808       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905259719808       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3087e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.3235e+19, overlap shift 1.3235e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905259719808       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905259719808       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3235e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.039221 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7292e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.0417
    reference variance = 0.597238
====================================================
  Execution time = 2.1087e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3312e-01
  Total weights = 1.9515e+06
  Execution time = 1.8662e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321156400901
                                         uncertainty =       0.001556217749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321156400901
                                         uncertainty =       0.001556217749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400789679
  error estimate for blocks of size 2^( 2) =       0.000414097120
  error estimate for blocks of size 2^( 3) =       0.000427148732
  error estimate for blocks of size 2^( 4) =       0.000440317073
  error estimate for blocks of size 2^( 5) =       0.000450814302
  error estimate for blocks of size 2^( 6) =       0.000460819202
  error estimate for blocks of size 2^( 7) =       0.000465444103

      target function =                  N/A
              le_mean =     -16.906432349487
             les_mean =     286.160578984830
             stat err =       0.000454348670
             autocorr =       1.285125269598
              std dev =       0.566802200189
             le_variance =       0.321264734139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321156400901
                                         uncertainty =       0.001556217749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321156400901
                                         uncertainty =       0.001556217749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400789679
  error estimate for blocks of size 2^( 2) =       0.000414097120
  error estimate for blocks of size 2^( 3) =       0.000427148732
  error estimate for blocks of size 2^( 4) =       0.000440317073
  error estimate for blocks of size 2^( 5) =       0.000450814302
  error estimate for blocks of size 2^( 6) =       0.000460819202
  error estimate for blocks of size 2^( 7) =       0.000465444103

      target function =                  N/A
              le_mean =     -16.906432349487
             les_mean =     286.160578984830
             stat err =       0.000454348670
             autocorr =       1.285125269598
              std dev =       0.566802200189
             le_variance =       0.321264734139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321156400901
                                         uncertainty =       0.001556217749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321156400901
                                         uncertainty =       0.001556217749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400789679
  error estimate for blocks of size 2^( 2) =       0.000414097120
  error estimate for blocks of size 2^( 3) =       0.000427148732
  error estimate for blocks of size 2^( 4) =       0.000440317073
  error estimate for blocks of size 2^( 5) =       0.000450814302
  error estimate for blocks of size 2^( 6) =       0.000460819202
  error estimate for blocks of size 2^( 7) =       0.000465444103

      target function =                  N/A
              le_mean =     -16.906432349487
             les_mean =     286.160578984830
             stat err =       0.000454348670
             autocorr =       1.285125269598
              std dev =       0.566802200189
             le_variance =       0.321264734139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321156400901
                                         uncertainty =       0.001556217749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321156400901
                                         uncertainty =       0.001556217749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400789679
  error estimate for blocks of size 2^( 2) =       0.000414097120
  error estimate for blocks of size 2^( 3) =       0.000427148732
  error estimate for blocks of size 2^( 4) =       0.000440317073
  error estimate for blocks of size 2^( 5) =       0.000450814302
  error estimate for blocks of size 2^( 6) =       0.000460819202
  error estimate for blocks of size 2^( 7) =       0.000465444103

      target function =                  N/A
              le_mean =     -16.906432349487
             les_mean =     286.160578984830
             stat err =       0.000454348670
             autocorr =       1.285125269598
              std dev =       0.566802200189
             le_variance =       0.321264734139


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906432349487        initial  <--
     8.2718e+17     8.2718e+18             0.0000e+00       -16.906432349487
     3.3087e+18     3.3087e+19             0.0000e+00       -16.906432349487
     1.3235e+19     1.3235e+20             0.0000e+00       -16.906432349487

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5694
  </log>
  <optVariables href="H2O.s097.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7868e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -16.9204
    reference variance = 0.320471
====================================================
  Execution time = 2.3311e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3761e-01
  Total weights = 1.951915673e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2156e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323932405585
                                         uncertainty =       0.002548548345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323932405585
                                         uncertainty =       0.002548548345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402524352
  error estimate for blocks of size 2^( 2) =       0.000415488640
  error estimate for blocks of size 2^( 3) =       0.000429022335
  error estimate for blocks of size 2^( 4) =       0.000442341547
  error estimate for blocks of size 2^( 5) =       0.000453302709
  error estimate for blocks of size 2^( 6) =       0.000460756773
  error estimate for blocks of size 2^( 7) =       0.000467642266

      target function =                  N/A
              le_mean =     -16.905736320830
             les_mean =     286.141531503226
             stat err =       0.000456010824
             autocorr =       1.283411669499
              std dev =       0.569255397325
             le_variance =       0.324051707384


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690573632083e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+18, overlap shift 8.2718e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905736320796       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905736320796       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.2718e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.3087e+19, overlap shift 3.3087e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905736320796       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905736320796       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3087e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.3235e+20, overlap shift 1.3235e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905736320796       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905736320796       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3235e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.040392 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9532e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -16.9027
    reference variance = 0.223623
====================================================
  Execution time = 2.1591e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3160e-01
  Total weights = 1.9520e+06
  Execution time = 1.8760e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320126337529
                                         uncertainty =       0.001955503790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320126337529
                                         uncertainty =       0.001955503790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400080337
  error estimate for blocks of size 2^( 2) =       0.000412838597
  error estimate for blocks of size 2^( 3) =       0.000426415165
  error estimate for blocks of size 2^( 4) =       0.000438557596
  error estimate for blocks of size 2^( 5) =       0.000450342161
  error estimate for blocks of size 2^( 6) =       0.000458859501
  error estimate for blocks of size 2^( 7) =       0.000461928050

      target function =                  N/A
              le_mean =     -16.906429524801
             les_mean =     286.158961939570
             stat err =       0.000452421827
             autocorr =       1.278770717771
              std dev =       0.565799038905
             le_variance =       0.320128552426

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320126337529
                                         uncertainty =       0.001955503790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320126337529
                                         uncertainty =       0.001955503790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400080337
  error estimate for blocks of size 2^( 2) =       0.000412838597
  error estimate for blocks of size 2^( 3) =       0.000426415165
  error estimate for blocks of size 2^( 4) =       0.000438557596
  error estimate for blocks of size 2^( 5) =       0.000450342161
  error estimate for blocks of size 2^( 6) =       0.000458859501
  error estimate for blocks of size 2^( 7) =       0.000461928050

      target function =                  N/A
              le_mean =     -16.906429524801
             les_mean =     286.158961939570
             stat err =       0.000452421827
             autocorr =       1.278770717771
              std dev =       0.565799038905
             le_variance =       0.320128552426

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320126337529
                                         uncertainty =       0.001955503790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320126337529
                                         uncertainty =       0.001955503790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400080337
  error estimate for blocks of size 2^( 2) =       0.000412838597
  error estimate for blocks of size 2^( 3) =       0.000426415165
  error estimate for blocks of size 2^( 4) =       0.000438557596
  error estimate for blocks of size 2^( 5) =       0.000450342161
  error estimate for blocks of size 2^( 6) =       0.000458859501
  error estimate for blocks of size 2^( 7) =       0.000461928050

      target function =                  N/A
              le_mean =     -16.906429524801
             les_mean =     286.158961939570
             stat err =       0.000452421827
             autocorr =       1.278770717771
              std dev =       0.565799038905
             le_variance =       0.320128552426

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320126337529
                                         uncertainty =       0.001955503790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320126337529
                                         uncertainty =       0.001955503790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400080337
  error estimate for blocks of size 2^( 2) =       0.000412838597
  error estimate for blocks of size 2^( 3) =       0.000426415165
  error estimate for blocks of size 2^( 4) =       0.000438557596
  error estimate for blocks of size 2^( 5) =       0.000450342161
  error estimate for blocks of size 2^( 6) =       0.000458859501
  error estimate for blocks of size 2^( 7) =       0.000461928050

      target function =                  N/A
              le_mean =     -16.906429524801
             les_mean =     286.158961939570
             stat err =       0.000452421827
             autocorr =       1.278770717771
              std dev =       0.565799038905
             le_variance =       0.320128552426


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906429524801        initial  <--
     8.2718e+18     8.2718e+19             0.0000e+00       -16.906429524801
     3.3087e+19     3.3087e+20             0.0000e+00       -16.906429524801
     1.3235e+20     1.3235e+21             0.0000e+00       -16.906429524801

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0901
  </log>
  <optVariables href="H2O.s098.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0628e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -16.9135
    reference variance = 0.275602
====================================================
  Execution time = 2.1206e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3532e-01
  Total weights = 1.951921982e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0236e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321651946919
                                         uncertainty =       0.002692551081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321651946919
                                         uncertainty =       0.002692551081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401033277
  error estimate for blocks of size 2^( 2) =       0.000414449398
  error estimate for blocks of size 2^( 3) =       0.000427799115
  error estimate for blocks of size 2^( 4) =       0.000439611277
  error estimate for blocks of size 2^( 5) =       0.000450368616
  error estimate for blocks of size 2^( 6) =       0.000458013706
  error estimate for blocks of size 2^( 7) =       0.000463041947

      target function =                  N/A
              le_mean =     -16.906205747187
             les_mean =     286.155110430418
             stat err =       0.000452758886
             autocorr =       1.274597737983
              std dev =       0.567146699480
             le_variance =       0.321655378731


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690620574719e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+19, overlap shift 8.2718e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906205747196       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906205747196       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.2718e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.3087e+20, overlap shift 3.3087e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906205747196       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906205747196       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3087e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.3235e+21, overlap shift 1.3235e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906205747196       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906205747196       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3235e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.041558 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7235e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -16.9074
    reference variance = 0.338816
====================================================
  Execution time = 2.1517e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3498e-01
  Total weights = 1.9517e+06
  Execution time = 1.8751e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324388177362
                                         uncertainty =       0.002481014002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324388177362
                                         uncertainty =       0.002481014002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402678739
  error estimate for blocks of size 2^( 2) =       0.000415072194
  error estimate for blocks of size 2^( 3) =       0.000428339107
  error estimate for blocks of size 2^( 4) =       0.000440360556
  error estimate for blocks of size 2^( 5) =       0.000450401796
  error estimate for blocks of size 2^( 6) =       0.000458748849
  error estimate for blocks of size 2^( 7) =       0.000463039540

      target function =                  N/A
              le_mean =     -16.906474105708
             les_mean =     286.163843685393
             stat err =       0.000453137685
             autocorr =       1.266318534842
              std dev =       0.569473733866
             le_variance =       0.324300333564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324388177362
                                         uncertainty =       0.002481014002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324388177362
                                         uncertainty =       0.002481014002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402678739
  error estimate for blocks of size 2^( 2) =       0.000415072194
  error estimate for blocks of size 2^( 3) =       0.000428339107
  error estimate for blocks of size 2^( 4) =       0.000440360556
  error estimate for blocks of size 2^( 5) =       0.000450401796
  error estimate for blocks of size 2^( 6) =       0.000458748849
  error estimate for blocks of size 2^( 7) =       0.000463039540

      target function =                  N/A
              le_mean =     -16.906474105708
             les_mean =     286.163843685393
             stat err =       0.000453137685
             autocorr =       1.266318534842
              std dev =       0.569473733866
             le_variance =       0.324300333564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324388177362
                                         uncertainty =       0.002481014002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324388177362
                                         uncertainty =       0.002481014002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402678739
  error estimate for blocks of size 2^( 2) =       0.000415072194
  error estimate for blocks of size 2^( 3) =       0.000428339107
  error estimate for blocks of size 2^( 4) =       0.000440360556
  error estimate for blocks of size 2^( 5) =       0.000450401796
  error estimate for blocks of size 2^( 6) =       0.000458748849
  error estimate for blocks of size 2^( 7) =       0.000463039540

      target function =                  N/A
              le_mean =     -16.906474105708
             les_mean =     286.163843685393
             stat err =       0.000453137685
             autocorr =       1.266318534842
              std dev =       0.569473733866
             le_variance =       0.324300333564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324388177362
                                         uncertainty =       0.002481014002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324388177362
                                         uncertainty =       0.002481014002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402678739
  error estimate for blocks of size 2^( 2) =       0.000415072194
  error estimate for blocks of size 2^( 3) =       0.000428339107
  error estimate for blocks of size 2^( 4) =       0.000440360556
  error estimate for blocks of size 2^( 5) =       0.000450401796
  error estimate for blocks of size 2^( 6) =       0.000458748849
  error estimate for blocks of size 2^( 7) =       0.000463039540

      target function =                  N/A
              le_mean =     -16.906474105708
             les_mean =     286.163843685393
             stat err =       0.000453137685
             autocorr =       1.266318534842
              std dev =       0.569473733866
             le_variance =       0.324300333564


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906474105708        initial  <--
     8.2718e+19     8.2718e+20             0.0000e+00       -16.906474105708
     3.3087e+20     3.3087e+21             0.0000e+00       -16.906474105708
     1.3235e+21     1.3235e+22             0.0000e+00       -16.906474105708

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0470
  </log>
  <optVariables href="H2O.s099.opt.xml">
   uu_0                 3.117531e-01 1 1  ON 0
   uu_1                 1.447377e-01 1 1  ON 1
   uu_2                 4.305772e-02 1 1  ON 2
   uu_3                -1.916587e-02 1 1  ON 3
   uu_4                -6.454693e-02 1 1  ON 4
   uu_5                -9.932998e-02 1 1  ON 5
   uu_6                -1.264844e-01 1 1  ON 6
   uu_7                -1.389809e-01 1 1  ON 7
   uu_8                -1.311520e-01 1 1  ON 8
   uu_9                -1.002764e-01 1 1  ON 9
   ud_0                 4.453621e-01 1 1  ON 10
   ud_1                 1.799295e-01 1 1  ON 11
   ud_2                 5.987753e-02 1 1  ON 12
   ud_3                -1.076749e-02 1 1  ON 13
   ud_4                -6.720102e-02 1 1  ON 14
   ud_5                -1.077671e-01 1 1  ON 15
   ud_6                -1.341374e-01 1 1  ON 16
   ud_7                -1.497585e-01 1 1  ON 17
   ud_8                -1.506344e-01 1 1  ON 18
   ud_9                -1.385813e-01 1 1  ON 19
   eO_0                -7.471078e-01 1 1  ON 20
   eO_1                -4.276999e-01 1 1  ON 21
   eO_2                -1.909341e-02 1 1  ON 22
   eO_3                 2.902573e-01 1 1  ON 23
   eO_4                 5.129991e-01 1 1  ON 24
   eO_5                 4.729072e-01 1 1  ON 25
   eO_6                 2.454354e-01 1 1  ON 26
   eO_7                -4.920388e-02 1 1  ON 27
   eO_8                -2.099812e-01 1 1  ON 28
   eO_9                -6.985333e-02 1 1  ON 29
  eH1_0                -2.490247e-01 1 1  ON 30
  eH1_1                -1.410049e-01 1 1  ON 31
  eH1_2                -9.187710e-02 1 1  ON 32
  eH1_3                -3.738922e-02 1 1  ON 33
  eH1_4                 1.162155e-02 1 1  ON 34
  eH1_5                 4.534866e-02 1 1  ON 35
  eH1_6                 1.014842e-01 1 1  ON 36
  eH1_7                 1.507969e-01 1 1  ON 37
  eH1_8                 1.645796e-01 1 1  ON 38
  eH1_9                 4.968283e-02 1 1  ON 39
  eH2_0                -2.461192e-01 1 1  ON 40
  eH2_1                -1.390233e-01 1 1  ON 41
  eH2_2                -8.956155e-02 1 1  ON 42
  eH2_3                -3.460410e-02 1 1  ON 43
  eH2_4                 1.430620e-02 1 1  ON 44
  eH2_5                 4.960727e-02 1 1  ON 45
  eH2_6                 1.052386e-01 1 1  ON 46
  eH2_7                 1.534309e-01 1 1  ON 47
  eH2_8                 1.693383e-01 1 1  ON 48
  eH2_9                 3.486813e-02 1 1  ON 49
ci_0001                 7.014451e-01 3 1  ON 50
ci_0002                 7.000932e-01 3 1  ON 51
ci_0003                -2.781587e-02 3 1  ON 52
ci_0004                -2.749066e-02 3 1  ON 53
ci_0005                -3.666456e-02 3 1  ON 54
ci_0006                -3.710019e-02 3 1  ON 55
ci_0007                -2.251857e-02 3 1  ON 56
ci_0008                -2.154054e-02 3 1  ON 57
ci_0009                -1.785212e-02 3 1  ON 58
ci_0010                -1.750380e-02 3 1  ON 59
ci_0011                -1.219756e-02 3 1  ON 60
ci_0012                -1.234250e-02 3 1  ON 61
ci_0013                 1.300622e-02 3 1  ON 62
ci_0014                 1.317847e-02 3 1  ON 63
ci_0015                 1.362498e-02 3 1  ON 64
ci_0016                 1.349988e-02 3 1  ON 65
ci_0017                 1.098905e-02 3 1  ON 66
ci_0018                 1.191322e-02 3 1  ON 67
ci_0019                 1.136437e-02 3 1  ON 68
ci_0020                 1.154277e-02 3 1  ON 69
ci_0021                -2.102486e-03 3 1  ON 70
ci_0022                -4.913977e-04 3 1  ON 71
ci_0023                -1.110239e-02 3 1  ON 72
ci_0024                -1.090651e-02 3 1  ON 73
ci_0025                -1.174355e-02 3 1  ON 74
ci_0026                -1.107539e-02 3 1  ON 75
ci_0027                -1.165977e-02 3 1  ON 76
ci_0028                -1.082994e-02 3 1  ON 77
ci_0029                -9.948724e-03 3 1  ON 78
ci_0030                -1.126667e-02 3 1  ON 79
ci_0031                 2.036705e-02 3 1  ON 80
ci_0032                 2.129426e-02 3 1  ON 81
ci_0033                 1.035378e-02 3 1  ON 82
ci_0034                 9.810566e-03 3 1  ON 83
ci_0035                 6.441575e-03 3 1  ON 84
ci_0036                 6.892870e-03 3 1  ON 85
ci_0037                -1.058260e-02 3 1  ON 86
ci_0038                -1.118889e-02 3 1  ON 87
ci_0039                -2.531945e-03 3 1  ON 88
ci_0040                -2.765595e-03 3 1  ON 89
ci_0041                 6.638183e-03 3 1  ON 90
ci_0042                 7.331245e-03 3 1  ON 91
ci_0043                -1.945849e-02 3 1  ON 92
ci_0044                -1.898993e-02 3 1  ON 93
ci_0045                 7.487142e-03 3 1  ON 94
ci_0046                 7.409369e-03 3 1  ON 95
ci_0047                -1.553773e-03 3 1  ON 96
ci_0048                -1.862451e-03 3 1  ON 97
ci_0049                -5.344927e-03 3 1  ON 98
ci_0050                -5.917964e-03 3 1  ON 99
ci_0051                -3.615063e-03 3 1  ON 100
ci_0052                -3.394659e-03 3 1  ON 101
ci_0053                -4.483616e-03 3 1  ON 102
ci_0054                -4.334931e-03 3 1  ON 103
ci_0055                 6.387853e-03 3 1  ON 104
ci_0056                 6.305072e-03 3 1  ON 105
ci_0057                 4.730771e-03 3 1  ON 106
ci_0058                 4.839678e-03 3 1  ON 107
ci_0059                -4.600646e-03 3 1  ON 108
ci_0060                -4.622911e-03 3 1  ON 109
ci_0061                -4.531637e-03 3 1  ON 110
ci_0062                -3.764913e-03 3 1  ON 111
ci_0063                -9.150459e-03 3 1  ON 112
ci_0064                -8.249809e-03 3 1  ON 113
ci_0065                -5.044314e-03 3 1  ON 114
ci_0066                -5.119995e-03 3 1  ON 115
ci_0067                -5.298547e-03 3 1  ON 116
ci_0068                -4.971036e-03 3 1  ON 117
ci_0069                 4.620468e-03 3 1  ON 118
ci_0070                 4.547039e-03 3 1  ON 119
ci_0071                 5.462915e-04 3 1  ON 120
ci_0072                -4.124720e-04 3 1  ON 121
ci_0073                 4.247461e-03 3 1  ON 122
ci_0074                 4.074953e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8287e+01 secs
  Total Execution time = 5.8769e+03 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
